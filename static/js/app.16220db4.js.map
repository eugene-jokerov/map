{"version":3,"sources":["webpack:///./src/lib/CORSProxy/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/baseService.js","webpack:///./src/lib/xhr-promise/index.js","webpack:///./src/lib/leaflet.control.commons/index.js","webpack:///./src/lib/logging/index.js","webpack:///./src/config.js","webpack:///./src/lib/notifications/index.js","webpack:///./src/lib/binary-strings/index.js","webpack:///./src/lib/controls-styles/controls-styles.css","webpack:///./src/lib/leaflet.hashState/leaflet.hashState.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/gpx.js","webpack:///./src/lib/contextmenu/index.js","webpack:///./src/lib/safe-localstorage/index.js","webpack:///./src/lib/leaflet.layer.canvasMarkers/index.js","webpack:///./src/lib/leaflet.fixes/fixWorldCopyJump.js","webpack:///./src/vendored/github.com/eligrey/FileSaver.js","webpack:///./src/lib/leaflet.control.track-list/track-list.js","webpack:///./src/lib/leaflet.hashState/hashState.js","webpack:///./src/lib/leaflet.control.printPages/decorations.js","webpack:///./src/lib/clipboardCopy/index.js","webpack:///./src/lib/tiled-data-loader/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/parseGeoFile.js","webpack:///./src/lib/stripBom/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/loadFromUrl.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/nktk.js","webpack:///./src/lib/anyElementResizeEvent/index.js","webpack:///./src/lib/knockout.component.progress/progress.js","webpack:///./src/lib/leaflet.layer.rasterize/index.js","webpack:///./src/lib/leaflet.layer.rasterize/TileLayer.js","webpack:///./src/lib/leaflet.layer.yandex/index.js","webpack:///./src/lib/leaflet.layer.google/index.js","webpack:///./src/lib/leaflet.layer.westraPasses/westraPassesMarkers.js","webpack:///./src/lib/popup-window/index.js","webpack:///./src/lib/iconFromBackgroundImage/index.js","webpack:///./src/lib/leaflet.layer.rasterize/CanvasMarkers.js","webpack:///./src/lib/leaflet.polyline-measure/index.js","webpack:///./src/lib/leaflet.layer.RetinaTileLayer/index.js","webpack:///./src/lib/magnetic-declination/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/common/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/common/style.css","webpack:///./src/lib/leaflet.events.drag/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/xmlUtils.js","webpack:///./src/vendored/github.com/augustl/js-unzip/js-unzip.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/jsInflate.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/codePages.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/nakarte/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/urlSafeBase64.js","webpack:///./src/lib/leaflet.control.elevation-profile/index.js","webpack:///./src/lib/elevations/index.js","webpack:///./src/lib/leaflet.control.layers.top-row/index.js","webpack:///./src/index.js","webpack:///./src/index.css","webpack:///./src/App.js","webpack:///./src/App.css","webpack:///./src/leaflet-fixes.css","webpack:///./src/lib/leaflet.map.sidebars/index.js","webpack:///./src/lib/leaflet.map.sidebars/style.css","webpack:///./src/lib/leaflet.control.printPages/control.js","webpack:///./src/lib/knockout.component.progress/style.css","webpack:///./src/lib/leaflet.control.printPages/control.css","webpack:///./src/lib/leaflet.control.printPages/pageFeature.js","webpack:///./src/lib/leaflet.control.printPages/page-feature.css","webpack:///./src/lib/contextmenu/contextmenu.css","webpack:///./src/lib/leaflet.control.printPages/map-render.js","webpack:///./src/secrets.js","webpack:///./src/lib/leaflet.layer.rasterize/imgFromDataString.js","webpack:///./src/lib/leaflet.layer.rasterize/Bing.js","webpack:///./src/lib/leaflet.layer.bing/index.js","webpack:///./src/lib/leaflet.layer.rasterize/Yandex.js","webpack:///./src/lib/leaflet.layer.yandex/style.css","webpack:///./src/lib/leaflet.layer.rasterize/Google.js","webpack:///./src/lib/leaflet.layer.rasterize/WestraPasses.js","webpack:///./src/lib/leaflet.layer.westraPasses/index.js","webpack:///./src/lib/leaflet.layer.westraPasses/westraPasses.css","webpack:///./src/lib/leaflet.layer.geojson-ajax/index.js","webpack:///./src/lib/notifications/style.css","webpack:///./src/lib/leaflet.layer.canvasMarkers/canvasMarkers.css","webpack:///./src/lib/leaflet.layer.rasterize/MeasuredLine.js","webpack:///./src/lib/leaflet.polyline-measure/measured_line.css","webpack:///./src/lib/leaflet.layer.rasterize/RetinaTileLayer.js","webpack:///./src/lib/leaflet.control.printPages/form.html","webpack:///./src/lib/leaflet.control.printPages/pdf.js","webpack:///./src/lib/leaflet.control.commons/style.css","webpack:///./src/lib/leaflet.control.printPages/decoration.magnetic-meridians.js","webpack:///./src/lib/leaflet.control.printPages/decoration.scale.js","webpack:///./src/lib/leaflet.control.printPages/decoration.grid.js","webpack:///./src/lib/leaflet.control.caption/index.js","webpack:///./src/lib/leaflet.control.caption/style.css","webpack:///./src/lib/leaflet.control.coordinates/index.js","webpack:///./src/lib/leaflet.control.coordinates/coordinates.css","webpack:///./src/lib/clipboardCopy/style.css","webpack:///./src/lib/leaflet.control.coordinates/formats.js","webpack:///./src/lib/leaflet.control.layers.hotkeys/index.js","webpack:///./src/lib/leaflet.control.layers.hotkeys/style.css","webpack:///./src/lib/leaflet.hashState/Leaflet.Map.js","webpack:///./src/lib/leaflet.hashState/Leaflet.Control.Layers.js","webpack:///./src/lib/leaflet.fixes/index.js","webpack:///./src/lib/leaflet.fixes/style.css","webpack:///./src/adaptive.css","webpack:///./src/lib/leaflet.control.panoramas/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/google/index.js","webpack:///./src/lib/googleMapsApi/index.js","webpack:///./src/lib/leaflet.control.panoramas/style.css","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/mapillary-coverage-layer.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/mapillary-loader.js","webpack:///./src/lib/cache/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/mvt.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/vector_tile_pb.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/style.css","webpack:///./src/lib/leaflet.control.panoramas/lib/wikimedia/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/wikimedia/coverage-layer.js","webpack:///./src/lib/leaflet.control.panoramas/lib/wikimedia/style.css","webpack:///./src/lib/leaflet.control.panoramas/lib/mapycz/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapycz/apiLoader.js","webpack:///./src/lib/leaflet.control.track-list/track-list.css","webpack:///./src/lib/file-read/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/zip.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/kml.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/ozi.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/simpleService.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/endomondo.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/etomesto.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/gpsies.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/urlEncode.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/gpslib.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/osm.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/strava.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/tracedetrail.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/yandex.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/nktk_pb.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/nakarte/loadTracksFromJson.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/movescount.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/garmin.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/sportstracker.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/openstreetmapRu.js","webpack:///./src/lib/leaflet.control.track-list/lib/geo_file_exporters.js","webpack:///./src/lib/leaflet.lineutil.simplifyLatLngs/index.js","webpack:///./src/lib/leaflet.control.elevation-profile/elevation-profile.css","webpack:///./src/lib/leaflet.polyline-edit/index.js","webpack:///./src/lib/leaflet.polyline-edit/edit_line.css","webpack:///./src/lib/leaflet.control.track-list/lib/meridian180.js","webpack:///./src/lib/leaflet.control.track-list/control-ruler.js","webpack:///./src/lib/leaflet.control.track-list/ruler.css","webpack:///./src/lib/leaflet.control.track-list/track-list.hash-state.js","webpack:///./src/lib/leaflet.control.track-list/track-list.localstorage.js","webpack:///./src/lib/leaflet.control.layers.minimize/index.js","webpack:///./src/lib/leaflet.control.layers.minimize/style.css","webpack:///./src/lib/leaflet.control.layers.top-row/style.css","webpack:///./src/lib/leaflet.control.layers.configure/index.js","webpack:///./src/lib/leaflet.control.layers.configure/style.css","webpack:///./src/lib/leaflet.control.layers.configure/customLayer.js","webpack:///./src/lib/leaflet.controls.raise-on-focus/index.js","webpack:///./src/lib/leaflet.controls.raise-on-focus/style.css","webpack:///./src/layers.js","webpack:///./src/lib/leaflet.layer.soviet-topomaps-grid/index.js","webpack:///./src/lib/leaflet.layer.soviet-topomaps-grid/style.css","webpack:///./src/lib/leaflet.layer.wikimapia/index.js","webpack:///./src/lib/leaflet.layer.wikimapia/wikimapia-loader.js","webpack:///./src/lib/leaflet.layer.wikimapia/wm-utils.js","webpack:///./src/lib/leaflet.layer.wikimapia/style.css","webpack:///./src/lib/leaflet.control.layers.events/index.js","webpack:///./src/lib/leaflet.control.jnx/index.js","webpack:///./src/lib/leaflet.control.jnx/style.css","webpack:///./src/lib/leaflet.control.jnx/selector.js","webpack:///./src/lib/leaflet.control.jnx/jnx-maker.js","webpack:///./src/lib/leaflet.control.jnx/jnx-encoder.js","webpack:///./src/lib/leaflet.control.jnx/binary-stream.js","webpack:///./src/lib/leaflet.control.jnx/hash-state.js","webpack:///./src/lib/leaflet.control.azimuth/index.js","webpack:///./src/lib/leaflet.control.azimuth/control.html","webpack:///./src/lib/leaflet.control.azimuth/style.css","webpack:///./src/lib/leaflet.control.azimuth/pointer.svg","webpack:///./src/lib/leaflet.control.azimuth/pointer-start.svg","webpack:///./src/lib/leaflet.control.azimuth/pointer-end.svg","webpack:///./src/lib/leaflet.control.locate/index.js","webpack:///./src/lib/leaflet.control.locate/style.css","webpack:///./src/lib/leaflet.control.zoom-display/index.js","webpack:///./src/lib/leaflet.control.zoom-display/style.css","webpack:///./src/lib/leaflet.placemark/index.js","webpack:///./src/lib/leaflet.placemark/style.css"],"names":["url","config","CORSProxyUrl","replace","this","origUrl","Error","isOurUrl","requests","requestOptions","map","it","fetch","options","Promise","all","responses","name","error","parseResponse","decodeURIComponent","e","split","pop","promise","XMLHttpRequestPromise","send","successIfStatus200","xhr","status","retryIfNetworkErrorOrServerError","XMLHttpRequestPromiseError","message","method","data","responseType","timeout","maxTries","retryTimeWait","isResponseSuccess","responseNeedsRetry","headers","withCredentials","resolve","reject","_resolve","_reject","then","bind","postData","_isResponseSuccess","_responseNeedsRetry","_retryTimeWait","triesLeft","XMLHttpRequest","onreadystatechange","_onreadystatechange","_open","k","v","setRequestHeader","open","readyState","_aborted","responseBinaryText","response","byteLength","arrayBufferToString","responseJSON","JSON","parse","_timerId","setTimeout","clearTimeout","abort","XHRQueue","maxSimultaneousRequests","_maxConnections","_queue","_activeCount","_originalAbort","_abortPromise","push","_processQueue","i","indexOf","splice","length","shift","_onRequestReady","containerClass","title","iconClass","cls","container","L","DomUtil","create","makeButton","buttonContainer","link","icon","appendChild","barContainer","stopContainerEvents","DomEvent","disableClickPropagation","disableScrollPropagation","on","stop","noControlClass","href","preventDefault","Control","include","_stopContainerEvents","_container","msg","extra","window","location","toString","console","log","Sentry","withScope","scope","setExtras","captureMessage","description","setTag","setExtra","captureException","addBreadcrumb","eventName","randId","Math","random","substring","caption","defaultLocation","defaultZoom","googleApiUrl","secrets","google","westraDataBaseUrl","elevationsServer","wikimediaCommonsCoverageUrl","geocachingSuUrl","tracksStorageServer","onOk","alertify","alert","value","result","prompt","activeElement","document","tagName","blur","stringToArrayBuffer","s","buf","ArrayBuffer","arr","Uint8Array","charCodeAt","arBuf","chunk","subarray","String","fromCharCode","apply","join","Blob","type","Mixin","HashState","enableHashState","key","defaultInitialState","_hashStateKey","eventSource","stateChangeEventsSource","stateChangeEvents","forEach","event","_onControlStateChanged","hashState","addEventListener","state","_onExternalStateChanged","getState","unserializeState","updateState","serializeState","logging","txt","preferNameFromFile","dom","getSegmentPoints","segment_element","points_elements","getElementsByTagName","points","point_element","lat","parseFloat","getAttribute","lng","isNaN","getRoutePoints","rte_element","DOMParser","parseFromString","documentElement","nodeName","trkName","xmlGetNodeText","tracks","xml","segments","segments_elements","segment_points","getTrackSegments","concat","routes","rte_elements","rte_points","getRoutes","waypoint_elements","waypoints","waypoint_element","waypoint","wptName","symbol_name","getWaypoints","items","keyCode","hide","parent","child","parentNode","isDescendant","target","originalEvent","returnValue","x","clientX","y","clientY","createElement","body","className","style","zIndex","onKeyDown","onMouseDown","createItems","item","setPosition","removeChild","removeEventListener","window_width","innerWidth","window_height","innerHeight","menu_width","offsetWidth","menu_height","offsetHeight","left","top","itemOptions","separator","createSeparator","createItem","el","disabled","header","innerHTML","text","callback","onItemClick","stopPropagation","storage","localStorage","setItem","getItem","localStorageWorks","_storage","n","Object","keys","removeItem","clear","calcIntersectionSum","rect","rects","right","bottom","rect2","sum","max","minX","min","maxX","minY","maxY","MarkerRBush","marker","latlng","a","b","RBush","Layer","CanvasMarkers","GridLayer","extend","async","labelFontName","labelFontSize","iconScale","pane","updateWhenZooming","Browser","mobile","iconsOpacity","labelShadowWidth","initialize","markers","prototype","call","rtree","_regions","_iconPositions","_labelPositions","_labelPositionsZoom","addMarkers","_images","_tileQueue","_hoverMarker","onMarkerEnter","onMarkerLeave","load","resetLabels","redraw","addMarker","insert","removeMarker","removeMarkers","remove","updateMarkers","updateMarker","setMarkerPosition","getMarkers","findLabelPosition","iconCenter","iconSize","textWidth","textHeight","pixelExtents","xPositions","yPositions","minIntersectionSum","Infinity","bestX","bestY","tileW","tileE","tileN","tileS","intersectionSum","search","preloadIcons","urls","newUrls","filter","images","image","src","createTile","coords","done","canvas","width","tileSize","height","drawTile","selectMarkersForDraw","zoom","withoutPadding","_map","iconsHorPad","iconsVertPad","labelsHorPad","labelsVertPad","iconsBounds","latLngBounds","unproject","point","labelsBounds","iconUrls","markerJobs","pointsForMarkers","getWest","getSouth","getEast","getNorth","pointsForLabels","tileMidLongitude","noWrap","wrapLatLngToTarget","p","project","stamp","projectedXY","drawSelectedMarkers","limitLabelsToImage","ctx","getContext","font","Util","template","size","entries","markerId","job","img","imgW","round","imgH","center","isLabel","label","measureText","regionsInTile","region","textBaseline","shadowColor","strokeStyle","fillStyle","lineWidth","shadowBlur","strokeText","fillText","globalAlpha","drawImage","z","findMarkerFromMouseEvent","wrap","onMouseMove","fire","showTooltip","tooltip","toolTip","latLngToLayerPoint","addClass","cursor","removeClass","onMouseOut","onClick","clickLocked","onRightClick","onAdd","getPane","createPane","getPanes","markerPane","onRemove","off","Polyline","shiftProjectedFitMapView","polylineBounds","getBounds","isValid","worldWidth","getPixelWorldBounds","getSize","polylineCenter","getCenter","mapCenter","_projectLatlngs","latlngs","projectedBounds","ring","flat","LatLng","len","projectedShift","Marker","update","_icon","pos","_latlng","_setPos","Map","addInitHook","_lastResetLongitude","abs","Handler","MarkerDrag","_onDrag","_marker","shadow","_shadow","iconPos","getPosition","layerPointToLatLng","oldLatLng","_oldLatLng","targetLng","shiftLongitudeToTarget","p1","getSouthEast","p2","getNorthWest","LatLngBounds","latLng","saveAs","view","navigator","test","userAgent","doc","get_URL","URL","webkitURL","save_link","createElementNS","can_use_save_link","is_safari","HTMLElement","safari","is_chrome_ios","setImmediate","throw_outside","ex","revoke","file","revokeObjectURL","auto_bom","blob","FileSaver","no_auto_bom","object_url","filesaver","force","dispatch_all","event_types","listener","dispatch","INIT","createObjectURL","node","download","MouseEvent","dispatchEvent","DONE","FileReader","reader","onloadend","undefined","readAsDataURL","fs_error","FS_proto","msSaveOrOpenBlob","WRITING","onwritestart","onprogress","onwrite","onabort","onerror","onwriteend","self","TRACKLIST_TRACK_COLORS","TrackSegment","MeasuredLine","includes","EditMixin","weight","lineCap","opacity","closestPointToLineSegment","segmentIndex","crs","CRS","EPSG3857","latLngToPoint","segStart","segEnd","pointToLatLng","LineUtil","closestPointOnSegment","isPointCloserToStart","distanceTo","mergeOptions","EditMixinOptions","TrackList","position","lineCursorStyle","interactive","dashArray","lineCursorValidStyle","color","lineCursorInvalidStyle","splitExtensions","splitExtensionsFirstStage","Evented","colors","ko","observableArray","observable","readingFiles","readProgressRange","readProgressDone","_lastTrackColor","trackListHeight","isPlacingPoint","trackAddingPoint","trackAddingSegment","removeAll","applyBindings","addListener","getContainer","onFileDragDrop","onFileDraging","menu","Contextmenu","copyAllTracksToClipboard","copyVisibleTracks","deleteAllTracks","deleteHiddenTracks","_markerLayer","print","scaleDependent","printTransparent","addTo","onMarkerClick","_setAdaptiveHeight","defaultEventHandle","_","maxHeight","offsetTop","setExpanded","setMinimized","dataTransfer","dropEffect","files","loadFilesFromFilesObject","onEnterPressedInInput","this_","loadFilesFromUrl","getTrackPolylines","track","feature","getLayers","layer","getTrackPoints","onButtonNewTrackClicked","trim","addTrackAndEdit","addSegmentAndEdit","stopPlacingPoint","segment","addTrackSegment","startEditTrackSegement","startDrawingLine","addTrack","readFiles","fileDataArray","geodataArray","fileData","filename","addTracksFromGeodataArray","loadFilesFromDisk","captureBreadcrumb","selectFiles","trackUrl","geodata","whenLoadDone","cb","subscription","subscribe","dispose","geodata_array","hasData","messages","data_empty","line","latngs","lastUnwrapped","unwrapped","prevUnwrapped","unwrapLatLngsCrossing180Meridian","simplifyLatlngs","CORRUPT","UNSUPPORTED","NETWORK","INVALID_URL","notify","onTrackColorChanged","polyline","setStyle","setMarkerIcon","onTrackVisibilityChanged","visible","addLayer","removeLayer","updateTrackHighlight","onTrackSegmentNodesChanged","getFixedLatLngs","recalculateTrackLength","getLength","formatLength","digits","toFixed","setTrackMeasureTicksVisibility","measureTicksShown","setMeasureTicksVisible","switchMeasureTicksVisibility","onColorSelectorClicked","_contextmenu","show","setViewToTrack","setViewToBounds","getTrackBounds","setViewToAllTracks","immediate","bounds","wrapLatLngBoundsToTarget","fitBounds","maxZoom","flyToBounds","lines","l","getLatLngs","attachColorSelector","index","attachActionsMenu","renameTrack","duplicateTrack","reverseTrack","showElevationProfileForTrack","removeTrack","saveTrackAsFile","geoExporters","saveGpx","saveKml","copyTrackLinkToClipboard","saveGpxWithElevations","_actionsMenu","onButtonAddSegmentClicked","stopEditLine","reverseTrackSegment","trackSegment","stopDrawingLine","ll","reverse","isEdited","_editedLine","deleteTrackSegment","newTrackSegment","_parentTrack","that","copyTracksLinkToClipboard","mouseEvent","serialized","trackToString","hashDigest","btoa","responseText","exporter","extension","addElevations","splitLinesAt180Meridian","extensions","lastIndexOf","slice","toLowerCase","request","reduce","acc","cur","ElevationProvider","get","elevations","alt","fileText","blobFromString","newName","query","showTrackMenu","showMenu","stopEdit","onTrackSegmentClick","_lineJoinActive","joinTrackSegments","startEdit","once","onLineEditEnd","onButtonAddPointClicked","beginPointCreate","_beginPointEdit","stopPlacingPointOnEscPressed","beginPointMove","_movingMarker","movePoint","createNewPoint","newLatLng","getNewPointName","maxNumber","match","parseInt","padStart","parentTrack","suggested","suggestedPoint","addPoint","renamePoint","newSegment","joinToStart","hideLineCursor","originalSegment","latngs2","_lineJoinFromStart","unshift","userCancelled","sourcePoints","onNodeRightClickShowMenu","onSegmentRightClickShowMenu","onTrackMouseEnter","onTrackMouseLeave","onTrackEditStart","onTrackEditEnd","onTrackSegmentDrawEnd","nodeIndex","splitTrackSegment","startLineJoinSelection","startShortCutSelection","newTrackFromSegment","showElevationProfileForSegment","showLineCursor","start","mousepos","_lineCursor","clone","onMouseMoveOnMapForLineCursor","onKeyUpForLineCursor","preventStopEdit","updateLineCursor","cursorStart","onLineCursorHideForJoin","onMouseMoveOnLineForJoin","disableEditOnLeftClick","cursorEnd","startFromNode","_shortCut","startNodeIndex","startLatLng","nodeMarkers","onMouseMoveOnNodeMarkerForShortCut","segmentOverlays","onMouseMoveOnLineSegmentForShortCut","onMouseMoveOnMapForShortCut","onClickNodeMarkerForShortCut","onClickLineSegmentForShortCut","onLineCursorHideForShortCut","updateShortCutSelection","highlighNodesForDeletion","endAtNode","getShortCutNodes","firstNodeToDelete","lastNodeToDelete","rangeValid","shortCutSegment","endNodeIndex","newNodes","spliceLatLngs","hover","onTrackRowMouseEnter","_highlightedTrack","onTrackRowMouseLeave","latlngs1","latlngs2","segment1","srcNodes","trackHidden","featureGroup","touch","bindTooltip","sticky","delay","_trackHighlight","removeFrom","trackHighlight","eachLayer","bringToBack","setMarkerLabel","srcPoint","removePoint","newLabel","forceVisible","saveToString","exportTracks","minTicksIntervalMeters","capturedTrack","pl","capturedBounds","measureTicks","getTicksPositions","hideElevationProfile","_elevationControl","ElevationProfile","samplingInterval","calcSamplingInterval","path","hasTracks","arrayItemsEqual","l1","l2","parseHashParams","args","m","substr","pair","exec","onChange","_listeners","_state","c","values","_saveStateToHash","hasKey","hasOwnProperty","stateItems","hash","origin","pathname","_ignoreChanges","onHashChanged","newState","changedKeys","PrintStaticLayer","printOptions","iterateTilePromises","tilePromise","draw","_drawRaster","isOverlay","overlaySolid","abortLoading","count","_unused_canvas","_unused_printOptions","ta","success","select","execCommand","w","h","showNotification","TiledDataLoader","cacheSize","_cache","Cache","_pendingRequests","_xhrQueue","dataTileCoords","makeTileKey","res","layerTileCoords","_unused_dataTileCoords","_unused_xhr","_unused_originalDataTileCoords","multiplier","offsetX","offsetY","layerTileToDataTileCoords","getFromCache","found","dataPromise","tileData","adjustment","calcAdjustment","dataTileKey","makeRequestData","fetchPromise","put","processResponse","pendingRequest","refCount","parsers","parsed","services","ServiceClass","service","geoData","trackView","shown","ticksShown","deltaEncodedSegments","deltaEncodeSegment","deltaLats","deltaLons","lats","lons","midLon","midLat","wp","arcUnit","packedWaypoints","lon","pbf","Pbf","versionStr","TrackView","write","finish","urlSafeBase64","encode","decode","parseNktkOld","parseNktkFragment","PackedStreamReader","_string","lastLon","lastLat","deltaLon","deltaLat","version","segmentsCount","pointsCount","midX","midY","waypointName","wayPoints","readNumber","readString","utf8","j","Boolean","parseNktkProtobuf","read","encodedLat","encodedLon","deltaDecodeSegment","unpackNumber","element","ResizeObserver","observe","setInterval","newWidth","newHeight","components","register","viewModel","params","progress","pureComputed","range","progressRange","progressDone","fullSize","pixelBounds","add","divideBy","assign","visibility","fadeAnimation","zoomAnimation","inertia","setView","noop","GridLayerGrabMixin","tileImagePromiseFromCoords","_unused_coords","waitTilesReadyToGrab","getTilesInfo","tileRange","_pxBoundsToTileRange","topLeft","tilePromiseIterator","Point","_tileZoom","_isValidTile","tilePos","_getTilePos","coordsPlusOne","tilePlusOne","subtract","_level","_wrapCoords","TileLayerGrabMixin","cloneForPrint","tileLayer","_url","xhrOptions","getTileUrl","noCors","xhrQueue","rawData","imgFromDataString","TileLayer","yandexCrs","EPSG3395","Yandex","subdomains","retina","yandexScale","tilePosLatLng","scaleBy","getTileSize","bounds2","Bounds","tile","coordsBelow","_adjustHeight","_initTile","Sat","Tracks","minZoom","maxNativeZoom","GoogleBase","_getZoomForUrl","_getSubdomain","lang","language","GoogleMap","GoogleTerrain","GoogleHybrid","GoogleSat","WestraPassesMarkers","filePasses","baseUrl","showPassDescription","_baseUrl","loadData","_downloadStarted","_loadMarkers","_makeTooltip","properties","grade","elevation","is_summit","_passToGpx","gpx","_passToKml","kml","_makeIcon","grade_eng","features","latlon","_dataLoaded","reports","id","altnames","connects","comments","comment","user","content","reports_total","reports_photo","reports_tech","slopes","author","openPopup","maxWidth","getElementById","onclick","openPopupWindow","uniqName","screenLeft","screen","availLeft","bordersWidth","screenX","outerWidth","availWidth","screenY","newWindow","closed","focus","f","cache","getComputedStyle","backgroundImage","offsetLeft","arg","_printProgressWeight","cloneMarker","cloneMarkers","printIconsOpacity","resolution","scale","destPixelSize","getTopRight","getBottomLeft","dummyMap","minTicksIntervalMm","_ticks","updateTicks","updateTicksLater","_clearTicks","tick","_addTick","transformMatrixString","transformMatrix","childNodes","transform","setLatLng","labelText","distanceValue","divIcon","html","keyboard","step","ticks","addTick","normalizedBounds","wrapLatLngBounds","normalizedPosition","positionMinus360","positionPlus360","contains","sinCos","dx","dy","sqrt","sinCosFromLatLonSegment","sin","cos","nextPointMeasure","q","lastTickMeasure","lastPointMeasure","_latlngs","points_n","pad","rad","PI","mercatorMetersPerPixel","referencePoint","mapScale","oldTicks","oldMarker","measuredLine","RetinaTileLayer","tileSizeMultiplicator","hiRes","useHiResTiles","newOptions","retinaOptionsOverrides","declination","minLat","maxLat","row1","floor","row2","dlat","col1","col2","dlon","colsCount","a1","getArrayValue","a2","v1","rowsCount","row","col","ind","ar1","atob","array","ar2","Float32Array","valueScale","offset","valueOffset","CloseButtonMixin","createCloseButton","closeButton","onCloseClick","DateLabelMixin","createDateLabel","dateLabel","updateDateLabel","timestamp","d","Date","getDate","getMonth","getFullYear","DragEvents","dragTolerance","dragButtons","stopOnLeave","setOptions","dragButton","startEvent","prevEvent","isDragging","button","disableImageDrag","disableTextSelection","_moveHandler","onMouseUp","onMouseLeave","fireDragEvent","finishDrag","tolerance","prevPos","dragMovement","enableImageDrag","enableTextSelection","Array","nodeValue","JSUnzip","fileContents","BigEndianBinaryStream","MAGIC_NUMBER","readEntries","isZipFile","ZipEntry","getByteRangeAsNumber","binaryStream","signature","getNextBytesAsNumber","versionNeeded","bitFlag","compressionMethod","timeBlob","isEncrypted","crc32","compressedSize","uncompressedSize","isUsingZip64","fileNameLength","extraFieldLength","fileName","getNextBytesAsString","isUsingBit3TrailingDataDescriptor","isUsingUtf8","escape","stream","resetByteIndex","currentByteIndex","getByteAt","steps","getByteRangeAsString","charCode","compressed","originalSize","out","s2","flattenArray","ar","parsePointFromHashValues","NakarteTrack","parseTrackUrlData","BaseService","NakarteUrlLoader","loaders","nktk","loadFromTextEncodedTrack","nktl","loadFromTextEncodedTrackId","nktu","loadFromUrlencodedUrls","nktp","loadPoint","nktj","loadFromJSON","paramName","loader","trackId","r","parseNktkSequence","loadTracksFromJson","loadFromUrl","NakarteUrl","paramNames","_params","promises","decoded","samplingIntgerval","createSvg","attributes","setAttribute","gradientToAngle","g","atan","Class","sightLine","samples","lastSampleDist","lastPointDistance","nextPointDistance","pathRegularSamples","horizZoom","dragStart","_addTo","_onWindowResize","_resizeGraph","newSvgWidth","drawingContainer","clientWidth","svgWidth","svg","updateGraph","updateGraphSelection","_controlContainer","setupContainerLayout","trackMarker","onLineMouseMove","onLineMouseEnter","onLineMouseLeave","polyLineSelection","propsContainer","leftAxisLables","onCloseButtonClick","graphCursor","graphCursorLabel","graphSelection","svgHeight","clientHeight","onSvgMouseMove","onSvgEnter","onSvgLeave","onSvgMouseWheel","svgDragEvents","onSvgDragStart","onSvgDragEnd","onSvgDrag","onSvgClick","onSvgDblClick","selStartIndex","roundedSampleIndexFromMouseEvent","graphContainerOffsetFromMouseEvent","getBoundingClientRect","sampleIndexFromMouseEvent","setTrackMarkerLabel","getElementsByClassName","setGraphSelection","cursorIndex","selMinInd","selMaxInd","selStart","selEnd","cursorShow","stats","calcProfileStats","updatePropsDisplay","scrollLeft","setLatLngs","setMapPositionAtIndex","panTo","oldHorizZoom","getWheelDelta","newScrollLeft","setupGraph","cursorHide","setCursorPosition","noData","maxElev","minElev","startElev","endElev","change","ascentAngleStr","descentAngleStr","ascent","descent","startApprox","endApprox","approx","incomplete","end","finalAscent","angleAvgAscent","avg","angleMaxAscent","angleAvgDescent","angleMaxDescent","dist","distance","dataLostAtStart","dataLostAtEnd","dataLost","calcGridValues","minValue","maxValue","ticksN","tickStep","tick1","ticksNs","tickSteps","matchFound","ceil","filterElevations","scanStart","scanEnd","linearValue","linearDelta","maxError","maxErrorInd","filtered","queue","notNullValues","firstNotNullValue","lastNotNullValue","firstNotNullIndex","lastNotNullIndex","ascents","descents","prevNotNullValue","prevNotNullIndex","gradient","gradientAvgAscent","gradientMinAscent","gradientMaxAscent","angleMinAscent","gradientAvgDescent","gradientMinDescent","gradientMaxDescent","angleMinDescent","delta","angleStr","distanceStr","sample1","sample2","indInt","markerPos","elevationStr","cursorLabel","indFrac","sqrDist","latlng1","latlng2","di","nextDist","nextSampleDist","prevDist","prevSampleDist","nearestInd","minDist","mouseLatlng","hasChildNodes","lastChild","horizStep","verticalMultiplier","gridValues","gridStep","x1","x2","valueToSvgCoord","startNewSegment","y1","y2","serverUrl","chunkSize","respValues","control","originalOnAdd","_topRowEnabled","__injectTopRow","_topRow","_section","insertBefore","uid","preconnect","preconnectLink","rel","head","dnsPrefetchLink","init","dsn","sentryDSN","release","RELEASE_VER","cookieUid","cookie","uidRaw","toUpperCase","getUid","configureScope","setUser","App","setUp","startInfo","localStorageKeys","safeLocalStorage","fixAll","MapWithSidebars","zoomControl","attributionControl","inertiaMaxSpeed","worldCopyJump","tracklist","Caption","ZoomDisplay","getPlacemarkHashStateInterface","Coordinates","locateControl","LocateControl","showError","code","customMessage","locationErrorMessage","validateState","validPositionInHash","valid","moveMapToCurrentLocation","layersControl","layers","collapsed","attribution","prefix","addControl","parentElement","removeControl","trackNames","tracksHashParams","hashParams","hasTrackParamsInHash","param","loadTracksFromStorage","tracksAfterLoadFromStorage","bindHashStateReadOnly","loadTrackFromParam","tracksAfterLoadFromHash","logEvent","saveTracksToStorage","0","1","2","_sidebarsContainer","setupSidebarsLayout","_mapContainer","onElementResize","requestAnimFrame","invalidateSize","_sidebarContainers","sidebars","midColumn","addElementToSidebar","barName","removeElementFromSidebar","extenders","checkNumberRange","newValue","notifySubscribers","PrintPages","defaultMargin","pageSizes","zoomLevels","pages","zoomLevel","pageWidth","pageHeight","settingsExpanded","makingPdf","downloadProgressRange","downloadProgressDone","marginLeft","marginRight","marginTop","marginBottom","autoZoomLevels","printSize","_printSize","onPageSizeChanged","pageSizeDescription","_displayPageSize","pagesNum","pagesNumLabel","_pagesNumLabel","gridOn","magneticMeridiansOn","notifyChange","updateFormZooms","formHtml","addPage","isLandscape","page","PageFeature","_rotated","cm","makePageContexmenuItems","rotatePage","addLandscapePage","addPortraitPage","removePage","setLabel","removePages","onSavePdfClicked","savePdf","zoomForPrint","suggestZooms","mapZoom","satZoom","incrementProgress","inc","getLatLngBounds","getPrintSize","getLabel","decorationLayers","Grid","MagneticMeridians","OverlayScale","eventId","zooms","action","renderPages","progressCallback","renderedLayers","getFileName","imagesInfo","pdf","makePdf","savePagesPdf","savePageJpg","pageNumber","setSize","onPagesNumLabelClick","renumberPage","rotate","newIndex","oldIndex","referenceLat","absLats","targetMetersPerPixel","mapUnitsPerPixel","LN2","hasPages","getLatLng","flags","rotated","opaqueLayer","transparentOverlayLayers","appendLayerShortName","shortName","isOverlayTransparent","currentPageSize","find","pageSize","centerLatLng","paperSize","draggable","updateView","rectangle","fillOpacity","_getLatLngBounds","centerMerc","Projection","SphericalMercator","mercatorScale","Earth","R","mercatorPageSize","multiplyBy","sw","ne","_animateZoom","newZoom","getZoom","pixel_sw","getSouthWest","pixel_ne","getNorthEast","pixel_center","st","pixel_width","pixel_height","fontSize","lineHeight","setBounds","getLayersForPrint","getZIndex","compare","i1","i2","getLayerZOrder","_path","TypeError","order","meta","sort","layer1","layer2","compareArrays","PageComposer","destSize","pixelBoundsAtZoom24","currentCanvas","currentZoom","currentTileScale","targetCanvas","createCanvas","tileInfo","tileScale","mergeCurrentCanvas","setupCurrentCanvas","dest","s_data","getImageData","sr","sg","sb","sa","sa1","dr","dg","db","d_image_data","d_data","data_length","putImageData","blendMultiplyCanvas","dataUrl","toDataURL","iterateLayersTiles","pageLabel","pagesCount","defaultXHROptions","_layerDummy","getTempMap","_rasterizeNeedsFullSizeMap","layerPromises","progressInc","doStop","disposeMap","promiseQueueBuffer","source","maxActive","next","pageImagesInfo","Set","composer","tilesIterator","queuedTilesIterator","putTile","getDataUrl","bingKey","thunderforestKey","mapillary","flickr","Image","blobUrl","onload","BingLayer","clearInterval","_key","tile2quad","quad","digit","mask","culture","_providers","metaRequested","tilePoint","loadMetadata","cbid","errorDetails","initMetadata","urlScheme","script","resourceSets","resources","imageUrlSubdomains","imageUrl","imageryProviders","coverageAreas","coverage","zoomMin","zoomMax","active","bbox","attrib","_update","_update_attribution","intersects","addAttribution","removeAttribution","tilesInfo","WestraPasses","waitDataReady","fileCoverage","fileLabels1","fileLabels2","labels2Zoom","markersZoom","labels1Zoom","markersOptions","GeoJSONAjax","onEachFeature","_setEventsForRegion","labels1","pointToLayer","_makeMarker","labels2","_onRegionClick","geojsonPoint","setLayersVisibility","zoomFinished","GeoJSON","requestTimeout","_loadStarted","addData","printWidthMm","_makelatLngToCanvasPixelTransformer","unscaleBy","_shift","targetBounds","getProjectedBounds","targetCenter","projected","lineBounds","lineJoin","beginPath","moveTo","lineTo","stroke","tickFontSizeMm","ticksPixelSize","setTransform","recPage","serialNum","pageRecId","contentRecId","imageRecId","recContent","contents","recImage","widthPixels","heightPixels","offsets","addRec","skipOffset","kidsIds","recPages","widthPoints","heightPoints","recOffsets","currentOffset","trailer","padding","recTrailer","angle","pixel","toLatLng","_makeCanvasToLatLngTransformer","lineThicknessMm","intervalPx","lineIntervalMm","samplingPx","samplingIntervalMm","pageDiagonal","maxSegments","drawLine","directionDown","getDeclination","maxLines","formatScale","nominalScale","scaleRange","unit","southLen","northLen","nScale","sScale","pageScaleRange","fontSizeMm","paddingMm","fillRect","intervalM","minGridIntervalM","minGridIntervalMm","intervals","metersPerDegree","pixelsPerMm","getGridInterval","mercatorBounds","canvasToMercatorScale","rows","yMerc","lat2","yMerc2","lineWidthPx","pageCanvasCenterX","direction","colN","firstRow","hasPointInPage","formatDistance","_drawGrid","_drawLabel","_contents","setContents","DEFAULT_FORMAT","formats","DEGREES","UNKNOWN_COORDINATES","SIGNED_DEGREES","DEGREES_AND_MINUTES","DEGREES_AND_MINUTES_AND_SECONDS","format","formatCode","formattedCoordinates","formatLatLng","wrapperClass","saveStateToStorage","makeButtonWithBar","_link","loadStateFromStorage","leafletCoordinatesActive","leafletCoordinatesFmt","setEnabled","isEnabled","enabled","classFunc","eventFunc","onMapRightClick","_isEnabled","coordinates","truncToFixed","precision","sliceEnd","padEnd","formatNumber","coordinatePresentations","coordinate","isLat","degrees","intDegrees","minutes","intMinutes","seconds","signedDegrees","formatter","getLayerHotkey","hotkey","extendLayerName","originalOnRemove","originalAddItem","_addItem","_hotKeysEnabled","obj","_addHotketEvents","_onHotkeyUp","_addHotKetEvents","altKey","ctrlKey","shiftKey","_keyDown","pressedKey","targetTag","_layers","layerId","inputs","input","click","Layers","k1","k2","hasBaselayer","overlay","chrome","PosAnimation","__panAnimationFixed","originalStep","_step","fixPanAnimationBug","pointerEnabled","ie","maxTouchPoints","originalHandleDOMEvent","_handleDOMEvent","_fireDOMEvent","Renderer","__animationFixed","resetInterval","originalGetEvents","getEvents","onZoom","now","_lastReset","_reset","_onZoom","onMove","move","fixVectorDrawWhileAnimation","fixVectorMarkerWorldJump","original_addTo","stackHorizontally","origOpenTooltip","_openTooltip","_tooltip","_pendingTooltip","origCloseTooltip","closeTooltip","addTooltipDelay","PanoMarker","zIndexOffset","getIcon","markerIcon","getElement","children","setHeading","setType","markerType","slim","normal","Panoramas","splitVerically","splitSizeFraction","minViewerSize","getProviders","provider","googleProvider","layerOptions","selected","mapMarkerType","wikimediaProvider","mapillaryProvider","mapyczProvider","loadSettings","_panoramasContainer","onContainerResize","providers","updateCoverageVisibility","nearbyPoints","storedSettings","panoramaSettings","_splitVerically","spitVertically","fraction","_splitSizeFraction","saveSetting","stringify","_splitterDragging","splitter","splitterButton","trackOutsideElement","dragstart","onSplitterDragStart","dragend","onSplitterDragEnd","drag","onSplitterDrag","onSplitterClick","setupViewerLayout","onMapResize","onButtonClick","onKeyUp","minSize","oldSize","newSize","mapSize","maxSize","setContainerSizePixels","switchControl","controlEnabled","disableControl","enableControl","codePointAt","onMapClick","notifyChanged","hidePanoViewer","coverageLayer","getCoverageLayer","showPanoramaContainer","panoramaVisible","hasClass","setupNearbyPoints","hidePano","viewer","deactivate","showPano","otherProvider","getViewer","setupViewerEvents","activate","onPanoramaChangeView","closeclick","onPanoramaCloseClick","hideMarker","placeMarker","heading","searchRadiusMeters","getPanoramaAtPos","searchResult","sidebar","updateContainerSize","containerSize","coverageCode","viewerState","setState","hashStateUpgrader","panoramasControl","oldState","upgradedState","getStreetViewService","maps","StreetViewService","getPanorama","radius","preference","StreetViewPreference","NEAREST","StreetViewStatus","OK","Viewer","panorama","StreetViewPanorama","enableCloseButton","imageDateControl","motionTracking","motionTrackingControl","throttle","_invalidateSize","setZoom","_active","pov","getPov","pitch","setVisible","setPov","trigger","_google","_pending","getMapillary","require","resp","component","cover","bearing","resize","onNodeChanged","onBearingChanged","_bearing","_zoom","_center","moveToKey","updateZoomAndCenter","_node","fireChangeEvent","capturedAt","getBearingCorrection","computedCA","originalCA","originalLatLon","_pitch","activateCover","_updateHandler","getBearing","deactivateCover","center0","center1","moveCloseTo","setCenter","MapillaryCoverage","updateWhenIdle","MapillaryLoader","onTileUnload","_abortLoading","_tileData","_adjustment","drawOverview","canvasCtx","geometry","arc","fill","drawSequences","lineI","pointI","drawImages","requestTileData","z2","originalDataTileCoords","_processResponse","decodeMvt","_maxSize","_store","_size","tileExtent","TileProto","parsedLayers","extent","parseFeatures","decodeCoordinate","parseGeometry","geometryType","ints","coordinatesScale","GeomType","POINT","LINESTRING","POLYGON","lineStrings","cmd","cmdRepeat","cmdN","Tile","exports","readFields","_readField","tag","readVarint","Feature","tags","readPackedVarint","parseSearchResponse","iinfo","imageinfo","imageDescription","extmetadata","ImageDescription","objectDescription","ObjectName","Artist","descriptionurl","thumburl","timeOriginal","DateTimeOriginal","time","DateTime","pageUrl","pageId","pageid","isCloser","d1","d2","clusterSize","photos","nearestLatlng","photo","formatDateTime","dateStr","year","month","day","mapContainer","pageButtonContainer","maxBoundsViscosity","Simple","zoomSnap","infoLabel","prevPhotoButton","nextPhotoButton","switchPhoto","_imageIdx","setupPageButtons","_buttons","imageIdx","imagePos","imageLayer","log2","southWest","northEast","setMaxZoom","setMaxBounds","animate","imageOverlay","setUrl","_showPano","MultiLayer","tms","WikimediaVectorCoverage","WikimediaLoader","urlTemplate","Uint16Array","dataOffset","pixelScale","getSMap","smap","Pano","getBest","Coords","fromWGS84","orig_windowAddEventListener","Scene","yaw","getCamera","setCamera","fov","updatePositionAndView","camera","place","getPlace","getCoords","toWGS84","syncPort","oldPlaceId","_placeId","oldHeading","_heading","getId","placeIdChanged","headingChanged","loaderUrl","Loader","pano","SMap","loadApi","readFile","fileInput","multiple","display","readAsArrayBuffer","parseKmz","parseZip","parseGpx","parseOziRte","parseOziPlt","parseOziWpt","parseKml","_unused_name","unzipper","uncompressed","entry","file_name","decode866","hasDocKml","coordinates_element","points_strings","placemarks","coord","pointObjs","nameTags","getPoints","expected_points_num","current_segment","total_points_num","fields","is_start_of_segment","currentSegment","pointName","decodeCP1251","YandexRuler","Endomondo","Etomesto","Gpsies","Gpslib","Osm","Strava","Tracedetrail","MovescountMove","MovescountRoute","GarminActivity","GarminRoute","SportsTrackerActivity","OpenStreetMapRu","SimpleService","nameFromUrl","responseURL","urlRegexps","some","re","userId","latitude","longitude","date","local_start_time","trackName","urlRe","getTrackId","startsWith","fileId","speed","dataType","filetype","submitButton","inappropriate","encodeURIComponent","pageResponse","trackResponse","401","404","isArray","userName","querySelector","textContent","activityTitle","nom_fr","proj","last_lat","last_lng","points_str","Segment","readPackedSVarint","writePackedSVarint","Waypoint","readSVarint","writeSVarintField","writeStringField","Waypoints","writeMessage","Track","View","readBoolean","writeVarintField","writeBooleanField","parseWaypoint","rawPoint","Number","lt","ln","parseTrack","rawTrack","rawSegment","errCorrupt","jsonString","geoDataArray","u","t","viewProps","MovescountBase","latitudes","longitudes","routeName","TrackPoints","trackPoint","Latitude","Longitude","GarminBase","coursePoints","pt","geoPoints","courseName","geoPolylineDTO","activityId","metadata","dataResponse","metadataResponse","payload","locations","la","startTime","toDateString","fullname","withElevations","fakeTime","simplify","_nodeMarkersZOffset","_editing","_drawingDirection","setupMarkers","onMapEndDrag","onKeyPress","_storedStyle","_nodeMarker","_lineNode","_segmentOverlay","getMarkerIndex","getSegmentOverlayIndex","segmentOverlay","onNodeMarkerDragEnd","replaceNode","_setupEndMarkers","onNodeMarkerMovedChangeNode","onNodeMarkerDblClickedRemoveNode","_disableEditOnLeftClick","removeNode","newNodeIndex","refNodeIndex","addNode","handler","dragging","_draggable","mousePos","_startPoint","_newPos","_startPos","mouseEventToLatLng","onMouseMoveFollowEndNode","makeNodeMarker","onNodeMarkerClickStartStopDrawing","latlngs_n","makeSegmentOverlay","onSegmentMouseDownAddNode","midPoint","Draggable","_dragging","_onDown","nodes","isAddingLeft","isAddingRight","prevNode","oldNode","nodesCount","startIndex","endIndex","startIcon","endIcon","startNode","endNode","disable","latLngs","wrappedLatLngs","newLines","newLine","prevLatLng","positiveLng","wrapNum","positivePrevLng","splitLng","sign","splitPrevLng","splitLat","getSegmentSplitPointLat","splitPrevLat","splitLineAt180Meridian","latLng1","latLng2","deltaLng","Ruler","trackList","_trackList","notEmpty","maxLocalStorageSessions","maxKey","_minimizeEnabled","__injectMinimizeButtons","contentsWrapper","minimizeButton","expandButton","originalUnserializeState","_configEnabled","_allLayersGroups","_allLayers","group","_initializeLayersState","updateEnabledLayers","addedLayers","hasBaselayerOnMap","enabledLayers","_justAdded","addOverlay","addBaseLayer","hasLayer","CustomLayer","z_1","x_1024","y_1024","infinite","invertedY","_globalTileRange","elements","querySelectorAll","raise","cornerDiv","layersDefs","grouppedLayers","isDefault","jnx","SovietTopoGrid","Wikimapia","zeroPad","num","bigLetterReplacers","Nomenclature","getQuadName1m","column","getQuadName500k","name1","subquad","name2","names","replacer","name3","getQuadName100k","getQuadName050k","_getQuads","row_height","column_width","name_factory","quads","min_lat","max_lat","maxCols","joined_quads","row_south","row_north","min_lon","max_lon","column_west","column_east","quad_bounds","getQuads1m","getQuads500k","getQuads100k","getQuads050k","LayerGroup","renderer","_quads","_updateRenderer","_cleanupQuads","_addQuad","titles","rect_options","smoothFactor","noClip","objects","_showContextMenu","_removeQuad","_addQuads","_addGrid","map_bbox","reset","clearLayers","quad_id","isPointInPolygon","polygon","inside","WikimapiaLoader","highlightedPlace","places","localPolygon","polygon2","_tileOnLoad","ielt9","_tileCoordsFromEvent","layerPoint","getPixelOrigin","getPlaceAtMousePos","tileCoords","_tiles","_tileCoordsToKey","getPlaceAtLatlng","setContent","boundsWESN","projectObj","_projectObj","exactMatch","hasChildren","wmUtils","makeTileUrl","parseTile","viewTileSize","urlPath","getTileId","tileIdToCoords","tileId","decodeTitles","chooseTitle","langCode","decodePolygon","makeCoordsLocal","tileX","tileY","tileZ","x0","y0","localCoords","asap","simplifyPolygon","tileHasChildren","p0","pixelDegSize","prevTime","placeId","originalLayerOnAdd","originalZoomOnAdd","Zoom","JNX","_layersControl","makingJnx","contextMenu","makeMenuItems","getLayerForJnx","selectedLayer","layerRec","layerName","estimateTilesCount","tilesCount","_selector","topLeftTile","bottomRightTile","maxLevel","minLevel","metersPerPixel","fileSizeMb","itemClass","resolutionString","sizeString","makeJnx","notifyProgress","sanitizedLayerName","makeJnxFromLayer","removeSelector","addSelector","RectangleSelect","onButtonClicked","Rectangle","fillColor","onMarkerDrag","onMarkerDragEnd","placeMarkers","topLeftPixel","setBoundsFromMarkers","imageFromarrayBuffer","dataURL","ensureImageJpg","convertToJpeg","srcLayer","maxZoomLevel","jnxProductId","jnxZOrder","writer","JnxWriter","minZoomLevel","progressWeight","tempMap","tilePromiseRec","imageRec","addTile","promiseRec","getJnx","jnxCoordinates","extents","toJnx","north","east","south","west","productName","productId","zOrder","tiles","level","totalTilesCount","levels_n","BinStream","writeInt32","writeUint32","seek","writeString","writeInt16","jnxScale","tileDescriptorOffset","tell","writeUint8","tileDataOffset","getBuffer","littlEndian","dv","DataView","_pos","old_buffer","buffer","newAr","oldAr","grow","newPos","checkSize","setUint8","setInt8","setInt16","setUint16","setInt32","setUint32","zeroTerminated","validateFloat","validateFloatRange","radians","roundAzimuth","Azimuth","trueAzimuth","magneticAzimuth","iconSingle","iconUrl","iconPointer","iconStart","iconPointerStart","iconEnd","iconPointerEnd","azimuthLine","single","which","rotationOrigin","layout","setPoints","elevationControl","showProfile","_enabled","hideProfile","atan2","setRotationAngle","updateValuesDisplay","azimuth","lat1","lng1","lng2","onProfileButtonClick","onReverseButtonClick","STATE_DISABLED","STATE_LOCATING","STATE_ENABLED","STATE_ENABLED_FOLLOWING","STATE_MOVING_TO_FOLLOWING","STATE_MOVING_TO_FOLLOWING_FIRST","STATE_UPDATING_FOLLOWING","EVENT_INIT","EVENT_BUTTON_CLICK","EVENT_LOCATION_RECEIVED","EVENT_LOCATION_ERROR","EVENT_MAP_MOVE","EVENT_MAP_MOVE_END","LOCALSTORAGE_POSITION","PositionMarker","_locationSet","_elements","accuracyCircle","circle","markerCircle","circleMarker","markerPoint","_updatePrecisionState","precise","_radius","_precise","setLocation","accuracy","setRadius","locationAcquireTimeoutMS","maxAutoZoom","minAutoZoomDeltaForAuto","minDistForAutoZoom","_events","_handleEvent","fallbackLatLng","forceLatLng","forceZoom","storedPosition","geolocation","getCurrentPosition","_storePositionToLocalStorage","enableHighAccuracy","maximumAge","_startLocating","_onLocationError","_watchID","watchPosition","_onLocationSuccess","_stopLocating","clearWatch","_storeLocation","_accuracy","_updateMarkerLocation","_updateMapPositionWhileFollowing","_updateFollowingStartPosition","_updateFollowingDestPosition","_setViewToLocation","preferAutoZoom","zoomFitAccuracy","getBoundsZoom","toBounds","autoZoom","screenSize","averageScreenSize","_onMapMove","_onMapMoveEnd","equals","_isMapOffsetFromFollowingSegment","pointToSegmentDistance","_isMapCenteredAtLocation","_updateButtonClasses","_setEvents","_processingEvent","_processEvent","_setState","_display","_zoomOutButton","_updateDisplay","Placemark","getTitle","onMapMove","showPlacemark","_placemark","onPlacemarkRemove","PlacemarkHashStateInterface","placemark"],"mappings":"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","file":"static/js/app.16220db4.js","sourcesContent":["import config from '~/config';\n\nexport default function urlViaCorsProxy(url) {\n    return config.CORSProxyUrl + url.replace(/^(https?):\\/\\//u, '$1/');\n}\n","import {fetch} from '~/lib/xhr-promise';\n\nclass BaseService {\n    constructor(url) {\n        this.origUrl = url;\n    }\n\n    isOurUrl() {\n        throw new Error('Method not implemented');\n    }\n\n    requestOptions() {\n        throw new Error('Method not implemented');\n    }\n\n    parseResponse() {\n        throw new Error('Method not implemented');\n    }\n\n    async geoData() {\n        if (!this.isOurUrl()) {\n            throw new Error('Unsupported url');\n        }\n        const requests = this.requestOptions().map((it) => fetch(it.url, it.options));\n        let responses;\n        try {\n            responses = await Promise.all(requests);\n        } catch (e) {\n            return [{name: this.origUrl, error: 'NETWORK'}];\n        }\n\n        return this.parseResponse(responses);\n    }\n\n    nameFromUrl(url) {\n        try {\n            url = decodeURIComponent(url);\n        } catch (e) {\n            // leave url as is\n        }\n\n        return url\n            .split('#')[0]\n            .split('?')[0]\n            .replace(/\\/*$/u, '')\n            .split('/')\n            .pop();\n    }\n}\n export default BaseService;\n","import {arrayBufferToString} from '~/lib/binary-strings';\n\nfunction successIfStatus200(xhr) {\n    return xhr.status >= 200 && xhr.status <= 299;\n}\n\nfunction retryIfNetworkErrorOrServerError(xhr) {\n    return (xhr.status === 0 || xhr.status >= 500);\n}\n\nclass XMLHttpRequestPromiseError extends Error {\n    constructor(xhr) {\n        super();\n        this.xhr = xhr;\n        this.name = 'XMLHttpRequestPromiseError';\n\n        this.message = xhr.status === 0 ? 'network error' : `server response is ${xhr.status}`;\n    }\n}\n\nclass XMLHttpRequestPromise {\n    constructor(\n        url, {method = 'GET', data = null, responseType = '', timeout = 30000, maxTries = 3, retryTimeWait = 500,\n            isResponseSuccess = successIfStatus200, responseNeedsRetry = retryIfNetworkErrorOrServerError,\n            headers = null, withCredentials = false} = {}) {\n        // console.log('promise constructor', url);\n        const promise = new Promise((resolve, reject) => {\n                this._resolve = resolve;\n                this._reject = reject;\n            }\n        );\n        this.then = promise.then.bind(promise);\n        this.catch = promise.catch.bind(promise);\n        this.method = method;\n        this.url = url;\n        this.responseType = responseType;\n        this.postData = data;\n        this._isResponseSuccess = isResponseSuccess;\n        this._responseNeedsRetry = responseNeedsRetry;\n        this._retryTimeWait = retryTimeWait;\n        this.triesLeft = maxTries;\n\n        const xhr = this.xhr = new XMLHttpRequest();\n        xhr.onreadystatechange = () => this._onreadystatechange();\n        this._open();\n        xhr.timeout = timeout;\n        if (responseType === 'binarystring') {\n            xhr.responseType = 'arraybuffer';\n        } else {\n            xhr.responseType = responseType;\n        }\n        if (headers) {\n            for (let [k, v] of headers) {\n                xhr.setRequestHeader(k, v);\n            }\n        }\n        xhr.withCredentials = withCredentials;\n    }\n\n    _open() {\n        // console.log('open', this.url);\n        this.xhr.open(this.method, this.url);\n    }\n\n    _onreadystatechange() {\n        const xhr = this.xhr;\n        if (xhr.readyState === 4 && !this._aborted) {\n            // console.log('ready state 4', this.url);\n            xhr.responseBinaryText = '';\n            if (this.responseType === 'binarystring' && xhr.response && xhr.response.byteLength) {\n                xhr.responseBinaryText = arrayBufferToString(xhr.response);\n            }\n            // IE doesnot support responseType=json\n            if (this.responseType === 'json' && (typeof xhr.response) === 'string') {\n                try {\n                    // xhr.response is readonly\n                    xhr.responseJSON = JSON.parse(xhr.response);\n                } catch (e) {\n                    xhr.responseJSON = null;\n                }\n            } else {\n                xhr.responseJSON = xhr.response;\n            }\n            if (this._isResponseSuccess(xhr)) {\n                // console.log('success', this.url);\n                this._resolve(xhr);\n            } else {\n                if (this.triesLeft > 0 && this._responseNeedsRetry(xhr)) {\n                    // console.log('retry', this.url);\n                    this._open();\n                    this._timerId = setTimeout(() => this.send(), this._retryTimeWait);\n                } else {\n                    // console.log('failed', this.url);\n                    this._reject(new XMLHttpRequestPromiseError(xhr));\n                }\n            }\n        }\n    }\n\n    abort() {\n        // console.log('abort', this.url);\n        this._aborted = true;\n        clearTimeout(this._timerId);\n        this.xhr.abort();\n    }\n\n    send() {\n        // console.log('send', this.url);\n        this.triesLeft -= 1;\n        this.xhr.send(this.postData);\n    }\n}\n\nclass XHRQueue {\n    constructor(maxSimultaneousRequests = 6) {\n        this._maxConnections = maxSimultaneousRequests;\n        this._queue = [];\n        this._activeCount = 0;\n    }\n\n    put(url, options) {\n        const promise = new XMLHttpRequestPromise(url, options);\n        promise._originalAbort = promise.abort;\n        promise.abort = () => this._abortPromise(promise);\n        this._queue.push(promise);\n        this._processQueue();\n        return promise;\n    }\n\n    _abortPromise(promise) {\n        const i = this._queue.indexOf(promise);\n        if (i > -1) {\n            // console.log('ABORT IN QUEUE');\n            this._queue.splice(i, 1);\n        } else {\n            if (promise.xhr.readyState === 4) {\n                // console.log('ABORT COMPLETED');\n            } else {\n                // console.log('ABORT ACTIVE');\n                promise._originalAbort();\n                this._activeCount -= 1;\n                setTimeout(() => this._processQueue(), 0);\n            }\n        }\n    }\n\n    _processQueue() {\n        if (this._activeCount >= this._maxConnections || this._queue.length === 0) {\n            return;\n        }\n        const promise = this._queue.shift();\n        promise\n            .catch(() => {\n                // do not throw if XHR request fails\n            })\n            .then(() => this._onRequestReady(promise));\n        this._activeCount += 1;\n        promise.send();\n    }\n\n    _onRequestReady(promise) {\n        if (!promise._aborted) {\n            this._activeCount -= 1;\n        }\n        setTimeout(() => this._processQueue(), 0);\n    }\n}\n\nfunction fetch(url, options) {\n    // console.log('fetch', url);\n    const promise = new XMLHttpRequestPromise(url, options);\n    promise.send();\n    return promise;\n}\n\nexport {fetch, XHRQueue};\n\n","import L from 'leaflet';\nimport './style.css';\n\nfunction stopContainerEvents(container) {\n    L.DomEvent.disableClickPropagation(container);\n    L.DomEvent.disableScrollPropagation(container);\n    L.DomEvent.on(container, 'mousemove contextmenu', L.DomEvent.stop);\n}\n\nL.Control.include({\n    _stopContainerEvents: function() {\n        stopContainerEvents(this._container);\n    }\n});\n\nfunction makeButton(containerClass, title, iconClass, noControlClass) {\n    let cls = 'leaflet-bar leaflet-control-single-button';\n    if (!noControlClass) {\n        cls += ' leafletControl';\n    }\n    if (containerClass) {\n        cls += ' ' + containerClass;\n    }\n    const container = L.DomUtil.create('div', cls);\n    stopContainerEvents(container);\n    const link = L.DomUtil.create('a', null, container);\n    link.href = '#';\n    L.DomEvent.on(link, 'click', L.DomEvent.preventDefault);\n    if (title) {\n        link.title = title;\n    }\n    const icon = L.DomUtil.create('div', iconClass, link);\n    return {container, link, icon};\n}\n\nfunction makeButtonWithBar(containerClass, title, iconClass) {\n    let cls = 'leaflet-control button-with-bar';\n    if (containerClass) {\n        cls += ' ' + containerClass;\n    }\n    const container = L.DomUtil.create('div', cls);\n    const {container: buttonContainer, link, icon} = makeButton(null, title, iconClass, true);\n    container.appendChild(buttonContainer);\n\n    const barContainer = L.DomUtil.create('div', 'leaflet-bar bar', container);\n    stopContainerEvents(barContainer);\n    return {container, buttonContainer, link, icon, barContainer};\n}\n\nexport {stopContainerEvents, makeButton, makeButtonWithBar};\n","import * as Sentry from '@sentry/browser';\n\nfunction randId() {\n    return Math.random().toString(36).substring(2, 13);\n}\n\nconst sessionId = randId(); // eslint-disable-line\n\nfunction captureMessage(msg, extra = {}) {\n    extra.url = window.location.toString();\n    console.log('captureMessage', msg, extra); // eslint-disable-line no-console\n    Sentry.withScope(function(scope) {\n        scope.setExtras(extra);\n        Sentry.captureMessage(msg);\n    });\n}\n\nfunction captureException(e, description) {\n    console.log('captureException', e, description); // eslint-disable-line no-console\n    Sentry.withScope(function(scope) {\n        if (description) {\n            scope.setTag('description', description);\n        }\n        scope.setExtra('url', window.location.toString());\n        Sentry.captureException(e);\n    });\n}\nfunction captureBreadcrumb(message, data = {}) {\n    data.url = window.location.toString();\n    Sentry.addBreadcrumb({\n        message, data\n    });\n}\n\nfunction logEvent(eventName, extra) { // eslint-disable-line\n    console.log(eventName, extra); // eslint-disable-line\n}\n\nexport {captureMessage, captureException, captureBreadcrumb, logEvent, randId};\n","import secrets from './secrets';\n\nconst config = {\n    caption: ``,\n    defaultLocation: [44.47716, 33.91960],\n    defaultZoom: 12,\n    googleApiUrl: `https://maps.googleapis.com/maps/api/js?v=3&key=${secrets.google}`,\n    westraDataBaseUrl: 'https://nakarte.me/westraPasses/',\n    CORSProxyUrl: 'https://proxy.nakarte.me/',\n    elevationsServer: 'https://elevation.nakarte.me/',\n    wikimediaCommonsCoverageUrl: 'https://tiles.nakarte.me/wikimedia_commons_images/{z}/{x}/{y}',\n    geocachingSuUrl: 'https://nakarte.me/geocachingSu/geocaching_su2.json',\n    tracksStorageServer: 'https://tracks.nakarte.me',\n    ...secrets\n};\n\nexport default config;\n","import alertify from 'alertify.js';\nimport './style.css';\n\nfunction notify(message, onOk) {\n    alertify.alert(message, onOk);\n}\n\nfunction query(message, value) {\n    function removeFocusFromInput() {\n        const activeElement = document.activeElement;\n        if (activeElement?.tagName === 'INPUT') {\n            activeElement.blur();\n        }\n    }\n\n    const result = window.prompt(message, value);\n    // There is a bug in Chrome on Android: after closing the prompt, it sets focus to last active input element\n    setTimeout(removeFocusFromInput, 0);\n    return result;\n}\n\nexport {notify, query};\n","function arrayBufferToString(arBuf) {\n    const\n        arr = new Uint8Array(arBuf),\n        s = [];\n    for (let i = 0; i < arr.length; i += 4096) {\n        let chunk = arr.subarray(i, i + 4096);\n        chunk = String.fromCharCode.apply(null, chunk);\n        s.push(chunk);\n    }\n    return s.join('');\n}\n\nfunction stringToArrayBuffer(s) {\n    const\n        length = s.length,\n        buf = new ArrayBuffer(length),\n        arr = new Uint8Array(buf);\n    for (let i = 0; i < length; i++) {\n        arr[i] = s.charCodeAt(i);\n    }\n    return buf;\n}\n\nfunction blobFromString(s) {\n    const arr = stringToArrayBuffer(s);\n    return new Blob([arr], {type: \"text/plain;charset=utf-8\"});\n}\n\nexport {arrayBufferToString, blobFromString, stringToArrayBuffer};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {hashState} from './hashState';\nimport * as logging from '~/lib/logging';\n\nL.Mixin.HashState = {\n    enableHashState: function(key, defaultInitialState = null) {\n        this._hashStateKey = key;\n        const eventSource = this.stateChangeEventsSource ? this[this.stateChangeEventsSource] : this;\n\n        // setup event listeners\n        if (this.stateChangeEvents) {\n            this.stateChangeEvents.forEach((event) => {\n                    eventSource.on(event, this._onControlStateChanged, this);\n                }\n            );\n        }\n\n        hashState.addEventListener(key, (state) => this._onExternalStateChanged(state));\n\n        // initialize control state from hash\n\n        const state = hashState.getState(key) || defaultInitialState;\n        if (!state || !this.unserializeState(state)) {\n            this.unserializeState(defaultInitialState);\n        }\n        hashState.updateState(this._hashStateKey, this.serializeState());\n        return this;\n    },\n\n    _onControlStateChanged: function() {\n        const state = this.serializeState();\n        hashState.updateState(this._hashStateKey, state);\n    },\n\n    _onExternalStateChanged: function(state) {\n        if (!this.unserializeState(state)) { // state from hash is invalid, update hash from component state\n            logging.captureMessage(`Invalid state in hash string (key \"${this._hashStateKey}\")`);\n            hashState.updateState(this._hashStateKey, this.serializeState());\n        }\n    }\n\n    // TODO: disableHashState\n};\n","import {decode as utf8_decode} from 'utf8';\nimport {xmlGetNodeText} from './xmlUtils';\nimport stripBom from '~/lib/stripBom';\n\nfunction parseGpx(txt, name, preferNameFromFile) {\n    var error;\n\n    function getSegmentPoints(segment_element) {\n        var points_elements = segment_element.getElementsByTagName('trkpt');\n        var points = [];\n        for (var i = 0; i < points_elements.length; i++) {\n            var point_element = points_elements[i];\n            var lat = parseFloat(point_element.getAttribute('lat'));\n            var lng = parseFloat(point_element.getAttribute('lon'));\n            if (isNaN(lat) || isNaN(lng)) {\n                error = 'CORRUPT';\n                break;\n            }\n            points.push({lat: lat, lng: lng});\n        }\n        return points;\n    }\n\n    function getTrackSegments(xml) {\n        var segments = [];\n        var segments_elements = xml.getElementsByTagName('trkseg');\n        for (var i = 0; i < segments_elements.length; i++) {\n            var segment_points = getSegmentPoints(segments_elements[i]);\n            if (segment_points.length) {\n                segments.push(segment_points);\n            }\n        }\n        return segments;\n    }\n\n    function getRoutePoints(rte_element) {\n        var points_elements = rte_element.getElementsByTagName('rtept');\n        var points = [];\n        for (var i = 0; i < points_elements.length; i++) {\n            var point_element = points_elements[i];\n            var lat = parseFloat(point_element.getAttribute('lat'));\n            var lng = parseFloat(point_element.getAttribute('lon'));\n            if (isNaN(lat) || isNaN(lng)) {\n                error = 'CORRUPT';\n                break;\n            }\n            points.push({lat: lat, lng: lng});\n        }\n        return points;\n    }\n\n    function getRoutes(xml) {\n        var routes = [];\n        var rte_elements = xml.getElementsByTagName('rte');\n        for (var i = 0; i < rte_elements.length; i++) {\n            var rte_points = getRoutePoints(rte_elements[i]);\n            if (rte_points.length) {\n                routes.push(rte_points);\n            }\n        }\n        return routes;\n    }\n\n    function getWaypoints(xml) {\n        var waypoint_elements = xml.getElementsByTagName('wpt');\n        var waypoints = [];\n        for (var i = 0; i < waypoint_elements.length; i++) {\n            var waypoint_element = waypoint_elements[i];\n            var waypoint = {};\n            waypoint.lat = parseFloat(waypoint_element.getAttribute('lat'));\n            waypoint.lng = parseFloat(waypoint_element.getAttribute('lon'));\n            if (isNaN(waypoint.lat) || isNaN(waypoint.lng)) {\n                error = 'CORRUPT';\n                continue;\n            }\n            let wptName = xmlGetNodeText(waypoint_element.getElementsByTagName('name')[0]) || '';\n            try {\n                wptName = utf8_decode((wptName));\n            } catch (e) {\n                error = 'CORRUPT';\n                wptName = '__invalid point name__';\n            }\n            waypoint.name = wptName;\n            waypoint.symbol_name = xmlGetNodeText(waypoint_element.getElementsByTagName('sym')[0]);\n            waypoints.push(waypoint);\n        }\n        return waypoints;\n    }\n\n    txt = stripBom(txt);\n    // remove namespaces\n    txt = txt.replace(/<([^ >]+):([^ >]+)/ug, '<$1_$2');\n    let dom;\n    try {\n        dom = (new DOMParser()).parseFromString(txt, \"text/xml\");\n    } catch (e) {\n        return null;\n    }\n    if (dom.documentElement.nodeName === 'parsererror') {\n        return null;\n    }\n    if (dom.getElementsByTagName('gpx').length === 0) {\n        return null;\n    }\n    if (preferNameFromFile) {\n        for (let trk of [...dom.getElementsByTagName('trk')]) {\n            let trkName = trk.getElementsByTagName('name')[0];\n            if (trkName) {\n                try {\n                    trkName = utf8_decode(xmlGetNodeText(trkName));\n                } catch (e) {\n                    error = 'CORRUPT';\n                }\n                if (trkName.length) {\n                    name = trkName;\n                    break;\n                }\n            }\n        }\n    }\n    return [{\n        name: name,\n        tracks: getTrackSegments(dom).concat(getRoutes(dom)),\n        points: getWaypoints(dom),\n        error: error\n    }];\n}\n\nexport default parseGpx;\n","import './contextmenu.css';\n\n/*\n    items = [\n        {text: 'Hello', disabled: true},\n        '-',\n        {text: 'World', callback: fn},\n        {text: 'section', separator: true},\n    ]\n */\n\nfunction isDescendant(parent, child) {\n    if (!parent) {\n        return false;\n    }\n    while (child) {\n        if (child === parent) {\n            return true;\n        }\n        child = child.parentNode;\n    }\n    return false;\n}\n\nclass Contextmenu {\n    constructor(items) {\n        this.items = items;\n    }\n\n    show(e) {\n        if (this._container) {\n            return;\n        }\n        if (e.originalEvent) {\n            e = e.originalEvent;\n        }\n        if (e.preventDefault) {\n            e.preventDefault();\n        } else {\n            e.returnValue = false;\n        }\n\n        const {clientX: x, clientY: y} = e;\n\n        const container = this._container = document.createElement('div');\n        document.body.appendChild(container);\n        container.className = 'contextmenu';\n        container.style.zIndex = 10000;\n\n        window.addEventListener('keydown', this.onKeyDown, true);\n        window.addEventListener('mousedown', this.onMouseDown, true);\n        window.addEventListener('touchstart', this.onMouseDown, true);\n\n        for (let item of this.createItems()) {\n            container.appendChild(item);\n        }\n        this.setPosition(x, y);\n    }\n\n    hide() {\n        if (!this._container) {\n            return;\n        }\n        document.body.removeChild(this._container);\n        this._container = null;\n\n        window.removeEventListener('keydown', this.onKeyDown, true);\n        window.removeEventListener('mousedown', this.onMouseDown, true);\n        window.removeEventListener('touchstart', this.onMouseDown, true);\n    }\n\n    onKeyDown = (e) => {\n        if (e.keyCode === 27) {\n            this.hide();\n        }\n    };\n\n    onMouseDown = (e) => {\n        if (!isDescendant(this._container, e.target)) {\n            this.hide();\n        }\n    };\n\n    setPosition(x, y) {\n        const window_width = window.innerWidth,\n            window_height = window.innerHeight,\n            menu_width = this._container.offsetWidth,\n            menu_height = this._container.offsetHeight;\n        if (x + menu_width >= window_width) {\n            x -= menu_width;\n            if (x < 0) {\n               x = 0;\n            }\n        }\n        if (y + menu_height >= window_height) {\n            y -= menu_height;\n            if (y < 0) {\n                y = 0;\n            }\n        }\n        this._container.style.left = `${x}px`;\n        this._container.style.top = `${y}px`;\n    }\n\n    *createItems() {\n        let items = this.items;\n        if (typeof items === 'function') {\n            items = items();\n        }\n        for (let itemOptions of items) {\n            if (typeof itemOptions === 'function') {\n                itemOptions = itemOptions();\n            }\n            if (itemOptions === '-' || itemOptions.separator) {\n                yield this.createSeparator(itemOptions);\n            } else {\n                yield this.createItem(itemOptions);\n            }\n        }\n    }\n\n    createItem(itemOptions) {\n        const el = document.createElement('a');\n        let className = 'item';\n        if (itemOptions.disabled) {\n            className += ' disabled';\n        }\n        if (itemOptions.header) {\n            className += ' header';\n        }\n        el.innerHTML = itemOptions.text;\n\n        const callback = itemOptions.callback;\n        if (callback && !itemOptions.disabled) {\n            className += ' action';\n            el.addEventListener('click', this.onItemClick.bind(this, callback));\n        }\n        el.className = className;\n        return el;\n    }\n\n    onItemClick(callback, e) {\n        e.stopPropagation();\n        e.preventDefault();\n        this.hide();\n        callback(e);\n    }\n\n    createSeparator(itemOptions) {\n        const el = document.createElement('div');\n        el.className = 'separator';\n        if (itemOptions.text) {\n            el.innerHTML = `<span>${itemOptions.text}</span>`;\n        }\n        return el;\n    }\n}\n\nexport default Contextmenu;\n","function localStorageWorks() {\n    try {\n        window.localStorage.setItem('_testDummy', 'TEST');\n        return window.localStorage.getItem('_testDummy') === 'TEST';\n    } catch (e) {\n        return false;\n    }\n}\n\nlet storage; // eslint-disable-line import/no-mutable-exports\n\nif (localStorageWorks()) {\n    storage = window.localStorage;\n} else {\n    let _storage = {};\n    storage = {\n        length: 0,\n\n        key: function(n) {\n            return Object.keys(_storage)[n];\n        },\n\n        removeItem: function(key) {\n            delete _storage[key];\n        },\n\n        getItem: function(key) {\n            return storage[key];\n        },\n\n        setItem: function(key, value) {\n            storage[key] = value;\n        },\n\n        clear: function() {\n            _storage = {};\n        }\n    };\n}\n\nexport default storage;\n","import L from 'leaflet';\nimport './canvasMarkers.css';\nimport RBush from 'rbush';\nimport loadImage from 'image-promise';\nimport {wrapLatLngToTarget} from '~/lib/leaflet.fixes/fixWorldCopyJump';\n\n/*\n Marker definition:\n {\n latlng: L.Latlng,\n icon: {url: string, center: [x, y]} or function(marker) returning icon,\n label: string or function,\n tooltip: string or function,\n any other fields\n }\n */\n\nfunction calcIntersectionSum(rect, rects) {\n    let sum = 0,\n        left, right, top, bottom, rect2;\n\n    for (rect2 of rects) {\n        left = Math.max(rect.minX, rect2.minX);\n        right = Math.min(rect.maxX, rect2.maxX);\n        top = Math.max(rect.minY, rect2.minY);\n        bottom = Math.min(rect.maxY, rect2.maxY);\n        if (top < bottom && left < right) {\n            sum += ((right - left) * (bottom - top));\n        }\n    }\n    return sum;\n}\n\nclass MarkerRBush extends RBush {\n    toBBox(marker) {\n        const x = marker.latlng.lng;\n        const y = marker.latlng.lat;\n        return {\n            minX: x,\n            minY: y,\n            maxX: x,\n            maxY: y\n        };\n    }\n\n    compareMinX(a, b) {\n        return a.latlng.lng - b.latlng.lng;\n    }\n\n    compareMinY(a, b) {\n        return a.latlng.lat - b.latlng.lat;\n    }\n}\n\nL.Layer.CanvasMarkers = L.GridLayer.extend({\n        options: {\n            async: true,\n            labelFontName: 'Verdana, Arial, sans-serif',\n            labelFontSize: 10,\n            iconScale: 1,\n            pane: 'rasterMarker',\n            updateWhenZooming: !L.Browser.mobile,\n            iconsOpacity: 1,\n            labelShadowWidth: 1,\n        },\n\n        initialize: function(markers, options) {\n            L.GridLayer.prototype.initialize.call(this, options);\n            this.rtree = new MarkerRBush(9);\n            this._regions = new RBush();\n            this._iconPositions = {};\n            this._labelPositions = {};\n            this._labelPositionsZoom = null;\n            this.addMarkers(markers);\n            this._images = {};\n            this._tileQueue = [];\n            this._hoverMarker = null;\n            this.on('markerenter', this.onMarkerEnter, this);\n            this.on('markerleave', this.onMarkerLeave, this);\n        },\n\n        addMarkers: function(markers) {\n            if (markers) {\n                this.rtree.load(markers);\n                this.resetLabels();\n                setTimeout(() => this.redraw(), 0);\n            }\n        },\n\n        addMarker: function(marker) {\n            // FIXME: adding existing marker must be be noop\n            this.rtree.insert(marker);\n            this.resetLabels();\n            setTimeout(() => this.redraw(), 0);\n        },\n\n        removeMarker: function(marker) {\n            this.removeMarkers([marker]);\n        },\n\n        removeMarkers: function(markers) {\n            markers.forEach((marker) => this.rtree.remove(marker));\n            this.resetLabels();\n            setTimeout(() => this.redraw(), 0);\n        },\n\n        updateMarkers: function(markers) {\n            this.removeMarkers(markers);\n            this.addMarkers(markers);\n        },\n\n        updateMarker: function(marker) {\n            this.updateMarkers([marker]);\n        },\n\n        setMarkerPosition: function(marker, latlng) {\n            this.removeMarker(marker);\n            marker.latlng = latlng;\n            this.addMarker(marker);\n        },\n\n        getMarkers: function() {\n            return this.rtree.all();\n        },\n\n        findLabelPosition: function(iconCenter, iconSize, textWidth, textHeight, pixelExtents) {\n            const\n                verticalPadding = 0,\n                xPositions = [iconCenter[0] + iconSize[0] / 2 + 2, iconCenter[0] - iconSize[0] / 2 - textWidth - 2],\n                yPositions = [\n                    iconCenter[1] - textHeight / 2 + verticalPadding,\n                    iconCenter[1] - textHeight * 0.75 - iconSize[1] / 4 + verticalPadding,\n                    iconCenter[1] - textHeight / 4 + iconSize[1] / 4 + verticalPadding,\n                    iconCenter[1] - textHeight - iconSize[1] / 2 + verticalPadding,\n                    iconCenter[1] + iconSize[1] / 2 + verticalPadding\n                ];\n\n            let minIntersectionSum = Infinity;\n            let bestX = xPositions[0],\n                bestY = yPositions[0];\n            for (let x of xPositions) {\n                for (let y of yPositions) {\n                    const rect = {minX: x, minY: y, maxX: x + textWidth, maxY: y + textHeight};\n                    if (pixelExtents && (rect.minX < pixelExtents.tileW || rect.maxX > pixelExtents.tileE ||\n                        rect.minY < pixelExtents.tileN || rect.maxY > pixelExtents.tileS)) {\n                        continue;\n                    }\n                    let intersectionSum = calcIntersectionSum(rect, this._regions.search(rect));\n                    if (intersectionSum < minIntersectionSum) {\n                        minIntersectionSum = intersectionSum;\n                        bestX = x;\n                        bestY = y;\n                        if (minIntersectionSum === 0) {\n                            break;\n                        }\n                    }\n                }\n                if (minIntersectionSum === 0) {\n                    break;\n                }\n            }\n            return [bestX, bestY];\n        },\n\n        preloadIcons: function(urls) {\n            const newUrls = urls.filter((url) => !(url in this._images));\n            if (newUrls.length) {\n                return loadImage(newUrls).then((images) => {\n                        for (let image of images) {\n                            this._images[image.src] = image;\n                        }\n                    }\n                );\n            }\n            return Promise.resolve();\n        },\n\n        createTile: function(coords, done) {\n            const canvas = L.DomUtil.create('canvas', 'leaflet-tile');\n            canvas.width = this.options.tileSize;\n            canvas.height = this.options.tileSize;\n            setTimeout(() => {\n                    this.drawTile(canvas, coords).then(() => done(null, canvas));\n                }, 0\n            );\n            return canvas;\n        },\n\n        selectMarkersForDraw: function({tileN, tileS, tileE, tileW}, zoom, withoutPadding) {\n            // FIXME: padding should depend on options.iconScale and fontSize\n            if (!this._map) {\n                return {};\n            }\n            const\n                iconsHorPad = withoutPadding ? 0 : 520,\n                iconsVertPad = withoutPadding ? 0 : 50,\n                labelsHorPad = withoutPadding ? 0 : 256,\n                labelsVertPad = withoutPadding ? 0 : 20;\n            const\n                iconsBounds = L.latLngBounds(\n                    this._map.unproject(L.point(tileW - iconsHorPad, tileS + iconsHorPad), zoom),\n                    this._map.unproject(L.point(tileE + iconsHorPad, tileN - iconsVertPad), zoom)\n                ),\n                labelsBounds = L.latLngBounds(\n                    this._map.unproject(L.point(tileW - labelsHorPad, tileS + labelsHorPad), zoom),\n                    this._map.unproject(L.point(tileE + labelsHorPad, tileN - labelsVertPad), zoom)\n                );\n            const\n                iconUrls = [],\n                markerJobs = {};\n\n            // used only to preload icons\n            const pointsForMarkers = [];\n            for (let shift of [-360, 0, 360]) {\n                pointsForMarkers.push(...this.rtree.search({\n                    minX: iconsBounds.getWest() + shift,\n                    minY: iconsBounds.getSouth(),\n                    maxX: iconsBounds.getEast() + shift,\n                    maxY: iconsBounds.getNorth()\n                }));\n            }\n\n            // used to place labels\n            const pointsForLabels = [];\n            for (let shift of [-360, 0, 360]) {\n                pointsForLabels.push(...this.rtree.search({\n                    minX: labelsBounds.getWest() + shift,\n                    minY: labelsBounds.getSouth(),\n                    maxX: labelsBounds.getEast() + shift,\n                    maxY: labelsBounds.getNorth()\n                }));\n            }\n            const tileMidLongitude = this._map.unproject([(tileE + tileW) / 2, tileN], zoom);\n\n            for (let marker of pointsForMarkers) {\n                let latlng = marker.latlng;\n                if (this.options.noWrap) {\n                    latlng = wrapLatLngToTarget(latlng, tileMidLongitude);\n                }\n                const p = this._map.project(latlng, zoom);\n                let icon = marker.icon;\n                if (typeof icon === 'function') {\n                    icon = icon(marker);\n                }\n                iconUrls.push(icon.url);\n                let markerId = L.stamp(marker);\n                markerJobs[markerId] = {marker: marker, icon: icon, projectedXY: p};\n            }\n            return {iconUrls, markerJobs, pointsForLabels};\n        },\n\n        drawSelectedMarkers: function(canvas, pixelExtents, markerJobs, pointsForLabels, zoom, limitLabelsToImage) {\n            const {tileN, tileW, tileS, tileE} = pixelExtents;\n            const textHeight = this.options.labelFontSize * this.options.iconScale;\n            if (this._labelPositionsZoom !== zoom) {\n                this._labelPositionsZoom = zoom;\n                this.resetLabels();\n            }\n            const ctx = canvas.getContext('2d');\n            ctx.font = L.Util.template('bold {size}px {name}',\n                {name: this.options.labelFontName, size: this.options.labelFontSize * this.options.iconScale}\n            );\n            for (let [markerId, job] of Object.entries(markerJobs)) {\n                let img = this._images[job.icon.url];\n                job.img = img;\n                const imgW = Math.round(img.width * this.options.iconScale);\n                const imgH = Math.round(img.height * this.options.iconScale);\n                if (!(markerId in this._iconPositions)) {\n                    let x = job.projectedXY.x - job.icon.center[0] * this.options.iconScale;\n                    let y = job.projectedXY.y - job.icon.center[1] * this.options.iconScale;\n                    x = Math.round(x);\n                    y = Math.round(y);\n                    this._iconPositions[markerId] = [x, y];\n                    this._regions.insert({\n                        minX: x,\n                        minY: y,\n                        maxX: x + imgW,\n                        maxY: y + imgH,\n                        marker: job.marker,\n                        isLabel: false\n                    });\n                }\n                let [x, y] = this._iconPositions[markerId];\n                job.iconCenter = [x + imgW / 2, y + imgH / 2];\n                job.iconSize = [imgW, imgH];\n            }\n            for (let marker of pointsForLabels) {\n                const markerId = L.stamp(marker);\n                const job = markerJobs[markerId];\n                let label = job.marker.label;\n                if (typeof label === 'function') {\n                    label = label(job.marker, zoom);\n                }\n                if (label) {\n                    job.label = label;\n                    if (!(markerId in this._labelPositions)) {\n                        const textWidth = ctx.measureText(label).width;\n                        const p = this.findLabelPosition(job.iconCenter, job.iconSize, textWidth, textHeight,\n                            limitLabelsToImage ? pixelExtents : null);\n                        this._labelPositions[markerId] = p;\n                        let [x, y] = p;\n                        this._regions.insert({\n                            minX: x,\n                            minY: y,\n                            maxX: x + textWidth,\n                            maxY: y + textHeight,\n                            marker: job.marker,\n                            isLabel: true\n                        });\n                    }\n                } else {\n                    this._labelPositions[markerId] = null;\n                }\n            }\n\n            const regionsInTile = this._regions.search({minX: tileW, minY: tileN, maxX: tileE, maxY: tileS});\n            // draw labels\n            for (let region of regionsInTile) {\n                if (region.isLabel) {\n                    // TODO: set font name ant size in options\n                    const markerId = L.stamp(region.marker);\n                    const job = markerJobs[markerId];\n                    const p = this._labelPositions[markerId];\n                    const x = p[0] - tileW;\n                    const y = p[1] - tileN;\n                    ctx.textBaseline = 'bottom';\n                    ctx.shadowColor = '#fff';\n                    ctx.strokeStyle = '#fff';\n                    ctx.fillStyle = '#000';\n                    ctx.lineWidth = 1.2 * this.options.iconScale;\n                    ctx.shadowBlur = this.options.labelShadowWidth * this.options.iconScale;\n                    ctx.strokeText(job.label, x, y + textHeight);\n                    ctx.shadowBlur = 0;\n                    ctx.fillText(job.label, x, y + textHeight);\n                }\n            }\n            ctx.globalAlpha = this.options.iconsOpacity;\n            // draw icons\n            for (let region of regionsInTile) {\n                if (!region.isLabel) {\n                    const markerId = L.stamp(region.marker);\n                    const job = markerJobs[markerId];\n                    const p = this._iconPositions[markerId];\n                    const x = p[0] - tileW;\n                    const y = p[1] - tileN;\n                    ctx.drawImage(job.img, x, y, job.iconSize[0], job.iconSize[1]);\n                }\n            }\n            ctx.globalAlpha = 1;\n        },\n\n        drawTile: async function(canvas, coords) {\n            const\n                zoom = coords.z,\n                tileSize = this.options.tileSize,\n                tileN = coords.y * tileSize,\n                tileW = coords.x * tileSize,\n                tileS = tileN + tileSize,\n                tileE = tileW + tileSize;\n            const pixelExtents = {tileN, tileS, tileE, tileW};\n            const {iconUrls, markerJobs, pointsForLabels} = this.selectMarkersForDraw(pixelExtents, zoom);\n            if (!markerJobs) {\n                return;\n            }\n            await this.preloadIcons(iconUrls);\n            this.drawSelectedMarkers(canvas, pixelExtents, markerJobs, pointsForLabels, zoom);\n        },\n\n        resetLabels: function() {\n            this._iconPositions = {};\n            this._labelPositions = {};\n            this._regions.clear();\n        },\n\n        findMarkerFromMouseEvent: function(e) {\n            const\n                p = this._map.project(e.latlng.wrap()),\n                region = this._regions.search({minX: p.x, minY: p.y, maxX: p.x, maxY: p.y})[0];\n            let marker;\n            if (region) {\n                marker = region.marker;\n            } else {\n                marker = null;\n            }\n            return marker;\n        },\n\n        onMouseMove: function(e) {\n            const marker = this.findMarkerFromMouseEvent(e);\n            if (this._hoverMarker !== marker) {\n                if (this._hoverMarker) {\n                    this.fire('markerleave', {marker: this._hoverMarker});\n                }\n                if (marker) {\n                    this.fire('markerenter', {marker: marker});\n                }\n                this._hoverMarker = marker;\n            }\n        },\n\n        showTooltip: function(e) {\n            if (!e.marker.tooltip) {\n                return;\n            }\n            let text = e.marker.tooltip;\n            if (typeof text === 'function') {\n                text = text(e.marker);\n                if (!e.marker.tooltip) {\n                    return;\n                }\n            }\n            this.toolTip.innerHTML = text;\n            const p = this._map.latLngToLayerPoint(e.marker.latlng);\n            L.DomUtil.setPosition(this.toolTip, p);\n            L.DomUtil.addClass(this.toolTip, 'canvas-marker-tooltip-on');\n        },\n\n        onMarkerEnter: function(e) {\n            this._map._container.style.cursor = 'pointer';\n            this.showTooltip(e);\n        },\n\n        onMarkerLeave: function() {\n            this._map._container.style.cursor = '';\n            L.DomUtil.removeClass(this.toolTip, 'canvas-marker-tooltip-on');\n        },\n\n        onMouseOut: function() {\n            if (this._hoverMarker) {\n                const marker = this._hoverMarker;\n                this._hoverMarker = null;\n                this.fire('markerleave', {marker});\n            }\n        },\n\n        onClick: function(e) {\n            if (this._map.clickLocked) {\n                return;\n            }\n            const marker = this.findMarkerFromMouseEvent(e);\n            if (marker) {\n                L.extend(e, {marker: marker});\n                this.fire('markerclick', e);\n            }\n        },\n\n        onRightClick: function(e) {\n            const marker = this.findMarkerFromMouseEvent(e);\n            if (marker) {\n                L.extend(e, {marker: marker});\n                this.fire('markercontextmenu', e);\n            }\n        },\n\n        onAdd: function(map) {\n            if (this.options.pane === 'rasterMarker' && !map.getPane('rasterMarker')) {\n                map.createPane('rasterMarker').style.zIndex = 550;\n            }\n            L.GridLayer.prototype.onAdd.call(this, map);\n            map.on('mousemove', this.onMouseMove, this);\n            map.on('mouseout', this.onMouseOut, this);\n            map.on('click', this.onClick, this);\n            map.on('contextmenu', this.onRightClick, this);\n            this.toolTip = L.DomUtil.create('div', 'canvas-marker-tooltip', this._map.getPanes().markerPane);\n        },\n\n        onRemove: function(map) {\n            this._map.off('mousemove', this.onMouseMove, this);\n            this._map.off('mouseout', this.onMouseOut, this);\n            this._map.off('click', this.onClick, this);\n            this._map.off('contextmenu', this.onRightClick, this);\n            if (this._hoverMarker) {\n                this._hoverMarker = null;\n                this.fire('markerleave', {marker: this._hoverMarker});\n            }\n            this._map.getPanes().markerPane.removeChild(this.toolTip);\n            L.GridLayer.prototype.onRemove.call(this, map);\n        }\n    }\n);\n","import L from 'leaflet';\n\nfunction shiftLongitudeToTarget(lng, targetLng) {\n    if (targetLng instanceof L.LatLngBounds) {\n        if (!targetLng.isValid()) {\n            return 0;\n        }\n        targetLng = targetLng.getCenter().lng;\n    } else {\n        targetLng = targetLng.lng ?? targetLng;\n    }\n    let shift = 0;\n    if (Math.abs(lng + 360 - targetLng) < Math.abs(lng - targetLng)) {\n        shift = 360;\n    } else if (Math.abs(lng - 360 - targetLng) < Math.abs(lng - targetLng)) {\n        shift = -360;\n    }\n    return shift;\n}\n\nfunction wrapLatLngToTarget(latLng, targetLng) {\n    const shift = shiftLongitudeToTarget(latLng.lng, targetLng);\n    return L.latLng(latLng.lat, latLng.lng + shift);\n}\n\nfunction wrapLatLngBoundsToTarget(latLngBounds, targetLng) {\n    const shift = shiftLongitudeToTarget(latLngBounds.getCenter().lng, targetLng);\n    const p1 = latLngBounds.getSouthEast();\n    const p2 = latLngBounds.getNorthWest();\n    return L.latLngBounds([[p1.lat, p1.lng + shift], [p2.lat, p2.lng + shift]]);\n}\n\nfunction fixVectorMarkerWorldJump() {\n    L.Polyline.prototype.shiftProjectedFitMapView = function() {\n        const polylineBounds = this.getBounds();\n        let shift = null;\n        if (this._map && polylineBounds.isValid()) {\n            const worldWidth = this._map.getPixelWorldBounds().getSize().x;\n            const polylineCenter = polylineBounds.getCenter();\n            const mapCenter = this._map.getCenter();\n\n            if (polylineCenter.lng < mapCenter.lng - 180) {\n                shift = worldWidth;\n            } else if (polylineCenter.lng > mapCenter.lng + 180) {\n                shift = -worldWidth;\n            } else {\n                shift = 0;\n            }\n        }\n        return shift;\n    };\n\n    // Shift line points longitude by +360 or -360, to minimize distance between line center and map view center\n    // Longitude is changed only for display, longitude of pints is not changed\n    // Breaks dipslay of lines spanning more then one world copy\n    L.Polyline.prototype._projectLatlngs = function(latlngs, result, projectedBounds) {\n        var flat = latlngs[0] instanceof L.LatLng,\n            len = latlngs.length,\n            i, ring;\n        let shift = null;\n        if (this.options.projectedShift) {\n            shift = this.options.projectedShift();\n        }\n        if (shift === null) {\n            shift = this.shiftProjectedFitMapView();\n        }\n\n        if (flat) {\n            ring = [];\n            for (i = 0; i < len; i++) {\n                let p = this._map.latLngToLayerPoint(latlngs[i]);\n                p.x += shift;\n                ring[i] = p;\n                projectedBounds.extend(p);\n            }\n            result.push(ring);\n        } else {\n            for (i = 0; i < len; i++) {\n                this._projectLatlngs(latlngs[i], result, projectedBounds);\n            }\n        }\n    };\n\n    // Shift marker longitude by +360 or -360, which is closer to map view center\n    // Longitude is changed only for positioning html-element, Marker._latlng is not changed\n    // Breaks display of markers with huge longitudes like 750 (can be displayed only at zoom levels 0 or 1)\n    L.Marker.prototype.update = function() {\n        if (this._icon) {\n            var pos = this._map.latLngToLayerPoint(this._latlng).round();\n            let shift = null;\n            if (this.options.projectedShift) {\n                shift = this.options.projectedShift();\n            }\n            if (shift === null) {\n                const mapCenter = this._map.getCenter();\n                const worldWidth = this._map.getPixelWorldBounds().getSize().x;\n                if (this._latlng.lng < mapCenter.lng - 180) {\n                    shift = worldWidth;\n                } else if (this._latlng.lng > mapCenter.lng + 180) {\n                    shift = -worldWidth;\n                } else {\n                    shift = 0;\n                }\n            }\n            pos.x += shift;\n            this._setPos(pos);\n        }\n\n        return this;\n    };\n\n    // Emit viewreset event when longitude of map view center changes more then 90 degrees from prevoius reset\n    L.Map.addInitHook(function() {\n        this._lastResetLongitude = null;\n        this.on('viewreset', () => {\n            this._lastResetLongitude = this.getCenter().lng;\n        });\n\n        this.on('move', () => {\n            const lng = this.getCenter().lng;\n            if (this._lastResetLongitude === null) {\n                this._lastResetLongitude = lng;\n            } else if (Math.abs(lng - this._lastResetLongitude) > 90) {\n                this.fire('viewreset');\n            }\n        });\n    });\n\n    // Avoid marker longitude change from 180 to -180 while dragging.\n    L.Handler.MarkerDrag = L.Handler.extend({\n        _onDrag: function(e) {\n            var marker = this._marker,\n                shadow = marker._shadow,\n                iconPos = L.DomUtil.getPosition(marker._icon),\n                latlng = marker._map.layerPointToLatLng(iconPos);\n            // update shadow position\n            if (shadow) {\n                L.DomUtil.setPosition(shadow, iconPos);\n            }\n\n            latlng = wrapLatLngToTarget(latlng, marker._latlng);\n            marker._latlng = latlng;\n            e.latlng = latlng;\n            e.oldLatLng = this._oldLatLng;\n\n            // @event drag: Event\n            // Fired repeatedly while the user drags the marker.\n            marker\n                .fire('move', e)\n                .fire('drag', e);\n        }\n    });\n}\n\nexport {wrapLatLngToTarget, fixVectorMarkerWorldJump, wrapLatLngBoundsToTarget};\n","/* FileSaver.js\n * A saveAs() FileSaver implementation.\n * 1.3.8\n * 2018-03-22 14:03:47\n *\n * By Eli Grey, https://eligrey.com\n * License: MIT\n *   See https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md\n */\n\n/*global self */\n/*jslint bitwise: true, indent: 4, laxbreak: true, laxcomma: true, smarttabs: true, plusplus: true */\n\n/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/src/FileSaver.js */\n\nexport var saveAs = saveAs || (function(view) {\n        \"use strict\";\n        // IE <10 is explicitly unsupported\n        if (typeof view === \"undefined\" || typeof navigator !== \"undefined\" && /MSIE [1-9]\\./.test(navigator.userAgent)) {\n            return;\n        }\n        var\n            doc = view.document\n            // only get URL when necessary in case Blob.js hasn't overridden it yet\n            , get_URL = function() {\n                return view.URL || view.webkitURL || view;\n            }\n            , save_link = doc.createElementNS(\"http://www.w3.org/1999/xhtml\", \"a\")\n            , can_use_save_link = \"download\" in save_link\n            , click = function(node) {\n                var event = new MouseEvent(\"click\");\n                node.dispatchEvent(event);\n            }\n            , is_safari = /constructor/i.test(view.HTMLElement) || view.safari\n            , is_chrome_ios =/CriOS\\/[\\d]+/.test(navigator.userAgent)\n            , setImmediate = view.setImmediate || view.setTimeout\n            , throw_outside = function(ex) {\n                setImmediate(function() {\n                    throw ex;\n                }, 0);\n            }\n            , force_saveable_type = \"application/octet-stream\"\n            // the Blob API is fundamentally broken as there is no \"downloadfinished\" event to subscribe to\n            , arbitrary_revoke_timeout = 1000 * 40 // in ms\n            , revoke = function(file) {\n                var revoker = function() {\n                    if (typeof file === \"string\") { // file is an object URL\n                        get_URL().revokeObjectURL(file);\n                    } else { // file is a File\n                        file.remove();\n                    }\n                };\n                setTimeout(revoker, arbitrary_revoke_timeout);\n            }\n            , dispatch = function(filesaver, event_types, event) {\n                event_types = [].concat(event_types);\n                var i = event_types.length;\n                while (i--) {\n                    var listener = filesaver[\"on\" + event_types[i]];\n                    if (typeof listener === \"function\") {\n                        try {\n                            listener.call(filesaver, event || filesaver);\n                        } catch (ex) {\n                            throw_outside(ex);\n                        }\n                    }\n                }\n            }\n            , auto_bom = function(blob) {\n                // prepend BOM for UTF-8 XML and text/* types (including HTML)\n                // note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\n                if (/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n                    return new Blob([String.fromCharCode(0xFEFF), blob], {type: blob.type});\n                }\n                return blob;\n            }\n            , FileSaver = function(blob, name, no_auto_bom) {\n                if (!no_auto_bom) {\n                    blob = auto_bom(blob);\n                }\n                // First try a.download, then web filesystem, then object URLs\n                var\n                    filesaver = this\n                    , type = blob.type\n                    , force = type === force_saveable_type\n                    , object_url\n                    , dispatch_all = function() {\n                        dispatch(filesaver, \"writestart progress write writeend\".split(\" \"));\n                    }\n                    // on any filesys errors revert to saving with object URLs\n                    , fs_error = function() {\n                        if ((is_chrome_ios || (force && is_safari)) && view.FileReader) {\n                            // Safari doesn't allow downloading of blob urls\n                            var reader = new FileReader();\n                            reader.onloadend = function() {\n                                var url = is_chrome_ios ? reader.result : reader.result.replace(/^data:[^;]*;/, 'data:attachment/file;');\n                                var popup = view.open(url, '_blank');\n                                if(!popup) view.location.href = url;\n                                url=undefined; // release reference before dispatching\n                                filesaver.readyState = filesaver.DONE;\n                                dispatch_all();\n                            };\n                            reader.readAsDataURL(blob);\n                            filesaver.readyState = filesaver.INIT;\n                            return;\n                        }\n                        // don't create more object URLs than needed\n                        if (!object_url) {\n                            object_url = get_URL().createObjectURL(blob);\n                        }\n                        if (force) {\n                            view.location.href = object_url;\n                        } else {\n                            var opened = view.open(object_url, \"_blank\");\n                            if (!opened) {\n                                // Apple does not allow window.open, see https://developer.apple.com/library/safari/documentation/Tools/Conceptual/SafariExtensionGuide/WorkingwithWindowsandTabs/WorkingwithWindowsandTabs.html\n                                view.location.href = object_url;\n                            }\n                        }\n                        filesaver.readyState = filesaver.DONE;\n                        dispatch_all();\n                        revoke(object_url);\n                    }\n                    ;\n                filesaver.readyState = filesaver.INIT;\n\n                if (can_use_save_link) {\n                    object_url = get_URL().createObjectURL(blob);\n                    setImmediate(function() {\n                        save_link.href = object_url;\n                        save_link.download = name;\n                        save_link.target = '_self';\n                        click(save_link);\n                        dispatch_all();\n                        revoke(object_url);\n                        filesaver.readyState = filesaver.DONE;\n                    }, 0);\n                    return;\n                }\n\n                fs_error();\n            }\n            , FS_proto = FileSaver.prototype\n            , saveAs = function(blob, name, no_auto_bom) {\n                return new FileSaver(blob, name || blob.name || \"download\", no_auto_bom);\n            }\n            ;\n\n        // IE 10+ (native saveAs)\n        if (typeof navigator !== \"undefined\" && navigator.msSaveOrOpenBlob) {\n            return function(blob, name, no_auto_bom) {\n                name = name || blob.name || \"download\";\n\n                if (!no_auto_bom) {\n                    blob = auto_bom(blob);\n                }\n                return navigator.msSaveOrOpenBlob(blob, name);\n            };\n        }\n\n        // todo: detect chrome extensions & packaged apps\n        //save_link.target = \"_blank\";\n\n        FS_proto.abort = function(){};\n        FS_proto.readyState = FS_proto.INIT = 0;\n        FS_proto.WRITING = 1;\n        FS_proto.DONE = 2;\n\n        FS_proto.error =\n            FS_proto.onwritestart =\n                FS_proto.onprogress =\n                    FS_proto.onwrite =\n                        FS_proto.onabort =\n                            FS_proto.onerror =\n                                FS_proto.onwriteend =\n                                    null;\n\n        return saveAs;\n    }(\n        typeof self !== \"undefined\" && self\n        || typeof window !== \"undefined\" && window\n        || this\n    ));\n","import L from 'leaflet';\nimport ko from 'knockout';\nimport Contextmenu from '~/lib/contextmenu';\nimport '~/lib/knockout.component.progress/progress';\nimport './track-list.css';\nimport {selectFiles, readFiles} from '~/lib/file-read';\nimport parseGeoFile from './lib/parseGeoFile';\nimport loadFromUrl from './lib/loadFromUrl';\nimport * as geoExporters from './lib/geo_file_exporters';\nimport copyToClipboard from '~/lib/clipboardCopy';\nimport {saveAs} from '~/vendored/github.com/eligrey/FileSaver';\nimport '~/lib/leaflet.layer.canvasMarkers';\nimport '~/lib/leaflet.lineutil.simplifyLatLngs';\nimport iconFromBackgroundImage from '~/lib/iconFromBackgroundImage';\nimport '~/lib/controls-styles/controls-styles.css';\nimport {ElevationProfile, calcSamplingInterval} from '~/lib/leaflet.control.elevation-profile';\nimport '~/lib/leaflet.control.commons';\nimport {blobFromString} from '~/lib/binary-strings';\nimport '~/lib/leaflet.polyline-edit';\nimport '~/lib/leaflet.polyline-measure';\nimport * as logging from '~/lib/logging';\nimport {notify, query} from '~/lib/notifications';\nimport {fetch} from '~/lib/xhr-promise';\nimport config from '~/config';\nimport md5 from 'blueimp-md5';\nimport {wrapLatLngToTarget, wrapLatLngBoundsToTarget} from '~/lib/leaflet.fixes/fixWorldCopyJump';\nimport {splitLinesAt180Meridian} from \"./lib/meridian180\";\nimport {ElevationProvider} from '~/lib/elevations';\n\nconst TRACKLIST_TRACK_COLORS = ['#77f', '#f95', '#0ff', '#f77', '#f7f', '#ee5'];\n\nconst TrackSegment = L.MeasuredLine.extend({\n    includes: L.Polyline.EditMixin,\n\n    options: {\n        weight: 6,\n        lineCap: 'round',\n        opacity: 0.5,\n\n    }\n});\nTrackSegment.mergeOptions(L.Polyline.EditMixinOptions);\n\nfunction unwrapLatLngsCrossing180Meridian(latngs) {\n    if (latngs.length === 0) {\n        return [];\n    }\n    const unwrapped = [latngs[0]];\n    let lastUnwrapped;\n    let prevUnwrapped = latngs[0];\n    for (let i = 1; i < latngs.length; i++) {\n        lastUnwrapped = wrapLatLngToTarget(latngs[i], prevUnwrapped);\n        unwrapped.push(lastUnwrapped);\n        prevUnwrapped = lastUnwrapped;\n    }\n    return unwrapped;\n}\n\nfunction closestPointToLineSegment(latlngs, segmentIndex, point) {\n    const crs = L.CRS.EPSG3857;\n    point = crs.latLngToPoint(point);\n    const segStart = crs.latLngToPoint(latlngs[segmentIndex]);\n    const segEnd = crs.latLngToPoint(latlngs[segmentIndex + 1]);\n    return crs.pointToLatLng(L.LineUtil.closestPointOnSegment(point, segStart, segEnd));\n}\n\nfunction isPointCloserToStart(latlngs, latlng) {\n    const distToStart = latlng.distanceTo(latlngs[0]);\n    const distToEnd = latlng.distanceTo(latlngs[latlngs.length - 1]);\n    return distToStart < distToEnd;\n}\n\nL.Control.TrackList = L.Control.extend({\n        options: {\n            position: 'bottomright',\n            lineCursorStyle: {interactive: false, weight: 1.5, opacity: 1, dashArray: '7,7'},\n            lineCursorValidStyle: {color: 'green'},\n            lineCursorInvalidStyle: {color: 'red'},\n            splitExtensions: ['gpx', 'kml', 'kmz', 'wpt', 'rte', 'plt', 'fit', 'tmp', 'jpg', 'crdownload'],\n            splitExtensionsFirstStage: ['xml', 'txt', 'html', 'php', 'tmp', 'gz'],\n        },\n        includes: L.Evented,\n\n        colors: TRACKLIST_TRACK_COLORS,\n\n        initialize: function() {\n            L.Control.prototype.initialize.call(this);\n            this.tracks = ko.observableArray();\n            this.url = ko.observable('');\n            this.readingFiles = ko.observable(0);\n            this.readProgressRange = ko.observable();\n            this.readProgressDone = ko.observable();\n            this._lastTrackColor = 0;\n            this.trackListHeight = ko.observable(0);\n            this.isPlacingPoint = false;\n            this.trackAddingPoint = ko.observable(null);\n            this.trackAddingSegment = ko.observable(null);\n        },\n\n        onAdd: function(map) {\n            this.map = map;\n            this.tracks.removeAll();\n            var container = this._container = L.DomUtil.create('div', 'leaflet-control leaflet-control-tracklist');\n            this._stopContainerEvents();\n\n            /* eslint-disable max-len */\n            container.innerHTML = `\n                <div class=\"leaflet-control-button-toggle\" data-bind=\"click: setExpanded\"\n                 title=\"Load, edit and save tracks\"></div>\n                <div class=\"leaflet-control-content\">\n                <div class=\"header\">\n                    <div class=\"hint\"\n                     title=\"gpx kml Ozi zip YandexMaps GPSies Strava GPSLib Endomondo Etomesto Movescount GarminConnect SportsTracker OSM Tracedetrail OpenStreetMap.ru\">\n                        gpx kml Ozi zip YandexMaps GPSies Strava\n                        <span class=\"formats-hint-more\">&hellip;</span>\n                    </div>\n                    <div class=\"button-minimize\" data-bind=\"click: setMinimized\"></div>\n                </div>\n                <div class=\"inputs-row\" data-bind=\"visible: !readingFiles()\">\n                    <a class=\"button add-track\" title=\"Создать новый трэк\" data-bind=\"click: onButtonNewTrackClicked\"></a\n                    ><a class=\"button open-file\" title=\"Открыть файл с трэком\" data-bind=\"click: loadFilesFromDisk\"></a\n                    ><input type=\"text\" class=\"input-url\" placeholder=\"URL трэка\"\n                        data-bind=\"textInput: url, event: {keypress: onEnterPressedInInput, contextmenu: defaultEventHandle, mousemove: defaultEventHandle}\"\n                    ><a class=\"button download-url\" title=\"Загрузить трэк по URL\" data-bind=\"click: loadFilesFromUrl\"></a\n                    ><a class=\"button menu-icon\" data-bind=\"click: function(_,e){this.showMenu(e)}\" title=\"Меню\"></a>\n                </div>\n                <div style=\"text-align: center\">\n                    <div data-bind=\"\n                        component: {\n                        name: 'progress-indicator',\n                        params: {progressRange: readProgressRange, progressDone: readProgressDone}\n                        },\n                        visible: readingFiles\"></div>\n                </div>\n                <div class=\"tracks-rows-wrapper\" data-bind=\"style: {maxHeight: trackListHeight}\">\n                <table class=\"tracks-rows\"><tbody data-bind=\"foreach: {data: tracks, as: 'track'}\">\n                    <tr data-bind=\"event: {\n                                       contextmenu: $parent.showTrackMenu.bind($parent),\n                                       mouseenter: $parent.onTrackRowMouseEnter.bind($parent, track),\n                                       mouseleave: $parent.onTrackRowMouseLeave.bind($parent, track)\n                                   },\n                                   css: {hover: hover() && $parent.tracks().length > 1, edit: isEdited() && $parent.tracks().length > 1}\">\n                        <td><input type=\"checkbox\" class=\"visibility-switch\" data-bind=\"checked: track.visible\"></td>\n                        <td><div class=\"color-sample\" data-bind=\"style: {backgroundColor: $parent.colors[track.color()]}, click: $parent.onColorSelectorClicked.bind($parent)\"></div></td>\n                        <td><div class=\"track-name-wrapper\"><div class=\"track-name\" data-bind=\"text: track.name, attr: {title: track.name}, click: $parent.setViewToTrack.bind($parent)\"></div></div></td>\n                        <td>\n                            <div class=\"button-length\" title=\"Show distance marks\" data-bind=\"\n                                text: $parent.formatLength(track.length()),\n                                css: {'ticks-enabled': track.measureTicksShown},\n                                click: $parent.switchMeasureTicksVisibility.bind($parent)\"></div>\n                        </td>\n                        <td><div class=\"button-add-track\" title=\"Добавить сегмент\" data-bind=\"click: $parent.onButtonAddSegmentClicked.bind($parent, track), css: {active: $parent.trackAddingSegment() === track}\"></div></td>\n                        <td><div class=\"button-add-point\" title=\"Добавить метку\" data-bind=\"click: $parent.onButtonAddPointClicked.bind($parent, track), css: {active: $parent.trackAddingPoint() === track}\"></div></td>\n                        <td><a class=\"track-text-button\" title=\"Действия\" data-bind=\"click: $parent.showTrackMenu.bind($parent)\">&hellip;</a></td>\n                    </tr>\n                </tbody></table>\n                </div>\n                </div>\n            `;\n            /* eslint-enable max-len */\n\n            ko.applyBindings(this, container);\n            // FIXME: add onRemove method and unsubscribe\n            L.DomEvent.addListener(map.getContainer(), 'drop', this.onFileDragDrop, this);\n            L.DomEvent.addListener(map.getContainer(), 'dragover', this.onFileDraging, this);\n            this.menu = new Contextmenu([\n                    {text: 'Копировать ссылку на все трэки', callback: this.copyAllTracksToClipboard.bind(this)},\n                    {text: 'Копировать ссылку на видимые трэки', callback: this.copyVisibleTracks.bind(this)},\n                    '-',\n                    {text: 'Удалить все трэки', callback: this.deleteAllTracks.bind(this)},\n                    {text: 'Удалить скрытые трэки', callback: this.deleteHiddenTracks.bind(this)}\n                ]\n            );\n            this._markerLayer = new L.Layer.CanvasMarkers(null, {\n                print: true,\n                scaleDependent: true,\n                zIndex: 1000,\n                printTransparent: true\n            }).addTo(map);\n            this._markerLayer.on('markerclick markercontextmenu', this.onMarkerClick, this);\n            this._markerLayer.on('markerenter', this.onMarkerEnter, this);\n            this._markerLayer.on('markerleave', this.onMarkerLeave, this);\n            map.on('resize', this._setAdaptiveHeight, this);\n            setTimeout(() => this._setAdaptiveHeight(), 0);\n            return container;\n        },\n\n        defaultEventHandle: function(_, e) {\n            L.DomEvent.stopPropagation(e);\n            return true;\n        },\n\n        _setAdaptiveHeight: function() {\n            const mapHeight = this._map.getSize().y;\n            let maxHeight;\n            maxHeight =\n                mapHeight -\n                this._container.offsetTop - // controls above\n                // controls below\n                (this._container.parentNode.offsetHeight - this._container.offsetTop - this._container.offsetHeight) -\n                105; // margin\n            this.trackListHeight(maxHeight + 'px');\n        },\n\n        setExpanded: function() {\n            L.DomUtil.removeClass(this._container, 'minimized');\n        },\n\n        setMinimized: function() {\n            L.DomUtil.addClass(this._container, 'minimized');\n        },\n\n        onFileDraging: function(e) {\n            L.DomEvent.stopPropagation(e);\n            L.DomEvent.preventDefault(e);\n            e.dataTransfer.dropEffect = 'copy';\n        },\n\n        onFileDragDrop: function(e) {\n            L.DomEvent.stopPropagation(e);\n            L.DomEvent.preventDefault(e);\n            const files = e.dataTransfer.files;\n            if (files && files.length) {\n                this.loadFilesFromFilesObject(files);\n            }\n        },\n\n        onEnterPressedInInput: function(this_, e) {\n            if (e.keyCode === 13) {\n                this_.loadFilesFromUrl();\n                L.DomEvent.stop(e);\n                return false;\n            }\n            return true;\n        },\n\n        getTrackPolylines: function(track) {\n            return track.feature.getLayers().filter(function(layer) {\n                    return layer instanceof L.Polyline;\n                }\n            );\n        },\n\n        getTrackPoints: function(track) {\n            return track.markers;\n        },\n\n        onButtonNewTrackClicked: function() {\n            let name = this.url().trim();\n            if (name.length > 0) {\n                this.url('');\n            } else {\n                name = 'Новый трэк';\n            }\n            this.addTrackAndEdit(name);\n        },\n\n        addSegmentAndEdit: function(track) {\n            this.stopPlacingPoint();\n            const segment = this.addTrackSegment(track);\n            this.startEditTrackSegement(segment);\n            segment.startDrawingLine();\n            this.trackAddingSegment(track);\n        },\n\n        addTrackAndEdit: function(name) {\n            const track = this.addTrack({name: name});\n            this.addSegmentAndEdit(track);\n            return track;\n        },\n\n        loadFilesFromFilesObject: function(files) {\n            this.readingFiles(this.readingFiles() + 1);\n\n            readFiles(files).then(function(fileDataArray) {\n                const geodataArray = [];\n                for (let fileData of fileDataArray) {\n                        geodataArray.push(...parseGeoFile(fileData.filename, fileData.data));\n                }\n                this.readingFiles(this.readingFiles() - 1);\n\n                this.addTracksFromGeodataArray(geodataArray);\n            }.bind(this));\n        },\n\n        loadFilesFromDisk: function() {\n            logging.captureBreadcrumb('load track from disk');\n            selectFiles(true).then(this.loadFilesFromFilesObject.bind(this));\n        },\n\n        loadFilesFromUrl: function() {\n            var url = this.url().trim();\n            if (!url) {\n                return;\n            }\n\n            this.readingFiles(this.readingFiles() + 1);\n\n            logging.captureBreadcrumb('load track from url', {trackUrl: url});\n            loadFromUrl(url)\n                .then((geodata) => {\n                    this.addTracksFromGeodataArray(geodata);\n                    this.readingFiles(this.readingFiles() - 1);\n                });\n            this.url('');\n        },\n\n        whenLoadDone: function(cb) {\n            if (this.readingFiles() === 0) {\n                cb();\n                return;\n            }\n            const subscription = this.readingFiles.subscribe((value) => {\n                if (value === 0) {\n                    subscription.dispose();\n                    cb();\n                }\n            });\n        },\n\n        addTracksFromGeodataArray: function(geodata_array) {\n            let hasData = false;\n            var messages = [];\n            if (geodata_array.length === 0) {\n                messages.push('No tracks loaded');\n            }\n            geodata_array.forEach(function(geodata) {\n                    var data_empty = !((geodata.tracks && geodata.tracks.length) ||\n                        (geodata.points && geodata.points.length));\n\n                    if (!data_empty) {\n                        if (geodata.tracks) {\n                            geodata.tracks = geodata.tracks.map(function(line) {\n                                    line = unwrapLatLngsCrossing180Meridian(line);\n                                    line = L.LineUtil.simplifyLatlngs(line, 360 / (1 << 24));\n                                    if (line.length === 1) {\n                                        line.push(line[0]);\n                                    }\n                                    return line;\n                                }\n                            );\n                        }\n                        hasData = true;\n                        this.addTrack(geodata);\n                    }\n                    var error_messages = {\n                        CORRUPT: 'File \"{name}\" is corrupt',\n                        UNSUPPORTED: 'File \"{name}\" has unsupported format or is badly corrupt',\n                        NETWORK: 'Could not download file from url \"{name}\"',\n                        INVALID_URL: '\"{name}\"  is not of supported URL type',\n                    };\n                    var message;\n                    if (geodata.error) {\n                        message = error_messages[geodata.error] || geodata.error;\n                        if (data_empty) {\n                            message += ', no data could be loaded';\n                        } else {\n                            message += ', loaded data can be invalid or incomplete';\n                        }\n                    }\n                    if (message) {\n                        message = L.Util.template(message, {name: geodata.name});\n                        messages.push(message);\n                    }\n                }.bind(this)\n            );\n            if (messages.length) {\n                notify(messages.join('\\n'));\n            }\n            return hasData;\n        },\n\n        onTrackColorChanged: function(track) {\n            var color = this.colors[track.color()];\n            this.getTrackPolylines(track).forEach(\n                function(polyline) {\n                    polyline.setStyle({color: color});\n                }\n            );\n            var markers = this.getTrackPoints(track);\n            markers.forEach(this.setMarkerIcon.bind(this));\n            this._markerLayer.updateMarkers(markers);\n        },\n\n        onTrackVisibilityChanged: function(track) {\n            if (track.visible()) {\n                this.map.addLayer(track.feature);\n                this._markerLayer.addMarkers(track.markers);\n            } else {\n                if (this.trackAddingPoint() === track) {\n                    this.stopPlacingPoint();\n                }\n                this.map.removeLayer(track.feature);\n                this._markerLayer.removeMarkers(track.markers);\n            }\n            this.updateTrackHighlight();\n        },\n\n        onTrackSegmentNodesChanged: function(track, segment) {\n            if (segment.getFixedLatLngs().length > 0) {\n                this.trackAddingSegment(null);\n            }\n            this.recalculateTrackLength(track);\n        },\n\n        recalculateTrackLength: function(track) {\n            const lines = this.getTrackPolylines(track);\n            let length = 0;\n            for (let line of lines) {\n                length += line.getLength();\n            }\n            track.length(length);\n        },\n\n        formatLength: function(x) {\n            var digits = 0;\n            if (x < 10000) {\n                digits = 2;\n            } else if (x < 100000) {\n                digits = 1;\n            }\n            return (x / 1000).toFixed(digits) + ' km';\n        },\n\n        setTrackMeasureTicksVisibility: function(track) {\n            var visible = track.measureTicksShown(),\n                lines = this.getTrackPolylines(track);\n            lines.forEach((line) => line.setMeasureTicksVisible(visible));\n        },\n\n        switchMeasureTicksVisibility: function(track) {\n            track.measureTicksShown(!(track.measureTicksShown()));\n        },\n\n        onColorSelectorClicked: function(track, e) {\n            track._contextmenu.show(e);\n        },\n\n        setViewToTrack: function(track) {\n            this.setViewToBounds(this.getTrackBounds(track));\n        },\n\n        setViewToAllTracks: function(immediate) {\n            const bounds = L.latLngBounds([]);\n            for (let track of this.tracks()) {\n                bounds.extend(this.getTrackBounds(track));\n            }\n            this.setViewToBounds(bounds, immediate);\n        },\n\n        setViewToBounds: function(bounds, immediate) {\n            if (bounds && bounds.isValid()) {\n                bounds = wrapLatLngBoundsToTarget(bounds, this.map.getCenter());\n                if (L.Browser.mobile || immediate) {\n                    this.map.fitBounds(bounds, {maxZoom: 16});\n                } else {\n                    this.map.flyToBounds(bounds, {maxZoom: 16});\n                }\n            }\n        },\n\n        getTrackBounds: function(track) {\n            const lines = this.getTrackPolylines(track);\n            const points = this.getTrackPoints(track);\n            const bounds = L.latLngBounds([]);\n            if (lines.length || points.length) {\n                lines.forEach((l) => {\n                        if (l.getLatLngs().length > 1) {\n                            bounds.extend(wrapLatLngBoundsToTarget(l.getBounds(), bounds));\n                        }\n                    }\n                );\n                points.forEach((p) => {\n                        bounds.extend(wrapLatLngToTarget(p.latlng, bounds));\n                    }\n                );\n            }\n            return bounds;\n        },\n\n        attachColorSelector: function(track) {\n            var items = this.colors.map(function(color, index) {\n                    return {\n                        text: '<div style=\"display: inline-block; vertical-align: middle; width: 50px; height: 0; ' +\n                            'border-top: 4px solid ' + color + '\"></div>',\n                        callback: track.color.bind(null, index)\n                    };\n                }\n            );\n            track._contextmenu = new Contextmenu(items);\n        },\n\n        attachActionsMenu: function(track) {\n            var items = [\n                function() {\n                    return {text: `${track.name()}`, header: true};\n                },\n                '-',\n                {text: 'Переименовать', callback: this.renameTrack.bind(this, track)},\n                {text: 'Дублировать', callback: this.duplicateTrack.bind(this, track)},\n                {text: 'Реверсировать', callback: this.reverseTrack.bind(this, track)},\n                {text: 'Показать профиль высоты', callback: this.showElevationProfileForTrack.bind(this, track)},\n                '-',\n                {text: 'Удалить', callback: this.removeTrack.bind(this, track)},\n                '-',\n                {text: 'Скачать GPX', callback: this.saveTrackAsFile.bind(this, track, geoExporters.saveGpx, '.gpx')},\n                {text: 'Скачать KML', callback: this.saveTrackAsFile.bind(this, track, geoExporters.saveKml, '.kml')},\n                {text: 'Копировать ссылку на трэк', callback: this.copyTrackLinkToClipboard.bind(this, track)},\n                {text: 'Дополнительно', separator: true},\n                {\n                    text: 'Скачать GPX с добавлением высоты',\n                    callback: this.saveTrackAsFile.bind(this, track, geoExporters.saveGpxWithElevations, '.gpx', true),\n                },\n            ];\n            track._actionsMenu = new Contextmenu(items);\n        },\n\n        onButtonAddSegmentClicked: function(track) {\n            if (!track.visible()) {\n                return;\n            }\n            if (this.trackAddingSegment() === track) {\n                this.trackAddingSegment(null);\n                this.stopEditLine();\n            } else {\n                this.addSegmentAndEdit(track);\n            }\n        },\n\n        duplicateTrack: function(track) {\n            const segments = this.getTrackPolylines(track).map((line) =>\n                line.getLatLngs().map((latlng) => [latlng.lat, latlng.lng])\n            );\n            const points = this.getTrackPoints(track)\n                .map((point) => ({lat: point.latlng.lat, lng: point.latlng.lng, name: point.label}));\n            this.addTrack({name: track.name(), tracks: segments, points});\n        },\n\n        reverseTrackSegment: function(trackSegment) {\n            trackSegment.stopDrawingLine();\n            var latlngs = trackSegment.getLatLngs();\n            latlngs = latlngs.map(function(ll) {\n                    return [ll.lat, ll.lng];\n                }\n            );\n            latlngs.reverse();\n            var isEdited = (this._editedLine === trackSegment);\n            this.deleteTrackSegment(trackSegment);\n            var newTrackSegment = this.addTrackSegment(trackSegment._parentTrack, latlngs);\n            if (isEdited) {\n                this.startEditTrackSegement(newTrackSegment);\n            }\n        },\n\n        reverseTrack: function(track) {\n            var that = this;\n            this.getTrackPolylines(track).forEach(function(trackSegment) {\n                    that.reverseTrackSegment(trackSegment);\n                }\n            );\n        },\n\n        copyTracksLinkToClipboard: function(tracks, mouseEvent) {\n            if (!tracks.length) {\n                notify('No tracks to copy');\n                return;\n            }\n            let serialized = tracks.map((track) => this.trackToString(track)).join('/');\n            const hashDigest = md5(serialized, null, true);\n            const key = btoa(hashDigest).replace(/\\//ug, '_').replace(/\\+/ug, '-').replace(/=/ug, '');\n            const url = window.location + '&nktl=' + key;\n            copyToClipboard(url, mouseEvent);\n            fetch(`${config.tracksStorageServer}/track/${key}`, {\n                method: 'POST',\n                data: serialized,\n                withCredentials: true\n            }).then(\n                null, (e) => {\n                    let message = e.message || e;\n                    if (e.xhr.status === 413) {\n                        message = 'track is too big';\n                    }\n                    logging.captureMessage('Failed to save track to server',\n                        {status: e.xhr.status, response: e.xhr.responseText});\n                    notify('Error making link: ' + message);\n                }\n            );\n        },\n\n        copyTrackLinkToClipboard: function(track, mouseEvent) {\n            this.copyTracksLinkToClipboard([track], mouseEvent);\n        },\n\n        saveTrackAsFile: async function(track, exporter, extension, addElevations = false) {\n            var lines = this.getTrackPolylines(track)\n                .map(function(line) {\n                        return line.getFixedLatLngs();\n                    }\n                );\n            lines = splitLinesAt180Meridian(lines);\n            var points = this.getTrackPoints(track);\n            let name = track.name();\n            // Browser (Chrome) removes leading dots.\n            name = name.replace(/^\\./u, '_');\n            for (let extensions of [this.options.splitExtensionsFirstStage, this.options.splitExtensions]) {\n                let i = name.lastIndexOf('.');\n                if (i > -1 && extensions.includes(name.slice(i + 1).toLowerCase())) {\n                    name = name.slice(0, i);\n                }\n            }\n            if (lines.length === 0 && points.length === 0) {\n                notify('Трэк пустой. Скачивание невозможно.');\n                return;\n            }\n\n            if (addElevations) {\n                const request = [\n                    ...points.map((p) => p.latlng),\n                    ...lines.reduce((acc, cur) => {\n                        acc.push(...cur);\n                        return acc;\n                    }, [])\n                ];\n                let elevations;\n                try {\n                    elevations = await new ElevationProvider().get(request);\n                } catch (e) {\n                    logging.captureException(e, 'error getting elevation for gpx');\n                    notify(`Failed to get elevation data: ${e.message}`);\n                }\n                let n = 0;\n                for (let p of points) {\n                    // we make copy of latlng as we are changing it\n                    p.latlng = L.latLng(p.latlng.lat, p.latlng.lng, elevations[n]);\n                    n += 1;\n                }\n                for (let line of lines) {\n                    for (let p of line) {\n                        // we do not need to create new LatLng since splitLinesAt180Meridian() have already done it\n                        p.alt = elevations[n];\n                        n += 1;\n                    }\n                }\n            }\n\n            var fileText = exporter(lines, name, points);\n            var filename = name + extension;\n            saveAs(blobFromString(fileText), filename, true);\n        },\n\n        renameTrack: function(track) {\n            var newName = query('Enter new name', track.name());\n            if (newName && newName.length) {\n                track.name(newName);\n            }\n        },\n\n        showTrackMenu: function(track, e) {\n            track._actionsMenu.show(e);\n        },\n\n        showMenu: function(e) {\n            this.menu.show(e);\n        },\n\n        stopEditLine: function() {\n            if (this._editedLine) {\n                this._editedLine.stopEdit();\n            }\n        },\n\n        onTrackSegmentClick: function(e) {\n            if (this.isPlacingPoint) {\n                return;\n            }\n            const trackSegment = e.target;\n            if (this._lineJoinActive) {\n                L.DomEvent.stopPropagation(e);\n                this.joinTrackSegments(trackSegment, isPointCloserToStart(e.target.getLatLngs(), e.latlng));\n            } else {\n                this.startEditTrackSegement(trackSegment);\n                L.DomEvent.stopPropagation(e);\n            }\n        },\n\n        startEditTrackSegement: function(polyline) {\n            if (this._editedLine && this._editedLine !== polyline) {\n                this.stopEditLine();\n            }\n            polyline.startEdit();\n            this._editedLine = polyline;\n            polyline.once('editend', this.onLineEditEnd, this);\n            polyline.fire('startedit');\n        },\n\n        onButtonAddPointClicked: function(track) {\n            if (!track.visible()) {\n                return;\n            }\n            if (this.trackAddingPoint() === track) {\n                this.stopPlacingPoint();\n            } else {\n                this.beginPointCreate(track);\n            }\n        },\n\n        _beginPointEdit: function() {\n            this.stopPlacingPoint();\n            this.stopEditLine();\n            L.DomUtil.addClass(this._map._container, 'leaflet-point-placing');\n            this.isPlacingPoint = true;\n            L.DomEvent.on(document, 'keydown', this.stopPlacingPointOnEscPressed, this);\n            this._map.fire('startedit');\n        },\n\n        beginPointMove: function(marker) {\n            this._beginPointEdit();\n            this._movingMarker = marker;\n            this.map.on('click', this.movePoint, this);\n        },\n\n        beginPointCreate: function(track) {\n            this._beginPointEdit();\n            this.map.on('click', this.createNewPoint, this);\n            this.trackAddingPoint(track);\n        },\n\n        movePoint: function(e) {\n            const marker = this._movingMarker;\n            const newLatLng = e.latlng.wrap();\n            this._markerLayer.setMarkerPosition(marker, newLatLng);\n            this.stopPlacingPoint();\n        },\n\n        getNewPointName: function(track) {\n            let maxNumber = 0;\n            for (let marker of track.markers) {\n                const label = marker.label;\n                if (label.match(/^\\d{3}([^\\d.]|$)/u)) {\n                    maxNumber = parseInt(label, 10);\n                }\n            }\n            return maxNumber === 999 ? '' : String(maxNumber + 1).padStart(3, '0');\n        },\n\n        createNewPoint: function(e) {\n            if (!this.isPlacingPoint) {\n                return;\n            }\n            const parentTrack = this.trackAddingPoint();\n            const name = e.suggested && this._map.suggestedPoint?.title || this.getNewPointName(parentTrack);\n            const newLatLng = e.latlng.wrap();\n            const marker = this.addPoint(parentTrack, {name: name, lat: newLatLng.lat, lng: newLatLng.lng});\n            this._markerLayer.addMarker(marker);\n            // we need to show prompt after marker is dispalyed;\n            // grid layer is updated in setTimout(..., 0)after adding marker\n            // it is better to do it on 'load' event but when it is fired marker is not yet displayed\n            setTimeout(() => {\n                this.renamePoint(marker);\n                this.beginPointCreate(parentTrack);\n            }, 10);\n        },\n\n        stopPlacingPointOnEscPressed: function(e) {\n            if (e.keyCode === 27) {\n                this.stopPlacingPoint();\n            }\n        },\n\n        stopPlacingPoint: function() {\n            this.isPlacingPoint = false;\n            this.trackAddingPoint(null);\n            L.DomUtil.removeClass(this._map._container, 'leaflet-point-placing');\n            L.DomEvent.off(document, 'keydown', this.stopPlacingPointOnEscPressed, this);\n            this.map.off('click', this.createNewPoint, this);\n            this.map.off('click', this.movePoint, this);\n        },\n\n        joinTrackSegments: function(newSegment, joinToStart) {\n            this.hideLineCursor();\n            var originalSegment = this._editedLine;\n            var latlngs = originalSegment.getLatLngs(),\n                latngs2 = newSegment.getLatLngs();\n            if (joinToStart === this._lineJoinFromStart) {\n                latngs2.reverse();\n            }\n            if (this._lineJoinFromStart) {\n                latlngs.unshift(...latngs2);\n            } else {\n                latlngs.push(...latngs2);\n            }\n            latlngs = latlngs.map(function(ll) {\n                    return [ll.lat, ll.lng];\n                }\n            );\n            this.deleteTrackSegment(originalSegment);\n            if (originalSegment._parentTrack === newSegment._parentTrack) {\n                this.deleteTrackSegment(newSegment);\n            }\n            this.addTrackSegment(originalSegment._parentTrack, latlngs);\n        },\n\n        onLineEditEnd: function(e) {\n            const polyline = e.target;\n            const track = polyline._parentTrack;\n            if (polyline.getLatLngs().length < 2) {\n                this.deleteTrackSegment(polyline);\n            }\n            if (this._editedLine === polyline) {\n                this._editedLine = null;\n            }\n            if (!this.getTrackPolylines(track).length && !this.getTrackPoints(track).length && e.userCancelled) {\n                this.removeTrack(track);\n            }\n        },\n\n        addTrackSegment: function(track, sourcePoints) {\n            var polyline = new TrackSegment(sourcePoints || [], {\n                    color: this.colors[track.color()],\n                    print: true\n                }\n            );\n            polyline._parentTrack = track;\n            polyline.setMeasureTicksVisible(track.measureTicksShown());\n            polyline.on('click', this.onTrackSegmentClick, this);\n            polyline.on('nodeschanged', this.onTrackSegmentNodesChanged.bind(this, track, polyline));\n            polyline.on('noderightclick', this.onNodeRightClickShowMenu, this);\n            polyline.on('segmentrightclick', this.onSegmentRightClickShowMenu, this);\n            polyline.on('mouseover', () => this.onTrackMouseEnter(track));\n            polyline.on('mouseout', () => this.onTrackMouseLeave(track));\n            polyline.on('editstart', () => this.onTrackEditStart(track));\n            polyline.on('editend', () => this.onTrackEditEnd(track));\n            polyline.on('drawend', this.onTrackSegmentDrawEnd, this);\n\n            // polyline.on('editingstart', polyline.setMeasureTicksVisible.bind(polyline, false));\n            // polyline.on('editingend', this.setTrackMeasureTicksVisibility.bind(this, track));\n            track.feature.addLayer(polyline);\n            this.recalculateTrackLength(track);\n            return polyline;\n        },\n\n        onNodeRightClickShowMenu: function(e) {\n            var items = [];\n            if (e.nodeIndex > 0 && e.nodeIndex < e.line.getLatLngs().length - 1) {\n                items.push({\n                        text: 'Разрезать',\n                        callback: this.splitTrackSegment.bind(this, e.line, e.nodeIndex, null)\n                    }\n                );\n            }\n            if (e.nodeIndex === 0 || e.nodeIndex === e.line.getLatLngs().length - 1) {\n                items.push({text: 'Соединить', callback: this.startLineJoinSelection.bind(this, e)});\n            }\n            items.push({text: 'Реверсировать', callback: this.reverseTrackSegment.bind(this, e.line)});\n            items.push({text: 'Укоротить', callback: this.startShortCutSelection.bind(this, e, true)});\n            items.push({text: 'Удалить сегмент', callback: this.deleteTrackSegment.bind(this, e.line)});\n            items.push({text: 'Новый трэк из сегмента', callback: this.newTrackFromSegment.bind(this, e.line)});\n            items.push('-');\n            items.push({\n                    text: 'Профиль высоты сегмента',\n                    callback: this.showElevationProfileForSegment.bind(this, e.line)\n                }\n            );\n\n            var menu = new Contextmenu(items);\n            menu.show(e.mouseEvent);\n        },\n\n        onSegmentRightClickShowMenu: function(e) {\n            var menu = new Contextmenu([\n                    {\n                        text: 'Разрезать',\n                        callback: this.splitTrackSegment.bind(this, e.line, e.nodeIndex, e.mouseEvent.latlng)\n                    },\n                    {text: 'Реверсировать', callback: this.reverseTrackSegment.bind(this, e.line)},\n                    {text: 'Укоротить', callback: this.startShortCutSelection.bind(this, e, false)},\n                    {text: 'Удалить сегмент', callback: this.deleteTrackSegment.bind(this, e.line)},\n                    {text: 'Новый трэк из сегмента', callback: this.newTrackFromSegment.bind(this, e.line)},\n                    '-',\n                    {\n                        text: 'Профиль высоты сегмента',\n                        callback: this.showElevationProfileForSegment.bind(this, e.line)\n                    }\n                ]\n            );\n            menu.show(e.mouseEvent);\n        },\n\n        showLineCursor: function(start, mousepos) {\n            this.hideLineCursor();\n            this._editedLine.stopDrawingLine();\n            this._lineCursor = L.polyline([start.clone(), mousepos], {\n                ...this.options.lineCursorStyle,\n                ...this.options.lineCursorInvalidStyle,\n            }).addTo(this._map);\n            this.map.on('mousemove', this.onMouseMoveOnMapForLineCursor, this);\n            this.map.on('click', this.hideLineCursor, this);\n            L.DomEvent.on(document, 'keyup', this.onKeyUpForLineCursor, this);\n            L.DomUtil.addClass(this.map.getContainer(), 'tracklist-line-cursor-shown');\n            this._editedLine.preventStopEdit = true;\n        },\n\n        hideLineCursor: function() {\n            if (this._lineCursor) {\n                this.map.off('mousemove', this.onMouseMoveOnMapForLineCursor, this);\n                this.map.off('click', this.hideLineCursor, this);\n                L.DomUtil.removeClass(this.map.getContainer(), 'tracklist-line-cursor-shown');\n                L.DomEvent.off(document, 'keyup', this.onKeyUpForLineCursor, this);\n                this.map.removeLayer(this._lineCursor);\n                this._lineCursor = null;\n                this._map.fire('linecursorhide');\n                this._editedLine.preventStopEdit = false;\n            }\n        },\n\n        onMouseMoveOnMapForLineCursor: function(e) {\n            this.updateLineCursor(e.latlng, false);\n        },\n\n        updateLineCursor: function(latlng, isValid) {\n            if (!this._lineCursor) {\n                return;\n            }\n            this._lineCursor.getLatLngs().splice(1, 1, latlng);\n            this._lineCursor.redraw();\n            this._lineCursor.setStyle(\n                isValid ? this.options.lineCursorValidStyle : this.options.lineCursorInvalidStyle\n            );\n        },\n\n        onKeyUpForLineCursor: function(e) {\n            if (e.target.tagName.toLowerCase() === 'input') {\n                return;\n            }\n            switch (e.keyCode) {\n                case 27:\n                case 13:\n                    this.hideLineCursor();\n                    L.DomEvent.stop(e);\n                    break;\n                default:\n            }\n        },\n\n        startLineJoinSelection: function(e) {\n            this._lineJoinFromStart = (e.nodeIndex === 0);\n            const cursorStart = this._editedLine.getLatLngs()[e.nodeIndex];\n            this.showLineCursor(cursorStart, e.mouseEvent.latlng);\n            this._map.on('linecursorhide', this.onLineCursorHideForJoin, this);\n            for (let track of this.tracks()) {\n                track.feature.on('mousemove', this.onMouseMoveOnLineForJoin, this);\n            }\n            this._lineJoinActive = true;\n            this._editedLine.disableEditOnLeftClick(true);\n        },\n\n        onMouseMoveOnLineForJoin: function(e) {\n            const latlngs = e.layer.getLatLngs();\n            const lineJoinToStart = isPointCloserToStart(latlngs, e.latlng);\n            const cursorEnd = lineJoinToStart ? latlngs[0] : latlngs[latlngs.length - 1];\n            L.DomEvent.stopPropagation(e);\n            this.updateLineCursor(cursorEnd, true);\n        },\n\n        onLineCursorHideForJoin: function() {\n            for (let track of this.tracks()) {\n                track.feature.off('mousemove', this.onMouseMoveOnLineForJoin, this);\n            }\n            this._map.off('linecursorhide', this.onLineCursorHideForJoin, this);\n            this._editedLine.disableEditOnLeftClick(false);\n            this._lineJoinActive = false;\n        },\n\n        startShortCutSelection: function(e, startFromNode) {\n            const line = this._editedLine;\n            this._shortCut = {startNodeIndex: e.nodeIndex, startFromNode};\n            let cursorStart;\n            if (startFromNode) {\n                cursorStart = line.getLatLngs()[e.nodeIndex];\n            } else {\n                cursorStart = closestPointToLineSegment(line.getLatLngs(), e.nodeIndex, e.mouseEvent.latlng);\n                this._shortCut.startLatLng = cursorStart;\n            }\n            this.showLineCursor(cursorStart, e.mouseEvent.latlng);\n            line.nodeMarkers.on('mousemove', this.onMouseMoveOnNodeMarkerForShortCut, this);\n            line.segmentOverlays.on('mousemove', this.onMouseMoveOnLineSegmentForShortCut, this);\n            this.map.on('mousemove', this.onMouseMoveOnMapForShortCut, this);\n            line.nodeMarkers.on('click', this.onClickNodeMarkerForShortCut, this);\n            line.segmentOverlays.on('click', this.onClickLineSegmentForShortCut, this);\n            this._map.on('linecursorhide', this.onLineCursorHideForShortCut, this);\n            line.disableEditOnLeftClick(true);\n        },\n\n        onMouseMoveOnLineSegmentForShortCut: function(e) {\n            this.updateShortCutSelection(e, false);\n        },\n\n        onMouseMoveOnNodeMarkerForShortCut: function(e) {\n            this.updateShortCutSelection(e, true);\n        },\n\n        onMouseMoveOnMapForShortCut: function() {\n            this._editedLine.highlighNodesForDeletion();\n        },\n\n        updateShortCutSelection: function(e, endAtNode) {\n            L.DomEvent.stopPropagation(e);\n            const line = this._editedLine;\n            const {firstNodeToDelete, lastNodeToDelete, rangeValid} = this.getShortCutNodes(e, endAtNode);\n            this.updateLineCursor(e.latlng, rangeValid);\n            if (rangeValid) {\n                line.highlighNodesForDeletion(firstNodeToDelete, lastNodeToDelete);\n            } else {\n                line.highlighNodesForDeletion();\n            }\n        },\n\n        onLineCursorHideForShortCut: function() {\n            const line = this._editedLine;\n            line.highlighNodesForDeletion();\n            line.nodeMarkers.off('mousemove', this.onMouseMoveOnNodeMarkerForShortCut, this);\n            line.segmentOverlays.off('mousemove', this.onMouseMoveOnLineSegmentForShortCut, this);\n            this.map.off('mousemove', this.onMouseMoveOnMapForShortCut, this);\n            line.nodeMarkers.off('click', this.onClickNodeMarkerForShortCut, this);\n            line.segmentOverlays.off('click', this.onClickLineSegmentForShortCut, this);\n            this._map.off('linecursorhide', this.onLineCursorHideForShortCut, this);\n            line.disableEditOnLeftClick(false);\n            this._shortCut = null;\n        },\n\n        onClickLineSegmentForShortCut: function(e) {\n            this.shortCutSegment(e, false);\n        },\n\n        onClickNodeMarkerForShortCut: function(e) {\n            this.shortCutSegment(e, true);\n        },\n\n        getShortCutNodes: function(e, endAtNode) {\n            const line = this._editedLine;\n            let startFromNode = this._shortCut.startFromNode;\n            let startNodeIndex = this._shortCut.startNodeIndex;\n            let endNodeIndex = line[endAtNode ? 'getMarkerIndex' : 'getSegmentOverlayIndex'](e.layer);\n            const newNodes = [];\n            if (!startFromNode) {\n                newNodes.push(this._shortCut.startLatLng);\n            }\n            if (!endAtNode) {\n                newNodes.push(closestPointToLineSegment(line.getLatLngs(), endNodeIndex, e.latlng));\n            }\n            let firstNodeToDelete, lastNodeToDelete;\n            if (endNodeIndex > startNodeIndex) {\n                firstNodeToDelete = startNodeIndex + 1;\n                lastNodeToDelete = endNodeIndex - 1;\n                if (!endAtNode) {\n                    lastNodeToDelete += 1;\n                }\n            } else {\n                newNodes.reverse();\n                firstNodeToDelete = endNodeIndex + 1;\n                lastNodeToDelete = startNodeIndex - 1;\n                if (!startFromNode) {\n                    lastNodeToDelete += 1;\n                }\n            }\n            return {firstNodeToDelete, lastNodeToDelete, newNodes, rangeValid: lastNodeToDelete >= firstNodeToDelete};\n        },\n\n        shortCutSegment: function(e, endAtNode) {\n            L.DomEvent.stopPropagation(e);\n            const line = this._editedLine;\n            const {firstNodeToDelete, lastNodeToDelete, newNodes, rangeValid} = this.getShortCutNodes(e, endAtNode);\n            if (!rangeValid) {\n                return;\n            }\n            this.stopEditLine();\n            line.spliceLatLngs(firstNodeToDelete, lastNodeToDelete - firstNodeToDelete + 1, ...newNodes);\n            this.startEditTrackSegement(line);\n        },\n\n        onTrackMouseEnter: function(track) {\n            track.hover(true);\n        },\n\n        onTrackMouseLeave: function(track) {\n            track.hover(false);\n        },\n\n        onTrackEditStart: function(track) {\n            track.isEdited(true);\n        },\n\n        onTrackEditEnd: function(track) {\n            track.isEdited(false);\n            this.hideLineCursor();\n            this._editedLine = null;\n        },\n\n        onTrackRowMouseEnter: function(track) {\n            this._highlightedTrack = track;\n            this.updateTrackHighlight();\n        },\n\n        onTrackRowMouseLeave: function(track) {\n            if (this._highlightedTrack === track) {\n                this._highlightedTrack = null;\n                this.updateTrackHighlight();\n            }\n        },\n\n        onTrackSegmentDrawEnd: function() {\n            this.trackAddingSegment(null);\n        },\n\n        splitTrackSegment: function(trackSegment, nodeIndex, latlng) {\n            var latlngs = trackSegment.getLatLngs();\n            latlngs = latlngs.map((latlng) => latlng.clone());\n            var latlngs1 = latlngs.slice(0, nodeIndex + 1),\n                latlngs2 = latlngs.slice(nodeIndex + 1);\n            if (latlng) {\n                latlng = closestPointToLineSegment(latlngs, nodeIndex, latlng);\n                latlngs1.push(latlng.clone());\n            } else {\n                latlng = latlngs[nodeIndex];\n            }\n            latlngs2.unshift(latlng.clone());\n            this.deleteTrackSegment(trackSegment);\n            var segment1 = this.addTrackSegment(trackSegment._parentTrack, latlngs1);\n            this.addTrackSegment(trackSegment._parentTrack, latlngs2);\n            this.startEditTrackSegement(segment1);\n        },\n\n        deleteTrackSegment: function(trackSegment) {\n            const track = trackSegment._parentTrack;\n            track.feature.removeLayer(trackSegment);\n            this.recalculateTrackLength(track);\n        },\n\n        newTrackFromSegment: function(trackSegment) {\n            var srcNodes = trackSegment.getLatLngs(),\n                newNodes = [],\n                i;\n            for (i = 0; i < srcNodes.length; i++) {\n                newNodes.push([srcNodes[i].lat, srcNodes[i].lng]);\n            }\n            this.addTrack({name: \"Новый трэк\", tracks: [newNodes]});\n        },\n\n        addTrack: function(geodata) {\n            var color;\n            color = geodata.color;\n            if (!(color >= 0 && color < this.colors.length)) {\n                color = this._lastTrackColor;\n                this._lastTrackColor = (this._lastTrackColor + 1) % this.colors.length;\n            }\n            var track = {\n                name: ko.observable(geodata.name),\n                color: ko.observable(color),\n                visible: ko.observable(!geodata.trackHidden),\n                length: ko.observable(0),\n                measureTicksShown: ko.observable(geodata.measureTicksShown || false),\n                feature: L.featureGroup([]),\n                markers: [],\n                hover: ko.observable(false),\n                isEdited: ko.observable(false)\n            };\n            (geodata.tracks || []).forEach(this.addTrackSegment.bind(this, track));\n            (geodata.points || []).forEach(this.addPoint.bind(this, track));\n\n            this.tracks.push(track);\n\n            track.visible.subscribe(this.onTrackVisibilityChanged.bind(this, track));\n            track.measureTicksShown.subscribe(this.setTrackMeasureTicksVisibility.bind(this, track));\n            track.color.subscribe(this.onTrackColorChanged.bind(this, track));\n            if (!L.Browser.touch) {\n                track.feature.bindTooltip(() => track.name(), {sticky: true, delay: 500});\n            }\n\n            // this.onTrackColorChanged(track);\n            this.onTrackVisibilityChanged(track);\n            this.attachColorSelector(track);\n            this.attachActionsMenu(track);\n            return track;\n        },\n\n        updateTrackHighlight: function() {\n            if (L.Browser.touch) {\n                return;\n            }\n            if (this._trackHighlight) {\n                this._trackHighlight.removeFrom(this._map);\n                this._trackHighlight = null;\n            }\n            if (this._highlightedTrack && this._highlightedTrack.visible()) {\n                const trackHighlight = L.featureGroup([]);\n\n                this._highlightedTrack.feature.eachLayer((line) => {\n                    let latlngs = line.getFixedLatLngs();\n                    L.polyline(latlngs).addTo(trackHighlight);\n                });\n\n                trackHighlight.setStyle({\n                    color: 'yellow',\n                    weight: '15',\n                    opacity: 0.5\n                });\n                trackHighlight.addTo(this._map).bringToBack();\n                this._trackHighlight = trackHighlight;\n            }\n        },\n\n        setMarkerIcon: function(marker) {\n            var symbol = 'marker',\n                colorInd = marker._parentTrack.color() + 1,\n                className = 'symbol-' + symbol + '-' + colorInd;\n            marker.icon = iconFromBackgroundImage('track-waypoint ' + className);\n        },\n\n        setMarkerLabel: function(marker, label) {\n            marker.label = label;\n        },\n\n        addPoint: function(track, srcPoint) {\n            var marker = {\n                latlng: L.latLng([srcPoint.lat, srcPoint.lng]),\n                _parentTrack: track,\n            };\n            this.setMarkerIcon(marker);\n            this.setMarkerLabel(marker, srcPoint.name);\n            track.markers.push(marker);\n            marker._parentTrack = track;\n            return marker;\n        },\n\n        onMarkerClick: function(e) {\n            new Contextmenu([\n                    {text: e.marker.label, header: true},\n                    '-',\n                    {text: 'Rename', callback: this.renamePoint.bind(this, e.marker)},\n                    {text: 'Move', callback: this.beginPointMove.bind(this, e.marker)},\n                    {text: 'Delete', callback: this.removePoint.bind(this, e.marker)},\n                ]\n            ).show(e);\n        },\n\n        onMarkerEnter: function(e) {\n            e.marker._parentTrack.hover(true);\n        },\n\n        onMarkerLeave: function(e) {\n            e.marker._parentTrack.hover(false);\n        },\n\n        removePoint: function(marker) {\n            this.stopPlacingPoint();\n            this._markerLayer.removeMarker(marker);\n            const markers = marker._parentTrack.markers;\n            const i = markers.indexOf(marker);\n            markers.splice(i, 1);\n        },\n\n        renamePoint: function(marker) {\n            this.stopPlacingPoint();\n            var newLabel = query('New point name', marker.label);\n            if (newLabel !== null) {\n                this.setMarkerLabel(marker, newLabel);\n                this._markerLayer.updateMarker(marker);\n            }\n        },\n\n        removeTrack: function(track) {\n            track.visible(false);\n            this.tracks.remove(track);\n        },\n\n        deleteAllTracks: function() {\n            var tracks = this.tracks().slice(0),\n                i;\n            for (i = 0; i < tracks.length; i++) {\n                this.removeTrack(tracks[i]);\n            }\n        },\n\n        deleteHiddenTracks: function() {\n            var tracks = this.tracks().slice(0),\n                i, track;\n            for (i = 0; i < tracks.length; i++) {\n                track = tracks[i];\n                if (!track.visible()) {\n                    this.removeTrack(tracks[i]);\n                }\n            }\n        },\n\n        trackToString: function(track, forceVisible) {\n            var lines = this.getTrackPolylines(track).map(function(line) {\n                    var points = line.getFixedLatLngs();\n                    points = L.LineUtil.simplifyLatlngs(points, 360 / (1 << 24));\n                    return points;\n                }\n            );\n            return geoExporters.saveToString(lines, track.name(), track.color(), track.measureTicksShown(),\n                this.getTrackPoints(track), forceVisible ? false : !track.visible()\n            );\n        },\n\n        copyAllTracksToClipboard: function(mouseEvent) {\n            this.copyTracksLinkToClipboard(this.tracks(), mouseEvent);\n        },\n\n        copyVisibleTracks: function(mouseEvent) {\n            const tracks = this.tracks().filter((track) => track.visible());\n            this.copyTracksLinkToClipboard(tracks, mouseEvent);\n        },\n\n        exportTracks: function(minTicksIntervalMeters) {\n            var that = this;\n            /* eslint-disable max-nested-callbacks */\n            return this.tracks()\n                .filter(function(track) {\n                        return that.getTrackPolylines(track).length;\n                    }\n                )\n                .map(function(track) {\n                        var capturedTrack = track.feature.getLayers().map(function(pl) {\n                                return pl.getLatLngs().map(function(ll) {\n                                        return [ll.lat, ll.lng];\n                                    }\n                                );\n                            }\n                        );\n                        var bounds = track.feature.getBounds();\n                        var capturedBounds = [\n                            [bounds.getSouth(), bounds.getWest()],\n                            [bounds.getNorth(), bounds.getEast()]\n                        ];\n                        return {\n                            color: track.color(),\n                            visible: track.visible(),\n                            segments: capturedTrack,\n                            bounds: capturedBounds,\n                            measureTicksShown: track.measureTicksShown(),\n                            measureTicks: [].concat(...track.feature.getLayers().map(function(pl) {\n                                    return pl.getTicksPositions(minTicksIntervalMeters);\n                                }\n                                )\n                            )\n                        };\n                    }\n                );\n            /* eslint-enable max-nested-callbacks */\n        },\n\n        showElevationProfileForSegment: function(line) {\n            this.hideElevationProfile();\n            this.stopEditLine();\n            this._elevationControl = new ElevationProfile(this._map, line.getLatLngs(), {\n                    samplingInterval: calcSamplingInterval(line.getLength())\n                }\n            );\n            this._map.fire('elevation-shown');\n        },\n\n        showElevationProfileForTrack: function(track) {\n            var lines = this.getTrackPolylines(track),\n                path = [],\n                i;\n            for (i = 0; i < lines.length; i++) {\n                if (lines[i] === this._editedLine) {\n                    this.stopEditLine();\n                }\n                path = path.concat(lines[i].getLatLngs());\n            }\n            this.hideElevationProfile();\n            this._elevationControl = new ElevationProfile(this._map, path, {\n                    samplingInterval: calcSamplingInterval(new L.MeasuredLine(path).getLength())\n                }\n            );\n            this._map.fire('elevation-shown');\n        },\n\n        hideElevationProfile: function() {\n            if (this._elevationControl) {\n                this._elevationControl.removeFrom(this._map);\n            }\n            this._elevationControl = null;\n        },\n\n        hasTracks: function() {\n            return this.tracks().length > 0;\n        }\n    }\n);\n\nexport {TRACKLIST_TRACK_COLORS};\n","function arrayItemsEqual(l1, l2) {\n    if (l1.length !== l2.length) {\n        return false;\n    }\n    for (var i = 0; i < l1.length; i++) {\n        if (l1[i] !== l2[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n\nfunction parseHashParams(s) {\n    const args = {},\n        i = s.indexOf('#');\n    if (i >= 0) {\n        s = s.substr(i + 1).trim();\n        let m, key, value;\n        for (let pair of s.split('&')) {\n            m = /^([^=]+?)(?:=(.*))?$/u.exec(pair);\n            if (m) {\n                [, key, value] = m;\n                if (value) {\n                    value = value.split('/');\n                } else {\n                    value = [];\n                }\n                args[key] = value;\n            }\n        }\n    }\n    return args;\n}\n\nconst hashState = {\n    _listeners: [],\n    _state: {},\n\n    addEventListener: function(key, callback) {\n        for (let [k, c] of this._listeners) {\n            if (k === key && c === callback) {\n                return;\n            }\n        }\n        this._listeners.push([key, callback]);\n    },\n\n    updateState: function(key, values) {\n        if (values) {\n            this._state[key] = values;\n        } else {\n            delete this._state[key];\n        }\n        this._saveStateToHash();\n    },\n\n    getState: function(key) {\n        return this._state[key];\n    },\n\n    hasKey: function(key) {\n        return this._state.hasOwnProperty(key);\n    },\n\n    _saveStateToHash: function() {\n        var stateItems = [];\n        for (let key of Object.keys(this._state)) {\n            if (this._state[key]) {\n                if (this._state[key].length) {\n                    var values = this._state[key].join('/');\n                    stateItems.push(key + '=' + values);\n                } else {\n                    stateItems.push(key);\n                }\n            }\n        }\n        const hash = stateItems.join('&');\n        const href = `${location.origin}${location.pathname}${location.search}#${hash}`;\n        this._ignoreChanges = true;\n        location.replace(href);\n        this._ignoreChanges = false;\n    },\n\n    onHashChanged: function() {\n        if (this._ignoreChanges) {\n            return;\n        }\n        const newState = parseHashParams(location.hash);\n        const changedKeys = {};\n        for (let key of Object.keys(newState)) {\n            if (!(key in this._state) || !arrayItemsEqual(newState[key], this._state[key])) {\n                changedKeys[key] = 1;\n            }\n        }\n\n        for (let key of Object.keys(this._state)) {\n            if (!(key in newState)) {\n                changedKeys[key] = 1;\n            }\n        }\n\n        for (let [key, callback] of this._listeners) {\n            if (key in changedKeys) {\n                callback(newState[key]);\n            }\n        }\n        this._state = newState;\n    }\n};\n\nfunction bindHashStateReadOnly(key, target) {\n    function onChange() {\n        target(hashState.getState(key));\n        hashState.updateState(key, null);\n    }\n    hashState.addEventListener(key, onChange);\n    onChange();\n}\n\nwindow.addEventListener('hashchange', hashState.onHashChanged.bind(hashState));\nhashState.onHashChanged();\n\nexport {hashState, bindHashStateReadOnly, parseHashParams};\n\n","class PrintStaticLayer {\n    _layerDummy = true;\n    _printProgressWeight = 0.01;\n\n    cloneForPrint() {\n        return this;\n    }\n\n    // printOptions = {\n    //     xhrOptions,\n    //     pixelBounds,\n    //     latLngBounds,\n    //     destPixelSize,\n    //     resolution,\n    //     scale,\n    //     zoom\n    // }\n    async getTilesInfo(printOptions) {\n        return {\n            iterateTilePromises: (function*() {\n                yield {\n                    tilePromise: Promise.resolve({\n                            draw: (canvas) => this._drawRaster(canvas, printOptions),\n                            isOverlay: true,\n                            overlaySolid: this.overlaySolid\n                        }\n                    ),\n                    abortLoading: () => {\n                        // no actions needed\n                    }\n                };\n            }).bind(this),\n            count: 1\n        };\n    }\n\n    _drawRaster(_unused_canvas, _unused_printOptions) {\n        throw new Error(\"Method not implemented\");\n    }\n}\n\nexport {PrintStaticLayer};\n","import './style.css';\nimport * as logging from '~/lib/logging';\nimport {query} from '~/lib/notifications';\n\nfunction showNotification(message, mouseEvent) {\n    var el = document.createElement('div');\n    el.innerHTML = message;\n    el.className = 'copy-clipboard-notification';\n    document.body.appendChild(el);\n    var w = el.offsetWidth,\n        h = el.offsetHeight,\n        x = mouseEvent.clientX - w - 8,\n        y = mouseEvent.clientY - h / 2;\n    if (x < 0) {\n        x = 0;\n    }\n    if (y < 0) {\n        y = 0;\n    }\n    el.style.top = y + 'px';\n    el.style.left = x + 'px';\n    setTimeout(function() {\n        document.body.removeChild(el);\n    }, 1000);\n}\n\nfunction copyToClipboard(s, mouseEvent) {\n    let success = false;\n    let ta;\n    try {\n        ta = document.createElement('textarea');\n        ta.value = s;\n        document.body.appendChild(ta);\n        ta.select();\n        success = document.execCommand('copy');\n        if (success) {\n            showNotification('Скопировано', mouseEvent);\n        }\n    } catch (e) {\n        logging.captureException(e, 'clipborad to copy failed');\n    } finally {\n        document.body.removeChild(ta);\n    }\n    if (!success) {\n        query(\"Copy to clipboard: Ctrl+C, Enter\", s);\n    }\n}\n\nexport default copyToClipboard;\n","import {Cache} from '~/lib/cache';\nimport {XHRQueue} from '~/lib/xhr-promise';\n\nclass TiledDataLoader {\n    constructor(cacheSize = 50) {\n        this._cache = new Cache(cacheSize);\n        this._pendingRequests = {};\n        this._xhrQueue = new XHRQueue();\n    }\n\n    makeTileKey(coords) {\n        return `${coords.x}:${coords.y}:${coords.z}`;\n    }\n\n    getFromCache(dataTileCoords) {\n        const key = this.makeTileKey(dataTileCoords);\n        const res = this._cache.get(key);\n        res['coords'] = dataTileCoords;\n        return res;\n    }\n\n    layerTileToDataTileCoords(layerTileCoords) {\n        return {...layerTileCoords};\n    }\n\n    makeRequestData(_unused_dataTileCoords) {\n        throw new Error('Not implemented');\n        // return {\n        //     url,\n        //     options\n        // }\n    }\n\n    processResponse(_unused_xhr, _unused_originalDataTileCoords) {\n        throw new Error('Not implemented');\n        // return {\n        //     tileData,\n        //     coords\n        // }\n    }\n\n    calcAdjustment(layerTileCoords, dataTileCoords) {\n        if (layerTileCoords.x === dataTileCoords.x &&\n            layerTileCoords.y === dataTileCoords.y &&\n            layerTileCoords.z === dataTileCoords.z) {\n            return null;\n        }\n        if (dataTileCoords.z > layerTileCoords.z) {\n            const multiplier = 1 << (dataTileCoords.z - layerTileCoords.z);\n            return {multiplier: 1 / multiplier, offsetX: 0, offsetY: 0};\n        }\n        const multiplier = 1 << (layerTileCoords.z - dataTileCoords.z);\n        return {\n            multiplier,\n            offsetX: (layerTileCoords.x - dataTileCoords.x * multiplier),\n            offsetY: (layerTileCoords.y - dataTileCoords.y * multiplier)\n        };\n    }\n\n    requestTileData(layerTileCoords) {\n        const dataTileCoords = this.layerTileToDataTileCoords(layerTileCoords);\n        let res = this.getFromCache(dataTileCoords);\n        if (res.found) {\n            return {\n                dataPromise: Promise.resolve({\n                        coords: res.coords,\n                        tileData: res.value,\n                        adjustment: this.calcAdjustment(layerTileCoords, res.coords)\n                    }\n                ),\n                abortLoading: () => {\n                    // no need to abort Promise which is resolved immediately\n                }\n            };\n        }\n\n        const dataTileKey = this.makeTileKey(dataTileCoords);\n        if (!(dataTileKey in this._pendingRequests)) {\n            const {url, options} = this.makeRequestData(dataTileCoords);\n            const fetchPromise = this._xhrQueue.put(url, options);\n            const dataPromise = (async() => {\n                let xhr;\n                try {\n                    xhr = await fetchPromise;\n                } catch (e) {\n                    return {error: e};\n                } finally {\n                    delete this._pendingRequests[dataTileKey];\n                }\n                const {tileData, coords} = await this.processResponse(xhr, dataTileCoords);\n                this._cache.put(this.makeTileKey(coords), tileData);\n                return {tileData, coords};\n            })();\n            const pendingRequest = this._pendingRequests[dataTileKey] = {\n                dataPromise,\n                refCount: 0\n            };\n            pendingRequest.abortLoading = () => {\n                pendingRequest.refCount -= 1;\n                if (pendingRequest.refCount < 1) {\n                    fetchPromise.abort();\n                    delete this._pendingRequests[dataTileKey];\n                }\n            };\n        }\n\n        let pendingRequest = this._pendingRequests[dataTileKey];\n        pendingRequest.refCount += 1;\n\n        return {\n            dataPromise: pendingRequest.dataPromise.then((data) => {\n                    if (data.error) {\n                        return data;\n                    }\n                    return {\n                        coords: data.coords,\n                        tileData: data.tileData,\n                        adjustment: this.calcAdjustment(layerTileCoords, data.coords)\n                    };\n            }),\n            abortLoading: () => pendingRequest.abortLoading()\n        };\n    }\n}\n\nexport {TiledDataLoader};\n","import parsers from './parsers';\n\nfunction parseGeoFile(name, data) {\n    for (var i = 0; i < parsers.length; i++) {\n        var parsed = parsers[i](data, name);\n        if (parsed !== null) {\n            return parsed;\n        }\n    }\n    return [{name: name, error: 'UNSUPPORTED'}];\n}\n\nexport default parseGeoFile;\n","export default function stripBom(s) {\n    if (s.substr(0, 3) === '\\xef\\xbb\\xbf') {\n        s = s.substr(3);\n    }\n    return s;\n}\n","import services from './services';\n\nasync function loadFromUrl(url) {\n    for (let ServiceClass of services) {\n        let service = new ServiceClass(url);\n        if (service.isOurUrl()) {\n            return service.geoData();\n        }\n    }\n    return [{name: url, error: 'INVALID_URL'}];\n}\n\nexport default loadFromUrl;\n","import Pbf from 'pbf';\nimport {TrackView} from './nktk_pb';\nimport {arrayBufferToString, stringToArrayBuffer} from '~/lib/binary-strings';\nimport utf8 from 'utf8';\nimport * as urlSafeBase64 from './urlSafeBase64';\n\nconst arcUnit = ((1 << 24) - 1) / 360;\n\nfunction PackedStreamReader(s) {\n    this._string = s;\n    this.position = 0;\n}\n\nfunction unpackNumber(s, position) {\n    var x,\n        n = 0;\n    x = s.charCodeAt(position);\n    if (isNaN(x)) {\n        throw new Error('Unexpected end of line while unpacking number');\n    }\n    if (x < 128) {\n        n = x - 64;\n        return [n, 1];\n    }\n    n = x & 0x7f;\n    x = s.charCodeAt(position + 1);\n    if (isNaN(x)) {\n        throw new Error('Unexpected end of line while unpacking number');\n    }\n    if (x < 128) {\n        n |= x << 7;\n        n -= 8192;\n        return [n, 2];\n    }\n    n |= (x & 0x7f) << 7;\n    x = s.charCodeAt(position + 2);\n    if (isNaN(x)) {\n        throw new Error('Unexpected end of line while unpacking number');\n    }\n    if (x < 128) {\n        n |= x << 14;\n        n -= 1048576;\n        return [n, 3];\n    }\n    n |= (x & 0x7f) << 14;\n    x = s.charCodeAt(position + 3);\n    if (isNaN(x)) {\n        throw new Error('Unexpected end of line while unpacking number');\n    }\n    n |= x << 21;\n    n -= 268435456;\n    return [n, 4];\n}\n\nPackedStreamReader.prototype.readNumber = function() {\n    var n = unpackNumber(this._string, this.position);\n    this.position += n[1];\n    return n[0];\n};\n\nPackedStreamReader.prototype.readString = function(size) {\n    var s = this._string.slice(this.position, this.position + size);\n    this.position += size;\n    return s;\n};\n\nfunction deltaEncodeSegment(points) {\n    let deltaLats = [],\n        deltaLons = [];\n    let lastLon = 0,\n        lastLat = 0,\n        lon, lat;\n    for (let i = 0, len = points.length; i < len; i++) {\n        let p = points[i];\n        lon = Math.round(p.lng * arcUnit);\n        lat = Math.round(p.lat * arcUnit);\n        let deltaLon = lon - lastLon;\n        let deltaLat = lat - lastLat;\n        deltaLats.push(deltaLat);\n        deltaLons.push(deltaLon);\n        lastLon = lon;\n        lastLat = lat;\n    }\n    return {deltaLats, deltaLons};\n}\n\nfunction deltaDecodeSegment(deltaLats, deltaLons) {\n    let encodedLat = 0,\n        encodedLon = 0;\n    const points = [];\n    for (let i = 0; i < deltaLats.length; i++) {\n        encodedLat += deltaLats[i];\n        encodedLon += deltaLons[i];\n        points.push({lat: encodedLat / arcUnit, lng: encodedLon / arcUnit});\n    }\n    return points;\n}\n\nfunction saveNktk(segments, name, color, measureTicksShown, waypoints, trackHidden) {\n    const trackView = {\n        view: {\n            color,\n            shown: !trackHidden,\n            ticksShown: measureTicksShown,\n        }\n    };\n    const track = trackView.track = {name};\n    if (segments && segments.length) {\n        let deltaEncodedSegments = [];\n        for (let segment of segments) {\n            let {deltaLats, deltaLons} = deltaEncodeSegment(segment);\n            deltaEncodedSegments.push({lats: deltaLats, lons: deltaLons});\n        }\n        track.segments = deltaEncodedSegments;\n    }\n    if (waypoints && waypoints.length) {\n        let midLon = 0,\n            midLat = 0;\n        waypoints.forEach((wp) => {\n                midLon += wp.latlng.lng;\n                midLat += wp.latlng.lat;\n            }\n        );\n        midLon = Math.round(midLon * arcUnit / waypoints.length);\n        midLat = Math.round(midLat * arcUnit / waypoints.length);\n        track.waypoints = {\n            midLat, midLon\n        };\n\n        let packedWaypoints = [];\n        for (let waypoint of waypoints) {\n            packedWaypoints.push({\n                name: waypoint.label,\n                lat: Math.round(waypoint.latlng.lat * arcUnit) - midLat,\n                lon: Math.round(waypoint.latlng.lng * arcUnit) - midLon\n            });\n        }\n        track.waypoints.waypoints = packedWaypoints;\n    }\n    const pbf = new Pbf();\n    const versionStr = String.fromCharCode(4 + 64);\n    TrackView.write(trackView, pbf);\n    const s = versionStr + arrayBufferToString(pbf.finish());\n    return urlSafeBase64.encode(s);\n}\n\nfunction parseNktkOld(s, version) {\n    var name,\n        n,\n        segments = [],\n        segment,\n        segmentsCount,\n        pointsCount,\n        arcUnit = ((1 << 24) - 1) / 360,\n        x, y,\n        error, midX, midY, /* symbol,*/ waypointName,\n        wayPoints = [],\n        color, measureTicksShown,\n        trackHidden = false;\n    s = new PackedStreamReader(s);\n    try {\n        n = s.readNumber();\n        name = s.readString(n);\n        name = utf8.decode(name);\n        segmentsCount = s.readNumber();\n        for (let i = 0; i < segmentsCount; i++) {\n            segment = [];\n            pointsCount = s.readNumber();\n            x = 0;\n            y = 0;\n            for (let j = 0; j < pointsCount; j++) {\n                x += s.readNumber();\n                y += s.readNumber();\n                segment.push({lng: x / arcUnit, lat: y / arcUnit});\n            }\n            segments.push(segment);\n            segment = null;\n        }\n    } catch (e) {\n        if (e.message.match('Unexpected end of line while unpacking number')) {\n            error = ['CORRUPT'];\n            if (segment) {\n                segments.push(segment);\n            }\n        } else {\n            throw e;\n        }\n    }\n    try {\n        color = s.readNumber();\n        measureTicksShown = s.readNumber();\n    } catch (e) {\n        if (e.message.match('Unexpected end of line while unpacking number')) {\n            color = 0;\n            measureTicksShown = 0;\n            if (version > 0) {\n                error = ['CORRUPT'];\n            }\n        } else {\n            throw e;\n        }\n    }\n    if (version >= 3) {\n        try {\n            trackHidden = Boolean(s.readNumber());\n        } catch (e) {\n            if (e.message.match('Unexpected end of line while unpacking number')) {\n                error = ['CORRUPT'];\n            } else {\n                throw e;\n            }\n        }\n    }\n    if (version >= 2) {\n        try {\n            pointsCount = s.readNumber();\n            if (pointsCount) {\n                midX = s.readNumber();\n                midY = s.readNumber();\n            }\n            for (let i = 0; i < pointsCount; i++) {\n                n = s.readNumber();\n                waypointName = s.readString(n);\n                waypointName = utf8.decode(waypointName);\n\n                // let symbol = s.readNumber();\n                s.readNumber();\n\n                x = s.readNumber() + midX;\n                y = s.readNumber() + midY;\n                wayPoints.push({\n                        name: waypointName,\n                        lat: y / arcUnit,\n                        lng: x / arcUnit,\n\n                    }\n                );\n            }\n        } catch (e) {\n            if (e.message.match('Unexpected end of line while unpacking number')) {\n                error = ['CORRUPT'];\n            } else {\n                throw e;\n            }\n        }\n    }\n    var geoData = {\n        name: name || \"Text encoded track\",\n        tracks: segments,\n        error: error,\n        points: wayPoints,\n        color: color,\n        measureTicksShown: measureTicksShown,\n        trackHidden: trackHidden\n    };\n    return [geoData];\n}\n\nfunction parseTrackUrlData(s) {\n    s = urlSafeBase64.decode(s);\n    if (!s) {\n        return [{name: 'Text encoded track', error: ['CORRUPT']}];\n    }\n    return parseNktkOld(s, 0);\n}\n\nfunction parseNktkProtobuf(s) {\n    const pbf = new Pbf(stringToArrayBuffer(s));\n    let trackView;\n    try {\n        trackView = TrackView.read(pbf);\n    } catch (e) {\n        return [{name: 'Text encoded track', error: ['CORRUPT']}];\n    }\n    const geoData = {\n        name: trackView.track.name || \"Text encoded track\",\n        color: trackView.view.color,\n        trackHidden: !trackView.view.shown,\n        measureTicksShown: trackView.view.ticksShown,\n    };\n    const segments = trackView.track.segments;\n    if (segments && segments.length) {\n        geoData.tracks = segments.map((segment) => deltaDecodeSegment(segment.lats, segment.lons));\n    }\n    if (trackView.track.waypoints && trackView.track.waypoints.waypoints.length) {\n        const waypoints = geoData.points = [];\n        for (let waypoint of trackView.track.waypoints.waypoints) {\n            waypoints.push({\n                name: waypoint.name,\n                lat: (waypoint.lat + trackView.track.waypoints.midLat) / arcUnit,\n                lng: (waypoint.lon + trackView.track.waypoints.midLon) / arcUnit\n            });\n        }\n    }\n    return [geoData];\n}\n\nfunction parseNktkFragment(s) {\n    s = urlSafeBase64.decode(s);\n    if (!s) {\n        return [{name: 'Text encoded track', error: ['CORRUPT']}];\n    }\n    const reader = new PackedStreamReader(s);\n    let version = reader.readNumber();\n    if (version === 1 || version === 2 || version === 3) {\n        return parseNktkOld(s.substring(reader.position), version);\n    } else if (version === 4) {\n        return parseNktkProtobuf(s.substring(reader.position));\n    }\n    return [{name: 'Text encoded track', error: ['CORRUPT']}];\n}\n\nfunction parseNktkSequence(s) {\n    return s.split('/')\n        .map(parseNktkFragment)\n        .reduce((acc, cur) => {\n            acc.push(...cur);\n            return acc;\n        });\n}\n\nexport {saveNktk, parseTrackUrlData, parseNktkSequence, parseNktkFragment};\n","function onElementResize(element, cb) {\n    if (window.ResizeObserver) {\n        const observer = new ResizeObserver(() => cb());\n        observer.observe(element);\n    } else {\n        let width = element.offsetWidth;\n        let height = element.offsetHeight;\n        setInterval(function () {\n            const newWidth = element.offsetWidth;\n            const newHeight = element.offsetHeight;\n            if (newWidth !== width || newHeight !== height) {\n                width = newWidth;\n                height = newHeight;\n                cb();\n            }\n        }, 200);\n    }\n}\n\nexport {onElementResize};\n","import ko from 'knockout';\nimport './style.css';\nimport '~/lib/controls-styles/controls-styles.css';\n\nko.components.register('progress-indicator', {\n    template: `\n        <div class=\"ko-progress-unknown icon-spinner-nuclear\" data-bind=\"visible: progress() === undefined\"></div>\n        <div class=\"ko-progress\" data-bind=\"visible: progress() !== undefined\">\n            <div class=\"ko-progress-bkg\">\n                <div class=\"ko-progress-bar\"  data-bind=\"style: {width: progress() + '%'}\"></div>\n            </div>\n        </div>`,\n    viewModel: function(params) {\n        this.progress = ko.pureComputed(function() {\n            var range = params.progressRange(),\n                done = params.progressDone();\n            return done === undefined ? undefined : done * 100 / range;\n        });\n    }\n});\n","import L from 'leaflet';\nimport './TileLayer';\nimport './Bing';\nimport './Yandex';\nimport './Google';\nimport './WestraPasses';\nimport './CanvasMarkers';\nimport './MeasuredLine';\nimport './RetinaTileLayer';\n\nfunction getTempMap(zoom, fullSize, pixelBounds) {\n    const container = L.DomUtil.create('div', '', document.body);\n    let width, height, center;\n    if (fullSize) {\n        const size = pixelBounds.getSize();\n        width = size.x;\n        height = size.y;\n        center = pixelBounds.min.add(size.divideBy(2));\n        center = L.CRS.EPSG3857.pointToLatLng(center, zoom);\n    } else {\n        width = 100;\n        height = 100;\n        center = L.latLng(0, 0);\n    }\n\n    Object.assign(container.style, {\n            width: `${width}px`,\n            height: `${height}px`,\n            position: 'absolute',\n            left: '0',\n            top: '0',\n            visibility: 'hidden',\n        }\n    );\n\n    const map = L.map(container, {fadeAnimation: false, zoomAnimation: false, inertia: false, maxZoom: 18});\n    map.setView(center, zoom);\n    return map;\n}\n\nfunction disposeMap(map) {\n    const container = map._container;\n    map.remove();\n    L.DomUtil.remove(container);\n}\n\nexport {getTempMap, disposeMap};\n","import L from 'leaflet';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\nimport {imgFromDataString} from './imgFromDataString';\n\nfunction noop() {\n    // dummy function\n}\n\nconst GridLayerGrabMixin = {\n    tileImagePromiseFromCoords: function(_unused_coords) {\n        throw new Error('Method not implemented');\n    },\n\n    waitTilesReadyToGrab: function() {\n        return Promise.resolve(null);\n    },\n\n    getTilesInfo: async function(printOptions) {\n        await this.waitTilesReadyToGrab();\n        const {pixelBounds} = printOptions;\n        const tileRange = this._pxBoundsToTileRange(pixelBounds);\n        const topLeft = pixelBounds.min;\n        const tilePromiseIterator = (function*() {\n            for (let j = tileRange.min.y; j <= tileRange.max.y; j++) {\n                for (let i = tileRange.min.x; i <= tileRange.max.x; i++) {\n                    let coords = new L.Point(i, j);\n                    coords.z = this._tileZoom;\n                    if (!this._isValidTile(coords)) {\n                        continue;\n                    }\n                    let tilePos = this._getTilePos(coords);\n                    const coordsPlusOne = coords.add(L.point(1, 1));\n                    coordsPlusOne.z = coords.z;\n                    const tilePlusOne = this._getTilePos(coordsPlusOne);\n                    const tileSize = tilePlusOne.subtract(tilePos);\n                    const latLngBounds = L.latLngBounds(\n                        this._map.unproject(tilePos.add(this._level.origin)),\n                        this._map.unproject(tilePlusOne.add(this._level.origin)));\n                    tilePos = tilePos.add(this._level.origin).subtract(topLeft);\n                    let {tilePromise, abortLoading} = this.tileImagePromiseFromCoords(\n                        this._wrapCoords(coords), printOptions);\n                    yield {\n                        tilePromise: tilePromise.then((image) => ({image, tilePos, tileSize, latLngBounds})),\n                        abortLoading\n                    };\n                }\n            }\n        }).bind(this);\n        return {\n            iterateTilePromises: tilePromiseIterator,\n            count: (tileRange.max.x - tileRange.min.x + 1) * (tileRange.max.y - tileRange.min.y + 1)\n        };\n    }\n};\n\nconst TileLayerGrabMixin = L.Util.extend({}, GridLayerGrabMixin, {\n        cloneForPrint: function(options) {\n            return L.tileLayer(this._url, L.Util.extend({}, this.options, options));\n        },\n\n        tileImagePromiseFromCoords: function(coords, printOptions) {\n            let {xhrOptions} = printOptions;\n            let url = this.getTileUrl(coords);\n            if (!url) {\n                return {tilePromise: Promise.resolve(null), abortLoading: noop};\n            }\n            if (this.options.noCors) {\n                url = urlViaCorsProxy(url);\n            }\n            let promise = this.options.xhrQueue.put(url, xhrOptions);\n\n            return {\n                tilePromise: printOptions.rawData ? promise : promise.then(imgFromDataString),\n                abortLoading: () => promise.abort()\n            };\n        }\n    }\n);\n\n// CanvasLayerGrabMixin has been deleted\n\nL.TileLayer.include(TileLayerGrabMixin);\n","import L from 'leaflet';\nimport './style.css';\n\nconst yandexCrs = L.CRS.EPSG3395;\n\nL.Layer.Yandex = L.TileLayer.extend({\n        options: {\n            subdomains: '1234',\n            className: L.Browser.retina ? '' : 'yandex-tile-layer',\n            yandexScale: L.Browser.retina ? 2 : 1\n        },\n\n        _getTilePos: function(coords) {\n            const tilePosLatLng = yandexCrs.pointToLatLng(coords.scaleBy(this.getTileSize()), coords.z);\n            return this._map.project(tilePosLatLng, coords.z).subtract(this._level.origin).round();\n        },\n\n        _pxBoundsToTileRange: function(bounds) {\n            const zoom = this._tileZoom;\n            const bounds2 = new L.Bounds(\n                yandexCrs.latLngToPoint(this._map.unproject(bounds.min, zoom), zoom),\n                yandexCrs.latLngToPoint(this._map.unproject(bounds.max, zoom), zoom));\n            return L.TileLayer.prototype._pxBoundsToTileRange.call(this, bounds2);\n        },\n\n        createTile: function(coords, done) {\n            const tile = L.TileLayer.prototype.createTile.call(this, coords, done);\n            const coordsBelow = L.point(coords).add([0, 1]);\n            coordsBelow.z = coords.z;\n            tile._adjustHeight = this._getTilePos(coordsBelow).y - this._getTilePos(coords).y;\n            return tile;\n        },\n\n        _initTile: function(tile) {\n            L.TileLayer.prototype._initTile.call(this, tile);\n            tile.style.height = `${tile._adjustHeight}px`;\n        }\n    }\n);\n\nL.Layer.Yandex.Map = L.Layer.Yandex.extend({\n    initialize: function(options) {\n        L.Layer.Yandex.prototype.initialize.call(\n            this,\n            'https://vec0{s}.maps.yandex.net/tiles?l=map&x={x}&y={y}&z={z}&scale={yandexScale}',\n            options\n        );\n    },\n});\n\nL.Layer.Yandex.Sat = L.Layer.Yandex.extend({\n    initialize: function(options) {\n        L.Layer.Yandex.prototype.initialize.call(\n            this,\n            'https://sat0{s}.maps.yandex.net/tiles?l=sat&x={x}&y={y}&z={z}',\n            options\n        );\n    },\n});\n\nL.Layer.Yandex.Tracks = L.Layer.Yandex.extend({\n    initialize: function(options) {\n        options = {minZoom: 10, maxNativeZoom: 16, ...options};\n        L.Layer.Yandex.prototype.initialize.call(\n            this,\n            'https://core-gpstiles.maps.yandex.net/tiles?style=point&x={x}&y={y}&z={z}',\n            options\n        );\n    },\n});\n","import L from \"leaflet\";\n\nL.Layer.GoogleBase = L.TileLayer.extend({\n    options: {\n        subdomains: '0123'\n    },\n\n    getTileUrl: function(coords) {\n        const data = {\n            x: coords.x,\n            y: coords.y,\n            z: 17 - this._getZoomForUrl(),\n            s: this._getSubdomain(coords),\n            lang: navigator.language || ''\n        };\n        return L.Util.template(this._url, data);\n    }\n});\n\nL.Layer.GoogleMap = L.Layer.GoogleBase.extend({\n    initialize: function(options) {\n        L.Layer.GoogleBase.prototype.initialize.call(\n            this, 'https://mt{s}.google.com/vt/lyrs=m@169000000&hl={lang}&x={x}&y={y}&zoom={z}', options);\n    }\n});\n\nL.Layer.GoogleTerrain = L.Layer.GoogleBase.extend({\n    initialize: function(options) {\n        L.Layer.GoogleBase.prototype.initialize.call(\n            this, 'https://mt{s}.google.com/vt/lyrs=t@130,r@206000000&hl={lang}&x={x}&y={y}&zoom={z}', options);\n    }\n});\n\nL.Layer.GoogleHybrid = L.Layer.GoogleBase.extend({\n    initialize: function(options) {\n        L.Layer.GoogleBase.prototype.initialize.call(\n            this, 'https://mt{s}.google.com/vt/lyrs=h@169000000&hl={lang}&x={x}&y={y}&zoom={z}', options);\n    }\n});\n\nL.Layer.GoogleSat = L.TileLayer.extend({\n    options: {\n        subdomains: '0123'\n    },\n\n    initialize: function(options) {\n        L.TileLayer.prototype.initialize.call(\n            this, 'https://mt{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', options);\n    }\n});\n","import L from 'leaflet';\nimport '~/lib/leaflet.layer.canvasMarkers';\nimport {openPopupWindow} from '~/lib/popup-window';\nimport escapeHtml from 'escape-html';\nimport {saveAs} from '~/vendored/github.com/eligrey/FileSaver';\nimport iconFromBackgroundImage from '~/lib/iconFromBackgroundImage';\nimport {fetch} from '~/lib/xhr-promise';\nimport {notify} from '~/lib/notifications';\nimport * as logging from '~/lib/logging';\n\nconst WestraPassesMarkers = L.Layer.CanvasMarkers.extend({\n        options: {\n            filePasses: 'westra_passes.json',\n            scaleDependent: true\n        },\n\n        initialize: function(baseUrl, options) {\n            L.Layer.CanvasMarkers.prototype.initialize.call(this, null, options);\n            this.on('markerclick', this.showPassDescription, this);\n            this._baseUrl = baseUrl;\n            this.url = baseUrl + this.options.filePasses;\n        },\n\n        loadData: function() {\n            if (this._downloadStarted) {\n                return;\n            }\n            this._downloadStarted = true;\n            fetch(this.url)\n                .then(\n                    (xhr) => this._loadMarkers(xhr),\n                    (e) => {\n                        this._downloadStarted = false;\n                        logging.captureException(e, 'failed to get westra passes');\n                        notify('Failed to get Westra passes data');\n                    }\n                );\n        },\n\n        onAdd: function(map) {\n            L.Layer.CanvasMarkers.prototype.onAdd.call(this, map);\n            this.loadData();\n        },\n\n        _makeTooltip: function(marker) {\n            var properties = marker.properties,\n                toolTip = properties.grade || '';\n            if (toolTip && properties.elevation) {\n                toolTip += ', ';\n            }\n            toolTip += properties.elevation || '';\n            if (toolTip) {\n                toolTip = ' (' + toolTip + ')';\n            }\n            toolTip = (properties.name || 'без названия') + toolTip;\n            toolTip = (properties.is_summit ? 'Вершина ' : 'Перевал ') + toolTip;\n            return toolTip;\n        },\n\n        _passToGpx: function(marker) {\n            let label = marker.tooltip;\n            if (typeof label === 'function') {\n                label = label(marker);\n            }\n            label = escapeHtml(label);\n            const gpx = `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\" ?>\n                <gpx xmlns=\"http://www.topografix.com/GPX/1/1\"\n                     creator=\"http://nakarte.me\"\n                     xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n                     xsi:schemaLocation=\"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd\"\n                     version=\"1.1\">\n                    <wpt lat=\"${marker.latlng.lat.toFixed(6)}\" lon=\"${marker.latlng.lng.toFixed(6)}\">\n                        <name>${label}</name>\n                    </wpt>\n                </gpx>\n            `;\n            var filename = marker.properties.name || 'Без названия';\n            saveAs(new Blob([gpx], {type: 'application/gpx+xml'}), filename + '.gpx', true);\n        },\n\n        _passToKml: function(marker) {\n            let label = marker.tooltip;\n            if (typeof label === 'function') {\n                label = label(marker);\n            }\n            label = escapeHtml(label);\n            const kml = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n                <kml xmlns=\"http://www.opengis.net/kml/2.2\">\n                    <Placemark>\n                        <name>${label}</name>\n                        <Point>\n                            <coordinates>\n                                ${marker.latlng.lng.toFixed(6)},${marker.latlng.lat.toFixed(6)},0\n                            </coordinates>\n                        </Point>\n                    </Placemark>\n                </kml>\n            `;\n            var filename = marker.properties.name || 'Без названия';\n            saveAs(new Blob([kml], {type: 'application/vnd.google-earth.kml+xml'}), filename + '.kml', true);\n        },\n\n        _makeIcon: function(marker) {\n            var className;\n            className = 'westra-pass-marker ';\n            if (marker.properties.is_summit) {\n                className += 'westra-pass-marker-summit';\n            } else {\n                className += 'westra-pass-marker-' + marker.properties.grade_eng;\n            }\n            return iconFromBackgroundImage(className);\n        },\n\n        _loadMarkers: function(xhr) {\n            var markers = [],\n                features = JSON.parse(xhr.response),\n                feature, i, marker;\n            for (i = 0; i < features.length; i++) {\n                feature = features[i];\n                marker = {\n                    latlng: {\n                        lat: feature.latlon[0],\n                        lng: feature.latlon[1]\n                    },\n                    label: feature.name || \"\",\n                    icon: this._makeIcon,\n                    tooltip: this._makeTooltip.bind(this),\n                    properties: feature\n                };\n                markers.push(marker);\n            }\n            this.addMarkers(markers);\n            this._dataLoaded = true;\n            this.fire('data-loaded');\n        },\n\n        showPassDescription: function(e) {\n            if (!this._map) {\n                return;\n            }\n            const properties = e.marker.properties,\n                latLng = e.marker.latlng,\n                url = 'https://westra.ru/passes/Passes/' + properties.id;\n            let altnames = '',\n                connects = '',\n                comments = '';\n            if (properties.altnames) {\n                altnames = `\n                    <tr>\n                        <td>Другие названия</td>\n                        <td>${properties.altnames}</td>\n                    </tr>`;\n            }\n\n            if (!properties.is_summit) {\n                connects = `\n                    <tr>\n                        <td>Соединяет</td>\n                        <td>${properties.connects || \"неизвестнo\"}</td>\n                    </tr>`;\n            }\n\n            if (properties.comments) {\n                for (let comment of properties.comments) {\n                    let user = '';\n                    if (comment.user) {\n                        user = `<span class=\"westra-passes-description-comment-author\">${comment.user}:</span>`;\n                    }\n                    comments += `<p class=\"westra-passes-description-comment\">${user}${comment.content}</p>`;\n                }\n                comments = `\n                    <tr>\n                        <td>Комментарии</td>\n                        <td>${comments}</td>\n                    </tr>`;\n            }\n            let reports;\n            if (properties.reports_total) {\n                reports =\n                    `<br>Отчетов: ${properties.reports_total}, ` +\n                    `с фото: ${properties.reports_photo || 0}, ` +\n                    `с описанием: ${properties.reports_tech || 0}`;\n            } else {\n                reports = '<br>Отчетов нет';\n            }\n            let description = `\n                <table class=\"pass-details\">\n                    <tr>\n                        <td>${properties.is_summit ? 'Вершина ' : 'Перевал '}</td>\n                        <td>${properties.name || 'название неизвестно'}</td>\n                    </tr>\n                    ${altnames}\n                    <tr>\n                        <td>Категория</td>\n                        <td>${properties.grade || \"неизвестная\"}</td>\n                    </tr>\n                    <tr>\n                        <td>Высота</td>\n                        <td>${properties.elevation ? (properties.elevation + ' м') : 'неизвестная'}</td>\n                    </tr>\n                    ${connects}\n                    <tr>\n                        <td>Характеристика склонов</td>\n                        <td>${properties.slopes || \"неизвестная\"}</td>\n                    </tr>\n                    <tr>\n                        <td>Координаты</td>\n                        <td>\n                            <table class=\"coords\">\n                                <tr class=\"header\">\n                                    <td>Широта</td>\n                                    <td>Долгота</td>\n                                </tr>\n                                <tr>\n                                    <td>${latLng.lat.toFixed(5)}</td>\n                                    <td>${latLng.lng.toFixed(5)}</td>\n                                    <td><a id=\"westra-pass-gpx\" title=\"Сохранить\">gpx</a></td>\n                                    <td><a id=\"westra-pass-kml\" title=\"Сохранить\">kml</a></td>\n                                </tr>\n                            </table>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>На сайте Вестры</td>\n                        <td><a id=\"westra-pass-link\" href=\"${url}\">${url}</a>${reports}</td></tr>\n                    <tr>\n                        <td>Добавил</td>\n                        <td>${properties.author || \"неизвестно\"}</td>\n                    </tr>\n                    ${comments}\n                </table>`;\n            this._map.openPopup(description, latLng, {maxWidth: 500});\n            document.getElementById('westra-pass-link').onclick = function() {\n                openPopupWindow(url, 780, 'westra-details');\n                return false;\n            };\n            document.getElementById('westra-pass-gpx').onclick = function() {\n                this._passToGpx(e.marker);\n                return false;\n            }.bind(this);\n            document.getElementById('westra-pass-kml').onclick = function() {\n                this._passToKml(e.marker);\n                return false;\n            }.bind(this);\n        }\n    }\n);\n\nexport {WestraPassesMarkers};\n","import {notify} from '~/lib/notifications';\n\nfunction openPopupWindow(url, width, uniqName = null) {\n    var left, top, height,\n        screenLeft = screen.availLeft || 0,\n        bordersWidth = 8;\n    // if browser window is in the right half of screen, place new window on left half\n    if (window.screenX - screenLeft - bordersWidth * 1.5 > width) {\n        left = window.screenX - width - bordersWidth * 1.5;\n        // if browser window is in the left half of screen, place new window on right half\n    } else if (window.screenX + window.outerWidth + width + bordersWidth * 1.5 < screenLeft + screen.availWidth) {\n        left = window.screenX + window.outerWidth + bordersWidth;\n        // if screen is small or browser window occupies whole screen, place new window on top of current window\n    } else {\n        left = window.screenX + window.outerWidth / 2 - width / 2;\n        if (left < 0) {\n            left = 0;\n        }\n    }\n    top = window.screenY;\n    height = window.innerHeight;\n    var features = 'width=' + width + ',height=' + height + ',left=' + left + ',top=' + top;\n    features += ',resizable,scrollbars';\n    var newWindow = window.open(url, uniqName, features);\n    if (!newWindow || newWindow.closed) {\n        notify('Всплывающее окно заблокировано браузером.\\n' +\n            'Для полноценной работы сайта необходимо разрешить всплывающие окна в настройках браузера для сайта.\\n\\n' +\n            'Pop-up window was blocked by the browser.\\n' +\n            'If you want to use the full functionality of this site, ' +\n            'turn off blocking pop-ups in the browser settings for this site.');\n    } else {\n        newWindow.focus();\n    }\n}\n\nexport {openPopupWindow};\n","function cached(f) {\n    var cache = {};\n    return function(arg) {\n        if (!(arg in cache)) {\n            cache[arg] = f(arg);\n        }\n        return cache[arg];\n    };\n}\n\nfunction iconFromBackgroundImage(className) {\n    const container = document.createElement('div');\n    container.style.position = 'absolute';\n    document.body.appendChild(container);\n    const el = document.createElement('div');\n    el.className = className;\n    container.appendChild(el);\n    const st = window.getComputedStyle(el),\n        url = st.backgroundImage.replace(/^url\\(\"?/u, '').replace(/\"?\\)$/u, '');\n    let icon = {url: url, center: [-el.offsetLeft, -el.offsetTop]};\n    document.body.removeChild(container);\n    container.removeChild(el);\n    return icon;\n}\n\nexport default cached(iconFromBackgroundImage);\n","import L from \"leaflet\";\nimport '~/lib/leaflet.layer.canvasMarkers';\n\nL.Layer.CanvasMarkers.include({\n        _printProgressWeight: 0.1,\n\n        cloneMarker: function(marker) {\n            return {\n                latlng: {lat: marker.latlng.lat, lng: marker.latlng.lng},\n                label: marker.label,\n                icon: marker.icon\n            };\n        },\n\n        cloneMarkers: function() {\n            const markers = this.rtree.all();\n\n            const markersCopy = markers.map(this.cloneMarker);\n            return markersCopy;\n        },\n\n        cloneForPrint: function(options) {\n            options = L.Util.extend({}, this.options, {noWrap: true});\n            if (options.printIconsOpacity !== undefined) {\n                options.iconsOpacity = options.printIconsOpacity;\n            }\n            return new L.Layer.CanvasMarkers(this.cloneMarkers(), options);\n        },\n\n        getTilesInfo: async function(printOptions) {\n            this.options.iconScale = printOptions.resolution / 90 * 0.75;\n            const scale = printOptions.pixelBounds.getSize().x / printOptions.destPixelSize.x;\n            const pixelExtents = {\n                tileN: printOptions.pixelBounds.getTopRight().y / scale,\n                tileS: printOptions.pixelBounds.getBottomLeft().y / scale,\n                tileE: printOptions.pixelBounds.getTopRight().x / scale,\n                tileW: printOptions.pixelBounds.getBottomLeft().x / scale\n            };\n            const crs = L.CRS.EPSG3857;\n            if (!this._map) {\n                const dummyMap = {\n                    project: crs.latLngToPoint.bind(crs),\n                    unproject: crs.pointToLatLng.bind(crs),\n                };\n                this._map = dummyMap;\n            }\n            const zoom = crs.zoom((1 / scale) * crs.scale(printOptions.zoom));\n            const {iconUrls, markerJobs, pointsForLabels} = this.selectMarkersForDraw(pixelExtents, zoom, true);\n            await this.preloadIcons(iconUrls);\n            return {\n                iterateTilePromises: (function*() {\n                    yield {\n                        tilePromise: Promise.resolve({\n                                draw: (canvas) => {\n                                    this.resetLabels();\n                                    this.drawSelectedMarkers(canvas, pixelExtents, markerJobs, pointsForLabels, zoom,\n                                        true);\n                                },\n                                isOverlay: true,\n                                overlaySolid: !this.options.printTransparent\n                            }\n                        ),\n                        abortLoading: () => {\n                            // no actions needed\n                        }\n                    };\n                }).bind(this),\n                count: 1\n            };\n        }\n    }\n);\n","import L from 'leaflet';\nimport './measured_line.css';\n\nfunction pointOnSegmentAtDistance(p1, p2, dist) {\n    // FIXME: we should place markers along projected line to avoid transformation distortions\n    var q = dist / p1.distanceTo(p2),\n        x = p1.lng + (p2.lng - p1.lng) * q,\n        y = p1.lat + (p2.lat - p1.lat) * q;\n    return L.latLng(y, x);\n}\n\nfunction sinCosFromLatLonSegment(segment) {\n    const\n        p1 = L.CRS.EPSG3857.project(segment[0]),\n        p2 = L.CRS.EPSG3857.project(segment[1]),\n        dx = p2.x - p1.x,\n        dy = p1.y - p2.y,\n        len = Math.sqrt(dx * dx + dy * dy),\n        sin = dy / len,\n        cos = dx / len;\n    return [sin, cos];\n}\n\nL.MeasuredLine = L.Polyline.extend({\n        options: {\n            minTicksIntervalMm: 15,\n        },\n\n        onAdd: function(map) {\n            L.Polyline.prototype.onAdd.call(this, map);\n            this._ticks = {};\n            this.updateTicks();\n            this._map.on('zoomend', this.updateTicks, this);\n            // markers are created only for visible part of map, need to update when it changes\n            this._map.on('moveend', this.updateTicks, this);\n            this.on('nodeschanged', this.updateTicksLater, this);\n        },\n\n        updateTicksLater: function() {\n            setTimeout(this.updateTicks.bind(this), 0);\n        },\n\n        onRemove: function(map) {\n            this._map.off('zoomend', this.updateTicks, this);\n            this._map.off('moveend', this.updateTicks, this);\n            this.off('nodeschanged', this.updateTicks, this);\n            this._clearTicks();\n            L.Polyline.prototype.onRemove.call(this, map);\n        },\n\n        _clearTicks: function() {\n            if (this._map) {\n                Object.values(this._ticks).forEach((tick) => this._map.removeLayer(tick));\n                this._ticks = {};\n            }\n        },\n\n        _addTick: function(tick, marker) {\n            var transformMatrixString = 'matrix(' + tick.transformMatrix.join(',') + ')';\n            if (marker) {\n                marker._icon.childNodes[0].style.transform = transformMatrixString;\n                marker.setLatLng(tick.position);\n            } else {\n                var labelText = Math.round((tick.distanceValue / 10)) / 100 + ' km',\n                    icon = L.divIcon(\n                        {\n                            html: '<div class=\"measure-tick-icon-text\" style=\"transform:' +\n                                transformMatrixString + '\">' +\n                            labelText + '</div>',\n                            className: 'measure-tick-icon'\n                        }\n                    );\n                marker = L.marker(tick.position, {\n                    icon: icon,\n                    interactive: false,\n                    keyboard: false,\n                    projectedShift: () => this.shiftProjectedFitMapView(),\n                });\n                marker.addTo(this._map);\n            }\n            this._ticks[tick.distanceValue.toString()] = marker;\n        },\n\n        setMeasureTicksVisible: function(visible) {\n            this.options.measureTicksShown = visible;\n            this.updateTicks();\n        },\n\n        getTicksPositions: function(minTicksIntervalMeters, bounds) {\n            var steps = [500, 1000, 2000, 5000, 10000, 20000, 50000, 100000, 200000, 500000, 1000000];\n            var ticks = [];\n\n            const that = this;\n            function addTick(position, segment, distanceValue) {\n                if (bounds) {\n                    // create markers only in visible part of map\n                    const normalizedBounds = that._map.wrapLatLngBounds(bounds);\n                    const normalizedPosition = position.wrap();\n                    // account for worldCopyJump\n                    const positionMinus360 = L.latLng(normalizedPosition.lat, normalizedPosition.lng - 360);\n                    const positionPlus360 = L.latLng(normalizedPosition.lat, normalizedPosition.lng + 360);\n                    if (\n                        !normalizedBounds.contains(normalizedPosition) &&\n                        !normalizedBounds.contains(positionMinus360) &&\n                        !normalizedBounds.contains(positionPlus360)\n                    ) {\n                        return;\n                    }\n                }\n\n                var sinCos = sinCosFromLatLonSegment(segment),\n                    sin = sinCos[0],\n                    cos = sinCos[1],\n                    transformMatrix;\n\n                if (sin > 0) {\n                    transformMatrix = [sin, -cos, cos, sin, 0, 0];\n                } else {\n                    transformMatrix = [-sin, cos, -cos, -sin, 0, 0];\n                }\n                ticks.push({position: position, distanceValue: distanceValue, transformMatrix: transformMatrix});\n            }\n\n            let step;\n            for (step of steps) {\n                if (step >= minTicksIntervalMeters) {\n                    break;\n                }\n            }\n\n            var lastTickMeasure = 0,\n                lastPointMeasure = 0,\n                points = this._latlngs,\n                points_n = points.length,\n                nextPointMeasure,\n                segmentLength;\n            if (points_n < 2) {\n                return ticks;\n            }\n\n            for (var i = 1; i < points_n; i++) {\n                segmentLength = points[i].distanceTo(points[i - 1]);\n                nextPointMeasure = lastPointMeasure + segmentLength;\n                if (nextPointMeasure >= lastTickMeasure + step) {\n                    while (lastTickMeasure + step <= nextPointMeasure) {\n                        lastTickMeasure += step;\n                        addTick(\n                            pointOnSegmentAtDistance(points[i - 1], points[i], lastTickMeasure - lastPointMeasure),\n                            [points[i - 1], points[i]],\n                            lastTickMeasure\n                        );\n                    }\n                }\n                lastPointMeasure = nextPointMeasure;\n            }\n            // remove last mark if it is close to track end\n            if (lastPointMeasure - lastTickMeasure < minTicksIntervalMeters / 2) {\n                ticks.pop();\n            }\n            // special case: if track is versy short, do not add starting mark\n            if (lastPointMeasure > minTicksIntervalMeters / 2) {\n                addTick(points[0], [points[0], points[1]], 0);\n            }\n            addTick(points[points_n - 1], [points[points_n - 2], points[points_n - 1]], lastPointMeasure);\n            return ticks;\n        },\n\n        updateTicks: function() {\n            if (!this._map) {\n                return;\n            }\n            if (!this.options.measureTicksShown) {\n                this._clearTicks();\n                return;\n            }\n            var bounds = this._map.getBounds().pad(1),\n                rad = Math.PI / 180,\n                dpi = 96,\n                mercatorMetersPerPixel = 20003931 / (this._map.project([180, 0]).x),\n                referencePoint = this.getLatLngs().length ? this.getBounds().getCenter() : this._map.getCenter(),\n                realMetersPerPixel = mercatorMetersPerPixel * Math.cos(referencePoint.lat * rad),\n                mapScale = 1 / dpi * 2.54 / 100 / realMetersPerPixel,\n                minTicksIntervalMeters = this.options.minTicksIntervalMm / mapScale / 1000,\n                ticks = this.getTicksPositions(minTicksIntervalMeters, bounds),\n                oldTicks = this._ticks;\n            this._ticks = {};\n            ticks.forEach(function(tick) {\n                    var oldMarker = oldTicks[tick.distanceValue.toString()];\n                    this._addTick(tick, oldMarker);\n                    if (oldMarker) {\n                        delete oldTicks[tick.distanceValue.toString()];\n                    }\n                }.bind(this)\n            );\n            Object.values(oldTicks).forEach((tick) => this._map.removeLayer(tick));\n        },\n\n        getLength: function() {\n            var points = this._latlngs,\n                points_n = points.length,\n                length = 0;\n\n            for (var i = 1; i < points_n; i++) {\n                length += points[i].distanceTo(points[i - 1]);\n            }\n            return length;\n        }\n    }\n);\n\nL.measuredLine = function(latlngs, options) {\n    return new L.MeasuredLine(latlngs, options);\n};\n","import L from 'leaflet';\n\nclass RetinaTileLayer extends L.TileLayer {\n    constructor(urls, options, hiRes = 'auto') {\n        let url, tileSizeMultiplicator;\n        const useHiResTiles = hiRes === 'auto' ? L.Browser.retina : hiRes;\n        const newOptions = L.extend({}, options);\n        if (useHiResTiles) {\n            url = urls[1];\n            tileSizeMultiplicator = 2;\n        } else {\n            tileSizeMultiplicator = 1;\n            url = urls[0];\n        }\n        if (options.retinaOptionsOverrides) {\n            L.extend(newOptions, options.retinaOptionsOverrides[useHiResTiles ? 1 : 0]);\n        }\n        super(url, newOptions);\n        this.urls = urls;\n        this.tileSizeMultiplicator = tileSizeMultiplicator;\n    }\n}\n\nexport {RetinaTileLayer};\n","import declination from './declination.json';\nimport {stringToArrayBuffer} from '~/lib/binary-strings';\n\nlet data;\n\nfunction mod(x, n) {\n    return ((x % n) + n) % n;\n}\n\nfunction loadData() {\n    const ar1 = new Uint8Array(stringToArrayBuffer(atob(declination.array)));\n    const ar2 = new Float32Array(ar1.length);\n    const scale = declination.valueScale;\n    const offset = declination.valueOffset;\n    for (let i = 0; i < ar1.length; i++) {\n        ar2[i] = ar1[i] / scale - offset;\n    }\n    return ar2;\n}\n\nfunction getArrayValue(row, col) {\n    if (row < 0 || col < 0 || col >= declination.colsCount || row >= declination.rowsCount) {\n        throw new Error(`Invalid col/row value col=${col} row=${row}`);\n    }\n    const ind = row * declination.colsCount + col;\n    if (ind >= data.length) {\n        throw new Error('Index value out of range');\n    }\n    return data[ind];\n}\n\nfunction getDeclination(lat, lon) {\n    if (lat < declination.minLat || lat > declination.maxLat) {\n        return null;\n    }\n    lon = mod(lon + 180, 360) - 180;\n    const row1 = Math.floor((lat - declination.minLat) / declination.step);\n    const row2 = row1 + 1;\n    const dlat = (lat - (row1 * declination.step + declination.minLat)) / declination.step;\n    let col1 = Math.floor((lon + 180) / declination.step);\n    let col2 = col1 + 1;\n    const dlon = (lon - (col1 * declination.step - 180)) / declination.step;\n    col1 %= declination.colsCount;\n    col2 %= declination.colsCount;\n    let a1 = getArrayValue(row1, col1);\n    let a2 = getArrayValue(row1, col2);\n    const v1 = a1 * (1 - dlon) + a2 * dlon;\n    if (row2 >= declination.rowsCount) {\n        return v1;\n    }\n    a1 = getArrayValue(row2, col1);\n    a2 = getArrayValue(row2, col2);\n    const v2 = a1 * (1 - dlon) + a2 * dlon;\n    const v = v1 * (1 - dlat) + v2 * dlat;\n    return v;\n}\n\ndata = loadData();\n\nexport {getDeclination};\n","import L from 'leaflet';\nimport './style.css';\n\nconst CloseButtonMixin = {\n    createCloseButton: function(container) {\n        this.closeButton = L.DomUtil.create('div', 'photo-viewer-button-close', container);\n        L.DomEvent.on(this.closeButton, 'click', this.onCloseClick, this);\n    },\n\n    onCloseClick: function() {\n        this.fire('closeclick');\n    },\n};\n\nfunction formatDateTime(ts) {\n    const d = new Date(ts);\n    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n    return `${d.getDate()} ${months[d.getMonth()]} ${d.getFullYear()}`;\n}\n\nconst DateLabelMixin = {\n    createDateLabel: function(container) {\n        this.dateLabel = L.DomUtil.create('div', 'mapillary-viewer-date-overlay', container);\n    },\n\n    updateDateLabel: function(timestamp) {\n        this.dateLabel.innerHTML = formatDateTime(timestamp);\n    }\n};\n\nexport {CloseButtonMixin, DateLabelMixin};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from \"leaflet\";\n\nconst DragEvents = L.Evented.extend({\n        options: {\n            dragTolerance: 2,\n            dragButtons: [0],\n            stopOnLeave: false,\n        },\n\n        initialize: function(element, options) {\n            L.setOptions(this, options);\n            this.element = element;\n\n            this.dragButton = null;\n            this.startEvent = null;\n            this.prevEvent = null;\n            this.isDragging = false;\n\n            L.DomEvent.on(element, 'mousedown', this.onMouseDown, this);\n        },\n\n        onMouseDown: function(e) {\n            if (this.dragButton === null && this.options.dragButtons.includes(e.button)) {\n                this.dragButton = e.button;\n                this.startEvent = e;\n                this.prevEvent = e;\n                L.DomUtil.disableImageDrag();\n                L.DomUtil.disableTextSelection();\n                this._moveHandler = this.onMouseMove.bind(this);\n                document.addEventListener('mousemove', this._moveHandler, true);\n                L.DomEvent.on(document, 'mouseup', this.onMouseUp, this);\n                if (this.options.stopOnLeave) {\n                    L.DomEvent.on(this.element, 'mouseleave', this.onMouseLeave, this);\n                }\n            }\n        },\n\n        onMouseUp: function(e) {\n            if (this.dragButton === e.button) {\n                if (this.isDragging) {\n                    this.fireDragEvent('dragend', e);\n                } else {\n                    this.fire('click', {originalEvent: e, target: this.element});\n                }\n                this.finishDrag();\n            }\n        },\n\n        onMouseMove: function(e) {\n            var that = this;\n            function exceedsTolerance() {\n                var tolerance = that.options.dragTolerance;\n                return Math.abs(e.clientX - that.startEvent.clientX) > tolerance ||\n                    Math.abs(e.clientY - that.startEvent.clientY) > tolerance;\n            }\n\n            if (this.isDragging) {\n                this.fireDragEvent('drag', e);\n                this.prevEvent = e;\n            } else if (this.dragButton !== null && exceedsTolerance()) {\n                this.isDragging = true;\n                this.fireDragEvent('dragstart', this.startEvent);\n                this.fireDragEvent('drag', e);\n                this.prevEvent = e;\n            }\n        },\n\n        onMouseLeave: function(e) {\n            if (this.isDragging) {\n                this.fireDragEvent('dragend', e);\n                this.finishDrag();\n            }\n        },\n\n        fireDragEvent: function(type, originalEvent) {\n            const prevPos = L.point(this.prevEvent.clientX, this.prevEvent.clientY);\n            const pos = L.point(originalEvent.clientX, originalEvent.clientY);\n            const data = {\n                dragButton: this.dragButton,\n                originalEvent,\n                dragMovement: pos.subtract(prevPos) // e.movementX is not available in Safari\n            };\n            this.fire(type, data);\n        },\n\n        finishDrag: function() {\n            this.isDragging = false;\n            this.dragButton = null;\n            L.DomUtil.enableImageDrag();\n            L.DomUtil.enableTextSelection();\n            document.removeEventListener('mousemove', this._moveHandler, true);\n            L.DomEvent.off(document, 'mouseup', this.onMouseUp, this);\n            L.DomEvent.off(this.element, 'mouseleave', this.onMouseLeave, this);\n        }\n    }\n);\n\nexport {DragEvents};\n","function xmlGetNodeText(node) {\n    if (node) {\n        return Array.prototype.slice.call(node.childNodes)\n            .map(function(node) {\n                    return node.nodeValue;\n                }\n            )\n            .join('');\n    }\n    return null;\n}\n\nexport {xmlGetNodeText};\n","(function (GLOBAL) {\n    function decodeUTF8(s){\n        return decodeURIComponent(escape(s));\n    }\n\n    var JSUnzip = function (fileContents) {\n        this.fileContents = new JSUnzip.BigEndianBinaryStream(fileContents);\n    }\n    GLOBAL.JSUnzip = JSUnzip;\n    JSUnzip.MAGIC_NUMBER = 0x04034b50;\n\n    JSUnzip.prototype = {\n        readEntries: function () {\n            if (!this.isZipFile()) {\n                throw new Error(\"File is not a Zip file.\");\n            }\n\n            this.entries = [];\n            var e = new JSUnzip.ZipEntry(this.fileContents);\n            while (typeof(e.data) === \"string\") {\n                this.entries.push(e);\n                e = new JSUnzip.ZipEntry(this.fileContents);\n            }\n        },\n\n        isZipFile: function () {\n            return this.fileContents.getByteRangeAsNumber(0, 4) === JSUnzip.MAGIC_NUMBER;\n        }\n    }\n\n    JSUnzip.ZipEntry = function (binaryStream) {\n        this.signature          = binaryStream.getNextBytesAsNumber(4);\n        if (this.signature !== JSUnzip.MAGIC_NUMBER) {\n            return;\n        }\n\n        this.versionNeeded      = binaryStream.getNextBytesAsNumber(2);\n        this.bitFlag            = binaryStream.getNextBytesAsNumber(2);\n        this.compressionMethod  = binaryStream.getNextBytesAsNumber(2);\n        this.timeBlob           = binaryStream.getNextBytesAsNumber(4);\n\n        if (this.isEncrypted()) {\n            throw \"File contains encrypted entry. Not supported.\";\n        }\n\n\n        this.crc32              = binaryStream.getNextBytesAsNumber(4);\n        this.compressedSize     = binaryStream.getNextBytesAsNumber(4);\n        this.uncompressedSize   = binaryStream.getNextBytesAsNumber(4);\n\n        if (this.isUsingZip64()) {\n            throw \"File is using Zip64 (4gb+ file size). Not supported\";\n        }\n\n        this.fileNameLength     = binaryStream.getNextBytesAsNumber(2);\n        this.extraFieldLength   = binaryStream.getNextBytesAsNumber(2);\n\n        this.fileName  = binaryStream.getNextBytesAsString(this.fileNameLength);\n        this.extra     = binaryStream.getNextBytesAsString(this.extraFieldLength);\n        this.data      = binaryStream.getNextBytesAsString(this.compressedSize);\n\n        if (this.isUsingBit3TrailingDataDescriptor()) {\n            if (typeof(console) !== \"undefined\") {\n                console.log( \"File is using bit 3 trailing data descriptor. Not supported.\");\n            }\n            binaryStream.getNextBytesAsNumber(16);  //Skip the descriptor and move to beginning of next ZipEntry\n        }\n\n        if (this.isUsingUtf8()) {\n            this.fileName = decodeUTF8(this.fileName);\n        }\n\n    }\n\n    JSUnzip.ZipEntry.prototype = {\n        isEncrypted: function () {\n            return (this.bitFlag & 0x01) === 0x01;\n        },\n\n        isUsingUtf8: function () {\n            return (this.bitFlag & 0x0800) === 0x0800;\n        },\n\n        isUsingBit3TrailingDataDescriptor: function () {\n            return (this.bitFlag & 0x0008) === 0x0008;\n        },\n\n        isUsingZip64: function () {\n            return this.compressedSize === 0xFFFFFFFF ||\n                this.uncompressedSize === 0xFFFFFFFF;\n        }\n    }\n\n    JSUnzip.BigEndianBinaryStream = function (stream) {\n        this.stream = stream;\n        this.resetByteIndex();\n    }\n\n    JSUnzip.BigEndianBinaryStream.prototype = {\n        // The index of the current byte, used when we step through the byte\n        // with getNextBytesAs*.\n        resetByteIndex: function () {\n            this.currentByteIndex = 0;\n        },\n\n        getByteAt: function (index) {\n            return this.stream.charCodeAt(index);\n        },\n\n        getNextBytesAsNumber: function (steps) {\n            var res = this.getByteRangeAsNumber(this.currentByteIndex, steps);\n            this.currentByteIndex += steps;\n            return res;\n        },\n\n        getNextBytesAsString: function (steps) {\n            var res = this.getByteRangeAsString(this.currentByteIndex, steps);\n            this.currentByteIndex += steps;\n            return res;\n        },\n\n        // Big endian, so we're going backwards.\n        getByteRangeAsNumber: function (index, steps) {\n            var result = 0;\n            var i = index + steps - 1;\n            while (i >= index) {\n                result = (result << 8) + this.getByteAt(i);\n                i--;\n            }\n            return result;\n        },\n\n        getByteRangeAsString: function (index, steps) {\n            var result = \"\";\n            var max = index + steps;\n            var i = index;\n            while (i < max) {\n                var charCode = this.getByteAt(i);\n                result += String.fromCharCode(charCode);\n                // Accounting for multi-byte strings.\n                max -= Math.floor(charCode / 0x100);\n                i++;\n            }\n            return result;\n        }\n    }\n}(this));\n","import tynyInflate from 'tiny-inflate';\nimport {stringToArrayBuffer, arrayBufferToString} from '~/lib/binary-strings';\n\nfunction jsInflate(compressed, originalSize) {\n    if (originalSize === 0) {\n        return '';\n    }\n    const out = new Uint8Array(originalSize);\n    tynyInflate(new Uint8Array(stringToArrayBuffer(compressed)), out);\n    return arrayBufferToString(out);\n}\n\nexport default jsInflate;\n","function decode866(s) {\n    var c, i,\n        s2 = [];\n    for (i = 0; i < s.length; i++) {\n        c = s.charCodeAt(i);\n        if (c >= 128 && c <= 175) {\n            c += (0x410 - 128);\n        } else if (c >= 224 && c <= 239) {\n            c += (0x440 - 224);\n        } else if (c === 240) {\n            c = 0x0401;\n        } else if (c === 241) {\n            c = 0x0451;\n        }\n        s2.push(String.fromCharCode(c));\n    }\n    return s2.join('');\n}\n\nfunction decodeCP1251(s) {\n    var c, i,\n        s2 = [];\n    for (i = 0; i < s.length; i++) {\n        c = s.charCodeAt(i);\n        if (c >= 192 && c <= 255) {\n            c += (0x410 - 192);\n        } else if (c === 168) {\n            c = 0x0401;\n        } else if (c === 184) {\n            c = 0x0451;\n        }\n        s2.push(String.fromCharCode(c));\n    }\n    return s2.join('');\n}\n\nexport {decode866, decodeCP1251};\n\n","import BaseService from '../baseService';\nimport {parseNktkSequence, parseTrackUrlData, parseNktkFragment} from '../../parsers/nktk';\nimport config from '~/config';\nimport {parseHashParams} from '~/lib/leaflet.hashState/hashState';\nimport loadFromUrl from '../../loadFromUrl';\nimport loadTracksFromJson from './loadTracksFromJson';\nimport {fetch} from '~/lib/xhr-promise';\n\nfunction flattenArray(ar) {\n    const res = [];\n    for (const it of ar) {\n        res.push(...it);\n    }\n    return res;\n}\n\nfunction parsePointFromHashValues(values) {\n    if (values.length < 2) {\n        return [{name: 'Point in url', error: 'CORRUPT'}];\n    }\n    const lat = parseFloat(values[0]);\n    const lng = parseFloat(values[1]);\n    if (isNaN(lat) || isNaN(lng) || lat < -90 || lat > 90 || lng < -180 || lng > 180) {\n        return [{name: 'Point in url', error: 'CORRUPT'}];\n    }\n    const name = ((values[2] || '').trim()) || 'Point';\n    return [{name, points: [{name, lat, lng}]}];\n}\n\nclass NakarteTrack extends BaseService {\n    isOurUrl() {\n        return this.origUrl.indexOf('track://') > -1;\n    }\n\n    requestOptions() {\n        return [];\n    }\n\n    parseResponse() {\n        const i = this.origUrl.indexOf('track://');\n        return parseTrackUrlData(this.origUrl.substring(i + 8));\n    }\n}\n\nclass NakarteUrlLoader {\n    constructor() {\n        this.loaders = {\n            nktk: this.loadFromTextEncodedTrack,\n            nktl: this.loadFromTextEncodedTrackId,\n            nktu: this.loadFromUrlencodedUrls,\n            nktp: this.loadPoint,\n            nktj: this.loadFromJSON\n        };\n    }\n\n    paramNames() {\n        return Object.keys(this.loaders);\n    }\n\n    async geoData(paramName, values) {\n        const loader = this.loaders[paramName];\n        return loader.call(this, values);\n    }\n\n    async loadFromTextEncodedTrack(values) {\n        return flattenArray(values.map(parseNktkFragment));\n    }\n\n    async loadFromTextEncodedTrackId(values) {\n        const requests = values.map((trackId) =>\n            fetch(\n                `${config.tracksStorageServer}/track/${trackId}`,\n                {responseType: 'binarystring', withCredentials: true}\n            )\n        );\n        let responses;\n        try {\n            responses = await Promise.all(requests);\n        } catch (e) {\n            return [{name: 'Track from nakarte server', error: 'NETWORK'}];\n        }\n        return flattenArray(responses.map((r) => parseNktkSequence(r.responseBinaryText)));\n    }\n\n    async loadFromJSON(values) {\n        return flattenArray(await Promise.all(values.map(loadTracksFromJson)));\n    }\n\n    async loadFromUrlencodedUrls(values) {\n        return flattenArray(await Promise.all(values.map(decodeURIComponent).map(loadFromUrl)));\n    }\n\n    async loadPoint(values) {\n        return parsePointFromHashValues(values.map(decodeURIComponent));\n    }\n}\n\nclass NakarteUrl {\n    constructor(url) {\n        const paramNames = new NakarteUrlLoader().paramNames();\n        this._params = Object.entries(parseHashParams(url))\n            .filter(([name]) => paramNames.includes(name));\n    }\n\n    isOurUrl() {\n        return this._params.length > 0;\n    }\n\n    async geoData() {\n        const promises = this._params.map(([paramName, value]) => new NakarteUrlLoader().geoData(paramName, value));\n        return flattenArray(await Promise.all(promises));\n    }\n}\n\nexport {NakarteTrack, NakarteUrl, NakarteUrlLoader};\n","function encode(s) {\n    return (btoa(s)\n            .replace(/\\+/ug, '-')\n            .replace(/\\//ug, '_')\n        // .replace(/=+$/, '')\n    );\n}\n\nfunction decode(s) {\n    var decoded;\n    s = s\n        .replace(/[\\n\\r \\t]/ug, '')\n        .replace(/-/ug, '+')\n        .replace(/_/ug, '/');\n    try {\n        decoded = atob(s);\n    } catch (e) {\n        // will return null for malformed data\n    }\n    if (decoded && decoded.length) {\n        return decoded;\n    }\n    return null;\n}\n\nexport {encode, decode};\n","import L from 'leaflet';\nimport './elevation-profile.css';\nimport {ElevationProvider} from '~/lib/elevations';\nimport '~/lib/leaflet.control.commons';\nimport {notify} from '~/lib/notifications';\nimport * as logging from '~/lib/logging';\nimport {DragEvents} from '~/lib/leaflet.events.drag';\n\nfunction calcSamplingInterval(length) {\n    var targetPointsN = 2000;\n    var maxPointsN = 9999;\n    var samplingIntgerval = length / targetPointsN;\n    if (samplingIntgerval < 10) {\n        samplingIntgerval = 10;\n    }\n    if (samplingIntgerval > 50) {\n        samplingIntgerval = 50;\n    }\n    if (length / samplingIntgerval > maxPointsN) {\n        samplingIntgerval = length / maxPointsN;\n    }\n    return samplingIntgerval;\n}\n\nfunction createSvg(tagName, attributes, parent) {\n    var element = document.createElementNS('http://www.w3.org/2000/svg', tagName);\n    if (attributes) {\n        var keys = Object.keys(attributes),\n            key, value;\n        for (var i = 0; i < keys.length; i++) {\n            key = keys[i];\n            value = attributes[key];\n            element.setAttribute(key, value);\n        }\n    }\n    if (parent) {\n        parent.appendChild(element);\n    }\n    return element;\n}\n\nfunction pointOnSegmentAtDistance(p1, p2, dist) {\n    // FIXME: we should place markers along projected line to avoid transformation distortions\n    var q = dist / p1.distanceTo(p2),\n        x = p1.lng + (p2.lng - p1.lng) * q,\n        y = p1.lat + (p2.lat - p1.lat) * q;\n    return L.latLng(y, x);\n}\n\nfunction gradientToAngle(g) {\n    return Math.round(Math.atan(g) * 180 / Math.PI);\n}\n\nfunction pathRegularSamples(latlngs, step) {\n    if (!latlngs.length) {\n        return [];\n    }\n    var samples = [],\n        lastSampleDist = 0,\n        lastPointDistance = 0,\n        nextPointDistance = 0,\n        segmentLength, i;\n\n    samples.push(latlngs[0]);\n    for (i = 1; i < latlngs.length; i++) {\n        segmentLength = latlngs[i].distanceTo(latlngs[i - 1]);\n        nextPointDistance = lastPointDistance + segmentLength;\n        if (nextPointDistance >= lastSampleDist + step) {\n            while (lastSampleDist + step <= nextPointDistance) {\n                lastSampleDist += step;\n                samples.push(\n                    pointOnSegmentAtDistance(latlngs[i - 1], latlngs[i], lastSampleDist - lastPointDistance)\n                );\n            }\n        }\n        lastPointDistance = nextPointDistance;\n    }\n    if (samples.length < 2) {\n        samples.push(latlngs[latlngs.length - 1]);\n    }\n    return samples;\n}\n\nconst ElevationProfile = L.Class.extend({\n        options: {\n            samplingInterval: 50,\n            sightLine: false\n        },\n\n        includes: L.Evented,\n\n        initialize: function(map, latlngs, options) {\n            L.setOptions(this, options);\n            this.path = latlngs;\n            var samples = this.samples = pathRegularSamples(this.path, this.options.samplingInterval);\n            samples = samples.map((latlng) => latlng.wrap());\n            if (!samples.length) {\n                notify('Track is empty');\n                return;\n            }\n            var that = this;\n            this.horizZoom = 1;\n            this.dragStart = null;\n            new ElevationProvider().get(samples)\n                .then(function(values) {\n                        that.values = values;\n                        that._addTo(map);\n                    }\n                )\n                .catch((e) => {\n                    logging.captureException(e, 'error getting elevation');\n                    notify(`Failed to get elevation data: ${e.message}`);\n                });\n            this.values = null;\n        },\n\n        _onWindowResize: function() {\n            this._resizeGraph();\n        },\n\n        _resizeGraph: function() {\n            const newSvgWidth = this.drawingContainer.clientWidth * this.horizZoom;\n            if (this.svgWidth < this.drawingContainer.clientWidth) {\n                this.svgWidth = newSvgWidth;\n                this.svg.setAttribute('width', this.svgWidth + 'px');\n                this.updateGraph();\n                this.updateGraphSelection();\n            }\n        },\n\n        _addTo: function(map) {\n            this._map = map;\n            var container = this._container = L.DomUtil.create('div', 'elevation-profile-container');\n            L.Control.prototype._stopContainerEvents.call(this);\n            this._map._controlContainer.appendChild(container);\n            this.setupContainerLayout();\n            this.updateGraph();\n            const icon = L.divIcon({\n                    className: 'elevation-profile-marker',\n                    html:\n                        '<div class=\"elevation-profile-marker-icon\"></div>' +\n                        '<div class=\"elevation-profile-marker-label\"></div>'\n                }\n            );\n            this.trackMarker = L.marker([1000, 0], {interactive: false, icon: icon});\n            this.polyline = L.polyline(this.path, {weight: 30, opacity: 0}).addTo(map);\n            this.polyline.on('mousemove', this.onLineMouseMove, this);\n            this.polyline.on('mouseover', this.onLineMouseEnter, this);\n            this.polyline.on('mouseout', this.onLineMouseLeave, this);\n            this.polyLineSelection = L.polyline([], {weight: 20, opacity: 0.5, color: 'yellow', lineCap: 'butt'});\n            return this;\n        },\n\n        setupContainerLayout: function() {\n            var horizZoom = this.horizZoom = 1;\n            var container = this._container;\n            this.propsContainer = L.DomUtil.create('div', 'elevation-profile-properties', container);\n            this.leftAxisLables = L.DomUtil.create('div', 'elevation-profile-left-axis', container);\n            this.closeButton = L.DomUtil.create('div', 'elevation-profile-close', container);\n            L.DomEvent.on(this.closeButton, 'click', this.onCloseButtonClick, this);\n            this.drawingContainer = L.DomUtil.create('div', 'elevation-profile-drawingContainer', container);\n            this.graphCursor = L.DomUtil.create('div', 'elevation-profile-cursor elevation-profile-cursor-hidden',\n                this.drawingContainer\n            );\n            this.graphCursorLabel =\n                L.DomUtil.create('div', 'elevation-profile-cursor-label elevation-profile-cursor-hidden',\n                    this.drawingContainer\n                );\n            this.graphSelection = L.DomUtil.create('div', 'elevation-profile-selection elevation-profile-cursor-hidden',\n                this.drawingContainer\n            );\n            var svgWidth = this.svgWidth = this.drawingContainer.clientWidth * horizZoom,\n                svgHeight = this.svgHeight = this.drawingContainer.clientHeight;\n            var svg = this.svg = createSvg('svg', {width: svgWidth, height: svgHeight}, this.drawingContainer);\n            L.DomEvent.on(svg, 'mousemove', this.onSvgMouseMove, this);\n            // We should handle mouseenter event, but due to a\n            // bug in Chrome (https://bugs.chromium.org/p/chromium/issues/detail?id=846738)\n            // this event is emitted while resizing window by dragging right window frame\n            // which causes cursor to appeat while resizing\n            L.DomEvent.on(svg, 'mousemove', this.onSvgEnter, this);\n            L.DomEvent.on(svg, 'mouseleave', this.onSvgLeave, this);\n            L.DomEvent.on(svg, 'mousewheel', this.onSvgMouseWheel, this);\n            this.svgDragEvents = new DragEvents(this.svg, {dragButtons: [0, 2], stopOnLeave: true});\n            this.svgDragEvents.on('dragstart', this.onSvgDragStart, this);\n            this.svgDragEvents.on('dragend', this.onSvgDragEnd, this);\n            this.svgDragEvents.on('drag', this.onSvgDrag, this);\n            this.svgDragEvents.on('click', this.onSvgClick, this);\n            L.DomEvent.on(svg, 'dblclick', this.onSvgDblClick, this);\n            L.DomEvent.on(window, 'resize', this._onWindowResize, this);\n        },\n\n        removeFrom: function(map) {\n            if (this.abortLoading) {\n                this.abortLoading();\n            }\n            if (!this._map) {\n                return this;\n            }\n            this._map._controlContainer.removeChild(this._container);\n            map.removeLayer(this.polyline);\n            map.removeLayer(this.trackMarker);\n            map.removeLayer(this.polyLineSelection);\n            L.DomEvent.off(window, 'resize', this._onWindowResize, this);\n            this._map = null;\n            return this;\n        },\n\n        onSvgDragStart: function(e) {\n            if (e.dragButton === 0) {\n                // FIXME: restore hiding when we make display of selection on map\n                // this.cursorHide();\n                this.polyLineSelection.addTo(this._map).bringToBack();\n                this.selStartIndex = this.roundedSampleIndexFromMouseEvent(e);\n            }\n        },\n\n        graphContainerOffsetFromMouseEvent: function(e) {\n            if (e.originalEvent) {\n                e = e.originalEvent;\n            }\n            let x = e.clientX - this.svg.getBoundingClientRect().left;\n            if (x < 0) {\n                x = 0;\n            }\n            if (x > this.svgWidth - 1) {\n                x = this.svgWidth - 1;\n            }\n            return x;\n        },\n\n        sampleIndexFromMouseEvent: function(e) {\n            const x = this.graphContainerOffsetFromMouseEvent(e);\n            return x / (this.svgWidth - 1) * (this.values.length - 1);\n        },\n\n        roundedSampleIndexFromMouseEvent: function(e) {\n            return Math.round(this.sampleIndexFromMouseEvent(e));\n        },\n\n        setTrackMarkerLabel: function(label) {\n            const icon = this.trackMarker._icon;\n            if (!icon) {\n                return;\n            }\n            icon.getElementsByClassName('elevation-profile-marker-label')[0].innerHTML = label;\n        },\n\n        setGraphSelection: function(cursorIndex) {\n            this.selMinInd = Math.min(cursorIndex, this.selStartIndex);\n            this.selMaxInd = Math.max(cursorIndex, this.selStartIndex);\n\n            if (this.selMinInd < 0) {\n                this.selMinInd = 0;\n            }\n            if (this.selMaxInd > this.values.length - 1) {\n                this.selMaxInd = this.values.length - 1;\n            }\n            this.updateGraphSelection();\n            L.DomUtil.removeClass(this.graphSelection, 'elevation-profile-cursor-hidden');\n        },\n\n        updateGraphSelection: function() {\n            const selStart = this.selMinInd * (this.svgWidth - 1) / (this.values.length - 1);\n            const selEnd = this.selMaxInd * (this.svgWidth - 1) / (this.values.length - 1);\n            this.graphSelection.style.left = selStart + 'px';\n            this.graphSelection.style.width = (selEnd - selStart) + 'px';\n        },\n\n        onSvgDragEnd: function(e) {\n            if (e.dragButton === 0) {\n                this.cursorShow();\n                this.setGraphSelection(this.roundedSampleIndexFromMouseEvent(e));\n                var stats = this.calcProfileStats(this.values.slice(this.selMinInd, this.selMaxInd + 1));\n                this.updatePropsDisplay(stats);\n                L.DomUtil.addClass(this.propsContainer, 'elevation-profile-properties-selected');\n            }\n            if (e.dragButton === 2) {\n                this.drawingContainer.scrollLeft -= e.dragMovement.x;\n            }\n        },\n\n        onSvgDrag: function(e) {\n            if (e.dragButton === 0) {\n                this.setGraphSelection(this.roundedSampleIndexFromMouseEvent(e));\n                this.polyLineSelection.setLatLngs(this.samples.slice(this.selMinInd, this.selMaxInd + 1));\n            }\n            if (e.dragButton === 2) {\n                this.drawingContainer.scrollLeft -= e.dragMovement.x;\n            }\n        },\n\n        onSvgClick: function(e) {\n            const button = e.originalEvent.button;\n            if (button === 0) {\n                this.dragStart = null;\n                L.DomUtil.addClass(this.graphSelection, 'elevation-profile-cursor-hidden');\n                L.DomUtil.removeClass(this.propsContainer, 'elevation-profile-properties-selected');\n                this._map.removeLayer(this.polyLineSelection);\n                if (this.stats) {\n                    this.updatePropsDisplay(this.stats);\n                }\n            }\n            if (button === 2) {\n                this.setMapPositionAtIndex(this.roundedSampleIndexFromMouseEvent(e));\n            }\n        },\n\n        onSvgDblClick: function(e) {\n            this.setMapPositionAtIndex(this.roundedSampleIndexFromMouseEvent(e));\n        },\n\n        setMapPositionAtIndex: function(ind) {\n            var latlng = this.samples[ind];\n            if (latlng) {\n                this._map.panTo(latlng);\n            }\n        },\n\n        onSvgMouseWheel: function(e) {\n            var oldHorizZoom = this.horizZoom;\n            this.horizZoom += L.DomEvent.getWheelDelta(e) > 0 ? 1 : -1;\n            if (this.horizZoom < 1) {\n                this.horizZoom = 1;\n            }\n            if (this.horizZoom > 10) {\n                this.horizZoom = 10;\n            }\n\n            var ind = this.sampleIndexFromMouseEvent(e);\n\n            var newScrollLeft = this.drawingContainer.scrollLeft +\n                this.graphContainerOffsetFromMouseEvent(e) * (this.horizZoom / oldHorizZoom - 1);\n            if (newScrollLeft < 0) {\n                newScrollLeft = 0;\n            }\n\n            this.svgWidth = this.drawingContainer.clientWidth * this.horizZoom;\n            this.svg.setAttribute('width', this.svgWidth + 'px');\n            this.setupGraph();\n            if (newScrollLeft > this.svgWidth - this.drawingContainer.clientWidth) {\n                newScrollLeft = this.svgWidth - this.drawingContainer.clientWidth;\n            }\n            this.drawingContainer.scrollLeft = newScrollLeft;\n\n            this.cursorHide();\n            this.setCursorPosition(ind);\n            this.cursorShow();\n            this.updateGraphSelection();\n        },\n\n        updateGraph: function() {\n            if (!this._map || !this.values) {\n                return;\n            }\n\n            this.stats = this.calcProfileStats(this.values);\n            this.updatePropsDisplay(this.stats);\n            this.setupGraph();\n        },\n\n        updatePropsDisplay: function(stats) {\n            if (!this._map) {\n                return;\n            }\n            let d;\n            if (stats.noData) {\n                d = {\n                    maxElev: '-',\n                    minElev: '-',\n                    startElev: '-',\n                    endElev: '-',\n                    change: '-',\n                    ascentAngleStr: '-',\n                    descentAngleStr: '-',\n                    ascent: '-',\n                    descent: '-',\n                    startApprox: '',\n                    endApprox: '',\n                    approx: '',\n                    incomplete: 'No elevation data',\n                };\n            } else {\n                d = {\n                    maxElev: Math.round(stats.max),\n                    minElev: Math.round(stats.min),\n                    startElev: Math.round(stats.start),\n                    endElev: Math.round(stats.end),\n                    change: Math.round(stats.finalAscent),\n                    ascentAngleStr: isNaN(stats.angleAvgAscent) ? '-' : L.Util.template('{avg} / {max}&deg;',\n                            {avg: stats.angleAvgAscent, max: stats.angleMaxAscent}\n                        ),\n                    descentAngleStr: isNaN(stats.angleAvgDescent) ? '-' : L.Util.template('{avg} / {max}&deg;',\n                            {avg: stats.angleAvgDescent, max: stats.angleMaxDescent}\n                        ),\n                    ascent: Math.round(stats.ascent),\n                    descent: Math.round(stats.descent),\n                    dist: (stats.distance / 1000).toFixed(1),\n                    startApprox: stats.dataLostAtStart > 0.02 ? '~ ' : '',\n                    endApprox: stats.dataLostAtEnd > 0.02 ? '~ ' : '',\n                    approx: stats.dataLost > 0.02 ? '~ ' : '',\n                    incomplete: stats.dataLost > 0.02 ? 'Some elevation data missing' : '',\n                };\n            }\n            d.dist = (stats.distance / 1000).toFixed(1);\n\n            this.propsContainer.innerHTML = `\n                <table>\n                <tr><td>Максимальная высота:</td><td>${d.maxElev}</td></tr>\n                <tr><td>Минимальная высота:</td><td>${d.minElev}</td></tr>\n                <tr class=\"start-group\"><td>Высота в начале:</td><td>${d.startApprox}${d.startElev}</td></tr>\n                <tr><td>Высота в конце:</td><td>${d.endApprox}${d.endElev}</td></tr>\n                <tr><td>Разница:</td><td>${d.startApprox || d.endApprox}${d.change}</td></tr>\n                <tr class=\"start-group\"><td>Сред. / Макс. наклон подъёма:</td><td>${d.ascentAngleStr}</td></tr>\n                <tr><td>Сред. / Макс. наклон спуска:</td><td>${d.descentAngleStr}</td></tr>\n                <tr class=\"start-group\"><td>Набор высоты:</td><td>${d.approx}${d.ascent}</td></tr>\n                <tr><td>Сброс высоты:</td><td>${d.approx}${d.descent}</td></tr>\n                <tr class=\"start-group\"><td>Дистанция:</td><td>${d.dist} km</td></tr>\n                <tr><td colspan=\"2\" style=\"text-align: center\">${d.incomplete}</td></tr>\n                </table>\n                `;\n        },\n\n        calcGridValues: function(minValue, maxValue) {\n            var ticksNs = [3, 4, 5],\n                tickSteps = [1, 2, 5, 10, 20, 50, 100, 200, 500, 1000, 2000, 5000, 10000],\n                ticks = [],\n                i, j, k, ticksN, tickStep, tick1, tick2,\n                matchFound = false;\n\n            for (i = 0; i < tickSteps.length; i++) {\n                tickStep = tickSteps[i];\n                for (j = 0; j < ticksNs.length; j++) {\n                    ticksN = ticksNs[j];\n                    tick1 = Math.floor(minValue / tickStep);\n                    tick2 = Math.ceil(maxValue / tickStep);\n                    if ((tick2 - tick1) < ticksN) {\n                        matchFound = true;\n                        break;\n                    }\n                }\n                if (matchFound) {\n                    break;\n                }\n            }\n            for (k = tick1; k < tick1 + ticksN; k++) {\n                ticks.push(k * tickStep);\n            }\n            return ticks;\n        },\n\n        filterElevations: function(values, tolerance) {\n            var filtered = values.slice(0);\n            if (filtered.length < 3) {\n                return filtered;\n            }\n            var scanStart, scanEnd, job, linearValue, linearDelta, maxError, maxErrorInd, i, error;\n            var queue = [[0, filtered.length - 1]];\n            while (queue.length) {\n                job = queue.pop();\n                scanStart = job[0];\n                scanEnd = job[1];\n                linearValue = filtered[scanStart];\n                linearDelta = (filtered[scanEnd] - filtered[scanStart]) / (scanEnd - scanStart);\n                maxError = null;\n                maxErrorInd = null;\n                for (i = scanStart + 1; i < scanEnd; i++) {\n                    linearValue += linearDelta;\n                    if (filtered[i] === null) {\n                        continue;\n                    }\n                    error = Math.abs(filtered[i] - linearValue);\n                    if (error === null || error > maxError) {\n                        maxError = error;\n                        maxErrorInd = i;\n                    }\n                }\n                if (maxError > tolerance) {\n                    if (scanEnd > scanStart + 2) {\n                        queue.push([scanStart, maxErrorInd]);\n                        queue.push([maxErrorInd, scanEnd]);\n                    }\n                } else {\n                    filtered.splice(scanStart + 1, scanEnd - scanStart - 1);\n                }\n            }\n            return filtered;\n        },\n\n        calcProfileStats: function(values) {\n            const stats = {\n                distance: (values.length - 1) * this.options.samplingInterval\n            };\n            const notNullValues = values.filter((value) => value !== null);\n            if (notNullValues.length === 0) {\n                stats.noData = true;\n                return stats;\n            }\n            stats.min = Math.min(...notNullValues);\n            stats.max = Math.max(...notNullValues);\n            let firstNotNullIndex = true,\n                lastNotNullIndex = true,\n                firstNotNullValue,\n                lastNotNullValue;\n            for (let i = 0; i < values.length; i++) {\n                let value = values[i];\n                if (value !== null) {\n                    firstNotNullValue = value;\n                    firstNotNullIndex = i;\n                    break;\n                }\n            }\n            for (let i = values.length - 1; i >= 0; i--) {\n                let value = values[i];\n                if (value !== null) {\n                    lastNotNullValue = value;\n                    lastNotNullIndex = i;\n                    break;\n                }\n            }\n            stats.finalAscent = lastNotNullValue - firstNotNullValue;\n\n            const ascents = [],\n                descents = [];\n            let prevNotNullValue = values[firstNotNullIndex],\n                prevNotNullIndex = firstNotNullIndex;\n            for (let i = firstNotNullIndex + 1; i <= lastNotNullIndex; i++) {\n                let value = values[i];\n                if (value === null) {\n                    continue;\n                }\n                let length = i - prevNotNullIndex;\n                let gradient = (value - prevNotNullValue) / length;\n                if (gradient > 0) {\n                    for (let j = 0; j < length; j++) {\n                        ascents.push(gradient);\n                    }\n                } else if (gradient < 0) {\n                    for (let j = 0; j < length; j++) {\n                        descents.push(-gradient);\n                    }\n                }\n                prevNotNullIndex = i;\n                prevNotNullValue = value;\n            }\n            function sum(a, b) {\n                return a + b;\n            }\n            if (ascents.length !== 0) {\n                stats.gradientAvgAscent = ascents.reduce(sum, 0) / ascents.length / this.options.samplingInterval;\n                stats.gradientMinAscent = Math.min(...ascents) / this.options.samplingInterval;\n                stats.gradientMaxAscent = Math.max(...ascents) / this.options.samplingInterval;\n                stats.angleAvgAscent = gradientToAngle(stats.gradientAvgAscent);\n                stats.angleMinAscent = gradientToAngle(stats.gradientMinAscent);\n                stats.angleMaxAscent = gradientToAngle(stats.gradientMaxAscent);\n            }\n            if (descents.length !== 0) {\n                stats.gradientAvgDescent = descents.reduce(sum, 0) / descents.length / this.options.samplingInterval;\n                stats.gradientMinDescent = Math.min(...descents) / this.options.samplingInterval;\n                stats.gradientMaxDescent = Math.max(...descents) / this.options.samplingInterval;\n                stats.angleAvgDescent = gradientToAngle(stats.gradientAvgDescent);\n                stats.angleMinDescent = gradientToAngle(stats.gradientMinDescent);\n                stats.angleMaxDescent = gradientToAngle(stats.gradientMaxDescent);\n            }\n\n            stats.start = firstNotNullValue;\n            stats.end = lastNotNullValue;\n            stats.distance = (values.length - 1) * this.options.samplingInterval;\n            stats.dataLostAtStart = firstNotNullIndex / values.length;\n            stats.dataLostAtEnd = 1 - lastNotNullIndex / (values.length - 1);\n            stats.dataLost = 1 - notNullValues.length / values.length;\n\n            const filterTolerance = 5;\n            const filtered = this.filterElevations(values.slice(firstNotNullIndex, lastNotNullIndex), filterTolerance);\n            let ascent = 0,\n                descent = 0,\n                delta;\n            for (let i = 1; i < filtered.length; i++) {\n                delta = filtered[i] - filtered[i - 1];\n                if (delta < 0) {\n                    descent += -delta;\n                } else {\n                    ascent += delta;\n                }\n            }\n            stats.ascent = ascent;\n            stats.descent = descent;\n\n            return stats;\n        },\n\n        setCursorPosition: function(ind) {\n            if (!this._map || !this.values) {\n                return;\n            }\n            const samplingInterval = this.options.samplingInterval;\n            const distanceKm = samplingInterval * ind / 1000;\n            const distanceStr = `${distanceKm.toFixed(2)} km`;\n            const sample1 = this.values[Math.ceil(ind)];\n            const sample2 = this.values[Math.floor(ind)];\n            let angleStr;\n            if (sample1 !== null && sample2 !== null) {\n                const gradient = (sample2 - sample1) / samplingInterval;\n                angleStr = `${Math.round(Math.atan(gradient) * 180 / Math.PI)}&deg`;\n            } else {\n                angleStr = '-';\n            }\n\n            const x = Math.round(ind / (this.values.length - 1) * (this.svgWidth - 1));\n            const indInt = Math.round(ind);\n            let elevation = this.values[indInt];\n            if (elevation === null) {\n                elevation = sample1;\n            }\n            if (elevation === null) {\n                elevation = sample2;\n            }\n            const elevationStr = (elevation === null) ? '-' : `${elevation} m`;\n\n            const cursorLabel = `${elevationStr}<br>${distanceStr}<br>${angleStr}`;\n\n            this.graphCursorLabel.innerHTML = cursorLabel;\n\n            this.graphCursor.style.left = x + 'px';\n            this.graphCursorLabel.style.left = x + 'px';\n            if (this.drawingContainer.getBoundingClientRect().left - this.drawingContainer.scrollLeft + x +\n                this.graphCursorLabel.offsetWidth >= this.drawingContainer.getBoundingClientRect().right) {\n                L.DomUtil.addClass(this.graphCursorLabel, 'elevation-profile-cursor-label-left');\n            } else {\n                L.DomUtil.removeClass(this.graphCursorLabel, 'elevation-profile-cursor-label-left');\n            }\n\n            let markerPos;\n            if (ind <= 0) {\n                markerPos = this.samples[0];\n            } else if (ind >= this.samples.length - 1) {\n                markerPos = this.samples[this.samples.length - 1];\n            } else {\n                const p1 = this.samples[Math.floor(ind)],\n                    p2 = this.samples[Math.ceil(ind)],\n                    indFrac = ind - Math.floor(ind);\n                markerPos = [p1.lat + (p2.lat - p1.lat) * indFrac, p1.lng + (p2.lng - p1.lng) * indFrac];\n            }\n            this.trackMarker.setLatLng(markerPos);\n\n            this.setTrackMarkerLabel(cursorLabel);\n        },\n\n        onSvgMouseMove: function(e) {\n            if (!this.values) {\n                return;\n            }\n            this.setCursorPosition(this.sampleIndexFromMouseEvent(e));\n        },\n\n        cursorShow: function() {\n            L.DomUtil.removeClass(this.graphCursor, 'elevation-profile-cursor-hidden');\n            L.DomUtil.removeClass(this.graphCursorLabel, 'elevation-profile-cursor-hidden');\n            this._map.addLayer(this.trackMarker);\n        },\n\n        cursorHide: function() {\n            L.DomUtil.addClass(this.graphCursor, 'elevation-profile-cursor-hidden');\n            L.DomUtil.addClass(this.graphCursorLabel, 'elevation-profile-cursor-hidden');\n            this._map.removeLayer(this.trackMarker);\n        },\n\n        onSvgEnter: function() {\n            this.cursorShow();\n        },\n\n        onSvgLeave: function() {\n            this.cursorHide();\n        },\n\n        onLineMouseEnter: function() {\n            this.cursorShow();\n        },\n\n        onLineMouseLeave: function() {\n            this.cursorHide();\n        },\n\n        onLineMouseMove: function(e) {\n            function sqrDist(latlng1, latlng2) {\n                var dx = (latlng1.lng - latlng2.lng);\n                var dy = (latlng1.lat - latlng2.lat);\n                return dx * dx + dy * dy;\n            }\n\n            var nearestInd = null,\n                ind,\n                minDist = null,\n                mouseLatlng = e.latlng,\n                i, sampleLatlng, dist, di;\n            let nextDist,\n                nextSampleDist,\n                prevDist,\n                prevSampleDist;\n            for (i = 0; i < this.samples.length; i++) {\n                sampleLatlng = this.samples[i];\n                dist = sqrDist(sampleLatlng, mouseLatlng);\n                if (nearestInd === null || dist < minDist) {\n                    nearestInd = i;\n                    minDist = dist;\n                }\n            }\n\n            if (nearestInd !== null) {\n                ind = nearestInd;\n                if (nearestInd > 0) {\n                    prevDist = sqrDist(mouseLatlng, this.samples[nearestInd - 1]);\n                    prevSampleDist = sqrDist(this.samples[nearestInd], this.samples[nearestInd - 1]);\n                }\n                if (nearestInd < this.samples.length - 1) {\n                    nextDist = sqrDist(mouseLatlng, this.samples[nearestInd + 1]);\n                    nextSampleDist = sqrDist(this.samples[nearestInd], this.samples[nearestInd + 1]);\n                }\n\n                if (nearestInd === 0) {\n                    if (nextDist < minDist + nextSampleDist) {\n                        di = (minDist - nextDist) / 2 / nextSampleDist + 1 / 2;\n                    } else {\n                        di = 0.001;\n                    }\n                } else if (nearestInd === this.samples.length - 1) {\n                    if (prevDist < minDist + prevSampleDist) {\n                        di = -((minDist - prevDist) / 2 / prevSampleDist + 1 / 2);\n                    } else {\n                        di = -0.001;\n                    }\n                } else {\n                    if (prevDist < nextDist) {\n                        di = -((minDist - prevDist) / 2 / prevSampleDist + 1 / 2);\n                    } else {\n                        di = (minDist - nextDist) / 2 / nextSampleDist + 1 / 2;\n                    }\n                }\n                if (di < -1) {\n                    di = -1;\n                }\n                if (di > 1) {\n                    di = 1;\n                }\n                this.setCursorPosition(ind + di);\n            }\n        },\n\n        setupGraph: function() {\n            if (!this._map || !this.values) {\n                return;\n            }\n\n            while (this.svg.hasChildNodes()) {\n                this.svg.removeChild(this.svg.lastChild);\n            }\n            while (this.leftAxisLables.hasChildNodes()) {\n                this.leftAxisLables.removeChild(this.leftAxisLables.lastChild);\n            }\n\n            var maxValue = Math.max.apply(null, this.values),\n                minValue = Math.min.apply(null, this.values),\n                svg = this.svg,\n                path, i, horizStep, verticalMultiplier, x, y, gridValues, label;\n\n            var paddingBottom = 8 + 16,\n                paddingTop = 8;\n\n            gridValues = this.calcGridValues(minValue, maxValue);\n            var gridStep = (this.svgHeight - paddingBottom - paddingTop) / (gridValues.length - 1);\n            for (i = 0; i < gridValues.length; i++) {\n                y = Math.round(i * gridStep - 0.5) + 0.5 + paddingTop;\n                path = L.Util.template('M{x1} {y} L{x2} {y}', {x1: 0, x2: this.svgWidth * this.horizZoom, y: y});\n                createSvg(\n                    'path',\n                    {'d': path, 'stroke-width': '1px', 'stroke': 'green', 'fill': 'none', 'stroke-opacity': '0.5'},\n                    svg\n                );\n\n                label = L.DomUtil.create('div', 'elevation-profile-grid-label', this.leftAxisLables);\n                label.innerHTML = gridValues[gridValues.length - i - 1];\n                label.style.top = (gridStep * i + paddingTop) + 'px';\n            }\n\n            horizStep = this.svgWidth / (this.values.length - 1);\n            verticalMultiplier =\n                (this.svgHeight - paddingTop - paddingBottom) / (gridValues[gridValues.length - 1] - gridValues[0]);\n\n            path = [];\n            const valueToSvgCoord = (el) => {\n                const y = (el - gridValues[0]) * verticalMultiplier;\n                return this.svgHeight - y - paddingBottom;\n            };\n\n            let startNewSegment = true;\n            for (i = 0; i < this.values.length; i++) {\n                let value = this.values[i];\n                if (value === null) {\n                    startNewSegment = true;\n                    continue;\n                }\n                path.push(startNewSegment ? 'M' : 'L');\n                x = i * horizStep;\n                y = valueToSvgCoord(value);\n                path.push(x + ' ' + y + ' ');\n                startNewSegment = false;\n            }\n            path = path.join('');\n            createSvg('path', {'d': path, 'stroke-width': '1px', 'stroke': 'brown', 'fill': 'none'}, svg);\n            // sightline\n            if (this.options.sightLine) {\n                path = L.Util.template('M{x1} {y1} L{x2} {y2}', {\n                        x1: 0,\n                        x2: this.svgWidth * this.horizZoom,\n                        y1: valueToSvgCoord(this.values[0]),\n                        y2: valueToSvgCoord(this.values[this.values.length - 1])\n                    }\n                );\n                createSvg(\n                    'path',\n                    {'d': path, 'stroke-width': '3px', 'stroke': '#94b1ff', 'fill': 'none', 'stroke-opacity': '0.5'},\n                    svg\n                );\n            }\n        },\n\n        onCloseButtonClick: function() {\n            this.removeFrom(this._map);\n        }\n    }\n);\n\nexport {ElevationProfile, calcSamplingInterval};\n","import config from '~/config';\nimport {fetch} from '~/lib/xhr-promise';\n\nclass ElevationProvider {\n    chunkSize = 10000;\n\n    constructor(serverUrl = config.elevationsServer) {\n        this.url = serverUrl;\n    }\n\n    async get(latlngs) {\n        const result = [];\n        for (let i = 0; i < latlngs.length; i += this.chunkSize) {\n            const chunk = latlngs.slice(i, i + this.chunkSize);\n            const request = chunk.map((ll) => `${ll.lat.toFixed(6)} ${ll.lng.toFixed(6)}`).join('\\n');\n            const xhr = await fetch(this.url, {method: 'POST', data: request, withCredentials: true});\n            const respValues = xhr.responseText.split('\\n').map((line) => (line === 'NULL' ? null : parseFloat(line)));\n            result.push(...respValues);\n        }\n        return result;\n    }\n}\n\nexport {ElevationProvider};\n","import L from 'leaflet';\nimport './style.css';\n\nfunction enableTopRow(control) {\n    const originalOnAdd = control.onAdd;\n    if (control._topRowEnabled) {\n        return;\n    }\n\n    L.Util.extend(control, {\n        _topRowEnabled: true,\n\n        onAdd: function(map) {\n            const container = originalOnAdd.call(this, map);\n            setTimeout(() => this.__injectTopRow(), 0);\n            return container;\n        },\n\n        __injectTopRow: function() {\n            this._topRow = L.DomUtil.create('div', 'leaflet-control-layers-top-row');\n            this._section.parentNode.insertBefore(this._topRow, this._section);\n        }\n\n    });\n    if (control._map) {\n        control.__injectTopRow();\n    }\n}\n\nexport default enableTopRow;\n","import * as Sentry from '@sentry/browser';\nimport './index.css';\nimport * as App from './App';\nimport config from './config';\n\nfunction getUid() {\n    const cookie = document.cookie;\n    const cookieUid = cookie.match(/\\buid=([^;]+)/u)[1];\n    const uidRaw = atob(cookieUid);\n    const l = [];\n    for (let i = 0; i < uidRaw.length; i++) {\n        l.push(uidRaw.charCodeAt(i));\n    }\n    const l2 = [];\n    l2.push(...l.slice(0, 4).reverse());\n    l2.push(...l.slice(4, 8).reverse());\n    l2.push(...l.slice(8, 12).reverse());\n    l2.push(...l.slice(12).reverse());\n    const uid = l2.map((c) => (\"0\" + c.toString(16)).slice(-2)).join('').toUpperCase();\n    return uid;\n}\n\nfunction preconnect(url) {\n    const preconnectLink = document.createElement('link');\n    preconnectLink.rel = 'preconnect';\n    preconnectLink.href = url;\n    document.head.appendChild(preconnectLink);\n\n    const dnsPrefetchLink = document.createElement('link');\n    dnsPrefetchLink.rel = 'dns-prefetch';\n    dnsPrefetchLink.href = url;\n    document.head.appendChild(dnsPrefetchLink);\n}\n\npreconnect(config.elevationsServer);\npreconnect(config.CORSProxyUrl);\npreconnect(config.tracksStorageServer);\n\nif (NODE_ENV === 'production') {\n    Sentry.init({\n        dsn: config.sentryDSN,\n        release: RELEASE_VER\n    });\n}\n\nconsole.log('Version:', RELEASE_VER); // eslint-disable-line no-console\n\nlet uid;\ntry {\n    uid = getUid();\n} catch (e) {\n    // ignore error\n}\nconsole.log('UID:', uid); // eslint-disable-line no-console\n\nSentry.configureScope(function(scope) {\n    scope.setUser({id: uid});\n});\n\nApp.setUp();\n\n","// extracted by mini-css-extract-plugin\nexport {};","import './App.css';\nimport './leaflet-fixes.css';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport {MapWithSidebars} from '~/lib/leaflet.map.sidebars';\nimport '~/lib/leaflet.control.printPages/control';\nimport '~/lib/leaflet.control.caption';\nimport config from './config';\nimport '~/lib/leaflet.control.coordinates';\nimport enableLayersControlHotKeys from '~/lib/leaflet.control.layers.hotkeys';\nimport '~/lib/leaflet.hashState/Leaflet.Map';\nimport '~/lib/leaflet.hashState/Leaflet.Control.Layers';\nimport {fixAll} from '~/lib/leaflet.fixes';\nimport './adaptive.css';\nimport '~/lib/leaflet.control.panoramas';\nimport '~/lib/leaflet.control.track-list/track-list';\nimport '~/lib/leaflet.control.track-list/control-ruler';\nimport '~/lib/leaflet.control.track-list/track-list.hash-state';\nimport '~/lib/leaflet.control.track-list/track-list.localstorage';\nimport enableLayersMinimize from '~/lib/leaflet.control.layers.minimize';\nimport enableLayersConfig from '~/lib/leaflet.control.layers.configure';\nimport raiseControlsOnFocus from '~/lib/leaflet.controls.raise-on-focus';\nimport {getLayers} from './layers';\nimport '~/lib/leaflet.control.layers.events';\nimport '~/lib/leaflet.control.jnx';\nimport '~/lib/leaflet.control.jnx/hash-state';\nimport '~/lib/leaflet.control.azimuth';\nimport {hashState, bindHashStateReadOnly} from '~/lib/leaflet.hashState/hashState';\nimport {LocateControl} from '~/lib/leaflet.control.locate';\nimport {notify} from '~/lib/notifications';\nimport ZoomDisplay from '~/lib/leaflet.control.zoom-display';\nimport * as logging from '~/lib/logging';\nimport safeLocalStorage from '~/lib/safe-localstorage';\nimport '~/lib/leaflet.placemark';\n\nconst locationErrorMessage = {\n    0: 'Ваш браузер не поддерживает геолокацию.',\n    1: 'Геолокация для этого сайта заблокирована. Пожалуйста, включите в настройках браузера.',\n    2: 'Не удалось получить позицию по неизвестной причине.',\n};\n\nfunction setUp() {\n    const startInfo = {\n        href: window.location.href,\n        localStorageKeys: Object.keys(safeLocalStorage),\n        mobile: L.Browser.mobile,\n    };\n    fixAll();\n\n    const map = new MapWithSidebars('map', {\n            zoomControl: false,\n            fadeAnimation: false,\n            attributionControl: false,\n            inertiaMaxSpeed: 1500,\n            worldCopyJump: true,\n            maxZoom: 18\n        }\n    );\n\n    const tracklist = new L.Control.TrackList();\n\n    /* controls top-left corner */\n    // Поле с информацией\n    new L.Control.Caption(config.caption, {\n            position: 'bottomleft'\n        }\n    ).addTo(map);\n\n    new ZoomDisplay().addTo(map);\n\n    map.getPlacemarkHashStateInterface().enableHashState('r');\n\n    new L.Control.Coordinates({position: 'topleft'}).addTo(map);\n\n    const locateControl = new LocateControl({\n        position: 'topleft',\n        showError: function({code, message}) {\n            let customMessage = locationErrorMessage[code];\n            if (!customMessage) {\n                customMessage = `Geolocation error: ${message}`;\n            }\n            notify(customMessage);\n        }\n    }).addTo(map);\n\n    let {lat, lng, zoom, valid: validPositionInHash} = map.validateState(hashState.getState('m'));\n    locateControl.moveMapToCurrentLocation(config.defaultZoom, L.latLng(config.defaultLocation),\n        validPositionInHash ? L.latLng(lat, lng) : null, validPositionInHash ? zoom : null);\n    map.enableHashState('m');\n\n    /* controls top-right corner */\n\n    const layersControl = L.control.layers(null, null, {collapsed: false})\n        .addTo(map);\n    enableLayersControlHotKeys(layersControl);\n    enableLayersMinimize(layersControl);\n    enableLayersConfig(layersControl, getLayers());\n    layersControl.enableHashState('l');\n\n    /* controls bottom-left corner */\n\n    const attribution = L.control.attribution({\n        position: 'bottomleft',\n        prefix: false,\n    });\n    map.on('resize', function() {\n        if (map.getSize().y > 567) {\n            map.addControl(attribution);\n            // Hack to keep control at the bottom of the map\n            const container = attribution._container;\n            const parent = container.parentElement;\n            parent.appendChild(container);\n        } else {\n            map.removeControl(attribution);\n        }\n    });\n    if (map.getSize().y > 567) {\n        map.addControl(attribution);\n    }\n    // ewfefwef\n\n    /* controls bottom-right corner */\n\n    function trackNames() {\n        return tracklist.tracks().map((track) => track.name());\n    }\n    tracklist.addTo(map);\n    const tracksHashParams = tracklist.hashParams();\n\n    let hasTrackParamsInHash = false;\n    for (let param of tracksHashParams) {\n        if (hashState.hasKey(param)) {\n            hasTrackParamsInHash = true;\n            break;\n        }\n    }\n    if (!hasTrackParamsInHash) {\n        tracklist.loadTracksFromStorage();\n    }\n    startInfo.tracksAfterLoadFromStorage = trackNames();\n\n    for (let param of tracksHashParams) {\n        bindHashStateReadOnly(param, tracklist.loadTrackFromParam.bind(tracklist, param));\n    }\n    startInfo.tracksAfterLoadFromHash = trackNames();\n\n    if (!validPositionInHash) {\n        tracklist.whenLoadDone(() => tracklist.setViewToAllTracks(true));\n    }\n\n    /* adaptive layout */\n\n    if (L.Browser.mobile) {\n        layersControl.setMinimized();\n        if (!tracklist.hasTracks()) {\n            tracklist.setMinimized();\n        }\n    }\n\n    if (L.Browser.mobile) {\n        map.on('mousedown dragstart', () => layersControl.setMinimized());\n    }\n\n    raiseControlsOnFocus(map);\n\n    /* save state at unload */\n\n    L.DomEvent.on(window, 'beforeunload', () => {\n        logging.logEvent('saveTracksToStorage begin', {\n            localStorageKeys: Object.keys(safeLocalStorage),\n            trackNames: trackNames(),\n        });\n        let localStorageKeys;\n        try {\n            tracklist.saveTracksToStorage();\n            localStorageKeys = Object.keys(safeLocalStorage); // eslint-disable-line\n        } catch (e) {\n            logging.logEvent('saveTracksToStorage failed', {error: e});\n            return; // eslint-disable-line\n        }\n    });\n}\n\nexport {setUp};\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\n\nimport './style.css';\nimport {onElementResize} from '~/lib/anyElementResizeEvent';\n\nconst MapWithSidebars = L.Map.extend({\n    initialize: function (id, options) {\n        this._sidebarsContainer = L.DomUtil.get(id);\n        this.setupSidebarsLayout(this._sidebarsContainer);\n        L.Map.prototype.initialize.call(this, this._mapContainer, options);\n        onElementResize(this._mapContainer, L.Util.requestAnimFrame.bind(null, this.invalidateSize.bind(this)));\n    },\n\n    setupSidebarsLayout: function (container) {\n        this._sidebarContainers = {};\n        const sidebars = this._sidebarContainers;\n        L.DomUtil.addClass(container, 'leaflet-map-sidebars-container');\n        sidebars['left'] = L.DomUtil.create('div', 'leaflet-map-sidebar-left', this._sidebarsContainer);\n        const midColumn = L.DomUtil.create('div', 'leaflet-map-sidebar-mid-column', this._sidebarsContainer);\n        sidebars['right'] = L.DomUtil.create('div', 'leaflet-map-sidebar-right', this._sidebarsContainer);\n        sidebars['top'] = L.DomUtil.create('div', 'leaflet-map-sidebar-top', midColumn);\n        this._mapContainer = L.DomUtil.create('div', 'leaflet-map-container-with-sidebars', midColumn);\n        sidebars['bottom'] = L.DomUtil.create('div', 'leaflet-map-sidebar-bottom', midColumn);\n    },\n\n    addElementToSidebar: function (barName, element) {\n        this._sidebarContainers[barName].appendChild(element);\n    },\n\n    removeElementFromSidebar: function (barName, element) {\n        this._sidebarContainers[barName].removeChild(element);\n    },\n});\n\nexport {MapWithSidebars};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport ko from 'knockout';\nimport '~/lib/knockout.component.progress/progress';\nimport '~/lib/controls-styles/controls-styles.css';\nimport './control.css';\nimport PageFeature from './pageFeature';\nimport Contextmenu from '~/lib/contextmenu';\nimport {renderPages} from './map-render';\nimport formHtml from './form.html';\nimport {notify} from '~/lib/notifications';\nimport {makePdf} from './pdf';\nimport {saveAs} from '~/vendored/github.com/eligrey/FileSaver';\nimport {blobFromString} from '~/lib/binary-strings';\nimport '~/lib/leaflet.hashState/leaflet.hashState';\nimport '~/lib/leaflet.control.commons';\nimport * as logging from '~/lib/logging';\nimport {MagneticMeridians} from './decoration.magnetic-meridians';\nimport {OverlayScale} from './decoration.scale';\nimport {Grid} from './decoration.grid';\n\nko.extenders.checkNumberRange = function(target, range) {\n    return ko.pureComputed({\n            read: target,  // always return the original observables value\n            write: function(newValue) {\n                newValue = parseFloat(newValue);\n                if (newValue >= range[0] && newValue <= range[1]) {\n                    target(newValue);\n                } else {\n                    target.notifySubscribers(target());\n                }\n            }\n        }\n    ).extend({notify: 'always'});\n};\n\nfunction savePagesPdf(imagesInfo, resolution, fileName) {\n    let pdf = makePdf(imagesInfo, resolution);\n    pdf = blobFromString(pdf);\n    saveAs(pdf, fileName, true);\n}\n\nfunction savePageJpg(page, fileName) {\n    saveAs(blobFromString(page.data), fileName, true);\n}\n\nL.Control.PrintPages = L.Control.extend({\n        options: {\n            position: 'bottomleft',\n            defaultMargin: 7,\n        },\n\n        includes: [L.Evented, L.Mixin.HashState],\n\n        stateChangeEvents: ['change'],\n\n        pageSizes: [\n            {name: 'A1', width: 594, height: 841},\n            {name: 'A2', width: 420, height: 594},\n            {name: 'A3', width: 297, height: 420},\n            {name: 'A4', width: 210, height: 297},\n            {name: 'A5', width: 148, height: 210}\n        ],\n\n        zoomLevels: ['auto', 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18],\n\n        initialize: function(options) {\n            L.Control.prototype.initialize.call(this, options);\n            this.pages = [];\n            this.scale = ko.observable(500).extend({checkNumberRange: [1, 1000000]});\n            this.resolution = ko.observable(300).extend({checkNumberRange: [10, 9999]});\n            this.zoomLevel = ko.observable('auto');\n            this.pageWidth = ko.observable(210).extend({checkNumberRange: [10, 9999]});\n            this.pageHeight = ko.observable(297).extend({checkNumberRange: [10, 9999]});\n            this.settingsExpanded = ko.observable(false);\n            this.makingPdf = ko.observable(false);\n            this.downloadProgressRange = ko.observable();\n            this.downloadProgressDone = ko.observable();\n            this.marginLeft = ko.observable(this.options.defaultMargin).extend({checkNumberRange: [0, 99]});\n            this.marginRight = ko.observable(this.options.defaultMargin).extend({checkNumberRange: [0, 99]});\n            this.marginTop = ko.observable(this.options.defaultMargin).extend({checkNumberRange: [0, 99]});\n            this.marginBottom = ko.observable(this.options.defaultMargin).extend({checkNumberRange: [0, 99]});\n            this.autoZoomLevels = ko.observable({});\n            this.printSize = ko.pureComputed(this._printSize, this);\n            this.printSize.subscribe(this.onPageSizeChanged, this);\n            this.scale.subscribe(this.onPageSizeChanged, this);\n            this.resolution.subscribe(this.onPageSizeChanged, this);\n            this.pageSizeDescription = ko.pureComputed(this._displayPageSize, this);\n            this.pagesNum = ko.observable(0);\n            this.pagesNumLabel = ko.pureComputed(this._pagesNumLabel, this);\n            this.gridOn = ko.observable(false);\n            this.magneticMeridiansOn = ko.observable(false);\n\n            // hash state notifications\n            this.scale.subscribe(this.notifyChange, this);\n            this.printSize.subscribe(this.notifyChange, this);\n            this.resolution.subscribe(this.notifyChange, this);\n            this.zoomLevel.subscribe(this.notifyChange, this);\n            this.gridOn.subscribe(this.notifyChange, this);\n            this.magneticMeridiansOn.subscribe(this.notifyChange, this);\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            const container = this._container =\n                L.DomUtil.create('div', 'leaflet-control control-form control-print-pages');\n            this._stopContainerEvents();\n\n            map.on('move', this.updateFormZooms, this);\n            container.innerHTML = formHtml;\n            ko.applyBindings(this, container);\n            this.updateFormZooms();\n            return container;\n        },\n\n        setExpanded: function() {\n            L.DomUtil.removeClass(this._container, 'minimized');\n        },\n\n        setMinimized: function() {\n            L.DomUtil.addClass(this._container, 'minimized');\n        },\n\n        addPage: function(isLandscape, center) {\n            let [pageWidth, pageHeight] = this.printSize();\n            if (isLandscape) {\n                [pageWidth, pageHeight] = [pageHeight, pageWidth];\n            }\n            if (!center) {\n                center = this._map.getCenter();\n            }\n            const page = new PageFeature(center, [pageWidth, pageHeight],\n                this.scale(), (this.pages.length + 1).toString()\n            );\n            page._rotated = isLandscape;\n            page.addTo(this._map);\n            this.pages.push(page);\n            this.pagesNum(this.pages.length);\n            let cm = new Contextmenu(this.makePageContexmenuItems.bind(this, page));\n            page.on('contextmenu', cm.show, cm);\n            page.on('click', this.rotatePage.bind(this, page));\n            page.on('move', this.updateFormZooms, this);\n            page.on('moveend', this.notifyChange, this);\n            this.updateFormZooms();\n            this.notifyChange();\n            return page;\n        },\n\n        addLandscapePage: function() {\n            this.addPage(true);\n        },\n\n        addPortraitPage: function() {\n            this.addPage(false);\n        },\n\n        removePage: function(page) {\n            let i = this.pages.indexOf(page);\n            this.pages.splice(i, 1);\n            this.pagesNum(this.pages.length);\n            this._map.removeLayer(page);\n            for (; i < this.pages.length; i++) {\n                this.pages[i].setLabel((i + 1).toString());\n            }\n            this.notifyChange();\n            this.updateFormZooms();\n        },\n\n        removePages: function() {\n            this.pages.forEach((page) => page.removeFrom(this._map));\n            this.pages = [];\n            this.pagesNum(this.pages.length);\n            this.notifyChange();\n            this.updateFormZooms();\n        },\n\n        onSavePdfClicked: function() {\n            if (!this.pages.length) {\n                notify('Add some pages to print');\n                return;\n            }\n            this.savePdf();\n        },\n\n        zoomForPrint: function() {\n            let zoom = this.zoomLevel();\n            if (zoom === 'auto') {\n                zoom = this.suggestZooms();\n            } else {\n                zoom = {mapZoom: zoom, satZoom: zoom};\n            }\n            return zoom;\n        },\n\n        incrementProgress: function(inc, range) {\n            this.downloadProgressRange(range);\n            this.downloadProgressDone((this.downloadProgressDone() || 0) + inc);\n        },\n\n        savePdf: function() {\n            logging.captureBreadcrumb('start save pdf');\n            if (!this._map) {\n                return;\n            }\n            this.downloadProgressRange(1000);\n            this.downloadProgressDone(undefined);\n            this.makingPdf(true);\n            const pages = this.pages.map((page) => ({\n                        latLngBounds: page.getLatLngBounds(),\n                        printSize: page.getPrintSize(),\n                        label: page.getLabel()\n            }));\n            const resolution = this.resolution();\n            const decorationLayers = [];\n            if (this.gridOn()) {\n                decorationLayers.push(new Grid());\n            }\n            if (this.magneticMeridiansOn()) {\n                decorationLayers.push(new MagneticMeridians());\n            }\n            decorationLayers.push(new OverlayScale());\n            const scale = this.scale();\n            const width = this.pageWidth();\n            const height = this.pageHeight();\n            const eventId = logging.randId();\n            const zooms = this.zoomForPrint();\n            this.fire('mapRenderStart', {\n                action: 'pdf',\n                eventId,\n                scale,\n                resolution,\n                pages,\n                zooms\n            });\n            renderPages({\n                    map: this._map,\n                    pages,\n                    zooms,\n                    resolution,\n                    scale,\n                    decorationLayers,\n                    progressCallback: this.incrementProgress.bind(this)\n                }\n            ).then(({images, renderedLayers}) => {\n                    if (images) {\n                        const fileName = this.getFileName({\n                            renderedLayers,\n                            scale,\n                            width,\n                            height,\n                            extension: 'pdf'\n                        });\n                        savePagesPdf(images, resolution, fileName);\n                        this.fire('mapRenderEnd', {eventId, success: true});\n                    }\n                }\n            ).catch((e) => {\n                    logging.captureException(e, 'raster creation failed');\n                    this.fire('mapRenderEnd', {eventId, success: false, error: e});\n                    notify(`Failed to create PDF: ${e.message}`);\n                }\n            ).then(() => this.makingPdf(false));\n        },\n\n        savePageJpg: function(page) {\n            logging.captureBreadcrumb('start save page jpg', {pageNumber: page.getLabel()});\n            const pages = [{\n                latLngBounds: page.getLatLngBounds(),\n                printSize: page.getPrintSize(),\n                label: page.getLabel()\n            }];\n            const decorationLayers = [];\n            if (this.gridOn()) {\n                decorationLayers.push(new Grid());\n            }\n            if (this.magneticMeridiansOn()) {\n                decorationLayers.push(new MagneticMeridians());\n            }\n            decorationLayers.push(new OverlayScale());\n            this.downloadProgressRange(1000);\n            this.downloadProgressDone(undefined);\n            this.makingPdf(true);\n            const resolution = this.resolution();\n            const scale = this.scale();\n            const width = this.pageWidth();\n            const height = this.pageHeight();\n            const eventId = logging.randId();\n            const zooms = this.zoomForPrint();\n            this.fire('mapRenderStart', {\n                action: 'jpg',\n                eventId,\n                scale,\n                resolution,\n                pages,\n                zooms\n            });\n            renderPages({\n                    map: this._map,\n                    pages,\n                    zooms,\n                    resolution,\n                    scale,\n                    decorationLayers,\n                    progressCallback: this.incrementProgress.bind(this)\n                }\n            )\n                .then(({images, renderedLayers}) => {\n                    const fileName = this.getFileName({\n                        renderedLayers,\n                        scale,\n                        width,\n                        height,\n                        extension: 'jpg'\n                    });\n                    savePageJpg(images[0], fileName);\n                    this.fire('mapRenderEnd', {eventId, success: true});\n                })\n                .catch((e) => {\n                        logging.captureException(e, 'raster creation failed');\n                        this.fire('mapRenderEnd', {eventId, success: false, error: e});\n                        notify(`Failed to create JPEG from page: ${e.message}`);\n                    }\n                ).then(() => this.makingPdf(false));\n        },\n\n        onPageSizeChanged: function() {\n            let [pageWidth, pageHeight] = this.printSize();\n            this.pages.forEach((page) => {\n                    let [w, h] = [pageWidth, pageHeight];\n                    if (page._rotated) {\n                        [w, h] = [h, w];\n                    }\n                    page.setSize([w, h], this.scale());\n                }\n            );\n            this.updateFormZooms();\n        },\n\n        onPagesNumLabelClick: function() {\n            if (this.pages.length > 0) {\n                const bounds = L.latLngBounds([]);\n                for (let page of this.pages) {\n                    bounds.extend(page.latLngBounds);\n                }\n                this._map.fitBounds(bounds.pad(0.2));\n            }\n        },\n\n        makePageContexmenuItems: function(page) {\n            const items = [\n                {text: 'Rotate', callback: this.rotatePage.bind(this, page)},\n                '-',\n                {text: 'Delete', callback: this.removePage.bind(this, page)},\n                '-',\n                {text: 'Save image', callback: this.savePageJpg.bind(this, page), disabled: this.makingPdf()}\n            ];\n            if (this.pages.length > 1) {\n                items.push({text: 'Change order', separator: true});\n                this.pages.forEach((p, i) => {\n                        if (p !== page) {\n                            items.push({\n                                    text: (i + 1).toString(),\n                                    callback: this.renumberPage.bind(this, page, i)\n                                }\n                            );\n                        }\n                    }\n                );\n            }\n            return items;\n        },\n\n        rotatePage: function(page) {\n            page._rotated = !page._rotated;\n            page.rotate();\n            this.notifyChange();\n        },\n\n        renumberPage: function(page, newIndex) {\n            const oldIndex = this.pages.indexOf(page);\n            this.pages.splice(oldIndex, 1);\n            this.pages.splice(newIndex, 0, page);\n            for (let i = Math.min(oldIndex, newIndex); i < this.pages.length; i++) {\n                this.pages[i].setLabel((i + 1).toString());\n            }\n            this.notifyChange();\n        },\n\n        _printSize: function() {\n            return [this.pageWidth() - this.marginLeft() - this.marginRight(),\n                this.pageHeight() - this.marginTop() - this.marginBottom()];\n        },\n\n        suggestZooms: function() {\n            const scale = this.scale(),\n                resolution = this.resolution();\n            let referenceLat;\n            if (this.pages.length > 0) {\n                let absLats = this.pages.map((page) => Math.abs(page.getLatLngBounds().getCenter().lat));\n                referenceLat = Math.min(...absLats);\n            } else {\n                if (!this._map) {\n                    return [null, null];\n                }\n                referenceLat = this._map.getCenter().lat;\n            }\n            let targetMetersPerPixel = scale / (resolution / 2.54);\n            let mapUnitsPerPixel = targetMetersPerPixel / Math.cos(referenceLat * Math.PI / 180);\n            let satZoom = Math.ceil(Math.log(40075016.4 / 256 / mapUnitsPerPixel) / Math.LN2);\n\n            targetMetersPerPixel = scale / (90 / 2.54) / 1.5;\n            mapUnitsPerPixel = targetMetersPerPixel / Math.cos(referenceLat * Math.PI / 180);\n            let mapZoom = Math.round(Math.log(40075016.4 / 256 / mapUnitsPerPixel) / Math.LN2);\n            mapZoom = Math.min(mapZoom, 18);\n            satZoom = Math.min(satZoom, 18);\n            mapZoom = Math.max(mapZoom, 0);\n            satZoom = Math.max(satZoom, 0);\n            return {mapZoom, satZoom};\n        },\n\n        updateFormZooms: function() {\n            this.autoZoomLevels(this.suggestZooms());\n        },\n\n        _displayPageSize: function() {\n            const width = this.pageWidth(),\n                height = this.pageHeight();\n            for (let size of this.pageSizes) {\n                if (size.width === width && size.height === height) {\n                    return size.name;\n                }\n            }\n            return `${width} x ${height} mm`;\n        },\n\n        notifyChange: function() {\n            this.fire('change');\n        },\n\n        hasPages: function() {\n            return this.pages.length > 0;\n        },\n\n        _pagesNumLabel: function() {\n            const n = this.pagesNum();\n            let label = '';\n            if (n) {\n                label += n;\n            } else {\n                label = 'No';\n            }\n            label += ' page';\n            if (n === 0 || n > 1) {\n                label += 's';\n            }\n            return label;\n        },\n\n        serializeState: function() {\n            const pages = this.pages;\n            let state = null;\n            if (pages.length) {\n                state = [];\n                state.push(this.scale().toString());\n                state.push(this.resolution().toString());\n                state.push(this.zoomLevel().toString());\n                state.push(this.pageWidth().toString());\n                state.push(this.pageHeight().toString());\n                state.push(this.marginLeft().toString());\n                state.push(this.marginRight().toString());\n                state.push(this.marginTop().toString());\n                state.push(this.marginBottom().toString());\n                for (let page of pages) {\n                    let latLng = page.getLatLng().wrap();\n                    state.push(latLng.lat.toFixed(5));\n                    state.push(latLng.lng.toFixed(5));\n                    state.push(page._rotated ? '1' : '0');\n                }\n                let flags =\n                    (this.magneticMeridiansOn() ? 1 : 0) |\n                    (this.gridOn() ? 2 : 0);\n                state.push(flags.toString());\n            }\n            return state;\n        },\n\n        unserializeState: function(state) {\n            if (!state || !state.length) {\n                return false;\n            }\n            this.removePages();\n            state = [...state];\n            this.scale(state.shift());\n            this.resolution(state.shift());\n            this.zoomLevel(state.shift());\n            this.pageWidth(state.shift());\n            this.pageHeight(state.shift());\n            this.marginLeft(state.shift());\n            this.marginRight(state.shift());\n            this.marginTop(state.shift());\n            this.marginBottom(state.shift());\n            let lat, lng, rotated;\n            while (state.length >= 3) {\n                lat = parseFloat(state.shift());\n                lng = parseFloat(state.shift());\n                rotated = parseInt(state.shift(), 10);\n                if (isNaN(lat) || isNaN(lng) || lat < -85 || lat > 85 || lng < -180 || lng > 180) {\n                    break;\n                }\n                this.addPage(Boolean(rotated), L.latLng(lat, lng));\n            }\n            if (state.length) {\n                const flags = parseInt(state.shift(), 10);\n                if (flags >= 0 && flags <= 3) {\n                    this.magneticMeridiansOn(Boolean(flags & 1));\n                    this.gridOn(Boolean(flags & 2));\n                }\n            }\n            return true;\n        },\n\n        getFileName: function({renderedLayers, scale, width, height, extension}) {\n            let fileName = '';\n\n            let opaqueLayer;\n            const transparentOverlayLayers = [];\n\n            renderedLayers.forEach((layer) => {\n                const {\n                    options: {\n                        isOverlay,\n                        isOverlayTransparent,\n                        shortName\n                    }\n                } = layer;\n\n                if (!shortName) {\n                    return;\n                }\n\n                if (isOverlay) {\n                    if (isOverlayTransparent) {\n                        transparentOverlayLayers.push(layer);\n                    } else {\n                        opaqueLayer = layer;\n                    }\n                } else if (!opaqueLayer) {\n                    opaqueLayer = layer;\n                }\n            });\n\n            function appendLayerShortName(layer) {\n                fileName += `${layer.options.shortName}_`;\n            }\n            if (opaqueLayer) {\n                appendLayerShortName(opaqueLayer);\n            }\n            transparentOverlayLayers.forEach(appendLayerShortName);\n\n            fileName += `${scale}m`;\n\n            const currentPageSize = this.pageSizes.find(\n                (pageSize) => width === pageSize.width && height === pageSize.height\n            );\n\n            if (currentPageSize) {\n                fileName += `_${currentPageSize.name}`;\n            }\n\n            return `${fileName}.${extension}`;\n        }\n    }\n);\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport './page-feature.css';\n\nconst PageFeature = L.Marker.extend({\n        initialize: function(centerLatLng, paperSize, scale, label) {\n            this.paperSize = paperSize;\n            this.scale = scale;\n            var icon = L.divIcon({className: \"print-page-marker\", html: label});\n            L.Marker.prototype.initialize.call(this, centerLatLng, {\n                    icon: icon,\n                    draggable: true,\n                    title: 'Left click to rotate, right click for menu'\n                }\n            );\n            this.on('drag', this.updateView.bind(this, undefined));\n        },\n\n        onAdd: function(map) {\n            L.Marker.prototype.onAdd.call(this, map);\n            map.on('viewreset', () => this.updateView());\n            this.rectangle = L.rectangle([[0, 0], [0, 0]],\n                {color: '#ff7800', weight: 2, opacity: 0.7, fillOpacity: 0.2}\n            ).addTo(map);\n            this.updateView();\n        },\n\n        onRemove: function(map) {\n            map.off('viewreset', this.updateView, this);\n            L.Marker.prototype.onRemove.call(this, map);\n            this.rectangle.removeFrom(map);\n        },\n\n        getLatLngBounds: function() {\n            return this.latLngBounds;\n        },\n\n        _getLatLngBounds: function() {\n            const centerLatLng = this.getLatLng();\n            const centerMerc = L.Projection.SphericalMercator.project(centerLatLng);\n            const mercatorScale =\n                (Math.cos((centerLatLng.lat * Math.PI) / 180) * L.CRS.Earth.R) / L.Projection.SphericalMercator.R;\n            const mercatorPageSize = L.point(...this.paperSize).multiplyBy(this.scale / 10 / mercatorScale);\n            let sw = centerMerc.subtract(mercatorPageSize.divideBy(2));\n            let ne = centerMerc.add(mercatorPageSize.divideBy(2));\n            sw = L.Projection.SphericalMercator.unproject(sw);\n            ne = L.Projection.SphericalMercator.unproject(ne);\n            return L.latLngBounds([sw, ne]);\n        },\n\n        _animateZoom: function(e) {\n            L.Marker.prototype._animateZoom.call(this, e);\n            this.updateView(e.zoom);\n        },\n\n        updateView: function(newZoom) {\n            if (!this._map) {\n                return;\n            }\n            if (newZoom === undefined) {\n                newZoom = this._map.getZoom();\n            }\n            var bounds = this.latLngBounds = this._getLatLngBounds();\n            var pixel_sw = this._map.project(bounds.getSouthWest(), newZoom);\n            var pixel_ne = this._map.project(bounds.getNorthEast(), newZoom);\n            var pixel_center = this._map.project(this.getLatLng(), newZoom);\n            var st = this._icon.style;\n            var pixel_width = pixel_ne.x - pixel_sw.x;\n            var pixel_height = pixel_sw.y - pixel_ne.y;\n            st.width = `${pixel_width}px`;\n            st.height = `${pixel_height}px`;\n            st.marginLeft = `${pixel_sw.x - pixel_center.x}px`;\n            st.marginTop = `${pixel_ne.y - pixel_center.y}px`;\n            st.fontSize = `${Math.min(pixel_width, pixel_height, 500) / 2}px`;\n            st.lineHeight = `${pixel_height}px`;\n            this.rectangle.setBounds(bounds);\n        },\n\n        setLabel: function(s) {\n            this._icon.innerHTML = s;\n        },\n\n        getLabel: function() {\n            return this._icon.innerHTML;\n        },\n\n        setSize: function(paperSize, scale) {\n            this.paperSize = paperSize;\n            this.scale = scale;\n            this.updateView();\n        },\n\n        getPrintSize: function() {\n            return L.point(...this.paperSize);\n        },\n\n        rotate: function() {\n            this.paperSize = [this.paperSize[1], this.paperSize[0]];\n            this.updateView();\n        }\n\n    }\n);\n\nexport default PageFeature;\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {getTempMap, disposeMap} from '~/lib/leaflet.layer.rasterize';\nimport {XHRQueue} from '~/lib/xhr-promise';\n\nfunction getLayersForPrint(map, xhrQueue) {\n    function getZIndex(el) {\n        return parseInt(window.getComputedStyle(el).zIndex, 10) || 0;\n    }\n\n    function compare(i1, i2) {\n        if (i1 < i2) {\n            return -1;\n        } else if (i1 > i2) {\n            return 1;\n        }\n        return 0;\n    }\n\n    function getLayerZOrder(layer) {\n        let el = layer._container || layer._path;\n        if (!el) {\n            throw new TypeError('Unsupported layer type');\n        }\n        const order = [];\n        while (el !== layer._map._container) {\n            order.push(getZIndex(el));\n            el = el.parentNode;\n        }\n        return order.reverse();\n    }\n\n    function compareArrays(ar1, ar2) {\n        const len = Math.min(ar1.length, ar2.length);\n        for (let i = 0; i < len; i++) {\n            let c = compare(ar1[i], ar2[i]);\n            if (c) {\n                return c;\n            }\n        }\n        return compare(ar1.length, ar2.length);\n    }\n\n    function compareLayersOrder(layer1, layer2) {\n        return compareArrays(getLayerZOrder(layer1), getLayerZOrder(layer2));\n    }\n\n    let layers = [];\n    map.eachLayer((layer) => {\n            if (layer.options.print) {\n                layers.push(layer);\n            } else {\n                if (layer.meta && layer.options.isOverlay === false) {\n                    throw new Error(`Print disabled for layer ${layer.meta.title}`);\n                }\n            }\n        }\n    );\n    layers.sort(compareLayersOrder);\n    layers = layers.map((l) => l.cloneForPrint({xhrQueue}));\n    return layers;\n}\n\nfunction blendMultiplyCanvas(src, dest) {\n    if (src.width !== dest.width || src.height !== dest.height) {\n        throw new Error('Canvas size mismatch');\n    }\n    var s_data = src.getContext('2d').getImageData(0, 0, src.width, src.height).data;\n    src.width = 0;\n    src.height = 0;\n    var d_image_data = dest.getContext('2d').getImageData(0, 0, dest.width, dest.height);\n    var d_data = d_image_data.data;\n    var data_length = s_data.length,\n        sr, sg, sb, sa, sa1,\n        dr, dg, db,\n        l;\n    for (var i = 0; i < data_length; i += 4) {\n        sa = s_data[i + 3] / 255;\n        if (sa) {\n            sr = s_data[i];\n            sg = s_data[i + 1];\n            sb = s_data[i + 2];\n            dr = d_data[i];\n            dg = d_data[i + 1];\n            db = d_data[i + 2];\n\n            l = (dr + dg + db) / 3;\n            l = l / 255 * 0.5 + 0.5;\n            sa1 = 1 - sa;\n            dr = sr * l * sa + sa1 * dr;\n            dg = sg * l * sa + sa1 * dg;\n            db = sb * l * sa + sa1 * db;\n\n            d_data[i] = dr;\n            d_data[i + 1] = dg;\n            d_data[i + 2] = db;\n        }\n    }\n    s_data = null;\n    dest.getContext('2d').putImageData(d_image_data, 0, 0);\n}\n\nclass PageComposer {\n    constructor(destSize, pixelBoundsAtZoom24) {\n        this.destSize = destSize;\n        this.projectedBounds = pixelBoundsAtZoom24;\n        this.currentCanvas = null;\n        this.currentZoom = null;\n        this.currentTileScale = null;\n        this.targetCanvas = this.createCanvas(destSize);\n    }\n\n    createCanvas(size) {\n        const canvas = L.DomUtil.create('canvas');\n        canvas.width = size.x;\n        canvas.height = size.y;\n        return canvas;\n    }\n\n    putTile(tileInfo) {\n        if (!tileInfo.isOverlay && !tileInfo.image) {\n            return;\n        }\n        let zoom;\n        if (tileInfo.isOverlay) {\n            zoom = tileInfo.overlaySolid ? 'solidOverlay' : 'overlay';\n        } else {\n            zoom = tileInfo.zoom;\n        }\n        if (zoom !== this.currentZoom || tileInfo.tileScale !== this.currentTileScale) {\n            this.mergeCurrentCanvas();\n            this.setupCurrentCanvas(zoom, tileInfo.tileScale);\n        }\n        if (tileInfo.isOverlay) {\n            tileInfo.draw(this.currentCanvas);\n        } else {\n            const ctx = this.currentCanvas.getContext('2d');\n            const {tilePos, tileSize} = tileInfo;\n            ctx.drawImage(\n                tileInfo.image,\n                tilePos.x * tileInfo.tileScale,\n                tilePos.y * tileInfo.tileScale,\n                tileSize.x * tileInfo.tileScale,\n                tileSize.y * tileInfo.tileScale\n            );\n        }\n    }\n\n    setupCurrentCanvas(zoom, tileScale) {\n        let size;\n        if (zoom === 'overlay' || zoom === 'solidOverlay') {\n            size = this.destSize;\n        } else {\n            const q = 1 << (24 - zoom);\n            const\n                topLeft = this.projectedBounds.min.divideBy(q).round(),\n                bottomRight = this.projectedBounds.max.divideBy(q).round();\n            size = bottomRight.subtract(topLeft).multiplyBy(tileScale);\n        }\n        this.currentCanvas = this.createCanvas(size);\n        this.currentZoom = zoom;\n        this.currentTileScale = tileScale;\n    }\n\n    mergeCurrentCanvas() {\n        if (!this.currentCanvas) {\n            return;\n        }\n        if (this.currentZoom === 'overlay') {\n            blendMultiplyCanvas(this.currentCanvas, this.targetCanvas);\n        } else {\n            this.targetCanvas.getContext('2d').drawImage(this.currentCanvas, 0, 0,\n                this.destSize.x, this.destSize.y\n            );\n        }\n        this.currentCanvas.width = 0;\n        this.currentCanvas.height = 0;\n        this.currentCanvas = null;\n    }\n\n    getDataUrl() {\n        this.mergeCurrentCanvas();\n        const dataUrl = this.targetCanvas.toDataURL(\"image/jpeg\");\n        this.targetCanvas.width = 0;\n        this.targetCanvas.height = 0;\n        this.targetCanvas = null;\n        return dataUrl;\n    }\n}\n\nasync function* iterateLayersTiles(\n    layers,\n    latLngBounds,\n    destPixelSize,\n    resolution,\n    scale,\n    zooms,\n    pageLabel,\n    pagesCount\n) {\n    const defaultXHROptions = {\n        responseType: 'blob',\n        timeout: 20000,\n        isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 404\n    };\n    let doStop;\n    for (let layer of layers) {\n        let zoom;\n        if (layer.options && layer.options.scaleDependent) {\n            zoom = zooms.mapZoom;\n        } else {\n            zoom = zooms.satZoom;\n        }\n        let pixelBounds = L.bounds(\n            L.CRS.EPSG3857.latLngToPoint(latLngBounds.getNorthWest(), zoom).round(),\n            L.CRS.EPSG3857.latLngToPoint(latLngBounds.getSouthEast(), zoom).round()\n        );\n        let map;\n        if (!layer._layerDummy) {\n            map = getTempMap(zoom, layer._rasterizeNeedsFullSizeMap, pixelBounds);\n            map.addLayer(layer);\n        }\n        let {iterateTilePromises, count, tileScale = 1} = await layer.getTilesInfo({\n                xhrOptions: defaultXHROptions,\n                pixelBounds,\n                latLngBounds,\n                destPixelSize,\n                resolution,\n                scale,\n                zoom,\n                pageLabel,\n                pagesCount\n            }\n        );\n        let layerPromises = [];\n        for (let tilePromise of iterateTilePromises()) {\n            layerPromises.push(tilePromise.tilePromise);\n            let progressInc = (layer._printProgressWeight || 1) / count;\n            tilePromise.tilePromise = tilePromise.tilePromise.then((tileInfo) => ({\n                zoom,\n                progressInc,\n                layer,\n                tileScale,\n                ...tileInfo,\n            }));\n            doStop = yield tilePromise;\n            if (doStop) {\n                tilePromise.abortLoading();\n                break;\n            }\n        }\n        if (!layer._layerDummy) {\n            if (doStop) {\n                disposeMap(map);\n                break;\n            } else {\n                Promise.all(layerPromises).then(() => disposeMap(map));\n            }\n        }\n    }\n}\n\nasync function* promiseQueueBuffer(source, maxActive) {\n    const queue = [];\n    while (queue.length < maxActive) {\n        let {value, done} = await source.next();\n        if (done) {\n            break;\n        }\n        queue.push(value);\n    }\n\n    while (queue.length) {\n        let doStop = yield queue.shift();\n        if (doStop) {\n            let {value, done} = await source.next(true);\n            if (!done) {\n                queue.push(value);\n            }\n            for (let {abortLoading} of queue) {\n                abortLoading();\n            }\n\n            return;\n        }\n        let {value, done} = await source.next();\n        if (!done) {\n            queue.push(value);\n        }\n    }\n}\n\nasync function renderPages({map, pages, zooms, resolution, scale, progressCallback, decorationLayers}) {\n    const xhrQueue = new XHRQueue();\n    const layers = getLayersForPrint(map, xhrQueue);\n    layers.push(...decorationLayers);\n    let progressRange = 0;\n    for (let layer of layers) {\n        progressRange += layer._printProgressWeight || 1;\n    }\n    progressRange *= pages.length;\n    const pageImagesInfo = [];\n    const renderedLayers = new Set();\n    for (let page of pages) {\n        let destPixelSize = page.printSize.multiplyBy(resolution / 25.4).round();\n        let pixelBounds = L.bounds(\n            map.project(page.latLngBounds.getNorthWest(), 24).round(),\n            map.project(page.latLngBounds.getSouthEast(), 24).round()\n        );\n\n        const composer = new PageComposer(destPixelSize, pixelBounds);\n        let tilesIterator = await iterateLayersTiles(layers, page.latLngBounds, destPixelSize, resolution, scale, zooms,\n            page.label, pages.length);\n        let queuedTilesIterator = promiseQueueBuffer(tilesIterator, 20);\n        while (true) {\n            let {value: tilePromise, done} = await queuedTilesIterator.next();\n            if (done) {\n                break;\n            }\n            let tileInfo;\n            try {\n                tileInfo = await tilePromise.tilePromise;\n            } catch (e) {\n                queuedTilesIterator.next(true);\n                throw e;\n            }\n            progressCallback(tileInfo.progressInc, progressRange);\n            composer.putTile(tileInfo);\n            const {image, draw, layer} = tileInfo;\n            if ((image || draw) && !layer._layerDummy) {\n                renderedLayers.add(layer);\n            }\n        }\n        const dataUrl = composer.getDataUrl();\n        let data = dataUrl.substring(dataUrl.indexOf(',') + 1);\n        data = atob(data);\n        pageImagesInfo.push({\n                data,\n                width: destPixelSize.x,\n                height: destPixelSize.y\n            }\n        );\n    }\n    return {images: pageImagesInfo, renderedLayers};\n}\n\nexport {renderPages};\n","const secrets = {\n    bingKey: '0000000000000000000000000000000000000000000000000000000000000000',\n    thunderforestKey: '00000000000000000000000000000000',\n    sentryDSN: 'https://00000000000000000000000000000000@sentry.io/111111',\n    mapillary: '0000000000000000000000000000000000000000000000000000',\n    flickr: '00000000000000000000000000000000',\n    google: 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXX'\n};\n\nexport default secrets;\n","function imgFromDataString(xhr) {\n    if (xhr.status === 200 && xhr.response.size) {\n        const image = new Image();\n        let blobUrl = window.URL.createObjectURL(xhr.response);\n        const promise = new Promise((resolve, reject) => {\n                image.onload = () => {\n                    resolve(image);\n                    window.URL.revokeObjectURL(blobUrl);\n                };\n                image.onerror = () => {\n                    reject(new Error('Image corrupt'));\n                    window.URL.revokeObjectURL(blobUrl);\n                };\n            }\n        );\n        image.src = blobUrl;\n        return promise;\n    }\n    return null;\n}\n\nexport {imgFromDataString};\n","import L from 'leaflet';\nimport {BingLayer} from '~/lib/leaflet.layer.bing';\n\nBingLayer.include({\n        waitTilesReadyToGrab: function() {\n            if (this._url) {\n                return Promise.resolve();\n            }\n            return new Promise((resolve) => {\n                    let i = setInterval(() => {\n                            if (this._url) {\n                                clearInterval(i);\n                                resolve();\n                            }\n                        }, 50\n                    );\n                }\n            );\n        },\n\n        cloneForPrint: function(options) {\n            return new BingLayer(this._key, L.Util.extend({}, this.options, options));\n        },\n    }\n);\n","import L from 'leaflet';\n\nfunction tile2quad(x, y, z) {\n    var quad = '';\n    for (var i = z; i > 0; i--) {\n        var digit = 0;\n        var mask = 1 << (i - 1);\n        if ((x & mask) !== 0) {\n            digit += 1;\n        }\n        if ((y & mask) !== 0) {\n            digit += 2;\n        }\n        quad += digit;\n    }\n    return quad;\n}\n\nconst BingLayer = L.TileLayer.extend({\n    options: {\n        subdomains: [0, 1, 2, 3],\n        type: 'Aerial',\n        attribution: 'Bing',\n        culture: ''\n    },\n\n    initialize: function(key, options) {\n        L.Util.setOptions(this, options);\n\n        this._key = key;\n        this._url = null;\n        this._providers = [];\n        this.metaRequested = false;\n    },\n\n    getTileUrl: function(tilePoint) {\n        var zoom = this._getZoomForUrl();\n        var subdomains = this.options.subdomains,\n            s = this.options.subdomains[Math.abs((tilePoint.x + tilePoint.y) % subdomains.length)];\n        return this._url.replace('{subdomain}', s)\n            .replace('{quadkey}', tile2quad(tilePoint.x, tilePoint.y, zoom))\n            .replace('{culture}', this.options.culture);\n    },\n\n    loadMetadata: function() {\n        if (this.metaRequested) {\n            return;\n        }\n        this.metaRequested = true;\n        var that = this;\n        var cbid = '_bing_metadata_' + L.Util.stamp(this);\n        window[cbid] = function(meta) {\n            window[cbid] = undefined;\n            var e = document.getElementById(cbid);\n            e.parentNode.removeChild(e);\n            if (meta.errorDetails) {\n                throw new Error(meta.errorDetails);\n            }\n            that.initMetadata(meta);\n        };\n        var urlScheme = 'https';\n        var url = urlScheme + '://dev.virtualearth.net/REST/v1/Imagery/Metadata/' +\n            this.options.type + '?include=ImageryProviders&jsonp=' + cbid +\n            '&key=' + this._key + '&UriScheme=' + urlScheme;\n        var script = document.createElement('script');\n        script.type = 'text/javascript';\n        script.src = url;\n        script.id = cbid;\n        document.getElementsByTagName('head')[0].appendChild(script);\n    },\n\n    initMetadata: function(meta) {\n        var r = meta.resourceSets[0].resources[0];\n        this.options.subdomains = r.imageUrlSubdomains;\n        this._url = r.imageUrl;\n        if (r.imageryProviders) {\n            for (var i = 0; i < r.imageryProviders.length; i++) {\n                var p = r.imageryProviders[i];\n                for (var j = 0; j < p.coverageAreas.length; j++) {\n                    var c = p.coverageAreas[j];\n                    var coverage = {zoomMin: c.zoomMin, zoomMax: c.zoomMax, active: false};\n                    var bounds = new L.LatLngBounds(\n                        new L.LatLng(c.bbox[0] + 0.01, c.bbox[1] + 0.01),\n                        new L.LatLng(c.bbox[2] - 0.01, c.bbox[3] - 0.01)\n                    );\n                    coverage.bounds = bounds;\n                    coverage.attrib = p.attribution;\n                    this._providers.push(coverage);\n                }\n            }\n        }\n        this._update();\n    },\n\n    _update: function() {\n        if (this._url === null || !this._map) {\n            return;\n        }\n        this._update_attribution();\n        L.TileLayer.prototype._update.apply(this, []);\n    },\n\n    _update_attribution: function() {\n        var bounds = L.latLngBounds(\n            this._map.getBounds().getSouthWest().wrap(),\n            this._map.getBounds().getNorthEast().wrap()\n        );\n        var zoom = this._map.getZoom();\n        for (var i = 0; i < this._providers.length; i++) {\n            var p = this._providers[i];\n            if ((zoom <= p.zoomMax && zoom >= p.zoomMin) &&\n                bounds.intersects(p.bounds)) {\n                if (!p.active && this._map.attributionControl) {\n                    this._map.attributionControl.addAttribution(p.attrib);\n                }\n                p.active = true;\n            } else {\n                if (p.active && this._map.attributionControl) {\n                    this._map.attributionControl.removeAttribution(p.attrib);\n                }\n                p.active = false;\n            }\n        }\n    },\n\n    onAdd: function(map) {\n        this.loadMetadata();\n        L.TileLayer.prototype.onAdd.apply(this, [map]);\n    },\n\n    onRemove: function(map) {\n        for (var i = 0; i < this._providers.length; i++) {\n            var p = this._providers[i];\n            if (p.active && this._map.attributionControl) {\n                this._map.attributionControl.removeAttribution(p.attrib);\n                p.active = false;\n            }\n        }\n        L.TileLayer.prototype.onRemove.apply(this, [map]);\n    }\n});\n\nexport {BingLayer, tile2quad};\n","import L from 'leaflet';\nimport '~/lib/leaflet.layer.yandex';\n\nL.Layer.Yandex.Map.include({\n    cloneForPrint: function(options) {\n        return new L.Layer.Yandex.Map({...this.options, ...options, yandexScale: 2});\n    },\n\n    getTilesInfo: async function(printOptions) {\n        const tilesInfo = await L.TileLayer.prototype.getTilesInfo.call(this, printOptions);\n        tilesInfo.tileScale = 2;\n        return tilesInfo;\n    },\n});\n\nL.Layer.Yandex.Sat.include({\n    cloneForPrint: function(options) {\n        return new L.Layer.Yandex.Sat({...this.options, ...options});\n    },\n});\n\nL.Layer.Yandex.Tracks.include({\n    cloneForPrint: function(options) {\n        return new L.Layer.Yandex.Tracks({...this.options, ...options});\n    },\n});\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport '~/lib/leaflet.layer.google';\n\nL.Layer.GoogleBase.include({\n    cloneForPrint: function(options) {\n        return new L.Layer.GoogleBase(this._url, L.Util.extend({}, this.options, options));\n    },\n});\n\n","import L from \"leaflet\";\nimport '~/lib/leaflet.layer.westraPasses';\nimport {WestraPassesMarkers} from '~/lib/leaflet.layer.westraPasses/westraPassesMarkers';\nimport '~/lib/leaflet.layer.canvasMarkers';\nimport './CanvasMarkers';\n\nL.Layer.WestraPasses.addInitHook(function() {\n    this.markers.options.print = this.options.print;\n    this.options.print = false;\n});\n\nWestraPassesMarkers.include({\n    waitDataReady: function() {\n        if (this._dataLoaded) {\n            return Promise.resolve();\n        }\n        return new Promise((resolve) => {\n           this.on('data-loaded', resolve);\n        });\n    },\n\n    cloneForPrint: function(options) {\n        options = L.Util.extend({}, this.options, options);\n        return new WestraPassesMarkers(this._baseUrl, options);\n    },\n\n    getTilesInfo: async function(printOptions) {\n        await this.waitDataReady();\n        return L.Layer.CanvasMarkers.prototype.getTilesInfo.call(this, printOptions);\n    }\n});\n","import L from 'leaflet';\nimport './westraPasses.css';\nimport '~/lib/leaflet.layer.geojson-ajax';\nimport {WestraPassesMarkers} from './westraPassesMarkers';\n\nL.Layer.WestraPasses = L.Layer.extend({\n        options: {\n            fileCoverage: 'westra_coverage.json',\n            fileLabels1: 'westra_regions_labels1.json',\n            fileLabels2: 'westra_regions_labels2.json',\n            scaleDependent: true,\n            labels2Zoom: 6,\n            markersZoom: 10,\n            labels1Zoom: 2\n\n        },\n\n        initialize: function(baseUrl, options) {\n            L.setOptions(this, options);\n            this.markers = new WestraPassesMarkers(baseUrl, options.markersOptions);\n            this.coverage = new L.Layer.GeoJSONAjax(baseUrl + this.options.fileCoverage, {\n                className: 'westra-coverage-polygon',\n                onEachFeature: this._setEventsForRegion.bind(this)\n            });\n            this.labels1 = new L.Layer.GeoJSONAjax(baseUrl + this.options.fileLabels1, {\n                pointToLayer: this._makeMarker,\n                onEachFeature: this._setEventsForRegion.bind(this)\n            });\n            this.labels2 = new L.Layer.GeoJSONAjax(baseUrl + this.options.fileLabels2, {\n                pointToLayer: this._makeMarker,\n                onEachFeature: this._setEventsForRegion.bind(this)\n            });\n        },\n\n        _setEventsForRegion: function(feature, layer) {\n            layer.on('click', this._onRegionClick, this);\n        },\n\n        _makeMarker: function(geojsonPoint, latlng) {\n            const icon = L.divIcon({\n                    className: 'westra-region-label',\n                    html: '<span>' + geojsonPoint.properties.name + '</span>'\n                }\n            );\n            const marker = L.marker(latlng, {icon: icon});\n            return marker;\n        },\n\n        _onRegionClick: function(e) {\n            const layer = e.target;\n            const latlng = layer.getLatLng ? layer.getLatLng() : e.latlng;\n            const zoom = this._map.getZoom();\n            let newZoom;\n            if (zoom < this.options.labels2Zoom) {\n                newZoom = this.options.labels2Zoom;\n            } else {\n                newZoom = this.options.markersZoom;\n            }\n            this._map.setView(latlng, newZoom);\n        },\n\n        setLayersVisibility: function(e) {\n            if (!this._map) {\n                return;\n            }\n            var newZoom;\n            var zoomFinished = e ? (e.type !== 'zoomanim') : true;\n            if (e && e.zoom !== undefined) {\n                newZoom = e.zoom;\n            } else {\n                newZoom = this._map.getZoom();\n            }\n            if (newZoom < this.options.labels1Zoom) {\n                this._map.removeLayer(this.markers);\n                this._map.addLayer(this.coverage);\n                this._map.removeLayer(this.labels1);\n                this._map.removeLayer(this.labels2);\n            } else if (newZoom < this.options.labels2Zoom) {\n                this._map.removeLayer(this.markers);\n                this._map.addLayer(this.coverage);\n                this._map.addLayer(this.labels1);\n                this._map.removeLayer(this.labels2);\n            } else if (newZoom < this.options.markersZoom) {\n                this._map.removeLayer(this.markers);\n                this._map.addLayer(this.coverage);\n                this._map.removeLayer(this.labels1);\n                this._map.addLayer(this.labels2);\n            } else {\n                if (zoomFinished) {\n                    this._map.addLayer(this.markers);\n                }\n                this._map.removeLayer(this.coverage);\n                this._map.removeLayer(this.labels1);\n                this._map.removeLayer(this.labels2);\n            }\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            this.markers.loadData();\n            this.coverage.loadData();\n            this.labels1.loadData();\n            this.labels2.loadData();\n            this.setLayersVisibility();\n            map.on('zoomend', this.setLayersVisibility, this);\n            map.on('zoomanim', this.setLayersVisibility, this);\n        },\n\n        onRemove: function() {\n            this._map.removeLayer(this.markers);\n            this._map.removeLayer(this.coverage);\n            this._map.removeLayer(this.labels1);\n            this._map.removeLayer(this.labels2);\n            this._map.off('zoomend', this.setLayersVisibility, this);\n            this._map.off('zoomanim', this.setLayersVisibility, this);\n            this._map = null;\n        }\n    }\n);\n\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {fetch} from '~/lib/xhr-promise';\nimport {notify} from '~/lib/notifications';\nimport * as logging from '~/lib/logging';\n\nL.Layer.GeoJSONAjax = L.GeoJSON.extend({\n        options: {\n            requestTimeout: 30000\n        },\n\n        initialize: function(url, options) {\n            L.GeoJSON.prototype.initialize.call(this, null, options);\n            this.url = url;\n        },\n\n        // Promise can be rejected if json invalid or addData fails\n        loadData: function() {\n            if (this._loadStarted) {\n                return;\n            }\n            this._loadStarted = true;\n            fetch(this.url, {timeout: this.options.requestTimeout})\n                .then(\n                    (xhr) => {\n                        this.addData(JSON.parse(xhr.response));\n                    },\n                    (e) => {\n                        logging.captureException(e, 'failed to get geojson');\n                        notify(`Failed to get GeoJSON data from ${this.url}: ${e.message}`);\n                    }\n                );\n        },\n\n        onAdd: function(map) {\n            L.GeoJSON.prototype.onAdd.call(this, map);\n            this.loadData();\n        }\n    }\n);\n\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport '~/lib/leaflet.polyline-measure';\n\nL.Polyline.include({\n        _printProgressWeight: 0.1,\n        printWidthMm: 1,\n\n        cloneForPrint: function(options) {\n            options = L.Util.extend({}, this.options, options);\n            const latlngs = this.getLatLngs().map((latlng) => latlng.clone());\n            return new L.Polyline(latlngs, options);\n        },\n\n        _makelatLngToCanvasPixelTransformer: function(printOptions, shift) {\n            const projectedBounds = printOptions.pixelBounds;\n            const scale = projectedBounds.getSize().unscaleBy(printOptions.destPixelSize);\n            const origin = projectedBounds.min;\n            return function(latlng) {\n                return L.CRS.EPSG3857.latLngToPoint(latlng, printOptions.zoom)\n                    .subtract(origin)\n                    .add(L.point([shift, 0]))\n                    .unscaleBy(scale);\n            };\n        },\n\n        _shift: function(targetBounds, zoom) {\n            const polylineBounds = this.getBounds();\n            let shift = 0;\n            const worldWidth = L.CRS.EPSG3857.getProjectedBounds(zoom).getSize().x;\n            if (polylineBounds.isValid()) {\n                const polylineCenter = polylineBounds.getCenter();\n                const targetCenter = targetBounds.getCenter();\n\n                if (polylineCenter.lng < targetCenter.lng - 180) {\n                    shift = 1;\n                } else if (polylineCenter.lng > targetCenter.lng + 180) {\n                    shift = -1;\n                } else {\n                    shift = 0;\n                }\n            }\n            return {lng: shift * 360, projected: worldWidth * shift};\n        },\n\n        _drawRaster: function(canvas, printOptions) {\n            const latlngs = this.getLatLngs();\n            const shift = this._shift(printOptions.latLngBounds, printOptions.zoom);\n            const lineBounds = this.getBounds();\n            if (latlngs.length < 2) {\n                return false;\n            }\n            const shiftedLineBounds = L.latLngBounds([\n                [lineBounds.getNorth(), lineBounds.getWest() + shift.lng],\n                [lineBounds.getSouth(), lineBounds.getEast() + shift.lng]\n            ]);\n            if (!shiftedLineBounds.intersects(printOptions.latLngBounds)) {\n                return false;\n            }\n\n            const ctx = canvas.getContext('2d');\n            ctx.lineWidth = this.printWidthMm / 25.4 * printOptions.resolution;\n            ctx.lineJoin = 'round';\n            ctx.lineCap = 'round';\n            ctx.strokeStyle = this.options.color;\n            const transform = this._makelatLngToCanvasPixelTransformer(printOptions, shift.projected);\n            let point;\n            ctx.beginPath();\n\n            point = transform(latlngs[0]);\n            ctx.moveTo(point.x, point.y);\n            for (let i = 1; i < latlngs.length; i++) {\n                point = transform(latlngs[i]);\n                ctx.lineTo(point.x, point.y);\n            }\n            ctx.stroke();\n            return true;\n        },\n\n        getTilesInfo: async function(printOptions) {\n            return {\n                iterateTilePromises: (function*() {\n                    yield {\n                        tilePromise: Promise.resolve({\n                                draw: (canvas) => this._drawRaster(canvas, printOptions),\n                                isOverlay: true\n                            }\n                        ),\n                        abortLoading: () => {\n                            // no actions needed\n                        }\n                    };\n                }).bind(this),\n                count: 1\n            };\n        }\n    }\n);\n\nL.MeasuredLine.include({\n        tickFontSizeMm: 2.5,\n\n        cloneForPrint: function(options) {\n            options = L.Util.extend({}, this.options, options);\n            const latlngs = this.getLatLngs().map((latlng) => latlng.clone());\n            return new L.MeasuredLine(latlngs, options);\n        },\n\n        _drawRaster: function(canvas, printOptions) {\n            if (!L.Polyline.prototype._drawRaster.call(this, canvas, printOptions)) {\n                return;\n            }\n            if (!this.options.measureTicksShown) {\n                return;\n            }\n            const minTicksIntervalMeters = printOptions.scale * 1.5;\n            const ctx = canvas.getContext('2d');\n            const ticks = this.getTicksPositions(minTicksIntervalMeters);\n            const ticksPixelSize = this.tickFontSizeMm / 25.4 * printOptions.resolution;\n            const shift = this._shift(printOptions.latLngBounds, printOptions.zoom);\n            const transform = this._makelatLngToCanvasPixelTransformer(printOptions, shift.projected);\n            ctx.font = `bold ${ticksPixelSize}px verdana`;\n            ctx.fillStyle = this.options.color;\n            for (let tick of ticks) {\n                let m = tick.transformMatrix;\n                let label = '\\u2501\\u2501 ' + Math.round((tick.distanceValue / 10)) / 100 + ' km';\n                let position = transform(tick.position);\n                ctx.setTransform(m[0], m[1], m[2], m[3], position.x, position.y);\n                ctx.fillText(label, 0, ticksPixelSize * 0.3);\n                ctx.setTransform(1, 0, 0, 1, 0, 0);\n            }\n        }\n    }\n);\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\n\nimport {RetinaTileLayer} from '~/lib/leaflet.layer.RetinaTileLayer';\nimport './TileLayer';\n\nRetinaTileLayer.include({\n    cloneForPrint: function(options) {\n        const newOptions = L.Util.extend({}, this.options, options);\n        return new RetinaTileLayer(this.urls, newOptions, newOptions.scaleDependent);\n    },\n\n    getTilesInfo: async function(printOptions) {\n        const tilesInfo = await L.TileLayer.prototype.getTilesInfo.call(this, printOptions);\n        tilesInfo.tileScale = this.tileSizeMultiplicator;\n        return tilesInfo;\n    },\n});\n","export default \"<div class=\\\"leaflet-control-button-toggle\\\" title=\\\"Print map\\\"\\n     data-bind=\\\"click: setExpanded, css: {'icon-spinner-nuclear': makingPdf, 'icon-printer': !makingPdf()}\\\">\\n    </div>\\n<div class=\\\"leaflet-control-content\\\">\\n<table class=\\\"layout\\\">\\n    <tbody>\\n    <tr><td colspan=\\\"2\\\">\\n        <a title=\\\"Add page in portrait orientation\\\" class=\\\"button-add-page-vert image-button\\\"\\n           data-bind=\\\"click: addPortraitPage\\\"></a>\\n        <a title=\\\"Add page in landscape orientation\\\" class=\\\"button-add-page-horiz image-button\\\"\\n           data-bind=\\\"click: addLandscapePage\\\"></a>\\n        <span class=\\\"pages-num\\\" data-bind=\\\"text: pagesNumLabel, click: onPagesNumLabelClick, css: {'pages-not-null': pagesNum() > 0}\\\"></span>\\n        <a title=\\\"Remove all pages\\\" class=\\\"button-remove-pages image-button\\\"\\n           data-bind=\\\"click: removePages\\\"></a>\\n    </td></tr>\\n    <tr>\\n        <td class=\\\"label\\\">Print scale</td>\\n        <td>\\n            <div class=\\\"preset-values\\\" >\\n                <a data-bind=\\\"click: function() {scale(100)}, css: {selected: scale() === 100}\\\">100 m</a>\\n                <a data-bind=\\\"click: function() {scale(500)}, css: {selected: scale() === 500}\\\">500 m</a>\\n                <a data-bind=\\\"click: function() {scale(1000)}, css: {selected: scale() === 1000}\\\">1 km</a>\\n            </div>\\n            <input type=\\\"text\\\" class=\\\"scale\\\" maxlength=\\\"6\\\" data-bind=\\\"value: scale\\\">&nbsp;m in 1 cm\\n        </td>\\n    </tr>\\n    <tr data-bind=\\\"visible: settingsExpanded\\\">\\n        <td class=\\\"label\\\">Page size</td>\\n        <td>\\n            <div class=\\\"preset-values\\\" data-bind=\\\"foreach: {data: pageSizes, as: 'size'}\\\">\\n                <a data-bind=\\\"click: function() {$root.pageWidth(size.width); $root.pageHeight(size.height)},\\n                              text: size.name,\\n                              css: {selected: size.name === $root.pageSizeDescription() }\\\"></a>\\n            </div>\\n            <input type=\\\"text\\\" maxlength=\\\"4\\\" title=\\\"width\\\" placeholder=\\\"width\\\" class=\\\"page-size\\\" data-bind=\\\"value: pageWidth\\\">\\n            x <input type=\\\"text\\\" maxlength=\\\"4\\\" title=\\\"height\\\" placeholder=\\\"height\\\" class=\\\"page-size\\\" data-bind=\\\"value: pageHeight\\\"> mm\\n        </td>\\n    </tr>\\n    <tr data-bind=\\\"visible: settingsExpanded\\\">\\n        <td class=\\\"label-high\\\">Margins</td>\\n        <td>\\n            <table class=\\\"margins\\\">\\n                <tr>\\n                    <td></td>\\n                    <td><input type=\\\"text\\\" maxlength=\\\"2\\\" value=\\\"3\\\" data-bind=\\\"value: marginTop\\\"></td>\\n                    <td></td>\\n                </tr>\\n                <tr>\\n                    <td><input type=\\\"text\\\" maxlength=\\\"2\\\" value=\\\"3\\\" data-bind=\\\"value: marginLeft\\\"></td>\\n                    <td></td><td><input type=\\\"text\\\" maxlength=\\\"2\\\" value=\\\"3\\\" data-bind=\\\"value: marginRight\\\"> mm</td>\\n                </tr>\\n                <tr><td></td><td><input type=\\\"text\\\" maxlength=\\\"2\\\" value=\\\"3\\\" data-bind=\\\"value: marginBottom\\\"></td><td></td></tr>\\n            </table>\\n        </td>\\n    </tr>\\n    <tr data-bind=\\\"visible: settingsExpanded\\\">\\n        <td class=\\\"label\\\">Resolution</td>\\n        <td><input type=\\\"text\\\" maxlength=\\\"4\\\" class=\\\"resolution\\\" data-bind=\\\"value: resolution\\\"> dpi</td>\\n    </tr>\\n    <tr data-bind=\\\"visible: settingsExpanded\\\">\\n        <td class=\\\"label\\\">Source zoom<br />level</td>\\n        <td>\\n            <select name=\\\"srczoom\\\"\\n                    data-bind=\\\"options: zoomLevels, value: zoomLevel\\\">\\n            </select>\\n        </td>\\n    </tr>\\n    <tr>\\n        <td colspan=\\\"2\\\">\\n            <label><input type=\\\"checkbox\\\" data-bind=\\\"checked: magneticMeridiansOn\\\"> Magnetic meridians</label>\\n            <label><input type=\\\"checkbox\\\" data-bind=\\\"checked: gridOn\\\"> Kilometers grid</label>\\n        </td>\\n    </tr>\\n    <tr><td colspan=\\\"2\\\">\\n        <a class=\\\"button-settings image-button\\\" data-bind=\\\"click: function() {settingsExpanded(!settingsExpanded())}\\\"\\n            title=\\\"More settings\\\"></a>\\n        <div class=\\\"settings-summary\\\">\\n            <span data-bind=\\\"text: pageSizeDescription\\\"></span><br/>\\n            <span data-bind=\\\"text: resolution\\\"></span>&nbsp;dpi,\\n            zoom&nbsp;<span data-bind=\\\"text: zoomLevel\\\"></span>\\n            <!-- ko if: zoomLevel()=== \\\"auto\\\" -->\\n            (<span title=\\\"Zoom for satellite and scanned imagery\\\" data-bind=\\\"text: autoZoomLevels().satZoom\\\"></span>&nbsp;\\n            /&nbsp;<span title=\\\"Zoom for maps like OSM and Google\\\" data-bind=\\\"text: autoZoomLevels().mapZoom\\\"></span>)\\n            <!-- /ko -->\\n        </div>\\n    </td></tr>\\n    <tr><td colspan=\\\"2\\\">\\n        <div class=\\\"download-button-row\\\">\\n            <div class=\\\"button-minimize\\\" data-bind=\\\"click: setMinimized\\\"></div>\\n            <a class=\\\"text-button button-save\\\" data-bind=\\\"\\n                                click: onSavePdfClicked,\\n                                visible: !makingPdf()\\\">Save PDF</a>\\n            <div data-bind=\\\"\\n                                component: { \\n                                    name: 'progress-indicator',\\n                                    params: {progressRange: downloadProgressRange, progressDone: downloadProgressDone}\\n                                },\\n                                visible: makingPdf()\\\"></div>\\n        </div>\\n    </td></tr>\\n    </tbody>\\n</table>\\n</div>\\n\";","function header() {\n    return '%PDF-1.3';\n}\n\nfunction eof() {\n    return '%%EOF\\n';\n}\n\nfunction recCatalog() {\n    return (\n`1 0 obj\n<< /Type /Catalog\n/Pages 2 0 R\n>>\nendobj`);\n}\n\nfunction recPages(count) {\n    let kidsIds = [];\n    for (let i = 0; i < count; i++) {\n        kidsIds.push(`${i * 3 + 3} 0 R`);\n    }\n    kidsIds = kidsIds.join(' ');\n    return (\n`2 0 obj\n<< /Type /Pages        \n/Kids [ ${kidsIds} ]\n/Count ${count}\n>>\nendobj`);\n}\n\nfunction recPage(serialNum, width, height) {\n    const pageRecId = serialNum * 3 + 3;\n    const contentRecId = pageRecId + 1;\n    const imageRecId = pageRecId + 2;\n    return (\n`${pageRecId} 0 obj\n<< /Type /Page\n/Parent 2 0 R\n/MediaBox [0 0 ${width} ${height}]\n/Contents ${contentRecId} 0 R\n/Rotate ${width > height ? 90 : 0}\n/Resources <<\n    /XObject << /Im${serialNum} ${imageRecId} 0 R >>\n    /ProcSet [ /PDF /Text /ImageC ] \n    >>\n>>\nendobj`);\n}\n\nfunction recContent(serialNum, width, height) {\n    const pageRecId = serialNum * 3 + 3;\n    const contentRecId = pageRecId + 1;\n    const contents = (\n`q\n${width} 0 0 ${height} 0 0 cm\n/Im${serialNum} Do\nQ   `);\n    return (\n`${contentRecId} 0 obj\n<<\n/Length ${contents.length + 1}\n>>\nstream\n${contents}   \nendstream\nendobj`);\n}\n\nfunction recImage(serialNum, widthPixels, heightPixels, data) {\n    const pageRecId = serialNum * 3 + 3;\n    const imageRecId = pageRecId + 2;\n\n    return (\n`${imageRecId} 0 obj\n<< /Type /XObject\n/Subtype /Image\n/Name /Im${serialNum}\n/Filter [ /DCTDecode ]\n/Width ${widthPixels}\n/Height ${heightPixels}\n/ColorSpace /DeviceRGB\n/BitsPerComponent 8\n/Length ${data.length}\n>>\nstream\n${data}\nendstream\nendobj`);\n}\n\nfunction recTrailer(recOffsets, currentOffset) {\n    const trailer = [];\n    trailer.push(\n`xref\n0 ${recOffsets.length + 1}\n0000000000 65535 f `);\n    const zeroes = '0000000000';\n    for (let offset of recOffsets) {\n        offset = offset.toString();\n        let padding = zeroes.substr(offset.length);\n        trailer.push(`${padding}${offset} 00000 n `);\n    }\n\n    trailer.push(\n`trailer\n<< /Root 1 0 R\n/Size ${recOffsets.length + 1}\n>>\nstartxref\n${currentOffset}`);\n    return trailer.join('\\n');\n}\n\nfunction makePdf(imagesInfo, resolution) {\n    let offset = 0;\n    const offsets = [];\n    let pdf = [];\n\n    function addRec(s, skipOffset) {\n        pdf.push(s);\n        if (!skipOffset) {\n            offsets.push(offset);\n        }\n        offset += s.length;\n    }\n\n    addRec(header(), true);\n    addRec(recCatalog());\n    addRec(recPages(imagesInfo.length));\n    for (let [i, {data, width, height}] of imagesInfo.entries()) {\n        let widthPoints = width / resolution * 72,\n            heightPoints = height / resolution * 72;\n        addRec(recPage(i, widthPoints, heightPoints));\n        addRec(recContent(i, widthPoints, heightPoints));\n        addRec(recImage(i, width, height, data));\n    }\n    addRec(recTrailer(offsets, offset), true);\n    addRec(eof(), true);\n\n    pdf = pdf.join('\\n');\n    return pdf;\n}\n\nexport {makePdf};\n\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {getDeclination} from '~/lib/magnetic-declination';\nimport {PrintStaticLayer} from './decorations';\n\nfunction radians(degrees) {\n    return degrees * Math.PI / 180;\n}\n\nfunction movePoint(p, angle, dist) {\n    angle = radians(angle);\n    return L.point(p.x + Math.sin(angle) * dist, p.y - Math.cos(angle) * dist);\n}\n\nclass MagneticMeridians extends PrintStaticLayer {\n    lineThicknessMm = 0.2;\n    lineIntervalMm = 50;\n    samplingIntervalMm = 15;\n    color = '#66c2ff';\n    overlaySolid = false;\n\n    _makeCanvasToLatLngTransformer(printOptions) {\n        const projectedBounds = printOptions.pixelBounds;\n        const scale = projectedBounds.getSize().unscaleBy(printOptions.destPixelSize);\n        const origin = projectedBounds.min;\n        return function(pixel) {\n            return L.CRS.EPSG3857.pointToLatLng(pixel.scaleBy(scale).add(origin), printOptions.zoom);\n        };\n    }\n\n    _drawRaster(canvas, printOptions) {\n        const toLatLng = this._makeCanvasToLatLngTransformer(printOptions);\n        const ctx = canvas.getContext('2d');\n        ctx.beginPath();\n        ctx.strokeStyle = this.color;\n        ctx.lineWidth = this.lineThicknessMm / 25.4 * printOptions.resolution;\n        const intervalPx = this.lineIntervalMm / 25.4 * printOptions.resolution;\n        const samplingPx = this.samplingIntervalMm / 25.4 * printOptions.resolution;\n        const pageDiagonal = Math.sqrt(\n            printOptions.destPixelSize.x * printOptions.destPixelSize.x +\n            printOptions.destPixelSize.y * printOptions.destPixelSize.y\n        );\n        const maxSegments = pageDiagonal / 2 / samplingPx;\n\n        function drawLine(p, directionDown) {\n            ctx.moveTo(p.x, p.y);\n\n            for (let i = 0; i <= maxSegments; i++) {\n                let latLng = toLatLng(p);\n                let declination = getDeclination(latLng.lat, latLng.lng);\n                if (declination === null) {\n                    break;\n                }\n                if (directionDown) {\n                    declination += 180;\n                }\n                p = movePoint(p, declination, samplingPx);\n                ctx.lineTo(p.x, p.y);\n            }\n        }\n\n        const center = printOptions.destPixelSize.divideBy(2);\n        const maxLines = pageDiagonal / 2 / intervalPx;\n\n        drawLine(center);\n        drawLine(center, true);\n\n        let p = center;\n        for (let i = 0; i <= maxLines; i++) {\n            let latLng = toLatLng(p);\n            let declination = getDeclination(latLng.lat, latLng.lng);\n            if (declination === null) {\n                declination = 0;\n            }\n            p = movePoint(p, declination + 90, intervalPx);\n            drawLine(p);\n            drawLine(p, true);\n        }\n        p = center;\n        for (let i = 0; i <= maxLines; i++) {\n            let latLng = toLatLng(p);\n            let declination = getDeclination(latLng.lat, latLng.lng);\n            if (declination === null) {\n                declination = 0;\n            }\n            p = movePoint(p, declination - 90, intervalPx);\n            drawLine(p);\n            drawLine(p, true);\n        }\n\n        ctx.stroke();\n    }\n}\n\nexport {MagneticMeridians};\n","import {PrintStaticLayer} from './decorations';\n\nfunction pageScaleRange(printOptions) {\n    const pageSize = printOptions.destPixelSize.divideBy(printOptions.resolution / 25.4);\n    const bounds = printOptions.latLngBounds;\n    const southLen = bounds.getSouthEast().distanceTo(bounds.getSouthWest());\n    const northLen = bounds.getNorthEast().distanceTo(bounds.getNorthWest());\n    const nScale = Math.round(northLen / pageSize.x * 10);\n    const sScale = Math.round(southLen / pageSize.x * 10);\n    return {\n        min: Math.min(nScale, sScale, printOptions.scale),\n        max: Math.max(nScale, sScale, printOptions.scale)\n    };\n}\n\nfunction formatScale(nominalScale, scaleRange) {\n    const threshold = 0.05;\n    if (\n        Math.abs(nominalScale - scaleRange.min) / nominalScale > threshold ||\n        Math.abs(nominalScale - scaleRange.max) / nominalScale > threshold\n    ) {\n        let unit;\n        scaleRange = {...scaleRange};\n        if (scaleRange.min >= 1000) {\n            scaleRange.min /= 1000;\n            scaleRange.max /= 1000;\n            unit = 'km';\n        } else {\n            unit = 'm';\n        }\n        return `${scaleRange.min} – ${scaleRange.max} ${unit} in 1 cm`;\n    }\n    let unit;\n    if (nominalScale >= 1000) {\n        nominalScale /= 1000;\n        unit = 'km';\n    } else {\n        unit = 'm';\n    }\n    return `${nominalScale} ${unit} in 1 cm`;\n}\n\nclass OverlayScale extends PrintStaticLayer {\n    fontSizeMm = 3;\n    font = 'verdana';\n    paddingMm = 1;\n    overlaySolid = true;\n\n    _drawRaster(canvas, printOptions) {\n        const ctx = canvas.getContext('2d');\n        let caption = formatScale(printOptions.scale, pageScaleRange(printOptions));\n        if (printOptions.pagesCount > 1) {\n            caption += ` | Page ${printOptions.pageLabel} / ${printOptions.pagesCount}`;\n        }\n        const fontSize = this.fontSizeMm / 25.4 * printOptions.resolution;\n        const padding = this.paddingMm / 25.4 * printOptions.resolution;\n        ctx.font = `${fontSize}px ${this.font}`;\n        const textWidth = ctx.measureText(caption).width;\n        ctx.textBaseline = 'bottom';\n        ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';\n        ctx.fillRect(0, 0, textWidth + 2 * padding, fontSize + 2 * padding);\n        ctx.fillStyle = '#000000';\n        ctx.fillText(caption, padding, fontSize + padding);\n    }\n}\n\nexport {OverlayScale};\n","import {PrintStaticLayer} from './decorations';\nimport L from 'leaflet';\n\nfunction radians(degrees) {\n    return degrees * Math.PI / 180;\n}\n\nclass Grid extends PrintStaticLayer {\n    minGridIntervalMm = 15;\n\n    fontSizeMm = 3;\n    font = 'verdana';\n    paddingMm = 1;\n\n    /* eslint-disable array-element-newline*/\n    intervals = [\n        1, 1.5, 2, 3.3, 5, 7.5,\n        10, 15, 20, 33, 50, 75,\n        100, 150, 200, 333, 500, 750,\n        1000, 1500, 2000, 4000, 5000, 7500,\n        10000, 15000, 20000, 40000, 50000, 75000,\n        100000, 150000, 200000, 400000, 500000, 750000,\n        1000000, 1500000, 2000000, 4000000, 5000000, 7500000\n    ];\n    /* eslint-enable array-element-newline*/\n\n    getGridInterval(printOptions) {\n        const minGridIntervalM = this.minGridIntervalMm / 10 * printOptions.scale;\n        let intervalM;\n        for (intervalM of this.intervals) {\n            if (intervalM > minGridIntervalM) {\n                break;\n            }\n        }\n        return intervalM;\n    }\n\n    formatDistance(x) {\n        let unit;\n        if (x < 1000) {\n            unit = 'm';\n        } else {\n            x /= 1000;\n            unit = 'km';\n        }\n        if (x % 1) {\n            x = x.toFixed(1);\n        }\n        return `${x} ${unit}`;\n    }\n\n    _drawGrid(canvas, printOptions) {\n        const metersPerDegree = L.Projection.SphericalMercator.R * Math.PI / 180;\n        const ctx = canvas.getContext('2d');\n        ctx.beginPath();\n        const pixelsPerMm = 1 / 25.4 * printOptions.resolution;\n        const intervalM = this.getGridInterval(printOptions);\n        const width = printOptions.destPixelSize.x;\n        const height = printOptions.destPixelSize.y;\n        const mercatorBounds = L.bounds(\n            L.Projection.SphericalMercator.project(printOptions.latLngBounds.getNorthWest()),\n            L.Projection.SphericalMercator.project(printOptions.latLngBounds.getSouthEast())\n        );\n        const canvasToMercatorScale = mercatorBounds.getSize().unscaleBy(printOptions.destPixelSize);\n        const rows = [];\n        let y = height;\n        while (true) {\n            let yMerc = mercatorBounds.max.y - y * canvasToMercatorScale.y;\n            let lat = L.Projection.SphericalMercator.unproject(L.point(0, yMerc)).lat;\n            rows.push({lat, y});\n            if (y < 0) {\n                break;\n            }\n            let lat2 = lat + intervalM / metersPerDegree;\n            let yMerc2 = L.Projection.SphericalMercator.project(L.latLng(lat2, 0)).y;\n            y = (mercatorBounds.max.y - yMerc2) / canvasToMercatorScale.y;\n        }\n        const lineWidthMm = 0.15;\n        let lineWidthPx = lineWidthMm * pixelsPerMm;\n        for (let {color, offset} of [\n            {color: '#D9D9D9', offset: lineWidthPx / 2},\n            {color: '#8C8C8C', offset: -lineWidthPx / 2},\n        ]) {\n            ctx.beginPath();\n\n            ctx.lineWidth = lineWidthPx;\n            ctx.strokeStyle = color;\n\n            for ({y} of rows) {\n                ctx.moveTo(0, y + offset);\n                ctx.lineTo(width, y + offset);\n            }\n            const pageCanvasCenterX = printOptions.destPixelSize.x / 2;\n            for (let direction of [-1, 1]) {\n                let colN = 0;\n                while (true) {\n                    let firstRow = true;\n                    let hasPointInPage = false;\n                    for (let {lat, y} of rows) {\n                        let dx = colN * intervalM / Math.cos(radians(lat)) / canvasToMercatorScale.x;\n                        // eslint-disable-next-line max-depth\n                        if (dx < pageCanvasCenterX) {\n                            hasPointInPage = true;\n                        }\n                        // eslint-disable-next-line max-depth\n                        if (firstRow) {\n                            ctx.moveTo(pageCanvasCenterX + dx * direction + offset, y);\n                        } else {\n                            ctx.lineTo(pageCanvasCenterX + dx * direction + offset, y);\n                        }\n                        firstRow = false;\n                    }\n                    if (!hasPointInPage) {\n                        break;\n                    }\n                    colN += 1;\n                }\n            }\n            ctx.stroke();\n        }\n    }\n\n    _drawLabel(canvas, printOptions) {\n        const intervalM = this.getGridInterval(printOptions);\n        const height = printOptions.destPixelSize.y;\n        const ctx = canvas.getContext('2d');\n        const caption = 'Grid ' + this.formatDistance(intervalM);\n        const fontSize = this.fontSizeMm / 25.4 * printOptions.resolution;\n        const padding = this.paddingMm / 25.4 * printOptions.resolution;\n        ctx.font = `${fontSize}px ${this.font}`;\n        const textWidth = ctx.measureText(caption).width;\n        ctx.textBaseline = 'bottom';\n        ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';\n        ctx.fillRect(0, height - fontSize - 2 * padding, textWidth + 2 * padding, fontSize + 2 * padding);\n        ctx.fillStyle = '#000000';\n        ctx.fillText(caption, padding, height - padding);\n    }\n\n    async getTilesInfo(printOptions) {\n        return {\n            iterateTilePromises: (function*() {\n                yield {\n                    tilePromise: Promise.resolve({\n                            draw: (canvas) => this._drawGrid(canvas, printOptions),\n                            isOverlay: true,\n                            overlaySolid: false\n                        }\n                    ),\n                    abortLoading: () => {\n                        // no actions needed\n                    }\n                };\n                yield {\n                    tilePromise: Promise.resolve({\n                            draw: (canvas) => this._drawLabel(canvas, printOptions),\n                            isOverlay: true,\n                            overlaySolid: true\n                        }\n                    ),\n                    abortLoading: () => {\n                        // no actions needed\n                    }\n                };\n            }).bind(this),\n            count: 2\n        };\n    }\n}\n\nexport {Grid};\n","import L from 'leaflet';\nimport './style.css';\nimport '~/lib/leaflet.control.commons';\n\nL.Control.Caption = L.Control.extend({\n    options: {\n        position: 'bottomright',\n        className: 'leaflet-control-caption'\n    },\n\n    initialize: function(contents, options) {\n        L.setOptions(this, options);\n        this._contents = contents;\n    },\n\n    onAdd: function(map) {\n        this._map = map;\n        this._container = L.DomUtil.create('div', this.options.className);\n        this._container.innerHTML = this._contents;\n        L.DomEvent.on(this._container, 'contextmenu', (e) => {\n            L.DomEvent.stopPropagation(e);\n            e.returnValue = true;\n            return true;\n        });\n        return this._container;\n    },\n\n    setContents: function(contents) {\n        this._contents = contents;\n        if (this._map) {\n            this._container.innerHTML = this._contents;\n        }\n    }\n\n});\n\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport ko from 'knockout';\nimport './coordinates.css';\nimport copyToClipboard from '~/lib/clipboardCopy';\nimport Contextmenu from '~/lib/contextmenu';\nimport {makeButtonWithBar} from '~/lib/leaflet.control.commons';\nimport safeLocalStorage from '~/lib/safe-localstorage';\nimport '~/lib/controls-styles/controls-styles.css';\nimport * as formats from './formats';\n\nconst DEFAULT_FORMAT = formats.DEGREES;\nconst UNKNOWN_COORDINATES = {\n    lat: '-------',\n    lng: '-------'\n};\n\nL.Control.Coordinates = L.Control.extend({\n        options: {\n            position: 'bottomleft'\n        },\n\n        formats: [\n            formats.SIGNED_DEGREES,\n            formats.DEGREES,\n            formats.DEGREES_AND_MINUTES,\n            formats.DEGREES_AND_MINUTES_AND_SECONDS\n        ],\n\n        initialize: function(options) {\n            L.Control.prototype.initialize.call(this, options);\n\n            this.latlng = ko.observable();\n            this.format = ko.observable(DEFAULT_FORMAT);\n            this.formatCode = ko.pureComputed({\n                read: () => this.format().code,\n                write: (value) => {\n                    for (let format of this.formats) {\n                        if (value === format.code) {\n                            this.format(format);\n                            break;\n                        }\n                    }\n                }\n            });\n\n            this.formattedCoordinates = ko.pureComputed(() => {\n                if (this.latlng()) {\n                    return formats.formatLatLng(this.latlng().wrap(), this.format());\n                }\n                return UNKNOWN_COORDINATES;\n            }, this);\n\n            this.wrapperClass = ko.pureComputed(() => this.format().wrapperClass, this);\n\n            this.formatCode.subscribe(this.saveStateToStorage, this);\n        },\n\n        onAdd: function(map) {\n            const {container, link, barContainer} = makeButtonWithBar(\n                'leaflet-contol-coordinates',\n                'Показать координаты под курсором',\n                'icon-coordinates'\n            );\n\n            this._map = map;\n            this._container = container;\n            this._link = link;\n\n            barContainer.innerHTML = `\n                <div data-bind=\"css: wrapperClass\">\n                    <div class=\"leaflet-coordinates-container\" data-bind=\"with: formattedCoordinates()\">\n                        <span class=\"leaflet-coordinates-latitude\" data-bind=\"html: lat\"></span>\n                        <span class=\"leaflet-coordinates-longitude\" data-bind=\"html: lng\"></span>\n                    </div>\n                    <hr class=\"leaflet-coordinates-divider\" />\n                    <div data-bind=\"foreach: formats\">\n                        <div>\n                            <label title=\"\">\n                                <input type=\"radio\" data-bind=\"checked: $parent.formatCode, value: code\" \n                                       class=\"leaflet-coordinates-format-radio\"/>\n                                <span data-bind=\"html: label\"></span>\n                            </label>\n                        </div>\n                    </div>\n                </div>\n            `;\n\n            barContainer.title = \"Правый клик для копирования координат\";\n\n            this.loadStateFromStorage();\n            ko.applyBindings(this, container);\n            L.DomEvent.on(link, 'click', this.onClick, this);\n\n            return container;\n        },\n\n        onRemove: function() {\n            L.DomEvent.off(this._link, 'click', this.onClick, this);\n        },\n\n        loadStateFromStorage: function() {\n            const active = safeLocalStorage.leafletCoordinatesActive === '1';\n            const code = safeLocalStorage.leafletCoordinatesFmt || DEFAULT_FORMAT.code;\n\n            this.formatCode(code);\n            this.setEnabled(active);\n        },\n\n        saveStateToStorage: function() {\n            safeLocalStorage.leafletCoordinatesActive = this.isEnabled() ? '1' : '0';\n            safeLocalStorage.leafletCoordinatesFmt = this.formatCode();\n        },\n\n        onMouseMove: function(e) {\n            this.latlng(e.latlng);\n        },\n\n        setEnabled: function(enabled) {\n            if (Boolean(enabled) === this.isEnabled()) {\n                return;\n            }\n            const classFunc = enabled ? 'addClass' : 'removeClass';\n            const eventFunc = enabled ? 'on' : 'off';\n            L.DomUtil[classFunc](this._container, 'active');\n            L.DomUtil[classFunc](this._container, 'highlight');\n            L.DomUtil[classFunc](this._map._container, 'coordinates-control-active');\n            this._map[eventFunc]('mousemove', this.onMouseMove, this);\n            this._map[eventFunc]('contextmenu', this.onMapRightClick, this);\n            this._isEnabled = Boolean(enabled);\n            this.latlng(null);\n        },\n\n        onMapRightClick: function(e) {\n            L.DomEvent.stop(e);\n\n            function createItem(format, options = {}) {\n                const {lat, lng} = formats.formatLatLng(e.latlng.wrap(), format);\n                const coordinates = `${lat} ${lng}`;\n\n                return {text: `${coordinates} <span class=\"leaflet-coordinates-menu-fmt\">${format.label}</span>`,\n                    callback: () => copyToClipboard(coordinates, e.originalEvent),\n                    ...options};\n            }\n\n            const header = createItem(this.format(), {\n                text: '<b>Скопировать в буфер обмена</b>',\n                header: true,\n            });\n            const items = this.formats.map((format) => createItem(format));\n            items.unshift(header, '-');\n\n            new Contextmenu(items).show(e);\n        },\n\n        isEnabled: function() {\n            return Boolean(this._isEnabled);\n        },\n\n        onClick: function() {\n            this.setEnabled(!this.isEnabled());\n            this.saveStateToStorage();\n        }\n    }\n);\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","function truncToFixed(x, precision) {\n    let s = x.toString();\n    let point = s.indexOf('.');\n    if (point === -1) {\n        point = s.length;\n        s += '.';\n    }\n    let sliceEnd = point + precision;\n    if (precision > 0) {\n        s = s.padEnd(point + precision + 1, '0');\n        sliceEnd += 1;\n    }\n    s = s.slice(0, sliceEnd);\n    return s;\n}\n\nfunction formatNumber(value, size, precision = 0) {\n    if (value < 0) {\n      throw new Error('Negative values not supported');\n    }\n\n    if (precision > 0) {\n        size += 1;\n    }\n    return truncToFixed(value, precision).padStart(size + precision, '0');\n}\n\nfunction coordinatePresentations(coordinate, isLat) {\n    const degrees = Math.abs(coordinate);\n    const intDegrees = Math.floor(degrees);\n    const minutes = (degrees - intDegrees) * 60;\n    const intMinutes = Math.floor(minutes);\n    const seconds = (minutes - intMinutes) * 60;\n\n    let direction;\n    if (isLat) {\n        direction = (coordinate < 0) ? 'S' : 'N';\n    } else {\n        direction = (coordinate < 0) ? 'W' : 'E';\n    }\n\n    return {\n        signedDegrees: coordinate.toFixed(5),\n        degrees: formatNumber(degrees, 0, 5),\n        intDegrees: formatNumber(intDegrees, 0),\n        minutes: formatNumber(minutes, 2, 3),\n        intMinutes: formatNumber(intMinutes, 2),\n        seconds: formatNumber(seconds, 2, 2),\n        direction\n    };\n}\n\nfunction formatLatLng(latlng, format) {\n    return {\n        lat: format.formatter(coordinatePresentations(latlng.lat, true)),\n        lng: format.formatter(coordinatePresentations(latlng.lng, false))\n    };\n}\n\nconst SIGNED_DEGREES = {\n    code: 'd',\n    label: '±ddd.ddddd',\n    wrapperClass: 'leaflet-coordinates-wrapper-signed-degrees',\n    formatter: ({signedDegrees}) => signedDegrees\n};\n\nconst DEGREES = {\n    code: 'D',\n    label: 'ddd.ddddd°',\n    wrapperClass: 'leaflet-coordinates-wrapper-degrees',\n    formatter: ({degrees, direction}) => `${direction} ${degrees}°`\n};\n\nconst DEGREES_AND_MINUTES = {\n    code: 'DM',\n    label: 'ddd°mm.mmm′',\n    wrapperClass: 'leaflet-coordinates-wrapper-degrees-and-minutes',\n    formatter: ({intDegrees, minutes, direction}) => `${direction} ${intDegrees}°${minutes}′`\n};\n\nconst DEGREES_AND_MINUTES_AND_SECONDS = {\n    code: 'DMS',\n    label: 'ddd°mm′ss.s″',\n    wrapperClass: 'leaflet-coordinates-wrapper-degrees-and-minutes-and-seconds',\n    formatter: ({intDegrees, intMinutes, seconds, direction}) => `${direction} ${intDegrees}°${intMinutes}′${seconds}″`\n};\n\nexport {\n    SIGNED_DEGREES,\n    DEGREES,\n    DEGREES_AND_MINUTES,\n    DEGREES_AND_MINUTES_AND_SECONDS,\n    formatLatLng\n};\n","import L from 'leaflet';\nimport './style.css';\n\nfunction getLayerHotkey(layer) {\n    if (!layer || !layer.options) {\n        return null;\n    }\n    let hotkey = layer.options.hotkey;\n    if (hotkey) {\n        return hotkey;\n    }\n    hotkey = layer.options.code;\n    if (hotkey && hotkey.length === 1) {\n        return hotkey;\n    }\n    return null;\n}\n\nfunction extendLayerName(name, layer) {\n    if (layer.options) {\n        const hotkey = getLayerHotkey(layer);\n        if (hotkey) {\n            name += `<span class=\"layers-control-hotkey\">${hotkey}</span>`;\n        }\n    }\n    return name;\n}\n\nfunction enableHotKeys(control) {\n    const originalOnAdd = control.onAdd;\n    const originalOnRemove = control.onRemove;\n    const originalAddItem = control._addItem;\n\n    if (control._hotKeysEnabled) {\n        return control;\n    }\n\n    L.Util.extend(control, {\n            _hotKeysEnabled: true,\n\n            _addItem: function(obj) {\n                if (!L.Browser.touch || !L.Browser.mobile) {\n                    obj = L.Util.extend({}, obj);\n                    obj.name = extendLayerName(obj.name, obj.layer);\n                }\n                return originalAddItem.call(this, obj);\n            },\n\n            onAdd: function(map) {\n                var result = originalOnAdd.call(this, map);\n                this._addHotketEvents();\n                return result;\n            },\n\n            onRemove: function(map) {\n                L.DomEvent.off(document, 'keyup', this._onHotkeyUp, this);\n                L.DomEvent.off(document, 'keydown', this.onKeyDown, this);\n                originalOnRemove.call(this, map);\n            },\n\n            _addHotKetEvents: function() {\n                L.DomEvent.on(document, 'keyup', this._onHotkeyUp, this);\n                L.DomEvent.on(document, 'keydown', this.onKeyDown, this);\n            },\n\n            onKeyDown: function(e) {\n                if (e.altKey || e.ctrlKey || e.shiftKey) {\n                    return;\n                }\n                this._keyDown = e.keyCode;\n            },\n\n            _onHotkeyUp: function(e) {\n                const pressedKey = this._keyDown;\n                this._keyDown = null;\n                const targetTag = e.target.tagName.toLowerCase();\n                if (\n                    (targetTag === 'input' && ['text', 'search'].includes(e.target.type)) ||\n                    targetTag === 'textarea' ||\n                    pressedKey !== e.keyCode\n                ) {\n                    return;\n                }\n                const key = String.fromCharCode(e.keyCode);\n                for (let layer of this._layers) {\n                    let layerId = L.stamp(layer.layer);\n                    const layerHotkey = getLayerHotkey(layer.layer);\n                    if (layerHotkey === key) {\n                        const inputs = this._container.getElementsByTagName('input');\n                        for (let input of [...inputs]) {\n                            if (input.layerId === layerId) {\n                                input.click();\n                                break;\n                            }\n                        }\n                        break;\n                    }\n                }\n            }\n        }\n    );\n    for (let layer of control._layers) {\n        layer.name = extendLayerName(layer.name, layer.layer);\n    }\n    control._addHotKetEvents();\n    control._update();\n    return control;\n}\n\nexport default enableHotKeys;\n\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport './leaflet.hashState';\n\nL.Map.include(L.Mixin.HashState);\n\nL.Map.include({\n        stateChangeEvents: ['moveend'],\n\n        serializeState: function() {\n            var center = this.getCenter();\n            var zoom = this.getZoom();\n            var precision = 5;\n            var state = [\n                zoom.toString(),\n                center.lat.toFixed(precision),\n                center.lng.toFixed(precision)\n            ];\n            return state;\n        },\n\n        validateState: function(values) {\n            if (!values || values.length !== 3) {\n                return {valid: false};\n            }\n            let zoom = parseInt(values[0], 10),\n                lat = parseFloat(values[1]),\n                lng = parseFloat(values[2]);\n            if (isNaN(zoom) || isNaN(lat) || isNaN(lng) || zoom < 0 || zoom > 32 || lat < -90 || lat > 90) {\n                return {valid: false};\n            }\n            return {lat, lng, zoom, valid: true};\n        },\n\n        unserializeState: function(values) {\n            let {lat, lng, zoom, valid} = this.validateState(values);\n            if (valid) {\n                this.setView([lat, lng], zoom);\n                return true;\n            }\n            return false;\n        }\n    }\n);\n\n","import L from 'leaflet';\nimport './leaflet.hashState';\n\nL.Control.Layers.include(L.Mixin.HashState);\n\nL.Control.Layers.include({\n        stateChangeEvents: ['baselayerchange', 'overlayadd', 'overlayremove'],\n        stateChangeEventsSource: '_map',\n\n        serializeState: function() {\n            const keys = [];\n            this._map.eachLayer((layer) => {\n                    let key = layer.options.code;\n                    if (key) {\n                        keys.push([key, layer.options.zIndex]);\n                    }\n                }\n            );\n            keys.sort((k1, k2) => k1[1] - k2[1]);\n            const state = keys.map((k) => k[0]);\n            return state;\n        },\n\n        unserializeState: function(values) {\n            if (!values || values.length === 0) {\n                return false;\n            }\n\n            let hasBaselayer;\n            for (let layer of this._layers) {\n                if (layer.layer.options && values.includes(layer.layer.options.code) && !layer.overlay) {\n                    hasBaselayer = true;\n                    break;\n                }\n            }\n\n            if (!hasBaselayer) {\n                return false;\n            }\n\n            for (let layer of this._layers) {\n                if (layer.layer.options && values.includes(layer.layer.options.code)) {\n                    this._map.addLayer(layer.layer);\n                } else {\n                    this._map.removeLayer(layer.layer);\n                }\n            }\n            return true;\n        }\n    }\n);\n\n","import L from 'leaflet';\nimport './style.css';\nimport {fixVectorMarkerWorldJump} from './fixWorldCopyJump';\n\n// https://github.com/Leaflet/Leaflet/issues/3575\nfunction fixPanAnimationBug() {\n    if (!L.Browser.chrome) {\n        return;\n    }\n    if (L.PosAnimation.prototype.__panAnimationFixed) {\n        return;\n    }\n\n    const originalStep = L.PosAnimation.prototype._step;\n    L.PosAnimation.prototype._step = function() {\n        return originalStep.call(this, true);\n    };\n    L.PosAnimation.prototype.__panAnimationFixed = true;\n}\n\nfunction fixTouchDetection() {\n    L.Browser.touch &= ((navigator.pointerEnabled && !L.Browser.ie) || navigator.maxTouchPoints);\n}\n\nfunction fixMapKeypressEvent() {\n    const originalHandleDOMEvent = L.Map.prototype._handleDOMEvent;\n    L.Map.prototype._handleDOMEvent = function(e) {\n        if (e.type === 'keypress' && e.keyCode === 13) {\n            this._fireDOMEvent(e, e.type);\n        } else {\n            originalHandleDOMEvent.call(this, e);\n        }\n    };\n}\n\nfunction fixVectorDrawWhileAnimation() {\n    if (L.Renderer.__animationFixed) {\n        return;\n    }\n\n    const resetInterval = 300;\n\n    const originalGetEvents = L.Renderer.prototype.getEvents;\n\n    function onZoom() {\n        const now = Date.now();\n        if (!this._lastReset || (now - this._lastReset > resetInterval)) {\n            this._reset();\n            this._lastReset = now;\n        } else {\n            L.Renderer.prototype._onZoom.call(this);\n        }\n    }\n\n    function onMove() {\n        const now = Date.now();\n        if (!this._lastReset || (now - this._lastReset > resetInterval)) {\n            this._reset();\n            this._lastReset = now;\n        }\n    }\n\n    function getEvents() {\n        const result = originalGetEvents.call(this);\n        result.move = onMove;\n        result.zoom = onZoom;\n        return result;\n    }\n\n    L.Renderer.prototype.getEvents = getEvents;\n    L.Renderer.__animationFixed = true;\n}\n\nfunction allowControlHorizontalStacking() {\n    const original_addTo = L.Control.prototype.addTo;\n    L.Control.prototype.addTo = function(map) {\n        const result = original_addTo.call(this, map);\n        if (this.options.stackHorizontally) {\n            L.DomUtil.addClass(this._container, 'leaflet-control-horizontal-stack');\n        }\n        return result;\n    };\n}\n\nfunction addTooltipDelay() {\n    const origOpenTooltip = L.Layer.prototype._openTooltip;\n    L.Layer.prototype._openTooltip = function(e) {\n        if (this._tooltip.options.delay) {\n            const that = this;\n            this._pendingTooltip = setTimeout(() => origOpenTooltip.call(that, e), this._tooltip.options.delay);\n        } else {\n            origOpenTooltip.call(this, e);\n        }\n    };\n\n    const origCloseTooltip = L.Layer.prototype.closeTooltip;\n    L.Layer.prototype.closeTooltip = function() {\n        clearInterval(this._pendingTooltip);\n        origCloseTooltip.call(this);\n    };\n}\n\nfunction fixAll() {\n    fixPanAnimationBug();\n    fixTouchDetection();\n    fixMapKeypressEvent();\n    fixVectorDrawWhileAnimation();\n    fixVectorMarkerWorldJump();\n    allowControlHorizontalStacking();\n    addTooltipDelay();\n}\n\nexport {fixAll};\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport ko from 'knockout';\nimport googleProvider from './lib/google';\nimport '~/lib/leaflet.hashState/leaflet.hashState';\n\nimport './style.css';\nimport '~/lib/controls-styles/controls-styles.css';\nimport {makeButtonWithBar} from '~/lib/leaflet.control.commons';\nimport mapillaryProvider from './lib/mapillary';\nimport wikimediaProvider from './lib/wikimedia';\nimport {DragEvents} from '~/lib/leaflet.events.drag';\nimport {onElementResize} from '~/lib/anyElementResizeEvent';\nimport safeLocalStorage from '~/lib/safe-localstorage';\nimport mapyczProvider from './lib/mapycz';\n\nconst PanoMarker = L.Marker.extend({\n    options: {\n        zIndexOffset: 10000\n    },\n\n    initialize: function() {\n        const icon = L.divIcon({\n                className: 'leaflet-panorama-marker-wraper',\n                html: '<div class=\"leaflet-panorama-marker\"></div>'\n            }\n        );\n        L.Marker.prototype.initialize.call(this, [0, 0], {icon, interactive: false});\n    },\n\n    getIcon: function() {\n        let markerIcon = this.getElement();\n        markerIcon = markerIcon.children[0];\n        return markerIcon;\n    },\n\n    setHeading: function(angle) {\n        const markerIcon = this.getIcon();\n        markerIcon.style.transform = `rotate(${angle || 0}deg)`;\n    },\n\n    setType: function(markerType) {\n        const className = {\n            slim: 'leaflet-panorama-marker-circle',\n            normal: 'leaflet-panorama-marker-binocular'\n        }[markerType];\n        this.getIcon().className = className;\n    }\n});\n\nL.Control.Panoramas = L.Control.extend({\n        includes: L.Evented,\n\n        options: {\n            position: 'topleft',\n            splitVerically: true,\n            splitSizeFraction: 0.5,\n            minViewerSize: 30,\n        },\n\n        getProviders: function() {\n            return [\n                {\n                    name: 'google',\n                    title: 'Google street view',\n                    provider: googleProvider,\n                    layerOptions: {zIndex: 10},\n                    code: 'g',\n                    selected: ko.observable(true),\n                    mapMarkerType: 'normal'\n                },\n                {\n                    name: 'wikimedia',\n                    title: 'Wikimedia commons',\n                    provider: wikimediaProvider,\n                    layerOptions: {opacity: 0.7, zIndex: 9},\n                    code: 'w',\n                    selected: ko.observable(false),\n                    mapMarkerType: 'slim'\n                },\n                {\n                    name: 'mapillary',\n                    title: 'Mapillary',\n                    provider: mapillaryProvider,\n                    layerOptions: {opacity: 0.7, zIndex: 8},\n                    code: 'm',\n                    selected: ko.observable(false),\n                    mapMarkerType: 'normal'\n                },\n                {\n                    name: 'mapycz',\n                    title: 'mapy.cz',\n                    provider: mapyczProvider,\n                    layerOptions: {opacity: 0.7, zIndex: 8},\n                    code: 'c',\n                    selected: ko.observable(false),\n                    mapMarkerType: 'normal'\n                }\n            ];\n        },\n\n        initialize: function(options) {\n            L.Control.prototype.initialize.call(this, options);\n            this.loadSettings();\n            this._panoramasContainer = L.DomUtil.create('div', 'panoramas-container');\n            onElementResize(\n                this._panoramasContainer,\n                L.Util.requestAnimFrame.bind(null, this.onContainerResize.bind(this))\n            );\n            this.providers = this.getProviders();\n            for (let provider of this.providers) {\n                provider.selected.subscribe(this.updateCoverageVisibility, this);\n                provider.container = L.DomUtil.create('div', 'panorama-container', this._panoramasContainer);\n            }\n            this.nearbyPoints = [];\n        },\n\n        loadSettings: function() {\n            let storedSettings;\n            try {\n                storedSettings = JSON.parse(safeLocalStorage.panoramaSettings);\n            } catch {\n                // ignore\n            }\n            this._splitVerically = storedSettings?.spitVertically ?? this.options.splitVerically;\n            const fraction = storedSettings?.splitSizeFraction;\n            this._splitSizeFraction = isNaN(fraction) ? this.options.splitSizeFraction : fraction;\n        },\n\n        saveSetting: function() {\n            safeLocalStorage.panoramaSettings = JSON.stringify({\n                spitVertically: this._splitVerically,\n                splitSizeFraction: this._splitSizeFraction\n            });\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n\n            this._splitterDragging = false;\n            const splitter = L.DomUtil.create('div', 'panorama-splitter', this._panoramasContainer);\n            L.DomUtil.create('div', 'splitter-border', splitter);\n            const splitterButton = L.DomUtil.create('div', 'button', splitter);\n            new DragEvents(splitter, null, {trackOutsideElement: true}).on({\n                dragstart: this.onSplitterDragStart,\n                dragend: this.onSplitterDragEnd,\n                drag: this.onSplitterDrag,\n            }, this);\n            new DragEvents(splitterButton, null, {trackOutsideElement: true}).on({\n                click: this.onSplitterClick\n            }, this);\n            this.setupViewerLayout();\n            const {container, link, barContainer} = makeButtonWithBar(\n                'leaflet-contol-panoramas', 'Show panoramas (Alt-P)', 'icon-panoramas');\n            map.on('resize', this.onMapResize, this);\n            this._container = container;\n            L.DomEvent.on(link, 'click', this.onButtonClick, this);\n            L.DomEvent.on(document, 'keyup', this.onKeyUp, this);\n            barContainer.innerHTML = `\n                 <div class=\"panoramas-list\" data-bind=\"foreach: providers\">\n                     <div>\n                         <label>\n                             <input type=\"checkbox\" data-bind=\"checked: selected\"><span data-bind=\"text: title\"></span>\n                         </label>\n                     </div>\n                 </div>\n             `;\n\n            ko.applyBindings(this, container);\n            map.createPane('rasterOverlay').style.zIndex = 300;\n            return container;\n        },\n\n        onSplitterDrag: function(e) {\n            const minSize = this.options.minViewerSize;\n            const container = this._panoramasContainer;\n            const oldSize = container[this._splitVerically ? 'offsetWidth' : 'offsetHeight'];\n            let newSize = oldSize + e.dragMovement[this._splitVerically ? 'x' : 'y'];\n            const mapSize = this._map._container[this._splitVerically ? 'offsetWidth' : 'offsetHeight'];\n            if (newSize < minSize) {\n                newSize = this.options.minViewerSize;\n            }\n            const maxSize = oldSize + mapSize - minSize;\n            if (newSize > maxSize) {\n                newSize = maxSize;\n            }\n            this.setContainerSizePixels(newSize);\n        },\n\n        onSplitterClick: function() {\n            this._splitVerically = !this._splitVerically;\n            this.saveSetting();\n            this.setupViewerLayout();\n        },\n\n        onButtonClick: function() {\n            this.switchControl();\n        },\n\n        switchControl: function() {\n            if (this.controlEnabled) {\n                this.disableControl();\n            } else {\n                this.enableControl();\n            }\n        },\n\n        onKeyUp: function(e) {\n            if (e.keyCode === 'P'.codePointAt(0) && e.altKey) {\n                this.switchControl();\n            }\n        },\n\n        enableControl: function() {\n            if (this.controlEnabled) {\n                return;\n            }\n            this.controlEnabled = true;\n            L.DomUtil.addClass(this._container, 'active');\n            this.updateCoverageVisibility();\n            this._map.on('click', this.onMapClick, this);\n            L.DomUtil.addClass(this._map._container, 'panoramas-control-active');\n            this.notifyChanged();\n        },\n\n        disableControl: function() {\n            if (!this.controlEnabled) {\n                return;\n            }\n            this.controlEnabled = false;\n            L.DomUtil.removeClass(this._container, 'active');\n            this.updateCoverageVisibility();\n            this._map.off('click', this.onMapClick, this);\n            this.hidePanoViewer();\n            L.DomUtil.removeClass(this._map._container, 'panoramas-control-active');\n            this.notifyChanged();\n        },\n\n        updateCoverageVisibility: function() {\n            if (!this._map) {\n                return;\n            }\n            for (let provider of this.providers) {\n                if (this.controlEnabled && provider.selected()) {\n                    if (!provider.coverageLayer) {\n                        const options = L.extend({pane: 'rasterOverlay'}, provider.layerOptions);\n                        provider.coverageLayer = provider.provider.getCoverageLayer(options);\n                    }\n                    provider.coverageLayer.addTo(this._map);\n                } else {\n                    if (provider.coverageLayer) {\n                        this._map.removeLayer(provider.coverageLayer);\n                    }\n                }\n            }\n            this.notifyChanged();\n        },\n\n        showPanoramaContainer: function() {\n            L.DomUtil.addClass(this._panoramasContainer, 'enabled');\n        },\n\n        panoramaVisible: function() {\n            if (L.DomUtil.hasClass(this._panoramasContainer, 'enabled')) {\n                for (let provider of this.providers) {\n                    if (L.DomUtil.hasClass(provider.container, 'enabled')) {\n                        return provider;\n                    }\n                }\n            }\n            return false;\n        },\n\n        setupNearbyPoints: function(points) {\n            for (let point of this.nearbyPoints) {\n                this._map.removeLayer(point);\n            }\n            this.nearbyPoints = [];\n            if (points) {\n                const icon = L.divIcon({className: 'leaflet-panorama-marker-point'});\n                for (let latlng of points) {\n                    this.nearbyPoints.push(L.marker(latlng, {icon}).addTo(this._map));\n                }\n            }\n        },\n\n        hidePano: function(provider) {\n            L.DomUtil.removeClass(provider.container, 'enabled');\n            if (provider.viewer) {\n                provider.viewer.deactivate();\n            }\n            this.setupNearbyPoints();\n        },\n\n        showPano: async function(provider, data) {\n            this.showPanoramaContainer();\n            for (let otherProvider of this.providers) {\n                if (otherProvider !== provider) {\n                    this.hidePano(otherProvider);\n                }\n            }\n            L.DomUtil.addClass(provider.container, 'enabled');\n            if (!provider.viewer) {\n                // eslint-disable-next-line require-atomic-updates\n                provider.viewer = await provider.provider.getViewer(provider.container);\n                this.setupViewerEvents(provider);\n            }\n            if (data) {\n                // wait for panorama container become of right size, needed for viewer setup\n                setTimeout(() => provider.viewer.showPano(data), 0);\n            }\n            provider.viewer.activate();\n            this.notifyChanged();\n        },\n\n        setupViewerEvents: function(provider) {\n            provider.viewer.on({\n                change: this.onPanoramaChangeView.bind(this, provider),\n                closeclick: this.onPanoramaCloseClick\n            }, this);\n        },\n\n        hidePanoViewer: function() {\n            for (let provider of this.providers) {\n                this.hidePano(provider);\n            }\n            L.DomUtil.removeClass(this._panoramasContainer, 'enabled');\n            this.hideMarker();\n            this.notifyChanged();\n        },\n\n        placeMarker: function(latlng, heading) {\n            if (!this.panoramaVisible()) {\n                return;\n            }\n            if (!this.marker) {\n                this.marker = new PanoMarker();\n            }\n            this._map.addLayer(this.marker);\n            this.marker.setLatLng(latlng);\n            this.marker.setHeading(heading);\n        },\n\n        hideMarker: function() {\n            if (this.marker) {\n                this._map.removeLayer(this.marker);\n            }\n        },\n        notifyChanged: function() {\n            this.fire('panoramachanged');\n        },\n\n        onPanoramaChangeView: function(provider, e) {\n            if (!this._map.getBounds().pad(-0.05).contains(e.latlng)) {\n                this._map.panTo(e.latlng);\n            }\n            this.placeMarker(e.latlng, e.heading);\n            this.marker.setType(provider.mapMarkerType);\n            this.setupNearbyPoints(e.latlngs);\n            this.notifyChanged();\n        },\n\n        onPanoramaCloseClick: function() {\n            this.hidePanoViewer();\n        },\n\n        onMapClick: async function(e) {\n            const\n                searchRadiusPx = 24,\n                p = this._map.project(e.latlng).add([searchRadiusPx, 0]),\n                searchRadiusMeters = e.latlng.distanceTo(this._map.unproject(p)),\n                promises = [];\n            for (let provider of this.providers) {\n                if (provider.selected()) {\n                    promises.push({\n                        promise: provider.provider.getPanoramaAtPos(e.latlng, searchRadiusMeters),\n                        provider: provider\n                    });\n                }\n            }\n\n            for (let {promise, provider} of promises) {\n                let searchResult = await promise;\n                if (searchResult.found) {\n                    this.showPano(provider, searchResult.data);\n                    return;\n                }\n            }\n        },\n\n        setupViewerLayout: function() {\n            let sidebar;\n            if (this._splitVerically) {\n                L.DomUtil.addClass(this._panoramasContainer, 'split-vertical');\n                L.DomUtil.removeClass(this._panoramasContainer, 'split-horizontal');\n                sidebar = 'left';\n                this._panoramasContainer.style.height = '100%';\n            } else {\n                L.DomUtil.addClass(this._panoramasContainer, 'split-horizontal');\n                L.DomUtil.removeClass(this._panoramasContainer, 'split-vertical');\n                sidebar = 'top';\n                this._panoramasContainer.style.width = '100%';\n            }\n            this._map.addElementToSidebar(sidebar, this._panoramasContainer);\n            this.updateContainerSize();\n        },\n\n        setContainerSizePixels: function(size) {\n            size = Math.round(size);\n            this._panoramasContainer.style[this._splitVerically ? 'width' : 'height'] = `${size}px`;\n            setTimeout(() => { // map size has not updated yet\n                const mapSize = this._map._container[this._splitVerically ? 'offsetWidth' : 'offsetHeight'];\n                this._splitSizeFraction = size / (mapSize + size);\n                this.saveSetting();\n            }, 0);\n        },\n\n        updateContainerSize: function() {\n            const fraction = this._splitSizeFraction;\n            const container = this._panoramasContainer;\n            const containerSize = container[this._splitVerically ? 'offsetWidth' : 'offsetHeight'];\n            const mapSize = this._map._container[this._splitVerically ? 'offsetWidth' : 'offsetHeight'];\n            const newSize = Math.round(fraction * (mapSize + containerSize));\n            container.style[this._splitVerically ? 'width' : 'height'] = `${newSize}px`;\n        },\n\n        onContainerResize: function() {\n            const provider = this.panoramaVisible();\n            if (provider && provider.viewer) {\n                provider.viewer.invalidateSize();\n            }\n        },\n\n        onMapResize: function() {\n            if (!this._splitterDragging) {\n                this.updateContainerSize();\n            }\n        },\n\n        onSplitterDragStart: function() {\n            this._splitterDragging = true;\n        },\n\n        onSplitterDragEnd: function() {\n            this._splitterDragging = false;\n        },\n    },\n);\n\nL.Control.Panoramas.include(L.Mixin.HashState);\nL.Control.Panoramas.include({\n        stateChangeEvents: ['panoramachanged'],\n\n        serializeState: function() {\n            let state = null;\n            if (this.controlEnabled) {\n                state = [];\n                let coverageCode = '_';\n                for (let provider of this.providers) {\n                    if (provider.selected()) {\n                        coverageCode += provider.code;\n                    }\n                }\n                state.push(coverageCode);\n                const provider = this.panoramaVisible();\n                if (provider && provider.viewer) {\n                    let viewerState = provider.viewer.getState();\n                    if (viewerState) {\n                        state.push(provider.code);\n                        state.push(...viewerState);\n                    }\n                }\n            }\n            return state;\n        },\n\n        unserializeState: function(state) {\n            if (!state) {\n                this.disableControl();\n                return true;\n            }\n\n            const coverageCode = state[0];\n            if (!coverageCode || coverageCode[0] !== '_') {\n                return false;\n            }\n            this.enableControl();\n            for (let provider of this.providers) {\n                provider.selected(coverageCode.includes(provider.code));\n            }\n            if (state.length > 2) {\n                const panoramaVisible = state[1];\n                for (let provider of this.providers) {\n                    if (panoramaVisible === provider.code) {\n                        this.showPano(provider).then(() => {\n                            const success = provider.viewer.setState(state.slice(2));\n                            if (!success) {\n                                this.hidePanoViewer();\n                            }\n                        });\n                        break;\n                    }\n                }\n            }\n            return true;\n        }\n    }\n);\n\nL.Control.Panoramas.hashStateUpgrader = function(panoramasControl) {\n    return L.Util.extend({}, L.Mixin.HashState, {\n        unserializeState: function(oldState) {\n            if (oldState) {\n                const upgradedState = ['_g'];\n                if (oldState.length) {\n                    upgradedState.push('g', ...oldState);\n                }\n                setTimeout(() => panoramasControl.unserializeState(upgradedState), 0);\n            }\n            return false;\n        },\n\n        serializeState: function() {\n            return null;\n        },\n    });\n};\n","import L from 'leaflet';\nimport getGoogle from '~/lib/googleMapsApi';\n\nfunction getCoverageLayer(options) {\n    return L.tileLayer(\n        'https://maps.googleapis.com/maps/vt?pb=!1m5!1m4!1i{z}!2i{x}!3i{y}!4i256!2m8!1e2!2ssvv!4m2!1scb_client!2sapiv3!4m2!1scc!2s*211m3*211e3*212b1*213e2*211m3*211e2*212b1*213e2!3m5!3sUS!12m1!1e40!12m1!1e18!4e0', // eslint-disable-line max-len\n        options\n    );\n}\n\nasync function getStreetViewService() {\n    const google = await getGoogle();\n    return new google.maps.StreetViewService();\n}\n\nasync function getPanoramaAtPos(latlng, searchRadiusMeters) {\n    const google = await getGoogle();\n    const service = await getStreetViewService();\n    const {data, status} = await new Promise((resolve) => {\n            service.getPanorama({\n                    location: latlng,\n                    radius: searchRadiusMeters,\n                    preference: google.maps.StreetViewPreference.NEAREST\n                }, (data, status) => resolve({data, status})\n            );\n        }\n    );\n    if (status === google.maps.StreetViewStatus.OK) {\n        return {found: true, data};\n    }\n    return {found: false};\n}\n\nconst Viewer = L.Evented.extend({\n    initialize: function(google, container) {\n        this.google = google;\n        const panorama = this.panorama = new google.maps.StreetViewPanorama(container, {\n                enableCloseButton: true,\n                imageDateControl: true,\n                motionTracking: false,\n                motionTrackingControl: false,\n            }\n        );\n        panorama.addListener('position_changed', () => this.onPanoramaChangeView());\n        panorama.addListener('pov_changed', () => this.onPanoramaChangeView());\n        panorama.addListener('closeclick', () => this.onCloseClick());\n\n        this.invalidateSize = L.Util.throttle(this._invalidateSize, 50, this);\n    },\n\n    showPano: function(data) {\n        this.panorama.setPosition(data.location.latLng);\n        this.panorama.setZoom(1);\n    },\n\n    onPanoramaChangeView: function() {\n        if (!this._active) {\n            return;\n        }\n        let pos = this.panorama.getPosition();\n        pos = L.latLng(pos.lat(), pos.lng());\n        const pov = this.panorama.getPov();\n        this.fire('change', {latlng: pos, heading: pov.heading, zoom: pov.zoom, pitch: pov.pitch});\n    },\n\n    onCloseClick: function() {\n        this.fire('closeclick');\n    },\n\n    activate: function() {\n        this._active = true;\n        this.panorama.setVisible(true);\n    },\n\n    deactivate: function() {\n        this._active = false;\n        this.panorama.setVisible(false);\n    },\n\n    getState: function() {\n        const pos = this.panorama.getPosition();\n        const pov = this.panorama.getPov();\n        if (pos && pov) {\n            return [\n                pos.lat().toFixed(6),\n                pos.lng().toFixed(6),\n                (pov.heading || 0).toFixed(1),\n                (pov.pitch || 0).toFixed(1),\n                (pov.zoom || 1).toFixed(1)\n            ];\n        }\n        return null;\n    },\n\n    setState: function(state) {\n        const lat = parseFloat(state[0]);\n        const lng = parseFloat(state[1]);\n        const heading = parseFloat(state[2]);\n        const pitch = parseFloat(state[3]);\n        const zoom = parseFloat(state[4]);\n        if (!isNaN(lat) && !isNaN(lng) && !isNaN(heading) && !isNaN(pitch) && !isNaN(zoom)) {\n            this.panorama.setPosition({lat, lng});\n            this.panorama.setPov({heading, pitch, zoom});\n            return true;\n        }\n        return false;\n    },\n\n    _invalidateSize: function() {\n        this.google.maps.event.trigger(this.panorama, 'resize');\n    }\n});\n\nasync function getViewer(container) {\n    const google = await getGoogle();\n    return new Viewer(google, container);\n}\n\nconst googleProvider = {getCoverageLayer, getPanoramaAtPos, getViewer};\nexport default googleProvider;\n","import loadScript from 'load-script';\nimport config from '~/config';\n\nlet _google = null;\nlet _pending = null;\n\nfunction getGoogle() {\n    if (_google) {\n        return Promise.resolve(_google);\n    }\n    if (!_pending) {\n        _pending = new Promise((resolve, reject) => {\n                loadScript(config.googleApiUrl, (error) => {\n                        if (error) {\n                            reject(error);\n                        } else {\n                            _google = window.google;\n                            resolve(_google);\n                        }\n                    }\n                );\n            }\n        );\n    }\n    return _pending;\n}\n\nexport default getGoogle;\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {MapillaryCoverage} from './mapillary-coverage-layer';\nimport {fetch} from '~/lib/xhr-promise';\nimport config from '~/config';\nimport './style.css';\nimport {CloseButtonMixin, DateLabelMixin} from '../common';\n\nfunction getCoverageLayer(options) {\n    return new MapillaryCoverage(options);\n}\n\nfunction getMapillary() {\n    return new Promise((resolve) => {\n        require.ensure(['mapillary-js/dist/mapillary.min.js', 'mapillary-js/dist/mapillary.min.css'], () => {\n            require('mapillary-js/dist/mapillary.min.css');\n            resolve(require('mapillary-js/dist/mapillary.min.js'));\n        }, 'mapillary');\n    });\n}\n\nasync function getPanoramaAtPos(latlng, searchRadiusMeters) {\n    const url = `https://a.mapillary.com/v3/images?` +\n        `client_id=${config.mapillary}&closeto=${latlng.lng},${latlng.lat}&radius=${searchRadiusMeters}`;\n    const resp = await fetch(url, {responseType: 'json', timeout: 10000});\n    if (resp.status === 200 && resp.responseJSON.features.length) {\n        return {found: true, data: resp.responseJSON.features[0].properties.key};\n    }\n    return {found: false};\n}\n\nconst Viewer = L.Evented.extend({\n        includes: [CloseButtonMixin, DateLabelMixin],\n\n        initialize: function(mapillary, container) {\n            const id = `container-${L.stamp(container)}`;\n            container.id = id;\n            const viewer = this.viewer = new mapillary.Viewer(\n                id, config.mapillary, null, {component: {cover: false, bearing: false}});\n            window.addEventListener('resize', function() {\n                    viewer.resize();\n                }\n            );\n            viewer.on('nodechanged', this.onNodeChanged.bind(this));\n            viewer.on('bearingchanged', this.onBearingChanged.bind(this));\n            this.createDateLabel(container);\n            this.createCloseButton(container);\n            this._bearing = 0;\n            this._zoom = 0;\n            this._center = [0, 0];\n            this.invalidateSize = L.Util.throttle(this._invalidateSize, 100, this);\n        },\n\n        showPano: function(data) {\n            this.deactivate();\n            this.activate();\n            this.viewer.moveToKey(data).then(() => {\n                this.viewer.setZoom(0);\n                this.updateZoomAndCenter();\n            });\n        },\n\n        onNodeChanged: function(node) {\n            if (this._node && (node.key === this._node.key)) {\n                return;\n            }\n            this._node = node;\n            this.fireChangeEvent();\n            this.updateDateLabel(node.capturedAt);\n        },\n\n        getBearingCorrection: function() {\n            if (this._node && 'computedCA' in this._node) {\n                return (this._node.computedCA - this._node.originalCA);\n            }\n            return 0;\n        },\n\n        onBearingChanged: function(bearing) {\n            bearing -= this.getBearingCorrection();\n            if (this._bearing === bearing) {\n                return;\n            }\n            this._bearing = bearing;\n            this.fireChangeEvent();\n        },\n\n        fireChangeEvent: function() {\n            if (this._node) {\n                const latlon = this._node.originalLatLon;\n                this.fire('change', {\n                        latlng: L.latLng(latlon.lat, latlon.lon),\n                        heading: this._bearing,\n                        pitch: this._pitch,\n                        zoom: this._zoom\n                    }\n                );\n            }\n        },\n\n        deactivate: function() {\n            this.viewer.activateCover();\n            if (this._updateHandler) {\n                clearInterval(this._updateHandler);\n                this._updateHandler = null;\n            }\n        },\n\n        updateZoomAndCenter: function() {\n            this.viewer.getZoom().then((zoom) => {\n                this._zoom = zoom;\n            });\n            this.viewer.getCenter().then((center) => {\n                this._center = center;\n            });\n            this.viewer.getBearing().then((bearing) => {\n                this.onBearingChanged(bearing);\n            });\n        },\n\n        activate: function() {\n            this.viewer.resize();\n            this.viewer.deactivateCover();\n            if (!this._updateHandler) {\n                this._updateHandler = setInterval(() => this.updateZoomAndCenter(), 200);\n            }\n        },\n\n        getState: function() {\n            if (!this._node) {\n                return [];\n            }\n            const {lat, lon} = this._node.originalLatLon;\n            return [\n                lat.toFixed(6),\n                lon.toFixed(6),\n                this._center[0].toFixed(4),\n                this._center[1].toFixed(4),\n                this._zoom.toFixed(2)\n            ];\n        },\n\n        setState: function(state) {\n            const lat = parseFloat(state[0]);\n            const lng = parseFloat(state[1]);\n            const center0 = parseFloat(state[2]);\n            const center1 = parseFloat(state[3]);\n            const zoom = parseFloat(state[4]);\n            if (!isNaN(lat) && !isNaN(lng) && !isNaN(center0) && !isNaN(center1) && !isNaN(zoom)) {\n                this.viewer.moveCloseTo(lat, lng).then(() => {\n                    this.viewer.setCenter([center0, center1]);\n                    this.viewer.setZoom(zoom);\n                });\n                return true;\n            }\n            return false;\n        },\n\n        _invalidateSize: function() {\n            this.viewer.resize();\n        }\n    }\n);\n\nasync function getViewer(container) {\n    const mapillary = await getMapillary();\n    return new Viewer(mapillary, container);\n}\n\nconst mapillaryProvider = {getCoverageLayer, getPanoramaAtPos, getViewer};\nexport default mapillaryProvider;\n","import L from 'leaflet';\nimport {MapillaryLoader} from './mapillary-loader';\n\nconst MapillaryCoverage = L.GridLayer.extend({\n        options: {\n            tileSize: 1024,\n            updateWhenIdle: true,\n            color: '#00cfb1'\n        },\n\n        initialize: function(options) {\n            L.GridLayer.prototype.initialize.call(this, options);\n            this.loader = new MapillaryLoader(this.options.url, 12);\n        },\n\n        onAdd: function(map) {\n            L.GridLayer.prototype.onAdd.call(this, map);\n            this.on('tileunload', this.onTileUnload, this);\n        },\n\n        onRemove: function(map) {\n            L.GridLayer.prototype.onRemove.call(this, map);\n            this.off('tileunload', this.onTileUnload, this);\n        },\n\n        onTileUnload: function(e) {\n            const tile = e.tile;\n            tile._abortLoading();\n            delete tile._tileData;\n            delete tile._adjustment;\n        },\n\n        drawOverview: function(canvas) {\n            const\n                tileData = canvas._tileData;\n            if (!tileData['mapillary-sequence-overview']) {\n                return;\n            }\n            let {multiplier, offsetX, offsetY} = canvas._adjustment;\n            const canvasCtx = canvas.getContext('2d');\n            canvasCtx.fillStyle = this.options.color;\n            for (let feature of tileData['mapillary-sequence-overview']) {\n                if (feature.geometry.type !== 'Point') {\n                    throw new Error(`Invalid sequence overview geometry type \"${feature.geometry.type}\"`);\n                }\n                canvasCtx.beginPath();\n                let x = feature.geometry.coordinates[0] * multiplier - offsetX;\n                let y = feature.geometry.coordinates[1] * multiplier - offsetY;\n                canvasCtx.arc(x, y, 5, 0, 2 * Math.PI);\n                canvasCtx.fill();\n            }\n        },\n\n        drawSequences: function(canvas, lineWidth) {\n            let\n                tileData = canvas._tileData,\n                adjustment = canvas._adjustment;\n\n            if (!tileData['mapillary-sequences']) {\n                return;\n            }\n            const canvasCtx = canvas.getContext('2d');\n            canvasCtx.beginPath();\n            canvasCtx.strokeStyle = this.options.color;\n            canvasCtx.lineWidth = lineWidth;\n            // canvasCtx.lineWidth = thinLines ? 1 : 1;\n            canvasCtx.lineCap = \"round\";\n            canvasCtx.lineJoin = \"bevel\";\n            for (let feature of tileData['mapillary-sequences']) {\n                if (feature.geometry.type !== 'MultiLineString') {\n                    throw new Error(`Invalid sequence geometry type \"${feature.geometry.type}\"`);\n                }\n                let {multiplier, offsetX, offsetY} = adjustment;\n\n                let lines = feature.geometry.coordinates;\n                for (let lineI = 0; lineI < lines.length; lineI++) {\n                    let line = lines[lineI];\n                    if (!line.length) {\n                        continue;\n                    }\n                    let x = line[0][0] * multiplier - offsetX;\n                    let y = line[0][1] * multiplier - offsetY;\n                    canvasCtx.moveTo(x, y);\n                    if (line.length === 1) {\n                        canvasCtx.lineTo(x, y);\n                    }\n                    for (let pointI = 0; pointI < line.length; pointI++) {\n                        let x = line[pointI][0] * multiplier - offsetX;\n                        let y = line[pointI][1] * multiplier - offsetY;\n                        canvasCtx.lineTo(x, y);\n                    }\n                }\n            }\n            canvasCtx.stroke();\n        },\n\n        drawImages: function(canvas) {\n            let\n                tileData = canvas._tileData,\n                adjustment = canvas._adjustment;\n            if (!tileData['mapillary-images']) {\n                return;\n            }\n            let {multiplier, offsetX, offsetY} = adjustment;\n            const canvasCtx = canvas.getContext('2d');\n            canvasCtx.beginPath();\n            canvasCtx.fillStyle = this.options.color;\n            for (let feature of tileData['mapillary-images']) {\n                if (feature.geometry.type !== 'Point') {\n                    throw new Error(`Invalid image geometry type \"${feature.geometry.type}\"`);\n                }\n                canvasCtx.beginPath();\n                let x = feature.geometry.coordinates[0] * multiplier - offsetX;\n                let y = feature.geometry.coordinates[1] * multiplier - offsetY;\n                canvasCtx.arc(x, y, 4, 0, 2 * Math.PI);\n                canvasCtx.fill();\n            }\n        },\n\n        drawTile: function(canvas, coords) {\n            if (!this._map) {\n                return;\n            }\n            if (!canvas._tileData) {\n                return;\n            }\n            if (coords.z < 6 + 2) {\n                this.drawOverview(canvas);\n            } else if (coords.z < 14 + 2) {\n                let width = coords.z < 14 ? 10 : 5;\n                this.drawSequences(canvas, width);\n            } else {\n                this.drawSequences(canvas, 2);\n                this.drawImages(canvas);\n            }\n        },\n\n        createTile: function(coords, done) {\n            const canvas = L.DomUtil.create('canvas', 'leaflet-tile');\n            canvas.width = this.options.tileSize;\n            canvas.height = this.options.tileSize;\n            let {dataPromise, abortLoading} = this.loader.requestTileData(coords);\n            dataPromise.then((data) => {\n                if (!data.error) {\n                    canvas._tileData = data.tileData;\n                    canvas._adjustment = data.adjustment || {multiplier: 1, offsetX: 0, offsetY: 0};\n                    setTimeout(() => {\n                        this.drawTile(canvas, coords);\n                        done(null, canvas);\n                    }, 1);\n                }\n            });\n            canvas._abortLoading = abortLoading;\n            return canvas;\n        },\n\n    }\n);\n\nexport {MapillaryCoverage};\n","import L from 'leaflet';\nimport {TiledDataLoader} from '~/lib/tiled-data-loader';\nimport {decodeMvt} from './mvt';\n\nclass MapillaryLoader extends TiledDataLoader {\n    url = 'https://d25uarhxywzl1j.cloudfront.net/v0.1/{z}/{x}/{y}.mvt';\n    maxZoom = 14;\n\n    getTileUrl(coords) {\n        const data = {\n            x: coords.x,\n            z: coords.z,\n            y: coords.y\n        };\n        return L.Util.template(this.url, data);\n    }\n\n    layerTileToDataTileCoords(layerTileCoords) {\n        let z = layerTileCoords.z - 2;\n        let z2 = null;\n        if (z > 6 && z <= 10) {\n            z2 = 6;\n        } else if (z >= 11 && z < 14) {\n            z2 = z - 4;\n        } else if (z < 0) {\n            z2 = 0;\n        } else if (z > this.maxZoom) {\n            z2 = this.maxZoom;\n        } else {\n            return {z, x: layerTileCoords.x, y: layerTileCoords.y};\n        }\n\n        let multiplier = 1 << (z - z2);\n        return {\n            x: Math.floor(layerTileCoords.x / multiplier),\n            y: Math.floor(layerTileCoords.y / multiplier),\n            z: z2\n        };\n    }\n\n    makeRequestData(dataTileCoords) {\n        return {\n            url: this.getTileUrl(dataTileCoords),\n            options: {\n                responseType: 'arraybuffer',\n                timeout: 10000,\n                isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403\n            }\n        };\n    }\n\n    calcAdjustment(layerTileCoords, dataTileCoords) {\n        let adjustment = super.calcAdjustment(\n            {x: layerTileCoords.x, y: layerTileCoords.y, z: layerTileCoords.z - 2},\n            dataTileCoords\n        );\n        if (adjustment) {\n            adjustment.offsetX *= 1024;\n            adjustment.offsetY *= 1024;\n        }\n        return adjustment;\n    }\n\n    async processResponse(xhr, originalDataTileCoords) {\n        return this._processResponse(xhr, originalDataTileCoords);\n    }\n\n    async _processResponse(xhr, originalDataTileCoords) {\n        let tileData;\n        if (xhr.status === 200 && xhr.response) {\n            const layers = decodeMvt(xhr.response, 1024);\n            tileData = {};\n            for (let layer of layers) {\n                tileData[layer.name] = layer.features;\n            }\n        } else {\n            tileData = null;\n        }\n\n        return {\n            tileData,\n            coords: originalDataTileCoords\n        };\n    }\n}\n\nexport {MapillaryLoader};\n","class Cache {\n    constructor(maxSize) {\n        this._maxSize = maxSize;\n        this._store = {};\n        this._size = 0;\n    }\n\n    get(key) {\n        if (key in this._store) {\n            const value = this._store[key];\n            delete this._store[key];\n            this._store[key] = value;\n            return {value, found: true};\n        }\n        return {found: false};\n    }\n\n    put(key, value) {\n        if (key in this._store) {\n            delete this._store[key];\n        } else {\n            this._size += 1;\n        }\n        this._store[key] = value;\n        if (this._size > this._maxSize) {\n            delete this._store[Object.keys(this._store)[0]];\n            this._size -= 1;\n        }\n    }\n}\n\nexport {Cache};\n","import Pbf from 'pbf';\nimport {Tile as TileProto} from './vector_tile_pb';\n\nfunction decodeCoordinate(x) {\n    return ((x >> 1) ^ (-(x & 1)));\n}\n\nfunction parseGeometry(geometryType, ints, coordinatesScale) { // eslint-disable-line complexity\n    if (geometryType !== TileProto.GeomType.POINT && geometryType !== TileProto.GeomType.LINESTRING &&\n        geometryType !== TileProto.GeomType.POLYGON) {\n        throw new Error(`Unknown feature geometry type ${geometryType}`);\n    }\n    const len = ints.length;\n    let pos = 0;\n    const lineStrings = [];\n    let line;\n    let x = 0,\n        y = 0;\n    while (pos < len) {\n        let i = ints[pos];\n        let cmd = i & 0x7;\n        let cmdRepeat = i >> 3;\n        switch (cmd) {\n            case 1: // MoveTo\n                if (cmdRepeat !== 1) {\n                    throw new Error(`repeat=${cmdRepeat} for command MoveTo`);\n                }\n                if (pos + 2 > len) {\n                    throw new Error('Not enough elements for MoveTo arguments');\n                }\n                if (line) {\n                    lineStrings.push(line);\n                }\n                x += decodeCoordinate(ints[pos + 1]);\n                y += decodeCoordinate(ints[pos + 2]);\n                line = [[x * coordinatesScale, y * coordinatesScale]];\n                pos += 3;\n                break;\n            case 2: // LineTo\n                if (cmdRepeat < 1) {\n                    throw new Error(`repeat=${cmdRepeat} for command LineTo`);\n                }\n                if (!line) {\n                    throw new Error('LineTo with empty linestring');\n                }\n                pos += 1;\n                for (let cmdN = 0; cmdN < cmdRepeat; cmdN++) {\n                    if (pos + 2 > len) {\n                        throw new Error('Not enough elements for LineTo arguments');\n                    }\n                    x += decodeCoordinate(ints[pos]);\n                    y += decodeCoordinate(ints[pos + 1]);\n                    line.push([x * coordinatesScale, y * coordinatesScale]);\n                    pos += 2;\n                }\n                break;\n            case 7: // ClosePath\n                if (geometryType !== TileProto.GeomType.POLYGON) {\n                    throw new Error(`ClosePath command for non-polygon type ${geometryType}`);\n                }\n                if (!line) {\n                    throw new Error('ClosePath with empty linestring');\n                }\n                if (cmdRepeat !== 1) {\n                    throw new Error(`ClosePath repeats ${cmdRepeat} times`);\n                }\n                line.push(line[0]);\n                pos += 1;\n                break;\n            default:\n                throw new Error(`Unknown command ${i} & 0x7 = ${cmd}`);\n        }\n    }\n    if (line) {\n        lineStrings.push(line);\n    }\n    const geometry = {};\n    switch (geometryType) {\n        case TileProto.GeomType.POINT:\n            if (lineStrings.length !== 1 || lineStrings[0].length !== 1) {\n                throw new Error('Invalid coordinates number for point');\n            }\n            geometry.type = 'Point';\n            geometry.coordinates = lineStrings[0][0];\n            break;\n        case TileProto.GeomType.LINESTRING:\n            geometry.type = 'MultiLineString';\n            geometry.coordinates = lineStrings;\n            break;\n        case TileProto.GeomType.POLYGON:\n            geometry.type = 'Polygon';\n            geometry.coordinates = lineStrings;\n            break;\n        default:\n    }\n    return geometry;\n}\n\nfunction parseFeatures(layer, coordinatesScale) {\n    const features = [];\n    for (let feature of layer.features) {\n        const geometry = parseGeometry(feature.type, feature.geometry, coordinatesScale);\n        features.push({geometry});\n    }\n    return features;\n}\n\nfunction decodeMvt(ar, tileExtent = 256) {\n    const\n        pbf = new Pbf(new Uint8Array(ar)),\n        tileData = TileProto.read(pbf);\n    const parsedLayers = [];\n    for (let layer of tileData.layers) {\n        let scale = tileExtent / layer.extent;\n        parsedLayers.push({\n            name: layer.name,\n            features: parseFeatures(layer, scale)\n        });\n    }\n    return parsedLayers;\n}\n\nexport {decodeMvt};\n","// code generated by pbf v3.0.5\n\n// Tile ========================================\n\nvar Tile = exports.Tile = {};\n\nTile.read = function (pbf, end) {\n    return pbf.readFields(Tile._readField, {layers: []}, end);\n};\nTile._readField = function (tag, obj, pbf) {\n    if (tag === 3) obj.layers.push(Tile.Layer.read(pbf, pbf.readVarint() + pbf.pos));\n};\n\nTile.GeomType = {\n    \"UNKNOWN\": 0,\n    \"POINT\": 1,\n    \"LINESTRING\": 2,\n    \"POLYGON\": 3\n};\n\n\n// Tile.Feature ========================================\n\nTile.Feature = {};\n\nTile.Feature.read = function (pbf, end) {\n    return pbf.readFields(Tile.Feature._readField, {id: 0, tags: [], type: 0, geometry: []}, end);\n};\nTile.Feature._readField = function (tag, obj, pbf) {\n    if (tag === 3) obj.type = pbf.readVarint();\n    else if (tag === 4) pbf.readPackedVarint(obj.geometry);\n};\n\n// Tile.Layer ========================================\n\nTile.Layer = {};\n\nTile.Layer.read = function (pbf, end) {\n    return pbf.readFields(Tile.Layer._readField, {version: 0, name: \"\", features: [], keys: [], values: [], extent: 0}, end);\n};\nTile.Layer._readField = function (tag, obj, pbf) {\n    if (tag === 15) obj.version = pbf.readVarint();\n    else if (tag === 1) obj.name = pbf.readString();\n    else if (tag === 2) obj.features.push(Tile.Feature.read(pbf, pbf.readVarint() + pbf.pos));\n    else if (tag === 5) obj.extent = pbf.readVarint();\n};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {MultiLayer, WikimediaVectorCoverage} from './coverage-layer';\nimport {fetch} from '~/lib/xhr-promise';\nimport './style.css';\nimport '../common/style.css';\nimport config from '~/config';\n\nfunction getCoverageLayer(options) {\n    const url = config.wikimediaCommonsCoverageUrl;\n    return new MultiLayer([\n        {layer: L.tileLayer(url, L.extend({}, options, {tms: true})), minZoom: 0, maxZoom: 10},\n        {layer: new WikimediaVectorCoverage(url, options), minZoom: 11, maxZoom: 18}\n    ]);\n}\n\nfunction parseSearchResponse(resp) { // eslint-disable-line complexity\n    const images = [];\n    if (resp && resp.query && resp.query.pages && resp.query.pages) {\n        for (let page of Object.values(resp.query.pages)) {\n            if (!page.coordinates || page.title.slice(-4).toLowerCase() !== '.jpg') {\n                continue;\n            }\n\n            const iinfo = page.imageinfo[0];\n            let imageDescription = iinfo.extmetadata.ImageDescription ? iinfo.extmetadata.ImageDescription.value : null;\n            let objectDescription = iinfo.extmetadata.ObjectName ? iinfo.extmetadata.ObjectName.value : null;\n            if (imageDescription && /^<table (.|\\n)+<\\/table>$/u.test(imageDescription)) {\n                imageDescription = null;\n            }\n            if (imageDescription) {\n                imageDescription = imageDescription.replace(/<[^>]+>/ug, '');\n                imageDescription = imageDescription.replace(/[\\n\\r]/ug, '');\n            }\n            if (\n                imageDescription &&\n                objectDescription &&\n                objectDescription.toLowerCase().includes(imageDescription.toLowerCase())\n            ) {\n                imageDescription = null;\n            }\n            if (\n                objectDescription &&\n                imageDescription &&\n                imageDescription.toLowerCase().includes(objectDescription.toLowerCase())\n            ) {\n                objectDescription = null;\n            }\n            let description = 'Wikimedia commons';\n            if (objectDescription || imageDescription) {\n                description = '';\n                if (objectDescription) {\n                    description = objectDescription;\n                }\n                if (imageDescription) {\n                    // eslint-disable-next-line max-depth\n                    if (objectDescription) {\n                        description += '</br>';\n                    }\n                    description += imageDescription;\n                }\n            }\n\n            let author = iinfo.extmetadata.Artist ? iinfo.extmetadata.Artist.value : null;\n            if (author && /^<table (.|\\n)+<\\/table>$/u.test(author)) {\n                author = `See author info at <a href=\"${iinfo.descriptionurl}\">Wikimedia commons</a>`;\n            }\n\n            // original images can be rotated, 90 degrees\n            // thumbnails are always oriented right\n            // so we request thumbnail of original image size\n            let url = iinfo.thumburl.replace('134px', `${iinfo.width}px`);\n            images.push({\n                url,\n                width: iinfo.width,\n                height: iinfo.height,\n                lat: page.coordinates[0].lat,\n                lng: page.coordinates[0].lon,\n                author: author,\n                timeOriginal: iinfo.extmetadata.DateTimeOriginal ? iinfo.extmetadata.DateTimeOriginal.value : null,\n                time: iinfo.extmetadata.DateTime ? iinfo.extmetadata.DateTime.value : null,\n                description: description,\n                pageUrl: iinfo.descriptionurl,\n                pageId: page.pageid.toString()\n            });\n        }\n        if (images.length) {\n            return images;\n        }\n    }\n    return null;\n}\n\nfunction isCloser(target, a, b) {\n    const d1 = target.distanceTo(a);\n    const d2 = target.distanceTo(b);\n    if (d1 < d2) {\n        return -1;\n    } else if (d1 === d2) {\n        return 0;\n    }\n    return 1;\n}\n\nasync function getPanoramaAtPos(latlng, searchRadiusMeters) {\n    latlng = L.latLng(latlng.lat, latlng.lng); // make independent copy\n\n    const clusterSize = 10;\n    const urlTemplate = 'https://commons.wikimedia.org/w/api.php?' +\n                        'origin=*&format=json&action=query&generator=geosearch&' +\n                        'ggsprimary=all&ggsnamespace=6&ggslimit=10&iilimit=1&coprimary=all&' +\n                        'ggsradius={radius}&ggscoord={lat}|{lng}&' +\n                        'iiurlwidth=134&' +\n                        'prop=imageinfo|coordinates&' +\n                        'iiprop=url|mime|size|extmetadata|commonmetadata|metadata';\n    searchRadiusMeters += clusterSize;\n    if (searchRadiusMeters < 10) {\n        searchRadiusMeters = 10;\n    }\n    if (searchRadiusMeters > 10000) {\n        searchRadiusMeters = 10000;\n    }\n    const url = L.Util.template(urlTemplate, {lat: latlng.lat, lng: latlng.lng, radius: Math.ceil(searchRadiusMeters)});\n    const resp = await fetch(url, {responseType: 'json', timeout: 10000});\n    if (resp.status === 200) {\n        let photos = parseSearchResponse(resp.responseJSON);\n        if (photos) {\n            photos.sort(isCloser.bind(null, latlng));\n            const nearestLatlng = L.latLng(photos[0].lat, photos[0].lng);\n            photos = photos.filter((photo) => nearestLatlng.distanceTo(L.latLng(photo.lat, photo.lng)) <= clusterSize);\n            return {\n                found: true,\n                data: photos\n            };\n        }\n        return {found: false};\n    }\n    return {found: false};\n}\n\nfunction formatDateTime(dateStr) {\n    const m = /^(\\d+)-(\\d+)-(\\d+)/u.exec(dateStr);\n    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n    if (m) {\n        let [year, month, day] = m.slice(1);\n        return `${day} ${months[month - 1]} ${year}`;\n    }\n    return dateStr;\n}\n\nconst Viewer = L.Evented.extend({\n    initialize: function(container) {\n        container = L.DomUtil.create('div', 'wikimedia-viewer-container', container);\n        const mapContainer = this.mapContainer = L.DomUtil.create('div', 'wikimedia-viewer-map-container', container);\n        this.pageButtonContainer = L.DomUtil.create('div', 'wikimedia-viewer-page-buttons-container', container);\n\n        this.map = L.map(mapContainer, {\n            maxBoundsViscosity: 1,\n            crs: L.CRS.Simple,\n            zoomControl: false,\n            attributionControl: false,\n            zoomSnap: 0,\n        });\n\n        this.map.on('zoomend', this.notifyChange, this);\n        this.map.on('moveend', this.notifyChange, this);\n\n        this.infoLabel = L.DomUtil.create('div', 'wikimedia-viewer-info-overlay', mapContainer);\n        this.closeButton = L.DomUtil.create('div', 'photo-viewer-button-close', container);\n        this.prevPhotoButton = L.DomUtil.create('div', 'wikimedia-viewer-button-prev', mapContainer);\n        this.nextPhotoButton = L.DomUtil.create('div', 'wikimedia-viewer-button-next', mapContainer);\n        L.DomEvent.on(this.prevPhotoButton, 'click', () => {\n            this.switchPhoto(this._imageIdx - 1);\n        });\n        L.DomEvent.on(this.nextPhotoButton, 'click', () => {\n            this.switchPhoto(this._imageIdx + 1);\n        });\n        L.DomEvent.on(this.closeButton, 'click', this.onCloseClick, this);\n    },\n\n    setupPageButtons: function(count) {\n        if (this._buttons) {\n            for (let button of this._buttons) {\n                this.pageButtonContainer.removeChild(button);\n            }\n        }\n        this._buttons = [];\n        if (count > 1) {\n            L.DomUtil.addClass(this.pageButtonContainer, 'enabled');\n\n            for (let i = 0; i < count; i++) {\n                let button = L.DomUtil.create('div', 'wikimedia-viewer-page-button', this.pageButtonContainer);\n                button.innerHTML = String(i + 1);\n                this._buttons.push(button);\n                L.DomEvent.on(button, 'click', () => this.switchPhoto(i));\n            }\n        } else {\n            L.DomUtil.removeClass(this.pageButtonContainer, 'enabled');\n        }\n    },\n\n    switchPhoto: function(imageIdx, imagePos = null) {\n        this._imageIdx = imageIdx;\n        if (this.imageLayer) {\n            this.map.removeLayer(this.imageLayer);\n        }\n        let image = this.images[imageIdx];\n        let mapSize = this.map.getSize();\n        if (!mapSize.x || !mapSize.y) {\n            mapSize = {x: 500, y: 500};\n        }\n        let maxZoom = Math.log2(Math.max(image.width / mapSize.x, image.height / mapSize.y)) + 2;\n        if (maxZoom < 1) {\n            maxZoom = 1;\n        }\n        let\n            southWest = this.map.unproject([0, image.height], maxZoom - 2),\n            northEast = this.map.unproject([image.width, 0], maxZoom - 2);\n        const bounds = new L.LatLngBounds(southWest, northEast);\n        this.map.setMaxZoom(maxZoom);\n        this.map.setMaxBounds(bounds);\n        if (imagePos) {\n            this.map.setView(imagePos.center, imagePos.zoom, {animate: false});\n        } else {\n            this.map.fitBounds(bounds, {animate: false});\n        }\n\n        this.imageLayer = L.imageOverlay(null, bounds);\n        L.DomUtil.addClass(this.mapContainer, 'loading');\n        this.imageLayer.on('load', () => {\n            L.DomUtil.removeClass(this.mapContainer, 'loading');\n        });\n        this.imageLayer.setUrl(image.url);\n        this.imageLayer.addTo(this.map);\n        let caption = [];\n\n        if (image.timeOriginal) {\n            caption.push(formatDateTime(image.timeOriginal));\n        }\n        if (image.author) {\n            caption.push(image.author);\n        }\n        caption.push(`<a href=\"${image.pageUrl}\">${image.description}</a>`);\n        caption = caption.join('</br>');\n        this.infoLabel.innerHTML = caption;\n\n        if (imageIdx > 0) {\n            L.DomUtil.addClass(this.prevPhotoButton, 'enabled');\n        } else {\n            L.DomUtil.removeClass(this.prevPhotoButton, 'enabled');\n        }\n        if (imageIdx < this.images.length - 1) {\n            L.DomUtil.addClass(this.nextPhotoButton, 'enabled');\n        } else {\n            L.DomUtil.removeClass(this.nextPhotoButton, 'enabled');\n        }\n        for (let [i, button] of this._buttons.entries()) {\n            ((i === imageIdx) ? L.DomUtil.addClass : L.DomUtil.removeClass)(button, 'active');\n        }\n        this.notifyChange();\n    },\n\n    notifyChange: function() {\n        if (this.images && this._active) {\n            const image = this.images[this._imageIdx];\n            this.fire('change', {\n                    latlng: L.latLng(image.lat, image.lng),\n                    latlngs: this.images.map((image) => L.latLng(image.lat, image.lng))\n                }\n            );\n        }\n    },\n\n    _showPano: function(images, imageIdx = 0, imagePos = null) {\n        this.images = images;\n        this.setupPageButtons(images.length);\n        this.switchPhoto(imageIdx, imagePos);\n    },\n\n    showPano: function(images) {\n        this._showPano(images);\n    },\n\n    onCloseClick: function() {\n        this.fire('closeclick');\n    },\n\n    activate: function() {\n        this._active = true;\n    },\n\n    deactivate: function() {\n        this._active = false;\n    },\n\n    setState: function(state) {\n        const lat = parseFloat(state[0]);\n        const lng = parseFloat(state[1]);\n        const pageId = state[2];\n        const y = parseFloat(state[3]);\n        const x = parseFloat(state[4]);\n        const zoom = parseFloat(state[5]);\n        if (!isNaN(lat) && !isNaN(lng) && !isNaN(x) && !isNaN(y) && !isNaN(zoom)) {\n            let imageIdx = -1;\n            getPanoramaAtPos({lat, lng}, 0).then((resp) => {\n                if (!resp.found) {\n                    return;\n                }\n                for (let [i, image] of resp.data.entries()) {\n                    if (image.pageId === pageId) {\n                        imageIdx = i;\n                        break;\n                    }\n                }\n                if (imageIdx > -1) {\n                    this._showPano(resp.data, imageIdx, {center: L.latLng(y, x), zoom});\n                }\n            });\n            return true;\n        }\n        return false;\n    },\n\n    getState: function() {\n        if (!this.images) {\n            return [];\n        }\n        const center = this.map.getCenter();\n        return [\n            this.images[0].lat.toFixed(6),\n            this.images[0].lng.toFixed(6),\n            this.images[this._imageIdx].pageId,\n            center.lat.toFixed(2),\n            center.lng.toFixed(2),\n            this.map.getZoom().toFixed(1)\n        ];\n    },\n\n    invalidateSize: function() {\n        this.map.invalidateSize();\n    }\n});\n\nfunction getViewer(container) {\n    return new Viewer(container);\n}\n\nconst wikimediaProvider = {getCoverageLayer, getPanoramaAtPos, getViewer};\nexport default wikimediaProvider;\n","import L from 'leaflet';\nimport {TiledDataLoader} from '~/lib/tiled-data-loader';\n\nconst MultiLayer = L.Layer.extend({\n    initialize: function(layers) {\n        this.layers = layers;\n    },\n\n    setLayersVisibility: function(e) {\n        if (!this._map) {\n            return;\n        }\n\n        let newZoom;\n        if (e && e.zoom !== undefined) {\n            newZoom = e.zoom;\n        } else {\n            newZoom = this._map.getZoom();\n        }\n\n        for (let layer of this.layers) {\n            if (layer.minZoom <= newZoom && newZoom <= layer.maxZoom) {\n                this._map.addLayer(layer.layer);\n            } else {\n                this._map.removeLayer(layer.layer);\n            }\n        }\n    },\n\n    onAdd: function(map) {\n        this._map = map;\n        this.setLayersVisibility();\n        map.on('zoomend', this.setLayersVisibility, this);\n    },\n\n    onRemove: function() {\n        for (let layer of this.layers) {\n            this._map.removeLayer(layer.layer);\n        }\n        this._map.off('zoomend', this.setLayersVisibility, this);\n        this._map.off('zoomanim', this.setLayersVisibility, this);\n        this._map = null;\n    }\n\n});\n\nclass WikimediaLoader extends TiledDataLoader {\n    constructor(urlTemplate, zoom) {\n        super();\n        this.url = urlTemplate;\n        this.maxZoom = zoom;\n    }\n\n    getTileUrl(coords) {\n        const data = {\n            x: coords.x,\n            z: coords.z,\n            y: 2 ** coords.z - 1 - coords.y\n        };\n        return L.Util.template(this.url, data);\n    }\n\n    layerTileToDataTileCoords(layerTileCoords) {\n        let z = layerTileCoords.z;\n        let z2 = null;\n        if (z > this.maxZoom) {\n            z2 = this.maxZoom;\n        } else {\n            return {z, x: layerTileCoords.x, y: layerTileCoords.y};\n        }\n\n        let multiplier = 1 << (z - z2);\n        return {\n            x: Math.floor(layerTileCoords.x / multiplier),\n            y: Math.floor(layerTileCoords.y / multiplier),\n            z: z2\n        };\n    }\n\n    makeRequestData(dataTileCoords) {\n        return {\n            url: this.getTileUrl(dataTileCoords),\n            options: {\n                responseType: 'arraybuffer',\n                timeout: 10000,\n                isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 404\n            }\n        };\n    }\n\n    async processResponse(xhr, originalDataTileCoords) {\n        let tileData;\n        if (originalDataTileCoords.z >= this.maxZoom && xhr.status === 200 && xhr.response) {\n            tileData = new Uint16Array(xhr.response);\n        } else {\n            tileData = null;\n        }\n\n        return {\n            tileData,\n            coords: originalDataTileCoords\n        };\n    }\n}\n\nconst WikimediaVectorCoverage = L.GridLayer.extend({\n        options: {\n            tileSize: 256,\n            // updateWhenIdle: true,\n            color: '#ff00ff',\n        },\n\n        initialize: function(url, options) {\n            L.GridLayer.prototype.initialize.call(this, options);\n            this.loader = new WikimediaLoader(url, 11);\n        },\n\n        onAdd: function(map) {\n            L.GridLayer.prototype.onAdd.call(this, map);\n            this.on('tileunload', this.onTileUnload, this);\n        },\n\n        onRemove: function(map) {\n            L.GridLayer.prototype.onRemove.call(this, map);\n            this.off('tileunload', this.onTileUnload, this);\n        },\n\n        onTileUnload: function(e) {\n            const tile = e.tile;\n            tile._abortLoading();\n            delete tile._tileData;\n            delete tile._adjustment;\n        },\n\n        drawTile: function(canvas, _unused_coords) {\n            if (!this._map) {\n                return;\n            }\n            if (!canvas._tileData) {\n                return;\n            }\n            const dataOffset = 5000;\n            const dataExtent = 65535 - 2 * dataOffset;\n            const tileData = canvas._tileData;\n            let {multiplier, offsetX, offsetY} = canvas._adjustment;\n            const canvasCtx = canvas.getContext('2d');\n            const pixelScale = multiplier * 256 / dataExtent;\n            canvasCtx.fillStyle = this.options.color;\n            for (let i = 0, l = tileData.length; i < l; i += 2) {\n                let x = (tileData[i] - dataOffset) * pixelScale - offsetX * 256;\n                let y = (tileData[i + 1] - dataOffset) * pixelScale - offsetY * 256;\n                canvasCtx.beginPath();\n                canvasCtx.arc(x, y, 5, 0, 2 * Math.PI);\n                canvasCtx.fill();\n            }\n        },\n\n        createTile: function(coords, done) {\n            const canvas = L.DomUtil.create('canvas', 'leaflet-tile');\n            canvas.width = this.options.tileSize;\n            canvas.height = this.options.tileSize;\n            let {dataPromise, abortLoading} = this.loader.requestTileData(coords);\n            dataPromise.then((data) => {\n                if (!data.error) {\n                    canvas._tileData = data.tileData;\n                    canvas._adjustment = data.adjustment || {multiplier: 1, offsetX: 0, offsetY: 0};\n                    setTimeout(() => {\n                        this.drawTile(canvas, coords);\n                        done(null, canvas);\n                    }, 1);\n                }\n            });\n\n            canvas._abortLoading = abortLoading;\n            return canvas;\n        },\n    }\n);\n\nexport {MultiLayer, WikimediaVectorCoverage};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {getSMap} from './apiLoader';\nimport {CloseButtonMixin, DateLabelMixin} from '../common';\n\nfunction getCoverageLayer(options) {\n    return L.tileLayer('https://mapserver.mapy.cz/panorama_hybrid-m/{z}-{x}-{y}', options);\n}\n\nasync function getPanoramaAtPos(latlng, searchRadiusMeters) {\n    const smap = await getSMap();\n    const request = smap.Pano.getBest(smap.Coords.fromWGS84(latlng.lng, latlng.lat), searchRadiusMeters);\n    try {\n        return {\n            found: true,\n            data: await request,\n        };\n    } catch (e) {\n        return {found: false};\n    }\n}\n\nconst Viewer = L.Evented.extend({\n    includes: [CloseButtonMixin, DateLabelMixin],\n\n    initialize: function(smap, container) {\n        // Disable keyboard events for panorama as they  conflict with other hotkeys.\n        const orig_windowAddEventListener = window.addEventListener;\n        window.addEventListener = (function(type, ...args) {\n            if (!/^key/u.test(type)) {\n                orig_windowAddEventListener(type, ...args);\n            }\n        });\n        this.panorama = new smap.Pano.Scene(container);\n        window.addEventListener = orig_windowAddEventListener;\n        this.createDateLabel(container);\n        this.createCloseButton(container);\n        window.addEventListener('resize', this.resize.bind(this));\n        this.invalidateSize = L.Util.throttle(this._invalidateSize, 100, this);\n    },\n\n    showPano: function(data) {\n        const yaw = this.panorama.getCamera().yaw;\n        this.panorama.show(data, {yaw});\n        this.panorama.setCamera({fov: 1.256637061});\n        this.updatePositionAndView();\n        this.updateDateLabel();\n    },\n\n    activate: function() {\n        this._active = true;\n        this.resize();\n        if (!this._updateHandler) {\n            this._updateHandler = setInterval(() => this.updatePositionAndView(), 200);\n        }\n    },\n\n    deactivate: function() {\n        this._active = false;\n        if (this._updateHandler) {\n            clearInterval(this._updateHandler);\n            this._updateHandler = null;\n        }\n    },\n\n    getState: function() {\n        const camera = this.panorama.getCamera();\n        const place = this.panorama.getPlace();\n        if (!place) {\n            return null;\n        }\n        const coords = place.getCoords().toWGS84();\n        return [\n            coords[1].toFixed(6),\n            coords[0].toFixed(6),\n            camera.yaw.toFixed(4),\n            camera.pitch.toFixed(4),\n            camera.fov.toFixed(4),\n        ];\n    },\n\n    setState: function(state) {\n        const lat = parseFloat(state[0]);\n        const lng = parseFloat(state[1]);\n        const yaw = parseFloat(state[2]);\n        const pitch = parseFloat(state[3]);\n        const fov = parseFloat(state[4]);\n        if (!isNaN(lat) && !isNaN(lng) && !isNaN(yaw) && !isNaN(pitch) && !isNaN(fov)) {\n            getPanoramaAtPos({lat, lng}, 0).then(({data, found}) => {\n                if (found) {\n                    this.panorama.show(data, {yaw, pitch, fov});\n                    this.panorama.setCamera({yaw, pitch, fov});\n                    this.updateDateLabel();\n                }\n            });\n            return true;\n        }\n        return false;\n    },\n\n    resize: function() {\n        this.panorama.syncPort();\n    },\n\n    updatePositionAndView: function() {\n        const place = this.panorama.getPlace();\n        if (!place) {\n            return;\n        }\n        const oldPlaceId = this._placeId;\n        const oldHeading = this._heading;\n        this._placeId = place.getId();\n        this._heading = this.panorama.getCamera().yaw;\n        const placeIdChanged = this._placeId !== oldPlaceId;\n        const headingChanged = this._heading !== oldHeading;\n        if (placeIdChanged) {\n            this.updateDateLabel();\n        }\n        if (placeIdChanged || headingChanged) {\n            const coords = place.getCoords().toWGS84();\n            this.fire('change', {\n                latlng: L.latLng(coords[1], coords[0]),\n                heading: (this._heading * 180) / Math.PI,\n            });\n        }\n    },\n\n    updateDateLabel: function() {\n        const place = this.panorama.getPlace();\n        const timestamp = Date.parse(place.getDate());\n        DateLabelMixin.updateDateLabel.call(this, timestamp);\n    },\n\n    _invalidateSize: function() {\n        this.panorama.syncPort();\n    }\n});\n\nasync function getViewer(container) {\n    const smap = await getSMap();\n    return new Viewer(smap, container);\n}\n\nconst mapyczProvider = {getCoverageLayer, getPanoramaAtPos, getViewer};\nexport default mapyczProvider;\n","import loadScript from 'load-script';\n\nlet _smap = null;\nlet _pending = null;\n\nfunction getLoader() {\n    const loaderUrl = 'https://api.mapy.cz/loader.js';\n    return new Promise((resolve, reject) => {\n        loadScript(loaderUrl, (error) => {\n            if (error) {\n                reject(error);\n            } else {\n                resolve(window.Loader);\n            }\n        });\n    });\n}\n\nfunction loadApi(loader) {\n    return new Promise((resolve) => {\n        loader.async = true;\n        loader.load(null, {pano: true}, () => {\n            resolve(window.SMap);\n        });\n    });\n}\n\nfunction getSMap() {\n    if (_smap) {\n        return _smap;\n    }\n    if (!_pending) {\n        _pending = getLoader().then((loader) => loadApi(loader));\n    }\n    return _pending;\n}\n\nexport {getSMap};\n","// extracted by mini-css-extract-plugin\nexport {};","import {arrayBufferToString} from '~/lib/binary-strings';\n\nconst selectFiles = (() => {\n    let fileInput;\n    return function selectFiles(multiple = false) {\n        if (fileInput) {\n            document.body.removeChild(fileInput);\n        }\n        fileInput = document.createElement('input');\n        document.body.appendChild(fileInput);\n        fileInput.type = 'file';\n        fileInput.multiple = Boolean(multiple);\n        fileInput.style.display = 'none';\n\n        const result = new Promise(function(resolve) {\n                fileInput.addEventListener('change', function() {\n                        resolve(fileInput.files);\n                    }\n                );\n            }\n        );\n        fileInput.click();\n        return result;\n    };\n})();\n\nfunction readFile(file) {\n    return new Promise(function(resolve) {\n            var reader = new FileReader();\n            reader.onload = function(e) {\n                resolve({\n                        data: arrayBufferToString(e.target.result),\n                        filename: file.name\n                    }\n                );\n            };\n            reader.readAsArrayBuffer(file);\n        }\n    );\n}\n\nfunction readFiles(files) {\n    files = Array.prototype.slice.apply(files);\n    return Promise.all(files.map(readFile));\n}\n\nexport {selectFiles, readFiles};\n","import parseGpx from './gpx';\nimport parseZip from './zip';\nimport {parseKmz, parseKml} from './kml';\nimport {parseOziPlt, parseOziRte, parseOziWpt} from './ozi';\n\nconst parsers = [\n    parseKmz,\n    parseZip,\n    parseGpx,\n    parseOziRte,\n    parseOziPlt,\n    parseOziWpt,\n    parseKml,\n];\n\nexport default parsers;\n","import {JSUnzip} from '~/vendored/github.com/augustl/js-unzip/js-unzip';\nimport jsInflate from './jsInflate';\nimport {decode866} from './codePages';\nimport parseGeoFile from '../parseGeoFile';\n\nfunction parseZip(txt, _unused_name) {\n    let unzipper;\n    try {\n        unzipper = new JSUnzip(txt);\n    } catch (e) {\n        return null;\n    }\n    if (!unzipper.isZipFile()) {\n        return null;\n    }\n    try {\n        unzipper.readEntries();\n    } catch (e) {\n        return null;\n    }\n    var geodata_array = [];\n    for (var i = 0; i < unzipper.entries.length; i++) {\n        var entry = unzipper.entries[i];\n        var uncompressed;\n        if (entry.compressionMethod === 0) {\n            uncompressed = entry.data;\n        } else if (entry.compressionMethod === 8) {\n            uncompressed = jsInflate(entry.data, entry.uncompressedSize);\n        } else {\n            return null;\n        }\n        var file_name = decode866(entry.fileName);\n        var geodata = parseGeoFile(file_name, uncompressed);\n        for (let item of geodata) {\n            if (item.error === 'UNSUPPORTED' && item.name.match(/(\\.(pdf|doc|txt|jpg))|\\/$/ui)) {\n                continue;\n            }\n            geodata_array.push(item);\n        }\n    }\n    return geodata_array;\n}\n\nexport default parseZip;\n","import {decode as utf8_decode} from 'utf8';\nimport {xmlGetNodeText} from './xmlUtils';\nimport stripBom from '~/lib/stripBom';\nimport JSUnzip from '~/vendored/github.com/augustl/js-unzip/js-unzip';\nimport jsInflate from './jsInflate';\n\nfunction parseKml(txt, name) {\n    var error;\n    function getSegmentPoints(coordinates_element) {\n        // convert multiline text value of tag to single line\n        var coordinates_string = xmlGetNodeText(coordinates_element);\n        var points_strings = coordinates_string.split(/\\s+/u);\n        var points = [];\n        for (var i = 0; i < points_strings.length; i++) {\n            if (points_strings[i].length) {\n                var point = points_strings[i].split(',');\n                var lat = parseFloat(point[1]);\n                var lng = parseFloat(point[0]);\n                if (isNaN(lat) || isNaN(lng)) {\n                    error = 'CORRUPT';\n                    break;\n                }\n                points.push({lat: lat, lng: lng});\n            }\n        }\n        return points;\n    }\n\n    function getTrackSegments(xml) {\n        var segments_elements = xml.getElementsByTagName('LineString');\n        var segments = [];\n        for (var i = 0; i < segments_elements.length; i++) {\n            var coordinates_element = segments_elements[i].getElementsByTagName('coordinates');\n            if (coordinates_element.length) {\n                var segment_points = getSegmentPoints(coordinates_element[0]);\n                if (segment_points.length) {\n                    segments.push(segment_points);\n                }\n            }\n        }\n        return segments;\n    }\n\n    function getPoints(dom) {\n        var points = [],\n            placemarks, i, coord, name, lat, lng, pointObjs;\n        placemarks = dom.getElementsByTagName('Placemark');\n        for (i = 0; i < placemarks.length; i++) {\n            pointObjs = placemarks[i].getElementsByTagName('Point');\n            if (pointObjs.length === 0) {\n                continue;\n            } else if (pointObjs.length > 1) {\n                error = 'CORRUPT';\n                break;\n            }\n            coord = pointObjs[0].getElementsByTagName('coordinates');\n            if (coord.length !== 1) {\n                error = 'CORRUPT';\n                break;\n            }\n            coord = xmlGetNodeText(coord[0]);\n            coord = coord.split(',');\n            lat = parseFloat(coord[1]);\n            lng = parseFloat(coord[0]);\n            if (isNaN(lat) || isNaN(lng)) {\n                error = 'CORRUPT';\n                break;\n            }\n            name = '';\n            const nameTags = placemarks[i].getElementsByTagName('name');\n            if (nameTags[0]) {\n                try {\n                    name = xmlGetNodeText(nameTags[0]);\n                    name = utf8_decode(name);\n                } catch (e) {\n                    error = 'CORRUPT';\n                }\n            }\n            points.push({\n                    name: name,\n                    lat: lat,\n                    lng: lng\n                }\n            );\n        }\n        return points;\n    }\n\n    txt = stripBom(txt);\n    txt = txt.replace(/<([^ >]+):([^ >]+)/ug, '<$1_$2');\n    let dom;\n    try {\n        dom = (new DOMParser()).parseFromString(txt, \"text/xml\");\n    } catch (e) {\n        return null;\n    }\n    if (dom.documentElement.nodeName === 'parsererror') {\n        return null;\n    }\n    if (dom.getElementsByTagName('kml').length === 0) {\n        return null;\n    }\n\n    return [{name: name, tracks: getTrackSegments(dom), points: getPoints(dom), error: error}];\n}\n\nfunction parseKmz(txt, name) {\n    var uncompressed;\n    let unzipper;\n    try {\n        unzipper = new JSUnzip(txt);\n    } catch (e) {\n        return null;\n    }\n    var tracks = [],\n        points = [],\n        geodata,\n        error;\n    var hasDocKml = false;\n    if (!unzipper.isZipFile()) {\n        return null;\n    }\n    try {\n        unzipper.readEntries();\n    } catch (e) {\n        return null;\n    }\n    var i, entry;\n    for (i = 0; i < unzipper.entries.length; i++) {\n        entry = unzipper.entries[i];\n        if (entry.fileName === 'doc.kml') {\n            hasDocKml = true;\n            break;\n        }\n    }\n    if (!hasDocKml) {\n        return null;\n    }\n\n    for (i = 0; i < unzipper.entries.length; i++) {\n        entry = unzipper.entries[i];\n        if (entry.fileName.match(/\\.kml$/iu)) {\n            if (entry.compressionMethod === 0) {\n                uncompressed = entry.data;\n            } else if (entry.compressionMethod === 8) {\n                uncompressed = jsInflate(entry.data, entry.uncompressedSize);\n            } else {\n                return null;\n            }\n            geodata = parseKml(uncompressed, 'dummmy');\n            if (geodata) {\n                error = error || geodata[0].error;\n                tracks.push(...geodata[0].tracks);\n                points.push(...geodata[0].points);\n            }\n        }\n    }\n\n    geodata = [{name: name, error: error, tracks: tracks, points: points}];\n    return geodata;\n}\n\nexport {parseKml, parseKmz};\n","import {decodeCP1251} from './codePages';\nimport stripBom from '~/lib/stripBom';\n\nfunction parseOziRte(txt, name) {\n    let error,\n        segments = [];\n    txt = stripBom(txt);\n    const lines = txt.split('\\n');\n    if (lines[0].indexOf('OziExplorer Route File') !== 0) {\n        return null;\n    }\n    let currentSegment = [];\n    for (let i = 4; i < lines.length; i++) {\n        let line = lines[i].trim();\n        if (!line) {\n            continue;\n        }\n        let fields = line.split(',');\n        if (fields[0] === 'R') {\n            if (currentSegment.length) {\n                segments.push(currentSegment);\n            }\n            currentSegment = [];\n        } else if (fields[0] === 'W') {\n            let lat = parseFloat(fields[5]);\n            let lng = parseFloat(fields[6]);\n            if (isNaN(lat) || isNaN(lng)) {\n                error = 'CORRUPT';\n                break;\n            }\n            currentSegment.push({lat, lng});\n        } else {\n            error = 'CORRUPT';\n            break;\n        }\n    }\n    if (currentSegment.length) {\n        segments.push(currentSegment);\n    }\n    return [{name, tracks: segments, error}];\n}\n\nfunction parseOziPlt(txt, name) {\n    var error;\n    var segments = [];\n    txt = stripBom(txt);\n    var lines = txt.split('\\n');\n    if (lines[0].indexOf('OziExplorer Track Point File') !== 0) {\n        return null;\n    }\n    var expected_points_num = parseInt(lines[5], 10);\n    var current_segment = [];\n    var total_points_num = 0;\n    for (var i = 6; i < lines.length; i++) {\n        var line = lines[i].trim();\n        if (!line) {\n            continue;\n        }\n        var fields = line.split(',');\n        var lat = parseFloat(fields[0]);\n        var lon = parseFloat(fields[1]);\n        var is_start_of_segment = parseInt(fields[2], 10);\n        if (isNaN(lat) || isNaN(lon) || isNaN(is_start_of_segment)) {\n            error = 'CORRUPT';\n            break;\n        }\n        if (is_start_of_segment) {\n            current_segment = [];\n        }\n        if (!current_segment.length) {\n            segments.push(current_segment);\n        }\n        current_segment.push({lat: lat, lng: lon});\n        total_points_num += 1;\n    }\n    if (isNaN(expected_points_num) || (expected_points_num !== 0 && expected_points_num !== total_points_num)) {\n        error = 'CORRUPT';\n    }\n    return [{name: name, tracks: segments, error: error}];\n}\n\nfunction parseOziWpt(txt, name) {\n    var points = [],\n        error,\n        lines, line,\n        i,\n        lat, lng, pointName, fields;\n    txt = stripBom(txt);\n    lines = txt.split('\\n');\n    if (lines[0].indexOf('OziExplorer Waypoint File') !== 0) {\n        return null;\n    }\n    for (i = 4; i < lines.length; i++) {\n        line = lines[i].trim();\n        if (!line) {\n            continue;\n        }\n        fields = line.split(',');\n        lat = parseFloat(fields[2]);\n        lng = parseFloat(fields[3]);\n        pointName = decodeCP1251(fields[1]).trim();\n        if (isNaN(lat) || isNaN(lng)) {\n            error = 'CORRUPT';\n            break;\n        }\n        points.push({\n                lat: lat,\n                lng: lng,\n                name: pointName\n            }\n        );\n    }\n    return [{name: name, points: points, error: error}];\n}\n\nexport {parseOziPlt, parseOziRte, parseOziWpt};\n","import SimpleService from './simpleService';\nimport Endomondo from './endomondo';\nimport Etomesto from './etomesto';\nimport Gpsies from './gpsies';\nimport Gpslib from './gpslib';\nimport Osm from './osm';\nimport Strava from './strava';\nimport Tracedetrail from './tracedetrail';\nimport {YandexRuler} from './yandex';\nimport {NakarteTrack, NakarteUrl} from './nakarte';\nimport {MovescountMove, MovescountRoute} from './movescount';\nimport {GarminActivity, GarminRoute} from './garmin';\nimport {SportsTrackerActivity} from './sportstracker';\nimport OpenStreetMapRu from './openstreetmapRu';\n\nconst services = [\n    YandexRuler,\n    NakarteTrack,\n    NakarteUrl,\n    Endomondo,\n    Etomesto,\n    Gpsies,\n    Gpslib,\n    Osm,\n    Strava,\n    Tracedetrail,\n    MovescountMove,\n    MovescountRoute,\n    GarminActivity,\n    GarminRoute,\n    SportsTrackerActivity,\n    OpenStreetMapRu,\n    SimpleService\n];\n\nexport default services;\n","import BaseService from './baseService';\nimport parseGeoFile from '../parseGeoFile';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nclass SimpleService extends BaseService {\n    isOurUrl() {\n        return Boolean(this.origUrl.match(/^https?:\\/\\/.+/u));\n    }\n\n    requestOptions() {\n        return [{\n            url: urlViaCorsProxy(this.origUrl),\n            options: {responseType: 'binarystring'}\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        return parseGeoFile(this.nameFromUrl(response.responseURL), response.responseBinaryText);\n    }\n}\n\nexport default SimpleService;\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nclass Endomondo extends BaseService {\n    urlRegexps = [\n        /^https?:\\/\\/(?:www\\.)?endomondo\\.com\\/users\\/(\\d+)\\/workouts\\/(\\d+)/u,\n        /^https?:\\/\\/(?:www\\.)?endomondo\\.com\\/workouts\\/(\\d+)\\/(\\d+)/u\n    ];\n\n    isOurUrl() {\n        return this.urlRegexps.some((re) => re.test(this.origUrl));\n    }\n\n    requestOptions() {\n        let userId, trackId;\n        let m = this.urlRegexps[0].exec(this.origUrl);\n        if (m) {\n            [userId, trackId] = [m[1], m[2]];\n        } else {\n            m = this.urlRegexps[1].exec(this.origUrl);\n            [trackId, userId] = [m[1], m[2]];\n        }\n        return [{\n            url: urlViaCorsProxy(`https://www.endomondo.com/rest/v1/users/${userId}/workouts/${trackId}`),\n            options: {\n                responseType: 'json',\n                isResponseSuccess: (xhr) => (xhr.status === 200 || xhr.status === 404)\n            },\n\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        if (response.status === 404) {\n            return [{error: 'Invalid link or user disabled viewing this workout track'}];\n        }\n\n        const data = response.responseJSON;\n        if (!data) {\n            return [{name: 'Endomondo activity', error: 'UNSUPPORTED'}];\n        }\n        if (!data.points || !data.points.points) {\n            return [{error: 'Endomondo user disabled viewing this workout track'}];\n        }\n\n        const track = data.points.points\n            .filter((p) => p.latitude)\n            .map((p) => ({\n                        lat: p.latitude,\n                        lng: p.longitude\n            }));\n        if (track.length === 0) {\n            return [{error: 'Endomondo user disabled viewing this workout track'}];\n        }\n\n        const date = data.local_start_time.split('T')[0];\n        const dist = `${data.distance.toFixed(1)} km`;\n        let trackName = `${date}, ${dist}`;\n        if (data.author && data.author.name) {\n            trackName += ` ${data.author.name}`;\n        }\n        if (data.title) {\n            trackName += `: ${data.title}`;\n        }\n        return [{\n            name: trackName,\n            tracks: [track]\n        }];\n    }\n}\n\nexport default Endomondo;\n","import urlViaCorsProxy from '~/lib/CORSProxy';\nimport BaseService from './baseService';\nimport parseGpx from '../parsers/gpx';\n\nclass Etomesto extends BaseService {\n    urlRe = /^https?:\\/\\/(?:www\\.)?etomesto\\.ru\\/track([a-z0-9]+)/u;\n\n    getTrackId() {\n        const m = this.urlRe.exec(this.origUrl);\n        return m[1];\n    }\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const trackId = this.getTrackId();\n        return [{\n            url: urlViaCorsProxy(`http://www.etomesto.ru/save/${trackId}.gpx`),\n            options: {\n                responseType: 'binarystring',\n                isResponseSuccess: (xhr) => (\n                    xhr.status === 200 &&\n                    !xhr.responseBinaryText.startsWith('ERROR'))\n            }\n        }];\n    }\n\n    parseResponse(responses) {\n        const trackId = this.getTrackId();\n        const response = responses[0];\n        const name = `Etomesto track ${trackId}`;\n        return parseGpx(response.responseBinaryText, name, true) || [{name: name, error: 'UNSUPPORTED'}];\n    }\n}\n\nexport default Etomesto;\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\nimport parseGpx from '../parsers/gpx';\nimport urlEncode from './urlEncode';\n\nclass Gpsies extends BaseService {\n    urlRe = /^https?:\\/\\/www\\.gpsies\\.com\\/map\\.do[^?]*\\?fileId=([a-z]+)/u;\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = m[1];\n        const newUrl = urlViaCorsProxy('https://www.gpsies.com/download.do');\n        return [{\n            url: newUrl,\n            options: {\n                method: 'POST',\n                data: urlEncode({\n                        fileId: trackId,\n                        speed: '10',\n                        dataType: '3',\n                        filetype: 'gpxTrk',\n                        submitButton: '',\n                        inappropriate: ''\n                    }\n                ),\n                headers: [[\"Content-type\", \"application/x-www-form-urlencoded\"]],\n                responseType: 'binarystring'\n            }\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        return parseGpx(response.responseBinaryText, this.nameFromUrl(response.responseURL), true) ||\n            [{name: name, error: 'UNSUPPORTED'}];\n    }\n}\n\nexport default Gpsies;\n","function urlEncode(d) {\n    return Object.entries(d).map(([k, v]) => `${k}=${encodeURIComponent(v)}`).join('&');\n}\n\nexport default urlEncode;\n","import urlViaCorsProxy from '~/lib/CORSProxy';\nimport BaseService from './baseService';\nimport parseGpx from '../parsers/gpx';\n\nclass Gpslib extends BaseService {\n    urlRe = /^https?:\\/\\/(?:.+\\.)?gpslib\\.[^.]+\\/tracks\\/info\\/(\\d+)/u;\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[1];\n        return [{\n            url: urlViaCorsProxy(`https://www.gpslib.ru/tracks/download/${trackId}.gpx`),\n            options: {responseType: 'binarystring'}\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        return parseGpx(response.responseBinaryText, `GPSLib ${this.trackId}`, true) ||\n            [{name: name, error: 'UNSUPPORTED'}];\n    }\n}\n\nexport default Gpslib;\n","import urlViaCorsProxy from '~/lib/CORSProxy';\nimport BaseService from './baseService';\nimport parseGpx from '../parsers/gpx';\n\nclass Osm extends BaseService {\n    urlRe = /^https?:\\/\\/(?:www\\.)?openstreetmap\\.org\\/user\\/(?:.*)\\/traces\\/(\\d+)/u;\n\n    getTrackId() {\n        const m = this.urlRe.exec(this.origUrl);\n        return m[1];\n    }\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const trackId = this.getTrackId();\n        return [{\n            url: urlViaCorsProxy(`https://www.openstreetmap.org/trace/${trackId}/data`),\n            options: {responseType: 'binarystring'}\n        }];\n    }\n\n    parseResponse(responses) {\n        const trackId = this.getTrackId();\n        const response = responses[0];\n        return parseGpx(response.responseBinaryText, `OSM track ${trackId}`, true) ||\n            [{name: name, error: 'UNSUPPORTED'}];\n    }\n}\n\nexport default Osm;\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nclass Strava extends BaseService {\n    urlRe = /^https?:\\/\\/(?:.+\\.)?strava\\.com\\/activities\\/(\\d+)/u;\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[1];\n        function isResponseSuccess(response) {\n            return [200, 401, 404].includes(response.status);\n        }\n        return [\n            {\n                url: urlViaCorsProxy(`https://www.strava.com/activities/${trackId}?hl=en-GB`),\n                options: {\n                    isResponseSuccess\n                }\n            },\n            {\n                url: urlViaCorsProxy(`https://www.strava.com/stream/${trackId}?streams%5B%5D=latlng`),\n                options: {\n                    responseType: 'json',\n                    isResponseSuccess\n                }\n            }\n        ];\n    }\n\n    parseResponse(responses) {\n        const statusMessages = {\n            401: 'Requested Strava activity marked as private',\n            404: 'Requested Strava activity could not be found'\n        };\n        const [pageResponse, trackResponse] = responses;\n        if (trackResponse.status !== 200) {\n            return [{error: statusMessages[trackResponse.status]}];\n        }\n        let name = `Strava ${this.trackId}`;\n        const latlngs = trackResponse.responseJSON?.latlng;\n        if (!latlngs || !Array.isArray(latlngs)) {\n            return [{name, error: 'UNSUPPORTED'}];\n        }\n        const tracks = [latlngs.map((p) => ({lat: p[0], lng: p[1]}))];\n        let dom;\n        try {\n            dom = (new DOMParser()).parseFromString(pageResponse.response, 'text/html');\n        } catch (e) {\n            // will use default name\n        }\n        if (dom) {\n            const userName = (dom.querySelector('a.minimal[href*=\"/athletes/\"]')?.textContent ?? '').trim();\n            const activityTitle = (dom.querySelector('h1.activity-name')?.textContent ?? '').trim();\n            let date = dom.querySelector('time')?.textContent ?? '';\n            date = date.split(',')[1] ?? '';\n            date = date.trim();\n            if (userName && activityTitle && date) {\n                name = `${userName} - ${activityTitle} ${date}`;\n            }\n        }\n        return [{\n            name,\n            tracks\n        }];\n    }\n}\n\nexport default Strava;\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\nimport L from 'leaflet';\n\nclass Tracedetrail extends BaseService {\n    urlRe = /^https?:\\/\\/(?:www\\.)?tracedetrail\\.[a-z]{2,}.*\\/trace\\/trace\\/([0-9]+)/u;\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[1];\n\n        return [{\n            url: urlViaCorsProxy(`https://tracedetrail.com/en/trace/geomSections/${trackId}`),\n            options: {responseType: 'json'}\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        let name = `Tracedetrail track ${this.trackId}`;\n        try {\n            name = response.responseJSON.nom_fr || name;\n            const geometry = JSON.parse(response.responseJSON.geometry);\n            const proj = L.CRS.EPSG3857;\n            const points = geometry.map((item) => proj.unproject(L.point(item.lon, item.lat)));\n\n            return [{\n                name,\n                tracks: [points]\n            }];\n        } catch (e) {\n            let error = 'UNSUPPORTED';\n\n            if (response.status === 200) {\n                error = `Track with id ${this.trackId} was deleted or did not exist`;\n            }\n\n            return [{name, error}];\n        }\n    }\n}\n\nexport default Tracedetrail;\n","import BaseService from './baseService';\n\nclass YandexRuler extends BaseService {\n    urlRe = /yandex\\..+[?&]rl=([^&]+)/u;\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        return [];\n    }\n\n    parseResponse() {\n        let last_lat = 0;\n        let last_lng = 0;\n        let error;\n        const points = [];\n        let s = this.urlRe.exec(this.origUrl)[1];\n        s = s.replace(/%2C/iug, ',');\n        const points_str = s.split('~');\n        for (let i = 0; i < points_str.length; i++) {\n            let point = points_str[i].split(',');\n            let lng = parseFloat(point[0]);\n            let lat = parseFloat(point[1]);\n            if (isNaN(lat) || isNaN(lng)) {\n                error = 'CORRUPT';\n                break;\n            }\n            last_lng += lng;\n            last_lat += lat;\n            points.push({lat: last_lat, lng: last_lng});\n        }\n        return [{\n            error: error,\n            tracks: [points],\n            name: 'Yandex ruler'\n        }];\n    }\n}\n\n// function parseYandexMap(txt) {\n//     var start_tag = '<script id=\"vpage\" type=\"application/json\">';\n//     var json_start = txt.indexOf(start_tag);\n//     if (json_start === -1) {\n//         return null;\n//     }\n//     json_start += start_tag.length;\n//     var json_end = txt.indexOf('</script>', json_start);\n//     if (json_end === -1) {\n//         return null;\n//     }\n//     var map_data = txt.substring(json_start, json_end);\n//     map_data = JSON.parse(map_data);\n//     console.log(map_data);\n//     if (!('request' in map_data)) {\n//         return null;\n//     }\n//     var name = 'YandexMap';\n//     var segments = [];\n//     var error;\n//     if (map_data.vpage && map_data.vpage.data && map_data.vpage.data.objects && map_data.vpage.data.objects.length) {\n//         var mapName = ('' + (map_data.vpage.data.name || '')).trim();\n//         if (mapName.length > 3) {\n//             name = '';\n//         } else if (mapName.length) {\n//             name += ': ';\n//         }\n//         name += fileutils.decodeUTF8(mapName);\n//         map_data.vpage.data.objects.forEach(function(obj){\n//             if (obj.pts && obj.pts.length) {\n//                 var segment = [];\n//                 for (var i=0; i< obj.pts.length; i++) {\n//                     var pt = obj.pts[i];\n//                     var lng = parseFloat(pt[0]);\n//                     var lat = parseFloat(pt[1]);\n//                     if (isNaN(lat) || isNaN(lng)) {\n//                         error = 'CORRUPT';\n//                         break;\n//                     }\n//                     segment.push({lat: lat, lng:lng});\n//                 }\n//                 if (segment.length) {\n//                     segments.push(segment);\n//                 }\n//             }\n//         });\n//     }\n//     if (map_data.request.args && map_data.request.args.rl) {\n//         var res = parseYandexRulerString(map_data.request.args.rl);\n//         error = error || res.error;\n//         if (res.points && res.points.length) {\n//             segments.push(res.points);\n//         }\n//     }\n//     return [{name: name, error: error, tracks: segments}];\n// }\n\nexport {YandexRuler};\n","'use strict'; // code generated by pbf v3.0.5\n\n// Segment ========================================\n\nvar self = exports;\n\nvar Segment = self.Segment = {};\n\nSegment.read = function (pbf, end) {\n    return pbf.readFields(Segment._readField, {lats: [], lons: []}, end);\n};\nSegment._readField = function (tag, obj, pbf) {\n    if (tag === 1) pbf.readPackedSVarint(obj.lats);\n    else if (tag === 2) pbf.readPackedSVarint(obj.lons);\n};\nSegment.write = function (obj, pbf) {\n    if (obj.lats) pbf.writePackedSVarint(1, obj.lats);\n    if (obj.lons) pbf.writePackedSVarint(2, obj.lons);\n};\n\n// Waypoint ========================================\n\nvar Waypoint = self.Waypoint = {};\n\nWaypoint.read = function (pbf, end) {\n    return pbf.readFields(Waypoint._readField, {lat: 0, lon: 0, name: \"\"}, end);\n};\nWaypoint._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.lat = pbf.readSVarint();\n    else if (tag === 2) obj.lon = pbf.readSVarint();\n    else if (tag === 3) obj.name = pbf.readString();\n};\nWaypoint.write = function (obj, pbf) {\n    if (obj.lat) pbf.writeSVarintField(1, obj.lat);\n    if (obj.lon) pbf.writeSVarintField(2, obj.lon);\n    if (obj.name) pbf.writeStringField(3, obj.name);\n};\n\n// Waypoints ========================================\n\nvar Waypoints = self.Waypoints = {};\n\nWaypoints.read = function (pbf, end) {\n    return pbf.readFields(Waypoints._readField, {midLat: 0, midLon: 0, waypoints: []}, end);\n};\nWaypoints._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.midLat = pbf.readSVarint();\n    else if (tag === 2) obj.midLon = pbf.readSVarint();\n    else if (tag === 3) obj.waypoints.push(Waypoint.read(pbf, pbf.readVarint() + pbf.pos));\n};\nWaypoints.write = function (obj, pbf) {\n    if (obj.midLat) pbf.writeSVarintField(1, obj.midLat);\n    if (obj.midLon) pbf.writeSVarintField(2, obj.midLon);\n    if (obj.waypoints) for (var i = 0; i < obj.waypoints.length; i++) pbf.writeMessage(3, Waypoint.write, obj.waypoints[i]);\n};\n\n// Track ========================================\n\nvar Track = self.Track = {};\n\nTrack.read = function (pbf, end) {\n    return pbf.readFields(Track._readField, {name: \"\", segments: [], waypoints: null}, end);\n};\nTrack._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.name = pbf.readString();\n    else if (tag === 2) obj.segments.push(Segment.read(pbf, pbf.readVarint() + pbf.pos));\n    else if (tag === 3) obj.waypoints = Waypoints.read(pbf, pbf.readVarint() + pbf.pos);\n};\nTrack.write = function (obj, pbf) {\n    if (obj.name) pbf.writeStringField(1, obj.name);\n    if (obj.segments) for (var i = 0; i < obj.segments.length; i++) pbf.writeMessage(2, Segment.write, obj.segments[i]);\n    if (obj.waypoints) pbf.writeMessage(3, Waypoints.write, obj.waypoints);\n};\n\n// View ========================================\n\nvar View = self.View = {};\n\nView.read = function (pbf, end) {\n    return pbf.readFields(View._readField, {color: 0, shown: false, ticksShown: false}, end);\n};\nView._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.color = pbf.readVarint(true);\n    else if (tag === 2) obj.shown = pbf.readBoolean();\n    else if (tag === 3) obj.ticksShown = pbf.readBoolean();\n};\nView.write = function (obj, pbf) {\n    if (obj.color) pbf.writeVarintField(1, obj.color);\n    if (obj.shown) pbf.writeBooleanField(2, obj.shown);\n    if (obj.ticksShown) pbf.writeBooleanField(3, obj.ticksShown);\n};\n\n// TrackView ========================================\n\nvar TrackView = self.TrackView = {};\n\nTrackView.read = function (pbf, end) {\n    return pbf.readFields(TrackView._readField, {view: null, track: null}, end);\n};\nTrackView._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.view = View.read(pbf, pbf.readVarint() + pbf.pos);\n    else if (tag === 2) obj.track = Track.read(pbf, pbf.readVarint() + pbf.pos);\n};\nTrackView.write = function (obj, pbf) {\n    if (obj.view) pbf.writeMessage(1, View.write, obj.view);\n    if (obj.track) pbf.writeMessage(2, Track.write, obj.track);\n};\n","import * as urlSafeBase64 from '../../parsers/urlSafeBase64';\nimport {TRACKLIST_TRACK_COLORS} from '../../../track-list';\nimport loadFromUrl from '../../loadFromUrl';\n\nfunction parseWaypoint(rawPoint) {\n    let name = rawPoint.n;\n    let lat = Number(rawPoint.lt);\n    let lng = Number(rawPoint.ln);\n    if (typeof name !== 'string' || !name || isNaN(lat) || isNaN(lng) ||\n        lat < -90 || lat > 90 || lng < -180 || lng > 180) {\n        return {valid: false};\n    }\n    return {\n        valid: true,\n        point: {lat, lng, name}\n    };\n}\n\nfunction parseTrack(rawTrack) {\n    if (!rawTrack.length) {\n        return {valid: false};\n    }\n    const track = [];\n    for (let rawSegment of rawTrack) {\n        let segment = [];\n        if (!rawSegment || !rawSegment.length) {\n            return {valid: false};\n        }\n        for (let rawPoint of rawSegment) {\n            if (!rawPoint || rawPoint.length !== 2) {\n                return {valid: false};\n            }\n            let [lat, lng] = rawPoint.map(Number);\n            if (isNaN(lat) || isNaN(lng) || lat < -90 || lat > 90) {\n                return {valid: false};\n            }\n            segment.push({lat, lng});\n        }\n        track.push(segment);\n    }\n    return {valid: true, track};\n}\n\nasync function loadTracksFromJson(value) { // eslint-disable-line complexity\n    const errCorrupt = [{name: 'Track in url', error: 'CORRUPT'}];\n\n    const jsonString = urlSafeBase64.decode(value);\n    let data;\n    try {\n        data = JSON.parse(jsonString);\n    } catch (e) {\n        return errCorrupt;\n    }\n    if (!data || !data.length) {\n        return errCorrupt;\n    }\n    const geoDataArray = [];\n\n    for (let el of data) {\n        // Each track should contain either url or at least one of tracks and points\n        if (!el.u && !(el.p || el.t)) {\n            return errCorrupt;\n        }\n        let geodata;\n        if (el.u) {\n            geodata = await\n                loadFromUrl(el.u);\n            if (el.n && geodata.length === 1 && !geodata[0].error) {\n                geodata[0].name = el.n;\n            }\n        } else {\n            geodata = {};\n            geodata.name = el.n || 'Track';\n            if (el.t) {\n                const res = parseTrack(el.t);\n                if (!res.valid) {\n                    return errCorrupt;\n                }\n                geodata.tracks = res.track;\n            }\n            if (el.p) {\n                geodata.points = [];\n                for (let rawPoint of el.p) {\n                    let res = parseWaypoint(rawPoint);\n                    // eslint-disable-next-line max-depth\n                    if (!res.valid) {\n                        return errCorrupt;\n                    }\n                    geodata.points.push(res.point);\n                }\n            }\n            geodata = [geodata];\n        }\n        let viewProps = {};\n        if ('c' in el) {\n            let color = Number(el.c);\n            if (color < 0 || color >= TRACKLIST_TRACK_COLORS.length) {\n                return errCorrupt;\n            }\n            viewProps.color = color;\n        }\n        if ('v' in el) {\n            viewProps.trackHidden = !el.v;\n        }\n        if ('m' in el) {\n            viewProps.measureTicksShown = Boolean(el.m);\n        }\n        geodata.forEach((el) => Object.assign(el, viewProps));\n        geoDataArray.push(...geodata);\n    }\n    return geoDataArray;\n}\n\nexport default loadTracksFromJson;\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nclass MovescountBase extends BaseService {\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n}\n\nclass MovescountRoute extends MovescountBase {\n    urlRe = /^https?:\\/\\/(?:www\\.)?movescount\\.com\\/([a-z]{2}\\/)?map.*[?&]route=(\\d+)/u;\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[2];\n        return [{\n            url: urlViaCorsProxy(`http://www.movescount.com/Move/Route/${trackId}`),\n            options: {\n                responseType: 'json',\n                isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403\n            },\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        if (response.status === 403) {\n            return [{error: 'Movescount user disabled viewing this route'}];\n        }\n        let name = `Movescount route ${this.trackId}`;\n        const data = response.responseJSON;\n        if (!data) {\n            return [{name, error: 'UNSUPPORTED'}];\n        }\n\n        let points = [];\n        let track = [];\n\n        for (let i = 0; i < data.points.latitudes.length; i++) {\n            const latlng = {\n                lat: data.points.latitudes[i],\n                lng: data.points.longitudes[i]\n            };\n            track.push(latlng);\n            const point = data.points.data[i];\n            if (point) {\n                points.push({...latlng, name: point.name});\n            }\n        }\n\n        name = data.routeName ? data.routeName : name;\n\n        return [{\n            name,\n            points,\n            tracks: [track]\n        }];\n    }\n}\n\nclass MovescountMove extends MovescountBase {\n    urlRe = /^https?:\\/\\/(?:www\\.)?movescount\\.com\\/([a-z]{2}\\/)?moves\\/move(\\d+)/u;\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[2];\n        return [\n            {\n                url: urlViaCorsProxy(`http://www.movescount.com/Move/Track2/${trackId}`),\n                options: {\n                    responseType: 'json',\n                    isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403\n                }\n            },\n            {\n                url: urlViaCorsProxy(`https://www.movescount.com/moves/move${trackId}`),\n                options: {\n                    isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403 || xhr.status === 404\n                }\n            }\n        ];\n    }\n\n    parseResponse(responses) {\n        const [trackResponse, pageResponse] = responses;\n        if (trackResponse.status === 403) {\n            return [{error: 'Movescount user disabled viewing this activity'}];\n        }\n        let name = `Movescount move ${this.trackId}`;\n        const data = trackResponse.responseJSON;\n        if (!data) {\n            return [{name, error: 'UNSUPPORTED'}];\n        }\n\n        const track = data.TrackPoints.map((trackPoint) => ({\n                lat: trackPoint.Latitude,\n                lng: trackPoint.Longitude\n            })\n        );\n\n        const dom = (new DOMParser()).parseFromString(pageResponse.response, \"text/html\");\n        try {\n            const title = dom.querySelector('title').text.trim();\n            name = title ? title : name;\n        } catch (_) {\n            // use previously constructed name\n        }\n\n        return [{\n            name,\n            tracks: [track]\n        }];\n    }\n}\n\nexport {MovescountRoute, MovescountMove};\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nclass GarminBase extends BaseService {\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n}\n\nclass GarminRoute extends GarminBase {\n    urlRe = /^https?:\\/\\/connect\\.garmin\\.com\\/modern\\/course\\/(\\d+)/u;\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[1];\n        return [{\n            url: urlViaCorsProxy(`https://connect.garmin.com/modern/proxy/course-service/course/${trackId}`),\n            options: {\n                responseType: 'json',\n                isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403 || xhr.status === 404\n            },\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        if (response.status === 403) {\n            return [{error: 'Garmin Connect user disabled viewing this route'}];\n        }\n        if (response.status === 404) {\n            return [{error: 'Garmin Connect route does not exist'}];\n        }\n        let name = `Garmin Connect route ${this.trackId}`;\n        const data = response.responseJSON;\n        if (!data) {\n            return [{name, error: 'UNSUPPORTED'}];\n        }\n        let points = data.coursePoints.map((pt) => ({name: pt.name, lat: pt.lat, lng: pt.lon}));\n        let track = data.geoPoints.map((obj) => ({lat: obj.latitude, lng: obj.longitude}));\n        name = data.courseName ? data.courseName : name;\n        return [{\n            name,\n            points,\n            tracks: [track]\n        }];\n    }\n}\n\nclass GarminActivity extends GarminBase {\n    urlRe = /^https?:\\/\\/connect\\.garmin\\.com\\/modern\\/activity\\/(\\d+)/u;\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[1];\n        return [\n            {\n                url: urlViaCorsProxy(\n                    `https://connect.garmin.com/modern/proxy/activity-service/activity/${trackId}/details`),\n                options: {\n                    responseType: 'json',\n                    isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403 || xhr.status === 404\n                }\n            }\n        ];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        if (response.status === 403) {\n            return [{error: 'Garmin Connect user disabled viewing this activity'}];\n        }\n        if (response.status === 404) {\n            return [{error: 'Garmin Connect activity does not exist'}];\n        }\n        let name = `Garmin Connect activity ${this.trackId}`;\n        const data = response.responseJSON;\n        if (!data) {\n            return [{name, error: 'UNSUPPORTED'}];\n        }\n        let track = data.geoPolylineDTO.polyline.map((obj) => ({lat: obj.lat, lng: obj.lon}));\n        return [{\n            name,\n            tracks: [track]\n        }];\n    }\n}\n\nexport {GarminRoute, GarminActivity};\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\nimport utf8 from 'utf8';\n\nclass SportsTrackerBase extends BaseService {\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n}\n\nclass SportsTrackerActivity extends SportsTrackerBase {\n    urlRe = /^https?:\\/\\/(www\\.)?sports-tracker\\.com\\/workout\\/([^/]+)\\/([a-z0-9]+)/u;\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const activityId = m[3];\n        return [\n            {\n                url: urlViaCorsProxy(\n                    `https://api.sports-tracker.com/apiserver/v1/workouts/${activityId}/data?samples=100000`\n                ),\n                options: {\n                    responseType: 'binarystring',\n                    isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403\n                }\n            },\n            {\n                url: urlViaCorsProxy(`https://api.sports-tracker.com/apiserver/v1/workouts/${activityId}/combined`),\n                options: {\n                    responseType: 'binarystring',\n                    isResponseSuccess: (xhr) => [200, 403, 404].includes(xhr.status)\n                }\n            }\n        ];\n    }\n\n    parseResponse(responses) {\n        const [dataResponse, metadataResponse] = responses;\n        if (metadataResponse.status === 404) {\n            return [{error: 'Sports Tracker activity not found'}];\n        }\n        if (dataResponse.status === 403) {\n            return [{error: 'Sports Tracker user disabled viewing this activity'}];\n        }\n        let data, metadata;\n        let name = `Sports Tracker activity`;\n        try {\n            data = JSON.parse(utf8.decode(dataResponse.responseBinaryText));\n            metadata = JSON.parse(utf8.decode(metadataResponse.responseBinaryText));\n        } catch (e) {\n            return [{name, error: 'UNSUPPORTED'}];\n        }\n        const track = data.payload.locations.map((location) => ({\n                lat: location.la,\n                lng: location.ln\n            })\n        );\n        if (data.payload.description) {\n            name = data.payload.description;\n        } else {\n            const startTime = new Date(metadata.payload.startTime).toDateString();\n            name = `${metadata.payload.fullname} on ${startTime}`;\n        }\n\n        return [{\n            name,\n            tracks: [track]\n        }];\n    }\n}\n\nexport {SportsTrackerActivity};\n","import urlViaCorsProxy from '~/lib/CORSProxy';\nimport BaseService from './baseService';\nimport parseGpx from '../parsers/gpx';\n\nclass OpenStreetMapRu extends BaseService {\n    urlRe = /^https?:\\/\\/(?:www\\.)?openstreetmap\\.ru\\/\\?mapid=(\\d+)/u;\n\n    getTrackId() {\n        const m = this.urlRe.exec(this.origUrl);\n        return m[1];\n    }\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const trackId = this.getTrackId();\n        return [{\n            url: urlViaCorsProxy(`https://openstreetmap.ru/mymap.php?id=${trackId}&format=gpx`),\n            options: {responseType: 'binarystring'}\n        }];\n    }\n\n    parseResponse(responses) {\n        const trackId = this.getTrackId();\n        const response = responses[0];\n        const geodata = parseGpx(response.responseBinaryText, `PersonalMap ${trackId}`, true);\n        if (!geodata) {\n            return [{name: name, error: 'UNSUPPORTED'}];\n        }\n        if (geodata[0].tracks.length === 0 && geodata[0].points.length === 0) {\n            return [{error: 'Personal map is empty or does not exist'}];\n        }\n        return geodata;\n    }\n}\n\nexport default OpenStreetMapRu;\n","import utf8 from 'utf8';\nimport escapeHtml from 'escape-html';\nimport {saveNktk} from './parsers/nktk';\n\nfunction saveGpx(segments, name, points, withElevations = false) {\n    const gpx = [];\n    const fakeTime = '1970-01-01T00:00:01.000Z';\n\n    gpx.push('<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\" ?>');\n    gpx.push(\n        '<gpx xmlns=\"http://www.topografix.com/GPX/1/1\" creator=\"http://nakarte.me\" ' +\n        'xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://www.topografix.com/GPX/1/1 ' +\n        'http://www.topografix.com/GPX/1/1/gpx.xsd\" version=\"1.1\">'\n    );\n    points.forEach(function(marker) {\n            var label = marker.label;\n            label = escapeHtml(label);\n            label = utf8.encode(label);\n            gpx.push(`\\t<wpt lat=\"${marker.latlng.lat.toFixed(6)}\" lon=\"${marker.latlng.lng.toFixed(6)}\">`);\n            if (withElevations && marker.latlng.alt !== null) {\n                gpx.push(`\\t\\t<ele>${marker.latlng.alt.toFixed(1)}</ele>`);\n            }\n            gpx.push(`\\t\\t<name>${label}</name>`);\n            gpx.push('\\t</wpt>');\n        }\n    );\n    if (segments.length > 0) {\n        name = name || 'Track';\n        name = escapeHtml(name);\n        name = utf8.encode(name);\n        gpx.push('\\t<trk>');\n        gpx.push('\\t\\t<name>' + name + '</name>');\n\n        for (let segment of segments) {\n            gpx.push('\\t\\t<trkseg>');\n            for (let point of segment) {\n                let x = point.lng.toFixed(6);\n                let y = point.lat.toFixed(6);\n                const elevation = (withElevations && point.alt !== null)\n                    ? `<ele>${point.alt.toFixed(1)}</ele>` : '';\n                // time element is not necessary, added for compatibility to Garmin Connect only\n                gpx.push(`\\t\\t\\t<trkpt lat=\"${y}\" lon=\"${x}\">${elevation}<time>${fakeTime}</time></trkpt>`);\n            }\n            gpx.push('\\t\\t</trkseg>');\n        }\n        gpx.push('\\t</trk>');\n    }\n    gpx.push('</gpx>');\n    return gpx.join('\\n');\n}\n\nfunction saveGpxWithElevations(segments, name, points) {\n    return saveGpx(segments, name, points, true);\n}\n\nfunction saveKml(segments, name, points) {\n    const kml = [];\n\n    name = name || 'Track';\n    name = escapeHtml(name);\n    name = utf8.encode(name);\n\n    kml.push('<?xml version=\"1.0\" encoding=\"UTF-8\"?>');\n    kml.push('<kml xmlns=\"http://www.opengis.net/kml/2.2\">');\n    kml.push('\\t<Document>');\n    kml.push(`\\t\\t<name>${name}</name>`);\n\n    for (let [i, segment] of segments.entries()) {\n        kml.push('\\t\\t<Placemark>');\n        kml.push(`\\t\\t\\t<name>Line ${(i + 1)}</name>`);\n        kml.push('\\t\\t\\t<LineString>');\n        kml.push('\\t\\t\\t\\t<tessellate>1</tessellate>');\n        kml.push('\\t\\t\\t\\t<coordinates>');\n\n        for (let point of segment) {\n            let x = point.lng.toFixed(6);\n            let y = point.lat.toFixed(6);\n            kml.push(`\\t\\t\\t\\t\\t${x},${y}`);\n        }\n\n        kml.push('\\t\\t\\t\\t</coordinates>');\n        kml.push('\\t\\t\\t</LineString>');\n        kml.push('\\t\\t</Placemark>');\n    }\n\n    points.forEach(function(marker) {\n            var label = marker.label;\n            label = escapeHtml(label);\n            label = utf8.encode(label);\n            var coordinates = marker.latlng.lng.toFixed(6) + ',' + marker.latlng.lat.toFixed(6) + ',0';\n\n            kml.push('\\t\\t<Placemark>');\n            kml.push('\\t\\t\\t<name>' + label + '</name>');\n            kml.push('\\t\\t\\t<Point>');\n            kml.push('\\t\\t\\t\\t<coordinates>' + coordinates + '</coordinates>');\n            kml.push('\\t\\t\\t</Point>');\n            kml.push('\\t\\t</Placemark>');\n        }\n    );\n\n    kml.push('\\t</Document>');\n    kml.push('\\t</kml>');\n\n    return kml.join('\\n');\n}\n\nexport {saveGpx, saveGpxWithElevations, saveKml, saveNktk as saveToString};\n\n","import L from 'leaflet';\n\nL.LineUtil.simplifyLatlngs = function simplifyLatlngs(points, tolerance) {\n    function latlngToXy(p) {\n        return {\n            x: p.lng,\n            y: p.lat\n        };\n    }\n\n    function xyToLatlng(p) {\n        return {\n            lat: p.y,\n            lng: p.x\n        };\n    }\n\n    points = points.map(latlngToXy);\n    points = L.LineUtil.simplify(points, tolerance);\n    points = points.map(xyToLatlng);\n    return points;\n};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport './edit_line.css';\nimport {wrapLatLngToTarget} from '~/lib/leaflet.fixes/fixWorldCopyJump';\n\nL.Polyline.EditMixinOptions = {\n    className: 'leaflet-editable-line'\n};\n\nL.Polyline.EditMixin = {\n    _nodeMarkersZOffset: 10000,\n\n    startEdit: function() {\n        if (this._map && !this._editing) {\n            this._editing = true;\n            this._drawingDirection = 0;\n            this.setupMarkers();\n            this.on('remove', this.stopEdit.bind(this));\n            this._map\n                .on('click', this.onMapClick, this)\n                .on('dragend', this.onMapEndDrag, this);\n            L.DomEvent.on(document, 'keyup', this.onKeyPress, this);\n            this._storedStyle = {weight: this.options.weight, opacity: this.options.opacity};\n            if (this._latlngs.length) {\n                this.setStyle({weight: 1.5, opacity: 1});\n            }\n            L.DomUtil.addClass(this._map._container, 'leaflet-line-editing');\n            this.fire('editstart', {target: this});\n        }\n    },\n\n    stopEdit: function(userCancelled) {\n        if (this._editing) {\n            this.stopDrawingLine();\n            this._editing = false;\n            this.removeMarkers();\n            L.DomEvent.off(document, 'keyup', this.onKeyPress, this);\n            this.off('remove', this.stopEdit.bind(this));\n            this._map\n                .off('click', this.onMapClick, this)\n                .off('dragend', this.onMapEndDrag, this);\n            if (this._latlngs.length) {\n                this.setStyle(this._storedStyle);\n            }\n            L.DomUtil.removeClass(this._map._container, 'leaflet-line-editing');\n            this.fire('editend', {target: this, userCancelled});\n        }\n    },\n\n    removeMarkers: function() {\n        this.getLatLngs().forEach(function(node) {\n                if (node._nodeMarker) {\n                    this.nodeMarkers.removeLayer(node._nodeMarker);\n                    delete node._nodeMarker._lineNode;\n                    delete node._nodeMarker;\n                }\n                if (node._segmentOverlay) {\n                    this.segmentOverlays.removeLayer(node._segmentOverlay);\n                    delete node._segmentOverlay._lineNode;\n                    delete node._segmentOverlay;\n                }\n            }.bind(this)\n        );\n    },\n\n    getMarkerIndex: function(marker) {\n        return this.getLatLngs().indexOf(marker._lineNode);\n    },\n\n    getSegmentOverlayIndex: function(segmentOverlay) {\n        return this.getLatLngs().indexOf(segmentOverlay._lineNode);\n    },\n\n    onNodeMarkerDragEnd: function(e) {\n        var marker = e.target,\n            nodeIndex = this.getMarkerIndex(marker);\n        this.replaceNode(nodeIndex, marker.getLatLng());\n        this._setupEndMarkers();\n    },\n\n    onNodeMarkerMovedChangeNode: function(e) {\n        var marker = e.target,\n            latlng = marker.getLatLng(),\n            node = marker._lineNode;\n        node.lat = latlng.lat;\n        node.lng = latlng.lng;\n        this.redraw();\n        this.fire('nodeschanged');\n    },\n\n    onNodeMarkerDblClickedRemoveNode: function(e) {\n        if (this._disableEditOnLeftClick) {\n            return;\n        }\n        if (this.getLatLngs().length < 2 || (this._drawingDirection && this.getLatLngs().length === 2)) {\n            return;\n        }\n        var marker = e.target,\n            nodeIndex = this.getMarkerIndex(marker);\n        this.removeNode(nodeIndex);\n        this._setupEndMarkers();\n    },\n\n    onMapClick: function(e) {\n        if (this._drawingDirection) {\n            let newNodeIndex,\n                refNodeIndex;\n            if (this._drawingDirection === -1) {\n                newNodeIndex = 1;\n                refNodeIndex = 0;\n            } else {\n                newNodeIndex = this._latlngs.length - 1;\n                refNodeIndex = this._latlngs.length - 1;\n            }\n            this.addNode(newNodeIndex, wrapLatLngToTarget(e.latlng, this._latlngs[refNodeIndex]));\n        } else {\n            if (!this.preventStopEdit) {\n                this.stopEdit(true);\n            }\n        }\n    },\n\n    onMapEndDrag: function(e) {\n        if (e.distance < 15) {\n            // get mouse position from map drag handler\n            var handler = e.target.dragging._draggable;\n            var mousePos = handler._startPoint.add(handler._newPos).subtract(handler._startPos);\n            var latlng = e.target.mouseEventToLatLng({clientX: mousePos.x, clientY: mousePos.y});\n            this.onMapClick({latlng: latlng});\n        }\n    },\n\n    startDrawingLine: function(direction, e) {\n        if (!this._editing) {\n            return;\n        }\n        if (direction === undefined) {\n            direction = 1;\n        }\n        if (this._drawingDirection === direction) {\n            return;\n        }\n        this.stopDrawingLine();\n        this._drawingDirection = direction;\n        if (e) {\n            var newNodeIndex = this._drawingDirection === -1 ? 0 : this.getLatLngs().length;\n            this.spliceLatLngs(newNodeIndex, 0, e.latlng);\n            this._setupEndMarkers();\n        }\n\n        this._map.on('mousemove', this.onMouseMoveFollowEndNode, this);\n        L.DomUtil.addClass(this._map._container, 'leaflet-line-drawing');\n        this._map.clickLocked = true;\n    },\n\n    stopDrawingLine: function() {\n        if (!this._drawingDirection) {\n            return;\n        }\n        this._map.off('mousemove', this.onMouseMoveFollowEndNode, this);\n        var nodeIndex = this._drawingDirection === -1 ? 0 : this.getLatLngs().length - 1;\n        this.spliceLatLngs(nodeIndex, 1);\n        this._drawingDirection = 0;\n        L.DomUtil.removeClass(this._map._container, 'leaflet-line-drawing');\n        this._map.clickLocked = false;\n        this._setupEndMarkers();\n        this.fire('drawend');\n    },\n\n    onKeyPress: function(e) {\n        if (e.target.tagName.toLowerCase() === 'input') {\n            return;\n        }\n        var code = e.keyCode;\n        switch (code) {\n            case 27:\n            case 13:\n                if (this._drawingDirection) {\n                    this.stopDrawingLine();\n                } else {\n                    if (!this.preventStopEdit) {\n                        this.stopEdit(true);\n                    }\n                }\n                L.DomEvent.stop(e);\n                break;\n            case 8:\n            case 46:\n                if (this._drawingDirection && this.getLatLngs().length > 2) {\n                    const nodeIndex = this._drawingDirection === 1 ? this.getLatLngs().length - 2 : 1;\n                    this.removeNode(nodeIndex);\n                    L.DomEvent.preventDefault(e);\n                }\n                break;\n\n            default:\n        }\n    },\n\n    onMouseMoveFollowEndNode: function(e) {\n        var nodeIndex = this._drawingDirection === -1 ? 0 : this.getLatLngs().length - 1;\n        let latlng = e.latlng;\n        if (this._latlngs.length > 0) {\n            latlng = wrapLatLngToTarget(latlng, this._latlngs[nodeIndex]);\n        }\n        this.spliceLatLngs(nodeIndex, 1, latlng);\n    },\n\n    makeNodeMarker: function(nodeIndex) {\n        // если кликнули по созданию нового трэка, то делаем линию тоньше только когда появятся 2 точки\n        if (this._latlngs.length === 2) {\n            this.setStyle({weight: 1.5, opacity: 1});\n        }\n        var node = this.getLatLngs()[nodeIndex],\n            marker = L.marker(node.clone(), {\n                    icon: L.divIcon({\n                        className: 'line-editor-node-marker-halo',\n                        html: '<div class=\"line-editor-node-marker\"></div>'\n                    }),\n                    draggable: true,\n                    zIndexOffset: this._nodeMarkersZOffset,\n                    projectedShift: () => this.shiftProjectedFitMapView()\n                }\n            );\n        marker\n            .on('drag', this.onNodeMarkerMovedChangeNode, this)\n            // .on('dragstart', this.fire.bind(this, 'editingstart'))\n            .on('dragend', this.onNodeMarkerDragEnd, this)\n            .on('dblclick', this.onNodeMarkerDblClickedRemoveNode, this)\n            .on('click', this.onNodeMarkerClickStartStopDrawing, this)\n            .on('contextmenu', function(e) {\n                    this.stopDrawingLine();\n                    this.fire('noderightclick', {\n                            nodeIndex: this.getMarkerIndex(marker),\n                            line: this,\n                            mouseEvent: e\n                        }\n                    );\n                }, this\n            );\n        marker._lineNode = node;\n        node._nodeMarker = marker;\n        marker.addTo(this.nodeMarkers);\n    },\n\n    onNodeMarkerClickStartStopDrawing: function(e) {\n        if (this._disableEditOnLeftClick) {\n            return;\n        }\n        var marker = e.target,\n            latlngs = this.getLatLngs(),\n            latlngs_n = latlngs.length,\n            nodeIndex = this.getMarkerIndex(marker);\n        if ((this._drawingDirection === -1 && nodeIndex === 1) ||\n            ((this._drawingDirection === 1 && nodeIndex === latlngs_n - 2))) {\n            this.stopDrawingLine();\n        } else if (nodeIndex === this.getLatLngs().length - 1) {\n            this.startDrawingLine(1, e);\n        } else if (nodeIndex === 0) {\n            this.startDrawingLine(-1, e);\n        }\n    },\n\n    makeSegmentOverlay: function(nodeIndex) {\n        const latlngs = this.getLatLngs(),\n            p1 = latlngs[nodeIndex],\n            p2 = latlngs[nodeIndex + 1];\n        if (!p2) {\n            return;\n        }\n        const segmentOverlay = L.polyline([p1, p2], {\n            weight: 10,\n            opacity: 0.0,\n            projectedShift: () => this.shiftProjectedFitMapView()\n        });\n        segmentOverlay.on('mousedown', this.onSegmentMouseDownAddNode, this);\n        segmentOverlay.on('contextmenu', function(e) {\n                this.stopDrawingLine();\n                this.fire('segmentrightclick', {\n                        nodeIndex: this.getSegmentOverlayIndex(segmentOverlay),\n                        mouseEvent: e,\n                        line: this\n                    }\n                );\n            }, this\n        );\n        segmentOverlay._lineNode = p1;\n        p1._segmentOverlay = segmentOverlay;\n        segmentOverlay.addTo(this.segmentOverlays);\n    },\n\n    onSegmentMouseDownAddNode: function(e) {\n        if (e.originalEvent.button !== 0 || this._disableEditOnLeftClick) {\n            return;\n        }\n        var segmentOverlay = e.target,\n            latlngs = this.getLatLngs(),\n            nodeIndex = this.getSegmentOverlayIndex(segmentOverlay) + 1;\n        const midPoint = L.latLngBounds(latlngs[nodeIndex], latlngs[nodeIndex - 1]).getCenter();\n        this.addNode(nodeIndex, wrapLatLngToTarget(e.latlng, midPoint));\n        if (L.Draggable._dragging) {\n            L.Draggable._dragging.finishDrag();\n        }\n        latlngs[nodeIndex]._nodeMarker.dragging._draggable._onDown(e.originalEvent);\n    },\n\n    addNode: function(index, latlng) {\n        var nodes = this.getLatLngs(),\n            isAddingLeft = (index === 1 && this._drawingDirection === -1),\n            isAddingRight = (index === nodes.length - 1 && this._drawingDirection === 1);\n        latlng = latlng.clone();\n        this.spliceLatLngs(index, 0, latlng);\n        this.makeNodeMarker(index);\n        if (!isAddingLeft && (index >= 1)) {\n            if (!isAddingRight) {\n                var prevNode = nodes[index - 1];\n                this.segmentOverlays.removeLayer(prevNode._segmentOverlay);\n                delete prevNode._segmentOverlay._lineNode;\n                delete prevNode._segmentOverlay;\n            }\n            this.makeSegmentOverlay(index - 1);\n        }\n        if (!isAddingRight) {\n            this.makeSegmentOverlay(index);\n        }\n        if (nodes.length < 3) {\n            this._setupEndMarkers();\n        }\n    },\n\n    removeNode: function(index) {\n        var nodes = this.getLatLngs(),\n            node = nodes[index],\n            marker = node._nodeMarker;\n        delete node._nodeMarker;\n        delete marker._lineNode;\n        this.spliceLatLngs(index, 1);\n        this.nodeMarkers.removeLayer(marker);\n        if (node._segmentOverlay) {\n            this.segmentOverlays.removeLayer(node._segmentOverlay);\n            delete node._segmentOverlay._lineNode;\n            delete node._segmentOverlay;\n        }\n        var prevNode = nodes[index - 1];\n        if (prevNode && prevNode._segmentOverlay) {\n            this.segmentOverlays.removeLayer(prevNode._segmentOverlay);\n            delete prevNode._segmentOverlay._lineNode;\n            delete prevNode._segmentOverlay;\n            if ((index < nodes.length - 1) || (index < nodes.length && this._drawingDirection !== 1)) {\n                this.makeSegmentOverlay(index - 1);\n            }\n        }\n    },\n\n    replaceNode: function(index, latlng) {\n        var nodes = this.getLatLngs(),\n            oldNode = nodes[index],\n            oldMarker = oldNode._nodeMarker;\n        this.nodeMarkers.removeLayer(oldNode._nodeMarker);\n        delete oldNode._nodeMarker;\n        delete oldMarker._lineNode;\n        latlng = latlng.clone();\n        this.spliceLatLngs(index, 1, latlng);\n        this.makeNodeMarker(index);\n        if (oldNode._segmentOverlay) {\n            this.segmentOverlays.removeLayer(oldNode._segmentOverlay);\n            delete oldNode._segmentOverlay._lineNode;\n            delete oldNode._segmentOverlay;\n            this.makeSegmentOverlay(index);\n        }\n        var prevNode = nodes[index - 1];\n        if (prevNode && prevNode._segmentOverlay) {\n            this.segmentOverlays.removeLayer(prevNode._segmentOverlay);\n            delete prevNode._segmentOverlay._lineNode;\n            delete prevNode._segmentOverlay;\n            this.makeSegmentOverlay(index - 1);\n        }\n    },\n\n    _setupEndMarkers: function() {\n        const nodesCount = this._latlngs.length;\n        if (nodesCount === 0) {\n            return;\n        }\n        const startIndex = this._drawingDirection === -1 ? 1 : 0;\n        const endIndex = this._drawingDirection === 1 ? nodesCount - 2 : nodesCount - 1;\n        const startIcon = this._latlngs[startIndex]._nodeMarker._icon;\n        L.DomUtil[this._drawingDirection === -1 ? 'removeClass' : 'addClass'](\n            startIcon, 'line-editor-node-marker-start'\n        );\n        if (endIndex >= 0) {\n            const endIcon = this._latlngs[endIndex]._nodeMarker._icon;\n            let func;\n            if (this._drawingDirection !== 1 && endIndex > 0) {\n                func = L.DomUtil.addClass;\n            } else {\n                func = L.DomUtil.removeClass;\n            }\n            func(endIcon, 'line-editor-node-marker-end');\n        }\n    },\n\n    setupMarkers: function() {\n        if (!this.segmentOverlays) {\n            this.segmentOverlays = L.featureGroup().addTo(this._map);\n        }\n        if (!this.nodeMarkers) {\n            this.nodeMarkers = L.featureGroup().addTo(this._map);\n        }\n        this.removeMarkers();\n        var latlngs = this.getLatLngs(),\n            startNode = 0,\n            endNode = latlngs.length - 1;\n        if (this._drawingDirection === -1) {\n            startNode += 1;\n        }\n        if (this._drawingDirection === 1) {\n            endNode -= 1;\n        }\n        for (var i = startNode; i <= endNode; i++) {\n            this.makeNodeMarker(i);\n            if (i < endNode) {\n                this.makeSegmentOverlay(i);\n            }\n        }\n        this._setupEndMarkers();\n    },\n\n    spliceLatLngs: function(...args) {\n        const latlngs = this.getLatLngs();\n        const res = latlngs.splice(...args);\n        this.setLatLngs(latlngs);\n        this.fire('nodeschanged');\n        return res;\n        // this._latlngs.splice(...args);\n        // this.redraw();\n    },\n\n    getFixedLatLngs: function() {\n        const start = this._drawingDirection === -1 ? 1 : 0;\n        let end = this._latlngs.length;\n        if (this._drawingDirection === 1) {\n            end -= 1;\n        }\n        return this._latlngs.slice(start, end);\n    },\n\n    disableEditOnLeftClick: function(disable) {\n        this._disableEditOnLeftClick = disable;\n    },\n\n    highlighNodesForDeletion: function(startNodeIndex, endNodeIndex) {\n        if (!this._editing) {\n            return;\n        }\n        const nodes = this.getLatLngs();\n        for (let i = 0; i < nodes.length; i++) {\n            const node = nodes[i];\n            const icon = node._nodeMarker._icon;\n            L.DomUtil[i >= startNodeIndex && i <= endNodeIndex ? 'addClass' : 'removeClass'](icon, 'highlight-delete');\n        }\n    }\n};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from \"leaflet\";\n\nfunction getSegmentSplitPointLat(latLng1, latLng2, lng) {\n    const deltaLat = latLng2.lat - latLng1.lat;\n    const deltaLng = latLng2.lng - latLng1.lng;\n    return latLng1.lat + deltaLat / deltaLng * (lng - latLng1.lng);\n}\n\nfunction splitLineAt180Meridian(latLngs) {\n    // this function also creates new LatLng object for all elements\n    const wrappedLatLngs = latLngs.map((ll) => ll.wrap());\n    const newLines = [];\n    if (latLngs.length < 2) {\n        return newLines;\n    }\n\n    let newLine = [wrappedLatLngs[0]];\n    newLines.push(newLine);\n    for (let i = 1; i < wrappedLatLngs.length; i++) {\n        let latLng = wrappedLatLngs[i];\n        let prevLatLng = wrappedLatLngs[i - 1];\n        if (Math.abs(latLng.lng - prevLatLng.lng) <= 180) {\n            newLine.push(latLng);\n        } else {\n            let positiveLng = L.Util.wrapNum(latLng.lng, [0, 360]);\n            let positivePrevLng = L.Util.wrapNum(prevLatLng.lng, [0, 360]);\n            let splitLng = 180 - 0.000001 * Math.sign(latLng.lng);\n            let splitPrevLng = 180 - 0.000001 * Math.sign(prevLatLng.lng);\n            let splitLat = getSegmentSplitPointLat(\n                L.latLng(prevLatLng.lat, positivePrevLng),\n                L.latLng(latLng.lat, positiveLng),\n                splitLng\n            );\n            let splitPrevLat = getSegmentSplitPointLat(\n                L.latLng(prevLatLng.lat, positivePrevLng),\n                L.latLng(latLng.lat, positiveLng),\n                splitPrevLng\n            );\n            newLine.push(L.latLng(splitPrevLat, splitPrevLng).wrap());\n            newLine = [L.latLng(splitLat, splitLng).wrap(), latLng];\n            newLines.push(newLine);\n        }\n    }\n    return newLines;\n}\n\nfunction splitLinesAt180Meridian(lines) {\n    return (lines || [])\n        .map((segment) => splitLineAt180Meridian(segment))\n        .reduce((acc, cur) => {\n            acc.push(...cur);\n            return acc;\n        }, []);\n}\n\nexport {splitLinesAt180Meridian};\n","import L from 'leaflet';\nimport './track-list';\nimport './ruler.css';\nimport {makeButton} from '~/lib/leaflet.control.commons';\n\nL.Control.TrackList.Ruler = L.Control.extend({\n    options: {\n        position: 'topleft'\n    },\n\n    initialize: function(trackList, options) {\n        L.Control.prototype.initialize.call(this, options);\n        this._trackList = trackList;\n    },\n\n    onAdd: function(map) {\n        this._map = map;\n        let {container} = makeButton('', 'Measure distance', 'icon-ruler');\n        this._container = container;\n        L.DomEvent.on(container, 'click', this.onClick, this);\n        return container;\n    },\n\n    onClick: function() {\n        this._trackList.setExpanded();\n        this._trackList.addTrackAndEdit('Ruler').measureTicksShown(true);\n    }\n\n});\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {NakarteUrlLoader} from './lib/services/nakarte';\n\nL.Control.TrackList.include({\n        hashParams: function() {\n            return new NakarteUrlLoader().paramNames();\n        },\n\n        loadTrackFromParam: async function(paramName, values) {\n            if (!values || !values.length) {\n                return;\n            }\n            this.readingFiles(this.readingFiles() + 1);\n            const geodata = await new NakarteUrlLoader().geoData(paramName, values);\n            const notEmpty = this.addTracksFromGeodataArray(geodata);\n            this.readingFiles(this.readingFiles() - 1);\n            if (notEmpty) {\n                this.setExpanded();\n            }\n        },\n    }\n);\n\n","import './track-list';\nimport L from 'leaflet';\nimport {parseNktkSequence} from './lib/parsers/nktk';\nimport safeLocalStorage from '~/lib/safe-localstorage';\nimport * as logging from '~/lib/logging';\n\nL.Control.TrackList.include({\n        maxLocalStorageSessions: 5,\n\n        saveTracksToStorage: function() {\n            var tracks = this.tracks(),\n                serialized = [],\n                maxKey = -1,\n                i, track, s, key, m,\n                keys = [];\n\n            for (i = 0; i < safeLocalStorage.length; i++) {\n                key = safeLocalStorage.key(i);\n                m = key.match(/^trackList_(\\d+)$/u);\n                if (m && m[1] !== undefined) {\n                    if (Number(m[1]) > maxKey) {\n                        maxKey = Number(m[1]);\n                    }\n                }\n            }\n            key = 'trackList_' + (maxKey + 1);\n\n            if (tracks.length === 0) {\n                safeLocalStorage.setItem(key, '');\n                return;\n            }\n            for (i = 0; i < tracks.length; i++) {\n                track = tracks[i];\n                s = this.trackToString(track);\n                serialized.push(s);\n            }\n            if (serialized.length === 0) {\n                return;\n            }\n            s = '#nktk=' + serialized.join('/');\n\n            safeLocalStorage.setItem(key, s);\n\n            // cleanup stale records\n            for (i = 0; i < safeLocalStorage.length; i++) {\n                key = safeLocalStorage.key(i);\n                m = key.match(/^trackList_(\\d+)$/u);\n                if (m && m[1] !== undefined) {\n                    keys.push(Number(m[1]));\n                }\n            }\n            if (keys.length > this.maxLocalStorageSessions) {\n                keys.sort(function(a, b) {\n                        return a - b;\n                    }\n                );\n                for (i = 0; i < keys.length - this.maxLocalStorageSessions; i++) {\n                    key = 'trackList_' + keys[i];\n                    safeLocalStorage.removeItem(key);\n                }\n            }\n        },\n\n        loadTracksFromStorage: function() {\n            var i, key, m, s,\n                geodata,\n                maxKey = -1;\n\n            for (i = 0; i < safeLocalStorage.length; i++) {\n                key = safeLocalStorage.key(i);\n                m = key.match(/^trackList_(\\d+)$/u);\n                if (m && m[1] !== undefined) {\n                    if (Number(m[1]) > maxKey) {\n                        maxKey = Number(m[1]);\n                    }\n                }\n            }\n            if (maxKey > -1) {\n                key = 'trackList_' + maxKey;\n                s = safeLocalStorage.getItem(key);\n                safeLocalStorage.removeItem(key);\n                if (s) {\n                    logging.captureBreadcrumb('load track from localStorage');\n                    s = s.slice(6); // remove \"#nktk=\" prefix\n                    geodata = parseNktkSequence(s);\n                    this.addTracksFromGeodataArray(geodata);\n                }\n            }\n        }\n    }\n);\n","import L from 'leaflet';\nimport './style.css';\nimport '~/lib/controls-styles/controls-styles.css';\nimport enableTopRow from '~/lib/leaflet.control.layers.top-row';\n\nfunction enableMinimize(control) {\n    const originalOnAdd = control.onAdd;\n    if (control._minimizeEnabled) {\n        return;\n    }\n    enableTopRow(control);\n\n    L.Util.extend(control, {\n            _minimizeEnabled: true,\n\n            onAdd: function(map) {\n                const container = originalOnAdd.call(this, map);\n                setTimeout(() => this.__injectMinimizeButtons(), 0);\n                return container;\n            },\n\n            __injectMinimizeButtons: function() {\n                const container = this._container;\n                const contentsWrapper = L.DomUtil.create('div', 'leaflet-control-content');\n                while (container.childNodes.length) {\n                    contentsWrapper.appendChild(container.childNodes[0]);\n                }\n                container.appendChild(contentsWrapper);\n                const minimizeButton = L.DomUtil.create('div', 'button-minimize');\n                this._topRow.appendChild(minimizeButton);\n                const expandButton = L.DomUtil.create('div', 'leaflet-control-button-toggle', container);\n                expandButton.title = 'Select layers';\n                L.DomEvent.on(expandButton, 'click', this.setExpanded, this);\n                L.DomEvent.on(minimizeButton, 'click', this.setMinimized, this);\n            },\n\n            setExpanded: function() {\n                L.DomUtil.removeClass(this._container, 'minimized');\n            },\n\n            setMinimized: function() {\n                L.DomUtil.addClass(this._container, 'minimized');\n            }\n        }\n    );\n    if (control._map) {\n        control.__injectMinimizeButtons();\n    }\n}\n\nexport default enableMinimize;\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport './style.css';\nimport enableTopRow from '~/lib/leaflet.control.layers.top-row';\nimport './customLayer';\n\nfunction enableConfig(control, {layers}) {\n    const originalOnAdd = control.onAdd;\n    const originalUnserializeState = control.unserializeState;\n    if (control._configEnabled) {\n        return;\n    }\n    enableTopRow(control);\n\n    L.Util.extend(control, {\n            _configEnabled: true,\n            _allLayersGroups: layers,\n            _allLayers: [].concat(...layers.map((group) => group.layers)),\n\n            onAdd: function(map) {\n                const container = originalOnAdd.call(this, map);\n                return container;\n            },\n\n            _initializeLayersState: function() {\n                this.updateEnabledLayers(); // eslint-disable-line\n            },\n\n            updateEnabledLayers: function(addedLayers) {\n                let hasBaselayerOnMap = false;\n                const enabledLayers = [...this._allLayers];\n                enabledLayers.sort((l1, l2) => l1.order - l2.order);\n                enabledLayers.forEach((l) => {\n                        l.layer._justAdded = addedLayers && addedLayers.includes(l);\n                        const {layer: {options: {isOverlay}}} = l;\n                        if (isOverlay) {\n                            this.addOverlay(l.layer, l.title);\n                        } else {\n                            this.addBaseLayer(l.layer, l.title);\n                        }\n                        if (!isOverlay && this._map.hasLayer(l.layer)) {\n                              hasBaselayerOnMap = true;\n                        }\n                    }\n                );\n                // если нет активного базового слоя, включить первый, если он есть\n                if (!hasBaselayerOnMap) {\n                    for (let layer of enabledLayers) {\n                        if (!layer.layer.options.isOverlay) {\n                            this._map.addLayer(layer.layer);\n                            break;\n                        }\n                    }\n                }\n                /* this.storeEnabledLayers(); */\n            },\n\n            unserializeState: function(values) {\n                this.updateEnabledLayers();\n                return originalUnserializeState.call(this, values);\n            },\n        }\n    );\n}\n\nexport default enableConfig;\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\n\nL.Layer.CustomLayer = L.TileLayer.extend({\n    getTileUrl: function(coords) {\n        const z = this._getZoomForUrl();\n        var data = {\n            r: L.Browser.retina ? '@2x' : '',\n            s: this._getSubdomain(coords),\n            x: coords.x,\n            y: coords.y,\n            z: z,\n            z_1: z + 1,\n            x_1024: Math.floor(coords.x / 1024),\n            y_1024: Math.floor(coords.y / 1024),\n        };\n        if (this._map && !this._map.options.crs.infinite) {\n            var invertedY = this._globalTileRange.max.y - coords.y;\n            if (this.options.tms) {\n                data['y'] = invertedY;\n                data['y_1024'] = Math.floor(invertedY / 1024);\n            }\n            data['-y'] = invertedY;\n        }\n\n        return L.Util.template(this._url, L.extend(data, this.options));\n    },\n\n    cloneForPrint: function(options) {\n        return new L.Layer.CustomLayer(this._url, L.Util.extend({}, this.options, options));\n    },\n\n});\n","import './style.css';\nimport L from 'leaflet';\n\nfunction raiseControlsOnFocus(map) {\n    const selectors = [\n        '.leaflet-top.leaflet-right',\n        '.leaflet-bottom.leaflet-right',\n        '.leaflet-top.leaflet-left',\n        '.leaflet-bottom.leaflet-left'\n    ];\n    let elements = map._container.querySelectorAll(selectors.join(','));\n\n    function raise(target) {\n        for (let cornerDiv of elements) {\n            if (cornerDiv === target) {\n                L.DomUtil.addClass(cornerDiv, 'leaflet-controls-corner-raised');\n            } else {\n                L.DomUtil.removeClass(cornerDiv, 'leaflet-controls-corner-raised');\n            }\n        }\n    }\n\n    [...elements].forEach((el) => L.DomEvent.on(el, 'mouseenter', raise.bind(null, el)));\n}\n\nexport default raiseControlsOnFocus;\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport '~/lib/leaflet.layer.yandex';\nimport '~/lib/leaflet.layer.google';\nimport '~/lib/leaflet.layer.soviet-topomaps-grid';\nimport '~/lib/leaflet.layer.wikimapia';\nimport {RetinaTileLayer} from '~/lib/leaflet.layer.RetinaTileLayer';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nconst layersDefs = [\n    {\n        title: 'OpenStreetMap',\n        description: 'OSM default style',\n        isDefault: true,\n        layer: L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n            {\n                code: 'O',\n                isOverlay: false,\n                scaleDependent: true,\n                print: true,\n                jnx: true,\n                shortName: 'osm',\n                attribution: '© Участники <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> '\n            }\n        )\n    },\n    {\n        title: 'OpenCycleMap',\n        description: '<a href=\"https://www.opencyclemap.org/docs/\">(Info and key)</a>',\n        isDefault: false,\n        layer: L.tileLayer('https://{s}.tile.thunderforest.com/cycle/{z}/{x}/{y}.png',\n            {\n                code: 'Ocm',\n                isOverlay: false,\n                scaleDependent: true,\n                print: true,\n                hotkey: 'H',\n                jnx: true,\n                shortName: 'opencyclemap',\n                attribution: 'Thunderforest <a href=\"https://www.opencyclemap.org/\">OpenCycleMap</a>'\n            }\n        )\n    },\n    {\n        title: 'OpenTopoMap',\n        isDefault: true,\n        layer: L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png',\n            {\n                code: 'Otm',\n                isOverlay: false,\n                maxNativeZoom: 17,\n                scaleDependent: true,\n                print: true,\n                jnx: true,\n                noCors: false,\n                shortName: 'opentopo',\n                attribution: '<a href=\"https://opentopomap.org/\">OpenTopoMap</a>'\n            }\n        )\n    },\n    {\n        title: 'Yandex Спутник',\n        isDefault: true,\n        layer: new L.Layer.Yandex.Sat(\n            {\n                scaleDependent: false,\n                code: 'S',\n                isOverlay: false,\n                print: true,\n                jnx: true,\n                shortName: 'yandex_sat',\n                attribution: '<a href=\"https://yandex.ru/maps/?l=sat\">Yandex</a>'\n            }\n        )\n    },\n    {\n        title: 'Google Спутник',\n        isDefault: true,\n        layer: new L.Layer.GoogleSat(\n            {\n                code: 'L',\n                isOverlay: false,\n                scaleDependent: false,\n                print: true,\n                jnx: true,\n                shortName: 'google_sat',\n                attribution: '<a href=\"https://www.google.com/maps/@45.0000194,34.336961,9z\">Google</a>'\n            }\n        )\n    },\n    {\n        title: 'ESRI Спутник',\n        isDefault: true,\n        layer: L.tileLayer(\n            'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',\n            {\n                code: 'E',\n                isOverlay: false,\n                scaleDependent: false,\n                maxNativeZoom: 18,\n                print: true,\n                jnx: true,\n                shortName: 'esri',\n                attribution: 'ESRI World Imagery for <a href=\"https://www.arcgis.com/\">ArcGIS</a>'\n            }\n        )\n    },\n    {\n        title: 'Советская карта (zoom ≥ 12)',\n        isDefault: true,\n        layer: L.tileLayer('https://{s}.tiles.nakarte.me/topo500/{z}/{x}/{y}',\n            {\n                code: 'B',\n                isOverlay: true,\n                isOverlayTransparent: false,\n                tms: true,\n                scaleDependent: false,\n                maxNativeZoom: 14,\n                minZoom: 12,\n                print: true,\n                jnx: true,\n                shortName: 'topo_500'\n            }\n        )\n    },\n    {\n        title: 'Разбивка на квадраты',\n        isDefault: true,\n        layer: new L.Layer.SovietTopoGrid({\n            code: 'Ng',\n            isOverlay: true,\n            print: false,\n            jnx: false\n        })\n    },\n    {\n        title: 'Wikimapia',\n        isDefault: true,\n        layer: new L.Wikimapia({\n            code: 'W',\n            hotkey: 'W',\n            isOverlay: true,\n            print: false,\n            jnx: false\n        })\n    },\n    {\n        title: 'OpenStreetMap GPS трэки',\n        isDefault: false,\n        layer: L.tileLayer('https://{s}.gps-tile.openstreetmap.org/lines/{z}/{x}/{y}.png',\n            {\n                code: 'Ot',\n                isOverlay: true,\n                isOverlayTransparent: true,\n                scaleDependent: true,\n                print: true,\n                jnx: false,\n                shortName: 'osm_gps_traces'\n            }\n        )\n    },\n    {\n        title: 'Strava трэки',\n        isDefault: false,\n        layer: new RetinaTileLayer(\n            [\n                urlViaCorsProxy(\n                    'https://heatmap-external-a.strava.com/tiles-auth/all/hot/{z}/{x}/{y}.png?px=256'\n                ),\n                urlViaCorsProxy(\n                    'https://heatmap-external-a.strava.com/tiles-auth/all/hot/{z}/{x}/{y}.png?px=512'\n                ),\n            ],\n            {\n                code: 'Sa',\n                hotkey: 'T',\n                isOverlay: true,\n                isOverlayTransparent: true,\n                scaleDependent: false,\n                print: true,\n                jnx: false,\n                subdomains: 'abc',\n                noCors: true,\n                shortName: 'strava_all',\n                retinaOptionsOverrides: [{maxNativeZoom: 16}, {maxNativeZoom: 15}],\n            }\n        )\n    },\n    {\n        title: 'Маркированные маршруты',\n        description: '<a href=\"https://hiking.waymarkedtrails.org/\">https://hiking.waymarkedtrails.org</a>',\n        isDefault: false,\n        layer: L.tileLayer('https://tile.waymarkedtrails.org/hiking/{z}/{x}/{y}.png',\n            {\n                code: 'Wh',\n                isOverlay: true,\n                tms: false,\n                print: true,\n                jnx: false,\n                scaleDependent: true,\n                shortName: 'hiking_trails',\n                isOverlayTransparent: true\n            })\n    },\n    {\n        title: 'Yandex трэки (zoom ≥ 10)',\n        isDefault: false,\n        layer: new L.Layer.Yandex.Tracks(\n            {\n                scaleDependent: true,\n                code: 'Ytr',\n                isOverlay: true,\n                isOverlayTransparent: true,\n                print: true,\n                jnx: false,\n                shortName: 'yandex_tracks',\n                noCors: true,\n            }\n        )\n    },\n];\n\nfunction getLayers() {\n    // set metadata\n    for (let layer of layersDefs) {\n        layer.layer.meta = {title: layer.title};\n    }\n\n    // divide layers by groups\n    const grouppedLayers = [];\n    let group = {group: 'title', layers: layersDefs};\n    grouppedLayers.push(group);\n\n    return {\n        layers: grouppedLayers,\n    };\n}\n\nexport {getLayers};\n","import L from 'leaflet';\nimport './style.css';\nimport Contextmenu from '~/lib/contextmenu';\nimport copyToClipboard from '~/lib/clipboardCopy';\n\nfunction zeroPad(num, size) {\n    var s = String(num);\n    while (s.length < size) {\n        s = \"0\" + s;\n    }\n    return s;\n}\n\nconst bigLetterReplacers = [\n    /* eslint-disable quote-props */\n    {\n        '1': 'А',\n        '2': 'Б',\n        '3': 'В',\n        '4': 'Г'\n    },\n    {\n        '1': 'A',\n        '2': 'B',\n        '3': 'C',\n        '4': 'D'\n    }\n    /* eslint-enable quote-props */\n];\n\nvar Nomenclature = {\n    getQuadName1m: function(column, row, join) {\n        var name = '';\n        if (row < 0) {\n            row = -row - 1;\n            name += 'x';\n        }\n        column += 31;\n        name += 'ABCDEFGHIJKLMNOPQRSTUV'[row] + '-' + zeroPad(column, 2);\n        for (var n = 1; n <= join - 1; n++) {\n            name += ',' + zeroPad(column + n, 2);\n        }\n        return [name];\n    },\n\n    getQuadName500k: function(column, row, join) {\n        var name1 = this.getQuadName1m(Math.floor(column / 2), Math.floor(row / 2), 1)[0];\n        var subquad = 2 - (row & 1) * 2 + (column & 1) + 1;\n        let name2 = '-' + subquad;\n        if (join > 1) {\n            name2 += ',' + (subquad + 1);\n        }\n        if (join === 4) {\n            name2 +=\n                ',' + this.getQuadName1m(Math.floor((column + 2) / 2), Math.floor(row / 2), 1) + '-' + subquad +\n                ',' + (subquad + 1);\n        }\n        const names = [name1 + name2];\n        for (let replacer of bigLetterReplacers) {\n            let name3 = name2.replace(/\\b[1-4]\\b/gu, (s) => replacer[s]);\n            names.push(name1 + name3);\n        }\n        return names;\n    },\n\n    getQuadName100k: function(column, row, join) {\n        var name = this.getQuadName1m(Math.floor(column / 12), Math.floor(row / 12), 1);\n        const subRow = row - Math.floor(row / 12) * 12;\n        const subColumn = column - Math.floor(column / 12) * 12;\n        var subquad = 132 - subRow * 12 + subColumn + 1;\n        name = name + '-' + zeroPad(subquad, 3);\n        if (join > 1) {\n            name += ',' + zeroPad(subquad + 1, 3);\n        }\n        if (join === 4) {\n            name += ',' + zeroPad(subquad + 2, 3) + ',' + zeroPad(subquad + 3, 3);\n        }\n\n        return [name];\n    },\n\n    getQuadName050k: function(column, row, join) {\n        var name1 = this.getQuadName100k(Math.floor(column / 2), Math.floor(row / 2), 1);\n        var subquad = 2 - (row & 1) * 2 + (column & 1) + 1;\n        let name2 = '-' + subquad;\n        if (join > 1) {\n            name2 += ',' + (subquad + 1);\n        }\n        if (join === 4) {\n            name2 += ',' + this.getQuadName100k(Math.floor((column + 2) / 2), Math.floor(row / 2), 1) + '-' +\n                subquad + ',' + (subquad + 1);\n        }\n        const names = [name1 + name2];\n        for (let replacer of bigLetterReplacers) {\n            let name3 = name2.replace(/\\b[1-4]\\b/gu, (s) => replacer[s]);\n            names.push(name1 + name3);\n        }\n        return names;\n    },\n\n    _getQuads: function(bounds, row_height, column_width, name_factory) {\n        bounds = L.latLngBounds(bounds);\n        var quads = [];\n        var min_lat = Math.max(bounds.getSouth(), -84);\n        var max_lat = Math.min(bounds.getNorth(), 84);\n        var min_row = Math.floor(min_lat / row_height);\n        const maxCols = 360 / column_width;\n        for (var row = min_row; row * row_height < max_lat; row++) {\n            var row_south = row * row_height;\n            var row_north = row_south + row_height;\n            var joined_quads;\n            if (row_south >= 76 || row_north <= -76) {\n                joined_quads = 4;\n            } else if (row_south >= 60 || row_north <= -60) {\n                joined_quads = 2;\n            } else {\n                joined_quads = 1;\n            }\n            var min_lon = bounds.getWest();\n            var max_lon = bounds.getEast();\n            var min_column = Math.floor((min_lon + 180) / column_width / joined_quads) * joined_quads -\n                Math.round(180 / column_width);\n            for (var column = min_column; column * column_width < max_lon; column += joined_quads) {\n                var column_west = column * column_width;\n                var column_east = column_west + column_width * joined_quads;\n                var quad_bounds = L.latLngBounds([[row_south, column_west], [row_north, column_east]]);\n                // shift column to positive numbers, calc modulo, shift back\n                const wrappedColumn = ((column + maxCols / 2) % maxCols + maxCols) % maxCols - maxCols / 2;\n                var names = name_factory(wrappedColumn, row, joined_quads);\n                quads.push({names: names, bounds: quad_bounds});\n            }\n        }\n        return quads;\n    },\n\n    getQuads1m: function(bounds) {\n        return this._getQuads(bounds, 4, 6, this.getQuadName1m);\n    },\n\n    getQuads500k: function(bounds) {\n        return this._getQuads(bounds, 2, 3, this.getQuadName500k.bind(this));\n    },\n\n    getQuads100k: function(bounds) {\n        return this._getQuads(bounds, 4 / 12, 6 / 12, this.getQuadName100k.bind(this));\n    },\n\n    getQuads050k: function(bounds) {\n        return this._getQuads(bounds, 4 / 12 / 2, 6 / 12 / 2, this.getQuadName050k.bind(this));\n    }\n\n};\n\nL.Layer.SovietTopoGrid = L.LayerGroup.extend({\n        options: {},\n\n        initialize: function(options) {\n            L.LayerGroup.prototype.initialize.call(this);\n            L.Util.setOptions(this, options);\n            this.renderer = L.svg({padding: 0.5});\n            this._quads = {};\n            this._updateRenderer = L.Util.throttle(this._updateRenderer, 100, this);\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            map.on('zoomend', this._reset, this);\n            map.on('move', this._update, this);\n            map.on('move', this._updateRenderer, this);\n            this._update();\n        },\n\n        onRemove: function(map) {\n            map.off('zoomend', this._reset, this);\n            map.off('move', this._update, this);\n            this._cleanupQuads(true);\n        },\n\n        _addQuad: function(bounds, id, titles, color, layer, scale) {\n            if (id in this._quads) {\n                return;\n            }\n            var rect_options = {\n                smoothFactor: 0,\n                noClip: true,\n                interactive: false,\n                fill: false,\n                opacity: {1: 0.7, 2: 0.4}[layer],\n                color: color,\n                weight: {1: 1, 2: 3}[layer],\n                renderer: this.renderer\n            };\n\n            var rect = L.rectangle(bounds, rect_options);\n            this.addLayer(rect);\n            if (layer === 1) {\n                rect.bringToBack();\n            }\n            var objects = [rect];\n            const title = titles[0].replace(/-/gu, ' &ndash; ');\n            var html = L.Util.template(`<span style=\"color:{color}\">{title}</span>`, {color: color, title: title});\n            var icon = L.divIcon({html: html, className: 'leaflet-sovietgrid-quadtitle-' + layer, iconSize: null});\n            var marker = L.marker(L.latLngBounds(bounds).getCenter(), {icon: icon});\n            this.addLayer(marker);\n            objects.push(marker);\n            this._quads[id] = objects;\n            marker.on('click contextmenu', this._showContextMenu.bind(this, scale, titles));\n        },\n\n        _showContextMenu: function(scale, titles, e) {\n            const scaleString = {\n                '1m': '1:1 000 000',\n                '500k': '1:500 000',\n                '100k': '1:100 000',\n                '050k': '1:50 000'\n            }[scale];\n            const items = [\n                {text: scaleString, header: true},\n                {text: 'Копировать в буфер обмена', header: true},\n                {\n                    text: titles[0],\n                    callback: () => {\n                        copyToClipboard(titles[0], e.originalEvent);\n                    }\n                }\n            ];\n            if (titles.length > 1) {\n                items.push({\n                        text: titles[1] + ' <span class=\"leaflet-sovietgrid-lang\">RUS</span>',\n                        callback: () => {\n                            copyToClipboard(titles[1], e.originalEvent);\n                        }\n                    }\n                );\n                items.push({\n                        text: titles[2] + ' <span class=\"leaflet-sovietgrid-lang\">LAT</span>',\n                        callback: () => {\n                            copyToClipboard(titles[2], e.originalEvent);\n                        }\n                    }\n                );\n            }\n            const menu = new Contextmenu(items);\n            menu.show(e);\n        },\n\n        _removeQuad: function(id) {\n            this._quads[id].forEach(this.removeLayer.bind(this));\n            delete this._quads[id];\n        },\n\n        _addQuads: function(quads, scale, color, layer) {\n            quads.forEach(function(quad) {\n                    var id = scale + quad.names[0];\n                    this._addQuad(quad.bounds, id, quad.names, color, layer, scale);\n                }.bind(this)\n            );\n        },\n\n        _addGrid: function() {\n            var quads;\n            var layer;\n            var map_bbox = this._map.getBounds();\n            var zoom = this._map.getZoom();\n\n            if (zoom >= 10) {\n                quads = Nomenclature.getQuads050k(map_bbox);\n                layer = (zoom >= 12) ? 2 : 1;\n                this._addQuads(quads, '050k', '#50d', layer);\n            }\n\n            if (zoom >= 8 && zoom < 12) {\n                quads = Nomenclature.getQuads100k(map_bbox);\n                layer = (zoom >= 10) ? 2 : 1;\n                this._addQuads(quads, '100k', '#d50', layer);\n            }\n\n            if (zoom >= 6 && zoom < 10) {\n                quads = Nomenclature.getQuads500k(map_bbox);\n                layer = (zoom >= 8) ? 2 : 1;\n                this._addQuads(quads, '500k', '#099', layer);\n            }\n\n            if (zoom >= 4 && zoom < 8) {\n                layer = (zoom >= 6) ? 2 : 1;\n                quads = Nomenclature.getQuads1m(map_bbox);\n                this._addQuads(quads, '1m', 'blue', layer);\n            }\n        },\n\n        _reset: function() {\n            this._update(true);\n        },\n\n        _cleanupQuads: function(reset) {\n            if (reset === true) {\n                this.clearLayers();\n                this._quads = {};\n            } else {\n                var map_bbox = this._map.getBounds();\n                for (var quad_id of Object.keys(this._quads)) {\n                    var rect = this._quads[quad_id][0];\n                    if (!map_bbox.intersects(rect.getBounds())) {\n                        this._removeQuad(quad_id);\n                    }\n                }\n            }\n        },\n\n        _updateRenderer: function() {\n            if (this.renderer._map) {\n                this.renderer._update();\n            }\n        },\n\n        _update: function(reset) {\n            this._cleanupQuads(reset);\n            this._addGrid();\n        }\n    }\n);\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {WikimapiaLoader} from './wikimapia-loader';\nimport './style.css';\nimport {openPopupWindow} from '~/lib/popup-window';\n\nfunction isPointInPolygon(polygon, p) {\n    var inside = false;\n    var prevNode = polygon[polygon.length - 1],\n        node, i;\n    for (i = 0; i < polygon.length; i++) {\n        node = polygon[i];\n        if (\n            ((node[0] <= p[0] && p[0] < prevNode[0]) || (prevNode[0] <= p[0] && p[0] < node[0])) &&\n            p[1] < (prevNode[1] - node[1]) * (p[0] - node[0]) / (prevNode[0] - node[0]) + node[1]\n        ) {\n            inside = !inside;\n        }\n        prevNode = node;\n    }\n    return inside;\n}\n\nL.Wikimapia = L.GridLayer.extend({\n        options: {\n            tileSize: 1024,\n            updateWhenIdle: true\n        },\n\n        initialize: function(options) {\n            L.GridLayer.prototype.initialize.call(this, options);\n            this.loader = null;\n        },\n\n        onAdd: function(map) {\n            if (!this.loader) {\n                this.loader = new WikimapiaLoader(map);\n            }\n            L.GridLayer.prototype.onAdd.call(this, map);\n            this.on('tileunload', this.onTileUnload, this);\n            map.on('mousemove', this.onMouseMove, this);\n            map.on('click', this.onClick, this);\n        },\n\n        onRemove: function(map) {\n            map.off('mousemove', this.onMouseMove, this);\n            map.off('click', this.onClick, this);\n            if (this.highlightedPlace) {\n                this._map.removeLayer(this.highlightedPlace.polygon);\n                this._map.removeLayer(this.highlightedPlace.label);\n                this.highlightedPlace = null;\n            }\n            L.TileLayer.prototype.onRemove.call(this, map);\n            this.off('tileunload', this.onTileUnload, this);\n        },\n\n        drawTile: function(canvas) {\n            if (!this._map) {\n                return;\n            }\n            const\n                tileData = canvas._tileData,\n                adjustment = canvas._adjustment;\n            if (!tileData) {\n                return;\n            }\n\n            const canvasCtx = canvas.getContext('2d');\n            canvasCtx.beginPath();\n            canvasCtx.strokeStyle = '#CFA600';\n            canvasCtx.lineWidth = 1;\n            for (let place of tileData.places) {\n                let polygon = place.localPolygon;\n                if (!polygon) {\n                    continue;\n                }\n                if (adjustment) {\n                    let {multiplier, offsetX, offsetY} = adjustment,\n                        polygon2 = [];\n                    for (let i = 0; i < polygon.length; i++) {\n                        let p = polygon[i];\n                        polygon2.push({\n                                x: p.x * multiplier - offsetX,\n                                y: p.y * multiplier - offsetY\n                            }\n                        );\n                    }\n                    polygon = polygon2;\n                }\n                canvasCtx.moveTo(polygon[0].x, polygon[0].y);\n                let p;\n                for (let i = 1; i < polygon.length; i++) {\n                    p = polygon[i];\n                    canvasCtx.lineTo(p.x, p.y);\n                }\n                canvasCtx.lineTo(polygon[0].x, polygon[0].y);\n            }\n            canvasCtx.stroke();\n        },\n\n        createTile: function(coords, done) {\n            const canvas = L.DomUtil.create('canvas', 'leaflet-tile');\n            canvas.width = this.options.tileSize;\n            canvas.height = this.options.tileSize;\n            let {dataPromise, abortLoading} = this.loader.requestTileData(coords);\n            dataPromise.then((data) => {\n                if (!data.error) {\n                    canvas._tileData = data.tileData;\n                    canvas._adjustment = data.adjustment;\n                    this.drawTile(canvas);\n                    this._tileOnLoad(done, canvas);\n                }\n            });\n\n            canvas._abortLoading = abortLoading;\n            return canvas;\n        },\n\n        _tileOnLoad: function(done, tile) {\n            // For https://github.com/Leaflet/Leaflet/issues/3332\n            if (L.Browser.ielt9) {\n                setTimeout(L.bind(done, this, null, tile), 0);\n            } else {\n                done(null, tile);\n            }\n        },\n\n        onTileUnload: function(e) {\n            const tile = e.tile;\n            tile._abortLoading();\n            delete tile._tileData;\n            delete tile._adjustment;\n        },\n\n        _tileCoordsFromEvent: function(e) {\n            const layerPoint = this._map.getPixelOrigin().add(e.layerPoint);\n            const tileSize = this.options.tileSize;\n            let coords = {\n                x: Math.floor(layerPoint.x / tileSize),\n                y: Math.floor(layerPoint.y / tileSize),\n                z: this._map.getZoom()\n            };\n\n            return coords;\n        },\n\n        getPlaceAtMousePos: function(e) {\n            const tileCoords = this._tileCoordsFromEvent(e);\n            let tile = this._tiles[this._tileCoordsToKey(tileCoords)];\n            if (!tile) {\n                return null;\n            }\n            const tileData = tile.el._tileData;\n            if (!tileData) {\n                return null;\n            }\n            return this.getPlaceAtLatlng(e.latlng.wrap(), tileData.places);\n        },\n\n        onMouseMove: function(e) {\n            const place = this.getPlaceAtMousePos(e);\n            if (this.highlightedPlace && (!place || this.highlightedPlace.id !== place.id)) {\n                this._map.removeLayer(this.highlightedPlace.polygon);\n                this._map.removeLayer(this.highlightedPlace.label);\n                this.highlightedPlace = null;\n            }\n\n            if (place && !this.highlightedPlace) {\n                this.highlightedPlace = {\n                    id: place.id,\n                    polygon: L.polygon(place.polygon, {\n                            weight: 0,\n                            color: '#E6B800'\n                        }\n                    ),\n                    label: L.tooltip({className: 'wikimapia-tooltip-wrapper'}, null)\n                };\n                this.highlightedPlace.label.setLatLng(e.latlng);\n                this.highlightedPlace.polygon.addTo(this._map).bringToBack();\n                this.highlightedPlace.label.setContent(`<div class=\"wikimapia-tooltip\">${place.title}</div>`);\n                this._map.addLayer(this.highlightedPlace.label);\n            }\n            if (this.highlightedPlace) {\n                this.highlightedPlace.label.setLatLng(e.latlng);\n            }\n        },\n\n        onClick: function(e) {\n            if (this._map.clickLocked) {\n                return;\n            }\n            const place = this.getPlaceAtMousePos(e);\n            if (place) {\n                const url = `http://wikimapia.org/${place.id}/ru/`;\n                openPopupWindow(url, 564, 'wikimapia-details');\n            }\n        },\n\n        getPlaceAtLatlng: function(latlng, places) {\n            let {lat, lng} = latlng,\n                bounds, place;\n            for (let i = places.length - 1; i >= 0; i--) {\n                place = places[i];\n                bounds = place.boundsWESN;\n                if (lng >= bounds[0] && lng <= bounds[1] && lat >= bounds[2] && lat <= bounds[3] &&\n                    isPointInPolygon(place.polygon, [lat, lng])) {\n                    return place;\n                }\n            }\n            return null;\n        }\n\n    }\n);\n","import {TiledDataLoader} from '~/lib/tiled-data-loader';\nimport * as wmUtils from './wm-utils';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nclass WikimapiaLoader extends TiledDataLoader {\n    maxZoom = 15;\n    minZoom = 1;\n    tileSize = 1024;\n\n    constructor(projectObj) {\n        super();\n        this._projectObj = projectObj;\n    }\n\n    getFromCache(dataTileCoords) {\n        dataTileCoords = {...dataTileCoords};\n        let exactMatch = true;\n        while (dataTileCoords.z >= 0) {\n            let key = this.makeTileKey(dataTileCoords);\n            let res = this._cache.get(key);\n            if (res.found) {\n                if (exactMatch || !res.value.hasChildren) {\n                    res['coords'] = dataTileCoords;\n                    return res;\n                }\n                break;\n            }\n            dataTileCoords.z -= 1;\n            dataTileCoords.x = Math.floor(dataTileCoords.x / 2);\n            dataTileCoords.y = Math.floor(dataTileCoords.y / 2);\n            exactMatch = false;\n        }\n        return {found: false};\n    }\n\n    layerTileToDataTileCoords(layerTileCoords) {\n        let z = layerTileCoords.z - 2;\n        if (z > this.maxZoom) {\n            let z2 = this.maxZoom,\n                multiplier = 1 << (z - z2);\n            return {\n                x: Math.floor(layerTileCoords.x / multiplier),\n                y: Math.floor(layerTileCoords.y / multiplier),\n                z: z2\n            };\n        } else if (z < this.minZoom) {\n            let z2 = this.minZoom,\n                multiplier = 1 / (1 << (z2 - z));\n            return {\n                x: Math.floor(layerTileCoords.x / multiplier),\n                y: Math.floor(layerTileCoords.y / multiplier),\n                z: z2\n            };\n        }\n        return {z, x: layerTileCoords.x, y: layerTileCoords.y};\n    }\n\n    makeRequestData(dataTileCoords) {\n        let url = wmUtils.makeTileUrl(dataTileCoords);\n        url = urlViaCorsProxy(url);\n        return {\n            url,\n            options: {timeout: 20000}\n        };\n    }\n\n    processResponse(xhr) {\n        return wmUtils.parseTile(xhr.response, this._projectObj)\n            .then((tileData) => ({\n                        tileData,\n                        coords: tileData.coords\n            }));\n    }\n\n    calcAdjustment(layerTileCoords, dataTileCoords) {\n        const adjustment = super.calcAdjustment(\n            {x: layerTileCoords.x, y: layerTileCoords.y, z: layerTileCoords.z - 2},\n            dataTileCoords\n        );\n        if (adjustment) {\n            adjustment.offsetX *= 1024;\n            adjustment.offsetY *= 1024;\n        }\n        return adjustment;\n    }\n}\n\nexport {WikimapiaLoader};\n","import L from 'leaflet';\n\n// (1233,130,5) -> \"032203\"\nfunction getTileId({x, y, z}) {\n    let id = [];\n    y = (1 << z) - y - 1;\n    z += 1;\n    while (z) {\n        id.push((x & 1) + (y & 1) * 2);\n        x >>= 1;\n        y >>= 1;\n        z -= 1;\n    }\n    return id.reverse().join('');\n}\n\nfunction makeTileUrl(coords) {\n    const\n        tileId = getTileId(coords),\n        urlPath = tileId.replace(/(\\d{3})(?!$)/gu, '$1/'); // \"033331022\" -> \"033/331/022\"\n    return `http://wikimapia.org/z1/itiles/${urlPath}.xy?342342`;\n}\n\nfunction tileIdToCoords(tileId) {\n    const z = tileId.length - 1;\n    let x = 0,\n        y = 0;\n    for (let i = 0; i < tileId.length; i++) {\n        let c = parseInt(tileId[i], 10);\n        x <<= 1;\n        y <<= 1;\n        x += c & 1;\n        y += c >> 1;\n    }\n    y = (1 << z) - y - 1;\n    return {x, y, z};\n}\n\nfunction getWikimapiaTileCoords(coords, viewTileSize) {\n    let z = coords.z - 2;\n    if (z < 0) {\n        z = 0;\n    }\n    if (z > 15) {\n        z = 15;\n    }\n    const q = 2 ** (z - coords.z + Math.log2(viewTileSize / 256));\n    let x = Math.floor(coords.x * q),\n        y = Math.floor(coords.y * q);\n    return {x, y, z};\n}\n\nfunction decodeTitles(s) {\n    const titles = {};\n    for (let title of s.split('\\x1f')) {\n        if (title.length > 2) {\n            let langCode = title.charCodeAt(0) - 32;\n            titles[langCode.toString()] = title.substring(1);\n        }\n    }\n    return titles;\n}\n\nfunction chooseTitle(titles) {\n    var popularLanguages = ['1', '0', '3', '2', '5', '4', '9', '28', '17', '27'];\n    for (let langCode of popularLanguages) {\n        if (langCode in titles) {\n            return titles[langCode];\n        }\n    }\n    for (let langCode of Object.keys(titles)) {\n        return titles[langCode];\n    }\n    return \"\";\n}\n\nfunction decodePolygon(s) {\n    var i = 0,\n        coords = [],\n        lat = 0,\n        lng = 0;\n    while (i < s.length) {\n        var p,\n            l = 0,\n            c = 0;\n        do {\n            p = s.charCodeAt(i++) - 63; // eslint-disable-line no-plusplus\n            c |= (p & 31) << l;\n            l += 5;\n        } while (p >= 32);\n        lng += c & 1 ? ~(c >> 1) : c >> 1;\n        l = 0;\n        c = 0;\n        do {\n            p = s.charCodeAt(i++) - 63; // eslint-disable-line no-plusplus\n            c |= (p & 31) << l;\n            l += 5;\n        } while (p >= 32);\n        lat += c & 1 ? ~(c >> 1) : c >> 1;\n        coords.push([lat / 1e6, lng / 1e6]);\n    }\n    return coords;\n}\n\nfunction makeCoordsLocal(line, tileCoords, projectObj) {\n    const {x: tileX, y: tileY, z: tileZ} = tileCoords,\n        x0 = tileX * 1024,\n        y0 = tileY * 1024,\n        localCoords = [];\n    let latlon, p;\n    for (let i = 0; i < line.length; i++) {\n        latlon = line[i];\n        p = projectObj.project(latlon, tileZ + 2);\n        p.x -= x0;\n        p.y -= y0;\n        localCoords.push(p);\n    }\n    return localCoords;\n}\n\nfunction asap() {\n    return new Promise((resolve) => setTimeout(resolve, 0));\n}\n\nfunction simplifyPolygon(latlngs, tileCoords, tileHasChildren, projectObj) {\n    const\n        x = tileCoords.x * 1024,\n        y = tileCoords.y * 1024,\n        p0 = projectObj.unproject([x, y], tileCoords.z + 2),\n        p1 = projectObj.unproject([x + 1, y + 1], tileCoords.z + 2);\n    let pixelDegSize = p0.lat - p1.lat;\n    if (!tileHasChildren && tileCoords.z < 15) {\n        pixelDegSize /= (1 << (15 - tileCoords.z));\n    }\n    let points = [];\n    for (let i = 0; i < latlngs.length; i++) {\n        let ll = latlngs[i];\n        points.push({x: ll[0], y: ll[1]});\n    }\n    points = L.LineUtil.simplify(points, pixelDegSize * 2);\n    latlngs = [];\n    for (let i = 0; i < points.length; i++) {\n        let p = points[i];\n        latlngs.push([p.x, p.y]);\n    }\n    return latlngs;\n}\n\nasync function parseTile(s, projectObj) {\n    const tile = {};\n    const places = tile.places = [];\n    const lines = s.split('\\n');\n    if (lines.length < 1) {\n        throw new Error('No data in tile');\n    }\n    const fields = lines[0].split('|');\n    const tileId = fields[0];\n    if (!tileId || !tileId.match(/^[0-3]+$/u)) {\n        throw new Error('Invalid tile header');\n    }\n    tile.tileId = tileId;\n    tile.coords = tileIdToCoords(tileId);\n    tile.hasChildren = fields[1] === '1';\n\n    // FIXME: ignore some errors\n    let prevTime = Date.now();\n    for (let line of lines.slice(2)) {\n        let curTime = Date.now();\n        if (curTime - prevTime > 20) {\n            await asap();\n            prevTime = Date.now();\n        }\n        const place = {};\n        const fields = line.split('|');\n        if (fields.length < 6) {\n            continue;\n        }\n        let placeId = fields[0];\n        if (!placeId.match(/^\\d+$/u)) {\n            // throw new Error('Invalid place id');\n            continue;\n        }\n        place.id = parseInt(placeId, 10);\n        place.title = chooseTitle(decodeTitles(fields[5]));\n        if (fields[6] !== '1') {\n            throw new Error(`Unknown wikimapia polygon encoding type: \"${fields[6]}\"`);\n        }\n\n        let bounds = fields[2].match(/^([-\\d]+),([-\\d]+),([-\\d]+),([-\\d]+)$/u);\n        if (!bounds) {\n            throw new Error('Invalid place bounds');\n        }\n        place.boundsWESN = bounds.slice(1).map((x) => parseInt(x, 10) / 1e7);\n\n        let coords = fields.slice(7).join('|');\n\n        coords = decodePolygon(coords);\n        if (coords.length < 3) {\n            throw new Error(`Polygon has ${coords.length} points`);\n        }\n        let polygon = simplifyPolygon(coords, tile.coords, tile.hasChildren, projectObj);\n        place.polygon = polygon;\n        place.localPolygon = makeCoordsLocal(polygon, tile.coords, projectObj);\n        places.push(place);\n    }\n    return tile;\n}\n\n// быстрое проектирование полигонов\n// TODO: каждые 50-100 мс отдавать управление\n// projectPlacesForZoom: function(tile, viewZoom) {\n//     if (viewZoom < tile.coords.z) {\n//         throw new Error('viewZoom < tile.zoom');\n//     }\n//     if (tile.places && tile.places[0] && tile.places[0].projectedPolygons &&\n//         tile.places[0].projectedPolygons[viewZoom]) {\n//         return;\n//     }\n//     const virtualTileSize = 256 * (2 ** (viewZoom - tile.coords.z));\n//     const p1 = L.point([tile.coords.x * virtualTileSize, tile.coords.y * virtualTileSize]),\n//         p2 = L.point([(tile.coords.x + 1) * virtualTileSize, (tile.coords.y + 1) * virtualTileSize]),\n//         latlng1 = this._map.unproject(p1, viewZoom),\n//         latlng2 = this._map.unproject(p2, viewZoom),\n//         lat0 = latlng1.lat,\n//         lng0 = latlng1.lng;\n//     const qx = (p2.x - p1.x) / (latlng2.lng - latlng1.lng),\n//         qy = (p2.y - p1.y) / (latlng2.lat - latlng1.lat);\n//\n//     const offsets = [],\n//         offsetsStep = virtualTileSize / 64;\n//     const y0 = p1.y;\n//     for (let y = -virtualTileSize; y <= 2 * virtualTileSize; y += offsetsStep) {\n//         let lat = y / qy + lat0;\n//         let offset = this._map.project([lat, lng0], viewZoom).y - y0 - y;\n//         offsets.push(offset);\n//     }\n//\n//     let ll, offset, offsetPos, offsetIndex, offsetIndexDelta, x, y;\n//     const x0 = p1.x;\n//     for (let place of tile.places) {\n//         let polygon = place.polygon;\n//         if (polygon.length < 3) {\n//             continue;\n//         }\n//         let projectedPolygon = [];\n//         for (let i = 0; i < polygon.length; i++) {\n//             ll = polygon[i];\n//             x = (ll[1] - lng0) * qx;\n//             y = (ll[0] - lat0) * qy;\n//             offsetPos = (y + virtualTileSize) / offsetsStep;\n//             offsetIndex = Math.floor(offsetPos);\n//             offsetIndexDelta = offsetPos - offsetIndex;\n//             offset = offsets[offsetIndex] * (1 - offsetIndexDelta) + offsets[offsetIndex + 1] * offsetIndexDelta;\n//             projectedPolygon.push([x + x0, y + offset + y0]);\n//         }\n//         projectedPolygon = projectedPolygon.map(L.point);\n//         projectedPolygon = L.LineUtil.simplify(projectedPolygon, 1.5);\n//         if (!place.projectedPolygons) {\n//             place.projectedPolygons = [];\n//         }\n//         place.projectedPolygons[viewZoom] = projectedPolygon;\n//     }\n// },\n\nexport {getTileId, getWikimapiaTileCoords, parseTile, makeTileUrl};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport '~/lib/leaflet.control.commons';\n\nconst originalLayerOnAdd = L.Control.Layers.prototype.onAdd;\n\nL.Control.Layers.include({\n    onAdd: function(map) {\n        const container = originalLayerOnAdd.call(this, map);\n        this._stopContainerEvents();\n        return container;\n    }\n});\n\nconst originalZoomOnAdd = L.Control.Zoom.prototype.onAdd;\n\nL.Control.Zoom.include({\n    onAdd: function(map) {\n        const container = originalZoomOnAdd.call(this, map);\n        this._container = container;\n        this._stopContainerEvents();\n        return container;\n    }\n});\n","import L from 'leaflet';\nimport ko from 'knockout';\nimport './style.css';\nimport '~/lib/leaflet.control.commons';\nimport {RectangleSelect} from './selector';\nimport Contextmenu from '~/lib/contextmenu';\nimport {makeJnxFromLayer, minZoom} from './jnx-maker';\nimport {saveAs} from '~/vendored/github.com/eligrey/FileSaver';\nimport {notify} from '~/lib/notifications';\nimport * as logging from '~/lib/logging';\n\nL.Control.JNX = L.Control.extend({\n        includes: L.Evented,\n\n        initialize: function(layersControl, options) {\n            L.Control.prototype.initialize.call(this, options);\n            this._layersControl = layersControl;\n            this.makingJnx = ko.observable(false);\n            this.downloadProgressRange = ko.observable(1);\n            this.downloadProgressDone = ko.observable(0);\n            this.contextMenu = new Contextmenu(() => this.makeMenuItems());\n        },\n\n        getLayerForJnx: function() {\n            let selectedLayer = {};\n            for (let layerRec of this._layersControl._layers) {\n                let layer = layerRec.layer;\n                if (this._map.hasLayer(layer) && layer.options && layer.options.jnx) {\n                    selectedLayer = {\n                        layer,\n                        layerName: layerRec.name\n                    };\n                }\n            }\n            return selectedLayer;\n        },\n\n        estimateTilesCount: function(maxZoom) {\n            let tilesCount = 0;\n            const bounds = this._selector.getBounds();\n            for (let zoom = minZoom(maxZoom); zoom <= maxZoom; zoom++) {\n                const topLeftTile = this._map.project(bounds.getNorthWest(), zoom).divideBy(256).floor();\n                const bottomRightTile = this._map.project(bounds.getSouthEast(), zoom).divideBy(256).ceil();\n                tilesCount += Math.ceil((bottomRightTile.x - topLeftTile.x) * (bottomRightTile.y - topLeftTile.y));\n            }\n            return tilesCount;\n        },\n\n        makeMenuItems: function() {\n            const {layer, layerName} = this.getLayerForJnx();\n            if (!layer) {\n                return [{text: 'No supported layers'}];\n            }\n            const maxLevel = layer.options.maxNativeZoom || layer.options.maxZoom || 18;\n            const minLevel = Math.max(0, maxLevel - 6);\n\n            const equatorLength = 40075016;\n            const lat = this._selector.getBounds().getCenter().lat;\n            let metersPerPixel = equatorLength / 2 ** maxLevel / 256 * Math.cos(lat / 180 * Math.PI);\n\n            const items = [{text: layerName, header: true}];\n            for (let zoom = maxLevel; zoom >= minLevel; zoom -= 1) {\n                let tilesCount = this.estimateTilesCount(zoom);\n                let fileSizeMb = tilesCount * 0.02;\n                let itemClass = tilesCount > 50000 ? 'jnx-menu-warning' : '';\n                let resolutionString = metersPerPixel.toFixed(2);\n                let sizeString = fileSizeMb.toFixed(fileSizeMb > 1 ? 0 : 1);\n                let item = {\n                    text: `<span class=\"${itemClass}\">Zoom ${zoom} (${resolutionString} m/pixel) &mdash; ${tilesCount} tiles (~${sizeString} Mb)</span>`, // eslint-disable-line max-len\n                    callback: () => this.makeJnx(layer, layerName, zoom),\n                    disabled: this.makingJnx()\n                };\n                items.push(item);\n                metersPerPixel *= 2;\n            }\n            return items;\n        },\n\n        notifyProgress: function(value, maxValue) {\n            this.downloadProgressDone(this.downloadProgressDone() + value);\n            this.downloadProgressRange(maxValue);\n        },\n\n        makeJnx: function(layer, layerName, zoom) {\n            logging.captureBreadcrumb('start making jnx');\n            this.makingJnx(true);\n            this.downloadProgressDone(0);\n\n            const bounds = this._selector.getBounds();\n            const sanitizedLayerName = layerName.toLowerCase().replace(/[ ()]+/u, '_');\n            const fileName = `nakarte.me_${sanitizedLayerName}_z${zoom}.jnx`;\n            const eventId = logging.randId();\n            this.fire('tileExportStart', {\n                eventId,\n                layer,\n                zoom,\n                bounds,\n            });\n            makeJnxFromLayer(layer, layerName, zoom, bounds, this.notifyProgress.bind(this))\n                .then((fileData) => {\n                    saveAs(fileData, fileName, true);\n                    this.fire('tileExportEnd', {eventId, success: true});\n                })\n                .catch((e) => {\n                    logging.captureException(e, 'Failed to create JNX');\n                    this.fire('tileExportEnd', {\n                        eventId,\n                        success: false,\n                        error: e\n                    });\n                    notify(`Failed to create JNX: ${e.message}`);\n                })\n                .then(() => this.makingJnx(false));\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            const container = this._container = L.DomUtil.create('div', 'leaflet-control leaflet-control-jnx');\n            container.innerHTML = `\n                <a class=\"button\" data-bind=\"visible: !makingJnx(), click: onButtonClicked\"\n                 title=\"Make JNX for Garmin receivers\">JNX</a>\n                <div data-bind=\"\n                    component:{\n                        name: 'progress-indicator',\n                        params: {progressRange: downloadProgressRange, progressDone: downloadProgressDone}\n                    },\n                    visible: makingJnx()\"></div>`;\n            ko.applyBindings(this, container);\n            this._stopContainerEvents();\n            return container;\n        },\n\n        removeSelector: function() {\n            if (this._selector) {\n                this._map.removeLayer(this._selector);\n                this._selector = null;\n                this.fire('selectionchange');\n            }\n        },\n\n        addSelector: function(bounds) {\n            if (!bounds) {\n                bounds = this._map.getBounds().pad(-0.25);\n            }\n            this._selector = new RectangleSelect(bounds)\n                .addTo(this._map)\n                .on('change', () => this.fire('selectionchange'))\n                .on('click contextmenu', (e) => {\n                    L.DomEvent.stop(e);\n                    this.contextMenu.show(e);\n                });\n            this.fire('selectionchange');\n        },\n\n        onButtonClicked: function() {\n            if (this._selector) {\n                if (this._selector.getBounds().intersects(this._map.getBounds().pad(-0.05))) {\n                    this.removeSelector();\n                } else {\n                    this.removeSelector();\n                    this.addSelector();\n                }\n            } else {\n                this.addSelector();\n            }\n        },\n    }\n);\n\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\n\nconst RectangleSelect = L.Rectangle.extend({\n        includes: L.Evented,\n\n        options: {\n            opacity: 1,\n            weight: 0.5,\n            fillOpacity: 0.2,\n            color: '#3388ff',\n            fillColor: '#3388ff',\n\n        },\n\n        onAdd: function(map) {\n            L.Rectangle.prototype.onAdd.call(this, map);\n            this.markers = [];\n            for (let position of ['top', 'right', 'bottom', 'left']) {\n                let marker = L.marker([0, 0], {\n                        icon: L.divIcon({className: `leaflet-rectangle-select-edge edge-${position}`}),\n                        draggable: true\n                    }\n                )\n                    .addTo(map);\n                marker.on({\n                        drag: this.onMarkerDrag,\n                        dragend: this.onMarkerDragEnd\n                    }, this\n                );\n                this.markers[position] = marker;\n            }\n            this.placeMarkers();\n            map.on('zoomend', this.placeMarkers, this);\n        },\n\n        placeMarkers: function() {\n            const bounds = this.getBounds();\n            const topLeftPixel = this._map.project(bounds.getNorthWest());\n            const bottomRightPixel = this._map.project(bounds.getSouthEast());\n            const size = bottomRightPixel.subtract(topLeftPixel);\n            let center = topLeftPixel.add(size.divideBy(2));\n            center = this._map.unproject(center);\n            this.markers['top'].setLatLng([bounds.getNorth(), center.lng]);\n            this.markers['top']._icon.style.width = `${size.x}px`;\n            this.markers['top']._icon.style.marginLeft = `-${size.x / 2}px`;\n            this.markers['right'].setLatLng([center.lat, bounds.getEast()]);\n            this.markers['right']._icon.style.height = `${size.y}px`;\n            this.markers['right']._icon.style.marginTop = `-${size.y / 2}px`;\n            this.markers['bottom'].setLatLng([bounds.getSouth(), center.lng]);\n            this.markers['bottom']._icon.style.width = `${size.x}px`;\n            this.markers['bottom']._icon.style.marginLeft = `-${size.x / 2}px`;\n            this.markers['left'].setLatLng([center.lat, bounds.getWest()]);\n            this.markers['left']._icon.style.height = `${size.y}px`;\n            this.markers['left']._icon.style.marginTop = `-${size.y / 2}px`;\n        },\n\n        onRemove: function(map) {\n            for (let marker of Object.values(this.markers)) {\n                this._map.removeLayer(marker);\n            }\n            this.markers = null;\n            map.off('zoomend', this.placeMarkers, this);\n            L.Rectangle.prototype.onRemove.call(this, map);\n        },\n\n        setBoundsFromMarkers: function() {\n            this.setBounds(\n                [\n                    [this.markers['top'].getLatLng().lat, this.markers['left'].getLatLng().lng],\n                    [this.markers['bottom'].getLatLng().lat, this.markers['right'].getLatLng().lng]\n                ]\n            );\n        },\n        onMarkerDrag: function() {\n            this.setBoundsFromMarkers();\n        },\n\n        onMarkerDragEnd: function() {\n            this.setBoundsFromMarkers();\n            this.placeMarkers();\n            this.fire('change');\n        }\n    }\n);\n\nexport {RectangleSelect};\n","import L from 'leaflet';\nimport {JnxWriter} from './jnx-encoder';\nimport {getTempMap, disposeMap} from '~/lib/leaflet.layer.rasterize';\nimport {XHRQueue} from '~/lib/xhr-promise';\nimport {arrayBufferToString, stringToArrayBuffer} from '~/lib/binary-strings';\n\nconst defaultXHROptions = {\n    responseType: 'arraybuffer',\n    timeout: 20000,\n    isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 404\n};\n\nfunction minZoom(maxZoom) {\n    return Math.max(maxZoom - 4, 0);\n}\n\nfunction imageFromarrayBuffer(arr) {\n    const dataUrl = 'data:image/png;base64,' + btoa(arrayBufferToString(arr));\n    const image = new Image();\n    return new Promise(function(resolve, reject) {\n            image.onload = () => resolve(image);\n            image.onerror = () => reject(new Error('Tile image corrupt'));\n            image.src = dataUrl;\n        }\n    );\n}\n\nasync function convertToJpeg(image) {\n    try {\n        image = await imageFromarrayBuffer(image);\n    } catch (e) {\n        return null;\n    }\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = image.width;\n    canvas.height = image.height;\n    const ctx = canvas.getContext(\"2d\");\n    ctx.drawImage(image, 0, 0);\n    const dataURL = canvas.toDataURL(\"image/jpeg\");\n    const s = atob(dataURL.replace(/^data:image\\/jpeg;base64,/u, \"\"));\n    return stringToArrayBuffer(s);\n}\n\nfunction ensureImageJpg(image) {\n    if (!image) {\n        return null;\n    }\n    if (arrayBufferToString(image.slice(0, 4)) === '\\x89PNG' &&\n        arrayBufferToString(image.slice(-8)) === 'IEND\\xae\\x42\\x60\\x82') {\n        return convertToJpeg(image);\n    } else if (arrayBufferToString(image.slice(0, 2)) === '\\xff\\xd8' &&\n        arrayBufferToString(image.slice(-2)) === '\\xff\\xd9') {\n        return Promise.resolve(image);\n    }\n    return null;\n}\n\nasync function makeJnxFromLayer(srcLayer, layerName, maxZoomLevel, latLngBounds, progress) {\n    const jnxProductId = L.stamp(srcLayer);\n    const jnxZOrder = Math.min(jnxProductId, 100);\n    const writer = new JnxWriter(layerName, jnxProductId, jnxZOrder);\n    const xhrQueue = new XHRQueue();\n    let doStop = false;\n    let error;\n    const minZoomLevel = minZoom(maxZoomLevel);\n    let progressWeight = 1;\n    for (let zoom = maxZoomLevel; zoom >= minZoomLevel; zoom--) {\n        let pixelBounds = L.bounds(\n            L.CRS.EPSG3857.latLngToPoint(latLngBounds.getNorthWest(), zoom).round(),\n            L.CRS.EPSG3857.latLngToPoint(latLngBounds.getSouthEast(), zoom).round()\n        );\n\n        let promises = [];\n        let layer = srcLayer.cloneForPrint({xhrQueue});\n        let tempMap = getTempMap(zoom, layer._rasterizeNeedsFullSizeMap, pixelBounds);\n        tempMap.addLayer(layer);\n        let {iterateTilePromises, count: tilesCount} = await layer.getTilesInfo({\n                xhrOptions: defaultXHROptions,\n                pixelBounds,\n                rawData: true\n            }\n        );\n        for (let tilePromiseRec of iterateTilePromises()) {\n            promises.push(tilePromiseRec);\n        }\n        for (let {tilePromise} of promises) {\n            let imageRec;\n            try {\n                imageRec = await tilePromise;\n            } catch (e) {\n                error = e;\n                doStop = true;\n                break;\n            }\n            let xhr = imageRec.image;\n\n            if (xhr === null || xhr.status !== 200 || !xhr.response || !xhr.response.byteLength) {\n                continue;\n            }\n            let image = await ensureImageJpg(xhr.response);\n            if (!image) {\n                error = new Error('Tile image invalid');\n                doStop = true;\n                break;\n            }\n            writer.addTile(image, zoom, imageRec.latLngBounds);\n            progress(progressWeight / tilesCount, 4 / 3);\n        }\n        disposeMap(tempMap);\n        if (doStop) {\n            promises.forEach((promiseRec) => promiseRec.abortLoading());\n            throw error;\n        }\n        progressWeight /= 4;\n    }\n\n    return writer.getJnx();\n}\n\nexport {makeJnxFromLayer, minZoom};\n","import L from 'leaflet';\nimport {BinStream} from './binary-stream';\n\nfunction jnxCoordinates(extents) {\n    function toJnx(x) {\n        return Math.round(x / 180.0 * 0x7fffffff);\n    }\n\n    return [toJnx(extents.north), toJnx(extents.east), toJnx(extents.south), toJnx(extents.west)];\n}\n\nconst JnxWriter = L.Class.extend({\n        initialize: function(productName, productId, zOrder) {\n            this.tiles = {};\n            this.productName = productName || 'Raster map';\n            this.productId = productId || 0;\n            this.zOrder = zOrder;\n        },\n\n        addTile: function(tileData, level, latLngBounds) {\n            this.tiles[level] = this.tiles[level] || [];\n            tileData = new Blob([tileData]).slice(2);\n            const extents = {\n                west: latLngBounds.getWest(),\n                north: latLngBounds.getNorth(),\n                south: latLngBounds.getSouth(),\n                east: latLngBounds.getEast(),\n\n            };\n            this.tiles[level].push({data: tileData, extents: extents});\n        },\n\n        getJnx: function() {\n            const HEADER_SIZE = 52,\n                LEVEL_INFO_SIZE = 17,\n                TILE_INFO_SIZE = 28;\n\n            let totalTilesCount = 0;\n            for (let levelTiles of Object.values(this.tiles)) {\n                totalTilesCount += levelTiles.length;\n            }\n            if (totalTilesCount === 0) {\n                throw new Error('No tiles collected, JNX is empty');\n            }\n            if (totalTilesCount > 50000) {\n                throw new Error('Too many tiles found (more then 50000)');\n            }\n\n            let west = 1e10,\n                east = -1e10,\n                north = -1e10,\n                south = 1e10,\n                levels_n = Object.keys(this.tiles).length,\n                level, tiles, extents,\n                i, tile;\n            for (let levelTiles of Object.values(this.tiles)) {\n                for (let tile of levelTiles) {\n                    west = (west < tile.extents.west) ? west : tile.extents.west;\n                    east = (east > tile.extents.east) ? east : tile.extents.east;\n                    north = (north > tile.extents.north) ? north : tile.extents.north;\n                    south = (south < tile.extents.south) ? south : tile.extents.south;\n                }\n            }\n            const stream = new BinStream(1024, true);\n            // header\n            stream.writeInt32(4); // version\n            stream.writeInt32(0); // device id\n            extents = jnxCoordinates({south: south, north: north, west: west, east: east});\n            stream.writeInt32(extents[0]); // north\n            stream.writeInt32(extents[1]); // west\n            stream.writeInt32(extents[2]); // south\n            stream.writeInt32(extents[3]); // east\n            stream.writeInt32(levels_n); // number of zoom levels\n            stream.writeInt32(0); // expiration date\n            stream.writeInt32(this.productId);\n            stream.writeInt32(0); // tiles CRC32\n            stream.writeInt32(0); // signature version\n            stream.writeUint32(0); // signature offset\n            stream.writeInt32(this.zOrder);\n            stream.seek(HEADER_SIZE + LEVEL_INFO_SIZE * levels_n);\n            // map description\n            stream.writeInt32(9); // section version\n            stream.writeString('12345678-1234-1234-1234-123456789ABC', true); // GUID\n            stream.writeString(this.productName, true);\n            stream.writeString('', true);\n            stream.writeInt16(this.productId);\n            stream.writeString(this.productName, true);\n            stream.writeInt32(levels_n);\n            // levels descriptions\n            for (level of Object.keys(this.tiles)) {\n                stream.writeString('', true);\n                stream.writeString('', true);\n                stream.writeString('', true);\n                stream.writeInt32(level);\n            }\n            let tileDescriptorOffset = stream.tell();\n            // level info\n            let jnxScale;\n            stream.seek(HEADER_SIZE);\n            for (level of Object.keys(this.tiles)) {\n                level = parseInt(level, 10);\n                stream.writeInt32(this.tiles[level].length);\n                stream.writeUint32(tileDescriptorOffset);\n                // jnxScale = JnxScales[level + 3];\n                jnxScale = 34115555 / (2 ** level) * Math.cos((north + south) / 2 / 180 * Math.PI) / 1.1;\n                stream.writeInt32(jnxScale);\n                stream.writeInt32(2);\n                stream.writeUint8(0);\n                tileDescriptorOffset += TILE_INFO_SIZE * this.tiles[level].length;\n            }\n            // tiles descriptors\n            stream.seek(stream.size);\n            let tileDataOffset = tileDescriptorOffset;\n            for (level of Object.keys(this.tiles)) {\n                tiles = this.tiles[level];\n                for (i = 0; i < tiles.length; i++) {\n                    tile = tiles[i];\n                    extents = jnxCoordinates(tile.extents);\n                    stream.writeInt32(extents[0]); // north\n                    stream.writeInt32(extents[1]); // west\n                    stream.writeInt32(extents[2]); // south\n                    stream.writeInt32(extents[3]); // east\n                    stream.writeInt16(256); // width\n                    stream.writeInt16(256); // height\n                    stream.writeInt32(tile.data.size);\n                    stream.writeUint32(tileDataOffset);\n                    tileDataOffset += tile.data.size;\n                }\n            }\n\n            const blob = [];\n            blob.push(stream.getBuffer());\n            for (level of Object.keys(this.tiles)) {\n                tiles = this.tiles[level];\n                for (i = 0; i < tiles.length; i++) {\n                    tile = tiles[i];\n                    blob.push(tile.data);\n                }\n            }\n\n            blob.push('BirdsEye');\n            return new Blob(blob);\n        }\n    }\n);\n\nexport {JnxWriter};\n","import utf8 from 'utf8';\n\nclass BinStream {\n    constructor(size, littlEndian) {\n        this.maxSize = 1024;\n        this.dv = new DataView(new ArrayBuffer(this.maxSize));\n        this._pos = 0;\n        this.size = 0;\n        this.littlEndian = littlEndian;\n    }\n\n    grow() {\n        this.maxSize *= 2;\n        const old_buffer = this.dv.buffer;\n        this.dv = new DataView(new ArrayBuffer(this.maxSize));\n        const newAr = new Uint8Array(this.dv.buffer);\n        const oldAr = new Uint8Array(old_buffer);\n        for (let i = 0; i < oldAr.length; i++) {\n            newAr[i] = oldAr[i];\n        }\n    }\n\n    checkSize(size) {\n        if (this._pos + size >= this.maxSize) {\n            this.grow();\n        }\n        const newPos = this._pos + size;\n        this.size = (newPos > this.size) ? newPos : this.size;\n    }\n\n    writeUint8(value) {\n        this.checkSize(1);\n        this.dv.setUint8(this._pos, value);\n        this._pos += 1;\n    }\n\n    writeInt8(value) {\n        this.checkSize(1);\n        this.dv.setInt8(this._pos, value);\n        this._pos += 1;\n    }\n\n    writeInt16(value) {\n        this.checkSize(2);\n        this.dv.setInt16(this._pos, value, this.littlEndian);\n        this._pos += 2;\n    }\n\n    writeUint16(value) {\n        this.checkSize(2);\n        this.dv.setUint16(this._pos, value, this.littlEndian);\n        this._pos += 2;\n    }\n\n    writeInt32(value) {\n        this.checkSize(4);\n        this.dv.setInt32(this._pos, value, this.littlEndian);\n        this._pos += 4;\n    }\n\n    writeUint32(value) {\n        this.checkSize(4);\n        this.dv.setUint32(this._pos, value, this.littlEndian);\n        this._pos += 4;\n    }\n\n    writeString(s, zeroTerminated) {\n        s = utf8.encode(s);\n        for (let i = 0; i < s.length; i++) {\n            this.writeUint8(s.charCodeAt(i));\n        }\n        if (zeroTerminated) {\n            this.writeUint8(0);\n        }\n    }\n\n    tell() {\n        return this._pos;\n    }\n\n    seek(pos) {\n        this._pos = pos;\n    }\n\n    getBuffer() {\n        return this.dv.buffer.slice(0, this.size);\n    }\n}\n\nexport {BinStream};\n","import L from 'leaflet';\nimport '~/lib/leaflet.hashState/leaflet.hashState';\n\nL.Control.JNX.include(L.Mixin.HashState);\nL.Control.JNX.include({\n        stateChangeEvents: ['selectionchange'],\n\n        serializeState: function() {\n            let state;\n            if (this._selector) {\n                const bounds = this._selector.getBounds();\n                state = [\n                    bounds.getSouth().toFixed(5),\n                    bounds.getWest().toFixed(5),\n                    bounds.getNorth().toFixed(5),\n                    bounds.getEast().toFixed(5)\n                ];\n            }\n            return state;\n        },\n\n        unserializeState: function(values) {\n            function validateFloat(value) {\n                value = parseFloat(value);\n                if (isNaN(value)) {\n                    throw new Error('INVALID VALUE');\n                }\n                return value;\n            }\n\n            function validateFloatRange(value, min, max) {\n                value = validateFloat(value);\n                if (value < min || value > max) {\n                    throw new Error('INVALID VALUE');\n                }\n                return value;\n            }\n\n            if (values && values.length === 4) {\n                let south, west, north, east;\n                try {\n                        south = validateFloatRange(values[0], -86, 86);\n                        west = validateFloat(values[1]);\n                        north = validateFloatRange(values[2], -86, 86);\n                        east = validateFloat(values[3]);\n                } catch (e) {\n                    if (e.message === 'INVALID VALUE') {\n                        return false;\n                    }\n                    throw e;\n                }\n                this.removeSelector();\n                this.addSelector([[south, west], [north, east]]);\n                return true;\n            }\n            return false;\n        }\n    }\n);\n","import L from 'leaflet';\nimport ko from 'knockout';\nimport {makeButtonWithBar} from '~/lib/leaflet.control.commons';\nimport layout from './control.html';\nimport '~/lib/controls-styles/controls-styles.css';\nimport './style.css';\nimport {getDeclination} from '~/lib/magnetic-declination';\nimport 'leaflet-rotatedmarker'; // eslint-disable-line import/no-unassigned-import\nimport iconPointer from './pointer.svg';\nimport iconPointerStart from './pointer-start.svg';\nimport iconPointerEnd from './pointer-end.svg';\nimport {ElevationProfile, calcSamplingInterval} from '~/lib/leaflet.control.elevation-profile';\n\nfunction radians(x) {\n    return x / 180 * Math.PI;\n}\n\nfunction degrees(x) {\n    return x / Math.PI * 180;\n}\n\nfunction calcAzimuth(latlng1, latlng2) {\n    const lat1 = radians(latlng1.lat);\n    const lat2 = radians(latlng2.lat);\n    const lng1 = radians(latlng1.lng);\n    const lng2 = radians(latlng2.lng);\n\n    const y = Math.sin(lng2 - lng1) * Math.cos(lat2);\n    const x = Math.cos(lat1) * Math.sin(lat2) -\n        Math.sin(lat1) * Math.cos(lat2) * Math.cos(lng2 - lng1);\n    let brng = Math.atan2(y, x);\n    brng = degrees(brng);\n    return brng;\n}\n\nfunction calcAngle(latlng1, latlng2) {\n    const p1 = L.Projection.SphericalMercator.project(latlng1);\n    const p2 = L.Projection.SphericalMercator.project(latlng2);\n    const delta = p2.subtract(p1);\n    const angle = Math.atan2(delta.x, delta.y);\n    return degrees(angle);\n}\n\nfunction roundAzimuth(a) {\n    return (Math.round(a) + 360) % 360;\n}\n\nL.Control.Azimuth = L.Control.extend({\n        options: {\n            position: 'bottomleft'\n        },\n\n        includes: L.Evented,\n\n        initialize: function(options) {\n            L.Control.prototype.initialize.call(this, options);\n            this.trueAzimuth = ko.observable(null);\n            this.magneticAzimuth = ko.observable(null);\n            this.distance = ko.observable(null);\n            this.points = {\n                start: null,\n                end: null\n            };\n            const iconSingle = L.icon({iconUrl: iconPointer, iconSize: [30, 30]});\n            const iconStart = L.icon({iconUrl: iconPointerStart, iconSize: [30, 30]});\n            const iconEnd = L.icon({iconUrl: iconPointerEnd, iconSize: [30, 45]});\n            this.azimuthLine = L.polyline([], {interactive: false, weight: 1.5});\n            this.markers = {\n                single: L.marker([0, 0], {icon: iconSingle, draggable: true, which: 'start'})\n                    .on('drag', this.onMarkerDrag, this)\n                    .on('click', L.DomEvent.stopPropagation),\n                start: L.marker([0, 0], {\n                    icon: iconStart,\n                    draggable: true,\n                    which: 'start',\n                    rotationOrigin: 'center center',\n                    projectedShift: () => this.azimuthLine.shiftProjectedFitMapView()\n                })\n                    .on('drag', this.onMarkerDrag, this)\n                    .on('click', L.DomEvent.stopPropagation)\n                    .on('dragend', this.onMarkerDragEnd, this),\n                end: L.marker([0, 0], {\n                    icon: iconEnd,\n                    draggable: true,\n                    which: 'end',\n                    rotationOrigin: 'center center',\n                    projectedShift: () => this.azimuthLine.shiftProjectedFitMapView()\n                })\n                    .on('drag', this.onMarkerDrag, this)\n                    .on('click', L.DomEvent.stopPropagation)\n                    .on('dragend', this.onMarkerDragEnd, this)\n            };\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            const {container, link, barContainer} = makeButtonWithBar(\n                'leaflet-control-azimuth', 'Measure bearing, display line of sight', 'icon-azimuth');\n            this._container = container;\n            L.DomEvent.on(link, 'click', this.onClick, this);\n\n            barContainer.innerHTML = layout;\n            ko.applyBindings(this, barContainer);\n            return container;\n        },\n\n        onClick: function() {\n            if (this.isEnabled()) {\n                this.disableControl();\n            } else {\n                this.enableControl();\n            }\n        },\n\n        onMarkerDrag: function(e) {\n            const marker = e.target;\n            this.setPoints({[marker.options.which]: marker.getLatLng()});\n        },\n\n        onMarkerDragEnd: function() {\n            if (this.elevationControl) {\n                this.showProfile();\n            }\n        },\n\n        enableControl: function() {\n            L.DomUtil.addClass(this._container, 'active');\n            L.DomUtil.addClass(this._container, 'highlight');\n            L.DomUtil.addClass(this._map._container, 'azimuth-control-active');\n            this._map.on('click', this.onMapClick, this);\n            this.fire('enabled');\n            this._map.clickLocked = true;\n            this._enabled = true;\n        },\n\n        disableControl: function() {\n            L.DomUtil.removeClass(this._container, 'active');\n            L.DomUtil.removeClass(this._container, 'highlight');\n            this.hideProfile();\n            this.setPoints({start: null, end: null});\n            L.DomUtil.removeClass(this._map._container, 'azimuth-control-active');\n            this._map.off('click', this.onMapClick, this);\n            this._map.clickLocked = false;\n            this._enabled = false;\n        },\n\n        isEnabled: function() {\n            return Boolean(this._enabled);\n        },\n\n        setPoints: function(points) {\n            Object.assign(this.points, points);\n            points = this.points;\n            if (points.start && !points.end) {\n                this.markers.single\n                    .setLatLng(points.start)\n                    .addTo(this._map);\n            } else {\n                this.markers.single.removeFrom(this._map);\n            }\n            if (points.start && points.end) {\n                const angle = calcAngle(points.start, points.end);\n                this.markers.start\n                    .setLatLng(points.start)\n                    .addTo(this._map)\n                    .setRotationAngle(angle);\n                this.markers.end\n                    .setLatLng(points.end)\n                    .addTo(this._map)\n                    .setRotationAngle(angle);\n                this.azimuthLine\n                    .setLatLngs([[points.start, points.end]])\n                    .addTo(this._map);\n            } else {\n                this.markers.start.removeFrom(this._map);\n                this.markers.end.removeFrom(this._map);\n                this.azimuthLine.removeFrom(this._map);\n            }\n            this.updateValuesDisplay();\n        },\n\n        updateValuesDisplay: function() {\n            if (this.points.start && this.points.end) {\n                const points = this.points;\n                const azimuth = calcAzimuth(points.start, points.end);\n                this.trueAzimuth(roundAzimuth(azimuth));\n                const declination = getDeclination(points.start.lat, points.start.lng);\n                if (declination === null) {\n                    this.magneticAzimuth(null);\n                } else {\n                    this.magneticAzimuth(roundAzimuth(azimuth - declination));\n                }\n                this.distance(points.start.distanceTo(points.end));\n            } else {\n                this.distance(null);\n                this.trueAzimuth(null);\n                this.magneticAzimuth(null);\n            }\n        },\n\n        onMapClick: function(e) {\n            if (!this.points.start && !this.points.end) {\n                this.setPoints({start: e.latlng});\n            } else if (this.points.start && !this.points.end) {\n                this.setPoints({end: e.latlng});\n            } else if (this.points.start && this.points.end) {\n                this.hideProfile();\n                this.setPoints({start: e.latlng, end: null});\n            }\n        },\n\n        showProfile: function() {\n            if (!this.points.end) {\n                return;\n            }\n            if (this.elevationControl) {\n                this.elevationControl.removeFrom(this._map);\n            }\n\n            const dist = this.points.start.distanceTo(this.points.end);\n            this.elevationControl = new ElevationProfile(this._map, [this.points.start, this.points.end], {\n                samplingInterval: calcSamplingInterval(dist),\n                sightLine: true\n            });\n            this.elevationControl.on('remove', () => {\n                this.elevationControl = null;\n            });\n            this.fire('elevation-shown');\n        },\n\n        hideProfile: function() {\n            if (this.elevationControl) {\n                this.elevationControl.removeFrom(this._map);\n            }\n            this.elevationControl = null;\n        },\n\n        onProfileButtonClick: function() {\n            this.showProfile();\n        },\n\n        onReverseButtonClick: function() {\n            if (this.points.end && this.points.start) {\n                this.setPoints({start: this.points.end, end: this.points.start});\n                if (this.elevationControl) {\n                    this.showProfile();\n                }\n            }\n        }\n\n    }\n);\n\n","export default \"<div class=\\\"contents\\\">\\n    <table>\\n        <tr>\\n            <td>True azimuth</td>\\n            <td data-bind=\\\"text: trueAzimuth() !== null ? Math.round(trueAzimuth()) + '&deg;' : '--'\\\"></td>\\n        </tr>\\n        <tr>\\n            <td>Magnetic azimuth</td>\\n            <td data-bind=\\\"text: magneticAzimuth() !== null ? magneticAzimuth() + '&deg;' : '--'\\\"></td>\\n        </tr>\\n        <tr>\\n            <td>Distance</td>\\n            <td data-bind=\\\"text: distance() === null ? '--' :\\n                distance() > 2000 ? (distance() / 1000).toFixed(2) + ' km' : Math.round(distance()) + ' m'\\\"></td>\\n        </tr>\\n    </table>\\n\\n    <div class=\\\"buttons\\\">\\n        <div class=\\\"button\\\" data-bind=\\\"click: onReverseButtonClick\\\">Reverse</div>\\n        <div class=\\\"button\\\" data-bind=\\\"click: onProfileButtonClick\\\">Elevation / Sightline</div>\\n    </div>\\n</div>\";","// extracted by mini-css-extract-plugin\nexport {};","export default \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMzAgMzAiPgogICAgPGc+CiAgICAgICAgPGVsbGlwc2Ugcnk9IjE1IiByeD0iMTUiIGN5PSIxNSIgY3g9IjE1IiBmaWxsPSIjNzc3IiBmaWxsLW9wYWNpdHk9IjAuNSIvPgogICAgICAgIDxlbGxpcHNlIHJ5PSIzIiByeD0iMyIgY3k9IjE1IiBjeD0iMTUiIGZpbGw9IiMzMzg4ZmYiIC8+CiAgICA8L2c+Cjwvc3ZnPg==\"","export default \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMzAgMzAiPgogICAgPGc+CiAgICAgICAgPGVsbGlwc2Ugcnk9IjE1IiByeD0iMTUiIGN5PSIxNSIgY3g9IjE1IiBmaWxsPSIjNzc3IiBmaWxsLW9wYWNpdHk9IjAuNSIvPgogICAgICAgIDxlbGxpcHNlIHJ5PSIzIiByeD0iMyIgY3k9IjE1IiBjeD0iMTUiIGZpbGw9IiMzMzg4ZmYiIC8+CiAgICA8L2c+Cjwvc3ZnPg==\"","export default \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMzAgNDUiPgogICAgPGc+CiAgICAgICAgPGVsbGlwc2Ugcnk9IjE1IiByeD0iMTUiIGN5PSIyNiIgY3g9IjE1IiBmaWxsPSIjNzc3IiBmaWxsLW9wYWNpdHk9IjAuNSIvPgogICAgICAgIDxwYXRoIGQ9Ik0xNSwyMCBsLTUsMTIgbDEwLDAgeiIgZmlsbD0iIzMzODhmZiIvPgogICAgPC9nPgo8L3N2Zz4=\"","import L from 'leaflet';\nimport {makeButton} from '~/lib/leaflet.control.commons';\nimport './style.css';\nimport localStorage from '~/lib/safe-localstorage';\n\nconst STATE_DISABLED = 'disabled';\nconst STATE_LOCATING = 'locating';\nconst STATE_ENABLED = 'enabled';\nconst STATE_ENABLED_FOLLOWING = 'enabled_following';\nconst STATE_MOVING_TO_FOLLOWING = 'moving_to_following';\nconst STATE_MOVING_TO_FOLLOWING_FIRST = 'moving_to_following_first';\nconst STATE_UPDATING_FOLLOWING = 'updating_following';\n\nconst EVENT_INIT = 'init';\nconst EVENT_BUTTON_CLICK = 'button_click';\nconst EVENT_LOCATION_RECEIVED = 'location_received';\nconst EVENT_LOCATION_ERROR = 'location_error';\nconst EVENT_MAP_MOVE = 'user_move';\nconst EVENT_MAP_MOVE_END = 'map_move_end';\n\nconst LOCALSTORAGE_POSITION = 'leaflet_locate_position';\n\nconst PositionMarker = L.LayerGroup.extend({\n    initialize: function(options) {\n        L.LayerGroup.prototype.initialize.call(this, options);\n        this._locationSet = false;\n        this._elements = {\n            accuracyCircle: L.circle([0, 0], {\n                radius: 1,\n                interactive: false,\n                fillColor: '#4271a8',\n                color: '#2ba3f7',\n                weight: 2\n            }),\n            markerCircle: L.circleMarker([0, 0], {\n                interactive: false,\n                radius: 10,\n                color: '#2ba3f7',\n                weight: 2.5,\n                fill: null,\n                opacity: 0.8\n            }),\n            markerPoint: L.circleMarker([0, 0], {\n                interactive: false,\n                radius: 2,\n                weight: 0,\n                color: '#2ba3f7',\n                fillOpacity: 0.8\n            }),\n        };\n        this.addLayer(this._elements.accuracyCircle);\n    },\n\n    onAdd: function(map) {\n        L.LayerGroup.prototype.onAdd.call(this, map);\n        map.on('zoom', this._onZoom, this);\n        this._updatePrecisionState();\n    },\n\n    onRemove: function(map) {\n        map.off('zoom', this._onZoom, this);\n        L.LayerGroup.prototype.onRemove.call(this, map);\n    },\n\n    _updatePrecisionState: function() {\n        if (!this._map || !this._locationSet) {\n            return;\n        }\n        const precise = this._elements.accuracyCircle._radius <= this._elements.markerCircle.options.radius * 0.8;\n        if (precise !== this._precise) {\n            if (precise) {\n                this._elements.accuracyCircle.setStyle({opacity: 0, fillOpacity: 0});\n                this.addLayer(this._elements.markerPoint);\n                this.addLayer(this._elements.markerCircle);\n            } else {\n                this._elements.accuracyCircle.setStyle({opacity: 0.8, fillOpacity: 0.4});\n                this.removeLayer(this._elements.markerPoint);\n                this.removeLayer(this._elements.markerCircle);\n            }\n            this._precise = precise;\n        }\n    },\n\n    setLocation: function(latlng, accuracy) {\n        this._elements.accuracyCircle.setLatLng(latlng);\n        this._elements.accuracyCircle.setRadius(accuracy);\n        this._elements.markerCircle.setLatLng(latlng);\n        this._elements.markerPoint.setLatLng(latlng);\n        this._locationSet = true;\n        this._updatePrecisionState();\n    },\n\n    _onZoom: function() {\n        this._updatePrecisionState();\n    }\n\n});\n\nconst LocateControl = L.Control.extend({\n        // button click behavior:\n        // if button turned off -- turn on, maps follows marker\n        // if button turned on\n        //     if map is following marker -- turn off\n        //     if map not following marker -- center map at marker, start following\n\n        options: {\n            locationAcquireTimeoutMS: Infinity,\n            showError: ({message}) => {\n                alert(message);\n            },\n            maxAutoZoom: 17,\n            minAutoZoomDeltaForAuto: 4,\n            minDistForAutoZoom: 2 // in average screen sizes\n        },\n\n        initialize: function(options) {\n            L.Control.prototype.initialize.call(this, options);\n            this._events = [];\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            const {container, link} = makeButton('leaflet-control-locate', 'Где я сейчас?', 'icon-position');\n            this._container = container;\n            L.DomEvent.on(link, 'click', () => this._handleEvent(EVENT_BUTTON_CLICK));\n            this._marker = new PositionMarker();\n            this._handleEvent(EVENT_INIT);\n            return container;\n        },\n\n        moveMapToCurrentLocation: function(zoom, fallbackLatLng, forceLatLng, forceZoom) {\n            let storedPosition;\n            try {\n                storedPosition = JSON.parse(localStorage.getItem(LOCALSTORAGE_POSITION));\n                let {lat, lon} = storedPosition;\n                if (lat && lon) {\n                    storedPosition = L.latLng(lat, lon);\n                } else {\n                    storedPosition = null;\n                }\n            } catch (e) {\n                // ignore invalid data from localstorage\n            }\n\n            if (storedPosition) {\n                this._map.setView(forceLatLng ? forceLatLng : storedPosition, forceZoom ? forceZoom : zoom, {\n                    animate: false,\n                });\n                if (!('geolocation' in navigator)) {\n                    return;\n                }\n                navigator.geolocation.getCurrentPosition(\n                    (pos) => {\n                        this._storePositionToLocalStorage(pos);\n                        if (!forceLatLng) {\n                            // TODO: check if map has not moved\n                            this._map.setView(L.latLng(pos.coords.latitude, pos.coords.longitude), zoom, {\n                                animate: false,\n                            });\n                        }\n                    },\n                    (e) => {\n                        if (e.code === 1) {\n                            localStorage.removeItem(LOCALSTORAGE_POSITION);\n                        }\n                    }, {\n                    enableHighAccuracy: false,\n                    timeout: 500,\n                    maximumAge: 0\n                });\n            } else {\n                this._map.setView(forceLatLng ? forceLatLng : fallbackLatLng, forceZoom ? forceZoom : zoom,\n                    {animate: false});\n            }\n        },\n\n        _startLocating: function() {\n            if (!('geolocation' in navigator) || !('watchPosition' in navigator.geolocation)) {\n                const error = {code: 0, message: 'Geolocation not supported'};\n                setTimeout(() => {\n                        this._onLocationError(error);\n                    }, 0\n                );\n            }\n            this._watchID = navigator.geolocation.watchPosition(\n                this._onLocationSuccess.bind(this), this._onLocationError.bind(this),\n                {\n                    enableHighAccuracy: true,\n                    timeout: this.options.locationAcquireTimeoutMS,\n                }\n            );\n        },\n\n        _storePositionToLocalStorage: function(pos) {\n            const coords = {lat: pos.coords.latitude, lon: pos.coords.longitude};\n            localStorage.setItem(LOCALSTORAGE_POSITION, JSON.stringify(coords));\n        },\n\n        _onLocationSuccess: function(pos) {\n            this._handleEvent(EVENT_LOCATION_RECEIVED, pos);\n            this._storePositionToLocalStorage(pos);\n        },\n\n        _onLocationError: function(e) {\n            this._handleEvent(EVENT_LOCATION_ERROR, e);\n            if (e.code === 1) {\n                localStorage.removeItem(LOCALSTORAGE_POSITION);\n            }\n        },\n\n        _stopLocating: function() {\n            if (this._watchID && navigator.geolocation) {\n                navigator.geolocation.clearWatch(this._watchID);\n            }\n        },\n\n        _storeLocation: function(position) {\n            this._latlng = L.latLng(position.coords.latitude, position.coords.longitude);\n            this._accuracy = position.coords.accuracy;\n        },\n\n        _updateMarkerLocation: function() {\n            this._marker.setLocation(this._latlng, this._accuracy);\n        },\n\n        _updateMapPositionWhileFollowing: function() {\n            this._updateFollowingStartPosition = this._map.getCenter();\n            this._updateFollowingDestPosition = this._latlng;\n            this._map.panTo(this._latlng);\n        },\n\n        _setViewToLocation: function(preferAutoZoom) {\n            if (!this._map || !this._latlng) {\n                return;\n            }\n\n            // autoZoom -- to fit accuracy cirlce on screen, but not more then options.maxAutoZoom (17)\n            // if current zoom more then options.minAutoZoomDeltaForAuto less then autoZoom, set autoZoom\n            // if map center far from geolocation, set autoZoom\n            // if map center not far from geolocation\n            //      if accuracy circle does not fit at current zoom, zoom out to fit\n            //      if  current zoom is less then minAutoZoomDeltaForAuto less then autoZoom\n            //          or >= autoZoom and circle fits screen, keep current zoom\n\n            const currentZoom = this._map.getZoom();\n            let zoomFitAccuracy = this._map.getBoundsZoom(this._latlng.toBounds(this._accuracy * 2));\n            let autoZoom = zoomFitAccuracy;\n            let newZoom;\n            autoZoom = Math.min(autoZoom, this.options.maxAutoZoom);\n\n            if (preferAutoZoom || autoZoom - currentZoom >= this.options.minAutoZoomDeltaForAuto) {\n                newZoom = autoZoom;\n            } else {\n                const p1 = this._map.project(this._map.getCenter());\n                const p2 = this._map.project(this._latlng);\n                const screenSize = this._map.getSize();\n                const averageScreenSize = (screenSize.x + screenSize.y) / 2;\n                if (p1.distanceTo(p2) > averageScreenSize * this.options.minDistForAutoZoom) {\n                    newZoom = autoZoom;\n                } else {\n                    newZoom = currentZoom > zoomFitAccuracy ? zoomFitAccuracy : currentZoom;\n                }\n            }\n            this._map.setView(this._latlng, newZoom);\n        },\n\n        _onMapMove: function() {\n            this._handleEvent(EVENT_MAP_MOVE);\n        },\n\n        _onMapMoveEnd: function() {\n            const ll = this._map.getCenter();\n            setTimeout(() => {\n                    if (this._map.getCenter().equals(ll)) {\n                        this._handleEvent(EVENT_MAP_MOVE_END);\n                    }\n                }, 100\n            );\n        },\n\n        _isMapOffsetFromFollowingSegment: function() {\n            if (this._updateFollowingStartPosition) {\n                const p = this._map.project(this._map.getCenter());\n                const p1 = this._map.project(this._updateFollowingStartPosition);\n                const p2 = this._map.project(this._updateFollowingDestPosition);\n                return L.LineUtil.pointToSegmentDistance(p, p1, p2) > 5;\n            }\n            return true;\n        },\n\n        _isMapCenteredAtLocation: function() {\n            if (!this._latlng || !this._map) {\n                return false;\n            }\n            let p1 = this._map.project(this._latlng);\n            let p2 = this._map.project(this._map.getCenter());\n            return p1.distanceTo(p2) < 5;\n        },\n\n        _updateButtonClasses: function(add, remove) {\n            for (let cls of add) {\n                L.DomUtil.addClass(this._container, cls);\n            }\n            for (let cls of remove) {\n                L.DomUtil.removeClass(this._container, cls);\n            }\n        },\n\n        _setEvents: function(on) {\n            const f = on ? 'on' : 'off';\n            this._map[f]('move', this._onMapMove, this);\n            this._map[f]('moveend', this._onMapMoveEnd, this);\n        },\n\n        _handleEvent: function(event, data) {\n            this._events.push({event, data});\n            if (!this._processingEvent) {\n                this._processingEvent = true;\n                while (this._events.length) {\n                    this._processEvent(this._events.shift());\n                }\n                this._processingEvent = false;\n            }\n        },\n\n        _processEvent: function({event, data}) { // eslint-disable-line complexity\n            // console.log('PROCESS EVENT', event);\n            const state = this._state;\n            switch (event) {\n                case EVENT_INIT:\n                    this._setState(STATE_DISABLED);\n                    break;\n                case EVENT_BUTTON_CLICK:\n                    if (state === STATE_DISABLED) {\n                        this._setState(STATE_LOCATING);\n                    } else if (state === STATE_ENABLED) {\n                        this._setState(STATE_MOVING_TO_FOLLOWING);\n                        this._setViewToLocation();\n                    } else {\n                        this._setState(STATE_DISABLED);\n                    }\n                    break;\n                case EVENT_LOCATION_RECEIVED:\n                    if (state === STATE_DISABLED) {\n                        return;\n                    }\n                    this._storeLocation(data);\n                    this._updateMarkerLocation();\n                    if (state === STATE_LOCATING || state === STATE_MOVING_TO_FOLLOWING_FIRST) {\n                        this._setViewToLocation(true);\n                        this._setState(STATE_MOVING_TO_FOLLOWING_FIRST);\n                    } else if (state === STATE_MOVING_TO_FOLLOWING) {\n                        this._setViewToLocation();\n                    } else if (this._state === STATE_ENABLED_FOLLOWING || state === STATE_UPDATING_FOLLOWING) {\n                        this._updateMapPositionWhileFollowing();\n                        this._setState(STATE_UPDATING_FOLLOWING);\n                    }\n                    break;\n                case EVENT_LOCATION_ERROR:\n                    if (state === STATE_DISABLED) {\n                        return;\n                    }\n                    this.options.showError(data);\n                    this._setState(STATE_DISABLED);\n                    break;\n                case EVENT_MAP_MOVE:\n                    if (state === STATE_ENABLED_FOLLOWING) {\n                        if (!this._isMapCenteredAtLocation() && this._isMapOffsetFromFollowingSegment()) {\n                            this._setState(STATE_ENABLED);\n                        }\n                    }\n                    break;\n                case EVENT_MAP_MOVE_END:\n                    if (state === STATE_MOVING_TO_FOLLOWING) {\n                        if (this._isMapCenteredAtLocation()) {\n                            this._setState(STATE_ENABLED_FOLLOWING);\n                        } else {\n                            this._setState(STATE_ENABLED);\n                        }\n                    } else if (state === STATE_UPDATING_FOLLOWING || state === STATE_MOVING_TO_FOLLOWING_FIRST) {\n                        if (this._isMapCenteredAtLocation() || !this._isMapOffsetFromFollowingSegment()) {\n                            this._setState(STATE_ENABLED_FOLLOWING);\n                        } else {\n                            this._setState(STATE_ENABLED);\n                        }\n                    }\n                    break;\n                default:\n            }\n        },\n\n        _setState: function(newState) {\n            const oldState = this._state;\n            if (oldState === newState) {\n                return;\n            }\n            // console.log(`STATE: ${oldState} -> ${newState}`);\n            switch (newState) {\n                case STATE_LOCATING:\n                    this._startLocating();\n                    this._updateButtonClasses(['requesting'], ['active', 'following']);\n                    this._setEvents(true);\n                    break;\n                case STATE_DISABLED:\n                    this._stopLocating();\n                    this._marker.removeFrom(this._map);\n                    this._setEvents(false);\n                    this._updateButtonClasses([], ['active', 'highlight', 'following', 'requesting']);\n                    break;\n                case STATE_ENABLED:\n                    this._updateButtonClasses(['active', 'highlight'], ['following', 'requesting']);\n                    break;\n                case STATE_MOVING_TO_FOLLOWING_FIRST:\n                    this._marker.addTo(this._map);\n                    break;\n                case STATE_ENABLED_FOLLOWING:\n                    this._updateButtonClasses(['active', 'highlight', 'following'], ['requesting']);\n                    break;\n                default:\n            }\n            this._state = newState;\n        },\n    }\n);\n\nexport {LocateControl};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport './style.css';\n\nconst ZoomWithDisplay = L.Control.Zoom.extend({\n    onAdd: function(map) {\n        const container = L.Control.Zoom.prototype.onAdd.call(this, map);\n        this._display = L.DomUtil.create('div', 'leaflet-control-zoom-display');\n        container.insertBefore(this._display, this._zoomOutButton);\n        map.on('zoomend', this._updateDisplay, this);\n        this._updateDisplay();\n        return container;\n    },\n\n    onRemove: function(map) {\n        L.Control.Zoom.prototype.onRemove.call(this, map);\n        map.off('zoomend', this._updateDisplay, this);\n    },\n\n    _updateDisplay: function() {\n        this._display.innerHTML = this._map.getZoom();\n    }\n\n});\n\nexport default ZoomWithDisplay;\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\n\nimport '~/lib/leaflet.hashState/leaflet.hashState';\n\nimport './style.css';\n\nconst Placemark = L.Marker.extend({\n    initialize: function(latlng, title) {\n        this.title = title;\n        const icon = L.divIcon({\n            html: '<div class=\"lealfet-placemark-title\"></div>',\n            className: 'leaflet-placemark',\n        });\n        L.Marker.prototype.initialize.call(this, latlng, {icon});\n    },\n\n    getTitle: function() {\n        return this.title;\n    },\n\n    onAdd: function(map) {\n        L.Marker.prototype.onAdd.call(this, map);\n        this.getElement().children[0].innerHTML = this.title;\n        this.on('click', this.onClick, this);\n        map.on('click', this.onMapClick, this);\n        map.suggestedPoint = {latlng: this.getLatLng(), title: this.title};\n    },\n\n    onRemove: function(map) {\n        this._map.off('move', this.onMapMove, this);\n        this._map.off('click', this.onMapClick, this);\n        this._map.suggestedPoint = null;\n        L.Marker.prototype.onRemove.call(this, map);\n    },\n\n    onClick: function() {\n        this._map.fire('click', {latlng: this.getLatLng(), suggested: true});\n        this._map.removeLayer(this);\n    },\n\n    onMapClick: function(e) {\n        if (!e.suggested) {\n            this._map.removeLayer(this);\n        }\n    },\n});\n\nL.Map.include({\n    showPlacemark: function(latlng, title) {\n        if (this._placemark) {\n            this.removeLayer(this._placemark);\n        }\n        this._placemark = new Placemark(latlng, title);\n        this.addLayer(this._placemark);\n        this.fire('placemarkshow');\n        this._placemark.on('remove', this.onPlacemarkRemove, this);\n    },\n\n    onPlacemarkRemove: function() {\n        this._placemark = null;\n        this.fire('placemarkhide');\n    },\n});\n\nconst PlacemarkHashStateInterface = L.Class.extend({\n    includes: L.Mixin.HashState,\n\n    stateChangeEvents: ['placemarkshow', 'placemarkhide'],\n\n    initialize: function(map) {\n        this.map = map;\n        this.stateChangeEventsSource = 'map';\n    },\n\n    serializeState: function() {\n        const placemark = this.map._placemark;\n        if (!placemark) {\n            return null;\n        }\n        const latlng = placemark.getLatLng();\n        return [latlng.lat.toFixed(6), latlng.lng.toFixed(6), encodeURIComponent(placemark.getTitle())];\n    },\n\n    unserializeState: function(values) {\n        if (!values) {\n            return false;\n        }\n        const lat = parseFloat(values[0]);\n        const lng = parseFloat(values[1]);\n        const title = decodeURIComponent(values[2] ?? '');\n        if (isNaN(lat) || isNaN(lng) || lat < -90 || lat > 90 || lng < -180 || lng > 180) {\n            return false;\n        }\n        this.map.showPlacemark(L.latLng(lat, lng), title);\n        return true;\n    },\n});\n\nL.Map.include({\n    getPlacemarkHashStateInterface: function() {\n        return new PlacemarkHashStateInterface(this);\n    },\n});\n","// extracted by mini-css-extract-plugin\nexport {};"],"sourceRoot":""}