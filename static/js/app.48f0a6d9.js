/*! For license information please see app.48f0a6d9.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[0],Array(51).concat([function(t,e,n){"use strict";n(14),n(43),Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return i.default.CORSProxyUrl+t.replace(/^(https?):\/\//,"$1/")};var r,i=(r=n(111))&&r.__esModule?r:{default:r}},,,,function(t,e,n){"use strict";n(1),n(18),n(19),n(0),n(20),n(14),n(5),n(43),n(41),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n(30);var r=n(67);function i(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.origUrl=e}var e,n,a,s,l;return e=t,(n=[{key:"isOurUrl",value:function(){throw new Error("Method not implemented")}},{key:"requestOptions",value:function(){throw new Error("Method not implemented")}},{key:"parseResponse",value:function(){throw new Error("Method not implemented")}},{key:"geoData",value:(s=regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isOurUrl()){t.next=2;break}throw new Error("Unsupported url");case 2:return e=this.requestOptions().map((function(t){return(0,r.fetch)(t.url,t.options)})),t.prev=3,t.next=6,Promise.all(e);case 6:n=t.sent,t.next=12;break;case 9:return t.prev=9,t.t0=t.catch(3),t.abrupt("return",[{name:this.origUrl,error:"NETWORK"}]);case 12:return t.abrupt("return",this.parseResponse(n));case 13:case"end":return t.stop()}}),t,this,[[3,9]])})),l=function(){var t=this,e=arguments;return new Promise((function(n,r){var o=s.apply(t,e);function a(t){i(o,n,r,a,l,"next",t)}function l(t){i(o,n,r,a,l,"throw",t)}a(void 0)}))},function(){return l.apply(this,arguments)})},{key:"nameFromUrl",value:function(t){try{t=decodeURIComponent(t)}catch(t){}return t.split("#")[0].split("?")[0].replace(/\/*$/,"").split("/").pop()}}])&&o(e.prototype,n),a&&o(e,a),t}();e.default=a},,,,,,,,,,,,function(t,e,n){"use strict";n(7),n(10),n(11),n(15),n(45),n(13),n(1),n(8),n(57),n(2),n(24),n(6),n(308),n(28),n(35),n(29),n(0),n(20),n(39),n(4),n(5),n(3),n(25),Object.defineProperty(e,"__esModule",{value:!0}),e.fetch=function(t,e){var n=new k(t,e);return n.send(),n},e.XHRQueue=void 0;var r=n(112);function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||a(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=a(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw o}}}}function a(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),t}function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){return!e||"object"!==c(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t){var e="function"==typeof Map?new Map:void 0;return(h=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return p(t,arguments,y(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),v(r,t)})(t)}function p(t,e,n){return(p=m()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&v(i,n.prototype),i}).apply(null,arguments)}function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function g(t){return t.status>=200&&t.status<=299}function b(t){return 0===t.status||t.status>=500}var w=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(i,t);var e,n,r=(e=i,n=m(),function(){var t,r=y(e);if(n){var i=y(this).constructor;t=Reflect.construct(r,arguments,i)}else t=r.apply(this,arguments);return d(this,t)});function i(t){var e;return f(this,i),(e=r.call(this)).xhr=t,e.name="XMLHttpRequestPromiseError",e.message=0===t.status?"network error":"server response is ".concat(t.status),e}return i}(h(Error)),k=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.method,s=void 0===a?"GET":a,l=r.data,u=void 0===l?null:l,c=r.responseType,d=void 0===c?"":c,h=r.timeout,p=void 0===h?3e4:h,m=r.maxTries,v=void 0===m?3:m,y=r.retryTimeWait,w=void 0===y?500:y,k=r.isResponseSuccess,_=void 0===k?g:k,S=r.responseNeedsRetry,x=void 0===S?b:S,O=r.headers,P=void 0===O?null:O,L=r.withCredentials,C=void 0!==L&&L;f(this,t);var M=new Promise((function(t,e){n._resolve=t,n._reject=e}));this.then=M.then.bind(M),this.catch=M.catch.bind(M),this.method=s,this.url=e,this.responseType=d,this.postData=u,this._isResponseSuccess=_,this._responseNeedsRetry=x,this._retryTimeWait=w,this.triesLeft=v;var j=this.xhr=new XMLHttpRequest;if(j.onreadystatechange=function(){return n._onreadystatechange()},this._open(),j.timeout=p,j.responseType="binarystring"===d?"arraybuffer":d,P){var T,D=o(P);try{for(D.s();!(T=D.n()).done;){var q=i(T.value,2),E=q[0],I=q[1];j.setRequestHeader(E,I)}}catch(t){D.e(t)}finally{D.f()}}j.withCredentials=C}return u(t,[{key:"_open",value:function(){this.xhr.open(this.method,this.url)}},{key:"_onreadystatechange",value:function(){var t=this,e=this.xhr;if(4===e.readyState&&!this._aborted){if(e.responseBinaryText="","binarystring"===this.responseType&&e.response&&e.response.byteLength&&(e.responseBinaryText=(0,r.arrayBufferToString)(e.response)),"json"===this.responseType&&"string"==typeof e.response)try{e.responseJSON=JSON.parse(e.response)}catch(t){e.responseJSON=null}else e.responseJSON=e.response;this._isResponseSuccess(e)?this._resolve(e):this.triesLeft>0&&this._responseNeedsRetry(e)?(this._open(),this._timerId=setTimeout((function(){return t.send()}),this._retryTimeWait)):this._reject(new w(e))}}},{key:"abort",value:function(){this._aborted=!0,clearTimeout(this._timerId),this.xhr.abort()}},{key:"send",value:function(){this.triesLeft-=1,this.xhr.send(this.postData)}}]),t}(),_=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;f(this,t),this._maxConnections=e,this._queue=[],this._activeCount=0}return u(t,[{key:"put",value:function(t,e){var n=this,r=new k(t,e);return r._originalAbort=r.abort,r.abort=function(){return n._abortPromise(r)},this._queue.push(r),this._processQueue(),r}},{key:"_abortPromise",value:function(t){var e=this,n=this._queue.indexOf(t);n>-1?this._queue.splice(n,1):4===t.xhr.readyState||(t._originalAbort(),this._activeCount-=1,setTimeout((function(){return e._processQueue()}),0))}},{key:"_processQueue",value:function(){var t=this;if(!(this._activeCount>=this._maxConnections||0===this._queue.length)){var e=this._queue.shift();e.catch((function(){})).then((function(){return t._onRequestReady(e)})),this._activeCount+=1,e.send()}}},{key:"_onRequestReady",value:function(t){var e=this;t._aborted||(this._activeCount-=1),setTimeout((function(){return e._processQueue()}),0)}}]),t}();e.XHRQueue=_},function(t,e,n){"use strict";n(148),Object.defineProperty(e,"__esModule",{value:!0}),e.stopContainerEvents=o,e.makeButton=a,e.makeButtonWithBar=function(t,e,n){var r="leaflet-control button-with-bar";t&&(r+=" "+t);var s=i.default.DomUtil.create("div",r),l=a(null,e,n,!0),u=l.container,c=l.link,f=l.icon;s.appendChild(u);var d=i.default.DomUtil.create("div","leaflet-bar bar",s);return o(d),{container:s,buttonContainer:u,link:c,icon:f,barContainer:d}};var r,i=(r=n(9))&&r.__esModule?r:{default:r};function o(t){i.default.DomEvent.disableClickPropagation(t),i.default.DomEvent.disableScrollPropagation(t),i.default.DomEvent.on(t,"mousemove contextmenu",i.default.DomEvent.stop)}function a(t,e,n,r){var a="leaflet-bar leaflet-control-single-button";r||(a+=" leafletControl"),t&&(a+=" "+t);var s=i.default.DomUtil.create("div",a);o(s);var l=i.default.DomUtil.create("a",null,s);return l.href="#",i.default.DomEvent.on(l,"click",i.default.DomEvent.preventDefault),e&&(l.title=e),{container:s,link:l,icon:i.default.DomUtil.create("div",n,l)}}n(411),i.default.Control.include({_stopContainerEvents:function(){o(this._container)}})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n(2),n(0),n(4),Object.defineProperty(e,"__esModule",{value:!0}),e.captureMessage=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.url=window.location.toString(),console.log("captureMessage",t,e),i.withScope((function(n){n.setExtras(e),i.captureMessage(t)}))},e.captureException=function(t,e){console.log("captureException",t,e),i.withScope((function(n){e&&n.setTag("description",e),n.setExtra("url",window.location.toString()),i.captureException(t)}))},e.captureBreadcrumb=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.url=window.location.toString(),i.addBreadcrumb({message:t,data:e})},e.logEvent=function(t,e){console.log(t,e)},e.randId=a;var i=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var e=o();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var s=i?Object.getOwnPropertyDescriptor(t,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=t[a]}n.default=t,e&&e.set(t,n);return n}(n(242));function o(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return o=function(){return t},t}function a(){return Math.random().toString(36).substring(2,13)}a()},,,,,,function(t,e,n){"use strict";n(25),Object.defineProperty(e,"__esModule",{value:!0}),e.notify=function(t,e){i.default.alert(t,e)},e.query=function(t,e){var n=window.prompt(t,e);return setTimeout((function(){var t=document.activeElement;"INPUT"===(null==t?void 0:t.tagName)&&t.blur()}),0),n};var r,i=(r=n(400))&&r.__esModule?r:{default:r};n(401)},,,,,,,,function(t,e,n){"use strict";n(7),n(46),n(22),n(62),n(19),n(59),n(96),n(34),n(23),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n(386))&&r.__esModule?r:{default:r};function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var s=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({caption:"",defaultLocation:[44.47716,33.9196],defaultZoom:12,googleApiUrl:"https://maps.googleapis.com/maps/api/js?v=3&key=".concat(i.default.google),westraDataBaseUrl:"https://nakarte.me/westraPasses/",CORSProxyUrl:"https://proxy.nakarte.me/",elevationsServer:"https://api.crimea-map.com/elevation",wikimediaCommonsCoverageUrl:"https://tiles.nakarte.me/wikimedia_commons_images/{z}/{x}/{y}",geocachingSuUrl:"https://nakarte.me/geocachingSu/geocaching_su2.json",tracksStorageServer:"https://tracks.nakarte.me"},i.default);e.default=s},function(t,e,n){"use strict";function r(t){for(var e=t.length,n=new ArrayBuffer(e),r=new Uint8Array(n),i=0;i<e;i++)r[i]=t.charCodeAt(i);return n}n(1),n(31),n(183),n(69),n(0),n(107),n(70),n(71),n(72),n(73),n(74),n(75),n(76),n(77),n(78),n(79),n(80),n(81),n(82),n(83),n(84),n(85),n(86),n(87),n(88),n(89),n(90),n(91),n(92),Object.defineProperty(e,"__esModule",{value:!0}),e.arrayBufferToString=function(t){for(var e=new Uint8Array(t),n=[],r=0;r<e.length;r+=4096){var i=e.subarray(r,r+4096);i=String.fromCharCode.apply(null,i),n.push(i)}return n.join("")},e.blobFromString=function(t){var e=r(t);return new Blob([e],{type:"text/plain;charset=utf-8"})},e.stringToArrayBuffer=r},,,,,,,,,,function(t,e,n){"use strict";n.r(e)},,,,,,function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n(22),n(23);var i,o=(i=n(9))&&i.__esModule?i:{default:i},a=n(214),s=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var e=l();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var a=i?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=t[o]}n.default=t,e&&e.set(t,n);return n}(n(97));function l(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return l=function(){return t},t}o.default.Mixin.HashState={enableHashState:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._hashStateKey=t;var r=this.stateChangeEventsSource?this[this.stateChangeEventsSource]:this;this.stateChangeEvents&&this.stateChangeEvents.forEach((function(t){r.on(t,e._onControlStateChanged,e)})),a.hashState.addEventListener(t,(function(t){return e._onExternalStateChanged(t)}));var i=a.hashState.getState(t)||n;return i&&this.unserializeState(i)||this.unserializeState(n),a.hashState.updateState(this._hashStateKey,this.serializeState()),this},_onControlStateChanged:function(){var t=this.serializeState();a.hashState.updateState(this._hashStateKey,t)},_onExternalStateChanged:function(t){this.unserializeState(t)||(s.captureMessage('Invalid state in hash string (key "'.concat(this._hashStateKey,'")')),a.hashState.updateState(this._hashStateKey,this.serializeState()))}}},function(t,e,n){"use strict";n(7),n(10),n(11),n(16),n(15),n(13),n(1),n(8),n(2),n(6),n(0),n(54),n(14),n(4),n(5),n(43),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=n(130),o=n(291),a=(r=n(219))&&r.__esModule?r:{default:r};function s(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var u=function(t,e,n){var r,l;function u(t){for(var e=t.getElementsByTagName("trkpt"),n=[],i=0;i<e.length;i++){var o=e[i],a=parseFloat(o.getAttribute("lat")),s=parseFloat(o.getAttribute("lon"));if(isNaN(a)||isNaN(s)){r="CORRUPT";break}n.push({lat:a,lng:s})}return n}function c(t){for(var e=t.getElementsByTagName("rtept"),n=[],i=0;i<e.length;i++){var o=e[i],a=parseFloat(o.getAttribute("lat")),s=parseFloat(o.getAttribute("lon"));if(isNaN(a)||isNaN(s)){r="CORRUPT";break}n.push({lat:a,lng:s})}return n}t=(t=(0,a.default)(t)).replace(/<((?:(?![ >])[\s\S])+):((?:(?![ >])[\s\S])+)/g,"<$1_$2");try{l=(new DOMParser).parseFromString(t,"text/xml")}catch(t){return null}if("parsererror"===l.documentElement.nodeName)return null;if(0===l.getElementsByTagName("gpx").length)return null;if(n)for(var f=0,d=s(l.getElementsByTagName("trk"));f<d.length;f++){var h=d[f].getElementsByTagName("name")[0];if(h){try{h=(0,i.decode)((0,o.xmlGetNodeText)(h))}catch(t){r="CORRUPT"}if(h.length){e=h;break}}}return[{name:e,tracks:function(t){for(var e=[],n=t.getElementsByTagName("trkseg"),r=0;r<n.length;r++){var i=u(n[r]);i.length&&e.push(i)}return e}(l).concat(function(t){for(var e=[],n=t.getElementsByTagName("rte"),r=0;r<n.length;r++){var i=c(n[r]);i.length&&e.push(i)}return e}(l)),points:function(t){for(var e=t.getElementsByTagName("wpt"),n=[],a=0;a<e.length;a++){var s=e[a],l={};if(l.lat=parseFloat(s.getAttribute("lat")),l.lng=parseFloat(s.getAttribute("lon")),isNaN(l.lat)||isNaN(l.lng))r="CORRUPT";else{var u=(0,o.xmlGetNodeText)(s.getElementsByTagName("name")[0])||"";try{u=(0,i.decode)(u)}catch(t){r="CORRUPT",u="__invalid point name__"}l.name=u,l.symbol_name=(0,o.xmlGetNodeText)(s.getElementsByTagName("sym")[0]),n.push(l)}}return n}(l),error:r}]};e.default=u},,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";function r(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw a}}}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n(7),n(10),n(11),n(15),n(13),n(1),n(8),n(2),n(24),n(6),n(19),n(0),n(4),n(5),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n(30),n(384);var s=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),a(this,"onKeyDown",(function(t){27===t.keyCode&&n.hide()})),a(this,"onMouseDown",(function(t){(function(t,e){if(!t)return!1;for(;e;){if(e===t)return!0;e=e.parentNode}return!1})(n._container,t.target)||n.hide()})),this.items=e}var e,n,i;return e=t,(n=[{key:"show",value:function(t){if(!this._container){t.originalEvent&&(t=t.originalEvent),t.preventDefault?t.preventDefault():t.returnValue=!1;var e=t,n=e.clientX,i=e.clientY,o=this._container=document.createElement("div");document.body.appendChild(o),o.className="contextmenu",o.style.zIndex=1e4,window.addEventListener("keydown",this.onKeyDown,!0),window.addEventListener("mousedown",this.onMouseDown,!0),window.addEventListener("touchstart",this.onMouseDown,!0);var a,s=r(this.createItems());try{for(s.s();!(a=s.n()).done;){var l=a.value;o.appendChild(l)}}catch(t){s.e(t)}finally{s.f()}this.setPosition(n,i)}}},{key:"hide",value:function(){this._container&&(document.body.removeChild(this._container),this._container=null,window.removeEventListener("keydown",this.onKeyDown,!0),window.removeEventListener("mousedown",this.onMouseDown,!0),window.removeEventListener("touchstart",this.onMouseDown,!0))}},{key:"setPosition",value:function(t,e){var n=window.innerWidth,r=window.innerHeight,i=this._container.offsetWidth,o=this._container.offsetHeight;t+i>=n&&(t-=i)<0&&(t=0),e+o>=r&&(e-=o)<0&&(e=0),this._container.style.left="".concat(t,"px"),this._container.style.top="".concat(e,"px")}},{key:"createItems",value:regeneratorRuntime.mark((function t(){var e,n,i,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:"function"==typeof(e=this.items)&&(e=e()),n=r(e),t.prev=3,n.s();case 5:if((i=n.n()).done){t.next=17;break}if("function"==typeof(o=i.value)&&(o=o()),"-"!==o&&!o.separator){t.next=13;break}return t.next=11,this.createSeparator(o);case 11:t.next=15;break;case 13:return t.next=15,this.createItem(o);case 15:t.next=5;break;case 17:t.next=22;break;case 19:t.prev=19,t.t0=t.catch(3),n.e(t.t0);case 22:return t.prev=22,n.f(),t.finish(22);case 25:case"end":return t.stop()}}),t,this,[[3,19,22,25]])}))},{key:"createItem",value:function(t){var e=document.createElement("a"),n="item";t.disabled&&(n+=" disabled"),t.header&&(n+=" header"),e.innerHTML=t.text;var r=t.callback;return r&&!t.disabled&&(n+=" action",e.addEventListener("click",this.onItemClick.bind(this,r))),e.className=n,e}},{key:"onItemClick",value:function(t,e){e.stopPropagation(),e.preventDefault(),this.hide(),t(e)}},{key:"createSeparator",value:function(t){var e=document.createElement("div");return e.className="separator",t.text&&(e.innerHTML="<span>".concat(t.text,"</span>")),e}}])&&o(e.prototype,n),i&&o(e,i),t}();e.default=s},,function(t,e,n){"use strict";var r;if(n(34),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,function(){try{return window.localStorage.setItem("_testDummy","TEST"),"TEST"===window.localStorage.getItem("_testDummy")}catch(t){return!1}}())r=window.localStorage;else{var i={};r={length:0,key:function(t){return Object.keys(i)[t]},removeItem:function(t){delete i[t]},getItem:function(t){return r[t]},setItem:function(t,e){r[t]=e},clear:function(){i={}}}}var o=r;e.default=o},,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";n(7),n(10),n(11),n(46),n(22),n(15),n(13),n(1),n(8),n(2),n(6),n(28),n(19),n(213),n(35),n(29),n(0),n(20),n(39),n(14),n(4),n(5),n(184),n(23),n(3),n(25),n(30);var r=s(n(9));n(403);var i=s(n(404)),o=s(n(405)),a=n(170);function s(t){return t&&t.__esModule?t:{default:t}}function l(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||b(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t){return function(t){if(Array.isArray(t))return w(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||b(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function m(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y(t);if(e){var i=y(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v(this,n)}}function v(t,e){return!e||"object"!==f(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function g(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=b(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function b(t,e){if(t){if("string"==typeof t)return w(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(t,e):void 0}}function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function k(t,e){var n,r,i,o,a,s,l=0,u=g(e);try{for(u.s();!(s=u.n()).done;)a=s.value,n=Math.max(t.minX,a.minX),r=Math.min(t.maxX,a.maxX),(i=Math.max(t.minY,a.minY))<(o=Math.min(t.maxY,a.maxY))&&n<r&&(l+=(r-n)*(o-i))}catch(t){u.e(t)}finally{u.f()}return l}var _,S,x=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(o,t);var e,n,r,i=m(o);function o(){return d(this,o),i.apply(this,arguments)}return e=o,(n=[{key:"toBBox",value:function(t){var e=t.latlng.lng,n=t.latlng.lat;return{minX:e,minY:n,maxX:e,maxY:n}}},{key:"compareMinX",value:function(t,e){return t.latlng.lng-e.latlng.lng}},{key:"compareMinY",value:function(t,e){return t.latlng.lat-e.latlng.lat}}])&&h(e.prototype,n),r&&h(e,r),o}(i.default);r.default.Layer.CanvasMarkers=r.default.GridLayer.extend({options:{async:!0,labelFontName:"Verdana, Arial, sans-serif",labelFontSize:10,iconScale:1,pane:"rasterMarker",updateWhenZooming:!r.default.Browser.mobile,iconsOpacity:1,labelShadowWidth:1},initialize:function(t,e){r.default.GridLayer.prototype.initialize.call(this,e),this.rtree=new x(9),this._regions=new i.default,this._iconPositions={},this._labelPositions={},this._labelPositionsZoom=null,this.addMarkers(t),this._images={},this._tileQueue=[],this._hoverMarker=null,this.on("markerenter",this.onMarkerEnter,this),this.on("markerleave",this.onMarkerLeave,this)},addMarkers:function(t){var e=this;t&&(this.rtree.load(t),this.resetLabels(),setTimeout((function(){return e.redraw()}),0))},addMarker:function(t){var e=this;this.rtree.insert(t),this.resetLabels(),setTimeout((function(){return e.redraw()}),0)},removeMarker:function(t){this.removeMarkers([t])},removeMarkers:function(t){var e=this;t.forEach((function(t){return e.rtree.remove(t)})),this.resetLabels(),setTimeout((function(){return e.redraw()}),0)},updateMarkers:function(t){this.removeMarkers(t),this.addMarkers(t)},updateMarker:function(t){this.updateMarkers([t])},setMarkerPosition:function(t,e){this.removeMarker(t),t.latlng=e,this.addMarker(t)},getMarkers:function(){return this.rtree.all()},findLabelPosition:function(t,e,n,r,i){for(var o=[t[0]+e[0]/2+2,t[0]-e[0]/2-n-2],a=[t[1]-r/2+0,t[1]-.75*r-e[1]/4+0,t[1]-r/4+e[1]/4+0,t[1]-r-e[1]/2+0,t[1]+e[1]/2+0],s=1/0,l=o[0],u=a[0],c=0,f=o;c<f.length;c++){var d,h=f[c],p=g(a);try{for(p.s();!(d=p.n()).done;){var m=d.value,v={minX:h,minY:m,maxX:h+n,maxY:m+r};if(!i||!(v.minX<i.tileW||v.maxX>i.tileE||v.minY<i.tileN||v.maxY>i.tileS)){var y=k(v,this._regions.search(v));if(y<s&&(l=h,u=m,0===(s=y)))break}}}catch(t){p.e(t)}finally{p.f()}if(0===s)break}return[l,u]},preloadIcons:function(t){var e=this,n=t.filter((function(t){return!(t in e._images)}));return n.length?(0,o.default)(n).then((function(t){var n,r=g(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;e._images[i.src]=i}}catch(t){r.e(t)}finally{r.f()}})):Promise.resolve()},createTile:function(t,e){var n=this,i=r.default.DomUtil.create("canvas","leaflet-tile");return i.width=this.options.tileSize,i.height=this.options.tileSize,setTimeout((function(){n.drawTile(i,t).then((function(){return e(null,i)}))}),0),i},selectMarkersForDraw:function(t,e,n){var i=t.tileN,o=t.tileS,s=t.tileE,l=t.tileW;if(!this._map)return{};for(var u=n?0:520,f=n?0:50,d=n?0:256,h=n?0:20,p=r.default.latLngBounds(this._map.unproject(r.default.point(l-u,o+u),e),this._map.unproject(r.default.point(s+u,i-f),e)),m=r.default.latLngBounds(this._map.unproject(r.default.point(l-d,o+d),e),this._map.unproject(r.default.point(s+d,i-h),e)),v=[],y={},g=[],b=0,w=[-360,0,360];b<w.length;b++){var k=w[b];g.push.apply(g,c(this.rtree.search({minX:p.getWest()+k,minY:p.getSouth(),maxX:p.getEast()+k,maxY:p.getNorth()})))}for(var _=[],S=0,x=[-360,0,360];S<x.length;S++){var O=x[S];_.push.apply(_,c(this.rtree.search({minX:m.getWest()+O,minY:m.getSouth(),maxX:m.getEast()+O,maxY:m.getNorth()})))}for(var P=this._map.unproject([(s+l)/2,i],e),L=0,C=g;L<C.length;L++){var M=C[L],j=M.latlng;this.options.noWrap&&(j=(0,a.wrapLatLngToTarget)(j,P));var T=this._map.project(j,e),D=M.icon;"function"==typeof D&&(D=D(M)),v.push(D.url),y[r.default.stamp(M)]={marker:M,icon:D,projectedXY:T}}return{iconUrls:v,markerJobs:y,pointsForLabels:_}},drawSelectedMarkers:function(t,e,n,i,o,a){var s=e.tileN,l=e.tileW,c=e.tileS,f=e.tileE,d=this.options.labelFontSize*this.options.iconScale;this._labelPositionsZoom!==o&&(this._labelPositionsZoom=o,this.resetLabels());var h=t.getContext("2d");h.font=r.default.Util.template("bold {size}px {name}",{name:this.options.labelFontName,size:this.options.labelFontSize*this.options.iconScale});for(var p=0,m=Object.entries(n);p<m.length;p++){var v=u(m[p],2),y=v[0],b=v[1],w=this._images[b.icon.url];b.img=w;var k=Math.round(w.width*this.options.iconScale),_=Math.round(w.height*this.options.iconScale);if(!(y in this._iconPositions)){var S=b.projectedXY.x-b.icon.center[0]*this.options.iconScale,x=b.projectedXY.y-b.icon.center[1]*this.options.iconScale;S=Math.round(S),x=Math.round(x),this._iconPositions[y]=[S,x],this._regions.insert({minX:S,minY:x,maxX:S+k,maxY:x+_,marker:b.marker,isLabel:!1})}var O=u(this._iconPositions[y],2),P=O[0],L=O[1];b.iconCenter=[P+k/2,L+_/2],b.iconSize=[k,_]}var C,M=g(i);try{for(M.s();!(C=M.n()).done;){var j=C.value,T=r.default.stamp(j),D=n[T],q=D.marker.label;if("function"==typeof q&&(q=q(D.marker,o)),q){if(D.label=q,!(T in this._labelPositions)){var E=h.measureText(q).width,I=this.findLabelPosition(D.iconCenter,D.iconSize,E,d,a?e:null);this._labelPositions[T]=I;var A=u(I,2),R=A[0],F=A[1];this._regions.insert({minX:R,minY:F,maxX:R+E,maxY:F+d,marker:D.marker,isLabel:!0})}}else this._labelPositions[T]=null}}catch(t){M.e(t)}finally{M.f()}var N,z=this._regions.search({minX:l,minY:s,maxX:f,maxY:c}),U=g(z);try{for(U.s();!(N=U.n()).done;){var Z=N.value;if(Z.isLabel){var B=r.default.stamp(Z.marker),W=n[B],G=this._labelPositions[B],K=G[0]-l,J=G[1]-s;h.textBaseline="bottom",h.shadowColor="#fff",h.strokeStyle="#fff",h.fillStyle="#000",h.lineWidth=1.2*this.options.iconScale,h.shadowBlur=this.options.labelShadowWidth*this.options.iconScale,h.strokeText(W.label,K,J+d),h.shadowBlur=0,h.fillText(W.label,K,J+d)}}}catch(t){U.e(t)}finally{U.f()}h.globalAlpha=this.options.iconsOpacity;var X,H=g(z);try{for(H.s();!(X=H.n()).done;){var V=X.value;if(!V.isLabel){var Y=r.default.stamp(V.marker),Q=n[Y],$=this._iconPositions[Y],tt=$[0]-l,et=$[1]-s;h.drawImage(Q.img,tt,et,Q.iconSize[0],Q.iconSize[1])}}}catch(t){H.e(t)}finally{H.f()}h.globalAlpha=1},drawTile:(_=regeneratorRuntime.mark((function t(e,n){var r,i,o,a,s,l,u,c,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.z,i=this.options.tileSize,o=n.y*i,a=n.x*i,s={tileN:o,tileS:o+i,tileE:a+i,tileW:a},l=this.selectMarkersForDraw(s,r),u=l.iconUrls,c=l.markerJobs,f=l.pointsForLabels,c){t.next=5;break}return t.abrupt("return");case 5:return t.next=7,this.preloadIcons(u);case 7:this.drawSelectedMarkers(e,s,c,f,r);case 8:case"end":return t.stop()}}),t,this)})),S=function(){var t=this,e=arguments;return new Promise((function(n,r){var i=_.apply(t,e);function o(t){l(i,n,r,o,a,"next",t)}function a(t){l(i,n,r,o,a,"throw",t)}o(void 0)}))},function(t,e){return S.apply(this,arguments)}),resetLabels:function(){this._iconPositions={},this._labelPositions={},this._regions.clear()},findMarkerFromMouseEvent:function(t){var e=this._map.project(t.latlng.wrap()),n=this._regions.search({minX:e.x,minY:e.y,maxX:e.x,maxY:e.y})[0];return n?n.marker:null},onMouseMove:function(t){var e=this.findMarkerFromMouseEvent(t);this._hoverMarker!==e&&(this._hoverMarker&&this.fire("markerleave",{marker:this._hoverMarker}),e&&this.fire("markerenter",{marker:e}),this._hoverMarker=e)},showTooltip:function(t){if(t.marker.tooltip){var e=t.marker.tooltip;if("function"!=typeof e||(e=e(t.marker),t.marker.tooltip)){this.toolTip.innerHTML=e;var n=this._map.latLngToLayerPoint(t.marker.latlng);r.default.DomUtil.setPosition(this.toolTip,n),r.default.DomUtil.addClass(this.toolTip,"canvas-marker-tooltip-on")}}},onMarkerEnter:function(t){this._map._container.style.cursor="pointer",this.showTooltip(t)},onMarkerLeave:function(){this._map._container.style.cursor="",r.default.DomUtil.removeClass(this.toolTip,"canvas-marker-tooltip-on")},onMouseOut:function(){if(this._hoverMarker){var t=this._hoverMarker;this._hoverMarker=null,this.fire("markerleave",{marker:t})}},onClick:function(t){if(!this._map.clickLocked){var e=this.findMarkerFromMouseEvent(t);e&&(r.default.extend(t,{marker:e}),this.fire("markerclick",t))}},onRightClick:function(t){var e=this.findMarkerFromMouseEvent(t);e&&(r.default.extend(t,{marker:e}),this.fire("markercontextmenu",t))},onAdd:function(t){"rasterMarker"!==this.options.pane||t.getPane("rasterMarker")||(t.createPane("rasterMarker").style.zIndex=550),r.default.GridLayer.prototype.onAdd.call(this,t),t.on("mousemove",this.onMouseMove,this),t.on("mouseout",this.onMouseOut,this),t.on("click",this.onClick,this),t.on("contextmenu",this.onRightClick,this),this.toolTip=r.default.DomUtil.create("div","canvas-marker-tooltip",this._map.getPanes().markerPane)},onRemove:function(t){this._map.off("mousemove",this.onMouseMove,this),this._map.off("mouseout",this.onMouseOut,this),this._map.off("click",this.onClick,this),this._map.off("contextmenu",this.onRightClick,this),this._hoverMarker&&(this._hoverMarker=null,this.fire("markerleave",{marker:this._hoverMarker})),this._map.getPanes().markerPane.removeChild(this.toolTip),r.default.GridLayer.prototype.onRemove.call(this,t)}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.wrapLatLngToTarget=a,e.fixVectorMarkerWorldJump=function(){i.default.Polyline.prototype.shiftProjectedFitMapView=function(){var t=this.getBounds(),e=null;if(this._map&&t.isValid()){var n=this._map.getPixelWorldBounds().getSize().x,r=t.getCenter(),i=this._map.getCenter();e=r.lng<i.lng-180?n:r.lng>i.lng+180?-n:0}return e},i.default.Polyline.prototype._projectLatlngs=function(t,e,n){var r,o,a=t[0]instanceof i.default.LatLng,s=t.length,l=null;if(this.options.projectedShift&&(l=this.options.projectedShift()),null===l&&(l=this.shiftProjectedFitMapView()),a){for(o=[],r=0;r<s;r++){var u=this._map.latLngToLayerPoint(t[r]);u.x+=l,o[r]=u,n.extend(u)}e.push(o)}else for(r=0;r<s;r++)this._projectLatlngs(t[r],e,n)},i.default.Marker.prototype.update=function(){if(this._icon){var t=this._map.latLngToLayerPoint(this._latlng).round(),e=null;if(this.options.projectedShift&&(e=this.options.projectedShift()),null===e){var n=this._map.getCenter(),r=this._map.getPixelWorldBounds().getSize().x;e=this._latlng.lng<n.lng-180?r:this._latlng.lng>n.lng+180?-r:0}t.x+=e,this._setPos(t)}return this},i.default.Map.addInitHook((function(){var t=this;this._lastResetLongitude=null,this.on("viewreset",(function(){t._lastResetLongitude=t.getCenter().lng})),this.on("move",(function(){var e=t.getCenter().lng;null===t._lastResetLongitude?t._lastResetLongitude=e:Math.abs(e-t._lastResetLongitude)>90&&t.fire("viewreset")}))})),i.default.Handler.MarkerDrag=i.default.Handler.extend({_onDrag:function(t){var e=this._marker,n=e._shadow,r=i.default.DomUtil.getPosition(e._icon),o=e._map.layerPointToLatLng(r);n&&i.default.DomUtil.setPosition(n,r),o=a(o,e._latlng),e._latlng=o,t.latlng=o,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)}})},e.wrapLatLngBoundsToTarget=function(t,e){var n=o(t.getCenter().lng,e),r=t.getSouthEast(),a=t.getNorthWest();return i.default.latLngBounds([[r.lat,r.lng+n],[a.lat,a.lng+n]])};var r,i=(r=n(9))&&r.__esModule?r:{default:r};function o(t,e){if(e instanceof i.default.LatLngBounds){if(!e.isValid())return 0;e=e.getCenter().lng}else{var n;e=null!==(n=e.lng)&&void 0!==n?n:e}var r=0;return Math.abs(t+360-e)<Math.abs(t-e)?r=360:Math.abs(t-360-e)<Math.abs(t-e)&&(r=-360),r}function a(t,e){var n=o(t.lng,e);return i.default.latLng(t.lat,t.lng+n)}},function(t,e,n){"use strict";n(16),n(6),n(14),n(43),n(41),n(25),Object.defineProperty(e,"__esModule",{value:!0}),e.saveAs=void 0;var r=r||function(t){if(!(void 0===t||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=t.document,n=function(){return t.URL||t.webkitURL||t},r=e.createElementNS("http://www.w3.org/1999/xhtml","a"),i="download"in r,o=/constructor/i.test(t.HTMLElement)||t.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent),s=t.setImmediate||t.setTimeout,l=function(t){s((function(){throw t}),0)},u=function(t){setTimeout((function(){"string"==typeof t?n().revokeObjectURL(t):t.remove()}),4e4)},c=function(t){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t},f=function(e,f,d){d||(e=c(e));var h,p=this,m="application/octet-stream"===e.type,v=function(){!function(t,e,n){for(var r=(e=[].concat(e)).length;r--;){var i=t["on"+e[r]];if("function"==typeof i)try{i.call(t,n||t)}catch(t){l(t)}}}(p,"writestart progress write writeend".split(" "))};if(p.readyState=p.INIT,i)return h=n().createObjectURL(e),void s((function(){var t,e;r.href=h,r.download=f,r.target="_self",t=r,e=new MouseEvent("click"),t.dispatchEvent(e),v(),u(h),p.readyState=p.DONE}),0);!function(){if((a||m&&o)&&t.FileReader){var r=new FileReader;return r.onloadend=function(){var e=a?r.result:r.result.replace(/^data:[^;]*;/,"data:attachment/file;");t.open(e,"_blank")||(t.location.href=e),e=void 0,p.readyState=p.DONE,v()},r.readAsDataURL(e),void(p.readyState=p.INIT)}(h||(h=n().createObjectURL(e)),m)?t.location.href=h:t.open(h,"_blank")||(t.location.href=h);p.readyState=p.DONE,v(),u(h)}()},d=f.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(t,e,n){return e=e||t.name||"download",n||(t=c(t)),navigator.msSaveOrOpenBlob(t,e)}:(d.abort=function(){},d.readyState=d.INIT=0,d.WRITING=1,d.DONE=2,d.error=d.onwritestart=d.onprogress=d.onwrite=d.onabort=d.onerror=d.onwriteend=null,function(t,e,n){return new f(t,e||t.name||"download",n)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||void 0);e.saveAs=r},,function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n(7),n(10),n(11),n(16),n(46),n(22),n(15),n(65),n(45),n(13),n(1),n(31),n(313),n(18),n(154),n(105),n(8),n(57),n(2),n(24),n(6),n(50),n(62),n(19),n(59),n(96),n(34),n(0),n(53),n(20),n(14),n(4),n(106),n(5),n(52),n(286),n(43),n(99),n(23),n(3),n(25),Object.defineProperty(e,"__esModule",{value:!0}),e.TRACKLIST_TRACK_COLORS=void 0,n(30);var i=P(n(9)),o=P(n(121)),a=P(n(147));n(269),n(445);var s=n(446),l=P(n(218)),u=P(n(220)),c=O(n(470)),f=P(n(216)),d=n(171);n(169),n(471);var h=P(n(280));n(122);var p=n(297);n(68);var m=n(112);n(473),n(282);var v=O(n(97)),y=n(103),g=n(67),b=P(n(111)),w=P(n(475)),k=n(170),_=n(476),S=n(298);function x(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return x=function(){return t},t}function O(t){if(t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var e=x();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var a=i?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=t[o]}return n.default=t,e&&e.set(t,n),n}function P(t){return t&&t.__esModule?t:{default:t}}function L(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function C(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?L(Object(n),!0).forEach((function(e){M(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function M(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function j(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}function T(t){return function(t){if(Array.isArray(t))return E(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||q(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=q(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function q(t,e){if(t){if("string"==typeof t)return E(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?E(t,e):void 0}}function E(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var I=["#77f","#f95","#0ff","#FF0000","#f7f","#000","#008000"];e.TRACKLIST_TRACK_COLORS=I;var A,R,F=i.default.MeasuredLine.extend({includes:i.default.Polyline.EditMixin,options:{weight:6,lineCap:"round",opacity:.6}});function N(t,e,n){var r=i.default.CRS.EPSG3857;n=r.latLngToPoint(n);var o=r.latLngToPoint(t[e]),a=r.latLngToPoint(t[e+1]);return r.pointToLatLng(i.default.LineUtil.closestPointOnSegment(n,o,a))}function z(t,e){return e.distanceTo(t[0])<e.distanceTo(t[t.length-1])}F.mergeOptions(i.default.Polyline.EditMixinOptions),i.default.Control.TrackList=i.default.Control.extend({options:{position:"bottomright",lineCursorStyle:{interactive:!1,weight:1.5,opacity:1,dashArray:"7,7"},lineCursorValidStyle:{color:"green"},lineCursorInvalidStyle:{color:"red"},splitExtensions:["gpx","kml","kmz","wpt","rte","plt","fit","tmp","jpg","crdownload"],splitExtensionsFirstStage:["xml","txt","html","php","tmp","gz"]},includes:i.default.Evented,colors:I,initialize:function(){i.default.Control.prototype.initialize.call(this),this.tracks=o.default.observableArray(),this.url=o.default.observable(""),this.readingFiles=o.default.observable(0),this.readProgressRange=o.default.observable(),this.readProgressDone=o.default.observable(),this._lastTrackColor=0,this.trackListHeight=o.default.observable(0),this.isPlacingPoint=!1,this.trackAddingPoint=o.default.observable(null),this.trackAddingSegment=o.default.observable(null)},onAdd:function(t){var e=this;this.map=t,this.tracks.removeAll();var n=this._container=i.default.DomUtil.create("div","leaflet-control leaflet-control-tracklist");return this._stopContainerEvents(),n.innerHTML='\n                <div class="leaflet-control-button-toggle" data-bind="click: setExpanded"\n                 title="Load, edit and save tracks"></div>\n                <div class="leaflet-control-content">\n                <div class="header">\n                    <div class="hint"\n                     title="gpx kml Ozi zip YandexMaps GPSies Strava GPSLib Endomondo Etomesto Movescount GarminConnect SportsTracker OSM Tracedetrail OpenStreetMap.ru">\n                        gpx kml Ozi zip YandexMaps GPSies Strava\n                        <span class="formats-hint-more">&hellip;</span>\n                    </div>\n                    <div class="button-minimize" data-bind="click: setMinimized"></div>\n                </div>\n                <div class="inputs-row" data-bind="visible: !readingFiles()">\n                    <a class="button add-track" title="Создать новый трэк" data-bind="click: onButtonNewTrackClicked"></a\n                    ><a class="button open-file" title="Открыть файл с трэком" data-bind="click: loadFilesFromDisk"></a\n                    ><input type="text" class="input-url" placeholder="URL трэка"\n                        data-bind="textInput: url, event: {keypress: onEnterPressedInInput, contextmenu: defaultEventHandle, mousemove: defaultEventHandle}"\n                    ><a class="button download-url" title="Загрузить трэк по URL" data-bind="click: loadFilesFromUrl"></a\n                    ><a class="button menu-icon" data-bind="click: function(_,e){this.showMenu(e)}" title="Меню"></a>\n                </div>\n                <div style="text-align: center">\n                    <div data-bind="\n                        component: {\n                        name: \'progress-indicator\',\n                        params: {progressRange: readProgressRange, progressDone: readProgressDone}\n                        },\n                        visible: readingFiles"></div>\n                </div>\n                <div class="tracks-rows-wrapper" data-bind="style: {maxHeight: trackListHeight}">\n                <table class="tracks-rows"><tbody data-bind="foreach: {data: tracks, as: \'track\'}">\n                    <tr data-bind="event: {\n                                       contextmenu: $parent.showTrackMenu.bind($parent),\n                                       mouseenter: $parent.onTrackRowMouseEnter.bind($parent, track),\n                                       mouseleave: $parent.onTrackRowMouseLeave.bind($parent, track)\n                                   },\n                                   css: {hover: hover() && $parent.tracks().length > 1, edit: isEdited() && $parent.tracks().length > 1}">\n                        <td><input type="checkbox" class="visibility-switch" data-bind="checked: track.visible"></td>\n                        <td><div class="color-sample" data-bind="style: {backgroundColor: $parent.colors[track.color()]}, click: $parent.onColorSelectorClicked.bind($parent)"></div></td>\n                        <td><div class="track-name-wrapper"><div class="track-name" data-bind="text: track.name, attr: {title: track.name}, click: $parent.setViewToTrack.bind($parent)"></div></div></td>\n                        <td>\n                            <div class="button-length" title="Show distance marks" data-bind="\n                                text: $parent.formatLength(track.length()),\n                                css: {\'ticks-enabled\': track.measureTicksShown},\n                                click: $parent.switchMeasureTicksVisibility.bind($parent)"></div>\n                        </td>\n                        <td><div class="button-add-track" title="Добавить сегмент" data-bind="click: $parent.onButtonAddSegmentClicked.bind($parent, track), css: {active: $parent.trackAddingSegment() === track}"></div></td>\n                        <td><div class="button-add-point" title="Добавить метку" data-bind="click: $parent.onButtonAddPointClicked.bind($parent, track), css: {active: $parent.trackAddingPoint() === track}"></div></td>\n                        <td><a class="track-text-button" title="Действия" data-bind="click: $parent.showTrackMenu.bind($parent)">&hellip;</a></td>\n                    </tr>\n                </tbody></table>\n                </div>\n                </div>\n            ',o.default.applyBindings(this,n),i.default.DomEvent.addListener(t.getContainer(),"drop",this.onFileDragDrop,this),i.default.DomEvent.addListener(t.getContainer(),"dragover",this.onFileDraging,this),this.menu=new a.default([{text:"Копировать ссылку на все трэки",callback:this.copyAllTracksToClipboard.bind(this)},{text:"Копировать ссылку на видимые трэки",callback:this.copyVisibleTracks.bind(this)},"-",{text:"Удалить все трэки",callback:this.deleteAllTracks.bind(this)},{text:"Удалить скрытые трэки",callback:this.deleteHiddenTracks.bind(this)}]),this._markerLayer=new i.default.Layer.CanvasMarkers(null,{print:!0,scaleDependent:!0,zIndex:1e3,printTransparent:!0}).addTo(t),this._markerLayer.on("markerclick markercontextmenu",this.onMarkerClick,this),this._markerLayer.on("markerenter",this.onMarkerEnter,this),this._markerLayer.on("markerleave",this.onMarkerLeave,this),t.on("resize",this._setAdaptiveHeight,this),setTimeout((function(){return e._setAdaptiveHeight()}),0),n},defaultEventHandle:function(t,e){return i.default.DomEvent.stopPropagation(e),!0},_setAdaptiveHeight:function(){var t;t=this._map.getSize().y-this._container.offsetTop-(this._container.parentNode.offsetHeight-this._container.offsetTop-this._container.offsetHeight)-105,this.trackListHeight(t+"px")},setExpanded:function(){i.default.DomUtil.removeClass(this._container,"minimized")},setMinimized:function(){i.default.DomUtil.addClass(this._container,"minimized")},onFileDraging:function(t){i.default.DomEvent.stopPropagation(t),i.default.DomEvent.preventDefault(t),t.dataTransfer.dropEffect="copy"},onFileDragDrop:function(t){i.default.DomEvent.stopPropagation(t),i.default.DomEvent.preventDefault(t);var e=t.dataTransfer.files;e&&e.length&&this.loadFilesFromFilesObject(e)},onEnterPressedInInput:function(t,e){return 13!==e.keyCode||(t.loadFilesFromUrl(),i.default.DomEvent.stop(e),!1)},getTrackPolylines:function(t){return t.feature.getLayers().filter((function(t){return t instanceof i.default.Polyline}))},getTrackPoints:function(t){return t.markers},onButtonNewTrackClicked:function(){var t=this.url().trim();t.length>0?this.url(""):t="Новый трэк",this.addTrackAndEdit(t)},addSegmentAndEdit:function(t){this.stopPlacingPoint();var e=this.addTrackSegment(t);this.startEditTrackSegement(e),e.startDrawingLine(),this.trackAddingSegment(t)},addTrackAndEdit:function(t){var e=this.addTrack({name:t,color:0});return this.addSegmentAndEdit(e),e},loadFilesFromFilesObject:function(t){this.readingFiles(this.readingFiles()+1),(0,s.readFiles)(t).then(function(t){var e,n=[],r=D(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;n.push.apply(n,T((0,l.default)(i.filename,i.data)))}}catch(t){r.e(t)}finally{r.f()}this.readingFiles(this.readingFiles()-1),this.addTracksFromGeodataArray(n)}.bind(this))},loadFilesFromDisk:function(){v.captureBreadcrumb("load track from disk"),(0,s.selectFiles)(!0).then(this.loadFilesFromFilesObject.bind(this))},loadFilesFromUrl:function(){var t=this,e=this.url().trim();e&&(this.readingFiles(this.readingFiles()+1),v.captureBreadcrumb("load track from url",{trackUrl:e}),(0,u.default)(e).then((function(e){t.addTracksFromGeodataArray(e),t.readingFiles(t.readingFiles()-1)})),this.url(""))},whenLoadDone:function(t){if(0!==this.readingFiles())var e=this.readingFiles.subscribe((function(n){0===n&&(e.dispose(),t())}));else t()},addTracksFromGeodataArray:function(t){var e=!1,n=[];return 0===t.length&&n.push("No tracks loaded"),t.forEach(function(t){var r=!(t.tracks&&t.tracks.length||t.points&&t.points.length);r||(t.tracks&&(t.tracks=t.tracks.map((function(t){return t=function(t){if(0===t.length)return[];for(var e,n=[t[0]],r=t[0],i=1;i<t.length;i++)e=(0,k.wrapLatLngToTarget)(t[i],r),n.push(e),r=e;return n}(t),1===(t=i.default.LineUtil.simplifyLatlngs(t,360/(1<<24))).length&&t.push(t[0]),t}))),e=!0,this.addTrack(t));var o;t.error&&(o={CORRUPT:'File "{name}" is corrupt',UNSUPPORTED:'File "{name}" has unsupported format or is badly corrupt',NETWORK:'Could not download file from url "{name}"',INVALID_URL:'"{name}"  is not of supported URL type'}[t.error]||t.error,o+=r?", no data could be loaded":", loaded data can be invalid or incomplete"),o&&(o=i.default.Util.template(o,{name:t.name}),n.push(o))}.bind(this)),n.length&&(0,y.notify)(n.join("\n")),e},onTrackColorChanged:function(t){var e=this.colors[t.color()];this.getTrackPolylines(t).forEach((function(t){t.setStyle({color:e})}));var n=this.getTrackPoints(t);n.forEach(this.setMarkerIcon.bind(this)),this._markerLayer.updateMarkers(n)},onTrackVisibilityChanged:function(t){t.visible()?(this.map.addLayer(t.feature),this._markerLayer.addMarkers(t.markers)):(this.trackAddingPoint()===t&&this.stopPlacingPoint(),this.map.removeLayer(t.feature),this._markerLayer.removeMarkers(t.markers)),this.updateTrackHighlight()},onTrackSegmentNodesChanged:function(t,e){e.getFixedLatLngs().length>0&&this.trackAddingSegment(null),this.recalculateTrackLength(t)},recalculateTrackLength:function(t){var e,n=0,r=D(this.getTrackPolylines(t));try{for(r.s();!(e=r.n()).done;){n+=e.value.getLength()}}catch(t){r.e(t)}finally{r.f()}t.length(n)},formatLength:function(t){var e=0;return t<1e4?e=2:t<1e5&&(e=1),(t/1e3).toFixed(e)+" km"},setTrackMeasureTicksVisibility:function(t){var e=t.measureTicksShown();this.getTrackPolylines(t).forEach((function(t){return t.setMeasureTicksVisible(e)}))},switchMeasureTicksVisibility:function(t){t.measureTicksShown(!t.measureTicksShown())},onColorSelectorClicked:function(t,e){t._contextmenu.show(e)},setViewToTrack:function(t){this.setViewToBounds(this.getTrackBounds(t))},setViewToAllTracks:function(t){var e,n=i.default.latLngBounds([]),r=D(this.tracks());try{for(r.s();!(e=r.n()).done;){var o=e.value;n.extend(this.getTrackBounds(o))}}catch(t){r.e(t)}finally{r.f()}this.setViewToBounds(n,t)},setViewToBounds:function(t,e){t&&t.isValid()&&(t=(0,k.wrapLatLngBoundsToTarget)(t,this.map.getCenter()),i.default.Browser.mobile||e?this.map.fitBounds(t,{maxZoom:16}):this.map.flyToBounds(t,{maxZoom:16}))},getTrackBounds:function(t){var e=this.getTrackPolylines(t),n=this.getTrackPoints(t),r=i.default.latLngBounds([]);return(e.length||n.length)&&(e.forEach((function(t){t.getLatLngs().length>1&&r.extend((0,k.wrapLatLngBoundsToTarget)(t.getBounds(),r))})),n.forEach((function(t){r.extend((0,k.wrapLatLngToTarget)(t.latlng,r))}))),r},attachColorSelector:function(t){var e=this.colors.map((function(e,n){return{text:'<div style="display: inline-block; vertical-align: middle; width: 50px; height: 0; border-top: 4px solid '+e+'"></div>',callback:t.color.bind(null,n)}}));t._contextmenu=new a.default(e)},attachActionsMenu:function(t){var e=[function(){return{text:"".concat(t.name()),header:!0}},"-",{text:"Переименовать",callback:this.renameTrack.bind(this,t)},{text:"Дублировать",callback:this.duplicateTrack.bind(this,t)},{text:"Реверсировать",callback:this.reverseTrack.bind(this,t)},{text:"Показать профиль высоты",callback:this.showElevationProfileForTrack.bind(this,t)},"-",{text:"Удалить",callback:this.removeTrack.bind(this,t)},"-",{text:"Скачать GPX",callback:this.saveTrackAsFile.bind(this,t,c.saveGpx,".gpx")},{text:"Скачать KML",callback:this.saveTrackAsFile.bind(this,t,c.saveKml,".kml")},{text:"Копировать ссылку на трэк",callback:this.copyTrackLinkToClipboard.bind(this,t)},{text:"Дополнительно",separator:!0},{text:"Скачать GPX с добавлением высоты",callback:this.saveTrackAsFile.bind(this,t,c.saveGpxWithElevations,".gpx",!0)}];t._actionsMenu=new a.default(e)},onButtonAddSegmentClicked:function(t){t.visible()&&(this.trackAddingSegment()===t?(this.trackAddingSegment(null),this.stopEditLine()):this.addSegmentAndEdit(t))},duplicateTrack:function(t){var e=this.getTrackPolylines(t).map((function(t){return t.getLatLngs().map((function(t){return[t.lat,t.lng]}))})),n=this.getTrackPoints(t).map((function(t){return{lat:t.latlng.lat,lng:t.latlng.lng,name:t.label}}));this.addTrack({name:t.name(),tracks:e,points:n})},reverseTrackSegment:function(t){t.stopDrawingLine();var e=t.getLatLngs();(e=e.map((function(t){return[t.lat,t.lng]}))).reverse();var n=this._editedLine===t;this.deleteTrackSegment(t);var r=this.addTrackSegment(t._parentTrack,e);n&&this.startEditTrackSegement(r)},reverseTrack:function(t){var e=this;this.getTrackPolylines(t).forEach((function(t){e.reverseTrackSegment(t)}))},copyTracksLinkToClipboard:function(t,e){var n=this;if(t.length){var r=t.map((function(t){return n.trackToString(t)})).join("/"),i=(0,w.default)(r,null,!0),o=btoa(i).replace(/\//g,"_").replace(/\+/g,"-").replace(/=/g,""),a=window.location+"&nktl="+o;(0,f.default)(a,e),(0,g.fetch)("".concat(b.default.tracksStorageServer,"/track/").concat(o),{method:"POST",data:r,withCredentials:!0}).then(null,(function(t){var e=t.message||t;413===t.xhr.status&&(e="track is too big"),v.captureMessage("Failed to save track to server",{status:t.xhr.status,response:t.xhr.responseText}),(0,y.notify)("Error making link: "+e)}))}else(0,y.notify)("No tracks to copy")},copyTrackLinkToClipboard:function(t,e){this.copyTracksLinkToClipboard([t],e)},saveTrackAsFile:(A=regeneratorRuntime.mark((function t(e,n,r){var o,a,s,l,u,c,f,h,p,g,b,w,k,x,O,P,L,C,M,j,q,E=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(o=E.length>3&&void 0!==E[3]&&E[3],a=this.getTrackPolylines(e).map((function(t){return t.getFixedLatLngs()})),a=(0,_.splitLinesAt180Meridian)(a),s=this.getTrackPoints(e),l=(l=e.name()).replace(/^\./,"_"),u=0,c=[this.options.splitExtensionsFirstStage,this.options.splitExtensions];u<c.length;u++)f=c[u],(h=l.lastIndexOf("."))>-1&&f.includes(l.slice(h+1).toLowerCase())&&(l=l.slice(0,h));if(0!==a.length||0!==s.length){t.next=10;break}return(0,y.notify)("Трэк пустой. Скачивание невозможно."),t.abrupt("return");case 10:if(!o){t.next=27;break}return p=[].concat(T(s.map((function(t){return t.latlng}))),T(a.reduce((function(t,e){return t.push.apply(t,T(e)),t}),[]))),t.prev=12,t.next=15,(new S.ElevationProvider).get(p);case 15:g=t.sent,t.next=22;break;case 18:t.prev=18,t.t0=t.catch(12),v.captureException(t.t0,"error getting elevation for gpx"),(0,y.notify)("Failed to get elevation data: ".concat(t.t0.message));case 22:b=0,w=D(s);try{for(w.s();!(k=w.n()).done;)(x=k.value).latlng=i.default.latLng(x.latlng.lat,x.latlng.lng,g[b]),b+=1}catch(t){w.e(t)}finally{w.f()}O=D(a);try{for(O.s();!(P=O.n()).done;){L=P.value,C=D(L);try{for(C.s();!(M=C.n()).done;)M.value.alt=g[b],b+=1}catch(t){C.e(t)}finally{C.f()}}}catch(t){O.e(t)}finally{O.f()}case 27:j=n(a,l,s),q=l+r,(0,d.saveAs)((0,m.blobFromString)(j),q,!0);case 30:case"end":return t.stop()}}),t,this,[[12,18]])})),R=function(){var t=this,e=arguments;return new Promise((function(n,r){var i=A.apply(t,e);function o(t){j(i,n,r,o,a,"next",t)}function a(t){j(i,n,r,o,a,"throw",t)}o(void 0)}))},function(t,e,n){return R.apply(this,arguments)}),renameTrack:function(t){var e=(0,y.query)("Enter new name",t.name());e&&e.length&&t.name(e)},showTrackMenu:function(t,e){t._actionsMenu.show(e)},showMenu:function(t){this.menu.show(t)},stopEditLine:function(){this._editedLine&&this._editedLine.stopEdit()},onTrackSegmentClick:function(t){if(!this.isPlacingPoint){var e=t.target;this._lineJoinActive?(i.default.DomEvent.stopPropagation(t),this.joinTrackSegments(e,z(t.target.getLatLngs(),t.latlng))):(this.startEditTrackSegement(e),i.default.DomEvent.stopPropagation(t))}},startEditTrackSegement:function(t){this._editedLine&&this._editedLine!==t&&this.stopEditLine(),t.startEdit(),this._editedLine=t,t.once("editend",this.onLineEditEnd,this),t.fire("startedit")},onButtonAddPointClicked:function(t){t.visible()&&(this.trackAddingPoint()===t?this.stopPlacingPoint():this.beginPointCreate(t))},_beginPointEdit:function(){this.stopPlacingPoint(),this.stopEditLine(),i.default.DomUtil.addClass(this._map._container,"leaflet-point-placing"),this.isPlacingPoint=!0,i.default.DomEvent.on(document,"keydown",this.stopPlacingPointOnEscPressed,this),this._map.fire("startedit")},beginPointMove:function(t){this._beginPointEdit(),this._movingMarker=t,this.map.on("click",this.movePoint,this)},beginPointCreate:function(t){this._beginPointEdit(),this.map.on("click",this.createNewPoint,this),this.trackAddingPoint(t)},movePoint:function(t){var e=this._movingMarker,n=t.latlng.wrap();this._markerLayer.setMarkerPosition(e,n),this.stopPlacingPoint()},getNewPointName:function(t){var e,n=0,r=D(t.markers);try{for(r.s();!(e=r.n()).done;){var i=e.value.label;i.match(/^[0-9]{3}((?:(?![\.0-9])[\s\S])|$)/)&&(n=parseInt(i,10))}}catch(t){r.e(t)}finally{r.f()}return 999===n?"":String(n+1).padStart(3,"0")},createNewPoint:function(t){var e,n=this;if(this.isPlacingPoint){var r=this.trackAddingPoint(),i=t.suggested&&(null===(e=this._map.suggestedPoint)||void 0===e?void 0:e.title)||this.getNewPointName(r),o=t.latlng.wrap(),a=this.addPoint(r,{name:i,lat:o.lat,lng:o.lng});this._markerLayer.addMarker(a),setTimeout((function(){n.renamePoint(a),n.beginPointCreate(r)}),10)}},stopPlacingPointOnEscPressed:function(t){27===t.keyCode&&this.stopPlacingPoint()},stopPlacingPoint:function(){this.isPlacingPoint=!1,this.trackAddingPoint(null),i.default.DomUtil.removeClass(this._map._container,"leaflet-point-placing"),i.default.DomEvent.off(document,"keydown",this.stopPlacingPointOnEscPressed,this),this.map.off("click",this.createNewPoint,this),this.map.off("click",this.movePoint,this)},joinTrackSegments:function(t,e){this.hideLineCursor();var n,r,i=this._editedLine,o=i.getLatLngs(),a=t.getLatLngs();(e===this._lineJoinFromStart&&a.reverse(),this._lineJoinFromStart)?(n=o).unshift.apply(n,T(a)):(r=o).push.apply(r,T(a));o=o.map((function(t){return[t.lat,t.lng]})),this.deleteTrackSegment(i),i._parentTrack===t._parentTrack&&this.deleteTrackSegment(t),this.addTrackSegment(i._parentTrack,o)},onLineEditEnd:function(t){var e=t.target,n=e._parentTrack;e.getLatLngs().length<2&&this.deleteTrackSegment(e),this._editedLine===e&&(this._editedLine=null),this.getTrackPolylines(n).length||this.getTrackPoints(n).length||!t.userCancelled||this.removeTrack(n)},addTrackSegment:function(t,e){var n=this,r=new F(e||[],{color:this.colors[t.color()],print:!0});return r._parentTrack=t,r.setMeasureTicksVisible(t.measureTicksShown()),r.on("click",this.onTrackSegmentClick,this),r.on("nodeschanged",this.onTrackSegmentNodesChanged.bind(this,t,r)),r.on("noderightclick",this.onNodeRightClickShowMenu,this),r.on("segmentrightclick",this.onSegmentRightClickShowMenu,this),r.on("mouseover",(function(){return n.onTrackMouseEnter(t)})),r.on("mouseout",(function(){return n.onTrackMouseLeave(t)})),r.on("editstart",(function(){return n.onTrackEditStart(t)})),r.on("editend",(function(){return n.onTrackEditEnd(t)})),r.on("drawend",this.onTrackSegmentDrawEnd,this),t.feature.addLayer(r),this.recalculateTrackLength(t),r},onNodeRightClickShowMenu:function(t){var e=[];t.nodeIndex>0&&t.nodeIndex<t.line.getLatLngs().length-1&&e.push({text:"Разрезать",callback:this.splitTrackSegment.bind(this,t.line,t.nodeIndex,null)}),0!==t.nodeIndex&&t.nodeIndex!==t.line.getLatLngs().length-1||e.push({text:"Соединить",callback:this.startLineJoinSelection.bind(this,t)}),e.push({text:"Реверсировать",callback:this.reverseTrackSegment.bind(this,t.line)}),e.push({text:"Укоротить",callback:this.startShortCutSelection.bind(this,t,!0)}),e.push({text:"Удалить сегмент",callback:this.deleteTrackSegment.bind(this,t.line)}),e.push({text:"Новый трэк из сегмента",callback:this.newTrackFromSegment.bind(this,t.line)}),e.push("-"),e.push({text:"Профиль высоты сегмента",callback:this.showElevationProfileForSegment.bind(this,t.line)}),new a.default(e).show(t.mouseEvent)},onSegmentRightClickShowMenu:function(t){new a.default([{text:"Разрезать",callback:this.splitTrackSegment.bind(this,t.line,t.nodeIndex,t.mouseEvent.latlng)},{text:"Реверсировать",callback:this.reverseTrackSegment.bind(this,t.line)},{text:"Укоротить",callback:this.startShortCutSelection.bind(this,t,!1)},{text:"Удалить сегмент",callback:this.deleteTrackSegment.bind(this,t.line)},{text:"Новый трэк из сегмента",callback:this.newTrackFromSegment.bind(this,t.line)},"-",{text:"Профиль высоты сегмента",callback:this.showElevationProfileForSegment.bind(this,t.line)}]).show(t.mouseEvent)},showLineCursor:function(t,e){this.hideLineCursor(),this._editedLine.stopDrawingLine(),this._lineCursor=i.default.polyline([t.clone(),e],C(C({},this.options.lineCursorStyle),this.options.lineCursorInvalidStyle)).addTo(this._map),this.map.on("mousemove",this.onMouseMoveOnMapForLineCursor,this),this.map.on("click",this.hideLineCursor,this),i.default.DomEvent.on(document,"keyup",this.onKeyUpForLineCursor,this),i.default.DomUtil.addClass(this.map.getContainer(),"tracklist-line-cursor-shown"),this._editedLine.preventStopEdit=!0},hideLineCursor:function(){this._lineCursor&&(this.map.off("mousemove",this.onMouseMoveOnMapForLineCursor,this),this.map.off("click",this.hideLineCursor,this),i.default.DomUtil.removeClass(this.map.getContainer(),"tracklist-line-cursor-shown"),i.default.DomEvent.off(document,"keyup",this.onKeyUpForLineCursor,this),this.map.removeLayer(this._lineCursor),this._lineCursor=null,this._map.fire("linecursorhide"),this._editedLine.preventStopEdit=!1)},onMouseMoveOnMapForLineCursor:function(t){this.updateLineCursor(t.latlng,!1)},updateLineCursor:function(t,e){this._lineCursor&&(this._lineCursor.getLatLngs().splice(1,1,t),this._lineCursor.redraw(),this._lineCursor.setStyle(e?this.options.lineCursorValidStyle:this.options.lineCursorInvalidStyle))},onKeyUpForLineCursor:function(t){if("input"!==t.target.tagName.toLowerCase())switch(t.keyCode){case 27:case 13:this.hideLineCursor(),i.default.DomEvent.stop(t)}},startLineJoinSelection:function(t){this._lineJoinFromStart=0===t.nodeIndex;var e=this._editedLine.getLatLngs()[t.nodeIndex];this.showLineCursor(e,t.mouseEvent.latlng),this._map.on("linecursorhide",this.onLineCursorHideForJoin,this);var n,r=D(this.tracks());try{for(r.s();!(n=r.n()).done;){n.value.feature.on("mousemove",this.onMouseMoveOnLineForJoin,this)}}catch(t){r.e(t)}finally{r.f()}this._lineJoinActive=!0,this._editedLine.disableEditOnLeftClick(!0)},onMouseMoveOnLineForJoin:function(t){var e=t.layer.getLatLngs(),n=z(e,t.latlng)?e[0]:e[e.length-1];i.default.DomEvent.stopPropagation(t),this.updateLineCursor(n,!0)},onLineCursorHideForJoin:function(){var t,e=D(this.tracks());try{for(e.s();!(t=e.n()).done;){t.value.feature.off("mousemove",this.onMouseMoveOnLineForJoin,this)}}catch(t){e.e(t)}finally{e.f()}this._map.off("linecursorhide",this.onLineCursorHideForJoin,this),this._editedLine.disableEditOnLeftClick(!1),this._lineJoinActive=!1},startShortCutSelection:function(t,e){var n,r=this._editedLine;this._shortCut={startNodeIndex:t.nodeIndex,startFromNode:e},e?n=r.getLatLngs()[t.nodeIndex]:(n=N(r.getLatLngs(),t.nodeIndex,t.mouseEvent.latlng),this._shortCut.startLatLng=n),this.showLineCursor(n,t.mouseEvent.latlng),r.nodeMarkers.on("mousemove",this.onMouseMoveOnNodeMarkerForShortCut,this),r.segmentOverlays.on("mousemove",this.onMouseMoveOnLineSegmentForShortCut,this),this.map.on("mousemove",this.onMouseMoveOnMapForShortCut,this),r.nodeMarkers.on("click",this.onClickNodeMarkerForShortCut,this),r.segmentOverlays.on("click",this.onClickLineSegmentForShortCut,this),this._map.on("linecursorhide",this.onLineCursorHideForShortCut,this),r.disableEditOnLeftClick(!0)},onMouseMoveOnLineSegmentForShortCut:function(t){this.updateShortCutSelection(t,!1)},onMouseMoveOnNodeMarkerForShortCut:function(t){this.updateShortCutSelection(t,!0)},onMouseMoveOnMapForShortCut:function(){this._editedLine.highlighNodesForDeletion()},updateShortCutSelection:function(t,e){i.default.DomEvent.stopPropagation(t);var n=this._editedLine,r=this.getShortCutNodes(t,e),o=r.firstNodeToDelete,a=r.lastNodeToDelete,s=r.rangeValid;this.updateLineCursor(t.latlng,s),s?n.highlighNodesForDeletion(o,a):n.highlighNodesForDeletion()},onLineCursorHideForShortCut:function(){var t=this._editedLine;t.highlighNodesForDeletion(),t.nodeMarkers.off("mousemove",this.onMouseMoveOnNodeMarkerForShortCut,this),t.segmentOverlays.off("mousemove",this.onMouseMoveOnLineSegmentForShortCut,this),this.map.off("mousemove",this.onMouseMoveOnMapForShortCut,this),t.nodeMarkers.off("click",this.onClickNodeMarkerForShortCut,this),t.segmentOverlays.off("click",this.onClickLineSegmentForShortCut,this),this._map.off("linecursorhide",this.onLineCursorHideForShortCut,this),t.disableEditOnLeftClick(!1),this._shortCut=null},onClickLineSegmentForShortCut:function(t){this.shortCutSegment(t,!1)},onClickNodeMarkerForShortCut:function(t){this.shortCutSegment(t,!0)},getShortCutNodes:function(t,e){var n,r,i=this._editedLine,o=this._shortCut.startFromNode,a=this._shortCut.startNodeIndex,s=i[e?"getMarkerIndex":"getSegmentOverlayIndex"](t.layer),l=[];return o||l.push(this._shortCut.startLatLng),e||l.push(N(i.getLatLngs(),s,t.latlng)),s>a?(n=a+1,r=s-1,e||(r+=1)):(l.reverse(),n=s+1,r=a-1,o||(r+=1)),{firstNodeToDelete:n,lastNodeToDelete:r,newNodes:l,rangeValid:r>=n}},shortCutSegment:function(t,e){i.default.DomEvent.stopPropagation(t);var n=this._editedLine,r=this.getShortCutNodes(t,e),o=r.firstNodeToDelete,a=r.lastNodeToDelete,s=r.newNodes;r.rangeValid&&(this.stopEditLine(),n.spliceLatLngs.apply(n,[o,a-o+1].concat(T(s))),this.startEditTrackSegement(n))},onTrackMouseEnter:function(t){t.hover(!0)},onTrackMouseLeave:function(t){t.hover(!1)},onTrackEditStart:function(t){t.isEdited(!0)},onTrackEditEnd:function(t){t.isEdited(!1),this.hideLineCursor(),this._editedLine=null},onTrackRowMouseEnter:function(t){this._highlightedTrack=t,this.updateTrackHighlight()},onTrackRowMouseLeave:function(t){this._highlightedTrack===t&&(this._highlightedTrack=null,this.updateTrackHighlight())},onTrackSegmentDrawEnd:function(){this.trackAddingSegment(null)},splitTrackSegment:function(t,e,n){var r=t.getLatLngs(),i=(r=r.map((function(t){return t.clone()}))).slice(0,e+1),o=r.slice(e+1);n?(n=N(r,e,n),i.push(n.clone())):n=r[e],o.unshift(n.clone()),this.deleteTrackSegment(t);var a=this.addTrackSegment(t._parentTrack,i);this.addTrackSegment(t._parentTrack,o),this.startEditTrackSegement(a)},deleteTrackSegment:function(t){var e=t._parentTrack;e.feature.removeLayer(t),this.recalculateTrackLength(e)},newTrackFromSegment:function(t){var e,n=t.getLatLngs(),r=[];for(e=0;e<n.length;e++)r.push([n[e].lat,n[e].lng]);this.addTrack({name:"Новый трэк",tracks:[r]})},addTrack:function(t){var e;(e=t.color)>=0&&e<this.colors.length||(e=this._lastTrackColor,this._lastTrackColor=(this._lastTrackColor+1)%this.colors.length);var n={name:o.default.observable(t.name),color:o.default.observable(e),visible:o.default.observable(!t.trackHidden),length:o.default.observable(0),measureTicksShown:o.default.observable(t.measureTicksShown||!1),feature:i.default.featureGroup([]),markers:[],hover:o.default.observable(!1),isEdited:o.default.observable(!1)};return(t.tracks||[]).forEach(this.addTrackSegment.bind(this,n)),(t.points||[]).forEach(this.addPoint.bind(this,n)),this.tracks.push(n),n.visible.subscribe(this.onTrackVisibilityChanged.bind(this,n)),n.measureTicksShown.subscribe(this.setTrackMeasureTicksVisibility.bind(this,n)),n.color.subscribe(this.onTrackColorChanged.bind(this,n)),i.default.Browser.touch||n.feature.bindTooltip((function(){return n.name()}),{sticky:!0,delay:500}),this.onTrackVisibilityChanged(n),this.attachColorSelector(n),this.attachActionsMenu(n),n},updateTrackHighlight:function(){if(!i.default.Browser.touch&&(this._trackHighlight&&(this._trackHighlight.removeFrom(this._map),this._trackHighlight=null),this._highlightedTrack&&this._highlightedTrack.visible())){var t=i.default.featureGroup([]);this._highlightedTrack.feature.eachLayer((function(e){var n=e.getFixedLatLngs();i.default.polyline(n).addTo(t)})),t.setStyle({color:"yellow",weight:"15",opacity:.5}),t.addTo(this._map).bringToBack(),this._trackHighlight=t}},setMarkerIcon:function(t){var e="symbol-marker-"+(t._parentTrack.color()+1);t.icon=(0,h.default)("track-waypoint "+e)},setMarkerLabel:function(t,e){t.label=e},addPoint:function(t,e){var n={latlng:i.default.latLng([e.lat,e.lng]),_parentTrack:t};return this.setMarkerIcon(n),this.setMarkerLabel(n,e.name),t.markers.push(n),n._parentTrack=t,n},onMarkerClick:function(t){new a.default([{text:t.marker.label,header:!0},"-",{text:"Rename",callback:this.renamePoint.bind(this,t.marker)},{text:"Move",callback:this.beginPointMove.bind(this,t.marker)},{text:"Delete",callback:this.removePoint.bind(this,t.marker)}]).show(t)},onMarkerEnter:function(t){t.marker._parentTrack.hover(!0)},onMarkerLeave:function(t){t.marker._parentTrack.hover(!1)},removePoint:function(t){this.stopPlacingPoint(),this._markerLayer.removeMarker(t);var e=t._parentTrack.markers,n=e.indexOf(t);e.splice(n,1)},renamePoint:function(t){this.stopPlacingPoint();var e=(0,y.query)("New point name",t.label);null!==e&&(this.setMarkerLabel(t,e),this._markerLayer.updateMarker(t))},removeTrack:function(t){t.visible(!1),this.tracks.remove(t)},deleteAllTracks:function(){var t,e=this.tracks().slice(0);for(t=0;t<e.length;t++)this.removeTrack(e[t])},deleteHiddenTracks:function(){var t,e=this.tracks().slice(0);for(t=0;t<e.length;t++)e[t].visible()||this.removeTrack(e[t])},trackToString:function(t,e){var n=this.getTrackPolylines(t).map((function(t){var e=t.getFixedLatLngs();return e=i.default.LineUtil.simplifyLatlngs(e,360/(1<<24))}));return c.saveToString(n,t.name(),t.color(),t.measureTicksShown(),this.getTrackPoints(t),!e&&!t.visible())},copyAllTracksToClipboard:function(t){this.copyTracksLinkToClipboard(this.tracks(),t)},copyVisibleTracks:function(t){var e=this.tracks().filter((function(t){return t.visible()}));this.copyTracksLinkToClipboard(e,t)},exportTracks:function(t){var e=this;return this.tracks().filter((function(t){return e.getTrackPolylines(t).length})).map((function(e){var n,r=e.feature.getLayers().map((function(t){return t.getLatLngs().map((function(t){return[t.lat,t.lng]}))})),i=e.feature.getBounds(),o=[[i.getSouth(),i.getWest()],[i.getNorth(),i.getEast()]];return{color:e.color(),visible:e.visible(),segments:r,bounds:o,measureTicksShown:e.measureTicksShown(),measureTicks:(n=[]).concat.apply(n,T(e.feature.getLayers().map((function(e){return e.getTicksPositions(t)}))))}}))},showElevationProfileForSegment:function(t){this.hideElevationProfile(),this.stopEditLine(),this._elevationControl=new p.ElevationProfile(this._map,t.getLatLngs(),{samplingInterval:(0,p.calcSamplingInterval)(t.getLength())}),this._map.fire("elevation-shown")},showElevationProfileForTrack:function(t){var e,n=this.getTrackPolylines(t),r=[];for(e=0;e<n.length;e++)n[e]===this._editedLine&&this.stopEditLine(),r=r.concat(n[e].getLatLngs());this.hideElevationProfile(),this._elevationControl=new p.ElevationProfile(this._map,r,{samplingInterval:(0,p.calcSamplingInterval)(new i.default.MeasuredLine(r).getLength())}),this._map.fire("elevation-shown")},hideElevationProfile:function(){this._elevationControl&&this._elevationControl.removeFrom(this._map),this._elevationControl=null},hasTracks:function(){return this.tracks().length>0}})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||o(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=o(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw a}}}}function o(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function l(t){var e={},n=t.indexOf("#");if(n>=0){var o,a,s,l,u=i((t=t.substr(n+1).trim()).split("&"));try{for(u.s();!(l=u.n()).done;){var c=l.value;if(o=/^((?:(?!=)[\s\S])+?)(?:=((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*))?$/.exec(c)){var f=r(o,3);a=f[1],s=(s=f[2])?s.split("/"):[],e[a]=s}}}catch(t){u.e(t)}finally{u.f()}}return e}n(7),n(10),n(11),n(16),n(15),n(45),n(13),n(1),n(31),n(8),n(2),n(24),n(6),n(34),n(0),n(14),n(4),n(5),n(43),n(184),n(41),n(99),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.bindHashStateReadOnly=function(t,e){function n(){e(u.getState(t)),u.updateState(t,null)}u.addEventListener(t,n),n()},e.parseHashParams=l,e.hashState=void 0;var u={_listeners:[],_state:{},addEventListener:function(t,e){var n,o=i(this._listeners);try{for(o.s();!(n=o.n()).done;){var a=r(n.value,2),s=a[0],l=a[1];if(s===t&&l===e)return}}catch(t){o.e(t)}finally{o.f()}this._listeners.push([t,e])},updateState:function(t,e){e?this._state[t]=e:delete this._state[t],this._saveStateToHash()},getState:function(t){return this._state[t]},hasKey:function(t){return this._state.hasOwnProperty(t)},_saveStateToHash:function(){for(var t=[],e=0,n=Object.keys(this._state);e<n.length;e++){var r=n[e];if(this._state[r])if(this._state[r].length){var i=this._state[r].join("/");t.push(r+"="+i)}else t.push(r)}var o=t.join("&"),a="".concat(location.origin).concat(location.pathname).concat(location.search,"#").concat(o);this._ignoreChanges=!0,location.replace(a),this._ignoreChanges=!1},onHashChanged:function(){if(!this._ignoreChanges){for(var t=l(location.hash),e={},n=0,o=Object.keys(t);n<o.length;n++){var a=o[n];a in this._state&&s(t[a],this._state[a])||(e[a]=1)}for(var u=0,c=Object.keys(this._state);u<c.length;u++){var f=c[u];f in t||(e[f]=1)}var d,h=i(this._listeners);try{for(h.s();!(d=h.n()).done;){var p=r(d.value,2),m=p[0],v=p[1];m in e&&v(t[m])}}catch(t){h.e(t)}finally{h.f()}this._state=t}}};e.hashState=u,window.addEventListener("hashchange",u.onHashChanged.bind(u)),u.onHashChanged()},function(t,e,n){"use strict";function r(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n(24),n(19),n(0),n(20),Object.defineProperty(e,"__esModule",{value:!0}),e.PrintStaticLayer=void 0,n(30);var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),o(this,"_layerDummy",!0),o(this,"_printProgressWeight",.01)}var e,n,a,s,l;return e=t,(n=[{key:"cloneForPrint",value:function(){return this}},{key:"getTilesInfo",value:(s=regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{iterateTilePromises:regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,{tilePromise:Promise.resolve({draw:function(t){return n._drawRaster(t,e)},isOverlay:!0,overlaySolid:this.overlaySolid}),abortLoading:function(){}};case 2:case"end":return t.stop()}}),t,this)})).bind(this),count:1});case 1:case"end":return t.stop()}}),t,this)})),l=function(){var t=this,e=arguments;return new Promise((function(n,i){var o=s.apply(t,e);function a(t){r(o,n,i,a,l,"next",t)}function l(t){r(o,n,i,a,l,"throw",t)}a(void 0)}))},function(t){return l.apply(this,arguments)})},{key:"_drawRaster",value:function(t,e){throw new Error("Method not implemented")}}])&&i(e.prototype,n),a&&i(e,a),t}();e.PrintStaticLayer=a},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n(25),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n(420);var i=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var s=i?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=t[o]}n.default=t,e&&e.set(t,n);return n}(n(97)),o=n(103);function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}var s=function(t,e){var n,r=!1;try{(n=document.createElement("textarea")).value=t,document.body.appendChild(n),n.select(),(r=document.execCommand("copy"))&&function(t,e){var n=document.createElement("div");n.innerHTML=t,n.className="copy-clipboard-notification",document.body.appendChild(n);var r=n.offsetWidth,i=n.offsetHeight,o=e.clientX-r-8,a=e.clientY-i/2;o<0&&(o=0),a<0&&(a=0),n.style.top=a+"px",n.style.left=o+"px",setTimeout((function(){document.body.removeChild(n)}),1e3)}("Скопировано",e)}catch(t){i.captureException(t,"clipborad to copy failed")}finally{document.body.removeChild(n)}r||(0,o.query)("Copy to clipboard: Ctrl+C, Enter",t)};e.default=s},function(t,e,n){"use strict";n(7),n(16),n(46),n(22),n(62),n(19),n(59),n(96),n(34),n(0),n(20),n(23),Object.defineProperty(e,"__esModule",{value:!0}),e.TiledDataLoader=void 0,n(30);var r=n(436),i=n(67);function o(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var c=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;l(this,t),this._cache=new r.Cache(e),this._pendingRequests={},this._xhrQueue=new i.XHRQueue}var e,n,c;return e=t,(n=[{key:"makeTileKey",value:function(t){return"".concat(t.x,":").concat(t.y,":").concat(t.z)}},{key:"getFromCache",value:function(t){var e=this.makeTileKey(t),n=this._cache.get(e);return n.coords=t,n}},{key:"layerTileToDataTileCoords",value:function(t){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},t)}},{key:"makeRequestData",value:function(t){throw new Error("Not implemented")}},{key:"processResponse",value:function(t,e){throw new Error("Not implemented")}},{key:"calcAdjustment",value:function(t,e){if(t.x===e.x&&t.y===e.y&&t.z===e.z)return null;if(e.z>t.z)return{multiplier:1/(1<<e.z-t.z),offsetX:0,offsetY:0};var n=1<<t.z-e.z;return{multiplier:n,offsetX:t.x-e.x*n,offsetY:t.y-e.y*n}}},{key:"requestTileData",value:function(t){var e=this,n=this.layerTileToDataTileCoords(t),r=this.getFromCache(n);if(r.found)return{dataPromise:Promise.resolve({coords:r.coords,tileData:r.value,adjustment:this.calcAdjustment(t,r.coords)}),abortLoading:function(){}};var i,a=this.makeTileKey(n);if(!(a in this._pendingRequests)){var s=this.makeRequestData(n),l=s.url,u=s.options,c=this._xhrQueue.put(l,u),f=(i=regeneratorRuntime.mark((function t(){var r,i,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,c;case 3:r=t.sent,t.next=9;break;case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",{error:t.t0});case 9:return t.prev=9,delete e._pendingRequests[a],t.finish(9);case 12:return t.next=14,e.processResponse(r,n);case 14:return i=t.sent,o=i.tileData,s=i.coords,e._cache.put(e.makeTileKey(s),o),t.abrupt("return",{tileData:o,coords:s});case 19:case"end":return t.stop()}}),t,null,[[0,6,9,12]])})),function(){var t=this,e=arguments;return new Promise((function(n,r){var a=i.apply(t,e);function s(t){o(a,n,r,s,l,"next",t)}function l(t){o(a,n,r,s,l,"throw",t)}s(void 0)}))})(),d=this._pendingRequests[a]={dataPromise:f,refCount:0};d.abortLoading=function(){d.refCount-=1,d.refCount<1&&(c.abort(),delete e._pendingRequests[a])}}var h=this._pendingRequests[a];return h.refCount+=1,{dataPromise:h.dataPromise.then((function(n){return n.error?n:{coords:n.coords,tileData:n.tileData,adjustment:e.calcAdjustment(t,n.coords)}})),abortLoading:function(){return h.abortLoading()}}}}])&&u(e.prototype,n),c&&u(e,c),t}();e.TiledDataLoader=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n(447))&&r.__esModule?r:{default:r};var o=function(t,e){for(var n=0;n<i.default.length;n++){var r=i.default[n](e,t);if(null!==r)return r}return[{name:t,error:"UNSUPPORTED"}]};e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){"ï»¿"===t.substr(0,3)&&(t=t.substr(3));return t}},function(t,e,n){"use strict";n(7),n(10),n(11),n(15),n(13),n(1),n(8),n(2),n(6),n(0),n(20),n(4),n(5),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n(30);var r,i=(r=n(452))&&r.__esModule?r:{default:r};function o(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw o}}}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}function l(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){s(o,r,i,a,l,"next",t)}function l(t){s(o,r,i,a,l,"throw",t)}a(void 0)}))}}function u(){return(u=l(regeneratorRuntime.mark((function t(e){var n,r,a,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=o(i.default),t.prev=1,n.s();case 3:if((r=n.n()).done){t.next=10;break}if(a=r.value,!(s=new a(e)).isOurUrl()){t.next=8;break}return t.abrupt("return",s.geoData());case 8:t.next=3;break;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),n.e(t.t0);case 15:return t.prev=15,n.f(),t.finish(15);case 18:return t.abrupt("return",[{name:e,error:"INVALID_URL"}]);case 19:case"end":return t.stop()}}),t,null,[[1,12,15,18]])})))).apply(this,arguments)}var c=function(t){return u.apply(this,arguments)};e.default=c},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n(7),n(10),n(11),n(22),n(15),n(13),n(1),n(18),n(154),n(8),n(2),n(6),n(0),n(14),n(4),n(5),n(52),n(41),n(23),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.saveNktk=function(t,e,n,r,s,u){var c={view:{color:n,shown:!u,ticksShown:r}},d=c.track={name:e};if(t&&t.length){var h,m=[],y=f(t);try{for(y.s();!(h=y.n()).done;){var g=v(h.value),b=g.deltaLats,w=g.deltaLons;m.push({lats:b,lons:w})}}catch(t){y.e(t)}finally{y.f()}d.segments=m}if(s&&s.length){var k=0,_=0;s.forEach((function(t){k+=t.latlng.lng,_+=t.latlng.lat})),k=Math.round(k*p/s.length),_=Math.round(_*p/s.length),d.waypoints={midLat:_,midLon:k};var S,x=[],O=f(s);try{for(O.s();!(S=O.n()).done;){var P=S.value;x.push({name:P.label,lat:Math.round(P.latlng.lat*p)-_,lon:Math.round(P.latlng.lng*p)-k})}}catch(t){O.e(t)}finally{O.f()}d.waypoints.waypoints=x}var L=new i.default,C=String.fromCharCode(68);o.TrackView.write(c,L);var M=C+(0,a.arrayBufferToString)(L.finish());return l.encode(M)},e.parseTrackUrlData=function(t){if(!(t=l.decode(t)))return[{name:"Text encoded track",error:["CORRUPT"]}];return y(t,0)},e.parseNktkSequence=function(t){return t.split("/").map(b).reduce((function(t,e){var n;return t.push.apply(t,function(t){if(Array.isArray(t))return h(t)}(n=e)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(n)||d(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),t}))},e.parseNktkFragment=b;var i=c(n(288)),o=n(464),a=n(112),s=c(n(130)),l=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var a=i?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=t[o]}n.default=t,e&&e.set(t,n);return n}(n(296));function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}function c(t){return t&&t.__esModule?t:{default:t}}function f(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=d(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function d(t,e){if(t){if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(t,e):void 0}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var p=46603.375;function m(t){this._string=t,this.position=0}function v(t){for(var e,n,r=[],i=[],o=0,a=0,s=0,l=t.length;s<l;s++){var u=t[s],c=(e=Math.round(u.lng*p))-o,f=(n=Math.round(u.lat*p))-a;r.push(f),i.push(c),o=e,a=n}return{deltaLats:r,deltaLons:i}}function y(t,e){var n,r,i,o,a,l,u,c,f,d,h,p,v,y=[],g=46603.375,b=[],w=!1;t=new m(t);try{r=t.readNumber(),n=t.readString(r),n=s.default.decode(n),o=t.readNumber();for(var k=0;k<o;k++){i=[],a=t.readNumber(),l=0,u=0;for(var _=0;_<a;_++)l+=t.readNumber(),u+=t.readNumber(),i.push({lng:l/g,lat:u/g});y.push(i),i=null}}catch(t){if(!t.message.match("Unexpected end of line while unpacking number"))throw t;c=["CORRUPT"],i&&y.push(i)}try{p=t.readNumber(),v=t.readNumber()}catch(t){if(!t.message.match("Unexpected end of line while unpacking number"))throw t;p=0,v=0,e>0&&(c=["CORRUPT"])}if(e>=3)try{w=Boolean(t.readNumber())}catch(t){if(!t.message.match("Unexpected end of line while unpacking number"))throw t;c=["CORRUPT"]}if(e>=2)try{(a=t.readNumber())&&(f=t.readNumber(),d=t.readNumber());for(var S=0;S<a;S++)r=t.readNumber(),h=t.readString(r),h=s.default.decode(h),t.readNumber(),l=t.readNumber()+f,u=t.readNumber()+d,b.push({name:h,lat:u/g,lng:l/g})}catch(t){if(!t.message.match("Unexpected end of line while unpacking number"))throw t;c=["CORRUPT"]}return[{name:n||"Text encoded track",tracks:y,error:c,points:b,color:p,measureTicksShown:v,trackHidden:w}]}function g(t){var e,n=new i.default((0,a.stringToArrayBuffer)(t));try{e=o.TrackView.read(n)}catch(t){return[{name:"Text encoded track",error:["CORRUPT"]}]}var r={name:e.track.name||"Text encoded track",color:e.view.color,trackHidden:!e.view.shown,measureTicksShown:e.view.ticksShown},s=e.track.segments;if(s&&s.length&&(r.tracks=s.map((function(t){return function(t,e){for(var n=0,r=0,i=[],o=0;o<t.length;o++)n+=t[o],r+=e[o],i.push({lat:n/p,lng:r/p});return i}(t.lats,t.lons)}))),e.track.waypoints&&e.track.waypoints.waypoints.length){var l,u=r.points=[],c=f(e.track.waypoints.waypoints);try{for(c.s();!(l=c.n()).done;){var d=l.value;u.push({name:d.name,lat:(d.lat+e.track.waypoints.midLat)/p,lng:(d.lon+e.track.waypoints.midLon)/p})}}catch(t){c.e(t)}finally{c.f()}}return[r]}function b(t){if(!(t=l.decode(t)))return[{name:"Text encoded track",error:["CORRUPT"]}];var e=new m(t),n=e.readNumber();return 1===n||2===n||3===n?y(t.substring(e.position),n):4===n?g(t.substring(e.position)):[{name:"Text encoded track",error:["CORRUPT"]}]}m.prototype.readNumber=function(){var t=function(t,e){var n,r=0;if(n=t.charCodeAt(e),isNaN(n))throw new Error("Unexpected end of line while unpacking number");if(n<128)return[r=n-64,1];if(r=127&n,n=t.charCodeAt(e+1),isNaN(n))throw new Error("Unexpected end of line while unpacking number");if(n<128)return r|=n<<7,[r-=8192,2];if(r|=(127&n)<<7,n=t.charCodeAt(e+2),isNaN(n))throw new Error("Unexpected end of line while unpacking number");if(n<128)return r|=n<<14,[r-=1048576,3];if(r|=(127&n)<<14,n=t.charCodeAt(e+3),isNaN(n))throw new Error("Unexpected end of line while unpacking number");return r|=n<<21,[r-=268435456,4]}(this._string,this.position);return this.position+=t[1],t[0]},m.prototype.readString=function(t){var e=this._string.slice(this.position,this.position+t);return this.position+=t,e}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";n(25),Object.defineProperty(e,"__esModule",{value:!0}),e.onElementResize=function(t,e){if(window.ResizeObserver){new ResizeObserver((function(){return e()})).observe(t)}else{var n=t.offsetWidth,r=t.offsetHeight;setInterval((function(){var i=t.offsetWidth,o=t.offsetHeight;i===n&&o===r||(n=i,r=o,e())}),200)}}},function(t,e,n){"use strict";var r,i=(r=n(121))&&r.__esModule?r:{default:r};n(377),n(122),i.default.components.register("progress-indicator",{template:'\n        <div class="ko-progress-unknown icon-spinner-nuclear" data-bind="visible: progress() === undefined"></div>\n        <div class="ko-progress" data-bind="visible: progress() !== undefined">\n            <div class="ko-progress-bkg">\n                <div class="ko-progress-bar"  data-bind="style: {width: progress() + \'%\'}"></div>\n            </div>\n        </div>',viewModel:function(t){this.progress=i.default.pureComputed((function(){var e=t.progressRange(),n=t.progressDone();return void 0===n?void 0:100*n/e}))}})},,function(t,e,n){"use strict";n(18),n(124),Object.defineProperty(e,"__esModule",{value:!0}),e.getTempMap=function(t,e,n){var r,o,a,s=i.default.DomUtil.create("div","",document.body);if(e){var l=n.getSize();r=l.x,o=l.y,a=n.min.add(l.divideBy(2)),a=i.default.CRS.EPSG3857.pointToLatLng(a,t)}else r=100,o=100,a=i.default.latLng(0,0);Object.assign(s.style,{width:"".concat(r,"px"),height:"".concat(o,"px"),position:"absolute",left:"0",top:"0",visibility:"hidden"});var u=i.default.map(s,{fadeAnimation:!1,zoomAnimation:!1,inertia:!1,maxZoom:18});return u.setView(a,t),u},e.disposeMap=function(t){var e=t._container;t.remove(),i.default.DomUtil.remove(e)};var r,i=(r=n(9))&&r.__esModule?r:{default:r};n(272),n(391),n(393),n(395),n(396),n(281),n(406),n(408)},function(t,e,n){"use strict";n(1),n(24),n(0),n(20),n(5),n(3),n(30);var r=a(n(9)),i=a(n(51)),o=n(387);function a(t){return t&&t.__esModule?t:{default:t}}function s(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}function l(){}var u,c,f={tileImagePromiseFromCoords:function(t){throw new Error("Method not implemented")},waitTilesReadyToGrab:function(){return Promise.resolve(null)},getTilesInfo:(u=regeneratorRuntime.mark((function t(e){var n,i,o,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.waitTilesReadyToGrab();case 2:return n=e.pixelBounds,i=this._pxBoundsToTileRange(n),o=n.min,a=regeneratorRuntime.mark((function t(){var n,a,s,l=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=i.min.y;case 1:if(!(n<=i.max.y)){t.next=15;break}a=regeneratorRuntime.mark((function t(i){var a,s,u,c,f,d,h,p,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((a=new r.default.Point(i,n)).z=l._tileZoom,l._isValidTile(a)){t.next=4;break}return t.abrupt("return","continue");case 4:return s=l._getTilePos(a),(u=a.add(r.default.point(1,1))).z=a.z,c=l._getTilePos(u),f=c.subtract(s),d=r.default.latLngBounds(l._map.unproject(s.add(l._level.origin)),l._map.unproject(c.add(l._level.origin))),s=s.add(l._level.origin).subtract(o),h=l.tileImagePromiseFromCoords(l._wrapCoords(a),e),p=h.tilePromise,m=h.abortLoading,t.next=14,{tilePromise:p.then((function(t){return{image:t,tilePos:s,tileSize:f,latLngBounds:d}})),abortLoading:m};case 14:case"end":return t.stop()}}),t)})),s=i.min.x;case 4:if(!(s<=i.max.x)){t.next=12;break}return t.delegateYield(a(s),"t0",6);case 6:if("continue"!==t.t0){t.next=9;break}return t.abrupt("continue",9);case 9:s++,t.next=4;break;case 12:n++,t.next=1;break;case 15:case"end":return t.stop()}}),t)})).bind(this),t.abrupt("return",{iterateTilePromises:a,count:(i.max.x-i.min.x+1)*(i.max.y-i.min.y+1)});case 7:case"end":return t.stop()}}),t,this)})),c=function(){var t=this,e=arguments;return new Promise((function(n,r){var i=u.apply(t,e);function o(t){s(i,n,r,o,a,"next",t)}function a(t){s(i,n,r,o,a,"throw",t)}o(void 0)}))},function(t){return c.apply(this,arguments)})},d=r.default.Util.extend({},f,{cloneForPrint:function(t){return r.default.tileLayer(this._url,r.default.Util.extend({},this.options,t))},tileImagePromiseFromCoords:function(t,e){var n=e.xhrOptions,r=this.getTileUrl(t);if(!r)return{tilePromise:Promise.resolve(null),abortLoading:l};this.options.noCors&&(r=(0,i.default)(r));var a=this.options.xhrQueue.put(r,n);return{tilePromise:e.rawData?a:a.then(o.imgFromDataString),abortLoading:function(){return a.abort()}}}});r.default.TileLayer.include(d)},,function(t,e,n){"use strict";n(7),n(46),n(22),n(62),n(19),n(59),n(96),n(34),n(23);var r,i=(r=n(9))&&r.__esModule?r:{default:r};function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n(394);var s=i.default.CRS.EPSG3395;i.default.Layer.Yandex=i.default.TileLayer.extend({options:{subdomains:"1234",className:i.default.Browser.retina?"":"yandex-tile-layer",yandexScale:i.default.Browser.retina?2:1},_getTilePos:function(t){var e=s.pointToLatLng(t.scaleBy(this.getTileSize()),t.z);return this._map.project(e,t.z).subtract(this._level.origin).round()},_pxBoundsToTileRange:function(t){var e=this._tileZoom,n=new i.default.Bounds(s.latLngToPoint(this._map.unproject(t.min,e),e),s.latLngToPoint(this._map.unproject(t.max,e),e));return i.default.TileLayer.prototype._pxBoundsToTileRange.call(this,n)},createTile:function(t,e){var n=i.default.TileLayer.prototype.createTile.call(this,t,e),r=i.default.point(t).add([0,1]);return r.z=t.z,n._adjustHeight=this._getTilePos(r).y-this._getTilePos(t).y,n},_initTile:function(t){i.default.TileLayer.prototype._initTile.call(this,t),t.style.height="".concat(t._adjustHeight,"px")}}),i.default.Layer.Yandex.Map=i.default.Layer.Yandex.extend({initialize:function(t){i.default.Layer.Yandex.prototype.initialize.call(this,"https://vec0{s}.maps.yandex.net/tiles?l=map&x={x}&y={y}&z={z}&scale={yandexScale}",t)}}),i.default.Layer.Yandex.Sat=i.default.Layer.Yandex.extend({initialize:function(t){i.default.Layer.Yandex.prototype.initialize.call(this,"https://sat0{s}.maps.yandex.net/tiles?l=sat&x={x}&y={y}&z={z}",t)}}),i.default.Layer.Yandex.Tracks=i.default.Layer.Yandex.extend({initialize:function(t){t=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({minZoom:10,maxNativeZoom:16},t),i.default.Layer.Yandex.prototype.initialize.call(this,"https://core-gpstiles.maps.yandex.net/tiles?style=point&x={x}&y={y}&z={z}",t)}})},function(t,e,n){"use strict";var r,i=(r=n(9))&&r.__esModule?r:{default:r};i.default.Layer.GoogleBase=i.default.TileLayer.extend({options:{subdomains:"0123"},getTileUrl:function(t){var e={x:t.x,y:t.y,z:17-this._getZoomForUrl(),s:this._getSubdomain(t),lang:navigator.language||""};return i.default.Util.template(this._url,e)}}),i.default.Layer.GoogleMap=i.default.Layer.GoogleBase.extend({initialize:function(t){i.default.Layer.GoogleBase.prototype.initialize.call(this,"https://mt{s}.google.com/vt/lyrs=m@169000000&hl={lang}&x={x}&y={y}&zoom={z}",t)}}),i.default.Layer.GoogleTerrain=i.default.Layer.GoogleBase.extend({initialize:function(t){i.default.Layer.GoogleBase.prototype.initialize.call(this,"https://mt{s}.google.com/vt/lyrs=t@130,r@206000000&hl={lang}&x={x}&y={y}&zoom={z}",t)}}),i.default.Layer.GoogleHybrid=i.default.Layer.GoogleBase.extend({initialize:function(t){i.default.Layer.GoogleBase.prototype.initialize.call(this,"https://mt{s}.google.com/vt/lyrs=h@169000000&hl={lang}&x={x}&y={y}&zoom={z}",t)}}),i.default.Layer.GoogleSat=i.default.TileLayer.extend({options:{subdomains:"0123"},initialize:function(t){i.default.TileLayer.prototype.initialize.call(this,"https://mt{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",t)}})},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n(7),n(10),n(11),n(16),n(15),n(13),n(1),n(8),n(2),n(24),n(6),n(50),n(0),n(4),n(5),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.WestraPassesMarkers=void 0;var i=h(n(9));n(169);var o=n(278),a=h(n(279)),s=n(171),l=h(n(280)),u=n(67),c=n(103),f=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var e=d();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var a=i?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=t[o]}n.default=t,e&&e.set(t,n);return n}(n(97));function d(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return d=function(){return t},t}function h(t){return t&&t.__esModule?t:{default:t}}function p(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return m(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var v=i.default.Layer.CanvasMarkers.extend({options:{filePasses:"westra_passes.json",scaleDependent:!0},initialize:function(t,e){i.default.Layer.CanvasMarkers.prototype.initialize.call(this,null,e),this.on("markerclick",this.showPassDescription,this),this._baseUrl=t,this.url=t+this.options.filePasses},loadData:function(){var t=this;this._downloadStarted||(this._downloadStarted=!0,(0,u.fetch)(this.url).then((function(e){return t._loadMarkers(e)}),(function(e){t._downloadStarted=!1,f.captureException(e,"failed to get westra passes"),(0,c.notify)("Failed to get Westra passes data")})))},onAdd:function(t){i.default.Layer.CanvasMarkers.prototype.onAdd.call(this,t),this.loadData()},_makeTooltip:function(t){var e=t.properties,n=e.grade||"";return n&&e.elevation&&(n+=", "),(n+=e.elevation||"")&&(n=" ("+n+")"),n=(e.name||"без названия")+n,n=(e.is_summit?"Вершина ":"Перевал ")+n},_passToGpx:function(t){var e=t.tooltip;"function"==typeof e&&(e=e(t)),e=(0,a.default)(e);var n='<?xml version="1.0" encoding="UTF-8" standalone="no" ?>\n                <gpx xmlns="http://www.topografix.com/GPX/1/1"\n                     creator="http://nakarte.me"\n                     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n                     xsi:schemaLocation="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd"\n                     version="1.1">\n                    <wpt lat="'.concat(t.latlng.lat.toFixed(6),'" lon="').concat(t.latlng.lng.toFixed(6),'">\n                        <name>').concat(e,"</name>\n                    </wpt>\n                </gpx>\n            "),r=t.properties.name||"Без названия";(0,s.saveAs)(new Blob([n],{type:"application/gpx+xml"}),r+".gpx",!0)},_passToKml:function(t){var e=t.tooltip;"function"==typeof e&&(e=e(t)),e=(0,a.default)(e);var n='<?xml version="1.0" encoding="UTF-8"?>\n                <kml xmlns="http://www.opengis.net/kml/2.2">\n                    <Placemark>\n                        <name>'.concat(e,"</name>\n                        <Point>\n                            <coordinates>\n                                ").concat(t.latlng.lng.toFixed(6),",").concat(t.latlng.lat.toFixed(6),",0\n                            </coordinates>\n                        </Point>\n                    </Placemark>\n                </kml>\n            "),r=t.properties.name||"Без названия";(0,s.saveAs)(new Blob([n],{type:"application/vnd.google-earth.kml+xml"}),r+".kml",!0)},_makeIcon:function(t){var e;return e="westra-pass-marker ",t.properties.is_summit?e+="westra-pass-marker-summit":e+="westra-pass-marker-"+t.properties.grade_eng,(0,l.default)(e)},_loadMarkers:function(t){var e,n,r,i=[],o=JSON.parse(t.response);for(n=0;n<o.length;n++)r={latlng:{lat:(e=o[n]).latlon[0],lng:e.latlon[1]},label:e.name||"",icon:this._makeIcon,tooltip:this._makeTooltip.bind(this),properties:e},i.push(r);this.addMarkers(i),this._dataLoaded=!0,this.fire("data-loaded")},showPassDescription:function(t){if(this._map){var e,n=t.marker.properties,r=t.marker.latlng,i="https://westra.ru/passes/Passes/"+n.id,a="",s="",l="";if(n.altnames&&(a="\n                    <tr>\n                        <td>Другие названия</td>\n                        <td>".concat(n.altnames,"</td>\n                    </tr>")),n.is_summit||(s="\n                    <tr>\n                        <td>Соединяет</td>\n                        <td>".concat(n.connects||"неизвестнo","</td>\n                    </tr>")),n.comments){var u,c=p(n.comments);try{for(c.s();!(u=c.n()).done;){var f=u.value,d="";f.user&&(d='<span class="westra-passes-description-comment-author">'.concat(f.user,":</span>")),l+='<p class="westra-passes-description-comment">'.concat(d).concat(f.content,"</p>")}}catch(t){c.e(t)}finally{c.f()}l="\n                    <tr>\n                        <td>Комментарии</td>\n                        <td>".concat(l,"</td>\n                    </tr>")}e=n.reports_total?"<br>Отчетов: ".concat(n.reports_total,", ")+"с фото: ".concat(n.reports_photo||0,", ")+"с описанием: ".concat(n.reports_tech||0):"<br>Отчетов нет";var h='\n                <table class="pass-details">\n                    <tr>\n                        <td>'.concat(n.is_summit?"Вершина ":"Перевал ","</td>\n                        <td>").concat(n.name||"название неизвестно","</td>\n                    </tr>\n                    ").concat(a,"\n                    <tr>\n                        <td>Категория</td>\n                        <td>").concat(n.grade||"неизвестная","</td>\n                    </tr>\n                    <tr>\n                        <td>Высота</td>\n                        <td>").concat(n.elevation?n.elevation+" м":"неизвестная","</td>\n                    </tr>\n                    ").concat(s,"\n                    <tr>\n                        <td>Характеристика склонов</td>\n                        <td>").concat(n.slopes||"неизвестная",'</td>\n                    </tr>\n                    <tr>\n                        <td>Координаты</td>\n                        <td>\n                            <table class="coords">\n                                <tr class="header">\n                                    <td>Широта</td>\n                                    <td>Долгота</td>\n                                </tr>\n                                <tr>\n                                    <td>').concat(r.lat.toFixed(5),"</td>\n                                    <td>").concat(r.lng.toFixed(5),'</td>\n                                    <td><a id="westra-pass-gpx" title="Сохранить">gpx</a></td>\n                                    <td><a id="westra-pass-kml" title="Сохранить">kml</a></td>\n                                </tr>\n                            </table>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>На сайте Вестры</td>\n                        <td><a id="westra-pass-link" href="').concat(i,'">').concat(i,"</a>").concat(e,"</td></tr>\n                    <tr>\n                        <td>Добавил</td>\n                        <td>").concat(n.author||"неизвестно","</td>\n                    </tr>\n                    ").concat(l,"\n                </table>");this._map.openPopup(h,r,{maxWidth:500}),document.getElementById("westra-pass-link").onclick=function(){return(0,o.openPopupWindow)(i,780,"westra-details"),!1},document.getElementById("westra-pass-gpx").onclick=function(){return this._passToGpx(t.marker),!1}.bind(this),document.getElementById("westra-pass-kml").onclick=function(){return this._passToKml(t.marker),!1}.bind(this)}}});e.WestraPassesMarkers=v},,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.openPopupWindow=function(t,e){var n,i,o,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=screen.availLeft||0,l=8;window.screenX-s-1.5*l>e?n=window.screenX-e-1.5*l:window.screenX+window.outerWidth+e+1.5*l<s+screen.availWidth?n=window.screenX+window.outerWidth+l:(n=window.screenX+window.outerWidth/2-e/2)<0&&(n=0);i=window.screenY,o=window.innerHeight;var u="width="+e+",height="+o+",left="+n+",top="+i;u+=",resizable,scrollbars";var c=window.open(t,a,u);!c||c.closed?(0,r.notify)("Всплывающее окно заблокировано браузером.\nДля полноценной работы сайта необходимо разрешить всплывающие окна в настройках браузера для сайта.\n\nPop-up window was blocked by the browser.\nIf you want to use the full functionality of this site, turn off blocking pop-ups in the browser settings for this site."):c.focus()};var r=n(103)},,function(t,e,n){"use strict";n(14),n(43),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i,o=(r=function(t){var e=document.createElement("div");e.style.position="absolute",document.body.appendChild(e);var n=document.createElement("div");n.className=t,e.appendChild(n);var r={url:window.getComputedStyle(n).backgroundImage.replace(/^url\("?/,"").replace(/"?\)$/,""),center:[-n.offsetLeft,-n.offsetTop]};return document.body.removeChild(e),e.removeChild(n),r},i={},function(t){return t in i||(i[t]=r(t)),i[t]});e.default=o},function(t,e,n){"use strict";n(18),n(24),n(0),n(20),n(30);var r,i,o,a=(r=n(9))&&r.__esModule?r:{default:r};function s(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}n(169),a.default.Layer.CanvasMarkers.include({_printProgressWeight:.1,cloneMarker:function(t){return{latlng:{lat:t.latlng.lat,lng:t.latlng.lng},label:t.label,icon:t.icon}},cloneMarkers:function(){return this.rtree.all().map(this.cloneMarker)},cloneForPrint:function(t){return void 0!==(t=a.default.Util.extend({},this.options,{noWrap:!0})).printIconsOpacity&&(t.iconsOpacity=t.printIconsOpacity),new a.default.Layer.CanvasMarkers(this.cloneMarkers(),t)},getTilesInfo:(i=regeneratorRuntime.mark((function t(e){var n,r,i,o,s,l,u,c,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.options.iconScale=e.resolution/90*.75,n=e.pixelBounds.getSize().x/e.destPixelSize.x,r={tileN:e.pixelBounds.getTopRight().y/n,tileS:e.pixelBounds.getBottomLeft().y/n,tileE:e.pixelBounds.getTopRight().x/n,tileW:e.pixelBounds.getBottomLeft().x/n},i=a.default.CRS.EPSG3857,this._map||(o={project:i.latLngToPoint.bind(i),unproject:i.pointToLatLng.bind(i)},this._map=o),s=i.zoom(1/n*i.scale(e.zoom)),l=this.selectMarkersForDraw(r,s,!0),u=l.iconUrls,c=l.markerJobs,f=l.pointsForLabels,t.next=9,this.preloadIcons(u);case 9:return t.abrupt("return",{iterateTilePromises:regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,{tilePromise:Promise.resolve({draw:function(t){e.resetLabels(),e.drawSelectedMarkers(t,r,c,f,s,!0)},isOverlay:!0,overlaySolid:!this.options.printTransparent}),abortLoading:function(){}};case 2:case"end":return t.stop()}}),t,this)})).bind(this),count:1});case 10:case"end":return t.stop()}}),t,this)})),o=function(){var t=this,e=arguments;return new Promise((function(n,r){var o=i.apply(t,e);function a(t){s(o,n,r,a,l,"next",t)}function l(t){s(o,n,r,a,l,"throw",t)}a(void 0)}))},function(t){return o.apply(this,arguments)})})},function(t,e,n){"use strict";n(22),n(31),n(2),n(24),n(0),n(172),n(4),n(23),n(25);var r,i=(r=n(9))&&r.__esModule?r:{default:r};n(407),i.default.MeasuredLine=i.default.Polyline.extend({options:{minTicksIntervalMm:15},onAdd:function(t){i.default.Polyline.prototype.onAdd.call(this,t),this._ticks={},this.updateTicks(),this._map.on("zoomend",this.updateTicks,this),this._map.on("moveend",this.updateTicks,this),this.on("nodeschanged",this.updateTicksLater,this)},updateTicksLater:function(){setTimeout(this.updateTicks.bind(this),0)},onRemove:function(t){this._map.off("zoomend",this.updateTicks,this),this._map.off("moveend",this.updateTicks,this),this.off("nodeschanged",this.updateTicks,this),this._clearTicks(),i.default.Polyline.prototype.onRemove.call(this,t)},_clearTicks:function(){var t=this;this._map&&(Object.values(this._ticks).forEach((function(e){return t._map.removeLayer(e)})),this._ticks={})},_addTick:function(t,e){var n=this,r="matrix("+t.transformMatrix.join(",")+")";if(e)e._icon.childNodes[0].style.transform=r,e.setLatLng(t.position);else{var o=Math.round(t.distanceValue/10)/100+" km",a=i.default.divIcon({html:'<div class="measure-tick-icon-text" style="transform:'+r+'">'+o+"</div>",className:"measure-tick-icon"});(e=i.default.marker(t.position,{icon:a,interactive:!1,keyboard:!1,projectedShift:function(){return n.shiftProjectedFitMapView()}})).addTo(this._map)}this._ticks[t.distanceValue.toString()]=e},setMeasureTicksVisible:function(t){this.options.measureTicksShown=t,this.updateTicks()},getTicksPositions:function(t,e){var n,r=[],o=this;function a(t,n,a){if(e){var s=o._map.wrapLatLngBounds(e),l=t.wrap(),u=i.default.latLng(l.lat,l.lng-360),c=i.default.latLng(l.lat,l.lng+360);if(!s.contains(l)&&!s.contains(u)&&!s.contains(c))return}var f,d=function(t){var e=i.default.CRS.EPSG3857.project(t[0]),n=i.default.CRS.EPSG3857.project(t[1]),r=n.x-e.x,o=e.y-n.y,a=Math.sqrt(r*r+o*o);return[o/a,r/a]}(n),h=d[0],p=d[1];f=h>0?[h,-p,p,h,0,0]:[-h,p,-p,-h,0,0],r.push({position:t,distanceValue:a,transformMatrix:f})}for(var s=0,l=[500,1e3,2e3,5e3,1e4,2e4,5e4,1e5,2e5,5e5,1e6];s<l.length&&!((n=l[s])>=t);s++);var u,c,f,d,h,p,m=0,v=0,y=this._latlngs,g=y.length;if(g<2)return r;for(var b=1;b<g;b++){if((u=v+y[b].distanceTo(y[b-1]))>=m+n)for(;m+n<=u;)m+=n,a((c=y[b-1],f=y[b],d=void 0,h=void 0,p=void 0,d=(m-v)/c.distanceTo(f),h=c.lng+(f.lng-c.lng)*d,p=c.lat+(f.lat-c.lat)*d,i.default.latLng(p,h)),[y[b-1],y[b]],m);v=u}return v-m<t/2&&r.pop(),v>t/2&&a(y[0],[y[0],y[1]],0),a(y[g-1],[y[g-2],y[g-1]],v),r},updateTicks:function(){var t=this;if(this._map)if(this.options.measureTicksShown){var e=this._map.getBounds().pad(1),n=Math.PI/180,r=20003931/this._map.project([180,0]).x,i=this.getLatLngs().length?this.getBounds().getCenter():this._map.getCenter(),o=1/96*2.54/100/(r*Math.cos(i.lat*n)),a=this.options.minTicksIntervalMm/o/1e3,s=this.getTicksPositions(a,e),l=this._ticks;this._ticks={},s.forEach(function(t){var e=l[t.distanceValue.toString()];this._addTick(t,e),e&&delete l[t.distanceValue.toString()]}.bind(this)),Object.values(l).forEach((function(e){return t._map.removeLayer(e)}))}else this._clearTicks()},getLength:function(){for(var t=this._latlngs,e=t.length,n=0,r=1;r<e;r++)n+=t[r].distanceTo(t[r-1]);return n}}),i.default.measuredLine=function(t,e){return new i.default.MeasuredLine(t,e)}},function(t,e,n){"use strict";n(7),n(10),n(11),n(1),n(2),n(28),n(35),n(29),n(0),n(39),n(4),n(5),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.RetinaTileLayer=void 0;var r,i=(r=n(9))&&r.__esModule?r:{default:r};function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=c(t);if(e){var i=c(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u(this,n)}}function u(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(n,t);var e=l(n);function n(t,r){var o,s,l,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"auto";a(this,n);var c="auto"===u?i.default.Browser.retina:u,f=i.default.extend({},r);return c?(s=t[1],l=2):(l=1,s=t[0]),r.retinaOptionsOverrides&&i.default.extend(f,r.retinaOptionsOverrides[c?1:0]),(o=e.call(this,s,f)).urls=t,o.tileSizeMultiplicator=l,o}return n}(i.default.TileLayer);e.RetinaTileLayer=f},function(t,e,n){"use strict";n(16),n(1),n(69),n(0),n(311),n(107),n(70),n(71),n(72),n(73),n(74),n(75),n(76),n(77),n(78),n(79),n(80),n(81),n(82),n(83),n(84),n(85),n(86),n(87),n(88),n(89),n(90),n(91),n(92),Object.defineProperty(e,"__esModule",{value:!0}),e.getDeclination=function(t,e){if(t<o.default.minLat||t>o.default.maxLat)return null;n=e+180,r=360,e=(n%r+r)%r-180;var n,r;var i=Math.floor((t-o.default.minLat)/o.default.step),a=i+1,l=(t-(i*o.default.step+o.default.minLat))/o.default.step,u=Math.floor((e+180)/o.default.step),c=u+1,f=(e-(u*o.default.step-180))/o.default.step;u%=o.default.colsCount,c%=o.default.colsCount;var d=s(i,u),h=s(i,c),p=d*(1-f)+h*f;if(a>=o.default.rowsCount)return p;return d=s(a,u),h=s(a,c),p*(1-l)+(d*(1-f)+h*f)*l};var r,i,o=(r=n(413))&&r.__esModule?r:{default:r},a=n(112);function s(t,e){if(t<0||e<0||e>=o.default.colsCount||t>=o.default.rowsCount)throw new Error("Invalid col/row value col=".concat(e," row=").concat(t));var n=t*o.default.colsCount+e;if(n>=i.length)throw new Error("Index value out of range");return i[n]}i=function(){for(var t=new Uint8Array((0,a.stringToArrayBuffer)(atob(o.default.array))),e=new Float32Array(t.length),n=o.default.valueScale,r=o.default.valueOffset,i=0;i<t.length;i++)e[i]=t[i]/n-r;return e}()},,,,,function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";n(65),n(24),n(106),Object.defineProperty(e,"__esModule",{value:!0}),e.DragEvents=void 0;var r,i=(r=n(9))&&r.__esModule?r:{default:r};var o=i.default.Evented.extend({options:{dragTolerance:2,dragButtons:[0],stopOnLeave:!1},initialize:function(t,e){i.default.setOptions(this,e),this.element=t,this.dragButton=null,this.startEvent=null,this.prevEvent=null,this.isDragging=!1,i.default.DomEvent.on(t,"mousedown",this.onMouseDown,this)},onMouseDown:function(t){null===this.dragButton&&this.options.dragButtons.includes(t.button)&&(this.dragButton=t.button,this.startEvent=t,this.prevEvent=t,i.default.DomUtil.disableImageDrag(),i.default.DomUtil.disableTextSelection(),this._moveHandler=this.onMouseMove.bind(this),document.addEventListener("mousemove",this._moveHandler,!0),i.default.DomEvent.on(document,"mouseup",this.onMouseUp,this),this.options.stopOnLeave&&i.default.DomEvent.on(this.element,"mouseleave",this.onMouseLeave,this))},onMouseUp:function(t){this.dragButton===t.button&&(this.isDragging?this.fireDragEvent("dragend",t):this.fire("click",{originalEvent:t,target:this.element}),this.finishDrag())},onMouseMove:function(t){var e,n=this;this.isDragging?(this.fireDragEvent("drag",t),this.prevEvent=t):null!==this.dragButton&&(e=n.options.dragTolerance,Math.abs(t.clientX-n.startEvent.clientX)>e||Math.abs(t.clientY-n.startEvent.clientY)>e)&&(this.isDragging=!0,this.fireDragEvent("dragstart",this.startEvent),this.fireDragEvent("drag",t),this.prevEvent=t)},onMouseLeave:function(t){this.isDragging&&(this.fireDragEvent("dragend",t),this.finishDrag())},fireDragEvent:function(t,e){var n=i.default.point(this.prevEvent.clientX,this.prevEvent.clientY),r=i.default.point(e.clientX,e.clientY),o={dragButton:this.dragButton,originalEvent:e,dragMovement:r.subtract(n)};this.fire(t,o)},finishDrag:function(){this.isDragging=!1,this.dragButton=null,i.default.DomUtil.enableImageDrag(),i.default.DomUtil.enableTextSelection(),document.removeEventListener("mousemove",this._moveHandler,!0),i.default.DomEvent.off(document,"mouseup",this.onMouseUp,this),i.default.DomEvent.off(this.element,"mouseleave",this.onMouseLeave,this)}});e.DragEvents=o},function(t,e,n){"use strict";n(31),n(18),n(8),Object.defineProperty(e,"__esModule",{value:!0}),e.xmlGetNodeText=function(t){if(t)return Array.prototype.slice.call(t.childNodes).map((function(t){return t.nodeValue})).join("");return null}},function(t,e,n){var r;n(1),n(0),n(3),r=function t(e){this.fileContents=new t.BigEndianBinaryStream(e)},this.JSUnzip=r,r.MAGIC_NUMBER=67324752,r.prototype={readEntries:function(){if(!this.isZipFile())throw new Error("File is not a Zip file.");this.entries=[];for(var t=new r.ZipEntry(this.fileContents);"string"==typeof t.data;)this.entries.push(t),t=new r.ZipEntry(this.fileContents)},isZipFile:function(){return this.fileContents.getByteRangeAsNumber(0,4)===r.MAGIC_NUMBER}},(r.ZipEntry=function(t){if(this.signature=t.getNextBytesAsNumber(4),this.signature===r.MAGIC_NUMBER){if(this.versionNeeded=t.getNextBytesAsNumber(2),this.bitFlag=t.getNextBytesAsNumber(2),this.compressionMethod=t.getNextBytesAsNumber(2),this.timeBlob=t.getNextBytesAsNumber(4),this.isEncrypted())throw"File contains encrypted entry. Not supported.";if(this.crc32=t.getNextBytesAsNumber(4),this.compressedSize=t.getNextBytesAsNumber(4),this.uncompressedSize=t.getNextBytesAsNumber(4),this.isUsingZip64())throw"File is using Zip64 (4gb+ file size). Not supported";var e;this.fileNameLength=t.getNextBytesAsNumber(2),this.extraFieldLength=t.getNextBytesAsNumber(2),this.fileName=t.getNextBytesAsString(this.fileNameLength),this.extra=t.getNextBytesAsString(this.extraFieldLength),this.data=t.getNextBytesAsString(this.compressedSize),this.isUsingBit3TrailingDataDescriptor()&&("undefined"!=typeof console&&console.log("File is using bit 3 trailing data descriptor. Not supported."),t.getNextBytesAsNumber(16)),this.isUsingUtf8()&&(this.fileName=(e=this.fileName,decodeURIComponent(escape(e))))}}).prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},isUsingUtf8:function(){return 2048==(2048&this.bitFlag)},isUsingBit3TrailingDataDescriptor:function(){return 8==(8&this.bitFlag)},isUsingZip64:function(){return 4294967295===this.compressedSize||4294967295===this.uncompressedSize}},(r.BigEndianBinaryStream=function(t){this.stream=t,this.resetByteIndex()}).prototype={resetByteIndex:function(){this.currentByteIndex=0},getByteAt:function(t){return this.stream.charCodeAt(t)},getNextBytesAsNumber:function(t){var e=this.getByteRangeAsNumber(this.currentByteIndex,t);return this.currentByteIndex+=t,e},getNextBytesAsString:function(t){var e=this.getByteRangeAsString(this.currentByteIndex,t);return this.currentByteIndex+=t,e},getByteRangeAsNumber:function(t,e){for(var n=0,r=t+e-1;r>=t;)n=(n<<8)+this.getByteAt(r),r--;return n},getByteRangeAsString:function(t,e){for(var n="",r=t+e,i=t;i<r;){var o=this.getByteAt(i);n+=String.fromCharCode(o),r-=Math.floor(o/256),i++}return n}}},function(t,e,n){"use strict";n(1),n(69),n(0),n(107),n(70),n(71),n(72),n(73),n(74),n(75),n(76),n(77),n(78),n(79),n(80),n(81),n(82),n(83),n(84),n(85),n(86),n(87),n(88),n(89),n(90),n(91),n(92),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n(449))&&r.__esModule?r:{default:r},o=n(112);var a=function(t,e){if(0===e)return"";var n=new Uint8Array(e);return(0,i.default)(new Uint8Array((0,o.stringToArrayBuffer)(t)),n),(0,o.arrayBufferToString)(n)};e.default=a},function(t,e,n){"use strict";n(31),Object.defineProperty(e,"__esModule",{value:!0}),e.decode866=function(t){var e,n,r=[];for(n=0;n<t.length;n++)(e=t.charCodeAt(n))>=128&&e<=175?e+=912:e>=224&&e<=239?e+=864:240===e?e=1025:241===e&&(e=1105),r.push(String.fromCharCode(e));return r.join("")},e.decodeCP1251=function(t){var e,n,r=[];for(n=0;n<t.length;n++)(e=t.charCodeAt(n))>=192&&e<=255?e+=848:168===e?e=1025:184===e&&(e=1105),r.push(String.fromCharCode(e));return r.join("")}},function(t,e,n){"use strict";n(7),n(10),n(11),n(16),n(46),n(15),n(65),n(45),n(13),n(1),n(18),n(8),n(2),n(6),n(28),n(19),n(213),n(35),n(34),n(29),n(0),n(54),n(20),n(39),n(4),n(106),n(5),n(99),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.NakarteUrlLoader=e.NakarteUrl=e.NakarteTrack=void 0,n(30);var r=c(n(55)),i=n(221),o=c(n(111)),a=n(214),s=c(n(220)),l=c(n(465)),u=n(67);function c(t){return t&&t.__esModule?t:{default:t}}function f(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||S(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){d(o,r,i,a,s,"next",t)}function s(t){d(o,r,i,a,s,"throw",t)}a(void 0)}))}}function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function y(t,e,n){return e&&v(t.prototype,e),n&&v(t,n),t}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function b(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=k(t);if(e){var i=k(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return w(this,n)}}function w(t,e){return!e||"object"!==p(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function k(t){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _(t){return function(t){if(Array.isArray(t))return x(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||S(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(t,e){if(t){if("string"==typeof t)return x(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(t,e):void 0}}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function O(t){var e,n=[],r=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=S(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(t);try{for(r.s();!(e=r.n()).done;){var i=e.value;n.push.apply(n,_(i))}}catch(t){r.e(t)}finally{r.f()}return n}function P(t){if(t.length<2)return[{name:"Point in url",error:"CORRUPT"}];var e=parseFloat(t[0]),n=parseFloat(t[1]);if(isNaN(e)||isNaN(n)||e<-90||e>90||n<-180||n>180)return[{name:"Point in url",error:"CORRUPT"}];var r=(t[2]||"").trim()||"Point";return[{name:r,points:[{name:r,lat:e,lng:n}]}]}var L=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(n,t);var e=b(n);function n(){return m(this,n),e.apply(this,arguments)}return y(n,[{key:"isOurUrl",value:function(){return this.origUrl.indexOf("track://")>-1}},{key:"requestOptions",value:function(){return[]}},{key:"parseResponse",value:function(){var t=this.origUrl.indexOf("track://");return(0,i.parseTrackUrlData)(this.origUrl.substring(t+8))}}]),n}(r.default);e.NakarteTrack=L;var C=function(){function t(){m(this,t),this.loaders={nktk:this.loadFromTextEncodedTrack,nktl:this.loadFromTextEncodedTrackId,nktu:this.loadFromUrlencodedUrls,nktp:this.loadPoint,nktj:this.loadFromJSON}}var e,n,r,a,c,f;return y(t,[{key:"paramNames",value:function(){return Object.keys(this.loaders)}},{key:"geoData",value:(f=h(regeneratorRuntime.mark((function t(e,n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.loaders[e],t.abrupt("return",r.call(this,n));case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return f.apply(this,arguments)})},{key:"loadFromTextEncodedTrack",value:(c=h(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",O(e.map(i.parseNktkFragment)));case 1:case"end":return t.stop()}}),t)}))),function(t){return c.apply(this,arguments)})},{key:"loadFromTextEncodedTrackId",value:(a=h(regeneratorRuntime.mark((function t(e){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.map((function(t){return(0,u.fetch)("".concat(o.default.tracksStorageServer,"/track/").concat(t),{responseType:"binarystring",withCredentials:!0})})),t.prev=1,t.next=4,Promise.all(n);case 4:r=t.sent,t.next=10;break;case 7:return t.prev=7,t.t0=t.catch(1),t.abrupt("return",[{name:"Track from nakarte server",error:"NETWORK"}]);case 10:return t.abrupt("return",O(r.map((function(t){return(0,i.parseNktkSequence)(t.responseBinaryText)}))));case 11:case"end":return t.stop()}}),t,null,[[1,7]])}))),function(t){return a.apply(this,arguments)})},{key:"loadFromJSON",value:(r=h(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=O,t.next=3,Promise.all(e.map(l.default));case 3:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 5:case"end":return t.stop()}}),t)}))),function(t){return r.apply(this,arguments)})},{key:"loadFromUrlencodedUrls",value:(n=h(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=O,t.next=3,Promise.all(e.map(decodeURIComponent).map(s.default));case 3:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 5:case"end":return t.stop()}}),t)}))),function(t){return n.apply(this,arguments)})},{key:"loadPoint",value:(e=h(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",P(e.map(decodeURIComponent)));case 1:case"end":return t.stop()}}),t)}))),function(t){return e.apply(this,arguments)})}]),t}();e.NakarteUrlLoader=C;var M=function(){function t(e){m(this,t);var n=(new C).paramNames();this._params=Object.entries((0,a.parseHashParams)(e)).filter((function(t){var e=f(t,1)[0];return n.includes(e)}))}var e;return y(t,[{key:"isOurUrl",value:function(){return this._params.length>0}},{key:"geoData",value:(e=h(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this._params.map((function(t){var e=f(t,2),n=e[0],r=e[1];return(new C).geoData(n,r)})),t.t0=O,t.next=4,Promise.all(e);case 4:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 6:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),t}();e.NakarteUrl=M},function(t,e,n){"use strict";n(14),n(43),Object.defineProperty(e,"__esModule",{value:!0}),e.encode=function(t){return btoa(t).replace(/\+/g,"-").replace(/\//g,"_")},e.decode=function(t){var e;t=t.replace(/[\t\n\r ]/g,"").replace(/\x2D/g,"+").replace(/_/g,"/");try{e=atob(t)}catch(t){}if(e&&e.length)return e;return null}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n(7),n(10),n(11),n(16),n(46),n(15),n(13),n(1),n(31),n(18),n(154),n(8),n(57),n(2),n(6),n(50),n(34),n(0),n(4),n(5),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.calcSamplingInterval=function(t){var e=t/2e3;e<10&&(e=10);e>50&&(e=50);t/e>9999&&(e=t/9999);return e},e.ElevationProfile=void 0;var i,o=(i=n(9))&&i.__esModule?i:{default:i};n(472);var a=n(298);n(68);var s=n(103),l=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var e=c();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var a=i?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=t[o]}n.default=t,e&&e.set(t,n);return n}(n(97)),u=n(290);function c(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return c=function(){return t},t}function f(t){return function(t){if(Array.isArray(t))return d(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function h(t,e,n){var r=document.createElementNS("http://www.w3.org/2000/svg",t);if(e)for(var i,o,a=Object.keys(e),s=0;s<a.length;s++)o=e[i=a[s]],r.setAttribute(i,o);return n&&n.appendChild(r),r}function p(t){return Math.round(180*Math.atan(t)/Math.PI)}var m=o.default.Class.extend({options:{samplingInterval:50,sightLine:!1},includes:o.default.Evented,initialize:function(t,e,n){o.default.setOptions(this,n),this.path=e;var r=this.samples=function(t,e){if(!t.length)return[];var n,r,i,a,s,l,u=[],c=0,f=0,d=0;for(u.push(t[0]),n=1;n<t.length;n++){if((d=f+t[n].distanceTo(t[n-1]))>=c+e)for(;c+e<=d;)c+=e,u.push((r=t[n-1],i=t[n],a=void 0,s=void 0,l=void 0,a=(c-f)/r.distanceTo(i),s=r.lng+(i.lng-r.lng)*a,l=r.lat+(i.lat-r.lat)*a,o.default.latLng(l,s)));f=d}return u.length<2&&u.push(t[t.length-1]),u}(this.path,this.options.samplingInterval);if((r=r.map((function(t){return t.wrap()}))).length){var i=this;this.horizZoom=1,this.dragStart=null,(new a.ElevationProvider).get(r).then((function(e){i.values=e,i._addTo(t)})).catch((function(t){l.captureException(t,"error getting elevation"),(0,s.notify)("Failed to get elevation data: ".concat(t.message))})),this.values=null}else(0,s.notify)("Track is empty")},_onWindowResize:function(){this._resizeGraph()},_resizeGraph:function(){var t=this.drawingContainer.clientWidth*this.horizZoom;this.svgWidth<this.drawingContainer.clientWidth&&(this.svgWidth=t,this.svg.setAttribute("width",this.svgWidth+"px"),this.updateGraph(),this.updateGraphSelection())},_addTo:function(t){this._map=t;var e=this._container=o.default.DomUtil.create("div","elevation-profile-container");o.default.Control.prototype._stopContainerEvents.call(this),this._map._controlContainer.appendChild(e),this.setupContainerLayout(),this.updateGraph();var n=o.default.divIcon({className:"elevation-profile-marker",html:'<div class="elevation-profile-marker-icon"></div><div class="elevation-profile-marker-label"></div>'});return this.trackMarker=o.default.marker([1e3,0],{interactive:!1,icon:n}),this.polyline=o.default.polyline(this.path,{weight:30,opacity:0}).addTo(t),this.polyline.on("mousemove",this.onLineMouseMove,this),this.polyline.on("mouseover",this.onLineMouseEnter,this),this.polyline.on("mouseout",this.onLineMouseLeave,this),this.polyLineSelection=o.default.polyline([],{weight:20,opacity:.5,color:"yellow",lineCap:"butt"}),this},setupContainerLayout:function(){var t=this.horizZoom=1,e=this._container;this.propsContainer=o.default.DomUtil.create("div","elevation-profile-properties",e),this.leftAxisLables=o.default.DomUtil.create("div","elevation-profile-left-axis",e),this.closeButton=o.default.DomUtil.create("div","elevation-profile-close",e),o.default.DomEvent.on(this.closeButton,"click",this.onCloseButtonClick,this),this.drawingContainer=o.default.DomUtil.create("div","elevation-profile-drawingContainer",e),this.graphCursor=o.default.DomUtil.create("div","elevation-profile-cursor elevation-profile-cursor-hidden",this.drawingContainer),this.graphCursorLabel=o.default.DomUtil.create("div","elevation-profile-cursor-label elevation-profile-cursor-hidden",this.drawingContainer),this.graphSelection=o.default.DomUtil.create("div","elevation-profile-selection elevation-profile-cursor-hidden",this.drawingContainer);var n=this.svgWidth=this.drawingContainer.clientWidth*t,r=this.svgHeight=this.drawingContainer.clientHeight,i=this.svg=h("svg",{width:n,height:r},this.drawingContainer);o.default.DomEvent.on(i,"mousemove",this.onSvgMouseMove,this),o.default.DomEvent.on(i,"mousemove",this.onSvgEnter,this),o.default.DomEvent.on(i,"mouseleave",this.onSvgLeave,this),o.default.DomEvent.on(i,"mousewheel",this.onSvgMouseWheel,this),this.svgDragEvents=new u.DragEvents(this.svg,{dragButtons:[0,2],stopOnLeave:!0}),this.svgDragEvents.on("dragstart",this.onSvgDragStart,this),this.svgDragEvents.on("dragend",this.onSvgDragEnd,this),this.svgDragEvents.on("drag",this.onSvgDrag,this),this.svgDragEvents.on("click",this.onSvgClick,this),o.default.DomEvent.on(i,"dblclick",this.onSvgDblClick,this),o.default.DomEvent.on(window,"resize",this._onWindowResize,this)},removeFrom:function(t){return this.abortLoading&&this.abortLoading(),this._map?(this._map._controlContainer.removeChild(this._container),t.removeLayer(this.polyline),t.removeLayer(this.trackMarker),t.removeLayer(this.polyLineSelection),o.default.DomEvent.off(window,"resize",this._onWindowResize,this),this._map=null,this):this},onSvgDragStart:function(t){0===t.dragButton&&(this.polyLineSelection.addTo(this._map).bringToBack(),this.selStartIndex=this.roundedSampleIndexFromMouseEvent(t))},graphContainerOffsetFromMouseEvent:function(t){t.originalEvent&&(t=t.originalEvent);var e=t.clientX-this.svg.getBoundingClientRect().left;return e<0&&(e=0),e>this.svgWidth-1&&(e=this.svgWidth-1),e},sampleIndexFromMouseEvent:function(t){return this.graphContainerOffsetFromMouseEvent(t)/(this.svgWidth-1)*(this.values.length-1)},roundedSampleIndexFromMouseEvent:function(t){return Math.round(this.sampleIndexFromMouseEvent(t))},setTrackMarkerLabel:function(t){var e=this.trackMarker._icon;e&&(e.getElementsByClassName("elevation-profile-marker-label")[0].innerHTML=t)},setGraphSelection:function(t){this.selMinInd=Math.min(t,this.selStartIndex),this.selMaxInd=Math.max(t,this.selStartIndex),this.selMinInd<0&&(this.selMinInd=0),this.selMaxInd>this.values.length-1&&(this.selMaxInd=this.values.length-1),this.updateGraphSelection(),o.default.DomUtil.removeClass(this.graphSelection,"elevation-profile-cursor-hidden")},updateGraphSelection:function(){var t=this.selMinInd*(this.svgWidth-1)/(this.values.length-1),e=this.selMaxInd*(this.svgWidth-1)/(this.values.length-1);this.graphSelection.style.left=t+"px",this.graphSelection.style.width=e-t+"px"},onSvgDragEnd:function(t){if(0===t.dragButton){this.cursorShow(),this.setGraphSelection(this.roundedSampleIndexFromMouseEvent(t));var e=this.calcProfileStats(this.values.slice(this.selMinInd,this.selMaxInd+1));this.updatePropsDisplay(e),o.default.DomUtil.addClass(this.propsContainer,"elevation-profile-properties-selected")}2===t.dragButton&&(this.drawingContainer.scrollLeft-=t.dragMovement.x)},onSvgDrag:function(t){0===t.dragButton&&(this.setGraphSelection(this.roundedSampleIndexFromMouseEvent(t)),this.polyLineSelection.setLatLngs(this.samples.slice(this.selMinInd,this.selMaxInd+1))),2===t.dragButton&&(this.drawingContainer.scrollLeft-=t.dragMovement.x)},onSvgClick:function(t){var e=t.originalEvent.button;0===e&&(this.dragStart=null,o.default.DomUtil.addClass(this.graphSelection,"elevation-profile-cursor-hidden"),o.default.DomUtil.removeClass(this.propsContainer,"elevation-profile-properties-selected"),this._map.removeLayer(this.polyLineSelection),this.stats&&this.updatePropsDisplay(this.stats)),2===e&&this.setMapPositionAtIndex(this.roundedSampleIndexFromMouseEvent(t))},onSvgDblClick:function(t){this.setMapPositionAtIndex(this.roundedSampleIndexFromMouseEvent(t))},setMapPositionAtIndex:function(t){var e=this.samples[t];e&&this._map.panTo(e)},onSvgMouseWheel:function(t){var e=this.horizZoom;this.horizZoom+=o.default.DomEvent.getWheelDelta(t)>0?1:-1,this.horizZoom<1&&(this.horizZoom=1),this.horizZoom>10&&(this.horizZoom=10);var n=this.sampleIndexFromMouseEvent(t),r=this.drawingContainer.scrollLeft+this.graphContainerOffsetFromMouseEvent(t)*(this.horizZoom/e-1);r<0&&(r=0),this.svgWidth=this.drawingContainer.clientWidth*this.horizZoom,this.svg.setAttribute("width",this.svgWidth+"px"),this.setupGraph(),r>this.svgWidth-this.drawingContainer.clientWidth&&(r=this.svgWidth-this.drawingContainer.clientWidth),this.drawingContainer.scrollLeft=r,this.cursorHide(),this.setCursorPosition(n),this.cursorShow(),this.updateGraphSelection()},updateGraph:function(){this._map&&this.values&&(this.stats=this.calcProfileStats(this.values),this.updatePropsDisplay(this.stats),this.setupGraph())},updatePropsDisplay:function(t){var e;this._map&&((e=t.noData?{maxElev:"-",minElev:"-",startElev:"-",endElev:"-",change:"-",ascentAngleStr:"-",descentAngleStr:"-",ascent:"-",descent:"-",startApprox:"",endApprox:"",approx:"",incomplete:"No elevation data"}:{maxElev:Math.round(t.max),minElev:Math.round(t.min),startElev:Math.round(t.start),endElev:Math.round(t.end),change:Math.round(t.finalAscent),ascentAngleStr:isNaN(t.angleAvgAscent)?"-":o.default.Util.template("{avg} / {max}&deg;",{avg:t.angleAvgAscent,max:t.angleMaxAscent}),descentAngleStr:isNaN(t.angleAvgDescent)?"-":o.default.Util.template("{avg} / {max}&deg;",{avg:t.angleAvgDescent,max:t.angleMaxDescent}),ascent:Math.round(t.ascent),descent:Math.round(t.descent),dist:(t.distance/1e3).toFixed(1),startApprox:t.dataLostAtStart>.02?"~ ":"",endApprox:t.dataLostAtEnd>.02?"~ ":"",approx:t.dataLost>.02?"~ ":"",incomplete:t.dataLost>.02?"Some elevation data missing":""}).dist=(t.distance/1e3).toFixed(1),this.propsContainer.innerHTML="\n                <table>\n                <tr><td>Максимальная высота:</td><td>".concat(e.maxElev,"</td></tr>\n                <tr><td>Минимальная высота:</td><td>").concat(e.minElev,'</td></tr>\n                <tr class="start-group"><td>Высота в начале:</td><td>').concat(e.startApprox).concat(e.startElev,"</td></tr>\n                <tr><td>Высота в конце:</td><td>").concat(e.endApprox).concat(e.endElev,"</td></tr>\n                <tr><td>Разница:</td><td>").concat(e.startApprox||e.endApprox).concat(e.change,'</td></tr>\n                <tr class="start-group"><td>Сред. / Макс. наклон подъёма:</td><td>').concat(e.ascentAngleStr,"</td></tr>\n                <tr><td>Сред. / Макс. наклон спуска:</td><td>").concat(e.descentAngleStr,'</td></tr>\n                <tr class="start-group"><td>Набор высоты:</td><td>').concat(e.approx).concat(e.ascent,"</td></tr>\n                <tr><td>Сброс высоты:</td><td>").concat(e.approx).concat(e.descent,'</td></tr>\n                <tr class="start-group"><td>Дистанция:</td><td>').concat(e.dist,' km</td></tr>\n                <tr><td colspan="2" style="text-align: center">').concat(e.incomplete,"</td></tr>\n                </table>\n                "))},calcGridValues:function(t,e){var n,r,i,o,a,s,l=[3,4,5],u=[1,2,5,10,20,50,100,200,500,1e3,2e3,5e3,1e4],c=[],f=!1;for(n=0;n<u.length;n++){for(a=u[n],r=0;r<l.length;r++)if(o=l[r],s=Math.floor(t/a),Math.ceil(e/a)-s<o){f=!0;break}if(f)break}for(i=s;i<s+o;i++)c.push(i*a);return c},filterElevations:function(t,e){var n,r,i,o,a,s,l,u,c,f=t.slice(0);if(f.length<3)return f;for(var d=[[0,f.length-1]];d.length;){for(n=(i=d.pop())[0],r=i[1],o=f[n],a=(f[r]-f[n])/(r-n),s=null,l=null,u=n+1;u<r;u++)o+=a,null!==f[u]&&(null===(c=Math.abs(f[u]-o))||c>s)&&(s=c,l=u);s>e?r>n+2&&(d.push([n,l]),d.push([l,r])):f.splice(n+1,r-n-1)}return f},calcProfileStats:function(t){var e={distance:(t.length-1)*this.options.samplingInterval},n=t.filter((function(t){return null!==t}));if(0===n.length)return e.noData=!0,e;e.min=Math.min.apply(Math,f(n)),e.max=Math.max.apply(Math,f(n));for(var r,i,o=!0,a=!0,s=0;s<t.length;s++){var l=t[s];if(null!==l){r=l,o=s;break}}for(var u=t.length-1;u>=0;u--){var c=t[u];if(null!==c){i=c,a=u;break}}e.finalAscent=i-r;for(var d=[],h=[],m=t[o],v=o,y=o+1;y<=a;y++){var g=t[y];if(null!==g){var b=y-v,w=(g-m)/b;if(w>0)for(var k=0;k<b;k++)d.push(w);else if(w<0)for(var _=0;_<b;_++)h.push(-w);v=y,m=g}}function S(t,e){return t+e}0!==d.length&&(e.gradientAvgAscent=d.reduce(S,0)/d.length/this.options.samplingInterval,e.gradientMinAscent=Math.min.apply(Math,d)/this.options.samplingInterval,e.gradientMaxAscent=Math.max.apply(Math,d)/this.options.samplingInterval,e.angleAvgAscent=p(e.gradientAvgAscent),e.angleMinAscent=p(e.gradientMinAscent),e.angleMaxAscent=p(e.gradientMaxAscent)),0!==h.length&&(e.gradientAvgDescent=h.reduce(S,0)/h.length/this.options.samplingInterval,e.gradientMinDescent=Math.min.apply(Math,h)/this.options.samplingInterval,e.gradientMaxDescent=Math.max.apply(Math,h)/this.options.samplingInterval,e.angleAvgDescent=p(e.gradientAvgDescent),e.angleMinDescent=p(e.gradientMinDescent),e.angleMaxDescent=p(e.gradientMaxDescent)),e.start=r,e.end=i,e.distance=(t.length-1)*this.options.samplingInterval,e.dataLostAtStart=o/t.length,e.dataLostAtEnd=1-a/(t.length-1),e.dataLost=1-n.length/t.length;for(var x,O=this.filterElevations(t.slice(o,a),5),P=0,L=0,C=1;C<O.length;C++)(x=O[C]-O[C-1])<0?L+=-x:P+=x;return e.ascent=P,e.descent=L,e},setCursorPosition:function(t){if(this._map&&this.values){var e,n=this.options.samplingInterval,r="".concat((n*t/1e3).toFixed(2)," km"),i=this.values[Math.ceil(t)],a=this.values[Math.floor(t)];if(null!==i&&null!==a){var s=(a-i)/n;e="".concat(Math.round(180*Math.atan(s)/Math.PI),"&deg")}else e="-";var l=Math.round(t/(this.values.length-1)*(this.svgWidth-1)),u=Math.round(t),c=this.values[u];null===c&&(c=i),null===c&&(c=a);var f,d=null===c?"-":"".concat(c," m"),h="".concat(d,"<br>").concat(r,"<br>").concat(e);if(this.graphCursorLabel.innerHTML=h,this.graphCursor.style.left=l+"px",this.graphCursorLabel.style.left=l+"px",this.drawingContainer.getBoundingClientRect().left-this.drawingContainer.scrollLeft+l+this.graphCursorLabel.offsetWidth>=this.drawingContainer.getBoundingClientRect().right?o.default.DomUtil.addClass(this.graphCursorLabel,"elevation-profile-cursor-label-left"):o.default.DomUtil.removeClass(this.graphCursorLabel,"elevation-profile-cursor-label-left"),t<=0)f=this.samples[0];else if(t>=this.samples.length-1)f=this.samples[this.samples.length-1];else{var p=this.samples[Math.floor(t)],m=this.samples[Math.ceil(t)],v=t-Math.floor(t);f=[p.lat+(m.lat-p.lat)*v,p.lng+(m.lng-p.lng)*v]}this.trackMarker.setLatLng(f),this.setTrackMarkerLabel(h)}},onSvgMouseMove:function(t){this.values&&this.setCursorPosition(this.sampleIndexFromMouseEvent(t))},cursorShow:function(){o.default.DomUtil.removeClass(this.graphCursor,"elevation-profile-cursor-hidden"),o.default.DomUtil.removeClass(this.graphCursorLabel,"elevation-profile-cursor-hidden"),this._map.addLayer(this.trackMarker)},cursorHide:function(){o.default.DomUtil.addClass(this.graphCursor,"elevation-profile-cursor-hidden"),o.default.DomUtil.addClass(this.graphCursorLabel,"elevation-profile-cursor-hidden"),this._map.removeLayer(this.trackMarker)},onSvgEnter:function(){this.cursorShow()},onSvgLeave:function(){this.cursorHide()},onLineMouseEnter:function(){this.cursorShow()},onLineMouseLeave:function(){this.cursorHide()},onLineMouseMove:function(t){function e(t,e){var n=t.lng-e.lng,r=t.lat-e.lat;return n*n+r*r}var n,r,i,o,a,s,l,u,c=null,f=null,d=t.latlng;for(r=0;r<this.samples.length;r++)i=e(this.samples[r],d),(null===c||i<f)&&(c=r,f=i);null!==c&&(n=c,c>0&&(l=e(d,this.samples[c-1]),u=e(this.samples[c],this.samples[c-1])),c<this.samples.length-1&&(a=e(d,this.samples[c+1]),s=e(this.samples[c],this.samples[c+1])),(o=0===c?a<f+s?(f-a)/2/s+.5:.001:c===this.samples.length-1?l<f+u?-((f-l)/2/u+.5):-.001:l<a?-((f-l)/2/u+.5):(f-a)/2/s+.5)<-1&&(o=-1),o>1&&(o=1),this.setCursorPosition(n+o))},setupGraph:function(){var t=this;if(this._map&&this.values){for(;this.svg.hasChildNodes();)this.svg.removeChild(this.svg.lastChild);for(;this.leftAxisLables.hasChildNodes();)this.leftAxisLables.removeChild(this.leftAxisLables.lastChild);var e,n,r,i,a,s,l,u,c=Math.max.apply(null,this.values),f=Math.min.apply(null,this.values),d=this.svg;l=this.calcGridValues(f,c);var p=(this.svgHeight-24-8)/(l.length-1);for(n=0;n<l.length;n++)s=Math.round(n*p-.5)+.5+8,h("path",{d:e=o.default.Util.template("M{x1} {y} L{x2} {y}",{x1:0,x2:this.svgWidth*this.horizZoom,y:s}),"stroke-width":"1px",stroke:"green",fill:"none","stroke-opacity":"0.5"},d),(u=o.default.DomUtil.create("div","elevation-profile-grid-label",this.leftAxisLables)).innerHTML=l[l.length-n-1],u.style.top=p*n+8+"px";r=this.svgWidth/(this.values.length-1),i=(this.svgHeight-8-24)/(l[l.length-1]-l[0]),e=[];var m=function(e){var n=(e-l[0])*i;return t.svgHeight-n-24},v=!0;for(n=0;n<this.values.length;n++){var y=this.values[n];null!==y?(e.push(v?"M":"L"),a=n*r,s=m(y),e.push(a+" "+s+" "),v=!1):v=!0}h("path",{d:e=e.join(""),"stroke-width":"1px",stroke:"brown",fill:"none"},d),this.options.sightLine&&h("path",{d:e=o.default.Util.template("M{x1} {y1} L{x2} {y2}",{x1:0,x2:this.svgWidth*this.horizZoom,y1:m(this.values[0]),y2:m(this.values[this.values.length-1])}),"stroke-width":"3px",stroke:"#94b1ff",fill:"none","stroke-opacity":"0.5"},d)}},onCloseButtonClick:function(){this.removeFrom(this._map)}});e.ElevationProfile=m},function(t,e,n){"use strict";n(7),n(10),n(11),n(16),n(15),n(13),n(1),n(31),n(18),n(8),n(2),n(6),n(50),n(19),n(0),n(54),n(20),n(14),n(4),n(5),n(41),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.ElevationProvider=void 0,n(30);var r,i=(r=n(111))&&r.__esModule?r:{default:r},o=n(67);function a(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function l(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.default.elevationsServer;u(this,t),f(this,"chunkSize",1e4),this.url=e}var e,n,r,s,d;return e=t,(n=[{key:"get",value:(s=regeneratorRuntime.mark((function t(e){var n,r,i,s,l,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=[],r=0;case 2:if(!(r<e.length)){t.next=13;break}return i=e.slice(r,r+this.chunkSize),s=i.map((function(t){return"".concat(t.lat.toFixed(6)," ").concat(t.lng.toFixed(6))})).join("\n"),t.next=7,(0,o.fetch)(this.url,{method:"POST",data:s,withCredentials:!1});case 7:l=t.sent,u=l.responseText.split("\n").map((function(t){return"NULL"===t?null:parseFloat(t)})),n.push.apply(n,a(u));case 10:r+=this.chunkSize,t.next=2;break;case 13:return t.abrupt("return",n);case 14:case"end":return t.stop()}}),t,this)})),d=function(){var t=this,e=arguments;return new Promise((function(n,r){var i=s.apply(t,e);function o(t){l(i,n,r,o,a,"next",t)}function a(t){l(i,n,r,o,a,"throw",t)}o(void 0)}))},function(t){return d.apply(this,arguments)})}])&&c(e.prototype,n),r&&c(e,r),t}();e.ElevationProvider=d},function(t,e,n){"use strict";n(25),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n(9))&&r.__esModule?r:{default:r};n(484);var o=function(t){var e=t.onAdd;t._topRowEnabled||(i.default.Util.extend(t,{_topRowEnabled:!0,onAdd:function(t){var n=this,r=e.call(this,t);return setTimeout((function(){return n.__injectTopRow()}),0),r},__injectTopRow:function(){this._topRow=i.default.DomUtil.create("div","leaflet-control-layers-top-row"),this._section.parentNode.insertBefore(this._topRow,this._section)}}),t._map&&t.__injectTopRow())};e.default=o},,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n(7),n(10),n(11),n(15),n(13),n(1),n(31),n(18),n(105),n(8),n(2),n(6),n(0),n(14),n(4),n(5),n(52),n(3);var i=c(n(242));n(366);var o,a,s=c(n(367)),l=(o=n(111))&&o.__esModule?o:{default:o};function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}function c(t){if(t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var a=i?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=t[o]}return n.default=t,e&&e.set(t,n),n}function f(t){return function(t){if(Array.isArray(t))return d(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function h(t){var e=document.createElement("link");e.rel="preconnect",e.href=t,document.head.appendChild(e);var n=document.createElement("link");n.rel="dns-prefetch",n.href=t,document.head.appendChild(n)}h(l.default.elevationsServer),h(l.default.CORSProxyUrl),h(l.default.tracksStorageServer),i.init({dsn:l.default.sentryDSN,release:"2021-01-11_11:07:25-master-89fb69c"}),console.log("Version:","2021-01-11_11:07:25-master-89fb69c");try{a=function(){for(var t=document.cookie.match(/\buid=((?:(?!;)[\s\S])+)/)[1],e=atob(t),n=[],r=0;r<e.length;r++)n.push(e.charCodeAt(r));var i=[];return i.push.apply(i,f(n.slice(0,4).reverse())),i.push.apply(i,f(n.slice(4,8).reverse())),i.push.apply(i,f(n.slice(8,12).reverse())),i.push.apply(i,f(n.slice(12).reverse())),i.map((function(t){return("0"+t.toString(16)).slice(-2)})).join("").toUpperCase()}()}catch(t){}console.log("UID:",a),i.configureScope((function(t){t.setUser({id:a})})),s.setUp()},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n(7),n(10),n(11),n(15),n(13),n(1),n(18),n(8),n(2),n(24),n(6),n(34),n(0),n(14),n(4),n(5),n(41),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.setUp=function(){var t={href:window.location.href,localStorageKeys:Object.keys(g.default),mobile:i.default.Browser.mobile};(0,l.fixAll)();var e=new o.MapWithSidebars("map",{zoomControl:!1,fadeAnimation:!1,attributionControl:!1,inertiaMaxSpeed:1500,worldCopyJump:!0,maxZoom:18}),n=new i.default.Control.TrackList;new i.default.Control.Caption(a.default.caption,{position:"bottomleft"}).addTo(e),(new v.default).addTo(e),e.getPlacemarkHashStateInterface().enableHashState("r"),new i.default.Control.Coordinates({position:"topleft"}).addTo(e);var r=new p.LocateControl({position:"topleft",showError:function(t){var e=t.code,n=t.message,r=S[e];r||(r="Geolocation error: ".concat(n)),(0,m.notify)(r)}}).addTo(e),b=h.hashState.getState("m");void 0===b&&(b=g.default.getItem("state-m"));"string"==typeof b&&(b=b.split(","));var w=e.validateState(b),_=w.lat,x=w.lng,O=w.zoom,P=w.valid;r.moveMapToCurrentLocation(a.default.defaultZoom,i.default.latLng(a.default.defaultLocation),P?i.default.latLng(_,x):null,P?O:null),e.enableHashState("m");(new i.default.Control.Panoramas).addTo(e);var L=i.default.control.layers(null,null,{collapsed:!1}).addTo(e);(0,s.default)(L),(0,u.default)(L),(0,c.default)(L,(0,d.getLayers)());var C=h.hashState.getState("l");void 0===C&&"string"==typeof(C=g.default.getItem("state-l"))&&(C=C.split(","),h.hashState.updateState("l",C));L.enableHashState("l");var M=i.default.control.attribution({position:"bottomleft",prefix:!1});e.on("resize",(function(){if(e.getSize().y>567){e.addControl(M);var t=M._container;t.parentElement.appendChild(t)}else e.removeControl(M)})),e.getSize().y>567&&e.addControl(M);function j(){return n.tracks().map((function(t){return t.name()}))}n.addTo(e);var T,D=n.hashParams(),q=!1,E=k(D);try{for(E.s();!(T=E.n()).done;){var I=T.value;if(h.hashState.hasKey(I)){q=!0;break}}}catch(t){E.e(t)}finally{E.f()}q||n.loadTracksFromStorage();t.tracksAfterLoadFromStorage=j();var A,R=k(D);try{for(R.s();!(A=R.n()).done;){var F=A.value;(0,h.bindHashStateReadOnly)(F,n.loadTrackFromParam.bind(n,F))}}catch(t){R.e(t)}finally{R.f()}t.tracksAfterLoadFromHash=j(),P||n.whenLoadDone((function(){return n.setViewToAllTracks(!0)}));i.default.Browser.mobile&&(L.setMinimized(),n.hasTracks()||n.setMinimized());i.default.Browser.mobile&&e.on("mousedown dragstart",(function(){return L.setMinimized()}));(0,f.default)(e),i.default.DomEvent.on(window,"beforeunload",(function(){y.logEvent("saveTracksToStorage begin",{localStorageKeys:Object.keys(g.default),trackNames:j()});try{n.saveTracksToStorage(),g.default.setItem("state-m",h.hashState.getState("m")),g.default.setItem("state-l",h.hashState.getState("l")),Object.keys(g.default)}catch(t){return void y.logEvent("saveTracksToStorage failed",{error:t})}}))},n(368),n(369);var i=w(n(9));n(372);var o=n(373);n(375),n(416);var a=w(n(111));n(418);var s=w(n(423));n(425),n(426);var l=n(427);n(429),n(430),n(173),n(478),n(480),n(481);var u=w(n(482)),c=w(n(485)),f=w(n(488)),d=n(490);n(497),n(498),n(504),n(505);var h=n(214),p=n(512),m=n(103),v=w(n(514)),y=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var e=b();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var a=i?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=t[o]}n.default=t,e&&e.set(t,n);return n}(n(97)),g=w(n(149));function b(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return b=function(){return t},t}function w(t){return t&&t.__esModule?t:{default:t}}function k(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n(516);var S={0:"Ваш браузер не поддерживает геолокацию.",1:"Геолокация для этого сайта заблокирована. Пожалуйста, включите в настройках браузера.",2:"Не удалось получить позицию по неизвестной причине."}},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";n.r(e)},,,,function(t,e,n){"use strict";n(24),Object.defineProperty(e,"__esModule",{value:!0}),e.MapWithSidebars=void 0;var r,i=(r=n(9))&&r.__esModule?r:{default:r};n(374);var o=n(268);var a=i.default.Map.extend({initialize:function(t,e){this._sidebarsContainer=i.default.DomUtil.get(t),this.setupSidebarsLayout(this._sidebarsContainer),i.default.Map.prototype.initialize.call(this,this._mapContainer,e),(0,o.onElementResize)(this._mapContainer,i.default.Util.requestAnimFrame.bind(null,this.invalidateSize.bind(this)))},setupSidebarsLayout:function(t){this._sidebarContainers={};var e=this._sidebarContainers;i.default.DomUtil.addClass(t,"leaflet-map-sidebars-container"),e.left=i.default.DomUtil.create("div","leaflet-map-sidebar-left",this._sidebarsContainer);var n=i.default.DomUtil.create("div","leaflet-map-sidebar-mid-column",this._sidebarsContainer);e.right=i.default.DomUtil.create("div","leaflet-map-sidebar-right",this._sidebarsContainer),e.top=i.default.DomUtil.create("div","leaflet-map-sidebar-top",n),this._mapContainer=i.default.DomUtil.create("div","leaflet-map-container-with-sidebars",n),e.bottom=i.default.DomUtil.create("div","leaflet-map-sidebar-bottom",n)},addElementToSidebar:function(t,e){this._sidebarContainers[t].appendChild(e)},removeElementFromSidebar:function(t,e){this._sidebarContainers[t].removeChild(e)}});e.MapWithSidebars=a},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n(7),n(10),n(11),n(16),n(305),n(22),n(15),n(45),n(13),n(1),n(18),n(8),n(57),n(2),n(24),n(6),n(50),n(0),n(54),n(53),n(4),n(5),n(23),n(3);var i=b(n(9)),o=b(n(121));n(269),n(122),n(378);var a=b(n(379)),s=b(n(147)),l=n(385),u=b(n(409)),c=n(103),f=n(410),d=n(171),h=n(112);n(128),n(68);var p=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var e=g();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var a=i?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=t[o]}n.default=t,e&&e.set(t,n);return n}(n(97)),m=n(412),v=n(414),y=n(415);function g(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return g=function(){return t},t}function b(t){return t&&t.__esModule?t:{default:t}}function w(t){return function(t){if(Array.isArray(t))return x(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||S(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=S(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function _(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||S(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(t,e){if(t){if("string"==typeof t)return x(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(t,e):void 0}}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}o.default.extenders.checkNumberRange=function(t,e){return o.default.pureComputed({read:t,write:function(n){(n=parseFloat(n))>=e[0]&&n<=e[1]?t(n):t.notifySubscribers(t())}}).extend({notify:"always"})},i.default.Control.PrintPages=i.default.Control.extend({options:{position:"bottomleft",defaultMargin:7},includes:[i.default.Evented,i.default.Mixin.HashState],stateChangeEvents:["change"],pageSizes:[{name:"A1",width:594,height:841},{name:"A2",width:420,height:594},{name:"A3",width:297,height:420},{name:"A4",width:210,height:297},{name:"A5",width:148,height:210}],zoomLevels:["auto",7,8,9,10,11,12,13,14,15,16,17,18],initialize:function(t){i.default.Control.prototype.initialize.call(this,t),this.pages=[],this.scale=o.default.observable(500).extend({checkNumberRange:[1,1e6]}),this.resolution=o.default.observable(300).extend({checkNumberRange:[10,9999]}),this.zoomLevel=o.default.observable("auto"),this.pageWidth=o.default.observable(210).extend({checkNumberRange:[10,9999]}),this.pageHeight=o.default.observable(297).extend({checkNumberRange:[10,9999]}),this.settingsExpanded=o.default.observable(!1),this.makingPdf=o.default.observable(!1),this.downloadProgressRange=o.default.observable(),this.downloadProgressDone=o.default.observable(),this.marginLeft=o.default.observable(this.options.defaultMargin).extend({checkNumberRange:[0,99]}),this.marginRight=o.default.observable(this.options.defaultMargin).extend({checkNumberRange:[0,99]}),this.marginTop=o.default.observable(this.options.defaultMargin).extend({checkNumberRange:[0,99]}),this.marginBottom=o.default.observable(this.options.defaultMargin).extend({checkNumberRange:[0,99]}),this.autoZoomLevels=o.default.observable({}),this.printSize=o.default.pureComputed(this._printSize,this),this.printSize.subscribe(this.onPageSizeChanged,this),this.scale.subscribe(this.onPageSizeChanged,this),this.resolution.subscribe(this.onPageSizeChanged,this),this.pageSizeDescription=o.default.pureComputed(this._displayPageSize,this),this.pagesNum=o.default.observable(0),this.pagesNumLabel=o.default.pureComputed(this._pagesNumLabel,this),this.gridOn=o.default.observable(!1),this.magneticMeridiansOn=o.default.observable(!1),this.scale.subscribe(this.notifyChange,this),this.printSize.subscribe(this.notifyChange,this),this.resolution.subscribe(this.notifyChange,this),this.zoomLevel.subscribe(this.notifyChange,this),this.gridOn.subscribe(this.notifyChange,this),this.magneticMeridiansOn.subscribe(this.notifyChange,this)},onAdd:function(t){this._map=t;var e=this._container=i.default.DomUtil.create("div","leaflet-control control-form control-print-pages");return this._stopContainerEvents(),t.on("move",this.updateFormZooms,this),e.innerHTML=u.default,o.default.applyBindings(this,e),this.updateFormZooms(),e},setExpanded:function(){i.default.DomUtil.removeClass(this._container,"minimized")},setMinimized:function(){i.default.DomUtil.addClass(this._container,"minimized")},addPage:function(t,e){var n=_(this.printSize(),2),r=n[0],i=n[1];if(t){var o=[i,r];r=o[0],i=o[1]}e||(e=this._map.getCenter());var l=new a.default(e,[r,i],this.scale(),(this.pages.length+1).toString());l._rotated=t,l.addTo(this._map),this.pages.push(l),this.pagesNum(this.pages.length);var u=new s.default(this.makePageContexmenuItems.bind(this,l));return l.on("contextmenu",u.show,u),l.on("click",this.rotatePage.bind(this,l)),l.on("move",this.updateFormZooms,this),l.on("moveend",this.notifyChange,this),this.updateFormZooms(),this.notifyChange(),l},addLandscapePage:function(){this.addPage(!0)},addPortraitPage:function(){this.addPage(!1)},removePage:function(t){var e=this.pages.indexOf(t);for(this.pages.splice(e,1),this.pagesNum(this.pages.length),this._map.removeLayer(t);e<this.pages.length;e++)this.pages[e].setLabel((e+1).toString());this.notifyChange(),this.updateFormZooms()},removePages:function(){var t=this;this.pages.forEach((function(e){return e.removeFrom(t._map)})),this.pages=[],this.pagesNum(this.pages.length),this.notifyChange(),this.updateFormZooms()},onSavePdfClicked:function(){this.pages.length?this.savePdf():(0,c.notify)("Add some pages to print")},zoomForPrint:function(){var t=this.zoomLevel();return t="auto"===t?this.suggestZooms():{mapZoom:t,satZoom:t}},incrementProgress:function(t,e){this.downloadProgressRange(e),this.downloadProgressDone((this.downloadProgressDone()||0)+t)},savePdf:function(){var t=this;if(p.captureBreadcrumb("start save pdf"),this._map){this.downloadProgressRange(1e3),this.downloadProgressDone(void 0),this.makingPdf(!0);var e=this.pages.map((function(t){return{latLngBounds:t.getLatLngBounds(),printSize:t.getPrintSize(),label:t.getLabel()}})),n=this.resolution(),r=[];this.gridOn()&&r.push(new y.Grid),this.magneticMeridiansOn()&&r.push(new m.MagneticMeridians),r.push(new v.OverlayScale);var i=this.scale(),o=this.pageWidth(),a=this.pageHeight(),s=p.randId(),u=this.zoomForPrint();this.fire("mapRenderStart",{action:"pdf",eventId:s,scale:i,resolution:n,pages:e,zooms:u}),(0,l.renderPages)({map:this._map,pages:e,zooms:u,resolution:n,scale:i,decorationLayers:r,progressCallback:this.incrementProgress.bind(this)}).then((function(e){var r=e.images,l=e.renderedLayers;if(r){var u=t.getFileName({renderedLayers:l,scale:i,width:o,height:a,extension:"pdf"});!function(t,e,n){var r=(0,f.makePdf)(t,e);r=(0,h.blobFromString)(r),(0,d.saveAs)(r,n,!0)}(r,n,u),t.fire("mapRenderEnd",{eventId:s,success:!0})}})).catch((function(e){p.captureException(e,"raster creation failed"),t.fire("mapRenderEnd",{eventId:s,success:!1,error:e}),(0,c.notify)("Failed to create PDF: ".concat(e.message))})).then((function(){return t.makingPdf(!1)}))}},savePageJpg:function(t){var e=this;p.captureBreadcrumb("start save page jpg",{pageNumber:t.getLabel()});var n=[{latLngBounds:t.getLatLngBounds(),printSize:t.getPrintSize(),label:t.getLabel()}],r=[];this.gridOn()&&r.push(new y.Grid),this.magneticMeridiansOn()&&r.push(new m.MagneticMeridians),r.push(new v.OverlayScale),this.downloadProgressRange(1e3),this.downloadProgressDone(void 0),this.makingPdf(!0);var i=this.resolution(),o=this.scale(),a=this.pageWidth(),s=this.pageHeight(),u=p.randId(),f=this.zoomForPrint();this.fire("mapRenderStart",{action:"jpg",eventId:u,scale:o,resolution:i,pages:n,zooms:f}),(0,l.renderPages)({map:this._map,pages:n,zooms:f,resolution:i,scale:o,decorationLayers:r,progressCallback:this.incrementProgress.bind(this)}).then((function(t){var n=t.images,r=t.renderedLayers,i=e.getFileName({renderedLayers:r,scale:o,width:a,height:s,extension:"jpg"});!function(t,e){(0,d.saveAs)((0,h.blobFromString)(t.data),e,!0)}(n[0],i),e.fire("mapRenderEnd",{eventId:u,success:!0})})).catch((function(t){p.captureException(t,"raster creation failed"),e.fire("mapRenderEnd",{eventId:u,success:!1,error:t}),(0,c.notify)("Failed to create JPEG from page: ".concat(t.message))})).then((function(){return e.makingPdf(!1)}))},onPageSizeChanged:function(){var t=this,e=_(this.printSize(),2),n=e[0],r=e[1];this.pages.forEach((function(e){var i=n,o=r;if(e._rotated){var a=[o,i];i=a[0],o=a[1]}e.setSize([i,o],t.scale())})),this.updateFormZooms()},onPagesNumLabelClick:function(){if(this.pages.length>0){var t,e=i.default.latLngBounds([]),n=k(this.pages);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.extend(r.latLngBounds)}}catch(t){n.e(t)}finally{n.f()}this._map.fitBounds(e.pad(.2))}},makePageContexmenuItems:function(t){var e=this,n=[{text:"Rotate",callback:this.rotatePage.bind(this,t)},"-",{text:"Delete",callback:this.removePage.bind(this,t)},"-",{text:"Save image",callback:this.savePageJpg.bind(this,t),disabled:this.makingPdf()}];return this.pages.length>1&&(n.push({text:"Change order",separator:!0}),this.pages.forEach((function(r,i){r!==t&&n.push({text:(i+1).toString(),callback:e.renumberPage.bind(e,t,i)})}))),n},rotatePage:function(t){t._rotated=!t._rotated,t.rotate(),this.notifyChange()},renumberPage:function(t,e){var n=this.pages.indexOf(t);this.pages.splice(n,1),this.pages.splice(e,0,t);for(var r=Math.min(n,e);r<this.pages.length;r++)this.pages[r].setLabel((r+1).toString());this.notifyChange()},_printSize:function(){return[this.pageWidth()-this.marginLeft()-this.marginRight(),this.pageHeight()-this.marginTop()-this.marginBottom()]},suggestZooms:function(){var t,e=this.scale(),n=this.resolution();if(this.pages.length>0){var r=this.pages.map((function(t){return Math.abs(t.getLatLngBounds().getCenter().lat)}));t=Math.min.apply(Math,w(r))}else{if(!this._map)return[null,null];t=this._map.getCenter().lat}var i=e/(n/2.54),o=i/Math.cos(t*Math.PI/180),a=Math.ceil(Math.log(156543.0328125/o)/Math.LN2);o=(i=e/(90/2.54)/1.5)/Math.cos(t*Math.PI/180);var s=Math.round(Math.log(156543.0328125/o)/Math.LN2);return s=Math.min(s,18),a=Math.min(a,18),{mapZoom:s=Math.max(s,0),satZoom:a=Math.max(a,0)}},updateFormZooms:function(){this.autoZoomLevels(this.suggestZooms())},_displayPageSize:function(){var t,e=this.pageWidth(),n=this.pageHeight(),r=k(this.pageSizes);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i.width===e&&i.height===n)return i.name}}catch(t){r.e(t)}finally{r.f()}return"".concat(e," x ").concat(n," mm")},notifyChange:function(){this.fire("change")},hasPages:function(){return this.pages.length>0},_pagesNumLabel:function(){var t=this.pagesNum(),e="";return t?e+=t:e="No",e+=" page",(0===t||t>1)&&(e+="s"),e},serializeState:function(){var t=this.pages,e=null;if(t.length){(e=[]).push(this.scale().toString()),e.push(this.resolution().toString()),e.push(this.zoomLevel().toString()),e.push(this.pageWidth().toString()),e.push(this.pageHeight().toString()),e.push(this.marginLeft().toString()),e.push(this.marginRight().toString()),e.push(this.marginTop().toString()),e.push(this.marginBottom().toString());var n,r=k(t);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=i.getLatLng().wrap();e.push(o.lat.toFixed(5)),e.push(o.lng.toFixed(5)),e.push(i._rotated?"1":"0")}}catch(t){r.e(t)}finally{r.f()}var a=(this.magneticMeridiansOn()?1:0)|(this.gridOn()?2:0);e.push(a.toString())}return e},unserializeState:function(t){if(!t||!t.length)return!1;var e,n,r;for(this.removePages(),t=w(t),this.scale(t.shift()),this.resolution(t.shift()),this.zoomLevel(t.shift()),this.pageWidth(t.shift()),this.pageHeight(t.shift()),this.marginLeft(t.shift()),this.marginRight(t.shift()),this.marginTop(t.shift()),this.marginBottom(t.shift());t.length>=3&&(e=parseFloat(t.shift()),n=parseFloat(t.shift()),r=parseInt(t.shift(),10),!(isNaN(e)||isNaN(n)||e<-85||e>85||n<-180||n>180));)this.addPage(Boolean(r),i.default.latLng(e,n));if(t.length){var o=parseInt(t.shift(),10);o>=0&&o<=3&&(this.magneticMeridiansOn(Boolean(1&o)),this.gridOn(Boolean(2&o)))}return!0},getFileName:function(t){var e,n=t.renderedLayers,r=t.scale,i=t.width,o=t.height,a=t.extension,s="",l=[];function u(t){s+="".concat(t.options.shortName,"_")}n.forEach((function(t){var n=t.options,r=n.isOverlay,i=n.isOverlayTransparent;n.shortName&&(r?i?l.push(t):e=t:e||(e=t))})),e&&u(e),l.forEach(u),s+="".concat(r,"m");var c=this.pageSizes.find((function(t){return i===t.width&&o===t.height}));return c&&(s+="_".concat(c.name)),"".concat(s,".").concat(a)}})},,function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";n(7),n(10),n(11),n(15),n(13),n(1),n(8),n(2),n(24),n(6),n(0),n(4),n(5),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n(9))&&r.__esModule?r:{default:r};function o(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n(380);var s=i.default.Marker.extend({initialize:function(t,e,n,r){this.paperSize=e,this.scale=n;var o=i.default.divIcon({className:"print-page-marker",html:r});i.default.Marker.prototype.initialize.call(this,t,{icon:o,draggable:!0,title:"Left click to rotate, right click for menu"}),this.on("drag",this.updateView.bind(this,void 0))},onAdd:function(t){var e=this;i.default.Marker.prototype.onAdd.call(this,t),t.on("viewreset",(function(){return e.updateView()})),this.rectangle=i.default.rectangle([[0,0],[0,0]],{color:"#ff7800",weight:2,opacity:.7,fillOpacity:.2}).addTo(t),this.updateView()},onRemove:function(t){t.off("viewreset",this.updateView,this),i.default.Marker.prototype.onRemove.call(this,t),this.rectangle.removeFrom(t)},getLatLngBounds:function(){return this.latLngBounds},_getLatLngBounds:function(){var t=this.getLatLng(),e=i.default.Projection.SphericalMercator.project(t),n=Math.cos(t.lat*Math.PI/180)*i.default.CRS.Earth.R/i.default.Projection.SphericalMercator.R,r=i.default.point.apply(i.default,o(this.paperSize)).multiplyBy(this.scale/10/n),a=e.subtract(r.divideBy(2)),s=e.add(r.divideBy(2));return a=i.default.Projection.SphericalMercator.unproject(a),s=i.default.Projection.SphericalMercator.unproject(s),i.default.latLngBounds([a,s])},_animateZoom:function(t){i.default.Marker.prototype._animateZoom.call(this,t),this.updateView(t.zoom)},updateView:function(t){if(this._map){void 0===t&&(t=this._map.getZoom());var e=this.latLngBounds=this._getLatLngBounds(),n=this._map.project(e.getSouthWest(),t),r=this._map.project(e.getNorthEast(),t),i=this._map.project(this.getLatLng(),t),o=this._icon.style,a=r.x-n.x,s=n.y-r.y;o.width="".concat(a,"px"),o.height="".concat(s,"px"),o.marginLeft="".concat(n.x-i.x,"px"),o.marginTop="".concat(r.y-i.y,"px"),o.fontSize="".concat(Math.min(a,s,500)/2,"px"),o.lineHeight="".concat(s,"px"),this.rectangle.setBounds(e)}},setLabel:function(t){this._icon.innerHTML=t},getLabel:function(){return this._icon.innerHTML},setSize:function(t,e){this.paperSize=t,this.scale=e,this.updateView()},getPrintSize:function(){return i.default.point.apply(i.default,o(this.paperSize))},rotate:function(){this.paperSize=[this.paperSize[1],this.paperSize[0]],this.updateView()}});e.default=s},function(t,e,n){"use strict";n.r(e)},,,,function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";n(7),n(10),n(198),n(11),n(46),n(22),n(15),n(45),n(13),n(1),n(18),n(105),n(8),n(98),n(2),n(6),n(62),n(19),n(59),n(96),n(34),n(0),n(53),n(20),n(4),n(306),n(5),n(23),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.renderPages=function(t){return L.apply(this,arguments)},n(30);var r,i=(r=n(9))&&r.__esModule?r:{default:r},o=n(271),a=n(67);function s(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||p(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}function u(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){l(o,r,i,a,s,"next",t)}function s(t){l(o,r,i,a,s,"throw",t)}a(void 0)}))}}function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){d(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=p(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function p(t,e){if(t){if("string"==typeof t)return m(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(t,e):void 0}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function y(t){return new w(t)}function g(t){return function(){return new b(t.apply(this,arguments))}}function b(t){var e,n;function r(e,n){try{var o=t[e](n),a=o.value,s=a instanceof w;Promise.resolve(s?a.wrapped:a).then((function(t){s?r("return"===e?"return":"next",t):i(o.done?"return":"normal",t)}),(function(t){r("throw",t)}))}catch(t){i("throw",t)}}function i(t,i){switch(t){case"return":e.resolve({value:i,done:!0});break;case"throw":e.reject(i);break;default:e.resolve({value:i,done:!1})}(e=e.next)?r(e.key,e.arg):n=null}this._invoke=function(t,i){return new Promise((function(o,a){var s={key:t,arg:i,resolve:o,reject:a,next:null};n?n=n.next=s:(e=n=s,r(t,i))}))},"function"!=typeof t.return&&(this.return=void 0)}function w(t){this.wrapped=t}function k(t,e){function n(t){return parseInt(window.getComputedStyle(t).zIndex,10)||0}function r(t,e){return t<e?-1:t>e?1:0}function i(t){var e=t._container||t._path;if(!e)throw new TypeError("Unsupported layer type");for(var r=[];e!==t._map._container;)r.push(n(e)),e=e.parentNode;return r.reverse()}var o=[];return t.eachLayer((function(t){if(t.options.print)o.push(t);else if(t.meta&&!1===t.options.isOverlay)throw new Error("Print disabled for layer ".concat(t.meta.title))})),o.sort((function(t,e){return function(t,e){for(var n=Math.min(t.length,e.length),i=0;i<n;i++){var o=r(t[i],e[i]);if(o)return o}return r(t.length,e.length)}(i(t),i(e))})),o=o.map((function(t){return t.cloneForPrint({xhrQueue:e})}))}"function"==typeof Symbol&&Symbol.asyncIterator&&(b.prototype[Symbol.asyncIterator]=function(){return this}),b.prototype.next=function(t){return this._invoke("next",t)},b.prototype.throw=function(t){return this._invoke("throw",t)},b.prototype.return=function(t){return this._invoke("return",t)};var _=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.destSize=e,this.projectedBounds=n,this.currentCanvas=null,this.currentZoom=null,this.currentTileScale=null,this.targetCanvas=this.createCanvas(e)}var e,n,r;return e=t,(n=[{key:"createCanvas",value:function(t){var e=i.default.DomUtil.create("canvas");return e.width=t.x,e.height=t.y,e}},{key:"putTile",value:function(t){var e;if(t.isOverlay||t.image)if((e=t.isOverlay?t.overlaySolid?"solidOverlay":"overlay":t.zoom)===this.currentZoom&&t.tileScale===this.currentTileScale||(this.mergeCurrentCanvas(),this.setupCurrentCanvas(e,t.tileScale)),t.isOverlay)t.draw(this.currentCanvas);else{var n=this.currentCanvas.getContext("2d"),r=t.tilePos,i=t.tileSize;n.drawImage(t.image,r.x*t.tileScale,r.y*t.tileScale,i.x*t.tileScale,i.y*t.tileScale)}}},{key:"setupCurrentCanvas",value:function(t,e){var n;if("overlay"===t||"solidOverlay"===t)n=this.destSize;else{var r=1<<24-t,i=this.projectedBounds.min.divideBy(r).round();n=this.projectedBounds.max.divideBy(r).round().subtract(i).multiplyBy(e)}this.currentCanvas=this.createCanvas(n),this.currentZoom=t,this.currentTileScale=e}},{key:"mergeCurrentCanvas",value:function(){this.currentCanvas&&("overlay"===this.currentZoom?function(t,e){if(t.width!==e.width||t.height!==e.height)throw new Error("Canvas size mismatch");var n=t.getContext("2d").getImageData(0,0,t.width,t.height).data;t.width=0,t.height=0;for(var r,i,o,a,s,l,u,c,f,d=e.getContext("2d").getImageData(0,0,e.width,e.height),h=d.data,p=n.length,m=0;m<p;m+=4)(a=n[m+3]/255)&&(r=n[m],i=n[m+1],o=n[m+2],l=r*(f=(f=((l=h[m])+(u=h[m+1])+(c=h[m+2]))/3)/255*.5+.5)*a+(s=1-a)*l,u=i*f*a+s*u,c=o*f*a+s*c,h[m]=l,h[m+1]=u,h[m+2]=c);n=null,e.getContext("2d").putImageData(d,0,0)}(this.currentCanvas,this.targetCanvas):this.targetCanvas.getContext("2d").drawImage(this.currentCanvas,0,0,this.destSize.x,this.destSize.y),this.currentCanvas.width=0,this.currentCanvas.height=0,this.currentCanvas=null)}},{key:"getDataUrl",value:function(){this.mergeCurrentCanvas();var t=this.targetCanvas.toDataURL("image/jpeg");return this.targetCanvas.width=0,this.targetCanvas.height=0,this.targetCanvas=null,t}}])&&v(e.prototype,n),r&&v(e,r),t}();function S(t,e,n,r,i,o,a,s){return x.apply(this,arguments)}function x(){return(x=g(regeneratorRuntime.mark((function t(e,n,r,a,s,l,u,c){var d,p,m,v,g;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:d={responseType:"blob",timeout:2e4,isResponseSuccess:function(t){return 200===t.status||404===t.status}},m=h(e),t.prev=2,g=regeneratorRuntime.mark((function t(){var e,m,g,b,w,k,_,S,x,O,P,L,C;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=v.value,m=void 0,m=e.options&&e.options.scaleDependent?l.mapZoom:l.satZoom,g=i.default.bounds(i.default.CRS.EPSG3857.latLngToPoint(n.getNorthWest(),m).round(),i.default.CRS.EPSG3857.latLngToPoint(n.getSouthEast(),m).round()),b=void 0,e._layerDummy||(b=(0,o.getTempMap)(m,e._rasterizeNeedsFullSizeMap,g)).addLayer(e),t.next=8,y(e.getTilesInfo({xhrOptions:d,pixelBounds:g,latLngBounds:n,destPixelSize:r,resolution:a,scale:s,zoom:m,pageLabel:u,pagesCount:c}));case 8:w=t.sent,k=w.iterateTilePromises,_=w.count,S=w.tileScale,x=void 0===S?1:S,O=[],P=h(k()),t.prev=15,C=regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=L.value,O.push(n.tilePromise),r=(e._printProgressWeight||1)/_,n.tilePromise=n.tilePromise.then((function(t){return f({zoom:m,progressInc:r,layer:e,tileScale:x},t)})),t.next=6,n;case 6:if(!(p=t.sent)){t.next=10;break}return n.abortLoading(),t.abrupt("return","break");case 10:case"end":return t.stop()}}),t)})),P.s();case 18:if((L=P.n()).done){t.next=25;break}return t.delegateYield(C(),"t0",20);case 20:if("break"!==t.t0){t.next=23;break}return t.abrupt("break",25);case 23:t.next=18;break;case 25:t.next=30;break;case 27:t.prev=27,t.t1=t.catch(15),P.e(t.t1);case 30:return t.prev=30,P.f(),t.finish(30);case 33:if(e._layerDummy){t.next=40;break}if(!p){t.next=39;break}return(0,o.disposeMap)(b),t.abrupt("return","break");case 39:Promise.all(O).then((function(){return(0,o.disposeMap)(b)}));case 40:case"end":return t.stop()}}),t,null,[[15,27,30,33]])})),m.s();case 5:if((v=m.n()).done){t.next=12;break}return t.delegateYield(g(),"t0",7);case 7:if("break"!==t.t0){t.next=10;break}return t.abrupt("break",12);case 10:t.next=5;break;case 12:t.next=17;break;case 14:t.prev=14,t.t1=t.catch(2),m.e(t.t1);case 17:return t.prev=17,m.f(),t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[2,14,17,20]])})))).apply(this,arguments)}function O(t,e){return P.apply(this,arguments)}function P(){return(P=g(regeneratorRuntime.mark((function t(e,n){var r,i,o,a,s,l,u,c,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=[];case 1:if(!(r.length<n)){t.next=12;break}return t.next=4,y(e.next());case 4:if(i=t.sent,o=i.value,!i.done){t.next=9;break}return t.abrupt("break",12);case 9:r.push(o),t.next=1;break;case 12:if(!r.length){t.next=34;break}return t.next=15,r.shift();case 15:if(!t.sent){t.next=26;break}return t.next=19,y(e.next(!0));case 19:a=t.sent,s=a.value,a.done||r.push(s),l=h(r);try{for(l.s();!(u=l.n()).done;)(0,u.value.abortLoading)()}catch(t){l.e(t)}finally{l.f()}return t.abrupt("return");case 26:return t.next=28,y(e.next());case 28:c=t.sent,f=c.value,c.done||r.push(f),t.next=12;break;case 34:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function L(){return(L=u(regeneratorRuntime.mark((function t(e){var n,r,o,l,u,c,f,d,p,m,v,y,g,b,w,x,P,L,C,M,j,T,D,q,E,I,A,R,F,N,z,U;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=e.map,r=e.pages,o=e.zooms,l=e.resolution,u=e.scale,c=e.progressCallback,f=e.decorationLayers,d=new a.XHRQueue,(p=k(n,d)).push.apply(p,s(f)),m=0,v=h(p);try{for(v.s();!(y=v.n()).done;)g=y.value,m+=g._printProgressWeight||1}catch(t){v.e(t)}finally{v.f()}m*=r.length,b=[],w=new Set,x=h(r),t.prev=11,x.s();case 13:if((P=x.n()).done){t.next=53;break}return L=P.value,C=L.printSize.multiplyBy(l/25.4).round(),M=i.default.bounds(n.project(L.latLngBounds.getNorthWest(),24).round(),n.project(L.latLngBounds.getSouthEast(),24).round()),j=new _(C,M),t.next=20,S(p,L.latLngBounds,C,l,u,o,L.label,r.length);case 20:T=t.sent,D=O(T,20);case 22:return t.next=25,D.next();case 25:if(q=t.sent,E=q.value,!q.done){t.next=30;break}return t.abrupt("break",47);case 30:return I=void 0,t.prev=31,t.next=34,E.tilePromise;case 34:I=t.sent,t.next=41;break;case 37:throw t.prev=37,t.t0=t.catch(31),D.next(!0),t.t0;case 41:c(I.progressInc,m),j.putTile(I),R=(A=I).image,F=A.draw,N=A.layer,!R&&!F||N._layerDummy||w.add(N),t.next=22;break;case 47:z=j.getDataUrl(),U=z.substring(z.indexOf(",")+1),U=atob(U),b.push({data:U,width:C.x,height:C.y});case 51:t.next=13;break;case 53:t.next=58;break;case 55:t.prev=55,t.t1=t.catch(11),x.e(t.t1);case 58:return t.prev=58,x.f(),t.finish(58);case 61:return t.abrupt("return",{images:b,renderedLayers:w});case 62:case"end":return t.stop()}}),t,null,[[11,55,58,61],[31,37]])})))).apply(this,arguments)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r={bingKey:"0000000000000000000000000000000000000000000000000000000000000000",thunderforestKey:"00000000000000000000000000000000",sentryDSN:"https://00000000000000000000000000000000@sentry.io/111111",mapillary:"ejd0bUg5dzlTZ0VscTZKeTQySHVONDowMzJhZTkzODNiYzVjY2Qz",flickr:"00000000000000000000000000000000",google:"XXXXXXXXXXXXXXXXXXXXXXXXXXXXX"};e.default=r},function(t,e,n){"use strict";n(1),n(0),n(20),n(5),n(3),n(307),Object.defineProperty(e,"__esModule",{value:!0}),e.imgFromDataString=function(t){if(200===t.status&&t.response.size){var e=new Image,n=window.URL.createObjectURL(t.response),r=new Promise((function(t,r){e.onload=function(){t(e),window.URL.revokeObjectURL(n)},e.onerror=function(){r(new Error("Image corrupt")),window.URL.revokeObjectURL(n)}}));return e.src=n,r}return null}},,,,function(t,e,n){"use strict";n(0),n(20),n(25);var r,i=(r=n(9))&&r.__esModule?r:{default:r},o=n(392);o.BingLayer.include({waitTilesReadyToGrab:function(){var t=this;return this._url?Promise.resolve():new Promise((function(e){var n=setInterval((function(){t._url&&(clearInterval(n),e())}),50)}))},cloneForPrint:function(t){return new o.BingLayer(this._key,i.default.Util.extend({},this.options,t))}})},function(t,e,n){"use strict";n(14),n(43),Object.defineProperty(e,"__esModule",{value:!0}),e.tile2quad=o,e.BingLayer=void 0;var r,i=(r=n(9))&&r.__esModule?r:{default:r};function o(t,e,n){for(var r="",i=n;i>0;i--){var o=0,a=1<<i-1;0!=(t&a)&&(o+=1),0!=(e&a)&&(o+=2),r+=o}return r}var a=i.default.TileLayer.extend({options:{subdomains:[0,1,2,3],type:"Aerial",attribution:"Bing",culture:""},initialize:function(t,e){i.default.Util.setOptions(this,e),this._key=t,this._url=null,this._providers=[],this.metaRequested=!1},getTileUrl:function(t){var e=this._getZoomForUrl(),n=this.options.subdomains,r=this.options.subdomains[Math.abs((t.x+t.y)%n.length)];return this._url.replace("{subdomain}",r).replace("{quadkey}",o(t.x,t.y,e)).replace("{culture}",this.options.culture)},loadMetadata:function(){if(!this.metaRequested){this.metaRequested=!0;var t=this,e="_bing_metadata_"+i.default.Util.stamp(this);window[e]=function(n){window[e]=void 0;var r=document.getElementById(e);if(r.parentNode.removeChild(r),n.errorDetails)throw new Error(n.errorDetails);t.initMetadata(n)};var n="https",r="https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.options.type+"?include=ImageryProviders&jsonp="+e+"&key="+this._key+"&UriScheme="+n,o=document.createElement("script");o.type="text/javascript",o.src=r,o.id=e,document.getElementsByTagName("head")[0].appendChild(o)}},initMetadata:function(t){var e=t.resourceSets[0].resources[0];if(this.options.subdomains=e.imageUrlSubdomains,this._url=e.imageUrl,e.imageryProviders)for(var n=0;n<e.imageryProviders.length;n++)for(var r=e.imageryProviders[n],o=0;o<r.coverageAreas.length;o++){var a=r.coverageAreas[o],s={zoomMin:a.zoomMin,zoomMax:a.zoomMax,active:!1},l=new i.default.LatLngBounds(new i.default.LatLng(a.bbox[0]+.01,a.bbox[1]+.01),new i.default.LatLng(a.bbox[2]-.01,a.bbox[3]-.01));s.bounds=l,s.attrib=r.attribution,this._providers.push(s)}this._update()},_update:function(){null!==this._url&&this._map&&(this._update_attribution(),i.default.TileLayer.prototype._update.apply(this,[]))},_update_attribution:function(){for(var t=i.default.latLngBounds(this._map.getBounds().getSouthWest().wrap(),this._map.getBounds().getNorthEast().wrap()),e=this._map.getZoom(),n=0;n<this._providers.length;n++){var r=this._providers[n];e<=r.zoomMax&&e>=r.zoomMin&&t.intersects(r.bounds)?(!r.active&&this._map.attributionControl&&this._map.attributionControl.addAttribution(r.attrib),r.active=!0):(r.active&&this._map.attributionControl&&this._map.attributionControl.removeAttribution(r.attrib),r.active=!1)}},onAdd:function(t){this.loadMetadata(),i.default.TileLayer.prototype.onAdd.apply(this,[t])},onRemove:function(t){for(var e=0;e<this._providers.length;e++){var n=this._providers[e];n.active&&this._map.attributionControl&&(this._map.attributionControl.removeAttribution(n.attrib),n.active=!1)}i.default.TileLayer.prototype.onRemove.apply(this,[t])}});e.BingLayer=a},function(t,e,n){"use strict";n(7),n(46),n(22),n(62),n(19),n(59),n(96),n(34),n(0),n(20),n(23),n(30);var r,i,o,a=(r=n(9))&&r.__esModule?r:{default:r};function s(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n(274),a.default.Layer.Yandex.Map.include({cloneForPrint:function(t){return new a.default.Layer.Yandex.Map(u(u(u({},this.options),t),{},{yandexScale:2}))},getTilesInfo:(i=regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.default.TileLayer.prototype.getTilesInfo.call(this,e);case 2:return(n=t.sent).tileScale=2,t.abrupt("return",n);case 5:case"end":return t.stop()}}),t,this)})),o=function(){var t=this,e=arguments;return new Promise((function(n,r){var o=i.apply(t,e);function a(t){s(o,n,r,a,l,"next",t)}function l(t){s(o,n,r,a,l,"throw",t)}a(void 0)}))},function(t){return o.apply(this,arguments)})}),a.default.Layer.Yandex.Sat.include({cloneForPrint:function(t){return new a.default.Layer.Yandex.Sat(u(u({},this.options),t))}}),a.default.Layer.Yandex.Tracks.include({cloneForPrint:function(t){return new a.default.Layer.Yandex.Tracks(u(u({},this.options),t))}})},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";var r,i=(r=n(9))&&r.__esModule?r:{default:r};n(275),i.default.Layer.GoogleBase.include({cloneForPrint:function(t){return new i.default.Layer.GoogleBase(this._url,i.default.Util.extend({},this.options,t))}})},function(t,e,n){"use strict";n(0),n(20),n(30);var r,i=(r=n(9))&&r.__esModule?r:{default:r};n(397);var o,a,s=n(276);function l(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}n(169),n(281),i.default.Layer.WestraPasses.addInitHook((function(){this.markers.options.print=this.options.print,this.options.print=!1})),s.WestraPassesMarkers.include({waitDataReady:function(){var t=this;return this._dataLoaded?Promise.resolve():new Promise((function(e){t.on("data-loaded",e)}))},cloneForPrint:function(t){return t=i.default.Util.extend({},this.options,t),new s.WestraPassesMarkers(this._baseUrl,t)},getTilesInfo:(o=regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.waitDataReady();case 2:return t.abrupt("return",i.default.Layer.CanvasMarkers.prototype.getTilesInfo.call(this,e));case 3:case"end":return t.stop()}}),t,this)})),a=function(){var t=this,e=arguments;return new Promise((function(n,r){var i=o.apply(t,e);function a(t){l(i,n,r,a,s,"next",t)}function s(t){l(i,n,r,a,s,"throw",t)}a(void 0)}))},function(t){return a.apply(this,arguments)})})},function(t,e,n){"use strict";n(24),n(6);var r,i=(r=n(9))&&r.__esModule?r:{default:r};n(398),n(399);var o=n(276);i.default.Layer.WestraPasses=i.default.Layer.extend({options:{fileCoverage:"westra_coverage.json",fileLabels1:"westra_regions_labels1.json",fileLabels2:"westra_regions_labels2.json",scaleDependent:!0,labels2Zoom:6,markersZoom:10,labels1Zoom:2},initialize:function(t,e){i.default.setOptions(this,e),this.markers=new o.WestraPassesMarkers(t,e.markersOptions),this.coverage=new i.default.Layer.GeoJSONAjax(t+this.options.fileCoverage,{className:"westra-coverage-polygon",onEachFeature:this._setEventsForRegion.bind(this)}),this.labels1=new i.default.Layer.GeoJSONAjax(t+this.options.fileLabels1,{pointToLayer:this._makeMarker,onEachFeature:this._setEventsForRegion.bind(this)}),this.labels2=new i.default.Layer.GeoJSONAjax(t+this.options.fileLabels2,{pointToLayer:this._makeMarker,onEachFeature:this._setEventsForRegion.bind(this)})},_setEventsForRegion:function(t,e){e.on("click",this._onRegionClick,this)},_makeMarker:function(t,e){var n=i.default.divIcon({className:"westra-region-label",html:"<span>"+t.properties.name+"</span>"});return i.default.marker(e,{icon:n})},_onRegionClick:function(t){var e,n=t.target,r=n.getLatLng?n.getLatLng():t.latlng;e=this._map.getZoom()<this.options.labels2Zoom?this.options.labels2Zoom:this.options.markersZoom,this._map.setView(r,e)},setLayersVisibility:function(t){if(this._map){var e,n=!t||"zoomanim"!==t.type;(e=t&&void 0!==t.zoom?t.zoom:this._map.getZoom())<this.options.labels1Zoom?(this._map.removeLayer(this.markers),this._map.addLayer(this.coverage),this._map.removeLayer(this.labels1),this._map.removeLayer(this.labels2)):e<this.options.labels2Zoom?(this._map.removeLayer(this.markers),this._map.addLayer(this.coverage),this._map.addLayer(this.labels1),this._map.removeLayer(this.labels2)):e<this.options.markersZoom?(this._map.removeLayer(this.markers),this._map.addLayer(this.coverage),this._map.removeLayer(this.labels1),this._map.addLayer(this.labels2)):(n&&this._map.addLayer(this.markers),this._map.removeLayer(this.coverage),this._map.removeLayer(this.labels1),this._map.removeLayer(this.labels2))}},onAdd:function(t){this._map=t,this.markers.loadData(),this.coverage.loadData(),this.labels1.loadData(),this.labels2.loadData(),this.setLayersVisibility(),t.on("zoomend",this.setLayersVisibility,this),t.on("zoomanim",this.setLayersVisibility,this)},onRemove:function(){this._map.removeLayer(this.markers),this._map.removeLayer(this.coverage),this._map.removeLayer(this.labels1),this._map.removeLayer(this.labels2),this._map.off("zoomend",this.setLayersVisibility,this),this._map.off("zoomanim",this.setLayersVisibility,this),this._map=null}})},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n(16);var i,o=(i=n(9))&&i.__esModule?i:{default:i},a=n(67),s=n(103),l=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var e=u();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var a=i?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=t[o]}n.default=t,e&&e.set(t,n);return n}(n(97));function u(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return u=function(){return t},t}o.default.Layer.GeoJSONAjax=o.default.GeoJSON.extend({options:{requestTimeout:3e4},initialize:function(t,e){o.default.GeoJSON.prototype.initialize.call(this,null,e),this.url=t},loadData:function(){var t=this;this._loadStarted||(this._loadStarted=!0,(0,a.fetch)(this.url,{timeout:this.options.requestTimeout}).then((function(e){t.addData(JSON.parse(e.response))}),(function(e){l.captureException(e,"failed to get geojson"),(0,s.notify)("Failed to get GeoJSON data from ".concat(t.url,": ").concat(e.message))})))},onAdd:function(t){o.default.GeoJSON.prototype.onAdd.call(this,t),this.loadData()}})},,function(t,e,n){"use strict";n.r(e)},,function(t,e,n){"use strict";n.r(e)},,,function(t,e,n){"use strict";n(7),n(10),n(11),n(15),n(13),n(1),n(18),n(8),n(2),n(24),n(6),n(0),n(20),n(4),n(5),n(3),n(30);var r,i,o,a=(r=n(9))&&r.__esModule?r:{default:r};function s(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}n(282),a.default.Polyline.include({_printProgressWeight:.1,printWidthMm:1,cloneForPrint:function(t){t=a.default.Util.extend({},this.options,t);var e=this.getLatLngs().map((function(t){return t.clone()}));return new a.default.Polyline(e,t)},_makelatLngToCanvasPixelTransformer:function(t,e){var n=t.pixelBounds,r=n.getSize().unscaleBy(t.destPixelSize),i=n.min;return function(n){return a.default.CRS.EPSG3857.latLngToPoint(n,t.zoom).subtract(i).add(a.default.point([e,0])).unscaleBy(r)}},_shift:function(t,e){var n=this.getBounds(),r=0,i=a.default.CRS.EPSG3857.getProjectedBounds(e).getSize().x;if(n.isValid()){var o=n.getCenter(),s=t.getCenter();r=o.lng<s.lng-180?1:o.lng>s.lng+180?-1:0}return{lng:360*r,projected:i*r}},_drawRaster:function(t,e){var n=this.getLatLngs(),r=this._shift(e.latLngBounds,e.zoom),i=this.getBounds();if(n.length<2)return!1;if(!a.default.latLngBounds([[i.getNorth(),i.getWest()+r.lng],[i.getSouth(),i.getEast()+r.lng]]).intersects(e.latLngBounds))return!1;var o=t.getContext("2d");o.lineWidth=this.printWidthMm/25.4*e.resolution,o.lineJoin="round",o.lineCap="round",o.strokeStyle=this.options.color;var s,l=this._makelatLngToCanvasPixelTransformer(e,r.projected);o.beginPath(),s=l(n[0]),o.moveTo(s.x,s.y);for(var u=1;u<n.length;u++)s=l(n[u]),o.lineTo(s.x,s.y);return o.stroke(),!0},getTilesInfo:(i=regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{iterateTilePromises:regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,{tilePromise:Promise.resolve({draw:function(t){return n._drawRaster(t,e)},isOverlay:!0}),abortLoading:function(){}};case 2:case"end":return t.stop()}}),t)})).bind(this),count:1});case 1:case"end":return t.stop()}}),t,this)})),o=function(){var t=this,e=arguments;return new Promise((function(n,r){var o=i.apply(t,e);function a(t){u(o,n,r,a,s,"next",t)}function s(t){u(o,n,r,a,s,"throw",t)}a(void 0)}))},function(t){return o.apply(this,arguments)})}),a.default.MeasuredLine.include({tickFontSizeMm:2.5,cloneForPrint:function(t){t=a.default.Util.extend({},this.options,t);var e=this.getLatLngs().map((function(t){return t.clone()}));return new a.default.MeasuredLine(e,t)},_drawRaster:function(t,e){if(a.default.Polyline.prototype._drawRaster.call(this,t,e)&&this.options.measureTicksShown){var n=1.5*e.scale,r=t.getContext("2d"),i=this.getTicksPositions(n),o=this.tickFontSizeMm/25.4*e.resolution,l=this._shift(e.latLngBounds,e.zoom),u=this._makelatLngToCanvasPixelTransformer(e,l.projected);r.font="bold ".concat(o,"px verdana"),r.fillStyle=this.options.color;var c,f=s(i);try{for(f.s();!(c=f.n()).done;){var d=c.value,h=d.transformMatrix,p="━━ "+Math.round(d.distanceValue/10)/100+" km",m=u(d.position);r.setTransform(h[0],h[1],h[2],h[3],m.x,m.y),r.fillText(p,0,.3*o),r.setTransform(1,0,0,1,0,0)}}catch(t){f.e(t)}finally{f.f()}}}})},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";n(0),n(20),n(30);var r,i,o,a=(r=n(9))&&r.__esModule?r:{default:r},s=n(283);function l(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}n(272),s.RetinaTileLayer.include({cloneForPrint:function(t){var e=a.default.Util.extend({},this.options,t);return new s.RetinaTileLayer(this.urls,e,e.scaleDependent)},getTilesInfo:(i=regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.default.TileLayer.prototype.getTilesInfo.call(this,e);case 2:return(n=t.sent).tileScale=this.tileSizeMultiplicator,t.abrupt("return",n);case 5:case"end":return t.stop()}}),t,this)})),o=function(){var t=this,e=arguments;return new Promise((function(n,r){var o=i.apply(t,e);function a(t){l(o,n,r,a,s,"next",t)}function s(t){l(o,n,r,a,s,"throw",t)}a(void 0)}))},function(t){return o.apply(this,arguments)})})},function(t,e,n){"use strict";n.r(e),e.default='<div class="leaflet-control-button-toggle" title="Print map"\n     data-bind="click: setExpanded, css: {\'icon-spinner-nuclear\': makingPdf, \'icon-printer\': !makingPdf()}">\n    </div>\n<div class="leaflet-control-content">\n<table class="layout">\n    <tbody>\n    <tr><td colspan="2">\n        <a title="Add page in portrait orientation" class="button-add-page-vert image-button"\n           data-bind="click: addPortraitPage"></a>\n        <a title="Add page in landscape orientation" class="button-add-page-horiz image-button"\n           data-bind="click: addLandscapePage"></a>\n        <span class="pages-num" data-bind="text: pagesNumLabel, click: onPagesNumLabelClick, css: {\'pages-not-null\': pagesNum() > 0}"></span>\n        <a title="Remove all pages" class="button-remove-pages image-button"\n           data-bind="click: removePages"></a>\n    </td></tr>\n    <tr>\n        <td class="label">Print scale</td>\n        <td>\n            <div class="preset-values" >\n                <a data-bind="click: function() {scale(100)}, css: {selected: scale() === 100}">100 m</a>\n                <a data-bind="click: function() {scale(500)}, css: {selected: scale() === 500}">500 m</a>\n                <a data-bind="click: function() {scale(1000)}, css: {selected: scale() === 1000}">1 km</a>\n            </div>\n            <input type="text" class="scale" maxlength="6" data-bind="value: scale">&nbsp;m in 1 cm\n        </td>\n    </tr>\n    <tr data-bind="visible: settingsExpanded">\n        <td class="label">Page size</td>\n        <td>\n            <div class="preset-values" data-bind="foreach: {data: pageSizes, as: \'size\'}">\n                <a data-bind="click: function() {$root.pageWidth(size.width); $root.pageHeight(size.height)},\n                              text: size.name,\n                              css: {selected: size.name === $root.pageSizeDescription() }"></a>\n            </div>\n            <input type="text" maxlength="4" title="width" placeholder="width" class="page-size" data-bind="value: pageWidth">\n            x <input type="text" maxlength="4" title="height" placeholder="height" class="page-size" data-bind="value: pageHeight"> mm\n        </td>\n    </tr>\n    <tr data-bind="visible: settingsExpanded">\n        <td class="label-high">Margins</td>\n        <td>\n            <table class="margins">\n                <tr>\n                    <td></td>\n                    <td><input type="text" maxlength="2" value="3" data-bind="value: marginTop"></td>\n                    <td></td>\n                </tr>\n                <tr>\n                    <td><input type="text" maxlength="2" value="3" data-bind="value: marginLeft"></td>\n                    <td></td><td><input type="text" maxlength="2" value="3" data-bind="value: marginRight"> mm</td>\n                </tr>\n                <tr><td></td><td><input type="text" maxlength="2" value="3" data-bind="value: marginBottom"></td><td></td></tr>\n            </table>\n        </td>\n    </tr>\n    <tr data-bind="visible: settingsExpanded">\n        <td class="label">Resolution</td>\n        <td><input type="text" maxlength="4" class="resolution" data-bind="value: resolution"> dpi</td>\n    </tr>\n    <tr data-bind="visible: settingsExpanded">\n        <td class="label">Source zoom<br />level</td>\n        <td>\n            <select name="srczoom"\n                    data-bind="options: zoomLevels, value: zoomLevel">\n            </select>\n        </td>\n    </tr>\n    <tr>\n        <td colspan="2">\n            <label><input type="checkbox" data-bind="checked: magneticMeridiansOn"> Magnetic meridians</label>\n            <label><input type="checkbox" data-bind="checked: gridOn"> Kilometers grid</label>\n        </td>\n    </tr>\n    <tr><td colspan="2">\n        <a class="button-settings image-button" data-bind="click: function() {settingsExpanded(!settingsExpanded())}"\n            title="More settings"></a>\n        <div class="settings-summary">\n            <span data-bind="text: pageSizeDescription"></span><br/>\n            <span data-bind="text: resolution"></span>&nbsp;dpi,\n            zoom&nbsp;<span data-bind="text: zoomLevel"></span>\n            \x3c!-- ko if: zoomLevel()=== "auto" --\x3e\n            (<span title="Zoom for satellite and scanned imagery" data-bind="text: autoZoomLevels().satZoom"></span>&nbsp;\n            /&nbsp;<span title="Zoom for maps like OSM and Google" data-bind="text: autoZoomLevels().mapZoom"></span>)\n            \x3c!-- /ko --\x3e\n        </div>\n    </td></tr>\n    <tr><td colspan="2">\n        <div class="download-button-row">\n            <div class="button-minimize" data-bind="click: setMinimized"></div>\n            <a class="text-button button-save" data-bind="\n                                click: onSavePdfClicked,\n                                visible: !makingPdf()">Save PDF</a>\n            <div data-bind="\n                                component: { \n                                    name: \'progress-indicator\',\n                                    params: {progressRange: downloadProgressRange, progressDone: downloadProgressDone}\n                                },\n                                visible: makingPdf()"></div>\n        </div>\n    </td></tr>\n    </tbody>\n</table>\n</div>\n'},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||o(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=o(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,a=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw a}}}}function o(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t,e,n){var r=3*t+3,i=r+1,o=r+2;return"".concat(r," 0 obj\n<< /Type /Page\n/Parent 2 0 R\n/MediaBox [0 0 ").concat(e," ").concat(n,"]\n/Contents ").concat(i," 0 R\n/Rotate ").concat(e>n?90:0,"\n/Resources <<\n    /XObject << /Im").concat(t," ").concat(o," 0 R >>\n    /ProcSet [ /PDF /Text /ImageC ] \n    >>\n>>\nendobj")}function l(t,e,n){var r=3*t+3+1,i="q\n".concat(e," 0 0 ").concat(n," 0 0 cm\n/Im").concat(t," Do\nQ   ");return"".concat(r," 0 obj\n<<\n/Length ").concat(i.length+1,"\n>>\nstream\n").concat(i,"   \nendstream\nendobj")}function u(t,e,n,r){return"".concat(3*t+3+2," 0 obj\n<< /Type /XObject\n/Subtype /Image\n/Name /Im").concat(t,"\n/Filter [ /DCTDecode ]\n/Width ").concat(e,"\n/Height ").concat(n,"\n/ColorSpace /DeviceRGB\n/BitsPerComponent 8\n/Length ").concat(r.length,"\n>>\nstream\n").concat(r,"\nendstream\nendobj")}n(7),n(10),n(11),n(16),n(15),n(13),n(1),n(31),n(8),n(2),n(6),n(0),n(4),n(5),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.makePdf=function(t,e){var n=0,o=[],a=[];function c(t,e){a.push(t),e||o.push(n),n+=t.length}c("%PDF-1.3",!0),c("1 0 obj\n<< /Type /Catalog\n/Pages 2 0 R\n>>\nendobj"),c(function(t){for(var e=[],n=0;n<t;n++)e.push("".concat(3*n+3," 0 R"));return e=e.join(" "),"2 0 obj\n<< /Type /Pages        \n/Kids [ ".concat(e," ]\n/Count ").concat(t,"\n>>\nendobj")}(t.length));var f,d=i(t.entries());try{for(d.s();!(f=d.n()).done;){var h=r(f.value,2),p=h[0],m=h[1],v=m.data,y=m.width,g=m.height,b=y/e*72,w=g/e*72;c(s(p,b,w)),c(l(p,b,w)),c(u(p,y,g,v))}}catch(t){d.e(t)}finally{d.f()}return c(function(t,e){var n=[];n.push("xref\n0 ".concat(t.length+1,"\n0000000000 65535 f "));var r,o=i(t);try{for(o.s();!(r=o.n()).done;){var a=r.value;a=a.toString();var s="0000000000".substr(a.length);n.push("".concat(s).concat(a," 00000 n "))}}catch(t){o.e(t)}finally{o.f()}return n.push("trailer\n<< /Root 1 0 R\n/Size ".concat(t.length+1,"\n>>\nstartxref\n").concat(e)),n.join("\n")}(o,n),!0),c("%%EOF\n",!0),a=a.join("\n")}},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";n(7),n(10),n(11),n(16),n(1),n(2),n(28),n(19),n(35),n(29),n(0),n(39),n(4),n(5),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.MagneticMeridians=void 0;var r,i=(r=n(9))&&r.__esModule?r:{default:r},o=n(284);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h(t);if(e){var i=h(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f(this,n)}}function f(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?d(t):e}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m(t,e,n){return e=e*Math.PI/180,i.default.point(t.x+Math.sin(e)*n,t.y-Math.cos(e)*n)}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(f,t);var e,n,r,a=c(f);function f(){var t;s(this,f);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return p(d(t=a.call.apply(a,[this].concat(n))),"lineThicknessMm",.2),p(d(t),"lineIntervalMm",50),p(d(t),"samplingIntervalMm",15),p(d(t),"color","#66c2ff"),p(d(t),"overlaySolid",!1),t}return e=f,(n=[{key:"_makeCanvasToLatLngTransformer",value:function(t){var e=t.pixelBounds,n=e.getSize().unscaleBy(t.destPixelSize),r=e.min;return function(e){return i.default.CRS.EPSG3857.pointToLatLng(e.scaleBy(n).add(r),t.zoom)}}},{key:"_drawRaster",value:function(t,e){var n=this._makeCanvasToLatLngTransformer(e),r=t.getContext("2d");r.beginPath(),r.strokeStyle=this.color,r.lineWidth=this.lineThicknessMm/25.4*e.resolution;var i=this.lineIntervalMm/25.4*e.resolution,a=this.samplingIntervalMm/25.4*e.resolution,s=Math.sqrt(e.destPixelSize.x*e.destPixelSize.x+e.destPixelSize.y*e.destPixelSize.y),l=s/2/a;function u(t,e){r.moveTo(t.x,t.y);for(var i=0;i<=l;i++){var s=n(t),u=(0,o.getDeclination)(s.lat,s.lng);if(null===u)break;e&&(u+=180),t=m(t,u,a),r.lineTo(t.x,t.y)}}var c=e.destPixelSize.divideBy(2),f=s/2/i;u(c),u(c,!0);for(var d=c,h=0;h<=f;h++){var p=n(d),v=(0,o.getDeclination)(p.lat,p.lng);null===v&&(v=0),u(d=m(d,v+90,i)),u(d,!0)}d=c;for(var y=0;y<=f;y++){var g=n(d),b=(0,o.getDeclination)(g.lat,g.lng);null===b&&(b=0),u(d=m(d,b-90,i)),u(d,!0)}r.stroke()}}])&&l(e.prototype,n),r&&l(e,r),f}(n(215).PrintStaticLayer);e.MagneticMeridians=v},function(t){t.exports=JSON.parse('{"minLat":-58,"step":2,"rowsCount":69,"maxLat":78,"valueOffset":76,"array":"7u7t7e3s7Ozr6+rq6unp6Ojn5+fm5ubl5eTk5OPj4uHh4N/e3dzb2djW1dPRz83LycbEwb+8ube0sa+sqaekop+dm5mXlZORj42MiomHhoSCgX9+fHp4dnRyb21raGVjYF1aV1RRTktIRUI/PDk2MzEuKyknJCIgHhwaGBYVExIRDw4ODQwMDAwMDA0OEBEUFxsfJSw0PklWZHSDkqGtuMLK0Nbb3uLk5+jq6+zt7e7u7u7u5ubm5ubm5eXl5OTk5OPj4+Li4uHh4eHg4ODg39/f3t7d3dzb2tnY19bU09HPzcvJx8TCv726t7Wyr6ypp6Shn5yamJaTkpCOjIuJiIaFg4KBf358e3l3dXNxb21qaGVjYF1aV1RRTktIRUI/PDo3NDIvLSooJiQiIB4dGxoZFxYWFRQUFBQUFBUWFxkbHiElKS40O0NMVWBrd4OOmaOttbzDyM3R1djb3d/g4uPk5eXm5ubm4ODg4ODg4N/f39/e3t7e3t3d3d3c3Nzc3Nzc29vb29ra2dnY19fW1dPS0c/Ny8nHxcPAvbu4tbKvraqnpKGenJmXlZKQjoyLiYeGhYOCgYB+fXx6eXh2dHNxb2xqaGVjYF1aV1RRT0xJRkNAPTo4NTMwLiwqKCYkIyEgHx4dHBsbGhoaGxscHR8gIyUoLDA0OT9GTVVeZ3B5g4yVnaWss7i+wsfKztHT1dfZ2tzd3d7f39/g2tvb29vb29ra2tra2tnZ2dnZ2NjY2NjY2NjY2NfX19fX1tbV1dTT0tHQz83LycfFw8G+u7m2s7CtqqekoZ6bmZaUkY+Ni4mHhoSDgoB/fn18e3p5d3Z1c3JwbmxqaGVjYF1bWFVST0xJRkNBPjs5NjQyMC4sKignJSQjIiEhICAgICEhIiMlJigrLjE1OT1DSE5VXGNrc3uDipKZn6arsba6vsLFyMvNz9HT1NXX19jZ2dra1tbW1tbW1tbW1tbW1dXV1dXV1NTU1NTU1NTU1NTU1NTU09PT0tLR0M/OzMvJyMbEwb+8ure0sa6rqKShnpuYlpOQjoyJh4aEgoGAfn18e3p6eXh3dnVzcnFvbWxqZ2VjYF5bWFVSUE1KR0RCPz06ODYzMTAuLCsqKCgnJiYlJSUmJicoKistLzI1ODxARUpPVVthaG91fIOJj5aboaarr7O3u77BxMbIyszOz9DR0tPU1NXV0dLS0tLS0tLS0tLS0tHR0dHR0dHR0dHR0dHR0dHR0dHQ0NDQz8/Ozs3MysnHxsTCv726uLWyr6uopaKfm5iVkpCNioiGhIKAf358e3p5eHh3dnV1dHNycXBubWtpZ2VjYF5bWVZTUE5LSEVDQD48OTc1NDIwLy4tLCsrKioqKissLS4vMTM2ODw/Q0dLUFVaYGZrcXd9g4iOk5idoqaqrrG1uLu+wMLExsjJy8zNzs/Q0NHRzs7Ozs7Pz8/Pzs7Ozs7Ozs7Ozs3Nzc3Nzc3Nzc3Nzs7Nzc3NzczMy8rJyMfFxMLAvbu4trOwrKmmop+cmJWSj4yKh4WCgX99fHp5eHd2dnV0dHNycnFwb25tbGtpZ2VjYV5cWVdUUU9MSUdEQkA9Ozk4NjQzMjEwLy8vLy8vMDEyMzU3OTs+QUVITFFVWl9kaW50eX6DiI2RlpqeoqaprbCztri7vb/Bw8TGx8jJysvMzM3NysvLy8vLy8vLy8vLy8vLy8vLy8rKysrKysrKysrKy8vLy8rKysrJycjHxsXDwsC+vLm2tLGtqqejoJyZlZKPjImGhIF/fXt6eHd2dXRzc3JycXFwcG9vbm1sa2ppZ2VjYV9dWlhVU1BNS0hGREJAPjw6OTc2NTQ0MzMzNDQ1Njc4Ojw+QUNGSk1RVVpeY2hscXZ6f4SIjJCUmJyfoqaprK6xs7a4ury+wMHCxMXGx8jIycnKx8jIyMjIyMjIyMjIyMjIyMjIyMjIx8fHx8fHx8jIyMjIyMjIx8fHxsbFxMPBwL68ube0sa6rqKShnZqWk4+MiYaDgX58enh3dXRzcnFxcG9vb25ubm1tbGxra2ppZ2ZkYmBeXFlXVFJPTUtIRkRCQD89PDs6OTg4ODg4OTk6PD0/QUNFSEtOUlZaXmJma29zeHyAhIiMj5OWmZ2goqWoq62vsrS2uLq7vb7AwcLDxMXFxsbHxMXFxcXGxsbGxsbGxsbGxcXFxcXFxcXFxcXFxcXFxcXFxcXFxcXExMPCwsC/vby6t7Wyr6yppaKem5eTkIyJhoOAfnt5d3V0cnFwb29ubW1sbGxsbGtra2tqamlpaGZlY2JgXVtZVlRST01LSUdFREJBQD8+PT09PT09Pj9AQkNFSEpNUFNWWl1hZWltcXV5fYGFiIyPkpWYm52goqWnqqyusLK0tre5ury9vr/AwcLDw8TEwsLCw8PDw8PDw8PDw8PDw8PDw8PDwsLCwsLCwsLCwsLCwsLCwsLCwcHAv769u7q4tbOwraqno5+cmJSRjYqGg4B9e3h2dHNxcG9ubWxsa2tqampqampqampqamlpaGdmZWNiYF5bWVdVU1BOTEtJR0ZFRENCQkJCQkJDREVGSEpMTlFUV1pdYWRobHB0d3t/goWJjI6RlJeZm56goqSnqautrrCytLW3uLm7vL2+v7/AwcHCwMDAwMDBwcHBwcHBwcHBwcHBwcDAwMDAwMDAwMDAwMDAwMDAwMC/v76+vby7ube1s7Guq6ikoZ2ZlpKOi4eEgX57eHZ0cnBvbm1sa2pqaWloaGhoaGhpaWlpaWlpaWhoZ2VkYmFfXVpYVlRSUE9NTEpJSEhHR0dHR0hJSktNTlBTVVhaXWFkZ2tucnZ5fYCDhomMjpGTlpianJ6goqSmqKqrra+wsrO1tre5uru8vL2+vr+/vb6+vr6+v7+/v7+/v7+/v7+/v76+vr6+vr6+vr6+vr6+vr69vb29vby8u7q4t7Wzsa6sqaWinpuXk4+MiIWBfnt5dnRycG5tbGtqaWhoZ2dnZ2dnZ2doaGlpampqampqaWhnZmRiYV9dW1lXVVNSUE9OTU1MTExNTU5PUFFTVVdZW15hZGdqbXF0d3t+gYSHioyPkZOVl5mbnZ6goqSlp6mqrK2vsLKztLa3uLm6uru8vL29u7y8vLy8vb29vb29vb29vb29vby8vLy8vLy8vLu7u7u7u7u7u7u7urq5uLe2tbOxr6yqpqOgnJmVkY2KhoJ/fHl3dHJwbm1ramloaGdmZmZmZmZmZmdnaGlpamtsbGxsbGtramhnZWNiYF5cWllXVlVUU1JSUlJSU1RVVldZW11fYmRnam1wc3Z5fH+ChYiKjY+Rk5WWmJqbnZ6goqOlpqipq6yur7Cys7S1tre4uLm6uru7urq6urq6u7u7u7u7u7u7u7u7u7u7urq6urq6urm5ubm5ubm5ubm5uLi3trW0s7GvraqnpKGempaTj4uHhIB9end1cnBubWtqaWhnZ2ZmZWVlZWVlZmZnaGlqa2xtbm9vb29vbm1samlnZWNiYF5dXFtaWVhYWFhYWVpbXF1fYWNlZ2psb3J1eHt+gIOGiIuNj5GTlJaYmZqcnZ6goaOkpqeoqqusrq+wsbKztLW2t7e4uLm5uLi4uLm5ubm5ubm5ubm5ubm5ubm5ubm4uLi4uLi4t7e3t7e3t7e3tra1tLOysa+tq6ilop+cmJSRjYmFgn97eHZzcW9tbGppaGdmZmVlZWVkZWVlZmdoaWprbW5vcXJzc3Nzc3JxcG5ta2poZmVjYmFgX15eXl5eX2BhYmNlZ2hqbW9xdHd5fH+BhIeJi42PkZOUlpeYmpucnZ6goaKkpaanqaqrra6vsLGys7S0tba2t7e4tra3t7e3t7e3t7e4uLi4uLi4uLe3t7e3t7a2tra2tra1tbW1tbW1tLSzsrGwr62rqaajoJ2alpKPi4eEgH16d3RycG5sa2loZ2dmZWVlZWVlZWVmZ2hpamttb3BydHV2d3h4eHd3dnRzcXBubWtpaGdmZWRkZGRkZWVmZ2lqbG5vcXR2eHt9gIKFh4qMjpCRk5SWl5iZmpucnZ6foaKjpKWnqKmqq62ur7CxsbKztLS1tba2tbW1tbW1tra2tra2tra2tra2tra2trW1tbW1tbS0tLS0tLSzs7OzsrKxsbCuraupp6Sin5uYlJGNiYaCf3x5dnNxb21ramloZ2ZmZWVlZWVlZmZnaGlqbG1vcXN1d3h6e3x8fXx8e3p5eHZ0c3Fwbm1sa2pqampqamtsbW5vcXJ0dnh6fH6Bg4WIioyOkJKTlZaXmJmam5ucnZ6foKGipKWmp6ipqqytrq+vsLGysrOztLS1s7S0tLS0tLS0tLS0tbW1tbW1tbW0tLS0tLSzs7Ozs7KysrKysrKxsbCwr66tq6mnpaOgnZqWk4+LiISBfXp3dXJwbmxraWhnZ2ZmZmVlZWZmZ2doaWtsbnBydHZ4enx9f4CBgYGBgIB/fXx6eXd2dHNycXBwb29vcHBxcnN0dXd4enx+gIKEhoiKjI6QkpOVlpeYmZmam5ycnZ6foKGio6Slpqeoqqusra2ur7CxsbKys7OzsrKzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzsrKysrKxsbGxsbGwsLCwr6+urayrqqimo6Gem5iVkY6KhoOAfHl2dHJvbWxqaWhnZ2ZmZmZmZmdnaGlqbG1vcHJ0d3l7fX+BgoSFhYaGhYWEg4GAfn17enl3dnV1dHR0dHV1dnd4eXp8fX+Bg4WHiYuNjpCSk5WWl5iZmZqam5ycnZ6fn6ChoqOlpqeoqaqrrKytrq+wsLGxsbKysbGxsbGysrKysrKysrKysrKysrKysrKxsbGxsbCwsLCwr6+vr6+urq2trKuqqKakop+dmpaTkIyJhYJ/e3h2c3FvbWxqaWhoZ2dnZ2dnaGhpamtsbnBxc3V3enx+gIKEhoeIiYqKiomIh4aFg4KBf358e3p6eXl5eXl6ent8fX5/gYKEhYeJi42OkJKTlZaXmJiZmpqbm5ycnZ2en6ChoqOkpaanqKmqq6ysra6vr7CwsLGxsLCwsLCwsLCwsbGxsbGxsbGxsbGxsbCwsLCwr6+vr6+urq6urq6traysq6qop6WjoJ6bmJWSjouIhIF+e3h1c3FvbWxqaWloaGhoaGhpaWprbG5vcXJ0dnh6fH+Bg4WHiYqLjI2NjY2MjIuJiIeFhIKBgH9+fn19fX19fn9/gIGCg4WGiImLjY6QkpOUlpeYmJmZmpqbm5ucnJ2en5+goaKjpKWmp6ipqqusrK2urq+vsLCwr6+vr6+vr6+vr6+wsLCwsLCwsLCwr6+vr6+vrq6urq6tra2traysrKuqqainpaShn52al5SRjYqHg4B9end1cnBubWxramlpaWlpaWpqa2xtb3Byc3V3eXt9f4GEhoiJi42Oj5CQkJCQj46NjIuJiIaFhIOCgYGBgYGBgYKCg4SFhoeIiouNjpCRk5SVlpeYmZmampqbm5ucnJ2dnp+goaKjpKWmp6eoqaqrrKytra6ur6+vrq+vr6+urq6urq6ur6+vr6+vr6+vrq6urq6ura2tra2srKysrKurq6qpqKempKKgnpuZlpOPjImGgn98eXd0cnBvbWxramppaWpqa2tsbW5wcXN0dnh6fH6AgoSGiIqMjY+QkZKSk5OTkpGQj46Ni4qJiIeGhYSEhISEhIWFhoaHiImKi42OkJGSlJWWl5iZmZqampqbm5ubnJydnp6foKGio6Slpqeoqamqq6ysra2urq6urq6urq6urq6urq6urq6urq6urq6urq2tra2traysrKysq6urq6uqqqmop6alo6GfnZqYlZKOi4iFgn98eXd0cnBvbWxra2pqamtrbG1ub3FydHV3eXt9foCChIaIioyOj5GSk5SUlZWVlJSTkpGQjo2Mi4qJiIeHh4eHh4eHiIiJiouMjY6PkZKTlJaXmJiZmZqampqam5ubm5ycnZ6foKGhoqOkpaanqKmqqqusrK2tra6ura2tra2tra2tra2tra2tra2tra2tra2srKysrKyrq6urq6uqqqqpqainpqWkoqCenJmWlJGOioeEgX57eXZ0cnBvbm1sbGtrbGxtbm9wcXN0dnh6e31/gYOFh4mKjI6PkZKTlZWWl5eXlpaVlJOSkZCOjYyLi4qKiYmJiYmKioqLjIyNjo+QkpOUlZaXmJmZmZqampqampqbm5ucnZ2en6ChoqOkpaamp6ipqqqrrKysra2tra2traysrKysrKysrKysrKysrKysrKysrKurq6urq6qqqqqqqampqKenpqSjoZ+dm5iWk5CNioeEgX57eXZ0cnFvbm1tbGxtbW5ub3Fyc3V3eHp8foCCg4WHiYqMjo+RkpSVlpeXmJiYmJiXlpWUk5KRkI+OjYyMjIuLi4uLjIyNjY6Pj5CRkpSVlpeXmJmZmZqampqampqam5ubnJ2enp+goaKjpKWmp6ioqaqqq6usrKytrKysrKysrKyrq6urq6urrKysrKysq6urq6urq6qqqqqqqqmpqaiop6empaOioJ6cmpeVko+MiYaDgH17eHZ0cnFwb25ubW1ubm9wcXJ0dnd5e31+gIKEhoeJi4yOj5GSk5WWl5iYmZmZmZmYmJeWlZSTkpGQj46Ojo2NjY2NjY6Oj4+QkJGSk5SVlpeYmJmZmZmampmZmZqampqbnJydnp+goaKio6SlpqeoqamqqqurrKysrKysrKurq6urq6urq6urq6urq6urq6urq6qqqqqqqqmpqampqKinp6alpKOhn52bmZaUkY6LiIWDgH17eHZ0c3Fwb29ubm9vcHFyc3R2eHl7fX+BgoSGiImLjI6PkZKTlZaXmJmZmpqampqamZiXlpWUk5KSkZCQj4+Pj4+Pj4+PkJCRkZKTlJWVlpeYmJmZmZmZmZmZmZmZmZqam5ycnZ6foKGio6SlpaanqKmpqqurq6ysq6urq6urq6urqqqqqqqqq6urq6urq6uqqqqqqqqpqampqamoqKenpqWko6Kgn52amJaTkI2LiIWCgH17eHZ1c3JxcHBvb3BwcXJzdXZ4eXt9f4GDhIaIiYuMjo+RkpOUlZeYmZmam5ubm5ubmpmZmJeWlZSTkpKRkZCQkJCQkJCQkZGSkpOTlJWWlpeYmJmZmZmZmZmZmZmZmZmampucnZ2en6ChoqOkpaanp6ipqqqrq6urq6urq6urqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqmpqampqKioqKempqWko6Ggnpyal5WSkI2Kh4WCf317eHd1c3JxcXBwcHFycnN1dnh5e31/gYOEhoiJi4yOj5CSk5SVlpeYmZqbm5ycnJycm5qamZiXlpWUlJOTkpKSkZGRkZGRkpKSk5OUlZWWl5eYmJiZmZmZmJiYmJiYmJmZmpqbnJ2en5+goaKjpKWmp6ioqaqqqqurq6urq6uqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqampqampqKiop6empaSjoqGfnZuZlpSRj4yJh4SCf317eXd1dHNycnFxcnJzdHV2eHl7fX+BgoSGiImLjI6PkJKTlJWWl5iZmpubnJydnZ2cnJubmpmYl5aWlZSUk5OTkpKSkpKSk5OTk5SUlZaWl5eYmJiYmJiYmJiYl5eXmJiYmZmam5ydnp+goaKjpKSlpqeoqamqqqqrqqurqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqampqamoqKinp6ampaSjoaCenJqYlpORjoyJhoSBf317eXd2dHNzcnJyc3N0dXZ4eXt9foCChIaHiYuMjo+QkZOUlZaXmJmZmpucnJ2dnZ2dnJybm5qZmJeXlpWVlJSUk5OTk5OTk5OUlJSVlZaWl5eXmJiYmJiYl5eXl5eXl5eYmJmZmpucnZ6foKGio6SlpqenqKmpqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqmpqamoqKinp6alpaOioZ+enJqXlZOQjouIhoOBf3x7eXd2dXRzc3NzdHR1dnh5e3x+gIKDhYeJioyNj5CRkpOUlZaXmJmam5ucnZ2dnp6dnZ2cm5qamZiXl5aWlZWVlJSUlJSUlJSUlZWVlpaWl5eXmJiYmJeXl5eWlpaWlpaXl5iZmZqbnJ2en6ChoqOkpaanqKipqaqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqpqampqKinp6alpKOioJ+dm5mXlJKPjYqIhYOBfnx7eXd2dXV0dHR0dXZ3eHl6fH5/gYOFhoiKjI2OkJGSk5SVlpeYmZqam5ycnZ2enp6enZ2cnJuampmYl5eWlpaVlZWVlZWVlZWVlZWWlpaWl5eXl5eXl5eXlpaWlZWVlZaWlpeYmJmam5ydnp+goaKjpKWmp6ioqamqqqqqqqqqqqqqqqqqqqqqqqqqq6urq6urq6qqqqqqqampqKinp6alpKOhoJ6cmpiWlJGPjIqHhYOAfnx7eXh3dnV1dXV1dnd4eXp8fX+BgoSGiImLjY6PkZKTlJWWl5iYmZqbm5ydnZ6enp6enp2dnJybmpmZmJiXl5aWlpaWlZWVlZWVlpaWlpaXl5eXl5eXl5aWlpWVlZWUlZWVlZaXl5iZmpucnZ6foKGio6SlpqeoqKmpqaqqqqqqqqqqqqqqqqqqqqurq6urq6urq6urq6qqqqmpqainp6alpKOhn56cmpiVk5GOjImHhIKAfnx7eXh3dnZ2dnZ2d3h5ent9foCCg4WHiYqMjY+QkpOUlZaXl5iZmpqbnJydnp6en5+enp6dnZybm5qZmZiYl5eXl5aWlpaWlpaWlpaWlpaXl5eXl5eWlpaVlZWUlJSUlJSUlJWWlpeYmZqbnJ2en6Cho6SlpqanqKmpqamqqqqqqqqqqqqqqqqrq6urq6usrKysrKurq6urqqqpqaiop6alpKKhn52bmZeVkpCNi4mGhIKAfnx7eXh3d3Z2dnd3eHl6e3x+f4GDhIaIiYuNjpCRkpOUlZaXmJmZmpubnJ2dnp6fn5+fn56enZ2cm5uamZmZmJiXl5eXl5eXlpaWlpaWl5eXl5eXl5aWlpWVlJSUk5OTk5OTk5SUlZaXmJmam5ydnp+goqOkpaanp6ipqampqqqqqqqqqqqqq6urq6usrKysrKysrKysrKurq6qqqamop6alpKKhn52bmZaUko+NioiGg4F/fnx7eXh4d3d3d3d4eXp7fH1/gIKEhYeJioyNj5CSk5SVlpeYmJmampucnJ2enp6fn5+fn5+enp2cnJubmpqZmZiYmJiYl5eXl5eXl5eXl5eXl5eWlpaWlZWUlJOTkpKSkpKSkpOTlJWWlpeYmpucnZ6foaKjpKWmp6eoqKmpqaqqqqqqqqurq6urrKysrK2tra2tra2trKysq6uqqqmop6alpKKgnp2amJaTkY+MioeFg4F/fXx7eXl4eHd4eHh5ent8fX6AgYOEhoiJi4yOj5GSk5SWlpeYmZqam5ucnZ2enp+fn5+fn5+fnp6dnJybm5qamZmZmZiYmJiYmJeXl5eXl5eXl5eWlpaVlZSUk5OSkpGRkZGRkZKSk5OUlZaXmJmbnJ2eoKGio6SlpqeoqKipqamqqqqqq6urq6ysrKytra2trq6urq6tra2srKyrqqmpqKalpKKgnpyamJWTkI6MiYeFgoB/fXx7enl4eHh4eHl6ent9fn+AgoOFh4iKi42PkJGTlJWWl5iZmZqbm5ycnZ6en5+foKCgoJ+fn56dnZycm5uampqZmZmZmZiYmJiYmJiXl5eXl5aWlpWVlJSTkpKRkZCQkJCQkJCRkZKTlJWWl5iZm5ydnqChoqOkpaanp6ioqamqqqqrq6urrKysra2trq6urq6urq6urq6traysq6qpqKelpKKgnpyal5WSkI2LiIaEgoB+fXt6enl4eHh5eXp6e3x9foCBg4SGh4mKjI2PkJKTlJWWl5iZmpqbnJydnZ6en5+goKCgoKCfn56enZ2cnJybm5qampqamZmZmZmYmJiYmJeXl5aWlpWUlJOSkpGQkI+Pj4+Pj4+QkJGSk5SVlpeYmZucnZ+goaKjpKWmpqeoqKmqqqqrq6ysrK2tra6urq+vr6+vr6+vr66ura2sq6qpqKelpKKgnpyZl5SSj42KiIaDgYB+fHt6eXl5eXl5eXp7fH1+f4CCg4WGiImLjI6PkZKTlZaXmJiZmpubnJydnp6fn5+goKCgoKCgn5+fnp6dnZycnJubm5qampqamZmZmZiYmJiXl5aWlZWUk5OSkZCQj46Ojo6Ojo6Oj5CQkZKTlJWXmJmbnJ2foKGipKWmpqenqKmpqqqrq6ysra2urq6vr7CwsLCwsLCwsK+vrq6trKuqqaempKKgnpuZl5SRj4yKh4WDgX99fHt6eXl5eXl5enp7fH1+gIGChIWHiIqLjY6QkZKUlZaXmJmampucnJ2dnp6fn6CgoKGhoaCgoKCfn56enZ2dnJycnJubm5uampqamZmZmJiXl5aWlZSUk5KRkJCPjo6NjY2MjY2Njo6PkJGSk5SVl5iZm5yen6Cho6SlpaanqKmpqqqrrKytra6ur6+wsLCxsbGxsbGxsLCwr66urayqqaimpKKgnpuZlpSRjoyJh4SCgH99fHt6eXl5eXl5ent8fH5/gIGDhIWHiIqLjY6QkZOUlZaXmJmam5ucnZ2enp+foKCgoaGhoaGhoKCgn5+fnp6enZ2dnJycnJubm5uampmZmZiYl5aWlZSTkpGRkI+OjY2MjIuLi4uMjI2Ojo+QkpOUlZeYmpucnp+goqOkpKWmp6ipqqurrK2trq6vr7CwsbGxsrKysrKysbGwsK+urayrqqimpKKgnpuZlpOQjouIhoSCgH58e3p5eXl5eXl5ent8fX5/gIGDhIaHiYqMjY+QkZOUlZaXmJmam5ycnZ2enp+goKChoaGhoaGhoaGhoKCgn5+fnp6enZ2dnZycnJubm5qamZiYl5aWlZSTkpGQj46NjIyLi4qKioqLi4yMjY6PkJGTlJWXmJqbnZ6foaKjpKWmp6ipqqurrK2urq+wsLGxsrKys7Ozs7OysrKxsbCvrq2rqqinpaKgnpuYlZOQjYqIhYOBf318e3p5eXh4eHl5ent8fX5/gIKDhIaHiYqMjY+QkpOUlZaYmZmam5ycnZ6en5+goKGhoaKioqKioqKhoaGgoKCgn5+fnp6enp2dnZycm5uamZmYl5aVlZOSkZCPjo2Mi4uKiYmJiYmJioqLjI2Oj5CRk5SWl5mam52eoKGio6SlpqipqqurrK2ur6+wsbGysrOzs7S0tLSzs7OysbGwr62sqqmnpaKgnZuYlZKPjYqHhYKAfn17enl4eHh4eHl5ent8fX5/gIKDhIaHiYqMjY+QkZOUlZeYmZqam5ydnZ6fn6CgoaGhoqKioqOjo6KioqKioaGhoKCgoJ+fn56enp2dnJubmpmYl5aVlJOSkZCOjYyLiomJiIiIiIiIiImKiouMjo+QkZOUlpeZmpydn6CioqOlpqeoqausra2ur7CxsbKzs7S0tLW1tbW0tLSzsrGwr66tq6mnpaOgnZuYlZKPjImGhIJ/fnx6eXh4eHd3eHh5eXp7fH5/gIGDhIaHiYqMjY+QkZOUlZeYmZqbm5ydnp6fn6CgoaGioqOjo6Ojo6Ojo6Ojo6KioqKhoaGgoKCfn56dnZybmpqZmJaVlJOSkI+OjYuKiYiIh4eGhoaHh4iIiYqLjI6PkJKTlZaYmZucnp+hoaOkpqeoqausra6vsLGxsrOztLW1tbW2trW1tbS0s7KxsK+tq6qnpaOgnZqXlJGOi4iGg4F/fXt6eXh3d3d3d3h4eXp7fH1+gIGChIWHiIqLjY6QkZOUlZaYmZqbm5ydnp6foKChoaKio6OkpKSkpKSkpKSkpKSjo6OjoqKioaGgoJ+enp2cm5qZmJeVlJORkI6NjIqJiIeHhoaFhYWFhoaHiImKi4yOj5CSlJWXmJqbnZ6goaKkpaeoqaqsra6vsLGys7S0tbW2tra2t7a2trW1tLOysa+urKqopaOgnZqXlJGOioiFgoB+fHp5eHd2dnZ2dnd4eHl6e31+f4GCg4WGiImLjI6PkZKUlZaXmZqbm5ydnp+foKGhoqKjo6SkpaWlpaWmpqalpaWlpaWkpKSjo6KioaCgn56dnJuZmJeVlJKRj46Mi4qIh4aFhYSEhISEhYWGh4iJiouMjo+RkpSWl5mbnJ6foKKjpaaoqaqsra6vsLKzs7S1tra3t7e3t7e3t7a2tbSzsbCurKqopaOgnZqXk5CNioeEgX98e3l4d3Z1dXV1dXZ3eHh6e3x9f4CBg4SGh4mKjI6PkZKTlZaXmJmbm5ydnp+goKGioqOkpKWlpqamp6enp6enp6enp6ampqWlpKSjoqKhoJ+enJuamJeVlJKQj42MiomHhoWEhIODg4ODg4SFhYaHiYqLjY6QkZOVlpiam52foKGjpaaoqaqsra6wsbKztLW2tre4uLi4uLi4uLe3trW0srGvrauopqOgnZmWk4+MiYaDgH17eXh2dXV0dHR0dHV2d3h5ent8fn+BgoSFh4iKi42PkJKTlJaXmJmam5ydnp+goaKio6Skpaamp6enqKioqampqampqaioqKenpqalpKOioaCfnZyamZeVk5KQjoyLiYiGhYSDgoKCgYKCgoODhIWGiImKjI2PkJKUlpeZm5yen6GjpKanqaqsra+wsbK0tba2t7i4ubm5ubm5ubi4t7a0s7GvrauppqOgnJmVko6LiISBf3x6eHZ1dHNzc3Nzc3R1dXZ3eXp7fX6AgYOEhoeJi4yOj5GSlJWXmJmam5ydnp+goaKjpKSlpqenqKipqaqqqqqrq6urq6qqqqmpqKenpqWkoqGgnpybmZeVk5GPjoyKiIeFhIOCgYGAgICBgYKCg4SFh4iJi4yOkJGTlZaYmpydn6GipKanqausrq+wsrO0tba3uLm5urq6urq6urm4uLe1tLKwrquppqOfnJiVkY2KhoOAfXt4dnVzcnJxcXFxcnJzdHV2d3l6e31+gIKDhYeIiouNj5CSk5WWmJmam5ydn6ChoqKjpKWmp6ioqaqqq6usrKytra2tra2srKyrqqqpqKelpKKhn52bmZeVk5GPjYuJh4aEg4KBgIB/f39/gICBgoOEhoeIiouNj5GSlJaYmZudnqCipKanqausrq+xsrO1tre4ubm6u7u7u7u7u7q5ube2tbOxrqyppqOfm5iUkIyIhYF+e3l3dXNycXBwb29wcHFycnR1dnd5enx9f4CChIWHiYuMjpCRk5SWl5iam5yen6ChoqOkpaanqKmqqqusra2urq+vr6+vr6+vrq6trayrqqinpqSioJ6cmpiWk5GPjIqIhoWDgoGAf35+fn5+f3+AgYKDhYaIiYuMjpCSk5WXmZudnqCipKWnqausrrCxsrS1tre4ubq7u7y8vLy8vLu7uri3tbOxr6yppqKfm5eTj4uHg4B8eXd0c3Fwb25ubW1ubm9wcXJzdHZ3eXp8fX+Bg4SGiIqLjY+QkpSVl5iam5yen6Cho6SlpqeoqaqrrK2urq+wsLGxsrKysrKxsbGwr66trKupp6akop+dm5iWk5GOjIqIhoSCgYB/fn19fX19fn5/gIGChIWHiIqMjY+Rk5WXmZqcnqCipKWnqautrrCxs7S2t7i5uru8vL29vb29vby8u7m4trSyr6yppqKempaRjYmFgX16d3RycG9tbGxra2tsbG1ub3BxcnR1d3h6fH5/gYOFh4iKjI6PkZOVlpiZm5yen6Cio6Smp6ipqqytrq+wsLGys7O0tLS1tbW0tLSzsrGwr62rqqilo6GenJmWk5GOjImHhYOBgH59fXx8fHx8fX1+f4CCg4SGiImLjY+RkpSWmJqcnqCipKWnqautrrCys7W2t7m6u7y9vb6+vr6+vr29vLq5t7WysK2ppaGdmZSQi4eDf3t3dHJvbWxramlpaWlpamtrbG5vcHJzdXd4enx+gIGDhYeJi42PkJKUlpeZm5yen6GipKWnqKmrrK2ur7Gys7S0tba2t7e4uLi3t7e2tbSzsbCurKqnpaKgnZqXlJGOi4mGhIKAf318fHt7e3t7fHx9fn+BgoSFh4mKjI6QkpSWmJqcnqCipKWnqautr7CytLW3uLm7vL29vr+/v8C/v7++vbu6uLWzsK2ppaGcl5OOiYSAfHh0cW9samloZ2ZmZmZnZ2hpamttbnBxc3V2eHp8foCChIaIioyOj5GTlZeZmpyeoKGjpKanqausra+wsbO0tba3uLm5urq7u7u7u7q5uLe2tbOxr6yqp6ShnpuXlJGOi4iGg4F/fnx7enp6enp6e3x8fX+AgYOFhoiKjI6QkpSWmJqcnZ+ho6Wnqautr7GytLa3ubq7vL2+v8DAwMHBwMC/vry7uLazsKyopKCblpCLhoF9eHRxbmtpZ2VkY2NjY2NkZGVmZ2lqbG1vcXN0dnh6fH6AgoSGiIuNj5GTlZaYmpyeoKKjpaepqqytr7Gys7W2t7m6u7y8vb6+vr6+vr69vLu6uLa0sq+tqqajoJyZlZGOi4iFg4B+fXt6eXl5eXl5ent8fX5/gYKEhoeJi42PkZOVl5mbnZ+ho6aoqqutr7Gztba4ubu8vb6/wMHBwsLCwcHAv727ubazsKyoo56Zk46Ig315dHBsaWdkY2FgYF9fX2BgYWJjZWZnaWttbnBydHZ4en1/gYOFh4mMjpCSlJaYmpyeoKKkpqiqq62vsbK0tre5uru9vr/AwMHCwsLCwsLBwL++vLq4trOwrammop6alpKPi4iFgoB+fHt5eXh4eHh4eXp7fH1/gIKDhYeJi42PkZOVl5mbnZ+ho6aoqqyur7Gztbe4uru9vr/AwcLCwsPDwsLBv768ubezr6umoZyWkIqEfnl0b2tnZGJgXl1cW1tbW1xdXl9gYmNlZmhqbG5wcnR2eXt9f4KEhoiLjY+RlJaYmpyeoaOlp6mrra+xs7S2uLq7vb7AwcLDxMXFxsbGxsbGxcTCwb+9ure0sK2ppaCcmJSQjIiFgn99e3p5eHd3d3d4eHl6e3x+f4GDhYaIioyOkJKVl5mbnZ+ho6aoqqyusLKztbe5ury9vsDBwsLDw8PDw8LBwL68ubazrqqkn5iSjIV/eXNuaWViX1xaWVhXV1dXV1hZWltdXmBiZGVnaWxucHJ0d3l7foCChYeKjI6Rk5WYmpyfoaOmqKqsrrCytLa4ury+v8HDxMXHyMnJysvLy8vKysnHxsTCv7y5tbGtqKOfmpaRjYmGgoB9e3l4d3d2dnZ3d3h5enx9f4CChIaIioyOkJKUlpmbnZ+ho6WoqqyusLK0tre5u7y+v8DBwsPExMTEw8PCwL68ubWxrKehm5SNhn94cmxnYl5bWFZUU1JSUlJSU1RVVlhZW11fYWNlZ2lrbnBzdXd6fH+BhIaJi46Qk5WYmp2foqSmqautsLK0tri7vb/AwsTGx8nKy83Ozs/Q0NDQz87NzMrHxcK+urayraijnpiUj4uHg4B9e3l4d3Z2dnZ2d3h5ent9foCCg4WHiYuOkJKUlpibnZ+ho6WoqqyusLK0tri5u72+v8HCw8PExMTEw8PBwL26t7OuqaOclY2FfnZwaWNeWldUUU9OTU1MTU1OT1BRU1RWWFpcXmBiZWdpbG5xc3Z4e36Ag4WIi42Qk5WYmp2goqWnqqyvsbS2uLu9v8HDxcfJy8zOz9HS09TU1dXV1dTT0tDOzMnFwb24s66oop2Xko2JhYJ/fHp4d3Z2dnZ2d3d4eXt8fn+Bg4WHiYuNj5GUlpianJ6ho6WnqqyusLK0tri5u72+v8HCw8PExMTDw8LAvru4tK+po5yUjIR7c2xlX1lVUU5LSUhHR0ZHR0hJSkxNT1FSVFdZW11gYmVnamxvcnR3enx/goWHio2QkpWYm52go6aoq66ws7W4ur2/wcTGyMrMztDS1NXW2Nna2tvb29va2djW1NHOysbBu7awqqOdl5KNiISBfnt6eHd2dnZ2d3d4eXp8fX+Bg4SGiIuNj5GTlZianJ6go6WnqauusLK0tbe5u7y+v8DBwsLDw8LCwb+9ureyraehmZGIf3ZtZV5YUk1JRkRCQUBAQEBBQkNERkdJS01PUVRWWFtdYGNlaGttcHN2eXx+gYSHio2Qk5WYm56hpKaprK+ytLe6vL/BxMbJy83Q0tTW2Nrb3d7f4OHi4uLi4eDf3dvY1NDMxsG6tK2moJmUjomFgn98enl4d3d3d3h4eXt8fX+BgoSGiIqMjpGTlZeam56goqSnqautr7Gztbe4uru9vr+/wMDAwL++vLq3s66popqSiX91bGNbU01IQ0A9Ozo5ODg4OTo7PD4/QUNFR0pMTlFTVllbXmFkZmlsb3J1eHt+gYSHio2Qk5aZnJ+ipaeqrbCztrm8vsHExsnMztHT1dja3N7g4uPl5ujp6erq6urp6Obk4d7a1dDKw7y1raafmJKNiYWBf317enl5eXl6ent9fn+Bg4SGiIqMjpCTlZeZ","colsCount":180,"valueScale":2}')},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=c(t);if(e){var i=c(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l(this,n)}}function l(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?u(t):e}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h(t,e){var n,r;return Math.abs(t-e.min)/t>.05||Math.abs(t-e.max)/t>.05?((e=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){d(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},e)).min>=1e3?(e.min/=1e3,e.max/=1e3,n="km"):n="m","".concat(e.min," – ").concat(e.max," ").concat(n," in 1 cm")):(t>=1e3?(t/=1e3,r="km"):r="m","".concat(t," ").concat(r," in 1 cm"))}n(7),n(10),n(11),n(16),n(46),n(22),n(1),n(2),n(28),n(62),n(19),n(59),n(96),n(35),n(34),n(29),n(0),n(39),n(4),n(5),n(23),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.OverlayScale=void 0;var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(c,t);var e,n,r,l=s(c);function c(){var t;i(this,c);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return d(u(t=l.call.apply(l,[this].concat(n))),"fontSizeMm",3),d(u(t),"font","verdana"),d(u(t),"paddingMm",1),d(u(t),"overlaySolid",!0),t}return e=c,(n=[{key:"_drawRaster",value:function(t,e){var n=t.getContext("2d"),r=h(e.scale,function(t){var e=t.destPixelSize.divideBy(t.resolution/25.4),n=t.latLngBounds,r=n.getSouthEast().distanceTo(n.getSouthWest()),i=n.getNorthEast().distanceTo(n.getNorthWest()),o=Math.round(i/e.x*10),a=Math.round(r/e.x*10);return{min:Math.min(o,a,t.scale),max:Math.max(o,a,t.scale)}}(e));e.pagesCount>1&&(r+=" | Page ".concat(e.pageLabel," / ").concat(e.pagesCount));var i=this.fontSizeMm/25.4*e.resolution,o=this.paddingMm/25.4*e.resolution;n.font="".concat(i,"px ").concat(this.font);var a=n.measureText(r).width;n.textBaseline="bottom",n.fillStyle="rgba(255, 255, 255, 0.7)",n.fillRect(0,0,a+2*o,i+2*o),n.fillStyle="#000000",n.fillText(r,o,i+o)}}])&&o(e.prototype,n),r&&o(e,r),c}(n(215).PrintStaticLayer);e.OverlayScale=p},function(t,e,n){"use strict";n(7),n(10),n(11),n(16),n(15),n(13),n(1),n(8),n(2),n(24),n(6),n(50),n(28),n(19),n(35),n(29),n(0),n(20),n(39),n(4),n(5),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.Grid=void 0,n(30);var r,i=n(215),o=(r=n(9))&&r.__esModule?r:{default:r};function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}function l(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=v(t);if(e){var i=v(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}function p(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?m(t):e}function m(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(p,t);var e,n,r,i,a,u=h(p);function p(){var t;c(this,p);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return y(m(t=u.call.apply(u,[this].concat(n))),"minGridIntervalMm",15),y(m(t),"fontSizeMm",3),y(m(t),"font","verdana"),y(m(t),"paddingMm",1),y(m(t),"intervals",[1,1.5,2,3.3,5,7.5,10,15,20,33,50,75,100,150,200,333,500,750,1e3,1500,2e3,4e3,5e3,7500,1e4,15e3,2e4,4e4,5e4,75e3,1e5,15e4,2e5,4e5,5e5,75e4,1e6,15e5,2e6,4e6,5e6,75e5]),t}return e=p,(n=[{key:"getGridInterval",value:function(t){var e,n,r=this.minGridIntervalMm/10*t.scale,i=l(this.intervals);try{for(i.s();!((n=i.n()).done||(e=n.value)>r););}catch(t){i.e(t)}finally{i.f()}return e}},{key:"formatDistance",value:function(t){var e;return t<1e3?e="m":(t/=1e3,e="km"),t%1&&(t=t.toFixed(1)),"".concat(t," ").concat(e)}},{key:"_drawGrid",value:function(t,e){var n=o.default.Projection.SphericalMercator.R*Math.PI/180,r=t.getContext("2d");r.beginPath();for(var i=1/25.4*e.resolution,a=this.getGridInterval(e),s=e.destPixelSize.x,u=e.destPixelSize.y,c=o.default.bounds(o.default.Projection.SphericalMercator.project(e.latLngBounds.getNorthWest()),o.default.Projection.SphericalMercator.project(e.latLngBounds.getSouthEast())),f=c.getSize().unscaleBy(e.destPixelSize),d=[],h=u;;){var p=c.max.y-h*f.y,m=o.default.Projection.SphericalMercator.unproject(o.default.point(0,p)).lat;if(d.push({lat:m,y:h}),h<0)break;var v=m+a/n,y=o.default.Projection.SphericalMercator.project(o.default.latLng(v,0)).y;h=(c.max.y-y)/f.y}for(var g=.15*i,b=0,w=[{color:"#D9D9D9",offset:g/2},{color:"#8C8C8C",offset:-g/2}];b<w.length;b++){var k=w[b],_=k.color,S=k.offset;r.beginPath(),r.lineWidth=g,r.strokeStyle=_;var x,O=l(d);try{for(O.s();!(x=O.n()).done;)h=x.value.y,r.moveTo(0,h+S),r.lineTo(s,h+S)}catch(t){O.e(t)}finally{O.f()}for(var P=e.destPixelSize.x/2,L=0,C=[-1,1];L<C.length;L++)for(var M=C[L],j=0;;){var T,D=!0,q=!1,E=l(d);try{for(E.s();!(T=E.n()).done;){var I=T.value,A=I.lat,R=I.y,F=j*a/Math.cos(A*Math.PI/180)/f.x;F<P&&(q=!0),D?r.moveTo(P+F*M+S,R):r.lineTo(P+F*M+S,R),D=!1}}catch(t){E.e(t)}finally{E.f()}if(!q)break;j+=1}r.stroke()}}},{key:"_drawLabel",value:function(t,e){var n=this.getGridInterval(e),r=e.destPixelSize.y,i=t.getContext("2d"),o="Grid "+this.formatDistance(n),a=this.fontSizeMm/25.4*e.resolution,s=this.paddingMm/25.4*e.resolution;i.font="".concat(a,"px ").concat(this.font);var l=i.measureText(o).width;i.textBaseline="bottom",i.fillStyle="rgba(255, 255, 255, 0.7)",i.fillRect(0,r-a-2*s,l+2*s,a+2*s),i.fillStyle="#000000",i.fillText(o,s,r-s)}},{key:"getTilesInfo",value:(i=regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{iterateTilePromises:regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,{tilePromise:Promise.resolve({draw:function(t){return n._drawGrid(t,e)},isOverlay:!0,overlaySolid:!1}),abortLoading:function(){}};case 2:return t.next=4,{tilePromise:Promise.resolve({draw:function(t){return n._drawLabel(t,e)},isOverlay:!0,overlaySolid:!0}),abortLoading:function(){}};case 4:case"end":return t.stop()}}),t)})).bind(this),count:2});case 1:case"end":return t.stop()}}),t,this)})),a=function(){var t=this,e=arguments;return new Promise((function(n,r){var o=i.apply(t,e);function a(t){s(o,n,r,a,l,"next",t)}function l(t){s(o,n,r,a,l,"throw",t)}a(void 0)}))},function(t){return a.apply(this,arguments)})}])&&f(e.prototype,n),r&&f(e,r),p}(i.PrintStaticLayer);e.Grid=g},function(t,e,n){"use strict";var r,i=(r=n(9))&&r.__esModule?r:{default:r};n(417),n(68),i.default.Control.Caption=i.default.Control.extend({options:{position:"bottomright",className:"leaflet-control-caption"},initialize:function(t,e){i.default.setOptions(this,e),this._contents=t},onAdd:function(t){return this._map=t,this._container=i.default.DomUtil.create("div",this.options.className),this._container.innerHTML=this._contents,i.default.DomEvent.on(this._container,"contextmenu",(function(t){return i.default.DomEvent.stopPropagation(t),t.returnValue=!0,!0})),this._container},setContents:function(t){this._contents=t,this._map&&(this._container.innerHTML=this._contents)}})},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n(7),n(10),n(11),n(16),n(46),n(22),n(15),n(13),n(1),n(18),n(8),n(2),n(6),n(62),n(19),n(59),n(96),n(34),n(0),n(4),n(5),n(148),n(23),n(3);var i=d(n(9)),o=d(n(121));n(419);var a=d(n(216)),s=d(n(147)),l=n(68),u=d(n(149));n(122);var c=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var e=f();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var a=i?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=t[o]}n.default=t,e&&e.set(t,n);return n}(n(421));function f(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return f=function(){return t},t}function d(t){return t&&t.__esModule?t:{default:t}}function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function p(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){m(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return y(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var g=c.DEGREES,b={lat:"-------",lng:"-------"};i.default.Control.Coordinates=i.default.Control.extend({options:{position:"bottomleft"},formats:[c.SIGNED_DEGREES,c.DEGREES,c.DEGREES_AND_MINUTES,c.DEGREES_AND_MINUTES_AND_SECONDS],initialize:function(t){var e=this;i.default.Control.prototype.initialize.call(this,t),this.latlng=o.default.observable(),this.format=o.default.observable(g),this.formatCode=o.default.pureComputed({read:function(){return e.format().code},write:function(t){var n,r=v(e.formats);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t===i.code){e.format(i);break}}}catch(t){r.e(t)}finally{r.f()}}}),this.formattedCoordinates=o.default.pureComputed((function(){return e.latlng()?c.formatLatLng(e.latlng().wrap(),e.format()):b}),this),this.wrapperClass=o.default.pureComputed((function(){return e.format().wrapperClass}),this),this.formatCode.subscribe(this.saveStateToStorage,this)},onAdd:function(t){var e=(0,l.makeButtonWithBar)("leaflet-contol-coordinates","Показать координаты под курсором","icon-coordinates"),n=e.container,r=e.link,a=e.barContainer;return this._map=t,this._container=n,this._link=r,a.innerHTML='\n                <div data-bind="css: wrapperClass">\n                    <div class="leaflet-coordinates-container" data-bind="with: formattedCoordinates()">\n                        <span class="leaflet-coordinates-latitude" data-bind="html: lat"></span>\n                        <span class="leaflet-coordinates-longitude" data-bind="html: lng"></span>\n                    </div>\n                    <hr class="leaflet-coordinates-divider" />\n                    <div data-bind="foreach: formats">\n                        <div>\n                            <label title="">\n                                <input type="radio" data-bind="checked: $parent.formatCode, value: code" \n                                       class="leaflet-coordinates-format-radio"/>\n                                <span data-bind="html: label"></span>\n                            </label>\n                        </div>\n                    </div>\n                </div>\n            ',a.title="Правый клик для копирования координат",this.loadStateFromStorage(),o.default.applyBindings(this,n),i.default.DomEvent.on(r,"click",this.onClick,this),n},onRemove:function(){i.default.DomEvent.off(this._link,"click",this.onClick,this)},loadStateFromStorage:function(){var t="1"===u.default.leafletCoordinatesActive,e=u.default.leafletCoordinatesFmt||g.code;this.formatCode(e),this.setEnabled(t)},saveStateToStorage:function(){u.default.leafletCoordinatesActive=this.isEnabled()?"1":"0",u.default.leafletCoordinatesFmt=this.formatCode()},onMouseMove:function(t){this.latlng(t.latlng)},setEnabled:function(t){if(Boolean(t)!==this.isEnabled()){var e=t?"addClass":"removeClass",n=t?"on":"off";i.default.DomUtil[e](this._container,"active"),i.default.DomUtil[e](this._container,"highlight"),i.default.DomUtil[e](this._map._container,"coordinates-control-active"),this._map[n]("mousemove",this.onMouseMove,this),this._map[n]("contextmenu",this.onMapRightClick,this),this._isEnabled=Boolean(t),this.latlng(null)}},onMapRightClick:function(t){function e(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=c.formatLatLng(t.latlng.wrap(),e),i=r.lat,o=r.lng,s="".concat(i," ").concat(o);return p({text:"".concat(s,' <span class="leaflet-coordinates-menu-fmt">').concat(e.label,"</span>"),callback:function(){return(0,a.default)(s,t.originalEvent)}},n)}i.default.DomEvent.stop(t);var n=e(this.format(),{text:"<b>Скопировать в буфер обмена</b>",header:!0}),r=this.formats.map((function(t){return e(t)}));r.unshift(n,"-"),new s.default(r).show(t)},isEnabled:function(){return Boolean(this._isEnabled)},onClick:function(){this.setEnabled(!this.isEnabled()),this.saveStateToStorage()}})},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";function r(t,e){var n=t.toString(),r=n.indexOf(".");-1===r&&(r=n.length,n+=".");var i=r+e;return e>0&&(n=n.padEnd(r+e+1,"0"),i+=1),n=n.slice(0,i)}function i(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(t<0)throw new Error("Negative values not supported");return n>0&&(e+=1),r(t,n).padStart(e+n,"0")}function o(t,e){var n,r=Math.abs(t),o=Math.floor(r),a=60*(r-o),s=Math.floor(a),l=60*(a-s);return n=e?t<0?"S":"N":t<0?"W":"E",{signedDegrees:t.toFixed(5),degrees:i(r,0,5),intDegrees:i(o,0),minutes:i(a,2,3),intMinutes:i(s,2),seconds:i(l,2,2),direction:n}}n(16),n(45),n(8),n(2),n(50),n(0),n(4),n(422),n(286),Object.defineProperty(e,"__esModule",{value:!0}),e.formatLatLng=function(t,e){return{lat:e.formatter(o(t.lat,!0)),lng:e.formatter(o(t.lng,!1))}},e.DEGREES_AND_MINUTES_AND_SECONDS=e.DEGREES_AND_MINUTES=e.DEGREES=e.SIGNED_DEGREES=void 0;e.SIGNED_DEGREES={code:"d",label:"±ddd.ddddd",wrapperClass:"leaflet-coordinates-wrapper-signed-degrees",formatter:function(t){return t.signedDegrees}};e.DEGREES={code:"D",label:"ddd.ddddd°",wrapperClass:"leaflet-coordinates-wrapper-degrees",formatter:function(t){var e=t.degrees,n=t.direction;return"".concat(n," ").concat(e,"°")}};e.DEGREES_AND_MINUTES={code:"DM",label:"ddd°mm.mmm′",wrapperClass:"leaflet-coordinates-wrapper-degrees-and-minutes",formatter:function(t){var e=t.intDegrees,n=t.minutes,r=t.direction;return"".concat(r," ").concat(e,"°").concat(n,"′")}};e.DEGREES_AND_MINUTES_AND_SECONDS={code:"DMS",label:"ddd°mm′ss.s″",wrapperClass:"leaflet-coordinates-wrapper-degrees-and-minutes-and-seconds",formatter:function(t){var e=t.intDegrees,n=t.intMinutes,r=t.seconds,i=t.direction;return"".concat(i," ").concat(e,"°").concat(n,"′").concat(r,"″")}}},,function(t,e,n){"use strict";n(7),n(10),n(11),n(15),n(65),n(13),n(1),n(8),n(2),n(6),n(0),n(4),n(5),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n(9))&&r.__esModule?r:{default:r};function o(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||s(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=s(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function s(t,e){if(t){if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t){if(!t||!t.options)return null;var e=t.options.hotkey;return e||((e=t.options.code)&&1===e.length?e:null)}function c(t,e){if(e.options){var n=u(e);n&&(t+='<span class="layers-control-hotkey">'.concat(n,"</span>"))}return t}n(424);var f=function(t){var e=t.onAdd,n=t.onRemove,r=t._addItem;if(t._hotKeysEnabled)return t;i.default.Util.extend(t,{_hotKeysEnabled:!0,_addItem:function(t){return i.default.Browser.touch&&i.default.Browser.mobile||((t=i.default.Util.extend({},t)).name=c(t.name,t.layer)),r.call(this,t)},onAdd:function(t){var n=e.call(this,t);return this._addHotketEvents(),n},onRemove:function(t){i.default.DomEvent.off(document,"keyup",this._onHotkeyUp,this),i.default.DomEvent.off(document,"keydown",this.onKeyDown,this),n.call(this,t)},_addHotKetEvents:function(){i.default.DomEvent.on(document,"keyup",this._onHotkeyUp,this),i.default.DomEvent.on(document,"keydown",this.onKeyDown,this)},onKeyDown:function(t){t.altKey||t.ctrlKey||t.shiftKey||(this._keyDown=t.keyCode)},_onHotkeyUp:function(t){var e=this._keyDown;this._keyDown=null;var n=t.target.tagName.toLowerCase();if(!("input"===n&&["text","search"].includes(t.target.type)||"textarea"===n||e!==t.keyCode)){var r,s=String.fromCharCode(t.keyCode),l=a(this._layers);try{for(l.s();!(r=l.n()).done;){var c=r.value,f=i.default.stamp(c.layer);if(u(c.layer)===s){for(var d=this._container.getElementsByTagName("input"),h=0,p=o(d);h<p.length;h++){var m=p[h];if(m.layerId===f){m.click();break}}break}}}catch(t){l.e(t)}finally{l.f()}}}});var s,l=a(t._layers);try{for(l.s();!(s=l.n()).done;){var f=s.value;f.name=c(f.name,f.layer)}}catch(t){l.e(t)}finally{l.f()}return t._addHotKetEvents(),t._update(),t};e.default=f},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";n(2),n(50),n(0),n(54),n(53),n(4);var r,i=(r=n(9))&&r.__esModule?r:{default:r};n(128),i.default.Map.include(i.default.Mixin.HashState),i.default.Map.include({stateChangeEvents:["moveend"],serializeState:function(){var t=this.getCenter();return[this.getZoom().toString(),t.lat.toFixed(5),t.lng.toFixed(5)]},validateState:function(t){if(!t||3!==t.length)return{valid:!1};var e=parseInt(t[0],10),n=parseFloat(t[1]),r=parseFloat(t[2]);return isNaN(e)||isNaN(n)||isNaN(r)||e<0||e>32||n<-90||n>90?{valid:!1}:{lat:n,lng:r,zoom:e,valid:!0}},unserializeState:function(t){var e=this.validateState(t),n=e.lat,r=e.lng,i=e.zoom;return!!e.valid&&(this.setView([n,r],i),!0)}})},function(t,e,n){"use strict";n(7),n(10),n(11),n(15),n(65),n(13),n(1),n(18),n(8),n(98),n(2),n(6),n(0),n(4),n(106),n(5),n(3);var r,i=(r=n(9))&&r.__esModule?r:{default:r};function o(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw o}}}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n(128),i.default.Control.Layers.include(i.default.Mixin.HashState),i.default.Control.Layers.include({stateChangeEvents:["baselayerchange","overlayadd","overlayremove"],stateChangeEventsSource:"_map",serializeState:function(){var t=[];return this._map.eachLayer((function(e){var n=e.options.code;n&&t.push([n,e.options.zIndex])})),t.sort((function(t,e){return t[1]-e[1]})),t.map((function(t){return t[0]}))},unserializeState:function(t){if(!t||0===t.length)return!1;var e,n,r=o(this._layers);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.layer.options&&t.includes(i.layer.options.code)&&!i.overlay){e=!0;break}}}catch(t){r.e(t)}finally{r.f()}if(!e)return!1;var a,s=o(this._layers);try{for(s.s();!(a=s.n()).done;){var l=a.value;l.layer.options&&t.includes(l.layer.options.code)?this._map.addLayer(l.layer):this._map.removeLayer(l.layer)}}catch(t){s.e(t)}finally{s.f()}return!0}})},function(t,e,n){"use strict";n(116),n(2),n(25),Object.defineProperty(e,"__esModule",{value:!0}),e.fixAll=function(){(function(){if(!i.default.Browser.chrome)return;if(i.default.PosAnimation.prototype.__panAnimationFixed)return;var t=i.default.PosAnimation.prototype._step;i.default.PosAnimation.prototype._step=function(){return t.call(this,!0)},i.default.PosAnimation.prototype.__panAnimationFixed=!0})(),i.default.Browser.touch&=navigator.pointerEnabled&&!i.default.Browser.ie||navigator.maxTouchPoints,e=i.default.Map.prototype._handleDOMEvent,i.default.Map.prototype._handleDOMEvent=function(t){"keypress"===t.type&&13===t.keyCode?this._fireDOMEvent(t,t.type):e.call(this,t)},function(){if(i.default.Renderer.__animationFixed)return;var t=300,e=i.default.Renderer.prototype.getEvents;function n(){var e=Date.now();!this._lastReset||e-this._lastReset>t?(this._reset(),this._lastReset=e):i.default.Renderer.prototype._onZoom.call(this)}function r(){var e=Date.now();(!this._lastReset||e-this._lastReset>t)&&(this._reset(),this._lastReset=e)}function o(){var t=e.call(this);return t.move=r,t.zoom=n,t}i.default.Renderer.prototype.getEvents=o,i.default.Renderer.__animationFixed=!0}(),(0,o.fixVectorMarkerWorldJump)(),t=i.default.Control.prototype.addTo,i.default.Control.prototype.addTo=function(e){var n=t.call(this,e);return this.options.stackHorizontally&&i.default.DomUtil.addClass(this._container,"leaflet-control-horizontal-stack"),n},function(){var t=i.default.Layer.prototype._openTooltip;i.default.Layer.prototype._openTooltip=function(e){if(this._tooltip.options.delay){var n=this;this._pendingTooltip=setTimeout((function(){return t.call(n,e)}),this._tooltip.options.delay)}else t.call(this,e)};var e=i.default.Layer.prototype.closeTooltip;i.default.Layer.prototype.closeTooltip=function(){clearInterval(this._pendingTooltip),e.call(this)}}();var t;var e};var r,i=(r=n(9))&&r.__esModule?r:{default:r};n(428);var o=n(170)},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";n(7),n(10),n(11),n(16),n(15),n(65),n(13),n(1),n(8),n(2),n(24),n(6),n(0),n(20),n(4),n(431),n(106),n(5),n(148),n(3),n(25),n(30);var r=f(n(9)),i=f(n(121));n(128),n(432),n(122);var o=n(68),a=f(n(433)),s=f(n(442)),l=n(290),u=n(268),c=f(n(149));function f(t){return t&&t.__esModule?t:{default:t}}function d(t){return function(t){if(Array.isArray(t))return y(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||v(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}function p(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){h(o,r,i,a,s,"next",t)}function s(t){h(o,r,i,a,s,"throw",t)}a(void 0)}))}}function m(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=v(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function v(t,e){if(t){if("string"==typeof t)return y(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(t,e):void 0}}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var g,b,w=r.default.Marker.extend({options:{zIndexOffset:1e4},initialize:function(){var t=r.default.divIcon({className:"leaflet-panorama-marker-wraper",html:'<div class="leaflet-panorama-marker"></div>'});r.default.Marker.prototype.initialize.call(this,[0,0],{icon:t,interactive:!1})},getIcon:function(){var t=this.getElement();return t=t.children[0]},setHeading:function(t){this.getIcon().style.transform="rotate(".concat(t||0,"deg)")},setType:function(t){var e={slim:"leaflet-panorama-marker-circle",normal:"leaflet-panorama-marker-binocular"}[t];this.getIcon().className=e}});r.default.Control.Panoramas=r.default.Control.extend({includes:r.default.Evented,options:{position:"topleft",splitVerically:!0,splitSizeFraction:.5,minViewerSize:30},getProviders:function(){return[{name:"wikimedia",title:"Фотки Wikimedia",provider:s.default,layerOptions:{opacity:.7,zIndex:9},code:"w",selected:i.default.observable(!0),mapMarkerType:"slim"},{name:"mapillary",title:"Панорамы Mapillary",provider:a.default,layerOptions:{opacity:.7,zIndex:8},code:"m",selected:i.default.observable(!1),mapMarkerType:"normal"}]},initialize:function(t){r.default.Control.prototype.initialize.call(this,t),this.loadSettings(),this._panoramasContainer=r.default.DomUtil.create("div","panoramas-container"),(0,u.onElementResize)(this._panoramasContainer,r.default.Util.requestAnimFrame.bind(null,this.onContainerResize.bind(this))),this.providers=this.getProviders();var e,n=m(this.providers);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.selected.subscribe(this.updateCoverageVisibility,this),i.container=r.default.DomUtil.create("div","panorama-container",this._panoramasContainer)}}catch(t){n.e(t)}finally{n.f()}this.nearbyPoints=[]},loadSettings:function(){var t,e,n,r;try{r=JSON.parse(c.default.panoramaSettings)}catch(t){}this._splitVerically=null!==(t=null===(e=r)||void 0===e?void 0:e.spitVertically)&&void 0!==t?t:this.options.splitVerically;var i=null===(n=r)||void 0===n?void 0:n.splitSizeFraction;this._splitSizeFraction=isNaN(i)?this.options.splitSizeFraction:i},saveSetting:function(){c.default.panoramaSettings=JSON.stringify({spitVertically:this._splitVerically,splitSizeFraction:this._splitSizeFraction})},onAdd:function(t){this._map=t,this._splitterDragging=!1;var e=r.default.DomUtil.create("div","panorama-splitter",this._panoramasContainer);r.default.DomUtil.create("div","splitter-border",e);var n=r.default.DomUtil.create("div","button",e);new l.DragEvents(e,null,{trackOutsideElement:!0}).on({dragstart:this.onSplitterDragStart,dragend:this.onSplitterDragEnd,drag:this.onSplitterDrag},this),new l.DragEvents(n,null,{trackOutsideElement:!0}).on({click:this.onSplitterClick},this),this.setupViewerLayout();var a=(0,o.makeButtonWithBar)("leaflet-contol-panoramas","Панорамы и фотки (Alt-P)","icon-panoramas"),s=a.container,u=a.link,c=a.barContainer;return t.on("resize",this.onMapResize,this),this._container=s,r.default.DomEvent.on(u,"click",this.onButtonClick,this),r.default.DomEvent.on(document,"keyup",this.onKeyUp,this),c.innerHTML='\n                 <div class="panoramas-list" data-bind="foreach: providers">\n                     <div>\n                         <label>\n                             <input type="checkbox" data-bind="checked: selected"><span data-bind="text: title"></span>\n                         </label>\n                     </div>\n                 </div>\n             ',i.default.applyBindings(this,s),t.createPane("rasterOverlay").style.zIndex=300,s},onSplitterDrag:function(t){var e=this.options.minViewerSize,n=this._panoramasContainer[this._splitVerically?"offsetWidth":"offsetHeight"],r=n+t.dragMovement[this._splitVerically?"x":"y"],i=this._map._container[this._splitVerically?"offsetWidth":"offsetHeight"];r<e&&(r=this.options.minViewerSize);var o=n+i-e;r>o&&(r=o),this.setContainerSizePixels(r)},onSplitterClick:function(){this._splitVerically=!this._splitVerically,this.saveSetting(),this.setupViewerLayout()},onButtonClick:function(){this.switchControl()},switchControl:function(){this.controlEnabled?this.disableControl():this.enableControl()},onKeyUp:function(t){t.keyCode==="P".codePointAt(0)&&t.altKey&&this.switchControl()},enableControl:function(){this.controlEnabled||(this.controlEnabled=!0,r.default.DomUtil.addClass(this._container,"active"),this.updateCoverageVisibility(),this._map.on("click",this.onMapClick,this),r.default.DomUtil.addClass(this._map._container,"panoramas-control-active"),this.notifyChanged())},disableControl:function(){this.controlEnabled&&(this.controlEnabled=!1,r.default.DomUtil.removeClass(this._container,"active"),this.updateCoverageVisibility(),this._map.off("click",this.onMapClick,this),this.hidePanoViewer(),r.default.DomUtil.removeClass(this._map._container,"panoramas-control-active"),this.notifyChanged())},updateCoverageVisibility:function(){if(this._map){var t,e=m(this.providers);try{for(e.s();!(t=e.n()).done;){var n=t.value;if(this.controlEnabled&&n.selected()){if(!n.coverageLayer){var i=r.default.extend({pane:"rasterOverlay"},n.layerOptions);n.coverageLayer=n.provider.getCoverageLayer(i)}n.coverageLayer.addTo(this._map)}else n.coverageLayer&&this._map.removeLayer(n.coverageLayer)}}catch(t){e.e(t)}finally{e.f()}this.notifyChanged()}},showPanoramaContainer:function(){r.default.DomUtil.addClass(this._panoramasContainer,"enabled")},panoramaVisible:function(){if(r.default.DomUtil.hasClass(this._panoramasContainer,"enabled")){var t,e=m(this.providers);try{for(e.s();!(t=e.n()).done;){var n=t.value;if(r.default.DomUtil.hasClass(n.container,"enabled"))return n}}catch(t){e.e(t)}finally{e.f()}}return!1},setupNearbyPoints:function(t){var e,n=m(this.nearbyPoints);try{for(n.s();!(e=n.n()).done;){var i=e.value;this._map.removeLayer(i)}}catch(t){n.e(t)}finally{n.f()}if(this.nearbyPoints=[],t){var o,a=r.default.divIcon({className:"leaflet-panorama-marker-point"}),s=m(t);try{for(s.s();!(o=s.n()).done;){var l=o.value;this.nearbyPoints.push(r.default.marker(l,{icon:a}).addTo(this._map))}}catch(t){s.e(t)}finally{s.f()}}},hidePano:function(t){r.default.DomUtil.removeClass(t.container,"enabled"),t.viewer&&t.viewer.deactivate(),this.setupNearbyPoints()},showPano:(b=p(regeneratorRuntime.mark((function t(e,n){var i,o,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.showPanoramaContainer(),i=m(this.providers);try{for(i.s();!(o=i.n()).done;)(a=o.value)!==e&&this.hidePano(a)}catch(t){i.e(t)}finally{i.f()}if(r.default.DomUtil.addClass(e.container,"enabled"),e.viewer){t.next=9;break}return t.next=7,e.provider.getViewer(e.container);case 7:e.viewer=t.sent,this.setupViewerEvents(e);case 9:n&&setTimeout((function(){return e.viewer.showPano(n)}),0),e.viewer.activate(),this.notifyChanged();case 12:case"end":return t.stop()}}),t,this)}))),function(t,e){return b.apply(this,arguments)}),setupViewerEvents:function(t){t.viewer.on({change:this.onPanoramaChangeView.bind(this,t),closeclick:this.onPanoramaCloseClick},this)},hidePanoViewer:function(){var t,e=m(this.providers);try{for(e.s();!(t=e.n()).done;){var n=t.value;this.hidePano(n)}}catch(t){e.e(t)}finally{e.f()}r.default.DomUtil.removeClass(this._panoramasContainer,"enabled"),this.hideMarker(),this.notifyChanged()},placeMarker:function(t,e){this.panoramaVisible()&&(this.marker||(this.marker=new w),this._map.addLayer(this.marker),this.marker.setLatLng(t),this.marker.setHeading(e))},hideMarker:function(){this.marker&&this._map.removeLayer(this.marker)},notifyChanged:function(){this._map.fire("panoramachanged")},onPanoramaChangeView:function(t,e){this._map.getBounds().pad(-.05).contains(e.latlng)||this._map.panTo(e.latlng),this.placeMarker(e.latlng,e.heading),this.marker.setType(t.mapMarkerType),this.setupNearbyPoints(e.latlngs),this.notifyChanged()},onPanoramaCloseClick:function(){this.hidePanoViewer()},onMapClick:(g=p(regeneratorRuntime.mark((function t(e){var n,r,i,o,a,s,l,u,c,f,d,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=this._map.project(e.latlng).add([24,0]),r=e.latlng.distanceTo(this._map.unproject(n)),i=[],o=m(this.providers);try{for(o.s();!(a=o.n()).done;)(s=a.value).selected()&&i.push({promise:s.provider.getPanoramaAtPos(e.latlng,r),provider:s})}catch(t){o.e(t)}finally{o.f()}l=0,u=i;case 4:if(!(l<u.length)){t.next=15;break}return c=u[l],f=c.promise,d=c.provider,t.next=8,f;case 8:if(!(h=t.sent).found){t.next=12;break}return this.showPano(d,h.data),t.abrupt("return");case 12:l++,t.next=4;break;case 15:case"end":return t.stop()}}),t,this)}))),function(t){return g.apply(this,arguments)}),setupViewerLayout:function(){var t;this._splitVerically?(r.default.DomUtil.addClass(this._panoramasContainer,"split-vertical"),r.default.DomUtil.removeClass(this._panoramasContainer,"split-horizontal"),t="left",this._panoramasContainer.style.height="100%"):(r.default.DomUtil.addClass(this._panoramasContainer,"split-horizontal"),r.default.DomUtil.removeClass(this._panoramasContainer,"split-vertical"),t="top",this._panoramasContainer.style.width="100%"),this._map.addElementToSidebar(t,this._panoramasContainer),this.updateContainerSize()},setContainerSizePixels:function(t){var e=this;t=Math.round(t),this._panoramasContainer.style[this._splitVerically?"width":"height"]="".concat(t,"px"),setTimeout((function(){var n=e._map._container[e._splitVerically?"offsetWidth":"offsetHeight"];e._splitSizeFraction=t/(n+t),e.saveSetting()}),0)},updateContainerSize:function(){var t=this._splitSizeFraction,e=this._panoramasContainer,n=e[this._splitVerically?"offsetWidth":"offsetHeight"],r=this._map._container[this._splitVerically?"offsetWidth":"offsetHeight"],i=Math.round(t*(r+n));e.style[this._splitVerically?"width":"height"]="".concat(i,"px")},onContainerResize:function(){var t=this.panoramaVisible();t&&t.viewer&&t.viewer.invalidateSize()},onMapResize:function(){this._splitterDragging||this.updateContainerSize()},onSplitterDragStart:function(){this._splitterDragging=!0},onSplitterDragEnd:function(){this._splitterDragging=!1}}),r.default.Control.Panoramas.include(r.default.Mixin.HashState),r.default.Control.Panoramas.include({stateChangeEvents:["panoramachanged"],serializeState:function(){var t=null;if(this.controlEnabled){t=[];var e,n="_",r=m(this.providers);try{for(r.s();!(e=r.n()).done;){var i=e.value;i.selected()&&(n+=i.code)}}catch(t){r.e(t)}finally{r.f()}t.push(n);var o=this.panoramaVisible();if(o&&o.viewer){var a,s=o.viewer.getState();if(s)t.push(o.code),(a=t).push.apply(a,d(s))}}return t},unserializeState:function(t){var e=this;if(!t)return this.disableControl(),!0;var n=t[0];if(!n||"_"!==n[0])return!1;this.enableControl();var r,i=m(this.providers);try{for(i.s();!(r=i.n()).done;){var o=r.value;o.selected(n.includes(o.code))}}catch(t){i.e(t)}finally{i.f()}if(t.length>2){var a,s=t[1],l=m(this.providers);try{var u=function(){var n=a.value;if(s===n.code)return e.showPano(n).then((function(){n.viewer.setState(t.slice(2))||e.hidePanoViewer()})),"break"};for(l.s();!(a=l.n()).done;){if("break"===u())break}}catch(t){l.e(t)}finally{l.f()}}return!0}}),r.default.Control.Panoramas.hashStateUpgrader=function(t){return r.default.Util.extend({},r.default.Mixin.HashState,{unserializeState:function(e){if(e){var n=["_g"];e.length&&n.push.apply(n,["g"].concat(d(e))),setTimeout((function(){return t.unserializeState(n)}),0)}return!1},serializeState:function(){return null}})}},,function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";n(16),n(24),n(50),n(0),n(54),n(20),n(25),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n(30);var r=l(n(9)),i=n(434),o=n(67),a=l(n(111));n(440);var s=n(441);function l(t){return t&&t.__esModule?t:{default:t}}function u(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}function c(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){u(o,r,i,a,s,"next",t)}function s(t){u(o,r,i,a,s,"throw",t)}a(void 0)}))}}function f(){return new Promise((function(t){n.e(3).then(function(){n(317),t(n(316))}.bind(null,n)).catch(n.oe)}))}function d(){return(d=c(regeneratorRuntime.mark((function t(e,n){var r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="https://a.mapillary.com/v3/images?"+"client_id=".concat(a.default.mapillary,"&closeto=").concat(e.lng,",").concat(e.lat,"&radius=").concat(n),t.next=3,(0,o.fetch)(r,{responseType:"json",timeout:1e4});case 3:if(200!==(i=t.sent).status||!i.responseJSON.features.length){t.next=6;break}return t.abrupt("return",{found:!0,data:i.responseJSON.features[0].properties.key});case 6:return t.abrupt("return",{found:!1});case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var h=r.default.Evented.extend({includes:[s.CloseButtonMixin,s.DateLabelMixin],initialize:function(t,e){var n="container-".concat(r.default.stamp(e));e.id=n;var i=this.viewer=new t.Viewer(n,a.default.mapillary,null,{component:{cover:!1,bearing:!1}});window.addEventListener("resize",(function(){i.resize()})),i.on("nodechanged",this.onNodeChanged.bind(this)),i.on("bearingchanged",this.onBearingChanged.bind(this)),this.createDateLabel(e),this.createCloseButton(e),this._bearing=0,this._zoom=0,this._center=[0,0],this.invalidateSize=r.default.Util.throttle(this._invalidateSize,100,this)},showPano:function(t){var e=this;this.deactivate(),this.activate(),this.viewer.moveToKey(t).then((function(){e.viewer.setZoom(0),e.updateZoomAndCenter()}))},onNodeChanged:function(t){this._node&&t.key===this._node.key||(this._node=t,this.fireChangeEvent(),this.updateDateLabel(t.capturedAt))},getBearingCorrection:function(){return this._node&&"computedCA"in this._node?this._node.computedCA-this._node.originalCA:0},onBearingChanged:function(t){t-=this.getBearingCorrection(),this._bearing!==t&&(this._bearing=t,this.fireChangeEvent())},fireChangeEvent:function(){if(this._node){var t=this._node.originalLatLon;this.fire("change",{latlng:r.default.latLng(t.lat,t.lon),heading:this._bearing,pitch:this._pitch,zoom:this._zoom})}},deactivate:function(){this.viewer.activateCover(),this._updateHandler&&(clearInterval(this._updateHandler),this._updateHandler=null)},updateZoomAndCenter:function(){var t=this;this.viewer.getZoom().then((function(e){t._zoom=e})),this.viewer.getCenter().then((function(e){t._center=e})),this.viewer.getBearing().then((function(e){t.onBearingChanged(e)}))},activate:function(){var t=this;this.viewer.resize(),this.viewer.deactivateCover(),this._updateHandler||(this._updateHandler=setInterval((function(){return t.updateZoomAndCenter()}),200))},getState:function(){if(!this._node)return[];var t=this._node.originalLatLon,e=t.lat,n=t.lon;return[e.toFixed(6),n.toFixed(6),this._center[0].toFixed(4),this._center[1].toFixed(4),this._zoom.toFixed(2)]},setState:function(t){var e=this,n=parseFloat(t[0]),r=parseFloat(t[1]),i=parseFloat(t[2]),o=parseFloat(t[3]),a=parseFloat(t[4]);return!(isNaN(n)||isNaN(r)||isNaN(i)||isNaN(o)||isNaN(a))&&(this.viewer.moveCloseTo(n,r).then((function(){e.viewer.setCenter([i,o]),e.viewer.setZoom(a)})),!0)},_invalidateSize:function(){this.viewer.resize()}});function p(){return(p=c(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f();case 2:return n=t.sent,t.abrupt("return",new h(n,e));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var m={getCoverageLayer:function(t){return new i.MapillaryCoverage(t)},getPanoramaAtPos:function(t,e){return d.apply(this,arguments)},getViewer:function(t){return p.apply(this,arguments)}};e.default=m},function(t,e,n){"use strict";n(7),n(10),n(11),n(182),n(15),n(13),n(1),n(8),n(2),n(6),n(0),n(4),n(5),n(3),n(25),Object.defineProperty(e,"__esModule",{value:!0}),e.MapillaryCoverage=void 0;var r,i=(r=n(9))&&r.__esModule?r:{default:r},o=n(435);function a(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var l=i.default.GridLayer.extend({options:{tileSize:1024,updateWhenIdle:!0,color:"#00cfb1"},initialize:function(t){i.default.GridLayer.prototype.initialize.call(this,t),this.loader=new o.MapillaryLoader(this.options.url,12)},onAdd:function(t){i.default.GridLayer.prototype.onAdd.call(this,t),this.on("tileunload",this.onTileUnload,this)},onRemove:function(t){i.default.GridLayer.prototype.onRemove.call(this,t),this.off("tileunload",this.onTileUnload,this)},onTileUnload:function(t){var e=t.tile;e._abortLoading(),delete e._tileData,delete e._adjustment},drawOverview:function(t){var e=t._tileData;if(e["mapillary-sequence-overview"]){var n=t._adjustment,r=n.multiplier,i=n.offsetX,o=n.offsetY,s=t.getContext("2d");s.fillStyle=this.options.color;var l,u=a(e["mapillary-sequence-overview"]);try{for(u.s();!(l=u.n()).done;){var c=l.value;if("Point"!==c.geometry.type)throw new Error('Invalid sequence overview geometry type "'.concat(c.geometry.type,'"'));s.beginPath();var f=c.geometry.coordinates[0]*r-i,d=c.geometry.coordinates[1]*r-o;s.arc(f,d,5,0,2*Math.PI),s.fill()}}catch(t){u.e(t)}finally{u.f()}}},drawSequences:function(t,e){var n=t._tileData,r=t._adjustment;if(n["mapillary-sequences"]){var i=t.getContext("2d");i.beginPath(),i.strokeStyle=this.options.color,i.lineWidth=e,i.lineCap="round",i.lineJoin="bevel";var o,s=a(n["mapillary-sequences"]);try{for(s.s();!(o=s.n()).done;){var l=o.value;if("MultiLineString"!==l.geometry.type)throw new Error('Invalid sequence geometry type "'.concat(l.geometry.type,'"'));for(var u=r.multiplier,c=r.offsetX,f=r.offsetY,d=l.geometry.coordinates,h=0;h<d.length;h++){var p=d[h];if(p.length){var m=p[0][0]*u-c,v=p[0][1]*u-f;i.moveTo(m,v),1===p.length&&i.lineTo(m,v);for(var y=0;y<p.length;y++){var g=p[y][0]*u-c,b=p[y][1]*u-f;i.lineTo(g,b)}}}}}catch(t){s.e(t)}finally{s.f()}i.stroke()}},drawImages:function(t){var e=t._tileData,n=t._adjustment;if(e["mapillary-images"]){var r=n.multiplier,i=n.offsetX,o=n.offsetY,s=t.getContext("2d");s.beginPath(),s.fillStyle=this.options.color;var l,u=a(e["mapillary-images"]);try{for(u.s();!(l=u.n()).done;){var c=l.value;if("Point"!==c.geometry.type)throw new Error('Invalid image geometry type "'.concat(c.geometry.type,'"'));s.beginPath();var f=c.geometry.coordinates[0]*r-i,d=c.geometry.coordinates[1]*r-o;s.arc(f,d,4,0,2*Math.PI),s.fill()}}catch(t){u.e(t)}finally{u.f()}}},drawTile:function(t,e){if(this._map&&t._tileData)if(e.z<8)this.drawOverview(t);else if(e.z<16){var n=e.z<14?10:5;this.drawSequences(t,n)}else this.drawSequences(t,2),this.drawImages(t)},createTile:function(t,e){var n=this,r=i.default.DomUtil.create("canvas","leaflet-tile");r.width=this.options.tileSize,r.height=this.options.tileSize;var o=this.loader.requestTileData(t),a=o.dataPromise,s=o.abortLoading;return a.then((function(i){i.error||(r._tileData=i.tileData,r._adjustment=i.adjustment||{multiplier:1,offsetX:0,offsetY:0},setTimeout((function(){n.drawTile(r,t),e(null,r)}),1))})),r._abortLoading=s,r}});e.MapillaryCoverage=l},function(t,e,n){"use strict";n(7),n(10),n(11),n(16),n(15),n(13),n(1),n(8),n(2),n(6),n(28),n(19),n(59),n(35),n(29),n(0),n(20),n(39),n(287),n(4),n(5),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.MapillaryLoader=void 0,n(30);var r,i=(r=n(9))&&r.__esModule?r:{default:r},o=n(217),a=n(437);function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function c(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}function f(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){c(o,r,i,a,s,"next",t)}function s(t){c(o,r,i,a,s,"throw",t)}a(void 0)}))}}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e,n){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=b(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function m(t,e){return(m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function v(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=b(t);if(e){var i=b(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y(this,n)}}function y(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?g(t):e}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function w(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var k=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(c,t);var e,n,r,o,s,u=v(c);function c(){var t;d(this,c);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return w(g(t=u.call.apply(u,[this].concat(n))),"url","https://d25uarhxywzl1j.cloudfront.net/v0.1/{z}/{x}/{y}.mvt"),w(g(t),"maxZoom",14),t}return e=c,(n=[{key:"getTileUrl",value:function(t){var e={x:t.x,z:t.z,y:t.y};return i.default.Util.template(this.url,e)}},{key:"layerTileToDataTileCoords",value:function(t){var e=t.z-2,n=null;if(e>6&&e<=10)n=6;else if(e>=11&&e<14)n=e-4;else if(e<0)n=0;else{if(!(e>this.maxZoom))return{z:e,x:t.x,y:t.y};n=this.maxZoom}var r=1<<e-n;return{x:Math.floor(t.x/r),y:Math.floor(t.y/r),z:n}}},{key:"makeRequestData",value:function(t){return{url:this.getTileUrl(t),options:{responseType:"arraybuffer",timeout:1e4,isResponseSuccess:function(t){return 200===t.status||403===t.status}}}}},{key:"calcAdjustment",value:function(t,e){var n=p(b(c.prototype),"calcAdjustment",this).call(this,{x:t.x,y:t.y,z:t.z-2},e);return n&&(n.offsetX*=1024,n.offsetY*=1024),n}},{key:"processResponse",value:(s=f(regeneratorRuntime.mark((function t(e,n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._processResponse(e,n));case 1:case"end":return t.stop()}}),t,this)}))),function(t,e){return s.apply(this,arguments)})},{key:"_processResponse",value:(o=f(regeneratorRuntime.mark((function t(e,n){var r,i,o,s,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(200===e.status&&e.response){i=(0,a.decodeMvt)(e.response,1024),r={},o=l(i);try{for(o.s();!(s=o.n()).done;)u=s.value,r[u.name]=u.features}catch(t){o.e(t)}finally{o.f()}}else r=null;return t.abrupt("return",{tileData:r,coords:n});case 2:case"end":return t.stop()}}),t)}))),function(t,e){return o.apply(this,arguments)})}])&&h(e.prototype,n),r&&h(e,r),c}(o.TiledDataLoader);e.MapillaryLoader=k},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n(19),n(34),Object.defineProperty(e,"__esModule",{value:!0}),e.Cache=void 0;var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._maxSize=e,this._store={},this._size=0}var e,n,i;return e=t,(n=[{key:"get",value:function(t){if(t in this._store){var e=this._store[t];return delete this._store[t],this._store[t]=e,{value:e,found:!0}}return{found:!1}}},{key:"put",value:function(t,e){t in this._store?delete this._store[t]:this._size+=1,this._store[t]=e,this._size>this._maxSize&&(delete this._store[Object.keys(this._store)[0]],this._size-=1)}}])&&r(e.prototype,n),i&&r(e,i),t}();e.Cache=i},function(t,e,n){"use strict";n(7),n(10),n(11),n(16),n(15),n(13),n(1),n(8),n(69),n(2),n(6),n(0),n(4),n(5),n(107),n(70),n(71),n(72),n(73),n(74),n(75),n(76),n(77),n(78),n(79),n(80),n(81),n(82),n(83),n(84),n(85),n(86),n(87),n(88),n(89),n(90),n(91),n(92),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.decodeMvt=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:256,r=new i.default(new Uint8Array(t)),s=o.Tile.read(r),l=[],u=a(s.layers);try{for(u.s();!(e=u.n()).done;){var f=e.value,d=n/f.extent;l.push({name:f.name,features:c(f,d)})}}catch(t){u.e(t)}finally{u.f()}return l};var r,i=(r=n(288))&&r.__esModule?r:{default:r},o=n(439);function a(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function l(t){return t>>1^-(1&t)}function u(t,e,n){if(t!==o.Tile.GeomType.POINT&&t!==o.Tile.GeomType.LINESTRING&&t!==o.Tile.GeomType.POLYGON)throw new Error("Unknown feature geometry type ".concat(t));for(var r,i=e.length,a=0,s=[],u=0,c=0;a<i;){var f=e[a],d=7&f,h=f>>3;switch(d){case 1:if(1!==h)throw new Error("repeat=".concat(h," for command MoveTo"));if(a+2>i)throw new Error("Not enough elements for MoveTo arguments");r&&s.push(r),r=[[(u+=l(e[a+1]))*n,(c+=l(e[a+2]))*n]],a+=3;break;case 2:if(h<1)throw new Error("repeat=".concat(h," for command LineTo"));if(!r)throw new Error("LineTo with empty linestring");a+=1;for(var p=0;p<h;p++){if(a+2>i)throw new Error("Not enough elements for LineTo arguments");u+=l(e[a]),c+=l(e[a+1]),r.push([u*n,c*n]),a+=2}break;case 7:if(t!==o.Tile.GeomType.POLYGON)throw new Error("ClosePath command for non-polygon type ".concat(t));if(!r)throw new Error("ClosePath with empty linestring");if(1!==h)throw new Error("ClosePath repeats ".concat(h," times"));r.push(r[0]),a+=1;break;default:throw new Error("Unknown command ".concat(f," & 0x7 = ").concat(d))}}r&&s.push(r);var m={};switch(t){case o.Tile.GeomType.POINT:if(1!==s.length||1!==s[0].length)throw new Error("Invalid coordinates number for point");m.type="Point",m.coordinates=s[0][0];break;case o.Tile.GeomType.LINESTRING:m.type="MultiLineString",m.coordinates=s;break;case o.Tile.GeomType.POLYGON:m.type="Polygon",m.coordinates=s}return m}function c(t,e){var n,r=[],i=a(t.features);try{for(i.s();!(n=i.n()).done;){var o=n.value,s=u(o.type,o.geometry,e);r.push({geometry:s})}}catch(t){i.e(t)}finally{i.f()}return r}},,function(t,e,n){"use strict";n(6);var r=e.Tile={};r.read=function(t,e){return t.readFields(r._readField,{layers:[]},e)},r._readField=function(t,e,n){3===t&&e.layers.push(r.Layer.read(n,n.readVarint()+n.pos))},r.GeomType={UNKNOWN:0,POINT:1,LINESTRING:2,POLYGON:3},r.Feature={},r.Feature.read=function(t,e){return t.readFields(r.Feature._readField,{id:0,tags:[],type:0,geometry:[]},e)},r.Feature._readField=function(t,e,n){3===t?e.type=n.readVarint():4===t&&n.readPackedVarint(e.geometry)},r.Layer={},r.Layer.read=function(t,e){return t.readFields(r.Layer._readField,{version:0,name:"",features:[],keys:[],values:[],extent:0},e)},r.Layer._readField=function(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():2===t?e.features.push(r.Feature.read(n,n.readVarint()+n.pos)):5===t&&(e.extent=n.readVarint())}},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";n(16),n(2),Object.defineProperty(e,"__esModule",{value:!0}),e.DateLabelMixin=e.CloseButtonMixin=void 0;var r,i=(r=n(9))&&r.__esModule?r:{default:r};n(289);var o={createCloseButton:function(t){this.closeButton=i.default.DomUtil.create("div","photo-viewer-button-close",t),i.default.DomEvent.on(this.closeButton,"click",this.onCloseClick,this)},onCloseClick:function(){this.fire("closeclick")}};e.CloseButtonMixin=o;var a={createDateLabel:function(t){this.dateLabel=i.default.DomUtil.create("div","mapillary-viewer-date-overlay",t)},updateDateLabel:function(t){var e;this.dateLabel.innerHTML=(e=new Date(t),"".concat(e.getDate()," ").concat(["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()]," ").concat(e.getFullYear()))}};e.DateLabelMixin=a},function(t,e,n){"use strict";n(7),n(10),n(11),n(16),n(46),n(15),n(65),n(13),n(1),n(31),n(18),n(8),n(98),n(2),n(24),n(6),n(226),n(50),n(0),n(172),n(54),n(20),n(14),n(4),n(106),n(5),n(43),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n(30);var r=s(n(9)),i=n(443),o=n(67);n(444),n(289);var a=s(n(111));function s(t){return t&&t.__esModule?t:{default:t}}function l(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=c(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||c(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){if(t){if("string"==typeof t)return f(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(t,e):void 0}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function d(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){d(o,r,i,a,s,"next",t)}function s(t){d(o,r,i,a,s,"throw",t)}a(void 0)}))}}function p(t){var e=[];if(t&&t.query&&t.query.pages&&t.query.pages){for(var n=0,r=Object.values(t.query.pages);n<r.length;n++){var i=r[n];if(i.coordinates&&".jpg"===i.title.slice(-4).toLowerCase()){var o=i.imageinfo[0],a=o.extmetadata.ImageDescription?o.extmetadata.ImageDescription.value:null,s=o.extmetadata.ObjectName?o.extmetadata.ObjectName.value:null;a&&/^<table ((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])|\n)+<\/table>$/.test(a)&&(a=null),a&&(a=(a=a.replace(/<(?:(?!>)[\s\S])+>/g,"")).replace(/[\n\r]/g,"")),a&&s&&s.toLowerCase().includes(a.toLowerCase())&&(a=null),s&&a&&a.toLowerCase().includes(s.toLowerCase())&&(s=null);var l="Wikimedia commons";(s||a)&&(l="",s&&(l=s),a&&(s&&(l+="</br>"),l+=a));var u=o.extmetadata.Artist?o.extmetadata.Artist.value:null;u&&/^<table ((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])|\n)+<\/table>$/.test(u)&&(u='See author info at <a href="'.concat(o.descriptionurl,'">Wikimedia commons</a>'));var c=o.thumburl.replace("134px","".concat(o.width,"px"));e.push({url:c,width:o.width,height:o.height,lat:i.coordinates[0].lat,lng:i.coordinates[0].lon,author:u,timeOriginal:o.extmetadata.DateTimeOriginal?o.extmetadata.DateTimeOriginal.value:null,time:o.extmetadata.DateTime?o.extmetadata.DateTime.value:null,description:l,pageUrl:o.descriptionurl,pageId:i.pageid.toString()})}}if(e.length)return e}return null}function m(t,e,n){var r=t.distanceTo(e),i=t.distanceTo(n);return r<i?-1:r===i?0:1}function v(t,e){return y.apply(this,arguments)}function y(){return(y=h(regeneratorRuntime.mark((function t(e,n){var i,a,s,l,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=r.default.latLng(e.lat,e.lng),"https://commons.wikimedia.org/w/api.php?origin=*&format=json&action=query&generator=geosearch&ggsprimary=all&ggsnamespace=6&ggslimit=10&iilimit=1&coprimary=all&ggsradius={radius}&ggscoord={lat}|{lng}&iiurlwidth=134&prop=imageinfo|coordinates&iiprop=url|mime|size|extmetadata|commonmetadata|metadata",(n+=i=10)<10&&(n=10),n>1e4&&(n=1e4),a=r.default.Util.template("https://commons.wikimedia.org/w/api.php?origin=*&format=json&action=query&generator=geosearch&ggsprimary=all&ggsnamespace=6&ggslimit=10&iilimit=1&coprimary=all&ggsradius={radius}&ggscoord={lat}|{lng}&iiurlwidth=134&prop=imageinfo|coordinates&iiprop=url|mime|size|extmetadata|commonmetadata|metadata",{lat:e.lat,lng:e.lng,radius:Math.ceil(n)}),t.next=9,(0,o.fetch)(a,{responseType:"json",timeout:1e4});case 9:if(200!==(s=t.sent).status){t.next=18;break}if(!(l=p(s.responseJSON))){t.next=17;break}return l.sort(m.bind(null,e)),u=r.default.latLng(l[0].lat,l[0].lng),l=l.filter((function(t){return u.distanceTo(r.default.latLng(t.lat,t.lng))<=i})),t.abrupt("return",{found:!0,data:l});case 17:case 18:return t.abrupt("return",{found:!1});case 19:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function g(t){var e=/^([0-9]+)\x2D([0-9]+)\x2D([0-9]+)/.exec(t);if(e){var n=u(e.slice(1),3),r=n[0],i=n[1],o=n[2];return"".concat(o," ").concat(["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][i-1]," ").concat(r)}return t}var b=r.default.Evented.extend({initialize:function(t){var e=this;t=r.default.DomUtil.create("div","wikimedia-viewer-container",t);var n=this.mapContainer=r.default.DomUtil.create("div","wikimedia-viewer-map-container",t);this.pageButtonContainer=r.default.DomUtil.create("div","wikimedia-viewer-page-buttons-container",t),this.map=r.default.map(n,{maxBoundsViscosity:1,crs:r.default.CRS.Simple,zoomControl:!1,attributionControl:!1,zoomSnap:0}),this.map.on("zoomend",this.notifyChange,this),this.map.on("moveend",this.notifyChange,this),this.infoLabel=r.default.DomUtil.create("div","wikimedia-viewer-info-overlay",n),this.closeButton=r.default.DomUtil.create("div","photo-viewer-button-close",t),this.prevPhotoButton=r.default.DomUtil.create("div","wikimedia-viewer-button-prev",n),this.nextPhotoButton=r.default.DomUtil.create("div","wikimedia-viewer-button-next",n),r.default.DomEvent.on(this.prevPhotoButton,"click",(function(){e.switchPhoto(e._imageIdx-1)})),r.default.DomEvent.on(this.nextPhotoButton,"click",(function(){e.switchPhoto(e._imageIdx+1)})),r.default.DomEvent.on(this.closeButton,"click",this.onCloseClick,this)},setupPageButtons:function(t){var e=this;if(this._buttons){var n,i=l(this._buttons);try{for(i.s();!(n=i.n()).done;){var o=n.value;this.pageButtonContainer.removeChild(o)}}catch(t){i.e(t)}finally{i.f()}}if(this._buttons=[],t>1){r.default.DomUtil.addClass(this.pageButtonContainer,"enabled");for(var a=function(t){var n=r.default.DomUtil.create("div","wikimedia-viewer-page-button",e.pageButtonContainer);n.innerHTML=String(t+1),e._buttons.push(n),r.default.DomEvent.on(n,"click",(function(){return e.switchPhoto(t)}))},s=0;s<t;s++)a(s)}else r.default.DomUtil.removeClass(this.pageButtonContainer,"enabled")},switchPhoto:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._imageIdx=t,this.imageLayer&&this.map.removeLayer(this.imageLayer);var i=this.images[t],o=this.map.getSize();o.x&&o.y||(o={x:500,y:500});var a=Math.log2(Math.max(i.width/o.x,i.height/o.y))+2;a<1&&(a=1);var s=this.map.unproject([0,i.height],a-2),c=this.map.unproject([i.width,0],a-2),f=new r.default.LatLngBounds(s,c);this.map.setMaxZoom(a),this.map.setMaxBounds(f),n?this.map.setView(n.center,n.zoom,{animate:!1}):this.map.fitBounds(f,{animate:!1}),this.imageLayer=r.default.imageOverlay(null,f),r.default.DomUtil.addClass(this.mapContainer,"loading"),this.imageLayer.on("load",(function(){r.default.DomUtil.removeClass(e.mapContainer,"loading")})),this.imageLayer.setUrl(i.url),this.imageLayer.addTo(this.map);var d=[];i.timeOriginal&&d.push(g(i.timeOriginal)),i.author&&d.push(i.author),d.push('<a href="'.concat(i.pageUrl,'">').concat(i.description,"</a>")),d=d.join("</br>"),this.infoLabel.innerHTML=d,t>0?r.default.DomUtil.addClass(this.prevPhotoButton,"enabled"):r.default.DomUtil.removeClass(this.prevPhotoButton,"enabled"),t<this.images.length-1?r.default.DomUtil.addClass(this.nextPhotoButton,"enabled"):r.default.DomUtil.removeClass(this.nextPhotoButton,"enabled");var h,p=l(this._buttons.entries());try{for(p.s();!(h=p.n()).done;){var m=u(h.value,2),v=m[0],y=m[1];(v===t?r.default.DomUtil.addClass:r.default.DomUtil.removeClass)(y,"active")}}catch(t){p.e(t)}finally{p.f()}this.notifyChange()},notifyChange:function(){if(this.images&&this._active){var t=this.images[this._imageIdx];this.fire("change",{latlng:r.default.latLng(t.lat,t.lng),latlngs:this.images.map((function(t){return r.default.latLng(t.lat,t.lng)}))})}},_showPano:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.images=t,this.setupPageButtons(t.length),this.switchPhoto(e,n)},showPano:function(t){this._showPano(t)},onCloseClick:function(){this.fire("closeclick")},activate:function(){this._active=!0},deactivate:function(){this._active=!1},setState:function(t){var e=this,n=parseFloat(t[0]),i=parseFloat(t[1]),o=t[2],a=parseFloat(t[3]),s=parseFloat(t[4]),c=parseFloat(t[5]);if(!(isNaN(n)||isNaN(i)||isNaN(s)||isNaN(a)||isNaN(c))){var f=-1;return v({lat:n,lng:i},0).then((function(t){if(t.found){var n,i=l(t.data.entries());try{for(i.s();!(n=i.n()).done;){var d=u(n.value,2),h=d[0];if(d[1].pageId===o){f=h;break}}}catch(t){i.e(t)}finally{i.f()}f>-1&&e._showPano(t.data,f,{center:r.default.latLng(a,s),zoom:c})}})),!0}return!1},getState:function(){if(!this.images)return[];var t=this.map.getCenter();return[this.images[0].lat.toFixed(6),this.images[0].lng.toFixed(6),this.images[this._imageIdx].pageId,t.lat.toFixed(2),t.lng.toFixed(2),this.map.getZoom().toFixed(1)]},invalidateSize:function(){this.map.invalidateSize()}});var w={getCoverageLayer:function(t){var e=a.default.wikimediaCommonsCoverageUrl;return new i.MultiLayer([{layer:r.default.tileLayer(e,r.default.extend({},t,{tms:!0})),minZoom:0,maxZoom:10},{layer:new i.WikimediaVectorCoverage(e,t),minZoom:11,maxZoom:18}])},getPanoramaAtPos:v,getViewer:function(t){return new b(t)}};e.default=w},function(t,e,n){"use strict";n(7),n(10),n(11),n(182),n(15),n(13),n(1),n(8),n(69),n(2),n(6),n(28),n(19),n(35),n(29),n(0),n(20),n(39),n(4),n(5),n(179),n(70),n(71),n(72),n(73),n(74),n(75),n(76),n(77),n(78),n(79),n(80),n(81),n(82),n(83),n(84),n(85),n(86),n(87),n(88),n(89),n(90),n(91),n(92),n(3),n(25),Object.defineProperty(e,"__esModule",{value:!0}),e.WikimediaVectorCoverage=e.MultiLayer=void 0,n(30);var r,i=(r=n(9))&&r.__esModule?r:{default:r},o=n(217);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=d(t);if(e){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f(this,n)}}function f(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var m=i.default.Layer.extend({initialize:function(t){this.layers=t},setLayersVisibility:function(t){if(this._map){var e;e=t&&void 0!==t.zoom?t.zoom:this._map.getZoom();var n,r=h(this.layers);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.minZoom<=e&&e<=i.maxZoom?this._map.addLayer(i.layer):this._map.removeLayer(i.layer)}}catch(t){r.e(t)}finally{r.f()}}},onAdd:function(t){this._map=t,this.setLayersVisibility(),t.on("zoomend",this.setLayersVisibility,this)},onRemove:function(){var t,e=h(this.layers);try{for(e.s();!(t=e.n()).done;){var n=t.value;this._map.removeLayer(n.layer)}}catch(t){e.e(t)}finally{e.f()}this._map.off("zoomend",this.setLayersVisibility,this),this._map.off("zoomanim",this.setLayersVisibility,this),this._map=null}});e.MultiLayer=m;var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(d,t);var e,n,r,o,a,f=c(d);function d(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),(n=f.call(this)).url=t,n.maxZoom=e,n}return e=d,(n=[{key:"getTileUrl",value:function(t){var e={x:t.x,z:t.z,y:Math.pow(2,t.z)-1-t.y};return i.default.Util.template(this.url,e)}},{key:"layerTileToDataTileCoords",value:function(t){var e=t.z,n=null;if(!(e>this.maxZoom))return{z:e,x:t.x,y:t.y};var r=1<<e-(n=this.maxZoom);return{x:Math.floor(t.x/r),y:Math.floor(t.y/r),z:n}}},{key:"makeRequestData",value:function(t){return{url:this.getTileUrl(t),options:{responseType:"arraybuffer",timeout:1e4,isResponseSuccess:function(t){return 200===t.status||404===t.status}}}}},{key:"processResponse",value:(o=regeneratorRuntime.mark((function t(e,n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.z>=this.maxZoom&&200===e.status&&e.response?new Uint16Array(e.response):null,t.abrupt("return",{tileData:r,coords:n});case 2:case"end":return t.stop()}}),t,this)})),a=function(){var t=this,e=arguments;return new Promise((function(n,r){var i=o.apply(t,e);function a(t){s(i,n,r,a,l,"next",t)}function l(t){s(i,n,r,a,l,"throw",t)}a(void 0)}))},function(t,e){return a.apply(this,arguments)})}])&&l(e.prototype,n),r&&l(e,r),d}(o.TiledDataLoader),y=i.default.GridLayer.extend({options:{tileSize:256,color:"#ff00ff"},initialize:function(t,e){i.default.GridLayer.prototype.initialize.call(this,e),this.loader=new v(t,11)},onAdd:function(t){i.default.GridLayer.prototype.onAdd.call(this,t),this.on("tileunload",this.onTileUnload,this)},onRemove:function(t){i.default.GridLayer.prototype.onRemove.call(this,t),this.off("tileunload",this.onTileUnload,this)},onTileUnload:function(t){var e=t.tile;e._abortLoading(),delete e._tileData,delete e._adjustment},drawTile:function(t,e){if(this._map&&t._tileData){var n=5e3,r=t._tileData,i=t._adjustment,o=i.multiplier,a=i.offsetX,s=i.offsetY,l=t.getContext("2d"),u=256*o/55535;l.fillStyle=this.options.color;for(var c=0,f=r.length;c<f;c+=2){var d=(r[c]-n)*u-256*a,h=(r[c+1]-n)*u-256*s;l.beginPath(),l.arc(d,h,5,0,2*Math.PI),l.fill()}}},createTile:function(t,e){var n=this,r=i.default.DomUtil.create("canvas","leaflet-tile");r.width=this.options.tileSize,r.height=this.options.tileSize;var o=this.loader.requestTileData(t),a=o.dataPromise,s=o.abortLoading;return a.then((function(i){i.error||(r._tileData=i.tileData,r._adjustment=i.adjustment||{multiplier:1,offsetX:0,offsetY:0},setTimeout((function(){n.drawTile(r,t),e(null,r)}),1))})),r._abortLoading=s,r}});e.WikimediaVectorCoverage=y},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";n(1),n(18),n(8),n(6),n(0),n(20),n(5),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.readFiles=function(t){return t=Array.prototype.slice.apply(t),Promise.all(t.map(a))},e.selectFiles=void 0;var r,i=n(112),o=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];r&&document.body.removeChild(r),r=document.createElement("input"),document.body.appendChild(r),r.type="file",r.multiple=Boolean(t),r.style.display="none";var e=new Promise((function(t){r.addEventListener("change",(function(){t(r.files)}))}));return r.click(),e};function a(t){return new Promise((function(e){var n=new FileReader;n.onload=function(n){e({data:(0,i.arrayBufferToString)(n.target.result),filename:t.name})},n.readAsArrayBuffer(t)}))}e.selectFiles=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=s(n(129)),i=s(n(448)),o=n(450),a=n(451);function s(t){return t&&t.__esModule?t:{default:t}}var l=[o.parseKmz,i.default,r.default,a.parseOziRte,a.parseOziPlt,a.parseOziWpt,o.parseKml];e.default=l},function(t,e,n){"use strict";n(7),n(10),n(11),n(15),n(13),n(1),n(8),n(2),n(6),n(0),n(14),n(4),n(5),n(52),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(292),i=s(n(293)),o=n(294),a=s(n(218));function s(t){return t&&t.__esModule?t:{default:t}}function l(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var c=function(t,e){var n;try{n=new r.JSUnzip(t)}catch(t){return null}if(!n.isZipFile())return null;try{n.readEntries()}catch(t){return null}for(var s=[],u=0;u<n.entries.length;u++){var c,f=n.entries[u];if(0===f.compressionMethod)c=f.data;else{if(8!==f.compressionMethod)return null;c=(0,i.default)(f.data,f.uncompressedSize)}var d,h=(0,o.decode866)(f.fileName),p=l((0,a.default)(h,c));try{for(p.s();!(d=p.n()).done;){var m=d.value;"UNSUPPORTED"===m.error&&m.name.match(/(\.(pdf|doc|txt|jpg))|\/$/i)||s.push(m)}}catch(t){p.e(t)}finally{p.f()}}return s};e.default=c},,function(t,e,n){"use strict";n(7),n(10),n(11),n(15),n(13),n(1),n(8),n(2),n(6),n(0),n(54),n(14),n(4),n(5),n(52),n(43),n(41),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.parseKml=f,e.parseKmz=function(t,e){var n,r;try{r=new a.default(t)}catch(t){return null}var i,o,l,c,d=[],h=[],p=!1;if(!r.isZipFile())return null;try{r.readEntries()}catch(t){return null}for(l=0;l<r.entries.length;l++)if("doc.kml"===(c=r.entries[l]).fileName){p=!0;break}if(!p)return null;for(l=0;l<r.entries.length;l++)if((c=r.entries[l]).fileName.match(/\.[k\u212A]ml$/i)){if(0===c.compressionMethod)n=c.data;else{if(8!==c.compressionMethod)return null;n=(0,s.default)(c.data,c.uncompressedSize)}(i=f(n,"dummmy"))&&(o=o||i[0].error,d.push.apply(d,u(i[0].tracks)),h.push.apply(h,u(i[0].points)))}return i=[{name:e,error:o,tracks:d,points:h}]};var r=n(130),i=n(291),o=l(n(219)),a=l(n(292)),s=l(n(293));function l(t){return t&&t.__esModule?t:{default:t}}function u(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function f(t,e){var n,a;function s(t){for(var e=(0,i.xmlGetNodeText)(t).split(/[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+/),r=[],o=0;o<e.length;o++)if(e[o].length){var a=e[o].split(","),s=parseFloat(a[1]),l=parseFloat(a[0]);if(isNaN(s)||isNaN(l)){n="CORRUPT";break}r.push({lat:s,lng:l})}return r}t=(t=(0,o.default)(t)).replace(/<((?:(?![ >])[\s\S])+):((?:(?![ >])[\s\S])+)/g,"<$1_$2");try{a=(new DOMParser).parseFromString(t,"text/xml")}catch(t){return null}return"parsererror"===a.documentElement.nodeName||0===a.getElementsByTagName("kml").length?null:[{name:e,tracks:function(t){for(var e=t.getElementsByTagName("LineString"),n=[],r=0;r<e.length;r++){var i=e[r].getElementsByTagName("coordinates");if(i.length){var o=s(i[0]);o.length&&n.push(o)}}return n}(a),points:function(t){var e,o,a,s,l,u,c,f=[];for(e=t.getElementsByTagName("Placemark"),o=0;o<e.length;o++)if(0!==(c=e[o].getElementsByTagName("Point")).length){if(c.length>1){n="CORRUPT";break}if(1!==(a=c[0].getElementsByTagName("coordinates")).length){n="CORRUPT";break}if(a=(a=(0,i.xmlGetNodeText)(a[0])).split(","),l=parseFloat(a[1]),u=parseFloat(a[0]),isNaN(l)||isNaN(u)){n="CORRUPT";break}s="";var d=e[o].getElementsByTagName("name");if(d[0])try{s=(0,i.xmlGetNodeText)(d[0]),s=(0,r.decode)(s)}catch(t){n="CORRUPT"}f.push({name:s,lat:l,lng:u})}return f}(a),error:n}]}},function(t,e,n){"use strict";n(45),n(54),n(53),n(14),n(41),n(99),Object.defineProperty(e,"__esModule",{value:!0}),e.parseOziPlt=function(t,e){var n,r=[],i=(t=(0,o.default)(t)).split("\n");if(0!==i[0].indexOf("OziExplorer Track Point File"))return null;for(var a=parseInt(i[5],10),s=[],l=0,u=6;u<i.length;u++){var c=i[u].trim();if(c){var f=c.split(","),d=parseFloat(f[0]),h=parseFloat(f[1]),p=parseInt(f[2],10);if(isNaN(d)||isNaN(h)||isNaN(p)){n="CORRUPT";break}p&&(s=[]),s.length||r.push(s),s.push({lat:d,lng:h}),l+=1}}(isNaN(a)||0!==a&&a!==l)&&(n="CORRUPT");return[{name:e,tracks:r,error:n}]},e.parseOziRte=function(t,e){var n,r=[],i=(t=(0,o.default)(t)).split("\n");if(0!==i[0].indexOf("OziExplorer Route File"))return null;for(var a=[],s=4;s<i.length;s++){var l=i[s].trim();if(l){var u=l.split(",");if("R"===u[0])a.length&&r.push(a),a=[];else{if("W"!==u[0]){n="CORRUPT";break}var c=parseFloat(u[5]),f=parseFloat(u[6]);if(isNaN(c)||isNaN(f)){n="CORRUPT";break}a.push({lat:c,lng:f})}}}a.length&&r.push(a);return[{name:e,tracks:r,error:n}]},e.parseOziWpt=function(t,e){var n,r,a,s,l,u,c,f,d=[];if(t=(0,o.default)(t),0!==(r=t.split("\n"))[0].indexOf("OziExplorer Waypoint File"))return null;for(s=4;s<r.length;s++)if(a=r[s].trim()){if(f=a.split(","),l=parseFloat(f[2]),u=parseFloat(f[3]),c=(0,i.decodeCP1251)(f[1]).trim(),isNaN(l)||isNaN(u)){n="CORRUPT";break}d.push({lat:l,lng:u,name:c})}return[{name:e,points:d,error:n}]};var r,i=n(294),o=(r=n(219))&&r.__esModule?r:{default:r}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=y(n(453)),i=y(n(454)),o=y(n(455)),a=y(n(457)),s=y(n(459)),l=y(n(460)),u=y(n(461)),c=y(n(462)),f=n(463),d=n(295),h=n(466),p=n(467),m=n(468),v=y(n(469));function y(t){return t&&t.__esModule?t:{default:t}}var g=[f.YandexRuler,d.NakarteTrack,d.NakarteUrl,i.default,o.default,a.default,s.default,l.default,u.default,c.default,h.MovescountMove,h.MovescountRoute,p.GarminActivity,p.GarminRoute,m.SportsTrackerActivity,v.default,r.default];e.default=g},function(t,e,n){"use strict";n(7),n(10),n(11),n(1),n(2),n(28),n(19),n(35),n(29),n(0),n(39),n(14),n(4),n(5),n(52),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=a(n(55)),i=a(n(218)),o=a(n(51));function a(t){return t&&t.__esModule?t:{default:t}}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h(t);if(e){var i=h(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}function d(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(s,t);var e,n,r,a=f(s);function s(){return l(this,s),a.apply(this,arguments)}return e=s,(n=[{key:"isOurUrl",value:function(){return Boolean(this.origUrl.match(/^https?:\/\/(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+/))}},{key:"requestOptions",value:function(){return[{url:(0,o.default)(this.origUrl),options:{responseType:"binarystring"}}]}},{key:"parseResponse",value:function(t){var e=t[0];return(0,i.default)(this.nameFromUrl(e.responseURL),e.responseBinaryText)}}])&&u(e.prototype,n),r&&u(e,r),s}(r.default);e.default=p},function(t,e,n){"use strict";n(7),n(10),n(11),n(16),n(46),n(1),n(18),n(224),n(2),n(6),n(50),n(28),n(19),n(35),n(29),n(0),n(39),n(14),n(4),n(5),n(41),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=o(n(55)),i=o(n(51));function o(t){return t&&t.__esModule?t:{default:t}}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=h(t);if(e){var i=h(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return f(this,n)}}function f(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?d(t):e}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(a,t);var e,n,r,o=c(a);function a(){var t;s(this,a);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return p(d(t=o.call.apply(o,[this].concat(n))),"urlRegexps",[/^https?:\/\/(?:www\.)?endomondo\.com\/users\/([0-9]+)\/workouts\/([0-9]+)/,/^https?:\/\/(?:www\.)?endomondo\.com\/workouts\/([0-9]+)\/([0-9]+)/]),t}return e=a,(n=[{key:"isOurUrl",value:function(){var t=this;return this.urlRegexps.some((function(e){return e.test(t.origUrl)}))}},{key:"requestOptions",value:function(){var t,e,n=this.urlRegexps[0].exec(this.origUrl);if(n){var r=[n[1],n[2]];t=r[0],e=r[1]}else{var o=[(n=this.urlRegexps[1].exec(this.origUrl))[1],n[2]];e=o[0],t=o[1]}return[{url:(0,i.default)("https://www.endomondo.com/rest/v1/users/".concat(t,"/workouts/").concat(e)),options:{responseType:"json",isResponseSuccess:function(t){return 200===t.status||404===t.status}}}]}},{key:"parseResponse",value:function(t){var e=t[0];if(404===e.status)return[{error:"Invalid link or user disabled viewing this workout track"}];var n=e.responseJSON;if(!n)return[{name:"Endomondo activity",error:"UNSUPPORTED"}];if(!n.points||!n.points.points)return[{error:"Endomondo user disabled viewing this workout track"}];var r=n.points.points.filter((function(t){return t.latitude})).map((function(t){return{lat:t.latitude,lng:t.longitude}}));if(0===r.length)return[{error:"Endomondo user disabled viewing this workout track"}];var i=n.local_start_time.split("T")[0],o="".concat(n.distance.toFixed(1)," km"),a="".concat(i,", ").concat(o);return n.author&&n.author.name&&(a+=" ".concat(n.author.name)),n.title&&(a+=": ".concat(n.title)),[{name:a,tracks:[r]}]}}])&&l(e.prototype,n),r&&l(e,r),a}(r.default);e.default=m},function(t,e,n){"use strict";n(7),n(10),n(11),n(16),n(1),n(2),n(28),n(19),n(35),n(29),n(0),n(39),n(14),n(4),n(5),n(456),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=a(n(51)),i=a(n(55)),o=a(n(129));function a(t){return t&&t.__esModule?t:{default:t}}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p(t);if(e){var i=p(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}function d(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?h(t):e}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(s,t);var e,n,i,a=f(s);function s(){var t;l(this,s);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return m(h(t=a.call.apply(a,[this].concat(n))),"urlRe",/^https?:\/\/(?:www\.)?etomesto\.ru\/track([0-9a-z]+)/),t}return e=s,(n=[{key:"getTrackId",value:function(){return this.urlRe.exec(this.origUrl)[1]}},{key:"isOurUrl",value:function(){return this.urlRe.test(this.origUrl)}},{key:"requestOptions",value:function(){var t=this.getTrackId();return[{url:(0,r.default)("http://www.etomesto.ru/save/".concat(t,".gpx")),options:{responseType:"binarystring",isResponseSuccess:function(t){return 200===t.status&&!t.responseBinaryText.startsWith("ERROR")}}}]}},{key:"parseResponse",value:function(t){var e=this.getTrackId(),n=t[0],r="Etomesto track ".concat(e);return(0,o.default)(n.responseBinaryText,r,!0)||[{name:r,error:"UNSUPPORTED"}]}}])&&u(e.prototype,n),i&&u(e,i),s}(i.default);e.default=v},,function(t,e,n){"use strict";n(7),n(10),n(11),n(16),n(1),n(2),n(28),n(19),n(35),n(29),n(0),n(39),n(14),n(4),n(5),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=s(n(55)),i=s(n(51)),o=s(n(129)),a=s(n(458));function s(t){return t&&t.__esModule?t:{default:t}}function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=m(t);if(e){var i=m(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h(this,n)}}function h(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?p(t):e}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(l,t);var e,n,r,s=d(l);function l(){var t;u(this,l);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return v(p(t=s.call.apply(s,[this].concat(n))),"urlRe",/^https?:\/\/www\.gpsies\.com\/map\.do(?:(?!\?)[\s\S])*\?fileId=([a-z]+)/),t}return e=l,(n=[{key:"isOurUrl",value:function(){return this.urlRe.test(this.origUrl)}},{key:"requestOptions",value:function(){var t=this.urlRe.exec(this.origUrl)[1];return[{url:(0,i.default)("https://www.gpsies.com/download.do"),options:{method:"POST",data:(0,a.default)({fileId:t,speed:"10",dataType:"3",filetype:"gpxTrk",submitButton:"",inappropriate:""}),headers:[["Content-type","application/x-www-form-urlencoded"]],responseType:"binarystring"}}]}},{key:"parseResponse",value:function(t){var e=t[0];return(0,o.default)(e.responseBinaryText,this.nameFromUrl(e.responseURL),!0)||[{name:name,error:"UNSUPPORTED"}]}}])&&c(e.prototype,n),r&&c(e,r),l}(r.default);e.default=y},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n(7),n(10),n(11),n(16),n(15),n(13),n(1),n(31),n(18),n(8),n(2),n(6),n(213),n(0),n(4),n(5),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=function(t){return Object.entries(t).map((function(t){var e=r(t,2),n=e[0],i=e[1];return"".concat(n,"=").concat(encodeURIComponent(i))})).join("&")};e.default=o},function(t,e,n){"use strict";n(7),n(10),n(11),n(16),n(1),n(2),n(28),n(19),n(35),n(29),n(0),n(39),n(14),n(4),n(5),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=a(n(51)),i=a(n(55)),o=a(n(129));function a(t){return t&&t.__esModule?t:{default:t}}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p(t);if(e){var i=p(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}function d(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?h(t):e}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(s,t);var e,n,i,a=f(s);function s(){var t;l(this,s);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return m(h(t=a.call.apply(a,[this].concat(n))),"urlRe",/^https?:\/\/(?:(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+\.)?gpslib\.(?:(?!\.)[\s\S])+\/tracks\/info\/([0-9]+)/),t}return e=s,(n=[{key:"isOurUrl",value:function(){return this.urlRe.test(this.origUrl)}},{key:"requestOptions",value:function(){var t=this.urlRe.exec(this.origUrl),e=this.trackId=t[1];return[{url:(0,r.default)("https://www.gpslib.ru/tracks/download/".concat(e,".gpx")),options:{responseType:"binarystring"}}]}},{key:"parseResponse",value:function(t){var e=t[0];return(0,o.default)(e.responseBinaryText,"GPSLib ".concat(this.trackId),!0)||[{name:name,error:"UNSUPPORTED"}]}}])&&u(e.prototype,n),i&&u(e,i),s}(i.default);e.default=v},function(t,e,n){"use strict";n(7),n(10),n(11),n(16),n(1),n(2),n(28),n(19),n(35),n(29),n(0),n(39),n(14),n(4),n(5),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=a(n(51)),i=a(n(55)),o=a(n(129));function a(t){return t&&t.__esModule?t:{default:t}}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p(t);if(e){var i=p(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}function d(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?h(t):e}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(s,t);var e,n,i,a=f(s);function s(){var t;l(this,s);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return m(h(t=a.call.apply(a,[this].concat(n))),"urlRe",/^https?:\/\/(?:www\.)?openstreetmap\.org\/user\/(?:(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)\/traces\/([0-9]+)/),t}return e=s,(n=[{key:"getTrackId",value:function(){return this.urlRe.exec(this.origUrl)[1]}},{key:"isOurUrl",value:function(){return this.urlRe.test(this.origUrl)}},{key:"requestOptions",value:function(){var t=this.getTrackId();return[{url:(0,r.default)("https://www.openstreetmap.org/trace/".concat(t,"/data")),options:{responseType:"binarystring"}}]}},{key:"parseResponse",value:function(t){var e=this.getTrackId(),n=t[0];return(0,o.default)(n.responseBinaryText,"OSM track ".concat(e),!0)||[{name:name,error:"UNSUPPORTED"}]}}])&&u(e.prototype,n),i&&u(e,i),s}(i.default);e.default=v},function(t,e,n){"use strict";n(7),n(10),n(11),n(16),n(15),n(65),n(13),n(1),n(18),n(8),n(2),n(6),n(28),n(19),n(35),n(29),n(0),n(39),n(14),n(4),n(5),n(41),n(99),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=o(n(55)),i=o(n(51));function o(t){return t&&t.__esModule?t:{default:t}}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=m(t);if(e){var i=m(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h(this,n)}}function h(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?p(t):e}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(a,t);var e,n,r,o=d(a);function a(){var t;u(this,a);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return v(p(t=o.call.apply(o,[this].concat(n))),"urlRe",/^https?:\/\/(?:(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+\.)?strava\.com\/activities\/([0-9]+)/),t}return e=a,(n=[{key:"isOurUrl",value:function(){return this.urlRe.test(this.origUrl)}},{key:"requestOptions",value:function(){var t=this.urlRe.exec(this.origUrl),e=this.trackId=t[1];function n(t){return[200,401,404].includes(t.status)}return[{url:(0,i.default)("https://www.strava.com/activities/".concat(e,"?hl=en-GB")),options:{isResponseSuccess:n}},{url:(0,i.default)("https://www.strava.com/stream/".concat(e,"?streams%5B%5D=latlng")),options:{responseType:"json",isResponseSuccess:n}}]}},{key:"parseResponse",value:function(t){var e,n=s(t,2),r=n[0],i=n[1];if(200!==i.status)return[{error:{401:"Requested Strava activity marked as private",404:"Requested Strava activity could not be found"}[i.status]}];var o="Strava ".concat(this.trackId),a=null===(e=i.responseJSON)||void 0===e?void 0:e.latlng;if(!a||!Array.isArray(a))return[{name:o,error:"UNSUPPORTED"}];var l,u=[a.map((function(t){return{lat:t[0],lng:t[1]}}))];try{l=(new DOMParser).parseFromString(r.response,"text/html")}catch(t){}if(l){var c,f,d,h,p,m,v,y=(null!==(c=null===(f=l.querySelector('a.minimal[href*="/athletes/"]'))||void 0===f?void 0:f.textContent)&&void 0!==c?c:"").trim(),g=(null!==(d=null===(h=l.querySelector("h1.activity-name"))||void 0===h?void 0:h.textContent)&&void 0!==d?d:"").trim(),b=null!==(p=null===(m=l.querySelector("time"))||void 0===m?void 0:m.textContent)&&void 0!==p?p:"";b=(b=null!==(v=b.split(",")[1])&&void 0!==v?v:"").trim(),y&&g&&b&&(o="".concat(y," - ").concat(g," ").concat(b))}return[{name:o,tracks:u}]}}])&&c(e.prototype,n),r&&c(e,r),a}(r.default);e.default=y},function(t,e,n){"use strict";n(7),n(10),n(11),n(16),n(1),n(18),n(2),n(28),n(19),n(35),n(29),n(0),n(39),n(14),n(4),n(5),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=a(n(55)),i=a(n(51)),o=a(n(9));function a(t){return t&&t.__esModule?t:{default:t}}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p(t);if(e){var i=p(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}function d(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?h(t):e}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(s,t);var e,n,r,a=f(s);function s(){var t;l(this,s);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return m(h(t=a.call.apply(a,[this].concat(n))),"urlRe",/^https?:\/\/(?:www\.)?tracedetrail\.[a-z]{2,}(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*\/trace\/trace\/([0-9]+)/),t}return e=s,(n=[{key:"isOurUrl",value:function(){return this.urlRe.test(this.origUrl)}},{key:"requestOptions",value:function(){var t=this.urlRe.exec(this.origUrl),e=this.trackId=t[1];return[{url:(0,i.default)("https://tracedetrail.com/en/trace/geomSections/".concat(e)),options:{responseType:"json"}}]}},{key:"parseResponse",value:function(t){var e=t[0],n="Tracedetrail track ".concat(this.trackId);try{n=e.responseJSON.nom_fr||n;var r=JSON.parse(e.responseJSON.geometry),i=o.default.CRS.EPSG3857;return[{name:n,tracks:[r.map((function(t){return i.unproject(o.default.point(t.lon,t.lat))}))]}]}catch(t){var a="UNSUPPORTED";return 200===e.status&&(a="Track with id ".concat(this.trackId," was deleted or did not exist")),[{name:n,error:a}]}}}])&&u(e.prototype,n),r&&u(e,r),s}(r.default);e.default=v},function(t,e,n){"use strict";var r;function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=f(t);if(e){var i=f(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return u(this,n)}}function u(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?c(t):e}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n(7),n(10),n(11),n(16),n(1),n(2),n(28),n(19),n(35),n(29),n(0),n(54),n(39),n(14),n(4),n(5),n(43),n(41),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.YandexRuler=void 0;var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(u,t);var e,n,r,i=l(u);function u(){var t;o(this,u);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return d(c(t=i.call.apply(i,[this].concat(n))),"urlRe",/yandex\.(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+[&\?]rl=((?:(?!&)[\s\S])+)/),t}return e=u,(n=[{key:"isOurUrl",value:function(){return this.urlRe.test(this.origUrl)}},{key:"requestOptions",value:function(){return[]}},{key:"parseResponse",value:function(){for(var t,e=0,n=0,r=[],i=this.urlRe.exec(this.origUrl)[1],o=(i=i.replace(/%2C/gi,",")).split("~"),a=0;a<o.length;a++){var s=o[a].split(","),l=parseFloat(s[0]),u=parseFloat(s[1]);if(isNaN(u)||isNaN(l)){t="CORRUPT";break}n+=l,e+=u,r.push({lat:e,lng:n})}return[{error:t,tracks:[r],name:"Yandex ruler"}]}}])&&a(e.prototype,n),r&&a(e,r),u}(((r=n(55))&&r.__esModule?r:{default:r}).default);e.YandexRuler=h},function(t,e,n){"use strict";n(6);var r=e,i=r.Segment={};i.read=function(t,e){return t.readFields(i._readField,{lats:[],lons:[]},e)},i._readField=function(t,e,n){1===t?n.readPackedSVarint(e.lats):2===t&&n.readPackedSVarint(e.lons)},i.write=function(t,e){t.lats&&e.writePackedSVarint(1,t.lats),t.lons&&e.writePackedSVarint(2,t.lons)};var o=r.Waypoint={};o.read=function(t,e){return t.readFields(o._readField,{lat:0,lon:0,name:""},e)},o._readField=function(t,e,n){1===t?e.lat=n.readSVarint():2===t?e.lon=n.readSVarint():3===t&&(e.name=n.readString())},o.write=function(t,e){t.lat&&e.writeSVarintField(1,t.lat),t.lon&&e.writeSVarintField(2,t.lon),t.name&&e.writeStringField(3,t.name)};var a=r.Waypoints={};a.read=function(t,e){return t.readFields(a._readField,{midLat:0,midLon:0,waypoints:[]},e)},a._readField=function(t,e,n){1===t?e.midLat=n.readSVarint():2===t?e.midLon=n.readSVarint():3===t&&e.waypoints.push(o.read(n,n.readVarint()+n.pos))},a.write=function(t,e){if(t.midLat&&e.writeSVarintField(1,t.midLat),t.midLon&&e.writeSVarintField(2,t.midLon),t.waypoints)for(var n=0;n<t.waypoints.length;n++)e.writeMessage(3,o.write,t.waypoints[n])};var s=r.Track={};s.read=function(t,e){return t.readFields(s._readField,{name:"",segments:[],waypoints:null},e)},s._readField=function(t,e,n){1===t?e.name=n.readString():2===t?e.segments.push(i.read(n,n.readVarint()+n.pos)):3===t&&(e.waypoints=a.read(n,n.readVarint()+n.pos))},s.write=function(t,e){if(t.name&&e.writeStringField(1,t.name),t.segments)for(var n=0;n<t.segments.length;n++)e.writeMessage(2,i.write,t.segments[n]);t.waypoints&&e.writeMessage(3,a.write,t.waypoints)};var l=r.View={};l.read=function(t,e){return t.readFields(l._readField,{color:0,shown:!1,ticksShown:!1},e)},l._readField=function(t,e,n){1===t?e.color=n.readVarint(!0):2===t?e.shown=n.readBoolean():3===t&&(e.ticksShown=n.readBoolean())},l.write=function(t,e){t.color&&e.writeVarintField(1,t.color),t.shown&&e.writeBooleanField(2,t.shown),t.ticksShown&&e.writeBooleanField(3,t.ticksShown)};var u=r.TrackView={};u.read=function(t,e){return t.readFields(u._readField,{view:null,track:null},e)},u._readField=function(t,e,n){1===t?e.view=l.read(n,n.readVarint()+n.pos):2===t&&(e.track=s.read(n,n.readVarint()+n.pos))},u.write=function(t,e){t.view&&e.writeMessage(1,l.write,t.view),t.track&&e.writeMessage(2,s.write,t.track)}},function(t,e,n){"use strict";n(7),n(10),n(11),n(22),n(15),n(13),n(1),n(18),n(8),n(2),n(6),n(133),n(124),n(0),n(20),n(4),n(5),n(23),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n(30);var r,i=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==u(t)&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}n.default=t,e&&e.set(t,n);return n}(n(296)),o=n(173),a=(r=n(220))&&r.__esModule?r:{default:r};function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function l(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||p(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}function f(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){c(o,r,i,a,s,"next",t)}function s(t){c(o,r,i,a,s,"throw",t)}a(void 0)}))}}function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||p(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=p(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function p(t,e){if(t){if("string"==typeof t)return m(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(t,e):void 0}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function v(t){var e=t.n,n=Number(t.lt),r=Number(t.ln);return"string"!=typeof e||!e||isNaN(n)||isNaN(r)||n<-90||n>90||r<-180||r>180?{valid:!1}:{valid:!0,point:{lat:n,lng:r,name:e}}}function y(t){if(!t.length)return{valid:!1};var e,n=[],r=h(t);try{for(r.s();!(e=r.n()).done;){var i=e.value,o=[];if(!i||!i.length)return{valid:!1};var a,s=h(i);try{for(s.s();!(a=s.n()).done;){var l=a.value;if(!l||2!==l.length)return{valid:!1};var u=d(l.map(Number),2),c=u[0],f=u[1];if(isNaN(c)||isNaN(f)||c<-90||c>90)return{valid:!1};o.push({lat:c,lng:f})}}catch(t){s.e(t)}finally{s.f()}n.push(o)}}catch(t){r.e(t)}finally{r.f()}return{valid:!0,track:n}}function g(){return(g=f(regeneratorRuntime.mark((function t(e){var n,r,s,c,f,d,p,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=[{name:"Track in url",error:"CORRUPT"}],r=i.decode(e),t.prev=2,s=JSON.parse(r),t.next=9;break;case 6:return t.prev=6,t.t0=t.catch(2),t.abrupt("return",n);case 9:if(s&&s.length){t.next=11;break}return t.abrupt("return",n);case 11:c=[],f=h(s),t.prev=13,p=regeneratorRuntime.mark((function t(){var e,r,i,s,u,f,p,m,g;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((e=d.value).u||e.p||e.t){t.next=3;break}return t.abrupt("return",{v:n});case 3:if(r=void 0,!e.u){t.next=11;break}return t.next=7,(0,a.default)(e.u);case 7:r=t.sent,e.n&&1===r.length&&!r[0].error&&(r[0].name=e.n),t.next=40;break;case 11:if((r={}).name=e.n||"Track",!e.t){t.next=18;break}if((i=y(e.t)).valid){t.next=17;break}return t.abrupt("return",{v:n});case 17:r.tracks=i.track;case 18:if(!e.p){t.next=39;break}r.points=[],s=h(e.p),t.prev=21,s.s();case 23:if((u=s.n()).done){t.next=31;break}if(f=u.value,(p=v(f)).valid){t.next=28;break}return t.abrupt("return",{v:n});case 28:r.points.push(p.point);case 29:t.next=23;break;case 31:t.next=36;break;case 33:t.prev=33,t.t0=t.catch(21),s.e(t.t0);case 36:return t.prev=36,s.f(),t.finish(36);case 39:r=[r];case 40:if(m={},!("c"in e)){t.next=46;break}if(!((g=Number(e.c))<0||g>=o.TRACKLIST_TRACK_COLORS.length)){t.next=45;break}return t.abrupt("return",{v:n});case 45:m.color=g;case 46:"v"in e&&(m.trackHidden=!e.v),"m"in e&&(m.measureTicksShown=Boolean(e.m)),r.forEach((function(t){return Object.assign(t,m)})),c.push.apply(c,l(r));case 50:case"end":return t.stop()}}),t,null,[[21,33,36,39]])})),f.s();case 16:if((d=f.n()).done){t.next=23;break}return t.delegateYield(p(),"t1",18);case 18:if("object"!==u(m=t.t1)){t.next=21;break}return t.abrupt("return",m.v);case 21:t.next=16;break;case 23:t.next=28;break;case 25:t.prev=25,t.t2=t.catch(13),f.e(t.t2);case 28:return t.prev=28,f.f(),t.finish(28);case 31:return t.abrupt("return",c);case 32:case"end":return t.stop()}}),t,null,[[2,6],[13,25,28,31]])})))).apply(this,arguments)}var b=function(t){return g.apply(this,arguments)};e.default=b},function(t,e,n){"use strict";n(7),n(10),n(11),n(16),n(46),n(22),n(15),n(1),n(18),n(8),n(2),n(6),n(28),n(62),n(19),n(59),n(96),n(35),n(34),n(29),n(0),n(39),n(14),n(4),n(5),n(99),n(23),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.MovescountMove=e.MovescountRoute=void 0;var r=o(n(55)),i=o(n(51));function o(t){return t&&t.__esModule?t:{default:t}}function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e,n){return e&&h(t.prototype,e),n&&h(t,n),t}function m(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=w(t);if(e){var i=w(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return g(this,n)}}function g(t,e){return!e||"object"!==f(e)&&"function"!=typeof e?b(t):e}function b(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var k=function(t){m(n,t);var e=y(n);function n(){return d(this,n),e.apply(this,arguments)}return p(n,[{key:"isOurUrl",value:function(){return this.urlRe.test(this.origUrl)}}]),n}(r.default),_=function(t){m(n,t);var e=y(n);function n(){var t;d(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return c(b(t=e.call.apply(e,[this].concat(i))),"urlRe",/^https?:\/\/(?:www\.)?movescount\.com\/([a-z]{2}\/)?map(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*[&\?]route=([0-9]+)/),t}return p(n,[{key:"requestOptions",value:function(){var t=this.urlRe.exec(this.origUrl),e=this.trackId=t[2];return[{url:(0,i.default)("http://www.movescount.com/Move/Route/".concat(e)),options:{responseType:"json",isResponseSuccess:function(t){return 200===t.status||403===t.status}}}]}},{key:"parseResponse",value:function(t){var e=t[0];if(403===e.status)return[{error:"Movescount user disabled viewing this route"}];var n="Movescount route ".concat(this.trackId),r=e.responseJSON;if(!r)return[{name:n,error:"UNSUPPORTED"}];for(var i=[],o=[],a=0;a<r.points.latitudes.length;a++){var s={lat:r.points.latitudes[a],lng:r.points.longitudes[a]};o.push(s);var l=r.points.data[a];l&&i.push(u(u({},s),{},{name:l.name}))}return[{name:n=r.routeName?r.routeName:n,points:i,tracks:[o]}]}}]),n}(k);e.MovescountRoute=_;var S=function(t){m(n,t);var e=y(n);function n(){var t;d(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return c(b(t=e.call.apply(e,[this].concat(i))),"urlRe",/^https?:\/\/(?:www\.)?movescount\.com\/([a-z]{2}\/)?moves\/move([0-9]+)/),t}return p(n,[{key:"requestOptions",value:function(){var t=this.urlRe.exec(this.origUrl),e=this.trackId=t[2];return[{url:(0,i.default)("http://www.movescount.com/Move/Track2/".concat(e)),options:{responseType:"json",isResponseSuccess:function(t){return 200===t.status||403===t.status}}},{url:(0,i.default)("https://www.movescount.com/moves/move".concat(e)),options:{isResponseSuccess:function(t){return 200===t.status||403===t.status||404===t.status}}}]}},{key:"parseResponse",value:function(t){var e=a(t,2),n=e[0],r=e[1];if(403===n.status)return[{error:"Movescount user disabled viewing this activity"}];var i="Movescount move ".concat(this.trackId),o=n.responseJSON;if(!o)return[{name:i,error:"UNSUPPORTED"}];var s=o.TrackPoints.map((function(t){return{lat:t.Latitude,lng:t.Longitude}})),l=(new DOMParser).parseFromString(r.response,"text/html");try{var u=l.querySelector("title").text.trim();i=u||i}catch(t){}return[{name:i,tracks:[s]}]}}]),n}(k);e.MovescountMove=S},function(t,e,n){"use strict";n(7),n(10),n(11),n(16),n(1),n(18),n(2),n(6),n(28),n(19),n(35),n(29),n(0),n(39),n(14),n(4),n(5),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.GarminActivity=e.GarminRoute=void 0;var r=o(n(55)),i=o(n(51));function o(t){return t&&t.__esModule?t:{default:t}}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e,n){return e&&u(t.prototype,e),n&&u(t,n),t}function f(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=v(t);if(e){var i=v(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}function p(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?m(t):e}function m(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var y=function(t){f(n,t);var e=h(n);function n(){return l(this,n),e.apply(this,arguments)}return c(n,[{key:"isOurUrl",value:function(){return this.urlRe.test(this.origUrl)}}]),n}(r.default),g=function(t){f(n,t);var e=h(n);function n(){var t;l(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return a(m(t=e.call.apply(e,[this].concat(i))),"urlRe",/^https?:\/\/connect\.garmin\.com\/modern\/course\/([0-9]+)/),t}return c(n,[{key:"requestOptions",value:function(){var t=this.urlRe.exec(this.origUrl),e=this.trackId=t[1];return[{url:(0,i.default)("https://connect.garmin.com/modern/proxy/course-service/course/".concat(e)),options:{responseType:"json",isResponseSuccess:function(t){return 200===t.status||403===t.status||404===t.status}}}]}},{key:"parseResponse",value:function(t){var e=t[0];if(403===e.status)return[{error:"Garmin Connect user disabled viewing this route"}];if(404===e.status)return[{error:"Garmin Connect route does not exist"}];var n="Garmin Connect route ".concat(this.trackId),r=e.responseJSON;if(!r)return[{name:n,error:"UNSUPPORTED"}];var i=r.coursePoints.map((function(t){return{name:t.name,lat:t.lat,lng:t.lon}})),o=r.geoPoints.map((function(t){return{lat:t.latitude,lng:t.longitude}}));return[{name:n=r.courseName?r.courseName:n,points:i,tracks:[o]}]}}]),n}(y);e.GarminRoute=g;var b=function(t){f(n,t);var e=h(n);function n(){var t;l(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return a(m(t=e.call.apply(e,[this].concat(i))),"urlRe",/^https?:\/\/connect\.garmin\.com\/modern\/activity\/([0-9]+)/),t}return c(n,[{key:"requestOptions",value:function(){var t=this.urlRe.exec(this.origUrl),e=this.trackId=t[1];return[{url:(0,i.default)("https://connect.garmin.com/modern/proxy/activity-service/activity/".concat(e,"/details")),options:{responseType:"json",isResponseSuccess:function(t){return 200===t.status||403===t.status||404===t.status}}}]}},{key:"parseResponse",value:function(t){var e=t[0];if(403===e.status)return[{error:"Garmin Connect user disabled viewing this activity"}];if(404===e.status)return[{error:"Garmin Connect activity does not exist"}];var n="Garmin Connect activity ".concat(this.trackId),r=e.responseJSON;return r?[{name:n,tracks:[r.geoPolylineDTO.polyline.map((function(t){return{lat:t.lat,lng:t.lon}}))]}]:[{name:n,error:"UNSUPPORTED"}]}}]),n}(y);e.GarminActivity=b},function(t,e,n){"use strict";n(7),n(10),n(11),n(16),n(15),n(65),n(13),n(1),n(18),n(8),n(2),n(6),n(28),n(19),n(35),n(29),n(0),n(39),n(14),n(4),n(5),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.SportsTrackerActivity=void 0;var r=a(n(55)),i=a(n(51)),o=a(n(130));function a(t){return t&&t.__esModule?t:{default:t}}function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function h(t,e,n){return e&&d(t.prototype,e),n&&d(t,n),t}function p(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}function m(t,e){return(m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function v(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=b(t);if(e){var i=b(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return y(this,n)}}function y(t,e){return!e||"object"!==c(e)&&"function"!=typeof e?g(t):e}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var w=function(t){p(n,t);var e=v(n);function n(){var t;f(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return u(g(t=e.call.apply(e,[this].concat(i))),"urlRe",/^https?:\/\/(www\.)?sports\x2Dtracker\.com\/workout\/((?:(?!\/)[\s\S])+)\/([0-9a-z]+)/),t}return h(n,[{key:"requestOptions",value:function(){var t=this.urlRe.exec(this.origUrl)[3];return[{url:(0,i.default)("https://api.sports-tracker.com/apiserver/v1/workouts/".concat(t,"/data?samples=100000")),options:{responseType:"binarystring",isResponseSuccess:function(t){return 200===t.status||403===t.status}}},{url:(0,i.default)("https://api.sports-tracker.com/apiserver/v1/workouts/".concat(t,"/combined")),options:{responseType:"binarystring",isResponseSuccess:function(t){return[200,403,404].includes(t.status)}}}]}},{key:"parseResponse",value:function(t){var e,n,r=s(t,2),i=r[0],a=r[1];if(404===a.status)return[{error:"Sports Tracker activity not found"}];if(403===i.status)return[{error:"Sports Tracker user disabled viewing this activity"}];var l="Sports Tracker activity";try{e=JSON.parse(o.default.decode(i.responseBinaryText)),n=JSON.parse(o.default.decode(a.responseBinaryText))}catch(t){return[{name:l,error:"UNSUPPORTED"}]}var u=e.payload.locations.map((function(t){return{lat:t.la,lng:t.ln}}));if(e.payload.description)l=e.payload.description;else{var c=new Date(n.payload.startTime).toDateString();l="".concat(n.payload.fullname," on ").concat(c)}return[{name:l,tracks:[u]}]}}]),n}(function(t){p(n,t);var e=v(n);function n(){return f(this,n),e.apply(this,arguments)}return h(n,[{key:"isOurUrl",value:function(){return this.urlRe.test(this.origUrl)}}]),n}(r.default));e.SportsTrackerActivity=w},function(t,e,n){"use strict";n(7),n(10),n(11),n(16),n(1),n(2),n(28),n(19),n(35),n(29),n(0),n(39),n(14),n(4),n(5),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=a(n(51)),i=a(n(55)),o=a(n(129));function a(t){return t&&t.__esModule?t:{default:t}}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=p(t);if(e){var i=p(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return d(this,n)}}function d(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?h(t):e}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(s,t);var e,n,i,a=f(s);function s(){var t;l(this,s);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return m(h(t=a.call.apply(a,[this].concat(n))),"urlRe",/^https?:\/\/(?:www\.)?openstreetmap\.ru\/\?mapid=([0-9]+)/),t}return e=s,(n=[{key:"getTrackId",value:function(){return this.urlRe.exec(this.origUrl)[1]}},{key:"isOurUrl",value:function(){return this.urlRe.test(this.origUrl)}},{key:"requestOptions",value:function(){var t=this.getTrackId();return[{url:(0,r.default)("https://openstreetmap.ru/mymap.php?id=".concat(t,"&format=gpx")),options:{responseType:"binarystring"}}]}},{key:"parseResponse",value:function(t){var e=this.getTrackId(),n=t[0],r=(0,o.default)(n.responseBinaryText,"PersonalMap ".concat(e),!0);return r?0===r[0].tracks.length&&0===r[0].points.length?[{error:"Personal map is empty or does not exist"}]:r:[{name:name,error:"UNSUPPORTED"}]}}])&&u(e.prototype,n),i&&u(e,i),s}(i.default);e.default=v},function(t,e,n){"use strict";n(7),n(10),n(11),n(16),n(22),n(15),n(13),n(1),n(31),n(8),n(2),n(6),n(50),n(0),n(4),n(5),n(23),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.saveGpx=f,e.saveGpxWithElevations=function(t,e,n){return f(t,e,n,!0)},e.saveKml=function(t,e,n){var o=[];e=e||"Track",e=(0,i.default)(e),e=r.default.encode(e),o.push('<?xml version="1.0" encoding="UTF-8"?>'),o.push('<kml xmlns="http://www.opengis.net/kml/2.2">'),o.push("\t<Document>"),o.push("\t\t<name>".concat(e,"</name>"));var a,u=l(t.entries());try{for(u.s();!(a=u.n()).done;){var c=s(a.value,2),f=c[0],d=c[1];o.push("\t\t<Placemark>"),o.push("\t\t\t<name>Line ".concat(f+1,"</name>")),o.push("\t\t\t<LineString>"),o.push("\t\t\t\t<tessellate>1</tessellate>"),o.push("\t\t\t\t<coordinates>");var h,p=l(d);try{for(p.s();!(h=p.n()).done;){var m=h.value,v=m.lng.toFixed(6),y=m.lat.toFixed(6);o.push("\t\t\t\t\t".concat(v,",").concat(y))}}catch(t){p.e(t)}finally{p.f()}o.push("\t\t\t\t</coordinates>"),o.push("\t\t\t</LineString>"),o.push("\t\t</Placemark>")}}catch(t){u.e(t)}finally{u.f()}return n.forEach((function(t){var e=t.label;e=(0,i.default)(e),e=r.default.encode(e);var n=t.latlng.lng.toFixed(6)+","+t.latlng.lat.toFixed(6)+",0";o.push("\t\t<Placemark>"),o.push("\t\t\t<name>"+e+"</name>"),o.push("\t\t\t<Point>"),o.push("\t\t\t\t<coordinates>"+n+"</coordinates>"),o.push("\t\t\t</Point>"),o.push("\t\t</Placemark>")})),o.push("\t</Document>"),o.push("\t</kml>"),o.join("\n")},Object.defineProperty(e,"saveToString",{enumerable:!0,get:function(){return o.saveNktk}});var r=a(n(130)),i=a(n(279)),o=n(221);function a(t){return t&&t.__esModule?t:{default:t}}function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||u(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=u(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function u(t,e){if(t){if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(t,e):void 0}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function f(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=[],s="1970-01-01T00:00:01.000Z";if(a.push('<?xml version="1.0" encoding="UTF-8" standalone="no" ?>'),a.push('<gpx xmlns="http://www.topografix.com/GPX/1/1" creator="http://nakarte.me" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd" version="1.1">'),n.forEach((function(t){var e=t.label;e=(0,i.default)(e),e=r.default.encode(e),a.push('\t<wpt lat="'.concat(t.latlng.lat.toFixed(6),'" lon="').concat(t.latlng.lng.toFixed(6),'">')),o&&null!==t.latlng.alt&&a.push("\t\t<ele>".concat(t.latlng.alt.toFixed(1),"</ele>")),a.push("\t\t<name>".concat(e,"</name>")),a.push("\t</wpt>")})),t.length>0){e=e||"Track",e=(0,i.default)(e),e=r.default.encode(e),a.push("\t<trk>"),a.push("\t\t<name>"+e+"</name>");var u,c=l(t);try{for(c.s();!(u=c.n()).done;){var f=u.value;a.push("\t\t<trkseg>");var d,h=l(f);try{for(h.s();!(d=h.n()).done;){var p=d.value,m=p.lng.toFixed(6),v=p.lat.toFixed(6),y=o&&null!==p.alt?"<ele>".concat(p.alt.toFixed(1),"</ele>"):"";a.push('\t\t\t<trkpt lat="'.concat(v,'" lon="').concat(m,'">').concat(y,"<time>").concat(s,"</time></trkpt>"))}}catch(t){h.e(t)}finally{h.f()}a.push("\t\t</trkseg>")}}catch(t){c.e(t)}finally{c.f()}a.push("\t</trk>")}return a.push("</gpx>"),a.join("\n")}},function(t,e,n){"use strict";n(18);var r,i=(r=n(9))&&r.__esModule?r:{default:r};i.default.LineUtil.simplifyLatlngs=function(t,e){return t=t.map((function(t){return{x:t.lng,y:t.lat}})),t=(t=i.default.LineUtil.simplify(t,e)).map((function(t){return{lat:t.y,lng:t.x}}))}},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";n(22),n(45),n(8),n(57),n(24),n(23);var r,i=(r=n(9))&&r.__esModule?r:{default:r};n(474);var o=n(170);i.default.Polyline.EditMixinOptions={className:"leaflet-editable-line"},i.default.Polyline.EditMixin={_nodeMarkersZOffset:1e4,startEdit:function(){this._map&&!this._editing&&(this._editing=!0,this._drawingDirection=0,this.setupMarkers(),this.on("remove",this.stopEdit.bind(this)),this._map.on("click",this.onMapClick,this).on("dragend",this.onMapEndDrag,this),i.default.DomEvent.on(document,"keyup",this.onKeyPress,this),this._storedStyle={weight:this.options.weight,opacity:this.options.opacity},this._latlngs.length&&this.setStyle({weight:1.5,opacity:1}),i.default.DomUtil.addClass(this._map._container,"leaflet-line-editing"),this.fire("editstart",{target:this}))},stopEdit:function(t){this._editing&&(this.stopDrawingLine(),this._editing=!1,this.removeMarkers(),i.default.DomEvent.off(document,"keyup",this.onKeyPress,this),this.off("remove",this.stopEdit.bind(this)),this._map.off("click",this.onMapClick,this).off("dragend",this.onMapEndDrag,this),this._latlngs.length&&this.setStyle(this._storedStyle),i.default.DomUtil.removeClass(this._map._container,"leaflet-line-editing"),this.fire("editend",{target:this,userCancelled:t}))},removeMarkers:function(){this.getLatLngs().forEach(function(t){t._nodeMarker&&(this.nodeMarkers.removeLayer(t._nodeMarker),delete t._nodeMarker._lineNode,delete t._nodeMarker),t._segmentOverlay&&(this.segmentOverlays.removeLayer(t._segmentOverlay),delete t._segmentOverlay._lineNode,delete t._segmentOverlay)}.bind(this))},getMarkerIndex:function(t){return this.getLatLngs().indexOf(t._lineNode)},getSegmentOverlayIndex:function(t){return this.getLatLngs().indexOf(t._lineNode)},onNodeMarkerDragEnd:function(t){var e=t.target,n=this.getMarkerIndex(e);this.replaceNode(n,e.getLatLng()),this._setupEndMarkers()},onNodeMarkerMovedChangeNode:function(t){var e=t.target,n=e.getLatLng(),r=e._lineNode;r.lat=n.lat,r.lng=n.lng,this.redraw(),this.fire("nodeschanged")},onNodeMarkerDblClickedRemoveNode:function(t){if(!this._disableEditOnLeftClick&&!(this.getLatLngs().length<2||this._drawingDirection&&2===this.getLatLngs().length)){var e=t.target,n=this.getMarkerIndex(e);this.removeNode(n),this._setupEndMarkers()}},onMapClick:function(t){var e,n;this._drawingDirection?(-1===this._drawingDirection?(e=1,n=0):(e=this._latlngs.length-1,n=this._latlngs.length-1),this.addNode(e,(0,o.wrapLatLngToTarget)(t.latlng,this._latlngs[n]))):this.preventStopEdit||this.stopEdit(!0)},onMapEndDrag:function(t){if(t.distance<15){var e=t.target.dragging._draggable,n=e._startPoint.add(e._newPos).subtract(e._startPos),r=t.target.mouseEventToLatLng({clientX:n.x,clientY:n.y});this.onMapClick({latlng:r})}},startDrawingLine:function(t,e){if(this._editing&&(void 0===t&&(t=1),this._drawingDirection!==t)){if(this.stopDrawingLine(),this._drawingDirection=t,e){var n=-1===this._drawingDirection?0:this.getLatLngs().length;this.spliceLatLngs(n,0,e.latlng),this._setupEndMarkers()}this._map.on("mousemove",this.onMouseMoveFollowEndNode,this),i.default.DomUtil.addClass(this._map._container,"leaflet-line-drawing"),this._map.clickLocked=!0}},stopDrawingLine:function(){if(this._drawingDirection){this._map.off("mousemove",this.onMouseMoveFollowEndNode,this);var t=-1===this._drawingDirection?0:this.getLatLngs().length-1;this.spliceLatLngs(t,1),this._drawingDirection=0,i.default.DomUtil.removeClass(this._map._container,"leaflet-line-drawing"),this._map.clickLocked=!1,this._setupEndMarkers(),this.fire("drawend")}},onKeyPress:function(t){if("input"!==t.target.tagName.toLowerCase())switch(t.keyCode){case 27:case 13:this._drawingDirection?this.stopDrawingLine():this.preventStopEdit||this.stopEdit(!0),i.default.DomEvent.stop(t);break;case 8:case 46:if(this._drawingDirection&&this.getLatLngs().length>2){var e=1===this._drawingDirection?this.getLatLngs().length-2:1;this.removeNode(e),i.default.DomEvent.preventDefault(t)}}},onMouseMoveFollowEndNode:function(t){var e=-1===this._drawingDirection?0:this.getLatLngs().length-1,n=t.latlng;this._latlngs.length>0&&(n=(0,o.wrapLatLngToTarget)(n,this._latlngs[e])),this.spliceLatLngs(e,1,n)},makeNodeMarker:function(t){var e=this;2===this._latlngs.length&&this.setStyle({weight:1.5,opacity:1});var n=this.getLatLngs()[t],r=i.default.marker(n.clone(),{icon:i.default.divIcon({className:"line-editor-node-marker-halo",html:'<div class="line-editor-node-marker"></div>'}),draggable:!0,zIndexOffset:this._nodeMarkersZOffset,projectedShift:function(){return e.shiftProjectedFitMapView()}});r.on("drag",this.onNodeMarkerMovedChangeNode,this).on("dragend",this.onNodeMarkerDragEnd,this).on("dblclick",this.onNodeMarkerDblClickedRemoveNode,this).on("click",this.onNodeMarkerClickStartStopDrawing,this).on("contextmenu",(function(t){this.stopDrawingLine(),this.fire("noderightclick",{nodeIndex:this.getMarkerIndex(r),line:this,mouseEvent:t})}),this),r._lineNode=n,n._nodeMarker=r,r.addTo(this.nodeMarkers)},onNodeMarkerClickStartStopDrawing:function(t){if(!this._disableEditOnLeftClick){var e=t.target,n=this.getLatLngs().length,r=this.getMarkerIndex(e);-1===this._drawingDirection&&1===r||1===this._drawingDirection&&r===n-2?this.stopDrawingLine():r===this.getLatLngs().length-1?this.startDrawingLine(1,t):0===r&&this.startDrawingLine(-1,t)}},makeSegmentOverlay:function(t){var e=this,n=this.getLatLngs(),r=n[t],o=n[t+1];if(o){var a=i.default.polyline([r,o],{weight:10,opacity:0,projectedShift:function(){return e.shiftProjectedFitMapView()}});a.on("mousedown",this.onSegmentMouseDownAddNode,this),a.on("contextmenu",(function(t){this.stopDrawingLine(),this.fire("segmentrightclick",{nodeIndex:this.getSegmentOverlayIndex(a),mouseEvent:t,line:this})}),this),a._lineNode=r,r._segmentOverlay=a,a.addTo(this.segmentOverlays)}},onSegmentMouseDownAddNode:function(t){if(0===t.originalEvent.button&&!this._disableEditOnLeftClick){var e=t.target,n=this.getLatLngs(),r=this.getSegmentOverlayIndex(e)+1,a=i.default.latLngBounds(n[r],n[r-1]).getCenter();this.addNode(r,(0,o.wrapLatLngToTarget)(t.latlng,a)),i.default.Draggable._dragging&&i.default.Draggable._dragging.finishDrag(),n[r]._nodeMarker.dragging._draggable._onDown(t.originalEvent)}},addNode:function(t,e){var n=this.getLatLngs(),r=1===t&&-1===this._drawingDirection,i=t===n.length-1&&1===this._drawingDirection;if(e=e.clone(),this.spliceLatLngs(t,0,e),this.makeNodeMarker(t),!r&&t>=1){if(!i){var o=n[t-1];this.segmentOverlays.removeLayer(o._segmentOverlay),delete o._segmentOverlay._lineNode,delete o._segmentOverlay}this.makeSegmentOverlay(t-1)}i||this.makeSegmentOverlay(t),n.length<3&&this._setupEndMarkers()},removeNode:function(t){var e=this.getLatLngs(),n=e[t],r=n._nodeMarker;delete n._nodeMarker,delete r._lineNode,this.spliceLatLngs(t,1),this.nodeMarkers.removeLayer(r),n._segmentOverlay&&(this.segmentOverlays.removeLayer(n._segmentOverlay),delete n._segmentOverlay._lineNode,delete n._segmentOverlay);var i=e[t-1];i&&i._segmentOverlay&&(this.segmentOverlays.removeLayer(i._segmentOverlay),delete i._segmentOverlay._lineNode,delete i._segmentOverlay,(t<e.length-1||t<e.length&&1!==this._drawingDirection)&&this.makeSegmentOverlay(t-1))},replaceNode:function(t,e){var n=this.getLatLngs(),r=n[t],i=r._nodeMarker;this.nodeMarkers.removeLayer(r._nodeMarker),delete r._nodeMarker,delete i._lineNode,e=e.clone(),this.spliceLatLngs(t,1,e),this.makeNodeMarker(t),r._segmentOverlay&&(this.segmentOverlays.removeLayer(r._segmentOverlay),delete r._segmentOverlay._lineNode,delete r._segmentOverlay,this.makeSegmentOverlay(t));var o=n[t-1];o&&o._segmentOverlay&&(this.segmentOverlays.removeLayer(o._segmentOverlay),delete o._segmentOverlay._lineNode,delete o._segmentOverlay,this.makeSegmentOverlay(t-1))},_setupEndMarkers:function(){var t=this._latlngs.length;if(0!==t){var e=-1===this._drawingDirection?1:0,n=1===this._drawingDirection?t-2:t-1,r=this._latlngs[e]._nodeMarker._icon;if(i.default.DomUtil[-1===this._drawingDirection?"removeClass":"addClass"](r,"line-editor-node-marker-start"),n>=0){var o=this._latlngs[n]._nodeMarker._icon;(1!==this._drawingDirection&&n>0?i.default.DomUtil.addClass:i.default.DomUtil.removeClass)(o,"line-editor-node-marker-end")}}},setupMarkers:function(){this.segmentOverlays||(this.segmentOverlays=i.default.featureGroup().addTo(this._map)),this.nodeMarkers||(this.nodeMarkers=i.default.featureGroup().addTo(this._map)),this.removeMarkers();var t=0,e=this.getLatLngs().length-1;-1===this._drawingDirection&&(t+=1),1===this._drawingDirection&&(e-=1);for(var n=t;n<=e;n++)this.makeNodeMarker(n),n<e&&this.makeSegmentOverlay(n);this._setupEndMarkers()},spliceLatLngs:function(){var t=this.getLatLngs(),e=t.splice.apply(t,arguments);return this.setLatLngs(t),this.fire("nodeschanged"),e},getFixedLatLngs:function(){var t=-1===this._drawingDirection?1:0,e=this._latlngs.length;return 1===this._drawingDirection&&(e-=1),this._latlngs.slice(t,e)},disableEditOnLeftClick:function(t){this._disableEditOnLeftClick=t},highlighNodesForDeletion:function(t,e){if(this._editing)for(var n=this.getLatLngs(),r=0;r<n.length;r++){var o=n[r]._nodeMarker._icon;i.default.DomUtil[r>=t&&r<=e?"addClass":"removeClass"](o,"highlight-delete")}}}},function(t,e,n){"use strict";n.r(e)},,function(t,e,n){"use strict";n(7),n(10),n(11),n(15),n(13),n(1),n(18),n(154),n(8),n(2),n(6),n(314),n(0),n(4),n(5),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.splitLinesAt180Meridian=function(t){return(t||[]).map((function(t){return function(t){var e=t.map((function(t){return t.wrap()})),n=[];if(t.length<2)return n;var r=[e[0]];n.push(r);for(var o=1;o<e.length;o++){var s=e[o],l=e[o-1];if(Math.abs(s.lng-l.lng)<=180)r.push(s);else{var u=i.default.Util.wrapNum(s.lng,[0,360]),c=i.default.Util.wrapNum(l.lng,[0,360]),f=180-1e-6*Math.sign(s.lng),d=180-1e-6*Math.sign(l.lng),h=a(i.default.latLng(l.lat,c),i.default.latLng(s.lat,u),f),p=a(i.default.latLng(l.lat,c),i.default.latLng(s.lat,u),d);r.push(i.default.latLng(p,d).wrap()),r=[i.default.latLng(h,f).wrap(),s],n.push(r)}}return n}(t)})).reduce((function(t,e){var n;return t.push.apply(t,function(t){if(Array.isArray(t))return o(t)}(n=e)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(n)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),t}),[])};var r,i=(r=n(9))&&r.__esModule?r:{default:r};function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function a(t,e,n){var r=e.lat-t.lat,i=e.lng-t.lng;return t.lat+r/i*(n-t.lng)}},,function(t,e,n){"use strict";var r,i=(r=n(9))&&r.__esModule?r:{default:r};n(173),n(479);var o=n(68);i.default.Control.TrackList.Ruler=i.default.Control.extend({options:{position:"topleft"},initialize:function(t,e){i.default.Control.prototype.initialize.call(this,e),this._trackList=t},onAdd:function(t){this._map=t;var e=(0,o.makeButton)("","Measure distance","icon-ruler").container;return this._container=e,i.default.DomEvent.on(e,"click",this.onClick,this),e},onClick:function(){this._trackList.setExpanded(),this._trackList.addTrackAndEdit("Ruler").measureTicksShown(!0)}})},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";n(0),n(20),n(30);var r,i,o,a=(r=n(9))&&r.__esModule?r:{default:r},s=n(295);function l(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}a.default.Control.TrackList.include({hashParams:function(){return(new s.NakarteUrlLoader).paramNames()},loadTrackFromParam:(i=regeneratorRuntime.mark((function t(e,n){var r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n&&n.length){t.next=2;break}return t.abrupt("return");case 2:return this.readingFiles(this.readingFiles()+1),t.next=5,(new s.NakarteUrlLoader).geoData(e,n);case 5:r=t.sent,i=this.addTracksFromGeodataArray(r),this.readingFiles(this.readingFiles()-1),i&&this.setExpanded();case 9:case"end":return t.stop()}}),t,this)})),o=function(){var t=this,e=arguments;return new Promise((function(n,r){var o=i.apply(t,e);function a(t){l(o,n,r,a,s,"next",t)}function s(t){l(o,n,r,a,s,"throw",t)}a(void 0)}))},function(t,e){return o.apply(this,arguments)})})},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n(31),n(8),n(98),n(133),n(14),n(52),n(173);var i=u(n(9)),o=n(221),a=u(n(149)),s=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var e=l();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var a=i?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=t[o]}n.default=t,e&&e.set(t,n);return n}(n(97));function l(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return l=function(){return t},t}function u(t){return t&&t.__esModule?t:{default:t}}i.default.Control.TrackList.include({maxLocalStorageSessions:5,saveTracksToStorage:function(){var t,e,n,r,i,o=this.tracks(),s=[],l=-1,u=[];for(t=0;t<a.default.length;t++)(i=(r=a.default.key(t)).match(/^trackList_([0-9]+)$/))&&void 0!==i[1]&&Number(i[1])>l&&(l=Number(i[1]));if(r="trackList_"+(l+1),0!==o.length){for(t=0;t<o.length;t++)e=o[t],n=this.trackToString(e),s.push(n);if(0!==s.length){for(n="#nktk="+s.join("/"),a.default.setItem(r,n),t=0;t<a.default.length;t++)(i=(r=a.default.key(t)).match(/^trackList_([0-9]+)$/))&&void 0!==i[1]&&u.push(Number(i[1]));if(u.length>this.maxLocalStorageSessions)for(u.sort((function(t,e){return t-e})),t=0;t<u.length-this.maxLocalStorageSessions;t++)r="trackList_"+u[t],a.default.removeItem(r)}}else a.default.setItem(r,"")},loadTracksFromStorage:function(){var t,e,n,r,i,l=-1;for(t=0;t<a.default.length;t++)(n=(e=a.default.key(t)).match(/^trackList_([0-9]+)$/))&&void 0!==n[1]&&Number(n[1])>l&&(l=Number(n[1]));l>-1&&(e="trackList_"+l,r=a.default.getItem(e),a.default.removeItem(e),r&&(s.captureBreadcrumb("load track from localStorage"),r=r.slice(6),i=(0,o.parseNktkSequence)(r),this.addTracksFromGeodataArray(i)))}})},function(t,e,n){"use strict";n(25),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=o(n(9));n(483),n(122);var i=o(n(299));function o(t){return t&&t.__esModule?t:{default:t}}var a=function(t){var e=t.onAdd;t._minimizeEnabled||((0,i.default)(t),r.default.Util.extend(t,{_minimizeEnabled:!0,onAdd:function(t){var n=this,r=e.call(this,t);return setTimeout((function(){return n.__injectMinimizeButtons()}),0),r},__injectMinimizeButtons:function(){for(var t=this._container,e=r.default.DomUtil.create("div","leaflet-control-content");t.childNodes.length;)e.appendChild(t.childNodes[0]);t.appendChild(e);var n=r.default.DomUtil.create("div","button-minimize");this._topRow.appendChild(n);var i=r.default.DomUtil.create("div","leaflet-control-button-toggle",t);i.title="Select layers",r.default.DomEvent.on(i,"click",this.setExpanded,this),r.default.DomEvent.on(n,"click",this.setMinimized,this)},setExpanded:function(){r.default.DomUtil.removeClass(this._container,"minimized")},setMinimized:function(){r.default.DomUtil.addClass(this._container,"minimized")}}),t._map&&t.__injectMinimizeButtons())};e.default=a},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";n(7),n(10),n(11),n(16),n(22),n(15),n(65),n(13),n(1),n(18),n(8),n(98),n(2),n(6),n(0),n(4),n(106),n(5),n(23),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=o(n(9));n(486);var i=o(n(299));function o(t){return t&&t.__esModule?t:{default:t}}function a(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||s(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){if(t){if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n(487);var u=function(t,e){var n,o=e.layers,l=t.onAdd,u=t.unserializeState;t._configEnabled||((0,i.default)(t),r.default.Util.extend(t,{_configEnabled:!0,_allLayersGroups:o,_allLayers:(n=[]).concat.apply(n,a(o.map((function(t){return t.layers})))),onAdd:function(t){return l.call(this,t)},_initializeLayersState:function(){this.updateEnabledLayers()},updateEnabledLayers:function(t){var e=this,n=!1,r=a(this._allLayers);if(r.sort((function(t,e){return t.order-e.order})),r.forEach((function(r){r.layer._justAdded=t&&t.includes(r);var i=r.layer.options.isOverlay;i?e.addOverlay(r.layer,r.title):e.addBaseLayer(r.layer,r.title),!i&&e._map.hasLayer(r.layer)&&(n=!0)})),!n){var i,o=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=s(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}(r);try{for(o.s();!(i=o.n()).done;){var l=i.value;if(!l.layer.options.isOverlay){this._map.addLayer(l.layer);break}}}catch(t){o.e(t)}finally{o.f()}}},unserializeState:function(t){return this.updateEnabledLayers(),u.call(this,t)}}))};e.default=u},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";var r,i=(r=n(9))&&r.__esModule?r:{default:r};i.default.Layer.CustomLayer=i.default.TileLayer.extend({getTileUrl:function(t){var e=this._getZoomForUrl(),n={r:i.default.Browser.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:e,z_1:e+1,x_1024:Math.floor(t.x/1024),y_1024:Math.floor(t.y/1024)};if(this._map&&!this._map.options.crs.infinite){var r=this._globalTileRange.max.y-t.y;this.options.tms&&(n.y=r,n.y_1024=Math.floor(r/1024)),n["-y"]=r}return i.default.Util.template(this._url,i.default.extend(n,this.options))},cloneForPrint:function(t){return new i.default.Layer.CustomLayer(this._url,i.default.Util.extend({},this.options,t))}})},function(t,e,n){"use strict";n(7),n(10),n(11),n(22),n(15),n(13),n(1),n(31),n(8),n(2),n(24),n(6),n(0),n(4),n(5),n(23),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n(489);var r,i=(r=n(9))&&r.__esModule?r:{default:r};function o(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||a(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var l=function(t){var e=t._container.querySelectorAll([".leaflet-top.leaflet-right",".leaflet-bottom.leaflet-right",".leaflet-top.leaflet-left",".leaflet-bottom.leaflet-left"].join(","));function n(t){var n,r=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=a(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw o}}}}(e);try{for(r.s();!(n=r.n()).done;){var o=n.value;o===t?i.default.DomUtil.addClass(o,"leaflet-controls-corner-raised"):i.default.DomUtil.removeClass(o,"leaflet-controls-corner-raised")}}catch(t){r.e(t)}finally{r.f()}}o(e).forEach((function(t){return i.default.DomEvent.on(t,"mouseenter",n.bind(null,t))}))};e.default=l},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";n(7),n(10),n(11),n(15),n(13),n(1),n(8),n(2),n(6),n(0),n(4),n(5),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.getLayers=function(){var t,e=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}(l);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.layer.meta={title:n.title}}}catch(t){e.e(t)}finally{e.f()}var r=[],i={group:"title",layers:l};return r.push(i),{layers:r}};var r=a(n(9));n(274),n(275),n(491),n(493);var i=n(283),o=a(n(51));function a(t){return t&&t.__esModule?t:{default:t}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var l=[{title:"OpenStreetMap",description:"OSM default style",isDefault:!0,layer:r.default.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{code:"O",isOverlay:!1,scaleDependent:!0,print:!0,jnx:!0,shortName:"osm",attribution:'© Участники <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> '})},{title:"OpenCycleMap",description:'<a href="https://www.opencyclemap.org/docs/">(Info and key)</a>',isDefault:!1,layer:r.default.tileLayer("https://{s}.tile.thunderforest.com/cycle/{z}/{x}/{y}.png",{code:"Ocm",isOverlay:!1,scaleDependent:!0,print:!0,hotkey:"H",jnx:!0,shortName:"opencyclemap",attribution:'Thunderforest <a href="https://www.opencyclemap.org/">OpenCycleMap</a>'})},{title:"OpenTopoMap",isDefault:!0,layer:r.default.tileLayer("https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",{code:"Otm",isOverlay:!1,maxNativeZoom:17,scaleDependent:!0,print:!0,jnx:!0,noCors:!1,shortName:"opentopo",attribution:'<a href="https://opentopomap.org/">OpenTopoMap</a>'})},{title:"Yandex Спутник",isDefault:!0,layer:new r.default.Layer.Yandex.Sat({scaleDependent:!1,code:"S",isOverlay:!1,print:!0,jnx:!0,shortName:"yandex_sat",attribution:'<a href="https://yandex.ru/maps/?l=sat">Yandex</a>'})},{title:"Google Спутник",isDefault:!0,layer:new r.default.Layer.GoogleSat({code:"L",isOverlay:!1,scaleDependent:!1,print:!0,jnx:!0,shortName:"google_sat",attribution:'<a href="https://www.google.com/maps/@45.0000194,34.336961,9z">Google</a>'})},{title:"ESRI Спутник",isDefault:!0,layer:r.default.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{code:"E",isOverlay:!1,scaleDependent:!1,maxNativeZoom:18,print:!0,jnx:!0,shortName:"esri",attribution:'ESRI World Imagery for <a href="https://www.arcgis.com/">ArcGIS</a>'})},{title:"Советская карта (zoom ≥ 12)",isDefault:!0,layer:r.default.tileLayer("https://{s}.tiles.nakarte.me/topo500/{z}/{x}/{y}",{code:"B",isOverlay:!0,isOverlayTransparent:!1,tms:!0,scaleDependent:!1,maxNativeZoom:14,minZoom:12,print:!0,jnx:!0,shortName:"topo_500"})},{title:"Разбивка на квадраты",isDefault:!0,layer:new r.default.Layer.SovietTopoGrid({code:"Ng",isOverlay:!0,print:!1,jnx:!1})},{title:"Wikimapia",isDefault:!0,layer:new r.default.Wikimapia({code:"W",hotkey:"W",isOverlay:!0,print:!1,jnx:!1})},{title:"OpenStreetMap GPS трэки",isDefault:!1,layer:r.default.tileLayer("https://{s}.gps-tile.openstreetmap.org/lines/{z}/{x}/{y}.png",{code:"Ot",isOverlay:!0,isOverlayTransparent:!0,scaleDependent:!0,print:!0,jnx:!1,shortName:"osm_gps_traces"})},{title:"Strava трэки",isDefault:!1,layer:new i.RetinaTileLayer([(0,o.default)("https://heatmap-external-a.strava.com/tiles-auth/all/hot/{z}/{x}/{y}.png?px=256"),(0,o.default)("https://heatmap-external-a.strava.com/tiles-auth/all/hot/{z}/{x}/{y}.png?px=512")],{code:"Sa",hotkey:"T",isOverlay:!0,isOverlayTransparent:!0,scaleDependent:!1,print:!0,jnx:!1,subdomains:"abc",noCors:!0,shortName:"strava_all",retinaOptionsOverrides:[{maxNativeZoom:16},{maxNativeZoom:15}]})},{title:"Маркированные маршруты",description:'<a href="https://hiking.waymarkedtrails.org/">https://hiking.waymarkedtrails.org</a>',isDefault:!1,layer:r.default.tileLayer("https://tile.waymarkedtrails.org/hiking/{z}/{x}/{y}.png",{code:"Wh",isOverlay:!0,tms:!1,print:!0,jnx:!1,scaleDependent:!0,shortName:"hiking_trails",isOverlayTransparent:!0})},{title:"Yandex трэки (zoom ≥ 10)",isDefault:!1,layer:new r.default.Layer.Yandex.Tracks({scaleDependent:!0,code:"Ytr",isOverlay:!0,isOverlayTransparent:!0,print:!0,jnx:!1,shortName:"yandex_tracks",noCors:!0})}]},function(t,e,n){"use strict";n(7),n(10),n(11),n(22),n(15),n(13),n(1),n(8),n(2),n(24),n(6),n(34),n(0),n(14),n(4),n(5),n(43),n(23),n(3);var r=a(n(9));n(492);var i=a(n(147)),o=a(n(216));function a(t){return t&&t.__esModule?t:{default:t}}function s(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e){for(var n=String(t);n.length<e;)n="0"+n;return n}var c=[{1:"А",2:"Б",3:"В",4:"Г"},{1:"A",2:"B",3:"C",4:"D"}],f={getQuadName1m:function(t,e,n){var r="";e<0&&(e=-e-1,r+="x"),r+="ABCDEFGHIJKLMNOPQRSTUV"[e]+"-"+u(t+=31,2);for(var i=1;i<=n-1;i++)r+=","+u(t+i,2);return[r]},getQuadName500k:function(t,e,n){var r=this.getQuadName1m(Math.floor(t/2),Math.floor(e/2),1)[0],i=2-2*(1&e)+(1&t)+1,o="-"+i;n>1&&(o+=","+(i+1)),4===n&&(o+=","+this.getQuadName1m(Math.floor((t+2)/2),Math.floor(e/2),1)+"-"+i+","+(i+1));var a,l=[r+o],u=s(c);try{var f=function(){var t=a.value,e=o.replace(/\b[1-4]\b/g,(function(e){return t[e]}));l.push(r+e)};for(u.s();!(a=u.n()).done;)f()}catch(t){u.e(t)}finally{u.f()}return l},getQuadName100k:function(t,e,n){var r=this.getQuadName1m(Math.floor(t/12),Math.floor(e/12),1),i=132-12*(e-12*Math.floor(e/12))+(t-12*Math.floor(t/12))+1;return r=r+"-"+u(i,3),n>1&&(r+=","+u(i+1,3)),4===n&&(r+=","+u(i+2,3)+","+u(i+3,3)),[r]},getQuadName050k:function(t,e,n){var r=this.getQuadName100k(Math.floor(t/2),Math.floor(e/2),1),i=2-2*(1&e)+(1&t)+1,o="-"+i;n>1&&(o+=","+(i+1)),4===n&&(o+=","+this.getQuadName100k(Math.floor((t+2)/2),Math.floor(e/2),1)+"-"+i+","+(i+1));var a,l=[r+o],u=s(c);try{var f=function(){var t=a.value,e=o.replace(/\b[1-4]\b/g,(function(e){return t[e]}));l.push(r+e)};for(u.s();!(a=u.n()).done;)f()}catch(t){u.e(t)}finally{u.f()}return l},_getQuads:function(t,e,n,i){t=r.default.latLngBounds(t);for(var o=[],a=Math.max(t.getSouth(),-84),s=Math.min(t.getNorth(),84),l=360/n,u=Math.floor(a/e);u*e<s;u++){var c,f=u*e,d=f+e;c=f>=76||d<=-76?4:f>=60||d<=-60?2:1;for(var h=t.getWest(),p=t.getEast(),m=Math.floor((h+180)/n/c)*c-Math.round(180/n);m*n<p;m+=c){var v=m*n,y=v+n*c,g=r.default.latLngBounds([[f,v],[d,y]]),b=i(((m+l/2)%l+l)%l-l/2,u,c);o.push({names:b,bounds:g})}}return o},getQuads1m:function(t){return this._getQuads(t,4,6,this.getQuadName1m)},getQuads500k:function(t){return this._getQuads(t,2,3,this.getQuadName500k.bind(this))},getQuads100k:function(t){return this._getQuads(t,4/12,.5,this.getQuadName100k.bind(this))},getQuads050k:function(t){return this._getQuads(t,4/12/2,.25,this.getQuadName050k.bind(this))}};r.default.Layer.SovietTopoGrid=r.default.LayerGroup.extend({options:{},initialize:function(t){r.default.LayerGroup.prototype.initialize.call(this),r.default.Util.setOptions(this,t),this.renderer=r.default.svg({padding:.5}),this._quads={},this._updateRenderer=r.default.Util.throttle(this._updateRenderer,100,this)},onAdd:function(t){this._map=t,t.on("zoomend",this._reset,this),t.on("move",this._update,this),t.on("move",this._updateRenderer,this),this._update()},onRemove:function(t){t.off("zoomend",this._reset,this),t.off("move",this._update,this),this._cleanupQuads(!0)},_addQuad:function(t,e,n,i,o,a){if(!(e in this._quads)){var s={smoothFactor:0,noClip:!0,interactive:!1,fill:!1,opacity:{1:.7,2:.4}[o],color:i,weight:{1:1,2:3}[o],renderer:this.renderer},l=r.default.rectangle(t,s);this.addLayer(l),1===o&&l.bringToBack();var u=[l],c=n[0].replace(/\x2D/g," &ndash; "),f=r.default.Util.template('<span style="color:{color}">{title}</span>',{color:i,title:c}),d=r.default.divIcon({html:f,className:"leaflet-sovietgrid-quadtitle-"+o,iconSize:null}),h=r.default.marker(r.default.latLngBounds(t).getCenter(),{icon:d});this.addLayer(h),u.push(h),this._quads[e]=u,h.on("click contextmenu",this._showContextMenu.bind(this,a,n))}},_showContextMenu:function(t,e,n){var r=[{text:{"1m":"1:1 000 000","500k":"1:500 000","100k":"1:100 000","050k":"1:50 000"}[t],header:!0},{text:"Копировать в буфер обмена",header:!0},{text:e[0],callback:function(){(0,o.default)(e[0],n.originalEvent)}}];e.length>1&&(r.push({text:e[1]+' <span class="leaflet-sovietgrid-lang">RUS</span>',callback:function(){(0,o.default)(e[1],n.originalEvent)}}),r.push({text:e[2]+' <span class="leaflet-sovietgrid-lang">LAT</span>',callback:function(){(0,o.default)(e[2],n.originalEvent)}})),new i.default(r).show(n)},_removeQuad:function(t){this._quads[t].forEach(this.removeLayer.bind(this)),delete this._quads[t]},_addQuads:function(t,e,n,r){t.forEach(function(t){var i=e+t.names[0];this._addQuad(t.bounds,i,t.names,n,r,e)}.bind(this))},_addGrid:function(){var t,e,n=this._map.getBounds(),r=this._map.getZoom();r>=10&&(t=f.getQuads050k(n),e=r>=12?2:1,this._addQuads(t,"050k","#50d",e)),r>=8&&r<12&&(t=f.getQuads100k(n),e=r>=10?2:1,this._addQuads(t,"100k","#d50",e)),r>=6&&r<10&&(t=f.getQuads500k(n),e=r>=8?2:1,this._addQuads(t,"500k","#099",e)),r>=4&&r<8&&(e=r>=6?2:1,t=f.getQuads1m(n),this._addQuads(t,"1m","blue",e))},_reset:function(){this._update(!0)},_cleanupQuads:function(t){if(!0===t)this.clearLayers(),this._quads={};else for(var e=this._map.getBounds(),n=0,r=Object.keys(this._quads);n<r.length;n++){var i=r[n],o=this._quads[i][0];e.intersects(o.getBounds())||this._removeQuad(i)}},_updateRenderer:function(){this.renderer._map&&this.renderer._update()},_update:function(t){this._cleanupQuads(t),this._addGrid()}})},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";n(7),n(10),n(11),n(15),n(13),n(1),n(8),n(2),n(24),n(6),n(0),n(4),n(5),n(3),n(25);var r,i=(r=n(9))&&r.__esModule?r:{default:r},o=n(494);n(496);var a=n(278);function s(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t,e){var n,r,i=!1,o=t[t.length-1];for(r=0;r<t.length;r++)((n=t[r])[0]<=e[0]&&e[0]<o[0]||o[0]<=e[0]&&e[0]<n[0])&&e[1]<(o[1]-n[1])*(e[0]-n[0])/(o[0]-n[0])+n[1]&&(i=!i),o=n;return i}i.default.Wikimapia=i.default.GridLayer.extend({options:{tileSize:1024,updateWhenIdle:!0},initialize:function(t){i.default.GridLayer.prototype.initialize.call(this,t),this.loader=null},onAdd:function(t){this.loader||(this.loader=new o.WikimapiaLoader(t)),i.default.GridLayer.prototype.onAdd.call(this,t),this.on("tileunload",this.onTileUnload,this),t.on("mousemove",this.onMouseMove,this),t.on("click",this.onClick,this)},onRemove:function(t){t.off("mousemove",this.onMouseMove,this),t.off("click",this.onClick,this),this.highlightedPlace&&(this._map.removeLayer(this.highlightedPlace.polygon),this._map.removeLayer(this.highlightedPlace.label),this.highlightedPlace=null),i.default.TileLayer.prototype.onRemove.call(this,t),this.off("tileunload",this.onTileUnload,this)},drawTile:function(t){if(this._map){var e=t._tileData,n=t._adjustment;if(e){var r=t.getContext("2d");r.beginPath(),r.strokeStyle="#CFA600",r.lineWidth=1;var i,o=s(e.places);try{for(o.s();!(i=o.n()).done;){var a=i.value.localPolygon;if(a){if(n){for(var l=n.multiplier,u=n.offsetX,c=n.offsetY,f=[],d=0;d<a.length;d++){var h=a[d];f.push({x:h.x*l-u,y:h.y*l-c})}a=f}r.moveTo(a[0].x,a[0].y);for(var p=void 0,m=1;m<a.length;m++)p=a[m],r.lineTo(p.x,p.y);r.lineTo(a[0].x,a[0].y)}}}catch(t){o.e(t)}finally{o.f()}r.stroke()}}},createTile:function(t,e){var n=this,r=i.default.DomUtil.create("canvas","leaflet-tile");r.width=this.options.tileSize,r.height=this.options.tileSize;var o=this.loader.requestTileData(t),a=o.dataPromise,s=o.abortLoading;return a.then((function(t){t.error||(r._tileData=t.tileData,r._adjustment=t.adjustment,n.drawTile(r),n._tileOnLoad(e,r))})),r._abortLoading=s,r},_tileOnLoad:function(t,e){i.default.Browser.ielt9?setTimeout(i.default.bind(t,this,null,e),0):t(null,e)},onTileUnload:function(t){var e=t.tile;e._abortLoading(),delete e._tileData,delete e._adjustment},_tileCoordsFromEvent:function(t){var e=this._map.getPixelOrigin().add(t.layerPoint),n=this.options.tileSize;return{x:Math.floor(e.x/n),y:Math.floor(e.y/n),z:this._map.getZoom()}},getPlaceAtMousePos:function(t){var e=this._tileCoordsFromEvent(t),n=this._tiles[this._tileCoordsToKey(e)];if(!n)return null;var r=n.el._tileData;return r?this.getPlaceAtLatlng(t.latlng.wrap(),r.places):null},onMouseMove:function(t){var e=this.getPlaceAtMousePos(t);!this.highlightedPlace||e&&this.highlightedPlace.id===e.id||(this._map.removeLayer(this.highlightedPlace.polygon),this._map.removeLayer(this.highlightedPlace.label),this.highlightedPlace=null),e&&!this.highlightedPlace&&(this.highlightedPlace={id:e.id,polygon:i.default.polygon(e.polygon,{weight:0,color:"#E6B800"}),label:i.default.tooltip({className:"wikimapia-tooltip-wrapper"},null)},this.highlightedPlace.label.setLatLng(t.latlng),this.highlightedPlace.polygon.addTo(this._map).bringToBack(),this.highlightedPlace.label.setContent('<div class="wikimapia-tooltip">'.concat(e.title,"</div>")),this._map.addLayer(this.highlightedPlace.label)),this.highlightedPlace&&this.highlightedPlace.label.setLatLng(t.latlng)},onClick:function(t){if(!this._map.clickLocked){var e=this.getPlaceAtMousePos(t);if(e){var n="http://wikimapia.org/".concat(e.id,"/ru/");(0,a.openPopupWindow)(n,564,"wikimapia-details")}}},getPlaceAtLatlng:function(t,e){for(var n,r,i=t.lat,o=t.lng,a=e.length-1;a>=0;a--)if(o>=(n=(r=e[a]).boundsWESN)[0]&&o<=n[1]&&i>=n[2]&&i<=n[3]&&u(r.polygon,[i,o]))return r;return null}})},function(t,e,n){"use strict";n(7),n(10),n(11),n(46),n(22),n(1),n(2),n(28),n(62),n(19),n(59),n(96),n(35),n(34),n(29),n(0),n(39),n(287),n(4),n(5),n(23),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.WikimapiaLoader=void 0;var r,i=n(217),o=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==l(t)&&"function"!=typeof t)return{default:t};var e=s();if(e&&e.has(t))return e.get(t);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var o=r?Object.getOwnPropertyDescriptor(t,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=t[i]}n.default=t,e&&e.set(t,n);return n}(n(495)),a=(r=n(51))&&r.__esModule?r:{default:r};function s(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return s=function(){return t},t}function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e,n){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=v(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=v(t);if(e){var i=v(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return p(this,n)}}function p(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?m(t):e}function m(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(s,t);var e,n,r,i=h(s);function s(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),y(m(e=i.call(this)),"maxZoom",15),y(m(e),"minZoom",1),y(m(e),"tileSize",1024),e._projectObj=t,e}return e=s,(n=[{key:"getFromCache",value:function(t){t=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){y(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},t);for(var e=!0;t.z>=0;){var n=this.makeTileKey(t),r=this._cache.get(n);if(r.found){if(e||!r.value.hasChildren)return r.coords=t,r;break}t.z-=1,t.x=Math.floor(t.x/2),t.y=Math.floor(t.y/2),e=!1}return{found:!1}}},{key:"layerTileToDataTileCoords",value:function(t){var e=t.z-2;if(e>this.maxZoom){var n=this.maxZoom,r=1<<e-n;return{x:Math.floor(t.x/r),y:Math.floor(t.y/r),z:n}}if(e<this.minZoom){var i=this.minZoom,o=1/(1<<i-e);return{x:Math.floor(t.x/o),y:Math.floor(t.y/o),z:i}}return{z:e,x:t.x,y:t.y}}},{key:"makeRequestData",value:function(t){var e=o.makeTileUrl(t);return{url:e=(0,a.default)(e),options:{timeout:2e4}}}},{key:"processResponse",value:function(t){return o.parseTile(t.response,this._projectObj).then((function(t){return{tileData:t,coords:t.coords}}))}},{key:"calcAdjustment",value:function(t,e){var n=f(v(s.prototype),"calcAdjustment",this).call(this,{x:t.x,y:t.y,z:t.z-2},e);return n&&(n.offsetX*=1024,n.offsetY*=1024),n}}])&&c(e.prototype,n),r&&c(e,r),s}(i.TiledDataLoader);e.WikimapiaLoader=g},function(t,e,n){"use strict";n(7),n(10),n(11),n(15),n(13),n(1),n(31),n(18),n(105),n(8),n(116),n(2),n(6),n(226),n(34),n(0),n(53),n(20),n(14),n(4),n(5),n(52),n(43),n(41),n(3),n(25),Object.defineProperty(e,"__esModule",{value:!0}),e.getTileId=u,e.getWikimapiaTileCoords=function(t,e){var n=t.z-2;n<0&&(n=0);n>15&&(n=15);var r=Math.pow(2,n-t.z+Math.log2(e/256)),i=Math.floor(t.x*r),o=Math.floor(t.y*r);return{x:i,y:o,z:n}},e.parseTile=function(t,e){return y.apply(this,arguments)},e.makeTileUrl=function(t){var e=u(t).replace(/([0-9]{3})(?!$)/g,"$1/");return"http://wikimapia.org/z1/itiles/".concat(e,".xy?342342")},n(30);var r,i=(r=n(9))&&r.__esModule?r:{default:r};function o(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}function a(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function s(t){o(a,r,i,s,l,"next",t)}function l(t){o(a,r,i,s,l,"throw",t)}s(void 0)}))}}function s(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t){var e=t.x,n=t.y,r=t.z,i=[];for(n=(1<<r)-n-1,r+=1;r;)i.push((1&e)+2*(1&n)),e>>=1,n>>=1,r-=1;return i.reverse().join("")}function c(t){for(var e=t.length-1,n=0,r=0,i=0;i<t.length;i++){var o=parseInt(t[i],10);n<<=1,r<<=1,n+=1&o,r+=o>>1}return{x:n,y:r=(1<<e)-r-1,z:e}}function f(t){var e,n={},r=s(t.split(""));try{for(r.s();!(e=r.n()).done;){var i=e.value;if(i.length>2)n[(i.charCodeAt(0)-32).toString()]=i.substring(1)}}catch(t){r.e(t)}finally{r.f()}return n}function d(t){for(var e=0,n=["1","0","3","2","5","4","9","28","17","27"];e<n.length;e++){var r=n[e];if(r in t)return t[r]}for(var i=0,o=Object.keys(t);i<o.length;i++){return t[o[i]]}return""}function h(t){for(var e=0,n=[],r=0,i=0;e<t.length;){var o,a=0,s=0;do{s|=(31&(o=t.charCodeAt(e++)-63))<<a,a+=5}while(o>=32);i+=1&s?~(s>>1):s>>1,a=0,s=0;do{s|=(31&(o=t.charCodeAt(e++)-63))<<a,a+=5}while(o>=32);r+=1&s?~(s>>1):s>>1,n.push([r/1e6,i/1e6])}return n}function p(t,e,n){for(var r,i,o=e.x,a=e.y,s=e.z,l=1024*o,u=1024*a,c=[],f=0;f<t.length;f++)r=t[f],(i=n.project(r,s+2)).x-=l,i.y-=u,c.push(i);return c}function m(){return new Promise((function(t){return setTimeout(t,0)}))}function v(t,e,n,r){var o=1024*e.x,a=1024*e.y,s=r.unproject([o,a],e.z+2),l=r.unproject([o+1,a+1],e.z+2),u=s.lat-l.lat;!n&&e.z<15&&(u/=1<<15-e.z);for(var c=[],f=0;f<t.length;f++){var d=t[f];c.push({x:d[0],y:d[1]})}c=i.default.LineUtil.simplify(c,2*u),t=[];for(var h=0;h<c.length;h++){var p=c[h];t.push([p.x,p.y])}return t}function y(){return(y=a(regeneratorRuntime.mark((function t(e,n){var r,i,o,a,l,u,y,g,b,w,k,_,S,x,O;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=(r={}).places=[],!((o=e.split("\n")).length<1)){t.next=5;break}throw new Error("No data in tile");case 5:if(a=o[0].split("|"),(l=a[0])&&l.match(/^[0-3]+$/)){t.next=9;break}throw new Error("Invalid tile header");case 9:r.tileId=l,r.coords=c(l),r.hasChildren="1"===a[1],u=Date.now(),y=s(o.slice(2)),t.prev=14,y.s();case 16:if((g=y.n()).done){t.next=48;break}if(b=g.value,!(Date.now()-u>20)){t.next=23;break}return t.next=22,m();case 22:u=Date.now();case 23:if(w={},!((k=b.split("|")).length<6)){t.next=27;break}return t.abrupt("continue",46);case 27:if((_=k[0]).match(/^[0-9]+$/)){t.next=30;break}return t.abrupt("continue",46);case 30:if(w.id=parseInt(_,10),w.title=d(f(k[5])),"1"===k[6]){t.next=34;break}throw new Error('Unknown wikimapia polygon encoding type: "'.concat(k[6],'"'));case 34:if(S=k[2].match(/^([\x2D0-9]+),([\x2D0-9]+),([\x2D0-9]+),([\x2D0-9]+)$/)){t.next=37;break}throw new Error("Invalid place bounds");case 37:if(w.boundsWESN=S.slice(1).map((function(t){return parseInt(t,10)/1e7})),!((x=h(x=k.slice(7).join("|"))).length<3)){t.next=42;break}throw new Error("Polygon has ".concat(x.length," points"));case 42:O=v(x,r.coords,r.hasChildren,n),w.polygon=O,w.localPolygon=p(O,r.coords,n),i.push(w);case 46:t.next=16;break;case 48:t.next=53;break;case 50:t.prev=50,t.t0=t.catch(14),y.e(t.t0);case 53:return t.prev=53,y.f(),t.finish(53);case 56:return t.abrupt("return",r);case 57:case"end":return t.stop()}}),t,null,[[14,50,53,56]])})))).apply(this,arguments)}},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";var r,i=(r=n(9))&&r.__esModule?r:{default:r};n(68);var o=i.default.Control.Layers.prototype.onAdd;i.default.Control.Layers.include({onAdd:function(t){var e=o.call(this,t);return this._stopContainerEvents(),e}});var a=i.default.Control.Zoom.prototype.onAdd;i.default.Control.Zoom.include({onAdd:function(t){var e=a.call(this,t);return this._container=e,this._stopContainerEvents(),e}})},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n(7),n(10),n(11),n(16),n(15),n(13),n(1),n(8),n(2),n(24),n(6),n(50),n(0),n(14),n(4),n(5),n(43),n(3);var i=h(n(9)),o=h(n(121));n(499),n(68);var a=n(500),s=h(n(147)),l=n(501),u=n(171),c=n(103),f=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var e=d();if(e&&e.has(t))return e.get(t);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){var a=i?Object.getOwnPropertyDescriptor(t,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=t[o]}n.default=t,e&&e.set(t,n);return n}(n(97));function d(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return d=function(){return t},t}function h(t){return t&&t.__esModule?t:{default:t}}function p(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return m(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}i.default.Control.JNX=i.default.Control.extend({includes:i.default.Evented,initialize:function(t,e){var n=this;i.default.Control.prototype.initialize.call(this,e),this._layersControl=t,this.makingJnx=o.default.observable(!1),this.downloadProgressRange=o.default.observable(1),this.downloadProgressDone=o.default.observable(0),this.contextMenu=new s.default((function(){return n.makeMenuItems()}))},getLayerForJnx:function(){var t,e={},n=p(this._layersControl._layers);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.layer;this._map.hasLayer(i)&&i.options&&i.options.jnx&&(e={layer:i,layerName:r.name})}}catch(t){n.e(t)}finally{n.f()}return e},estimateTilesCount:function(t){for(var e=0,n=this._selector.getBounds(),r=(0,l.minZoom)(t);r<=t;r++){var i=this._map.project(n.getNorthWest(),r).divideBy(256).floor(),o=this._map.project(n.getSouthEast(),r).divideBy(256).ceil();e+=Math.ceil((o.x-i.x)*(o.y-i.y))}return e},makeMenuItems:function(){var t=this,e=this.getLayerForJnx(),n=e.layer,r=e.layerName;if(!n)return[{text:"No supported layers"}];for(var i=n.options.maxNativeZoom||n.options.maxZoom||18,o=Math.max(0,i-6),a=this._selector.getBounds().getCenter().lat,s=40075016/Math.pow(2,i)/256*Math.cos(a/180*Math.PI),l=[{text:r,header:!0}],u=function(e){var i=t.estimateTilesCount(e),o=.02*i,a=i>5e4?"jnx-menu-warning":"",u=s.toFixed(2),c=o.toFixed(o>1?0:1),f={text:'<span class="'.concat(a,'">Zoom ').concat(e," (").concat(u," m/pixel) &mdash; ").concat(i," tiles (~").concat(c," Mb)</span>"),callback:function(){return t.makeJnx(n,r,e)},disabled:t.makingJnx()};l.push(f),s*=2},c=i;c>=o;c-=1)u(c);return l},notifyProgress:function(t,e){this.downloadProgressDone(this.downloadProgressDone()+t),this.downloadProgressRange(e)},makeJnx:function(t,e,n){var r=this;f.captureBreadcrumb("start making jnx"),this.makingJnx(!0),this.downloadProgressDone(0);var i=this._selector.getBounds(),o=e.toLowerCase().replace(/[ \(\)]+/,"_"),a="nakarte.me_".concat(o,"_z").concat(n,".jnx"),s=f.randId();this.fire("tileExportStart",{eventId:s,layer:t,zoom:n,bounds:i}),(0,l.makeJnxFromLayer)(t,e,n,i,this.notifyProgress.bind(this)).then((function(t){(0,u.saveAs)(t,a,!0),r.fire("tileExportEnd",{eventId:s,success:!0})})).catch((function(t){f.captureException(t,"Failed to create JNX"),r.fire("tileExportEnd",{eventId:s,success:!1,error:t}),(0,c.notify)("Failed to create JNX: ".concat(t.message))})).then((function(){return r.makingJnx(!1)}))},onAdd:function(t){this._map=t;var e=this._container=i.default.DomUtil.create("div","leaflet-control leaflet-control-jnx");return e.innerHTML='\n                <a class="button" data-bind="visible: !makingJnx(), click: onButtonClicked"\n                 title="Make JNX for Garmin receivers">JNX</a>\n                <div data-bind="\n                    component:{\n                        name: \'progress-indicator\',\n                        params: {progressRange: downloadProgressRange, progressDone: downloadProgressDone}\n                    },\n                    visible: makingJnx()"></div>',o.default.applyBindings(this,e),this._stopContainerEvents(),e},removeSelector:function(){this._selector&&(this._map.removeLayer(this._selector),this._selector=null,this.fire("selectionchange"))},addSelector:function(t){var e=this;t||(t=this._map.getBounds().pad(-.25)),this._selector=new a.RectangleSelect(t).addTo(this._map).on("change",(function(){return e.fire("selectionchange")})).on("click contextmenu",(function(t){i.default.DomEvent.stop(t),e.contextMenu.show(t)})),this.fire("selectionchange")},onButtonClicked:function(){this._selector?this._selector.getBounds().intersects(this._map.getBounds().pad(-.05))?this.removeSelector():(this.removeSelector(),this.addSelector()):this.addSelector()}})},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";n(172),Object.defineProperty(e,"__esModule",{value:!0}),e.RectangleSelect=void 0;var r,i=(r=n(9))&&r.__esModule?r:{default:r};var o=i.default.Rectangle.extend({includes:i.default.Evented,options:{opacity:1,weight:.5,fillOpacity:.2,color:"#3388ff",fillColor:"#3388ff"},onAdd:function(t){i.default.Rectangle.prototype.onAdd.call(this,t),this.markers=[];for(var e=0,n=["top","right","bottom","left"];e<n.length;e++){var r=n[e],o=i.default.marker([0,0],{icon:i.default.divIcon({className:"leaflet-rectangle-select-edge edge-".concat(r)}),draggable:!0}).addTo(t);o.on({drag:this.onMarkerDrag,dragend:this.onMarkerDragEnd},this),this.markers[r]=o}this.placeMarkers(),t.on("zoomend",this.placeMarkers,this)},placeMarkers:function(){var t=this.getBounds(),e=this._map.project(t.getNorthWest()),n=this._map.project(t.getSouthEast()).subtract(e),r=e.add(n.divideBy(2));r=this._map.unproject(r),this.markers.top.setLatLng([t.getNorth(),r.lng]),this.markers.top._icon.style.width="".concat(n.x,"px"),this.markers.top._icon.style.marginLeft="-".concat(n.x/2,"px"),this.markers.right.setLatLng([r.lat,t.getEast()]),this.markers.right._icon.style.height="".concat(n.y,"px"),this.markers.right._icon.style.marginTop="-".concat(n.y/2,"px"),this.markers.bottom.setLatLng([t.getSouth(),r.lng]),this.markers.bottom._icon.style.width="".concat(n.x,"px"),this.markers.bottom._icon.style.marginLeft="-".concat(n.x/2,"px"),this.markers.left.setLatLng([r.lat,t.getWest()]),this.markers.left._icon.style.height="".concat(n.y,"px"),this.markers.left._icon.style.marginTop="-".concat(n.y/2,"px")},onRemove:function(t){for(var e=0,n=Object.values(this.markers);e<n.length;e++){var r=n[e];this._map.removeLayer(r)}this.markers=null,t.off("zoomend",this.placeMarkers,this),i.default.Rectangle.prototype.onRemove.call(this,t)},setBoundsFromMarkers:function(){this.setBounds([[this.markers.top.getLatLng().lat,this.markers.left.getLatLng().lng],[this.markers.bottom.getLatLng().lat,this.markers.right.getLatLng().lng]])},onMarkerDrag:function(){this.setBoundsFromMarkers()},onMarkerDragEnd:function(){this.setBoundsFromMarkers(),this.placeMarkers(),this.fire("change")}});e.RectangleSelect=o},function(t,e,n){"use strict";n(7),n(10),n(11),n(22),n(15),n(13),n(1),n(8),n(2),n(6),n(0),n(20),n(14),n(4),n(5),n(43),n(23),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.makeJnxFromLayer=function(t,e,n,r,i){return g.apply(this,arguments)},e.minZoom=p,n(30);var r,i=(r=n(9))&&r.__esModule?r:{default:r},o=n(502),a=n(271),s=n(67),l=n(112);function u(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function f(t,e,n,r,i,o,a){try{var s=t[o](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(r,i)}function d(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){f(o,r,i,a,s,"next",t)}function s(t){f(o,r,i,a,s,"throw",t)}a(void 0)}))}}var h={responseType:"arraybuffer",timeout:2e4,isResponseSuccess:function(t){return 200===t.status||404===t.status}};function p(t){return Math.max(t-4,0)}function m(t){var e="data:image/png;base64,"+btoa((0,l.arrayBufferToString)(t)),n=new Image;return new Promise((function(t,r){n.onload=function(){return t(n)},n.onerror=function(){return r(new Error("Tile image corrupt"))},n.src=e}))}function v(){return(v=d(regeneratorRuntime.mark((function t(e){var n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m(e);case 3:e=t.sent,t.next=9;break;case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",null);case 9:return(n=document.createElement("canvas")).width=e.width,n.height=e.height,n.getContext("2d").drawImage(e,0,0),r=n.toDataURL("image/jpeg"),i=atob(r.replace(/^data:image\/jpeg;base64,/,"")),t.abrupt("return",(0,l.stringToArrayBuffer)(i));case 17:case"end":return t.stop()}}),t,null,[[0,6]])})))).apply(this,arguments)}function y(t){return t?"PNG"===(0,l.arrayBufferToString)(t.slice(0,4))&&"IEND®B`"===(0,l.arrayBufferToString)(t.slice(-8))?function(t){return v.apply(this,arguments)}(t):"ÿØ"===(0,l.arrayBufferToString)(t.slice(0,2))&&"ÿÙ"===(0,l.arrayBufferToString)(t.slice(-2))?Promise.resolve(t):null:null}function g(){return(g=d(regeneratorRuntime.mark((function t(e,n,r,l,c){var f,d,m,v,g,b,w,k,_,S,x,O,P,L,C,M,j,T,D,q,E,I,A,R,F;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:f=i.default.stamp(e),d=Math.min(f,100),m=new o.JnxWriter(n,f,d),v=new s.XHRQueue,g=!1,w=p(r),k=1,_=r;case 8:if(!(_>=w)){t.next=59;break}return S=i.default.bounds(i.default.CRS.EPSG3857.latLngToPoint(l.getNorthWest(),_).round(),i.default.CRS.EPSG3857.latLngToPoint(l.getSouthEast(),_).round()),x=[],O=e.cloneForPrint({xhrQueue:v}),(P=(0,a.getTempMap)(_,O._rasterizeNeedsFullSizeMap,S)).addLayer(O),t.next=16,O.getTilesInfo({xhrOptions:h,pixelBounds:S,rawData:!0});case 16:L=t.sent,C=L.iterateTilePromises,M=L.count,j=u(C());try{for(j.s();!(T=j.n()).done;)D=T.value,x.push(D)}catch(t){j.e(t)}finally{j.f()}q=0,E=x;case 22:if(!(q<E.length)){t.next=51;break}return I=E[q].tilePromise,A=void 0,t.prev=25,t.next=28,I;case 28:A=t.sent,t.next=36;break;case 31:return t.prev=31,t.t0=t.catch(25),b=t.t0,g=!0,t.abrupt("break",51);case 36:if(null!==(R=A.image)&&200===R.status&&R.response&&R.response.byteLength){t.next=39;break}return t.abrupt("continue",48);case 39:return t.next=41,y(R.response);case 41:if(F=t.sent){t.next=46;break}return b=new Error("Tile image invalid"),g=!0,t.abrupt("break",51);case 46:m.addTile(F,_,A.latLngBounds),c(k/M,4/3);case 48:q++,t.next=22;break;case 51:if((0,a.disposeMap)(P),!g){t.next=55;break}throw x.forEach((function(t){return t.abortLoading()})),b;case 55:k/=4;case 56:_--,t.next=8;break;case 59:return t.abrupt("return",m.getJnx());case 60:case"end":return t.stop()}}),t,null,[[25,31]])})))).apply(this,arguments)}},function(t,e,n){"use strict";n(7),n(10),n(11),n(15),n(13),n(1),n(8),n(2),n(6),n(34),n(0),n(172),n(53),n(4),n(5),n(3),Object.defineProperty(e,"__esModule",{value:!0}),e.JnxWriter=void 0;var r,i=(r=n(9))&&r.__esModule?r:{default:r},o=n(503);function a(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){l=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function l(t){function e(t){return Math.round(t/180*2147483647)}return[e(t.north),e(t.east),e(t.south),e(t.west)]}var u=i.default.Class.extend({initialize:function(t,e,n){this.tiles={},this.productName=t||"Raster map",this.productId=e||0,this.zOrder=n},addTile:function(t,e,n){this.tiles[e]=this.tiles[e]||[],t=new Blob([t]).slice(2);var r={west:n.getWest(),north:n.getNorth(),south:n.getSouth(),east:n.getEast()};this.tiles[e].push({data:t,extents:r})},getJnx:function(){for(var t=0,e=0,n=Object.values(this.tiles);e<n.length;e++){t+=n[e].length}if(0===t)throw new Error("No tiles collected, JNX is empty");if(t>5e4)throw new Error("Too many tiles found (more then 50000)");for(var r,i,s,u,c,f=1e10,d=-1e10,h=-1e10,p=1e10,m=Object.keys(this.tiles).length,v=0,y=Object.values(this.tiles);v<y.length;v++){var g,b=a(y[v]);try{for(b.s();!(g=b.n()).done;){var w=g.value;f=f<w.extents.west?f:w.extents.west,d=d>w.extents.east?d:w.extents.east,h=h>w.extents.north?h:w.extents.north,p=p<w.extents.south?p:w.extents.south}}catch(t){b.e(t)}finally{b.f()}}var k=new o.BinStream(1024,!0);k.writeInt32(4),k.writeInt32(0),s=l({south:p,north:h,west:f,east:d}),k.writeInt32(s[0]),k.writeInt32(s[1]),k.writeInt32(s[2]),k.writeInt32(s[3]),k.writeInt32(m),k.writeInt32(0),k.writeInt32(this.productId),k.writeInt32(0),k.writeInt32(0),k.writeUint32(0),k.writeInt32(this.zOrder),k.seek(52+17*m),k.writeInt32(9),k.writeString("12345678-1234-1234-1234-123456789ABC",!0),k.writeString(this.productName,!0),k.writeString("",!0),k.writeInt16(this.productId),k.writeString(this.productName,!0),k.writeInt32(m);for(var _=0,S=Object.keys(this.tiles);_<S.length;_++)r=S[_],k.writeString("",!0),k.writeString("",!0),k.writeString("",!0),k.writeInt32(r);var x,O=k.tell();k.seek(52);for(var P=0,L=Object.keys(this.tiles);P<L.length;P++)r=L[P],r=parseInt(r,10),k.writeInt32(this.tiles[r].length),k.writeUint32(O),x=34115555/Math.pow(2,r)*Math.cos((h+p)/2/180*Math.PI)/1.1,k.writeInt32(x),k.writeInt32(2),k.writeUint8(0),O+=28*this.tiles[r].length;k.seek(k.size);for(var C=O,M=0,j=Object.keys(this.tiles);M<j.length;M++)for(r=j[M],i=this.tiles[r],u=0;u<i.length;u++)s=l((c=i[u]).extents),k.writeInt32(s[0]),k.writeInt32(s[1]),k.writeInt32(s[2]),k.writeInt32(s[3]),k.writeInt16(256),k.writeInt16(256),k.writeInt32(c.data.size),k.writeUint32(C),C+=c.data.size;var T=[];T.push(k.getBuffer());for(var D=0,q=Object.keys(this.tiles);D<q.length;D++)for(r=q[D],i=this.tiles[r],u=0;u<i.length;u++)c=i[u],T.push(c.data);return T.push("BirdsEye"),new Blob(T)}});e.JnxWriter=u},function(t,e,n){"use strict";n(1),n(8),n(183),n(69),n(315),n(19),n(0),n(107),n(70),n(71),n(72),n(73),n(74),n(75),n(76),n(77),n(78),n(79),n(80),n(81),n(82),n(83),n(84),n(85),n(86),n(87),n(88),n(89),n(90),n(91),n(92),Object.defineProperty(e,"__esModule",{value:!0}),e.BinStream=void 0;var r,i=(r=n(130))&&r.__esModule?r:{default:r};function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.maxSize=1024,this.dv=new DataView(new ArrayBuffer(this.maxSize)),this._pos=0,this.size=0,this.littlEndian=n}var e,n,r;return e=t,(n=[{key:"grow",value:function(){this.maxSize*=2;var t=this.dv.buffer;this.dv=new DataView(new ArrayBuffer(this.maxSize));for(var e=new Uint8Array(this.dv.buffer),n=new Uint8Array(t),r=0;r<n.length;r++)e[r]=n[r]}},{key:"checkSize",value:function(t){this._pos+t>=this.maxSize&&this.grow();var e=this._pos+t;this.size=e>this.size?e:this.size}},{key:"writeUint8",value:function(t){this.checkSize(1),this.dv.setUint8(this._pos,t),this._pos+=1}},{key:"writeInt8",value:function(t){this.checkSize(1),this.dv.setInt8(this._pos,t),this._pos+=1}},{key:"writeInt16",value:function(t){this.checkSize(2),this.dv.setInt16(this._pos,t,this.littlEndian),this._pos+=2}},{key:"writeUint16",value:function(t){this.checkSize(2),this.dv.setUint16(this._pos,t,this.littlEndian),this._pos+=2}},{key:"writeInt32",value:function(t){this.checkSize(4),this.dv.setInt32(this._pos,t,this.littlEndian),this._pos+=4}},{key:"writeUint32",value:function(t){this.checkSize(4),this.dv.setUint32(this._pos,t,this.littlEndian),this._pos+=4}},{key:"writeString",value:function(t,e){t=i.default.encode(t);for(var n=0;n<t.length;n++)this.writeUint8(t.charCodeAt(n));e&&this.writeUint8(0)}},{key:"tell",value:function(){return this._pos}},{key:"seek",value:function(t){this._pos=t}},{key:"getBuffer",value:function(){return this.dv.buffer.slice(0,this.size)}}])&&o(e.prototype,n),r&&o(e,r),t}();e.BinStream=a},function(t,e,n){"use strict";n(50),n(54);var r,i=(r=n(9))&&r.__esModule?r:{default:r};n(128),i.default.Control.JNX.include(i.default.Mixin.HashState),i.default.Control.JNX.include({stateChangeEvents:["selectionchange"],serializeState:function(){var t;if(this._selector){var e=this._selector.getBounds();t=[e.getSouth().toFixed(5),e.getWest().toFixed(5),e.getNorth().toFixed(5),e.getEast().toFixed(5)]}return t},unserializeState:function(t){function e(t){if(t=parseFloat(t),isNaN(t))throw new Error("INVALID VALUE");return t}function n(t,n,r){if((t=e(t))<n||t>r)throw new Error("INVALID VALUE");return t}if(t&&4===t.length){var r,i,o,a;try{r=n(t[0],-86,86),i=e(t[1]),o=n(t[2],-86,86),a=e(t[3])}catch(t){if("INVALID VALUE"===t.message)return!1;throw t}return this.removeSelector(),this.addSelector([[r,i],[o,a]]),!0}return!1}})},function(t,e,n){"use strict";n(124),n(19),n(148);var r=d(n(9)),i=d(n(121)),o=n(68),a=d(n(506));n(122),n(507);var s=n(284);n(508);var l=d(n(509)),u=d(n(510)),c=d(n(511)),f=n(297);function d(t){return t&&t.__esModule?t:{default:t}}function h(t){return t/180*Math.PI}function p(t){return t/Math.PI*180}function m(t){return(Math.round(t)+360)%360}r.default.Control.Azimuth=r.default.Control.extend({options:{position:"bottomleft"},includes:r.default.Evented,initialize:function(t){var e=this;r.default.Control.prototype.initialize.call(this,t),this.trueAzimuth=i.default.observable(null),this.magneticAzimuth=i.default.observable(null),this.distance=i.default.observable(null),this.points={start:null,end:null};var n=r.default.icon({iconUrl:l.default,iconSize:[30,30]}),o=r.default.icon({iconUrl:u.default,iconSize:[30,30]}),a=r.default.icon({iconUrl:c.default,iconSize:[30,45]});this.azimuthLine=r.default.polyline([],{interactive:!1,weight:1.5}),this.markers={single:r.default.marker([0,0],{icon:n,draggable:!0,which:"start"}).on("drag",this.onMarkerDrag,this).on("click",r.default.DomEvent.stopPropagation),start:r.default.marker([0,0],{icon:o,draggable:!0,which:"start",rotationOrigin:"center center",projectedShift:function(){return e.azimuthLine.shiftProjectedFitMapView()}}).on("drag",this.onMarkerDrag,this).on("click",r.default.DomEvent.stopPropagation).on("dragend",this.onMarkerDragEnd,this),end:r.default.marker([0,0],{icon:a,draggable:!0,which:"end",rotationOrigin:"center center",projectedShift:function(){return e.azimuthLine.shiftProjectedFitMapView()}}).on("drag",this.onMarkerDrag,this).on("click",r.default.DomEvent.stopPropagation).on("dragend",this.onMarkerDragEnd,this)}},onAdd:function(t){this._map=t;var e=(0,o.makeButtonWithBar)("leaflet-control-azimuth","Measure bearing, display line of sight","icon-azimuth"),n=e.container,s=e.link,l=e.barContainer;return this._container=n,r.default.DomEvent.on(s,"click",this.onClick,this),l.innerHTML=a.default,i.default.applyBindings(this,l),n},onClick:function(){this.isEnabled()?this.disableControl():this.enableControl()},onMarkerDrag:function(t){var e,n,r,i=t.target;this.setPoints((e={},n=i.options.which,r=i.getLatLng(),n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e))},onMarkerDragEnd:function(){this.elevationControl&&this.showProfile()},enableControl:function(){r.default.DomUtil.addClass(this._container,"active"),r.default.DomUtil.addClass(this._container,"highlight"),r.default.DomUtil.addClass(this._map._container,"azimuth-control-active"),this._map.on("click",this.onMapClick,this),this.fire("enabled"),this._map.clickLocked=!0,this._enabled=!0},disableControl:function(){r.default.DomUtil.removeClass(this._container,"active"),r.default.DomUtil.removeClass(this._container,"highlight"),this.hideProfile(),this.setPoints({start:null,end:null}),r.default.DomUtil.removeClass(this._map._container,"azimuth-control-active"),this._map.off("click",this.onMapClick,this),this._map.clickLocked=!1,this._enabled=!1},isEnabled:function(){return Boolean(this._enabled)},setPoints:function(t){if(Object.assign(this.points,t),(t=this.points).start&&!t.end?this.markers.single.setLatLng(t.start).addTo(this._map):this.markers.single.removeFrom(this._map),t.start&&t.end){var e=(n=t.start,i=t.end,o=r.default.Projection.SphericalMercator.project(n),a=r.default.Projection.SphericalMercator.project(i).subtract(o),p(Math.atan2(a.x,a.y)));this.markers.start.setLatLng(t.start).addTo(this._map).setRotationAngle(e),this.markers.end.setLatLng(t.end).addTo(this._map).setRotationAngle(e),this.azimuthLine.setLatLngs([[t.start,t.end]]).addTo(this._map)}else this.markers.start.removeFrom(this._map),this.markers.end.removeFrom(this._map),this.azimuthLine.removeFrom(this._map);var n,i,o,a;this.updateValuesDisplay()},updateValuesDisplay:function(){if(this.points.start&&this.points.end){var t=this.points,e=(r=t.start,i=t.end,o=h(r.lat),a=h(i.lat),l=h(r.lng),u=h(i.lng),c=Math.sin(u-l)*Math.cos(a),f=Math.cos(o)*Math.sin(a)-Math.sin(o)*Math.cos(a)*Math.cos(u-l),p(Math.atan2(c,f)));this.trueAzimuth(m(e));var n=(0,s.getDeclination)(t.start.lat,t.start.lng);null===n?this.magneticAzimuth(null):this.magneticAzimuth(m(e-n)),this.distance(t.start.distanceTo(t.end))}else this.distance(null),this.trueAzimuth(null),this.magneticAzimuth(null);var r,i,o,a,l,u,c,f},onMapClick:function(t){this.points.start||this.points.end?this.points.start&&!this.points.end?this.setPoints({end:t.latlng}):this.points.start&&this.points.end&&(this.hideProfile(),this.setPoints({start:t.latlng,end:null})):this.setPoints({start:t.latlng})},showProfile:function(){var t=this;if(this.points.end){this.elevationControl&&this.elevationControl.removeFrom(this._map);var e=this.points.start.distanceTo(this.points.end);this.elevationControl=new f.ElevationProfile(this._map,[this.points.start,this.points.end],{samplingInterval:(0,f.calcSamplingInterval)(e),sightLine:!0}),this.elevationControl.on("remove",(function(){t.elevationControl=null})),this.fire("elevation-shown")}},hideProfile:function(){this.elevationControl&&this.elevationControl.removeFrom(this._map),this.elevationControl=null},onProfileButtonClick:function(){this.showProfile()},onReverseButtonClick:function(){this.points.end&&this.points.start&&(this.setPoints({start:this.points.end,end:this.points.start}),this.elevationControl&&this.showProfile())}})},function(t,e,n){"use strict";n.r(e),e.default='<div class="contents">\n    <table>\n        <tr>\n            <td>True azimuth</td>\n            <td data-bind="text: trueAzimuth() !== null ? Math.round(trueAzimuth()) + \'&deg;\' : \'--\'"></td>\n        </tr>\n        <tr>\n            <td>Magnetic azimuth</td>\n            <td data-bind="text: magneticAzimuth() !== null ? magneticAzimuth() + \'&deg;\' : \'--\'"></td>\n        </tr>\n        <tr>\n            <td>Distance</td>\n            <td data-bind="text: distance() === null ? \'--\' :\n                distance() > 2000 ? (distance() / 1000).toFixed(2) + \' km\' : Math.round(distance()) + \' m\'"></td>\n        </tr>\n    </table>\n\n    <div class="buttons">\n        <div class="button" data-bind="click: onReverseButtonClick">Reverse</div>\n        <div class="button" data-bind="click: onProfileButtonClick">Elevation / Sightline</div>\n    </div>\n</div>'},function(t,e,n){"use strict";n.r(e)},,function(t,e,n){"use strict";n.r(e),e.default="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMzAgMzAiPgogICAgPGc+CiAgICAgICAgPGVsbGlwc2Ugcnk9IjE1IiByeD0iMTUiIGN5PSIxNSIgY3g9IjE1IiBmaWxsPSIjNzc3IiBmaWxsLW9wYWNpdHk9IjAuNSIvPgogICAgICAgIDxlbGxpcHNlIHJ5PSIzIiByeD0iMyIgY3k9IjE1IiBjeD0iMTUiIGZpbGw9IiMzMzg4ZmYiIC8+CiAgICA8L2c+Cjwvc3ZnPg=="},function(t,e,n){"use strict";n.r(e),e.default="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMzAgMzAiPgogICAgPGc+CiAgICAgICAgPGVsbGlwc2Ugcnk9IjE1IiByeD0iMTUiIGN5PSIxNSIgY3g9IjE1IiBmaWxsPSIjNzc3IiBmaWxsLW9wYWNpdHk9IjAuNSIvPgogICAgICAgIDxlbGxpcHNlIHJ5PSIzIiByeD0iMyIgY3k9IjE1IiBjeD0iMTUiIGZpbGw9IiMzMzg4ZmYiIC8+CiAgICA8L2c+Cjwvc3ZnPg=="},function(t,e,n){"use strict";n.r(e),e.default="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMzAgNDUiPgogICAgPGc+CiAgICAgICAgPGVsbGlwc2Ugcnk9IjE1IiByeD0iMTUiIGN5PSIyNiIgY3g9IjE1IiBmaWxsPSIjNzc3IiBmaWxsLW9wYWNpdHk9IjAuNSIvPgogICAgICAgIDxwYXRoIGQ9Ik0xNSwyMCBsLTUsMTIgbDEwLDAgeiIgZmlsbD0iIzMzODhmZiIvPgogICAgPC9nPgo8L3N2Zz4="},function(t,e,n){"use strict";n(7),n(10),n(11),n(15),n(13),n(1),n(8),n(2),n(24),n(6),n(0),n(4),n(5),n(148),n(3),n(25),Object.defineProperty(e,"__esModule",{value:!0}),e.LocateControl=void 0;var r=a(n(9)),i=n(68);n(513);var o=a(n(149));function a(t){return t&&t.__esModule?t:{default:t}}function s(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var u="disabled",c="locating",f="enabled",d="enabled_following",h="moving_to_following",p="moving_to_following_first",m="updating_following",v="init",y="button_click",g="location_received",b="location_error",w="user_move",k="map_move_end",_="leaflet_locate_position",S=r.default.LayerGroup.extend({initialize:function(t){r.default.LayerGroup.prototype.initialize.call(this,t),this._locationSet=!1,this._elements={accuracyCircle:r.default.circle([0,0],{radius:1,interactive:!1,fillColor:"#4271a8",color:"#2ba3f7",weight:2}),markerCircle:r.default.circleMarker([0,0],{interactive:!1,radius:10,color:"#2ba3f7",weight:2.5,fill:null,opacity:.8}),markerPoint:r.default.circleMarker([0,0],{interactive:!1,radius:2,weight:0,color:"#2ba3f7",fillOpacity:.8})},this.addLayer(this._elements.accuracyCircle)},onAdd:function(t){r.default.LayerGroup.prototype.onAdd.call(this,t),t.on("zoom",this._onZoom,this),this._updatePrecisionState()},onRemove:function(t){t.off("zoom",this._onZoom,this),r.default.LayerGroup.prototype.onRemove.call(this,t)},_updatePrecisionState:function(){if(this._map&&this._locationSet){var t=this._elements.accuracyCircle._radius<=.8*this._elements.markerCircle.options.radius;t!==this._precise&&(t?(this._elements.accuracyCircle.setStyle({opacity:0,fillOpacity:0}),this.addLayer(this._elements.markerPoint),this.addLayer(this._elements.markerCircle)):(this._elements.accuracyCircle.setStyle({opacity:.8,fillOpacity:.4}),this.removeLayer(this._elements.markerPoint),this.removeLayer(this._elements.markerCircle)),this._precise=t)}},setLocation:function(t,e){this._elements.accuracyCircle.setLatLng(t),this._elements.accuracyCircle.setRadius(e),this._elements.markerCircle.setLatLng(t),this._elements.markerPoint.setLatLng(t),this._locationSet=!0,this._updatePrecisionState()},_onZoom:function(){this._updatePrecisionState()}}),x=r.default.Control.extend({options:{locationAcquireTimeoutMS:1/0,showError:function(t){var e=t.message;alert(e)},maxAutoZoom:17,minAutoZoomDeltaForAuto:4,minDistForAutoZoom:2},initialize:function(t){r.default.Control.prototype.initialize.call(this,t),this._events=[]},onAdd:function(t){var e=this;this._map=t;var n=(0,i.makeButton)("leaflet-control-locate","Где я сейчас?","icon-position"),o=n.container,a=n.link;return this._container=o,r.default.DomEvent.on(a,"click",(function(){return e._handleEvent(y)})),this._marker=new S,this._handleEvent(v),o},moveMapToCurrentLocation:function(t,e,n,i){var a,s=this;try{var l=a=JSON.parse(o.default.getItem(_)),u=l.lat,c=l.lon;a=u&&c?r.default.latLng(u,c):null}catch(t){}if(a){if(this._map.setView(n||a,i||t,{animate:!1}),!("geolocation"in navigator))return;navigator.geolocation.getCurrentPosition((function(e){s._storePositionToLocalStorage(e),n||s._map.setView(r.default.latLng(e.coords.latitude,e.coords.longitude),t,{animate:!1})}),(function(t){1===t.code&&o.default.removeItem(_)}),{enableHighAccuracy:!1,timeout:500,maximumAge:0})}else this._map.setView(n||e,i||t,{animate:!1})},_startLocating:function(){var t=this;if(!("geolocation"in navigator)||!("watchPosition"in navigator.geolocation)){var e={code:0,message:"Geolocation not supported"};setTimeout((function(){t._onLocationError(e)}),0)}this._watchID=navigator.geolocation.watchPosition(this._onLocationSuccess.bind(this),this._onLocationError.bind(this),{enableHighAccuracy:!0,timeout:this.options.locationAcquireTimeoutMS})},_storePositionToLocalStorage:function(t){var e={lat:t.coords.latitude,lon:t.coords.longitude};o.default.setItem(_,JSON.stringify(e))},_onLocationSuccess:function(t){this._handleEvent(g,t),this._storePositionToLocalStorage(t)},_onLocationError:function(t){this._handleEvent(b,t),1===t.code&&o.default.removeItem(_)},_stopLocating:function(){this._watchID&&navigator.geolocation&&navigator.geolocation.clearWatch(this._watchID)},_storeLocation:function(t){this._latlng=r.default.latLng(t.coords.latitude,t.coords.longitude),this._accuracy=t.coords.accuracy},_updateMarkerLocation:function(){this._marker.setLocation(this._latlng,this._accuracy)},_updateMapPositionWhileFollowing:function(){this._updateFollowingStartPosition=this._map.getCenter(),this._updateFollowingDestPosition=this._latlng,this._map.panTo(this._latlng)},_setViewToLocation:function(t){if(this._map&&this._latlng){var e,n=this._map.getZoom(),r=this._map.getBoundsZoom(this._latlng.toBounds(2*this._accuracy)),i=r;if(i=Math.min(i,this.options.maxAutoZoom),t||i-n>=this.options.minAutoZoomDeltaForAuto)e=i;else{var o=this._map.project(this._map.getCenter()),a=this._map.project(this._latlng),s=this._map.getSize(),l=(s.x+s.y)/2;e=o.distanceTo(a)>l*this.options.minDistForAutoZoom?i:n>r?r:n}this._map.setView(this._latlng,e)}},_onMapMove:function(){this._handleEvent(w)},_onMapMoveEnd:function(){var t=this,e=this._map.getCenter();setTimeout((function(){t._map.getCenter().equals(e)&&t._handleEvent(k)}),100)},_isMapOffsetFromFollowingSegment:function(){if(this._updateFollowingStartPosition){var t=this._map.project(this._map.getCenter()),e=this._map.project(this._updateFollowingStartPosition),n=this._map.project(this._updateFollowingDestPosition);return r.default.LineUtil.pointToSegmentDistance(t,e,n)>5}return!0},_isMapCenteredAtLocation:function(){if(!this._latlng||!this._map)return!1;var t=this._map.project(this._latlng),e=this._map.project(this._map.getCenter());return t.distanceTo(e)<5},_updateButtonClasses:function(t,e){var n,i=s(t);try{for(i.s();!(n=i.n()).done;){var o=n.value;r.default.DomUtil.addClass(this._container,o)}}catch(t){i.e(t)}finally{i.f()}var a,l=s(e);try{for(l.s();!(a=l.n()).done;){var u=a.value;r.default.DomUtil.removeClass(this._container,u)}}catch(t){l.e(t)}finally{l.f()}},_setEvents:function(t){var e=t?"on":"off";this._map[e]("move",this._onMapMove,this),this._map[e]("moveend",this._onMapMoveEnd,this)},_handleEvent:function(t,e){if(this._events.push({event:t,data:e}),!this._processingEvent){for(this._processingEvent=!0;this._events.length;)this._processEvent(this._events.shift());this._processingEvent=!1}},_processEvent:function(t){var e=t.event,n=t.data,r=this._state;switch(e){case v:this._setState(u);break;case y:r===u?this._setState(c):r===f?(this._setState(h),this._setViewToLocation()):this._setState(u);break;case g:if(r===u)return;this._storeLocation(n),this._updateMarkerLocation(),r===c||r===p?(this._setViewToLocation(!0),this._setState(p)):r===h?this._setViewToLocation():this._state!==d&&r!==m||(this._updateMapPositionWhileFollowing(),this._setState(m));break;case b:if(r===u)return;this.options.showError(n),this._setState(u);break;case w:r===d&&!this._isMapCenteredAtLocation()&&this._isMapOffsetFromFollowingSegment()&&this._setState(f);break;case k:r===h?this._isMapCenteredAtLocation()?this._setState(d):this._setState(f):r!==m&&r!==p||(this._isMapCenteredAtLocation()||!this._isMapOffsetFromFollowingSegment()?this._setState(d):this._setState(f))}},_setState:function(t){if(this._state!==t){switch(t){case c:this._startLocating(),this._updateButtonClasses(["requesting"],["active","following"]),this._setEvents(!0);break;case u:this._stopLocating(),this._marker.removeFrom(this._map),this._setEvents(!1),this._updateButtonClasses([],["active","highlight","following","requesting"]);break;case f:this._updateButtonClasses(["active","highlight"],["following","requesting"]);break;case p:this._marker.addTo(this._map);break;case d:this._updateButtonClasses(["active","highlight","following"],["requesting"])}this._state=t}}});e.LocateControl=x},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r,i=(r=n(9))&&r.__esModule?r:{default:r};n(515);var o=i.default.Control.Zoom.extend({onAdd:function(t){var e=i.default.Control.Zoom.prototype.onAdd.call(this,t);return this._display=i.default.DomUtil.create("div","leaflet-control-zoom-display"),e.insertBefore(this._display,this._zoomOutButton),t.on("zoomend",this._updateDisplay,this),this._updateDisplay(),e},onRemove:function(t){i.default.Control.Zoom.prototype.onRemove.call(this,t),t.off("zoomend",this._updateDisplay,this)},_updateDisplay:function(){this._display.innerHTML=this._map.getZoom()}});e.default=o},function(t,e,n){"use strict";n.r(e)},function(t,e,n){"use strict";n(18),n(50),n(54);var r,i=(r=n(9))&&r.__esModule?r:{default:r};n(128),n(517);var o=i.default.Marker.extend({initialize:function(t,e){this.title=e;var n=i.default.divIcon({html:'<div class="lealfet-placemark-title"></div>',className:"leaflet-placemark"});i.default.Marker.prototype.initialize.call(this,t,{icon:n})},getTitle:function(){return this.title},onAdd:function(t){i.default.Marker.prototype.onAdd.call(this,t),this.getElement().children[0].innerHTML=this.title,this.on("click",this.onClick,this),t.on("click",this.onMapClick,this),t.suggestedPoint={latlng:this.getLatLng(),title:this.title}},onRemove:function(t){this._map.off("move",this.onMapMove,this),this._map.off("click",this.onMapClick,this),this._map.suggestedPoint=null,i.default.Marker.prototype.onRemove.call(this,t)},onClick:function(){this._map.fire("click",{latlng:this.getLatLng(),suggested:!0}),this._map.removeLayer(this)},onMapClick:function(t){t.suggested||this._map.removeLayer(this)}});i.default.Map.include({showPlacemark:function(t,e){this._placemark&&this.removeLayer(this._placemark),this._placemark=new o(t,e),this.addLayer(this._placemark),this.fire("placemarkshow"),this._placemark.on("remove",this.onPlacemarkRemove,this)},onPlacemarkRemove:function(){this._placemark=null,this.fire("placemarkhide")}});var a=i.default.Class.extend({includes:i.default.Mixin.HashState,stateChangeEvents:["placemarkshow","placemarkhide"],initialize:function(t){this.map=t,this.stateChangeEventsSource="map"},serializeState:function(){var t=this.map._placemark;if(!t)return null;var e=t.getLatLng();return[e.lat.toFixed(6),e.lng.toFixed(6),encodeURIComponent(t.getTitle())]},unserializeState:function(t){var e;if(!t)return!1;var n=parseFloat(t[0]),r=parseFloat(t[1]),o=decodeURIComponent(null!==(e=t[2])&&void 0!==e?e:"");return!(isNaN(n)||isNaN(r)||n<-90||n>90||r<-180||r>180)&&(this.map.showPlacemark(i.default.latLng(n,r),o),!0)}});i.default.Map.include({getPlacemarkHashStateInterface:function(){return new a(this)}})},function(t,e,n){"use strict";n.r(e)}]),[[318,1,2]]]);
//# sourceMappingURL=app.48f0a6d9.js.map