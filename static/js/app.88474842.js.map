{"version":3,"sources":["webpack:///./src/lib/CORSProxy/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/baseService.js","webpack:///./src/lib/xhr-promise/index.js","webpack:///./src/lib/leaflet.control.commons/index.js","webpack:///./src/config.js","webpack:///./src/lib/logging/index.js","webpack:///./src/lib/notifications/index.js","webpack:///./src/lib/binary-strings/index.js","webpack:///./src/lib/controls-styles/controls-styles.css","webpack:///./src/lib/leaflet.hashState/leaflet.hashState.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/gpx.js","webpack:///./src/lib/contextmenu/index.js","webpack:///./src/lib/safe-localstorage/index.js","webpack:///./src/lib/leaflet.layer.canvasMarkers/index.js","webpack:///./src/lib/leaflet.fixes/fixWorldCopyJump.js","webpack:///./src/vendored/github.com/eligrey/FileSaver.js","webpack:///./src/lib/leaflet.control.track-list/track-list.js","webpack:///./src/lib/leaflet.hashState/hashState.js","webpack:///./src/lib/leaflet.control.printPages/decorations.js","webpack:///./src/lib/clipboardCopy/index.js","webpack:///./src/lib/tiled-data-loader/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/parseGeoFile.js","webpack:///./src/lib/stripBom/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/loadFromUrl.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/nktk.js","webpack:///./src/lib/anyElementResizeEvent/index.js","webpack:///./src/lib/knockout.component.progress/progress.js","webpack:///./src/lib/leaflet.layer.rasterize/index.js","webpack:///./src/lib/leaflet.layer.rasterize/TileLayer.js","webpack:///./src/lib/leaflet.layer.yandex/index.js","webpack:///./src/lib/leaflet.layer.google/index.js","webpack:///./src/lib/leaflet.layer.westraPasses/westraPassesMarkers.js","webpack:///./src/lib/popup-window/index.js","webpack:///./src/lib/iconFromBackgroundImage/index.js","webpack:///./src/lib/leaflet.layer.rasterize/CanvasMarkers.js","webpack:///./src/lib/leaflet.polyline-measure/index.js","webpack:///./src/lib/leaflet.layer.RetinaTileLayer/index.js","webpack:///./src/lib/magnetic-declination/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/common/style.css","webpack:///./src/lib/leaflet.events.drag/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/xmlUtils.js","webpack:///./src/vendored/github.com/augustl/js-unzip/js-unzip.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/jsInflate.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/codePages.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/nakarte/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/urlSafeBase64.js","webpack:///./src/lib/leaflet.control.elevation-profile/index.js","webpack:///./src/lib/elevations/index.js","webpack:///./src/lib/leaflet.control.layers.top-row/index.js","webpack:///./src/lib/leaflet.control.azimuth/pointer.svg","webpack:///./src/lib/leaflet.placemark/index.js","webpack:///./src/index.js","webpack:///./src/index.css","webpack:///./src/App.js","webpack:///./src/App.css","webpack:///./src/leaflet-fixes.css","webpack:///./src/lib/leaflet.map.sidebars/index.js","webpack:///./src/lib/leaflet.map.sidebars/style.css","webpack:///./src/lib/leaflet.control.printPages/control.js","webpack:///./src/lib/knockout.component.progress/style.css","webpack:///./src/lib/leaflet.control.printPages/control.css","webpack:///./src/lib/leaflet.control.printPages/pageFeature.js","webpack:///./src/lib/leaflet.control.printPages/page-feature.css","webpack:///./src/lib/contextmenu/contextmenu.css","webpack:///./src/lib/leaflet.control.printPages/map-render.js","webpack:///./src/secrets.js","webpack:///./src/lib/leaflet.layer.rasterize/imgFromDataString.js","webpack:///./src/lib/leaflet.layer.rasterize/Bing.js","webpack:///./src/lib/leaflet.layer.bing/index.js","webpack:///./src/lib/leaflet.layer.rasterize/Yandex.js","webpack:///./src/lib/leaflet.layer.yandex/style.css","webpack:///./src/lib/leaflet.layer.rasterize/Google.js","webpack:///./src/lib/leaflet.layer.rasterize/WestraPasses.js","webpack:///./src/lib/leaflet.layer.westraPasses/index.js","webpack:///./src/lib/leaflet.layer.westraPasses/westraPasses.css","webpack:///./src/lib/leaflet.layer.geojson-ajax/index.js","webpack:///./src/lib/notifications/style.css","webpack:///./src/lib/leaflet.layer.canvasMarkers/canvasMarkers.css","webpack:///./src/lib/leaflet.layer.rasterize/MeasuredLine.js","webpack:///./src/lib/leaflet.polyline-measure/measured_line.css","webpack:///./src/lib/leaflet.layer.rasterize/RetinaTileLayer.js","webpack:///./src/lib/leaflet.control.printPages/form.html","webpack:///./src/lib/leaflet.control.printPages/pdf.js","webpack:///./src/lib/leaflet.control.commons/style.css","webpack:///./src/lib/leaflet.control.printPages/decoration.magnetic-meridians.js","webpack:///./src/lib/leaflet.control.printPages/decoration.scale.js","webpack:///./src/lib/leaflet.control.printPages/decoration.grid.js","webpack:///./src/lib/leaflet.control.caption/index.js","webpack:///./src/lib/leaflet.control.caption/style.css","webpack:///./src/lib/leaflet.control.coordinates/index.js","webpack:///./src/lib/leaflet.control.coordinates/coordinates.css","webpack:///./src/lib/clipboardCopy/style.css","webpack:///./src/lib/leaflet.control.coordinates/formats.js","webpack:///./src/lib/leaflet.control.layers.hotkeys/index.js","webpack:///./src/lib/leaflet.control.layers.hotkeys/style.css","webpack:///./src/lib/leaflet.hashState/Leaflet.Map.js","webpack:///./src/lib/leaflet.hashState/Leaflet.Control.Layers.js","webpack:///./src/lib/leaflet.fixes/index.js","webpack:///./src/lib/leaflet.fixes/style.css","webpack:///./src/adaptive.css","webpack:///./src/lib/leaflet.control.panoramas/index.js","webpack:///./src/lib/leaflet.control.panoramas/style.css","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/mapillary-coverage-layer.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/mapillary-loader.js","webpack:///./src/lib/cache/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/mvt.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/vector_tile_pb.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/style.css","webpack:///./src/lib/leaflet.control.panoramas/lib/common/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/wikimedia/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/wikimedia/coverage-layer.js","webpack:///./src/lib/leaflet.control.panoramas/lib/wikimedia/style.css","webpack:///./src/lib/leaflet.control.track-list/track-list.css","webpack:///./src/lib/file-read/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/zip.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/kml.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/ozi.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/simpleService.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/endomondo.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/etomesto.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/gpsies.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/urlEncode.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/gpslib.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/osm.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/strava.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/tracedetrail.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/yandex.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/nktk_pb.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/nakarte/loadTracksFromJson.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/movescount.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/garmin.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/sportstracker.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/openstreetmapRu.js","webpack:///./src/lib/leaflet.control.track-list/lib/geo_file_exporters.js","webpack:///./src/lib/leaflet.lineutil.simplifyLatLngs/index.js","webpack:///./src/lib/leaflet.control.elevation-profile/elevation-profile.css","webpack:///./src/lib/leaflet.polyline-edit/index.js","webpack:///./src/lib/leaflet.polyline-edit/edit_line.css","webpack:///./src/lib/leaflet.control.track-list/lib/meridian180.js","webpack:///./src/lib/leaflet.control.track-list/control-ruler.js","webpack:///./src/lib/leaflet.control.track-list/ruler.css","webpack:///./src/lib/leaflet.control.track-list/track-list.hash-state.js","webpack:///./src/lib/leaflet.control.track-list/track-list.localstorage.js","webpack:///./src/lib/leaflet.control.layers.minimize/index.js","webpack:///./src/lib/leaflet.control.layers.minimize/style.css","webpack:///./src/lib/leaflet.control.layers.top-row/style.css","webpack:///./src/lib/leaflet.control.layers.configure/index.js","webpack:///./src/lib/leaflet.control.layers.configure/style.css","webpack:///./src/lib/leaflet.control.layers.configure/customLayer.js","webpack:///./src/lib/leaflet.controls.raise-on-focus/index.js","webpack:///./src/lib/leaflet.controls.raise-on-focus/style.css","webpack:///./src/layers.js","webpack:///./src/lib/leaflet.layer.soviet-topomaps-grid/index.js","webpack:///./src/lib/leaflet.layer.soviet-topomaps-grid/style.css","webpack:///./src/lib/leaflet.layer.wikimapia/index.js","webpack:///./src/lib/leaflet.layer.wikimapia/wikimapia-loader.js","webpack:///./src/lib/leaflet.layer.wikimapia/wm-utils.js","webpack:///./src/lib/leaflet.layer.wikimapia/style.css","webpack:///./src/lib/leaflet.control.layers.events/index.js","webpack:///./src/lib/leaflet.control.jnx/index.js","webpack:///./src/lib/leaflet.control.jnx/style.css","webpack:///./src/lib/leaflet.control.jnx/selector.js","webpack:///./src/lib/leaflet.control.jnx/jnx-maker.js","webpack:///./src/lib/leaflet.control.jnx/jnx-encoder.js","webpack:///./src/lib/leaflet.control.jnx/binary-stream.js","webpack:///./src/lib/leaflet.control.jnx/hash-state.js","webpack:///./src/lib/leaflet.control.azimuth/index.js","webpack:///./src/lib/leaflet.control.azimuth/control.html","webpack:///./src/lib/leaflet.control.azimuth/style.css","webpack:///./src/lib/leaflet.control.azimuth/pointer-start.svg","webpack:///./src/lib/leaflet.control.azimuth/pointer-end.svg","webpack:///./src/lib/leaflet.control.locate/index.js","webpack:///./src/lib/leaflet.control.locate/style.css","webpack:///./src/lib/leaflet.control.zoom-display/index.js","webpack:///./src/lib/leaflet.control.zoom-display/style.css","webpack:///./src/lib/leaflet.placemark/style.css","webpack:///./src/lib/leaflet.control.weather/index.js","webpack:///./src/lib/leaflet.control.weather/style.css","webpack:///./src/lib/leaflet.control.weather/images/humidity.svg","webpack:///./src/lib/leaflet.control.search/index.js","webpack:///./src/lib/leaflet.control.search/control.html","webpack:///./src/lib/leaflet.control.search/providers/index.js","webpack:///./src/lib/leaflet.control.search/providers/coordinates.js","webpack:///./src/lib/leaflet.control.search/providers/mapycz/index.js","webpack:///./src/lib/leaflet.control.search/providers/remoteBase.js","webpack:///./src/lib/leaflet.control.search/providers/mapycz/categories.csv","webpack:///./src/lib/leaflet.control.search/style.css"],"names":["url","config","CORSProxyUrl","replace","this","origUrl","Error","isOurUrl","requests","requestOptions","map","it","fetch","options","Promise","all","responses","name","error","parseResponse","decodeURIComponent","e","split","pop","promise","XMLHttpRequestPromise","send","successIfStatus200","xhr","status","retryIfNetworkErrorOrServerError","XMLHttpRequestPromiseError","message","method","data","responseType","timeout","maxTries","retryTimeWait","isResponseSuccess","responseNeedsRetry","headers","withCredentials","resolve","reject","_resolve","_reject","then","bind","postData","_isResponseSuccess","_responseNeedsRetry","_retryTimeWait","triesLeft","XMLHttpRequest","onreadystatechange","_onreadystatechange","_open","k","v","setRequestHeader","open","readyState","_aborted","responseBinaryText","response","byteLength","arrayBufferToString","responseJSON","JSON","parse","_timerId","setTimeout","clearTimeout","abort","XHRQueue","maxSimultaneousRequests","_maxConnections","_queue","_activeCount","_originalAbort","_abortPromise","push","_processQueue","i","indexOf","splice","length","shift","_onRequestReady","containerClass","title","iconClass","cls","container","L","DomUtil","create","makeButton","buttonContainer","link","icon","appendChild","barContainer","stopContainerEvents","DomEvent","disableClickPropagation","disableScrollPropagation","on","stop","noControlClass","href","preventDefault","Control","include","_stopContainerEvents","_container","caption","defaultLocation","crimeaBounds","topLeft","bottomRight","defaultZoom","googleApiUrl","secrets","google","westraDataBaseUrl","elevationsServer","wikimediaCommonsCoverageUrl","geocachingSuUrl","tracksStorageServer","apiServer","weatherServer","msg","extra","window","location","toString","console","log","Sentry","withScope","scope","setExtras","captureMessage","description","setTag","setExtra","captureException","addBreadcrumb","eventName","randId","Math","random","substring","onOk","alertify","alert","value","result","prompt","activeElement","document","tagName","blur","stringToArrayBuffer","s","buf","ArrayBuffer","arr","Uint8Array","charCodeAt","arBuf","chunk","subarray","String","fromCharCode","apply","join","Blob","type","Mixin","HashState","enableHashState","key","defaultInitialState","_hashStateKey","eventSource","stateChangeEventsSource","stateChangeEvents","forEach","event","_onControlStateChanged","hashState","addEventListener","state","_onExternalStateChanged","getState","unserializeState","updateState","serializeState","logging","txt","preferNameFromFile","dom","getSegmentPoints","segment_element","points_elements","getElementsByTagName","points","point_element","lat","parseFloat","getAttribute","lng","isNaN","getRoutePoints","rte_element","DOMParser","parseFromString","documentElement","nodeName","trkName","xmlGetNodeText","tracks","xml","segments","segments_elements","segment_points","getTrackSegments","concat","routes","rte_elements","rte_points","getRoutes","waypoint_elements","waypoints","waypoint_element","waypoint","wptName","symbol_name","getWaypoints","items","keyCode","hide","parent","child","parentNode","isDescendant","target","originalEvent","returnValue","x","clientX","y","clientY","createElement","body","className","style","zIndex","onKeyDown","onMouseDown","createItems","item","setPosition","removeChild","removeEventListener","window_width","innerWidth","window_height","innerHeight","menu_width","offsetWidth","menu_height","offsetHeight","left","top","itemOptions","separator","createSeparator","createItem","el","disabled","header","innerHTML","text","callback","onItemClick","stopPropagation","storage","localStorage","setItem","getItem","localStorageWorks","_storage","n","Object","keys","removeItem","clear","calcIntersectionSum","rect","rects","right","bottom","rect2","sum","max","minX","min","maxX","minY","maxY","MarkerRBush","marker","latlng","a","b","RBush","Layer","CanvasMarkers","GridLayer","extend","async","labelFontName","labelFontSize","iconScale","pane","updateWhenZooming","Browser","mobile","iconsOpacity","labelShadowWidth","initialize","markers","prototype","call","rtree","_regions","_iconPositions","_labelPositions","_labelPositionsZoom","addMarkers","_images","_tileQueue","_hoverMarker","onMarkerEnter","onMarkerLeave","load","resetLabels","redraw","addMarker","insert","removeMarker","removeMarkers","remove","updateMarkers","updateMarker","setMarkerPosition","getMarkers","findLabelPosition","iconCenter","iconSize","textWidth","textHeight","pixelExtents","xPositions","yPositions","minIntersectionSum","Infinity","bestX","bestY","tileW","tileE","tileN","tileS","intersectionSum","search","preloadIcons","urls","newUrls","filter","images","image","src","createTile","coords","done","canvas","width","tileSize","height","drawTile","selectMarkersForDraw","zoom","withoutPadding","_map","iconsHorPad","iconsVertPad","labelsHorPad","labelsVertPad","iconsBounds","latLngBounds","unproject","point","labelsBounds","iconUrls","markerJobs","pointsForMarkers","getWest","getSouth","getEast","getNorth","pointsForLabels","tileMidLongitude","noWrap","wrapLatLngToTarget","p","project","stamp","projectedXY","drawSelectedMarkers","limitLabelsToImage","ctx","getContext","font","Util","template","size","entries","markerId","job","img","imgW","round","imgH","center","isLabel","label","measureText","regionsInTile","region","textBaseline","shadowColor","strokeStyle","fillStyle","lineWidth","shadowBlur","strokeText","fillText","globalAlpha","drawImage","z","findMarkerFromMouseEvent","wrap","onMouseMove","fire","showTooltip","tooltip","toolTip","latLngToLayerPoint","addClass","cursor","removeClass","onMouseOut","onClick","clickLocked","onRightClick","onAdd","getPane","createPane","getPanes","markerPane","onRemove","off","Polyline","shiftProjectedFitMapView","polylineBounds","getBounds","isValid","worldWidth","getPixelWorldBounds","getSize","polylineCenter","getCenter","mapCenter","_projectLatlngs","latlngs","projectedBounds","ring","flat","LatLng","len","projectedShift","Marker","update","_icon","pos","_latlng","_setPos","Map","addInitHook","_lastResetLongitude","abs","Handler","MarkerDrag","_onDrag","_marker","shadow","_shadow","iconPos","getPosition","layerPointToLatLng","oldLatLng","_oldLatLng","targetLng","shiftLongitudeToTarget","p1","getSouthEast","p2","getNorthWest","LatLngBounds","latLng","saveAs","view","navigator","test","userAgent","doc","get_URL","URL","webkitURL","save_link","createElementNS","can_use_save_link","is_safari","HTMLElement","safari","is_chrome_ios","setImmediate","throw_outside","ex","revoke","file","revokeObjectURL","auto_bom","blob","FileSaver","no_auto_bom","object_url","filesaver","force","dispatch_all","event_types","listener","dispatch","INIT","createObjectURL","node","download","MouseEvent","dispatchEvent","DONE","FileReader","reader","onloadend","undefined","readAsDataURL","fs_error","FS_proto","msSaveOrOpenBlob","WRITING","onwritestart","onprogress","onwrite","onabort","onerror","onwriteend","self","TRACKLIST_TRACK_COLORS","TrackSegment","MeasuredLine","includes","EditMixin","weight","lineCap","opacity","unwrapLatLngsCrossing180Meridian","latngs","lastUnwrapped","unwrapped","prevUnwrapped","closestPointToLineSegment","segmentIndex","crs","CRS","EPSG3857","latLngToPoint","segStart","segEnd","pointToLatLng","LineUtil","closestPointOnSegment","isPointCloserToStart","distanceTo","mergeOptions","EditMixinOptions","TrackList","position","lineCursorStyle","interactive","dashArray","lineCursorValidStyle","color","lineCursorInvalidStyle","splitExtensions","splitExtensionsFirstStage","Evented","colors","currentGroup","ko","observable","observableArray","readingFiles","readProgressRange","readProgressDone","_lastTrackColor","trackListHeight","isPlacingPoint","trackAddingPoint","trackAddingSegment","filteredTracks","computed","current_group","utils","arrayFilter","element","group","subscribe","changes","shared","setTab","obj","tab","check_groups","shared_tracks_exists","setCurrentGroup","base_loaded","querySelector","base_tab","classList","add","removeAll","applyBindings","addListener","getContainer","onFileDragDrop","onFileDraging","menu","Contextmenu","copyAllTracksToClipboard","copyVisibleTracks","downloadVisibleTracks","deleteAllTracks","deleteHiddenTracks","_markerLayer","print","scaleDependent","printTransparent","addTo","onMarkerClick","_setAdaptiveHeight","showDefaultTracklist","valueHasMutated","showSharedTracklist","defaultEventHandle","_","maxHeight","offsetTop","setExpanded","setMinimized","dataTransfer","dropEffect","files","loadFilesFromFilesObject","onEnterPressedInInput","this_","loadFilesFromUrl","getTrackPolylines","track","feature","getLayers","layer","getTrackPoints","onButtonNewTrackClicked","trim","addTrackAndEdit","addSegmentAndEdit","stopPlacingPoint","segment","addTrackSegment","startEditTrackSegement","startDrawingLine","addTrack","readFiles","fileDataArray","geodataArray","fileData","filename","addTracksFromGeodataArray","loadFilesFromDisk","captureBreadcrumb","selectFiles","trackUrl","geodata","whenLoadDone","cb","subscription","dispose","geodata_array","origin","hasData","messages","data_empty","line","simplifyLatlngs","fitBounds","CORRUPT","UNSUPPORTED","NETWORK","INVALID_URL","notify","onTrackColorChanged","polyline","setStyle","setMarkerIcon","onTrackVisibilityChanged","visible","addLayer","removeLayer","updateTrackHighlight","onTrackSegmentNodesChanged","getFixedLatLngs","recalculateTrackLength","getLength","formatLength","digits","toFixed","setTrackMeasureTicksVisibility","measureTicksShown","setMeasureTicksVisible","switchMeasureTicksVisibility","onColorSelectorClicked","_contextmenu","show","setViewToTrack","setViewToBounds","getTrackBounds","setViewToAllTracks","immediate","bounds","wrapLatLngBoundsToTarget","maxZoom","flyToBounds","lines","l","getLatLngs","attachColorSelector","index","attachActionsMenu","renameTrack","duplicateTrack","reverseTrack","showElevationProfileForTrack","removeTrack","saveTrackAsFile","geoExporters","saveGpx","saveKml","copyTrackLinkToClipboard","saveGpxWithElevations","_actionsMenu","onButtonAddSegmentClicked","stopEditLine","reverseTrackSegment","trackSegment","stopDrawingLine","ll","reverse","isEdited","_editedLine","deleteTrackSegment","newTrackSegment","_parentTrack","that","copyTracksLinkToClipboard","mouseEvent","serialized","trackToString","hashDigest","btoa","responseText","exporter","extension","addElevations","splitLinesAt180Meridian","extensions","lastIndexOf","slice","toLowerCase","request","reduce","acc","cur","ElevationProvider","get","elevations","alt","fileText","blobFromString","newName","query","showTrackMenu","showMenu","stopEdit","onTrackSegmentClick","_lineJoinActive","joinTrackSegments","startEdit","once","onLineEditEnd","track_row_element","track_container","scrollIfNeeded","scrollTop","offsetBottom","onButtonAddPointClicked","beginPointCreate","_beginPointEdit","stopPlacingPointOnEscPressed","beginPointMove","_movingMarker","movePoint","createNewPoint","newLatLng","getNewPointName","maxNumber","match","parseInt","padStart","parentTrack","suggested","suggestedPoint","addPoint","renamePoint","newSegment","joinToStart","hideLineCursor","originalSegment","latngs2","_lineJoinFromStart","unshift","userCancelled","sourcePoints","onNodeRightClickShowMenu","onSegmentRightClickShowMenu","onTrackMouseEnter","onTrackMouseLeave","onTrackEditStart","onTrackEditEnd","onTrackSegmentDrawEnd","nodeIndex","splitTrackSegment","startLineJoinSelection","startShortCutSelection","newTrackFromSegment","showElevationProfileForSegment","showLineCursor","start","mousepos","_lineCursor","clone","onMouseMoveOnMapForLineCursor","onKeyUpForLineCursor","preventStopEdit","updateLineCursor","cursorStart","onLineCursorHideForJoin","onMouseMoveOnLineForJoin","disableEditOnLeftClick","cursorEnd","startFromNode","_shortCut","startNodeIndex","startLatLng","nodeMarkers","onMouseMoveOnNodeMarkerForShortCut","segmentOverlays","onMouseMoveOnLineSegmentForShortCut","onMouseMoveOnMapForShortCut","onClickNodeMarkerForShortCut","onClickLineSegmentForShortCut","onLineCursorHideForShortCut","updateShortCutSelection","highlighNodesForDeletion","endAtNode","getShortCutNodes","firstNodeToDelete","lastNodeToDelete","rangeValid","shortCutSegment","endNodeIndex","newNodes","spliceLatLngs","hover","onTrackRowMouseEnter","_highlightedTrack","onTrackRowMouseLeave","latlngs1","latlngs2","segment1","srcNodes","trackHidden","featureGroup","touch","bindTooltip","sticky","delay","_trackHighlight","removeFrom","trackHighlight","eachLayer","bringToBack","setMarkerLabel","srcPoint","removePoint","newLabel","forceVisible","saveToString","zip","JSZip","file_names","generateAsync","exportTracks","minTicksIntervalMeters","capturedTrack","pl","capturedBounds","measureTicks","getTicksPositions","hideElevationProfile","_elevationControl","ElevationProfile","samplingInterval","calcSamplingInterval","path","hasTracks","arrayItemsEqual","l1","l2","parseHashParams","args","m","substr","pair","exec","onChange","_listeners","_state","c","values","_saveStateToHash","hasKey","hasOwnProperty","stateItems","hash","pathname","_ignoreChanges","onHashChanged","newState","changedKeys","PrintStaticLayer","printOptions","iterateTilePromises","tilePromise","draw","_drawRaster","isOverlay","overlaySolid","abortLoading","count","_unused_canvas","_unused_printOptions","ta","success","select","execCommand","w","h","showNotification","TiledDataLoader","cacheSize","_cache","Cache","_pendingRequests","_xhrQueue","dataTileCoords","makeTileKey","res","layerTileCoords","_unused_dataTileCoords","_unused_xhr","_unused_originalDataTileCoords","multiplier","offsetX","offsetY","layerTileToDataTileCoords","getFromCache","found","dataPromise","tileData","adjustment","calcAdjustment","dataTileKey","makeRequestData","fetchPromise","put","processResponse","pendingRequest","refCount","parsers","parsed","services","ServiceClass","service","geoData","trackView","shown","ticksShown","deltaEncodedSegments","deltaEncodeSegment","deltaLats","deltaLons","lats","lons","midLon","midLat","wp","arcUnit","packedWaypoints","lon","pbf","Pbf","versionStr","TrackView","write","finish","urlSafeBase64","encode","decode","parseNktkOld","track_data","parseNktkFragment","element2","PackedStreamReader","_string","lastLon","lastLat","deltaLon","deltaLat","deltaDecodeSegment","encodedLat","encodedLon","version","segmentsCount","pointsCount","midX","midY","waypointName","wayPoints","readNumber","readString","utf8","j","Boolean","parseNktkProtobuf","read","unpackNumber","ResizeObserver","observe","setInterval","newWidth","newHeight","components","register","viewModel","params","progress","pureComputed","range","progressRange","progressDone","fullSize","pixelBounds","divideBy","assign","visibility","fadeAnimation","zoomAnimation","inertia","setView","noop","GridLayerGrabMixin","tileImagePromiseFromCoords","_unused_coords","waitTilesReadyToGrab","getTilesInfo","tileRange","_pxBoundsToTileRange","tilePromiseIterator","Point","_tileZoom","_isValidTile","tilePos","_getTilePos","coordsPlusOne","tilePlusOne","subtract","_level","_wrapCoords","TileLayerGrabMixin","cloneForPrint","tileLayer","_url","xhrOptions","getTileUrl","noCors","xhrQueue","rawData","imgFromDataString","TileLayer","yandexCrs","EPSG3395","Yandex","subdomains","retina","yandexScale","tilePosLatLng","scaleBy","getTileSize","bounds2","Bounds","tile","coordsBelow","_adjustHeight","_initTile","Sat","Tracks","minZoom","maxNativeZoom","GoogleBase","_getZoomForUrl","_getSubdomain","lang","language","GoogleMap","GoogleTerrain","GoogleHybrid","GoogleSat","WestraPassesMarkers","filePasses","baseUrl","showPassDescription","_baseUrl","loadData","_downloadStarted","_loadMarkers","_makeTooltip","properties","grade","elevation","is_summit","_passToGpx","gpx","_passToKml","kml","_makeIcon","grade_eng","features","latlon","_dataLoaded","reports","id","altnames","connects","comments","comment","user","content","reports_total","reports_photo","reports_tech","slopes","author","openPopup","maxWidth","getElementById","onclick","openPopupWindow","uniqName","screenLeft","screen","availLeft","bordersWidth","screenX","outerWidth","availWidth","screenY","newWindow","closed","focus","f","cache","getComputedStyle","backgroundImage","offsetLeft","arg","_printProgressWeight","cloneMarker","cloneMarkers","printIconsOpacity","resolution","scale","destPixelSize","getTopRight","getBottomLeft","dummyMap","minTicksIntervalMm","_ticks","updateTicks","updateTicksLater","_clearTicks","tick","_addTick","transformMatrixString","transformMatrix","childNodes","transform","setLatLng","labelText","distanceValue","divIcon","html","keyboard","step","ticks","addTick","normalizedBounds","wrapLatLngBounds","normalizedPosition","positionMinus360","positionPlus360","contains","sinCos","dx","dy","sqrt","sinCosFromLatLonSegment","sin","cos","nextPointMeasure","q","lastTickMeasure","lastPointMeasure","_latlngs","points_n","pad","rad","PI","mercatorMetersPerPixel","referencePoint","mapScale","oldTicks","oldMarker","measuredLine","RetinaTileLayer","tileSizeMultiplicator","hiRes","useHiResTiles","newOptions","retinaOptionsOverrides","declination","minLat","maxLat","row1","floor","row2","dlat","col1","col2","dlon","colsCount","a1","getArrayValue","a2","v1","rowsCount","row","col","ind","ar1","atob","array","ar2","Float32Array","valueScale","offset","valueOffset","DragEvents","dragTolerance","dragButtons","stopOnLeave","setOptions","dragButton","startEvent","prevEvent","isDragging","button","disableImageDrag","disableTextSelection","_moveHandler","onMouseUp","onMouseLeave","fireDragEvent","finishDrag","tolerance","prevPos","dragMovement","enableImageDrag","enableTextSelection","Array","nodeValue","JSUnzip","fileContents","BigEndianBinaryStream","MAGIC_NUMBER","readEntries","isZipFile","ZipEntry","getByteRangeAsNumber","binaryStream","signature","getNextBytesAsNumber","versionNeeded","bitFlag","compressionMethod","timeBlob","isEncrypted","crc32","compressedSize","uncompressedSize","isUsingZip64","fileNameLength","extraFieldLength","fileName","getNextBytesAsString","isUsingBit3TrailingDataDescriptor","isUsingUtf8","escape","stream","resetByteIndex","currentByteIndex","getByteAt","steps","getByteRangeAsString","charCode","compressed","originalSize","out","s2","flattenArray","ar","parsePointFromHashValues","NakarteTrack","parseTrackUrlData","BaseService","NakarteUrlLoader","loaders","nktk","loadFromTextEncodedTrack","nktl","loadFromTextEncodedTrackId","nktu","loadFromUrlencodedUrls","nktp","loadPoint","nktj","loadFromJSON","paramName","loader","trackId","r","parseNktkSequence","loadTracksFromJson","loadFromUrl","NakarteUrl","paramNames","_params","promises","decoded","samplingIntgerval","createSvg","attributes","setAttribute","gradientToAngle","g","atan","Class","sightLine","samples","lastSampleDist","lastPointDistance","nextPointDistance","pathRegularSamples","crimea_bounds","horizZoom","dragStart","_addTo","_onWindowResize","_resizeGraph","newSvgWidth","drawingContainer","clientWidth","svgWidth","svg","updateGraph","updateGraphSelection","_controlContainer","setupContainerLayout","trackMarker","onLineMouseMove","onLineMouseEnter","onLineMouseLeave","polyLineSelection","propsContainer","leftAxisLables","closeButton","onCloseButtonClick","graphCursor","graphCursorLabel","graphSelection","svgHeight","clientHeight","onSvgMouseMove","onSvgEnter","onSvgLeave","onSvgMouseWheel","svgDragEvents","onSvgDragStart","onSvgDragEnd","onSvgDrag","onSvgClick","onSvgDblClick","selStartIndex","roundedSampleIndexFromMouseEvent","graphContainerOffsetFromMouseEvent","getBoundingClientRect","sampleIndexFromMouseEvent","setTrackMarkerLabel","getElementsByClassName","setGraphSelection","cursorIndex","selMinInd","selMaxInd","selStart","selEnd","cursorShow","stats","calcProfileStats","updatePropsDisplay","scrollLeft","setLatLngs","setMapPositionAtIndex","panTo","oldHorizZoom","getWheelDelta","newScrollLeft","setupGraph","cursorHide","setCursorPosition","d","noData","maxElev","minElev","startElev","endElev","change","ascentAngleStr","descentAngleStr","ascent","descent","startApprox","endApprox","approx","incomplete","end","finalAscent","angleAvgAscent","avg","angleMaxAscent","angleAvgDescent","angleMaxDescent","dist","distance","dataLostAtStart","dataLostAtEnd","dataLost","calcGridValues","minValue","maxValue","ticksN","tickStep","tick1","ticksNs","tickSteps","matchFound","ceil","filterElevations","scanStart","scanEnd","linearValue","linearDelta","maxError","maxErrorInd","filtered","queue","notNullValues","firstNotNullValue","lastNotNullValue","firstNotNullIndex","lastNotNullIndex","ascents","descents","prevNotNullValue","prevNotNullIndex","gradient","gradientAvgAscent","gradientMinAscent","gradientMaxAscent","angleMinAscent","gradientAvgDescent","gradientMinDescent","gradientMaxDescent","angleMinDescent","delta","angleStr","distanceStr","sample1","sample2","indInt","markerPos","elevationStr","cursorLabel","indFrac","sqrDist","latlng1","latlng2","di","nextDist","nextSampleDist","prevDist","prevSampleDist","nearestInd","minDist","mouseLatlng","hasChildNodes","lastChild","horizStep","verticalMultiplier","gridValues","gridStep","x1","x2","valueToSvgCoord","startNewSegment","y1","y2","serverUrl","chunkSize","respValues","control","originalOnAdd","_topRowEnabled","__injectTopRow","_topRow","_section","insertBefore","Placemark","getTitle","getElement","children","onMapClick","getLatLng","onMapMove","showPlacemark","_placemark","onPlacemarkRemove","PlacemarkHashStateInterface","placemark","encodeURIComponent","getPlacemarkHashStateInterface","uid","preconnect","preconnectLink","rel","head","dnsPrefetchLink","RELEASE_VER","cookieUid","cookie","uidRaw","toUpperCase","getUid","App","setUp","startInfo","localStorageKeys","safeLocalStorage","fixAll","MapWithSidebars","zoomControl","attributionControl","inertiaMaxSpeed","worldCopyJump","tap","tracklist","Caption","ZoomDisplay","SearchControl","stackHorizontally","maxMapWidthToMinimize","Coordinates","Weather","locateControl","LocateControl","showError","code","customMessage","locationErrorMessage","state_map","validateState","validPositionInHash","valid","moveMapToCurrentLocation","Panoramas","layersControl","layers","collapsed","state_layers","attribution","prefix","addControl","parentElement","removeControl","trackNames","tracksHashParams","hashParams","param","loadTracksFromStorage","tracksAfterLoadFromStorage","bindHashStateReadOnly","loadTrackFromParam","tracksAfterLoadFromHash","logEvent","saveTracksToStorage","0","1","2","_sidebarsContainer","setupSidebarsLayout","_mapContainer","onElementResize","requestAnimFrame","invalidateSize","_sidebarContainers","sidebars","midColumn","addElementToSidebar","barName","removeElementFromSidebar","extenders","checkNumberRange","newValue","notifySubscribers","PrintPages","defaultMargin","pageSizes","zoomLevels","pages","zoomLevel","pageWidth","pageHeight","settingsExpanded","makingPdf","downloadProgressRange","downloadProgressDone","marginLeft","marginRight","marginTop","marginBottom","autoZoomLevels","printSize","_printSize","onPageSizeChanged","pageSizeDescription","_displayPageSize","pagesNum","pagesNumLabel","_pagesNumLabel","gridOn","magneticMeridiansOn","notifyChange","updateFormZooms","formHtml","addPage","isLandscape","page","PageFeature","_rotated","cm","makePageContexmenuItems","rotatePage","addLandscapePage","addPortraitPage","removePage","setLabel","removePages","onSavePdfClicked","savePdf","zoomForPrint","suggestZooms","mapZoom","satZoom","incrementProgress","inc","getLatLngBounds","getPrintSize","getLabel","decorationLayers","Grid","MagneticMeridians","OverlayScale","eventId","zooms","action","renderPages","progressCallback","renderedLayers","getFileName","imagesInfo","pdf","makePdf","savePagesPdf","savePageJpg","pageNumber","setSize","onPagesNumLabelClick","renumberPage","rotate","newIndex","oldIndex","referenceLat","absLats","targetMetersPerPixel","mapUnitsPerPixel","LN2","hasPages","flags","rotated","opaqueLayer","transparentOverlayLayers","appendLayerShortName","shortName","isOverlayTransparent","currentPageSize","find","pageSize","centerLatLng","paperSize","draggable","updateView","rectangle","fillOpacity","_getLatLngBounds","centerMerc","Projection","SphericalMercator","mercatorScale","Earth","R","mercatorPageSize","multiplyBy","sw","ne","_animateZoom","newZoom","getZoom","pixel_sw","getSouthWest","pixel_ne","getNorthEast","pixel_center","st","pixel_width","pixel_height","fontSize","lineHeight","setBounds","getLayersForPrint","getZIndex","compare","i1","i2","getLayerZOrder","_path","TypeError","order","meta","sort","layer1","layer2","compareArrays","PageComposer","destSize","pixelBoundsAtZoom24","currentCanvas","currentZoom","currentTileScale","targetCanvas","createCanvas","tileInfo","tileScale","mergeCurrentCanvas","setupCurrentCanvas","dest","s_data","getImageData","sr","sg","sb","sa","sa1","dr","dg","db","d_image_data","d_data","data_length","putImageData","blendMultiplyCanvas","dataUrl","toDataURL","iterateLayersTiles","pageLabel","pagesCount","defaultXHROptions","_layerDummy","getTempMap","_rasterizeNeedsFullSizeMap","layerPromises","progressInc","doStop","disposeMap","promiseQueueBuffer","source","maxActive","next","pageImagesInfo","Set","composer","tilesIterator","queuedTilesIterator","putTile","getDataUrl","bingKey","thunderforestKey","sentryDSN","mapillary","flickr","Image","blobUrl","onload","BingLayer","clearInterval","_key","tile2quad","quad","digit","mask","culture","_providers","metaRequested","tilePoint","loadMetadata","cbid","errorDetails","initMetadata","urlScheme","script","resourceSets","resources","imageUrlSubdomains","imageUrl","imageryProviders","coverageAreas","coverage","zoomMin","zoomMax","active","bbox","attrib","_update","_update_attribution","intersects","addAttribution","removeAttribution","tilesInfo","WestraPasses","waitDataReady","fileCoverage","fileLabels1","fileLabels2","labels2Zoom","markersZoom","labels1Zoom","markersOptions","GeoJSONAjax","onEachFeature","_setEventsForRegion","labels1","pointToLayer","_makeMarker","labels2","_onRegionClick","geojsonPoint","setLayersVisibility","zoomFinished","GeoJSON","requestTimeout","_loadStarted","addData","printWidthMm","_makelatLngToCanvasPixelTransformer","unscaleBy","_shift","targetBounds","getProjectedBounds","targetCenter","projected","lineBounds","lineJoin","beginPath","moveTo","lineTo","stroke","tickFontSizeMm","ticksPixelSize","setTransform","recPage","serialNum","pageRecId","contentRecId","imageRecId","recContent","contents","recImage","widthPixels","heightPixels","offsets","addRec","skipOffset","kidsIds","recPages","widthPoints","heightPoints","recOffsets","currentOffset","trailer","padding","recTrailer","angle","pixel","toLatLng","_makeCanvasToLatLngTransformer","lineThicknessMm","intervalPx","lineIntervalMm","samplingPx","samplingIntervalMm","pageDiagonal","maxSegments","drawLine","directionDown","getDeclination","maxLines","formatScale","nominalScale","scaleRange","unit","southLen","northLen","nScale","sScale","pageScaleRange","fontSizeMm","paddingMm","fillRect","intervalM","minGridIntervalM","minGridIntervalMm","intervals","metersPerDegree","pixelsPerMm","getGridInterval","mercatorBounds","canvasToMercatorScale","rows","yMerc","lat2","yMerc2","lineWidthPx","pageCanvasCenterX","direction","colN","firstRow","hasPointInPage","formatDistance","_drawGrid","_drawLabel","_contents","setContents","DEFAULT_FORMAT","formats","DEGREES","UNKNOWN_COORDINATES","SIGNED_DEGREES","DEGREES_AND_MINUTES","DEGREES_AND_MINUTES_AND_SECONDS","format","formatCode","formattedCoordinates","formatLatLng","wrapperClass","saveStateToStorage","makeButtonWithBar","_link","loadStateFromStorage","leafletCoordinatesActive","leafletCoordinatesFmt","setEnabled","isEnabled","enabled","classFunc","eventFunc","onMapRightClick","_isEnabled","coordinates","truncToFixed","precision","sliceEnd","padEnd","formatNumber","coordinatePresentations","coordinate","isLat","degrees","intDegrees","minutes","intMinutes","seconds","signedDegrees","formatter","getLayerHotkey","hotkey","extendLayerName","originalOnRemove","originalAddItem","_addItem","_hotKeysEnabled","_addHotketEvents","_onHotkeyUp","_addHotKetEvents","altKey","ctrlKey","shiftKey","_keyDown","pressedKey","targetTag","_layers","layerId","inputs","input","click","Layers","k1","k2","hasBaselayer","overlay","chrome","PosAnimation","__panAnimationFixed","originalStep","_step","fixPanAnimationBug","pointerEnabled","ie","maxTouchPoints","originalHandleDOMEvent","_handleDOMEvent","_fireDOMEvent","Renderer","__animationFixed","resetInterval","originalGetEvents","getEvents","onZoom","now","Date","_lastReset","_reset","_onZoom","onMove","move","fixVectorDrawWhileAnimation","fixVectorMarkerWorldJump","original_addTo","origOpenTooltip","_openTooltip","_tooltip","_pendingTooltip","origCloseTooltip","closeTooltip","addTooltipDelay","PanoMarker","zIndexOffset","getIcon","markerIcon","setHeading","setType","markerType","slim","normal","splitVerically","splitSizeFraction","minViewerSize","getProviders","provider","wikimediaProvider","layerOptions","selected","mapMarkerType","mapillaryProvider","loadSettings","_panoramasContainer","onContainerResize","providers","updateCoverageVisibility","nearbyPoints","storedSettings","panoramaSettings","_splitVerically","spitVertically","fraction","_splitSizeFraction","saveSetting","stringify","_splitterDragging","splitter","splitterButton","trackOutsideElement","dragstart","onSplitterDragStart","dragend","onSplitterDragEnd","drag","onSplitterDrag","onSplitterClick","setupViewerLayout","onMapResize","onButtonClick","onKeyUp","minSize","oldSize","newSize","mapSize","maxSize","setContainerSizePixels","switchControl","controlEnabled","disableControl","enableControl","codePointAt","notifyChanged","hidePanoViewer","coverageLayer","getCoverageLayer","showPanoramaContainer","panoramaVisible","hasClass","setupNearbyPoints","hidePano","viewer","deactivate","showPano","otherProvider","getViewer","setupViewerEvents","activate","onPanoramaChangeView","closeclick","onPanoramaCloseClick","hideMarker","placeMarker","heading","searchRadiusMeters","getPanoramaAtPos","searchResult","sidebar","updateContainerSize","containerSize","coverageCode","viewerState","setState","hashStateUpgrader","panoramasControl","oldState","upgradedState","getMapillary","require","resp","Viewer","CloseButtonMixin","DateLabelMixin","component","cover","bearing","resize","onNodeChanged","onBearingChanged","createDateLabel","createCloseButton","_bearing","_zoom","_center","throttle","_invalidateSize","moveToKey","setZoom","updateZoomAndCenter","_node","fireChangeEvent","updateDateLabel","capturedAt","getBearingCorrection","computedCA","originalCA","originalLatLon","pitch","_pitch","activateCover","_updateHandler","getBearing","deactivateCover","center0","center1","moveCloseTo","setCenter","MapillaryCoverage","updateWhenIdle","MapillaryLoader","onTileUnload","_abortLoading","_tileData","_adjustment","drawOverview","canvasCtx","geometry","arc","fill","drawSequences","lineI","pointI","drawImages","requestTileData","z2","originalDataTileCoords","_processResponse","decodeMvt","_maxSize","_store","_size","tileExtent","TileProto","parsedLayers","extent","parseFeatures","decodeCoordinate","parseGeometry","geometryType","ints","coordinatesScale","GeomType","POINT","LINESTRING","POLYGON","lineStrings","cmd","cmdRepeat","cmdN","Tile","exports","readFields","_readField","tag","readVarint","Feature","tags","readPackedVarint","onCloseClick","dateLabel","timestamp","getDate","getMonth","getFullYear","parseSearchResponse","iinfo","imageinfo","imageDescription","extmetadata","ImageDescription","objectDescription","ObjectName","Artist","descriptionurl","thumburl","timeOriginal","DateTimeOriginal","time","DateTime","pageUrl","pageId","pageid","isCloser","d1","d2","clusterSize","radius","photos","nearestLatlng","photo","formatDateTime","dateStr","year","month","day","mapContainer","pageButtonContainer","maxBoundsViscosity","Simple","zoomSnap","infoLabel","prevPhotoButton","nextPhotoButton","switchPhoto","_imageIdx","setupPageButtons","_buttons","imageIdx","imagePos","imageLayer","log2","southWest","northEast","setMaxZoom","setMaxBounds","animate","imageOverlay","setUrl","_active","_showPano","MultiLayer","tms","WikimediaVectorCoverage","WikimediaLoader","urlTemplate","Uint16Array","dataOffset","pixelScale","readFile","fileInput","multiple","display","readAsArrayBuffer","parseKmz","parseZip","parseGpx","parseOziRte","parseOziPlt","parseOziWpt","parseKml","_unused_name","unzipper","uncompressed","entry","file_name","decode866","hasDocKml","coordinates_element","points_strings","placemarks","coord","pointObjs","nameTags","getPoints","expected_points_num","current_segment","total_points_num","fields","is_start_of_segment","currentSegment","pointName","decodeCP1251","YandexRuler","Endomondo","Etomesto","Gpsies","Gpslib","Osm","Strava","Tracedetrail","MovescountMove","MovescountRoute","GarminActivity","GarminRoute","SportsTrackerActivity","OpenStreetMapRu","SimpleService","nameFromUrl","responseURL","urlRegexps","some","re","userId","latitude","longitude","date","local_start_time","trackName","urlRe","getTrackId","startsWith","fileId","speed","dataType","filetype","submitButton","inappropriate","pageResponse","trackResponse","401","404","isArray","userName","textContent","activityTitle","nom_fr","proj","last_lat","last_lng","points_str","Segment","readPackedSVarint","writePackedSVarint","Waypoint","readSVarint","writeSVarintField","writeStringField","Waypoints","writeMessage","Track","View","readBoolean","writeVarintField","writeBooleanField","parseWaypoint","rawPoint","Number","lt","ln","parseTrack","rawTrack","rawSegment","errCorrupt","jsonString","geoDataArray","u","t","viewProps","MovescountBase","latitudes","longitudes","routeName","TrackPoints","trackPoint","Latitude","Longitude","GarminBase","coursePoints","pt","geoPoints","courseName","geoPolylineDTO","activityId","metadata","dataResponse","metadataResponse","payload","locations","la","startTime","toDateString","fullname","withElevations","fakeTime","simplify","_nodeMarkersZOffset","_editing","_drawingDirection","setupMarkers","onMapEndDrag","onKeyPress","_storedStyle","_nodeMarker","_lineNode","_segmentOverlay","getMarkerIndex","getSegmentOverlayIndex","segmentOverlay","onNodeMarkerDragEnd","replaceNode","_setupEndMarkers","onNodeMarkerMovedChangeNode","onNodeMarkerDblClickedRemoveNode","_disableEditOnLeftClick","removeNode","newNodeIndex","refNodeIndex","addNode","handler","dragging","_draggable","mousePos","_startPoint","_newPos","_startPos","mouseEventToLatLng","onMouseMoveFollowEndNode","makeNodeMarker","onNodeMarkerClickStartStopDrawing","latlngs_n","makeSegmentOverlay","onSegmentMouseDownAddNode","midPoint","Draggable","_dragging","_onDown","nodes","isAddingLeft","isAddingRight","prevNode","oldNode","nodesCount","startIndex","endIndex","startIcon","endIcon","startNode","endNode","disable","latLngs","wrappedLatLngs","newLines","newLine","prevLatLng","positiveLng","wrapNum","positivePrevLng","splitLng","sign","splitPrevLng","splitLat","getSegmentSplitPointLat","splitPrevLat","splitLineAt180Meridian","latLng1","latLng2","deltaLng","Ruler","trackList","_trackList","notEmpty","maxLocalStorageSessions","_minimizeEnabled","__injectMinimizeButtons","contentsWrapper","minimizeButton","expandButton","originalUnserializeState","layers_loaded","_configEnabled","_allLayersGroups","_allLayers","_initializeLayersState","updateEnabledLayers","addedLayers","hasBaselayerOnMap","enabledLayers","_justAdded","addOverlay","addBaseLayer","hasLayer","CustomLayer","z_1","x_1024","y_1024","infinite","invertedY","_globalTileRange","elements","querySelectorAll","raise","cornerDiv","layersDefs","grouppedLayers","isDefault","jnx","SovietTopoGrid","Wikimapia","zeroPad","num","bigLetterReplacers","Nomenclature","getQuadName1m","column","getQuadName500k","name1","subquad","name2","names","replacer","name3","getQuadName100k","getQuadName050k","_getQuads","row_height","column_width","name_factory","quads","min_lat","max_lat","maxCols","joined_quads","row_south","row_north","min_lon","max_lon","column_west","column_east","quad_bounds","getQuads1m","getQuads500k","getQuads100k","getQuads050k","LayerGroup","renderer","_quads","_updateRenderer","_cleanupQuads","_addQuad","titles","rect_options","smoothFactor","noClip","objects","_showContextMenu","_removeQuad","_addQuads","_addGrid","map_bbox","reset","clearLayers","quad_id","isPointInPolygon","polygon","inside","WikimapiaLoader","highlightedPlace","places","localPolygon","polygon2","_tileOnLoad","ielt9","_tileCoordsFromEvent","layerPoint","getPixelOrigin","getPlaceAtMousePos","tileCoords","_tiles","_tileCoordsToKey","getPlaceAtLatlng","place","setContent","boundsWESN","projectObj","_projectObj","exactMatch","hasChildren","wmUtils","makeTileUrl","parseTile","viewTileSize","urlPath","getTileId","tileIdToCoords","tileId","decodeTitles","chooseTitle","langCode","decodePolygon","makeCoordsLocal","tileX","tileY","tileZ","x0","y0","localCoords","asap","simplifyPolygon","tileHasChildren","p0","pixelDegSize","prevTime","placeId","originalLayerOnAdd","originalZoomOnAdd","Zoom","JNX","_layersControl","makingJnx","contextMenu","makeMenuItems","getLayerForJnx","selectedLayer","layerRec","layerName","estimateTilesCount","tilesCount","_selector","topLeftTile","bottomRightTile","maxLevel","minLevel","metersPerPixel","fileSizeMb","itemClass","resolutionString","sizeString","makeJnx","notifyProgress","sanitizedLayerName","makeJnxFromLayer","removeSelector","addSelector","RectangleSelect","onButtonClicked","Rectangle","fillColor","onMarkerDrag","onMarkerDragEnd","placeMarkers","topLeftPixel","setBoundsFromMarkers","imageFromarrayBuffer","dataURL","ensureImageJpg","convertToJpeg","srcLayer","maxZoomLevel","jnxProductId","jnxZOrder","writer","JnxWriter","minZoomLevel","progressWeight","tempMap","tilePromiseRec","imageRec","addTile","promiseRec","getJnx","jnxCoordinates","extents","toJnx","north","east","south","west","productName","productId","zOrder","tiles","level","totalTilesCount","levels_n","BinStream","writeInt32","writeUint32","seek","writeString","writeInt16","jnxScale","tileDescriptorOffset","tell","writeUint8","tileDataOffset","getBuffer","littlEndian","dv","DataView","_pos","old_buffer","buffer","newAr","oldAr","grow","newPos","checkSize","setUint8","setInt8","setInt16","setUint16","setInt32","setUint32","zeroTerminated","validateFloat","validateFloatRange","radians","roundAzimuth","Azimuth","trueAzimuth","magneticAzimuth","iconSingle","iconUrl","iconPointer","iconStart","iconPointerStart","iconEnd","iconPointerEnd","azimuthLine","single","which","rotationOrigin","layout","setPoints","elevationControl","showProfile","_enabled","hideProfile","atan2","setRotationAngle","updateValuesDisplay","azimuth","lat1","lng1","lng2","onProfileButtonClick","onReverseButtonClick","STATE_DISABLED","STATE_LOCATING","STATE_ENABLED","STATE_ENABLED_FOLLOWING","STATE_MOVING_TO_FOLLOWING","STATE_MOVING_TO_FOLLOWING_FIRST","STATE_UPDATING_FOLLOWING","EVENT_INIT","EVENT_BUTTON_CLICK","EVENT_LOCATION_RECEIVED","EVENT_LOCATION_ERROR","EVENT_MAP_MOVE","EVENT_MAP_MOVE_END","LOCALSTORAGE_POSITION","PositionMarker","_locationSet","_elements","accuracyCircle","circle","markerCircle","circleMarker","markerPoint","_updatePrecisionState","precise","_radius","_precise","setLocation","accuracy","setRadius","locationAcquireTimeoutMS","maxAutoZoom","minAutoZoomDeltaForAuto","minDistForAutoZoom","_events","_handleEvent","fallbackLatLng","forceLatLng","forceZoom","storedPosition","geolocation","getCurrentPosition","_storePositionToLocalStorage","enableHighAccuracy","maximumAge","_startLocating","_onLocationError","_watchID","watchPosition","_onLocationSuccess","_stopLocating","clearWatch","_storeLocation","_accuracy","_updateMarkerLocation","_updateMapPositionWhileFollowing","_updateFollowingStartPosition","_updateFollowingDestPosition","_setViewToLocation","preferAutoZoom","zoomFitAccuracy","getBoundsZoom","toBounds","autoZoom","screenSize","averageScreenSize","_onMapMove","_onMapMoveEnd","equals","_isMapOffsetFromFollowingSegment","pointToSegmentDistance","_isMapCenteredAtLocation","_updateButtonClasses","_setEvents","_processingEvent","_processEvent","_setState","_display","_zoomOutButton","_updateDisplay","periods","icon_map","layerGroup","link_container","_simulated","unload","showControl","renderMarkerIcon","current_weather","temp","rain","waterImage","renderPlaces","period_index","current_period","baloon","closest","dataset","zindex","controlContainer","positionSliderLabel","positionSlider","setCurrentPeriod","bindingHandlers","hasFocusNested","init","valueAccessor","handleFocusChange","SearchViewModel","minSearchQueryLength","inputHasFocus","controlOrChildHasFocus","controlHasFocus","isQueryLengthOk","allowMinimize","highlightedIndex","itemSelected","escapePressed","onQueryChange","showResults","onShowResults","onControlHasFocusChange","onInputHasFocusChange","maybeRequestSearch","searchAborted","searchRequested","inputPlaceholder","helpText","allowed","providerOptions","maxResponses","minQueryLength","maxMapHeightToMinimize","help","magicProviders","Cls","searchPromise","setInputPlaceholder","setHelpText","onSearchRequested","onSearchAborted","onResultItemClicked","setFocusToMap","controlTemplate","onDocumentKeyUp","updateMinimizeAllowed","tabIndex","searchOptions","magicProvider","isOurQuery","setResultError","results","setResult","setFocus","setMinimizeAllowed","mapycz","MapyCzProvider","CoordinatesProvider","reInteger","reFractional","reSignedFractional","reHemisphere","latIsSouth","lonIsWest","h1","h2","h3","allowEmpty","hLat","hLon","swapLatLon","empty","CoordinatesDMS","latDeg","latMin","latSec","lonDeg","lonMin","lonSec","other","getLatitudeLetter","getLongitudeLetter","regexp","d1Str","m1Str","s1Str","d2Str","m2Str","s2Str","hemispheres","parseHemispheres","m1","s1","m2","coord1","coord2","equalTo","RegExp","CoordinatesDM","CoordinatesD","CoordinatesDSigned","latDegSigned","lonDegSigned","inp","normalize","regexps","symbols","northernHemishphere","southernHemishphere","westernHemishphere","easternHemishphere","coordFieldRe","coordNumbersFieldRe","normalizeInput","every","field","parser","fromString","resultItems","coordStrings","category","address","categories","_categories","BaseProvider","apiUrl","languages","categoriesLanguages","defaultLanguage","langStr","getRequestLanguages","categoriesLanguage","waitNoNewRequestsSent","searchParams","append","userData","suggestSecondRow","iconId","icons","poiTypeId","suggestFirstRow","suggestThirdRow","poiIds","typeId","poiId","sleep","ms","supportedLanguages","_sleep","sleepPromise","module"],"mappings":"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","file":"static/js/app.88474842.js","sourcesContent":["import config from '~/config';\n\nexport default function urlViaCorsProxy(url) {\n    return config.CORSProxyUrl + url.replace(/^(https?):\\/\\//u, '$1/');\n}\n","import {fetch} from '~/lib/xhr-promise';\n\nclass BaseService {\n    constructor(url) {\n        this.origUrl = url;\n    }\n\n    isOurUrl() {\n        throw new Error('Method not implemented');\n    }\n\n    requestOptions() {\n        throw new Error('Method not implemented');\n    }\n\n    parseResponse() {\n        throw new Error('Method not implemented');\n    }\n\n    async geoData() {\n        if (!this.isOurUrl()) {\n            throw new Error('Unsupported url');\n        }\n        const requests = this.requestOptions().map((it) => fetch(it.url, it.options));\n        let responses;\n        try {\n            responses = await Promise.all(requests);\n        } catch (e) {\n            return [{name: this.origUrl, error: 'NETWORK'}];\n        }\n\n        return this.parseResponse(responses);\n    }\n\n    nameFromUrl(url) {\n        try {\n            url = decodeURIComponent(url);\n        } catch (e) {\n            // leave url as is\n        }\n\n        return url\n            .split('#')[0]\n            .split('?')[0]\n            .replace(/\\/*$/u, '')\n            .split('/')\n            .pop();\n    }\n}\n export default BaseService;\n","import {arrayBufferToString} from '~/lib/binary-strings';\n\nfunction successIfStatus200(xhr) {\n    return xhr.status >= 200 && xhr.status <= 299;\n}\n\nfunction retryIfNetworkErrorOrServerError(xhr) {\n    return (xhr.status === 0 || xhr.status >= 500);\n}\n\nclass XMLHttpRequestPromiseError extends Error {\n    constructor(xhr) {\n        super();\n        this.xhr = xhr;\n        this.name = 'XMLHttpRequestPromiseError';\n\n        this.message = xhr.status === 0 ? 'network error' : `server response is ${xhr.status}`;\n    }\n}\n\nclass XMLHttpRequestPromise {\n    constructor(\n        url, {method = 'GET', data = null, responseType = '', timeout = 30000, maxTries = 3, retryTimeWait = 500,\n            isResponseSuccess = successIfStatus200, responseNeedsRetry = retryIfNetworkErrorOrServerError,\n            headers = null, withCredentials = false} = {}) {\n        // console.log('promise constructor', url);\n        const promise = new Promise((resolve, reject) => {\n                this._resolve = resolve;\n                this._reject = reject;\n            }\n        );\n        this.then = promise.then.bind(promise);\n        this.catch = promise.catch.bind(promise);\n        this.method = method;\n        this.url = url;\n        this.responseType = responseType;\n        this.postData = data;\n        this._isResponseSuccess = isResponseSuccess;\n        this._responseNeedsRetry = responseNeedsRetry;\n        this._retryTimeWait = retryTimeWait;\n        this.triesLeft = maxTries;\n\n        const xhr = this.xhr = new XMLHttpRequest();\n        xhr.onreadystatechange = () => this._onreadystatechange();\n        this._open();\n        xhr.timeout = timeout;\n        if (responseType === 'binarystring') {\n            xhr.responseType = 'arraybuffer';\n        } else {\n            xhr.responseType = responseType;\n        }\n        if (headers) {\n            for (let [k, v] of headers) {\n                xhr.setRequestHeader(k, v);\n            }\n        }\n        xhr.withCredentials = withCredentials;\n    }\n\n    _open() {\n        // console.log('open', this.url);\n        this.xhr.open(this.method, this.url);\n    }\n\n    _onreadystatechange() {\n        const xhr = this.xhr;\n        if (xhr.readyState === 4 && !this._aborted) {\n            // console.log('ready state 4', this.url);\n            xhr.responseBinaryText = '';\n            if (this.responseType === 'binarystring' && xhr.response && xhr.response.byteLength) {\n                xhr.responseBinaryText = arrayBufferToString(xhr.response);\n            }\n            // IE doesnot support responseType=json\n            if (this.responseType === 'json' && (typeof xhr.response) === 'string') {\n                try {\n                    // xhr.response is readonly\n                    xhr.responseJSON = JSON.parse(xhr.response);\n                } catch (e) {\n                    xhr.responseJSON = null;\n                }\n            } else {\n                xhr.responseJSON = xhr.response;\n            }\n            if (this._isResponseSuccess(xhr)) {\n                // console.log('success', this.url);\n                this._resolve(xhr);\n            } else {\n                if (this.triesLeft > 0 && this._responseNeedsRetry(xhr)) {\n                    // console.log('retry', this.url);\n                    this._open();\n                    this._timerId = setTimeout(() => this.send(), this._retryTimeWait);\n                } else {\n                    // console.log('failed', this.url);\n                    this._reject(new XMLHttpRequestPromiseError(xhr));\n                }\n            }\n        }\n    }\n\n    abort() {\n        // console.log('abort', this.url);\n        this._aborted = true;\n        clearTimeout(this._timerId);\n        this.xhr.abort();\n    }\n\n    send() {\n        // console.log('send', this.url);\n        this.triesLeft -= 1;\n        this.xhr.send(this.postData);\n    }\n}\n\nclass XHRQueue {\n    constructor(maxSimultaneousRequests = 6) {\n        this._maxConnections = maxSimultaneousRequests;\n        this._queue = [];\n        this._activeCount = 0;\n    }\n\n    put(url, options) {\n        const promise = new XMLHttpRequestPromise(url, options);\n        promise._originalAbort = promise.abort;\n        promise.abort = () => this._abortPromise(promise);\n        this._queue.push(promise);\n        this._processQueue();\n        return promise;\n    }\n\n    _abortPromise(promise) {\n        const i = this._queue.indexOf(promise);\n        if (i > -1) {\n            // console.log('ABORT IN QUEUE');\n            this._queue.splice(i, 1);\n        } else {\n            if (promise.xhr.readyState === 4) {\n                // console.log('ABORT COMPLETED');\n            } else {\n                // console.log('ABORT ACTIVE');\n                promise._originalAbort();\n                this._activeCount -= 1;\n                setTimeout(() => this._processQueue(), 0);\n            }\n        }\n    }\n\n    _processQueue() {\n        if (this._activeCount >= this._maxConnections || this._queue.length === 0) {\n            return;\n        }\n        const promise = this._queue.shift();\n        promise\n            .catch(() => {\n                // do not throw if XHR request fails\n            })\n            .then(() => this._onRequestReady(promise));\n        this._activeCount += 1;\n        promise.send();\n    }\n\n    _onRequestReady(promise) {\n        if (!promise._aborted) {\n            this._activeCount -= 1;\n        }\n        setTimeout(() => this._processQueue(), 0);\n    }\n}\n\nfunction fetch(url, options) {\n    // console.log('fetch', url);\n    const promise = new XMLHttpRequestPromise(url, options);\n    promise.send();\n    return promise;\n}\n\nexport {fetch, XHRQueue};\n\n","import L from 'leaflet';\nimport './style.css';\n\nfunction stopContainerEvents(container) {\n    L.DomEvent.disableClickPropagation(container);\n    L.DomEvent.disableScrollPropagation(container);\n    L.DomEvent.on(container, 'mousemove contextmenu', L.DomEvent.stop);\n}\n\nL.Control.include({\n    _stopContainerEvents: function() {\n        stopContainerEvents(this._container);\n    }\n});\n\nfunction makeButton(containerClass, title, iconClass, noControlClass) {\n    let cls = 'leaflet-bar leaflet-control-single-button';\n    if (!noControlClass) {\n        cls += ' leafletControl';\n    }\n    if (containerClass) {\n        cls += ' ' + containerClass;\n    }\n    const container = L.DomUtil.create('div', cls);\n    stopContainerEvents(container);\n    const link = L.DomUtil.create('a', null, container);\n    link.href = '#';\n    L.DomEvent.on(link, 'click', L.DomEvent.preventDefault);\n    if (title) {\n        link.title = title;\n    }\n    const icon = L.DomUtil.create('div', iconClass, link);\n    return {container, link, icon};\n}\n\nfunction makeButtonWithBar(containerClass, title, iconClass) {\n    let cls = 'leaflet-control button-with-bar';\n    if (containerClass) {\n        cls += ' ' + containerClass;\n    }\n    const container = L.DomUtil.create('div', cls);\n    const {container: buttonContainer, link, icon} = makeButton(null, title, iconClass, true);\n    container.appendChild(buttonContainer);\n\n    const barContainer = L.DomUtil.create('div', 'leaflet-bar bar', container);\n    stopContainerEvents(barContainer);\n    return {container, buttonContainer, link, icon, barContainer};\n}\n\nexport {stopContainerEvents, makeButton, makeButtonWithBar};\n","import secrets from './secrets';\n\nconst config = {\n    caption: `<a target=\"_blank\" href=\"https://vk.com/crimea_map\">Документация</a> | <a target=\"_blank\" href=\"https://vk.com/crimea_map\">Ваши вопросы, отзывы и предложения</a>`,\n    defaultLocation: [44.47716, 33.91960],\n    crimeaBounds: {\n        topLeft     : [ 44.288469027276506, 36.66412353515624 ],\n        bottomRight : [ 46.02366774426006, 32.3876953125 ]\n    },\n    defaultZoom: 12,\n    googleApiUrl: `https://maps.googleapis.com/maps/api/js?v=3&key=${secrets.google}`,\n    westraDataBaseUrl: 'https://nakarte.me/westraPasses/',\n    CORSProxyUrl: 'https://proxy.nakarte.me/',\n    elevationsServer: 'https://api.crimea-map.com/elevation',\n    wikimediaCommonsCoverageUrl: 'https://tiles.nakarte.me/wikimedia_commons_images/{z}/{x}/{y}',\n    geocachingSuUrl: 'https://nakarte.me/geocachingSu/geocaching_su2.json',\n    tracksStorageServer: 'https://api.crimea-map.com/tracks',\n    apiServer: 'https://api.crimea-map.com/',\n    weatherServer: 'https://crimeamountain.ru/wp-admin/admin-ajax.php?action=jwp_weather_api',\n    ...secrets\n};\n\nexport default config;\n","import * as Sentry from '@sentry/browser';\n\nfunction randId() {\n    return Math.random().toString(36).substring(2, 13);\n}\n\nconst sessionId = randId(); // eslint-disable-line\n\nfunction captureMessage(msg, extra = {}) {\n    extra.url = window.location.toString();\n    console.log('captureMessage', msg, extra); // eslint-disable-line no-console\n    Sentry.withScope(function(scope) {\n        scope.setExtras(extra);\n        Sentry.captureMessage(msg);\n    });\n}\n\nfunction captureException(e, description) {\n    console.log('captureException', e, description); // eslint-disable-line no-console\n    Sentry.withScope(function(scope) {\n        if (description) {\n            scope.setTag('description', description);\n        }\n        scope.setExtra('url', window.location.toString());\n        Sentry.captureException(e);\n    });\n}\nfunction captureBreadcrumb(message, data = {}) {\n    data.url = window.location.toString();\n    Sentry.addBreadcrumb({\n        message, data\n    });\n}\n\nfunction logEvent(eventName, extra) { // eslint-disable-line\n    console.log(eventName, extra); // eslint-disable-line\n}\n\nexport {captureMessage, captureException, captureBreadcrumb, logEvent, randId};\n","import alertify from 'alertify.js';\nimport './style.css';\n\nfunction notify(message, onOk) {\n    alertify.alert(message, onOk);\n}\n\nfunction query(message, value) {\n    function removeFocusFromInput() {\n        const activeElement = document.activeElement;\n        if (activeElement?.tagName === 'INPUT') {\n            activeElement.blur();\n        }\n    }\n\n    const result = window.prompt(message, value);\n    // There is a bug in Chrome on Android: after closing the prompt, it sets focus to last active input element\n    setTimeout(removeFocusFromInput, 0);\n    return result;\n}\n\nexport {notify, query};\n","function arrayBufferToString(arBuf) {\n    const\n        arr = new Uint8Array(arBuf),\n        s = [];\n    for (let i = 0; i < arr.length; i += 4096) {\n        let chunk = arr.subarray(i, i + 4096);\n        chunk = String.fromCharCode.apply(null, chunk);\n        s.push(chunk);\n    }\n    return s.join('');\n}\n\nfunction stringToArrayBuffer(s) {\n    const\n        length = s.length,\n        buf = new ArrayBuffer(length),\n        arr = new Uint8Array(buf);\n    for (let i = 0; i < length; i++) {\n        arr[i] = s.charCodeAt(i);\n    }\n    return buf;\n}\n\nfunction blobFromString(s) {\n    const arr = stringToArrayBuffer(s);\n    return new Blob([arr], {type: \"text/plain;charset=utf-8\"});\n}\n\nexport {arrayBufferToString, blobFromString, stringToArrayBuffer};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {hashState} from './hashState';\nimport * as logging from '~/lib/logging';\n\nL.Mixin.HashState = {\n    enableHashState: function(key, defaultInitialState = null) {\n        this._hashStateKey = key;\n        const eventSource = this.stateChangeEventsSource ? this[this.stateChangeEventsSource] : this;\n\n        // setup event listeners\n        if (this.stateChangeEvents) {\n            this.stateChangeEvents.forEach((event) => {\n                    eventSource.on(event, this._onControlStateChanged, this);\n                }\n            );\n        }\n\n        hashState.addEventListener(key, (state) => this._onExternalStateChanged(state));\n\n        // initialize control state from hash\n\n        const state = hashState.getState(key) || defaultInitialState;\n        if (!state || !this.unserializeState(state)) {\n            this.unserializeState(defaultInitialState);\n        }\n        hashState.updateState(this._hashStateKey, this.serializeState());\n        return this;\n    },\n\n    _onControlStateChanged: function() {\n        const state = this.serializeState();\n        hashState.updateState(this._hashStateKey, state);\n    },\n\n    _onExternalStateChanged: function(state) {\n        if (!this.unserializeState(state)) { // state from hash is invalid, update hash from component state\n            logging.captureMessage(`Invalid state in hash string (key \"${this._hashStateKey}\")`);\n            hashState.updateState(this._hashStateKey, this.serializeState());\n        }\n    }\n\n    // TODO: disableHashState\n};\n","import {decode as utf8_decode} from 'utf8';\nimport {xmlGetNodeText} from './xmlUtils';\nimport stripBom from '~/lib/stripBom';\n\nfunction parseGpx(txt, name, preferNameFromFile) {\n    var error;\n\n    function getSegmentPoints(segment_element) {\n        var points_elements = segment_element.getElementsByTagName('trkpt');\n        var points = [];\n        for (var i = 0; i < points_elements.length; i++) {\n            var point_element = points_elements[i];\n            var lat = parseFloat(point_element.getAttribute('lat'));\n            var lng = parseFloat(point_element.getAttribute('lon'));\n            if (isNaN(lat) || isNaN(lng)) {\n                error = 'CORRUPT';\n                break;\n            }\n            points.push({lat: lat, lng: lng});\n        }\n        return points;\n    }\n\n    function getTrackSegments(xml) {\n        var segments = [];\n        var segments_elements = xml.getElementsByTagName('trkseg');\n        for (var i = 0; i < segments_elements.length; i++) {\n            var segment_points = getSegmentPoints(segments_elements[i]);\n            if (segment_points.length) {\n                segments.push(segment_points);\n            }\n        }\n        return segments;\n    }\n\n    function getRoutePoints(rte_element) {\n        var points_elements = rte_element.getElementsByTagName('rtept');\n        var points = [];\n        for (var i = 0; i < points_elements.length; i++) {\n            var point_element = points_elements[i];\n            var lat = parseFloat(point_element.getAttribute('lat'));\n            var lng = parseFloat(point_element.getAttribute('lon'));\n            if (isNaN(lat) || isNaN(lng)) {\n                error = 'CORRUPT';\n                break;\n            }\n            points.push({lat: lat, lng: lng});\n        }\n        return points;\n    }\n\n    function getRoutes(xml) {\n        var routes = [];\n        var rte_elements = xml.getElementsByTagName('rte');\n        for (var i = 0; i < rte_elements.length; i++) {\n            var rte_points = getRoutePoints(rte_elements[i]);\n            if (rte_points.length) {\n                routes.push(rte_points);\n            }\n        }\n        return routes;\n    }\n\n    function getWaypoints(xml) {\n        var waypoint_elements = xml.getElementsByTagName('wpt');\n        var waypoints = [];\n        for (var i = 0; i < waypoint_elements.length; i++) {\n            var waypoint_element = waypoint_elements[i];\n            var waypoint = {};\n            waypoint.lat = parseFloat(waypoint_element.getAttribute('lat'));\n            waypoint.lng = parseFloat(waypoint_element.getAttribute('lon'));\n            if (isNaN(waypoint.lat) || isNaN(waypoint.lng)) {\n                error = 'CORRUPT';\n                continue;\n            }\n            let wptName = xmlGetNodeText(waypoint_element.getElementsByTagName('name')[0]) || '';\n            try {\n                wptName = utf8_decode((wptName));\n            } catch (e) {\n                error = 'CORRUPT';\n                wptName = '__invalid point name__';\n            }\n            waypoint.name = wptName;\n            waypoint.symbol_name = xmlGetNodeText(waypoint_element.getElementsByTagName('sym')[0]);\n            waypoints.push(waypoint);\n        }\n        return waypoints;\n    }\n\n    txt = stripBom(txt);\n    // remove namespaces\n    txt = txt.replace(/<([^ >]+):([^ >]+)/ug, '<$1_$2');\n    let dom;\n    try {\n        dom = (new DOMParser()).parseFromString(txt, \"text/xml\");\n    } catch (e) {\n        return null;\n    }\n    if (dom.documentElement.nodeName === 'parsererror') {\n        return null;\n    }\n    if (dom.getElementsByTagName('gpx').length === 0) {\n        return null;\n    }\n    if (preferNameFromFile) {\n        for (let trk of [...dom.getElementsByTagName('trk')]) {\n            let trkName = trk.getElementsByTagName('name')[0];\n            if (trkName) {\n                try {\n                    trkName = utf8_decode(xmlGetNodeText(trkName));\n                } catch (e) {\n                    error = 'CORRUPT';\n                }\n                if (trkName.length) {\n                    name = trkName;\n                    break;\n                }\n            }\n        }\n    }\n    return [{\n        name: name,\n        tracks: getTrackSegments(dom).concat(getRoutes(dom)),\n        points: getWaypoints(dom),\n        error: error\n    }];\n}\n\nexport default parseGpx;\n","import './contextmenu.css';\n\n/*\n    items = [\n        {text: 'Hello', disabled: true},\n        '-',\n        {text: 'World', callback: fn},\n        {text: 'section', separator: true},\n    ]\n */\n\nfunction isDescendant(parent, child) {\n    if (!parent) {\n        return false;\n    }\n    while (child) {\n        if (child === parent) {\n            return true;\n        }\n        child = child.parentNode;\n    }\n    return false;\n}\n\nclass Contextmenu {\n    constructor(items) {\n        this.items = items;\n    }\n\n    show(e) {\n        if (this._container) {\n            return;\n        }\n        if (e.originalEvent) {\n            e = e.originalEvent;\n        }\n        if (e.preventDefault) {\n            e.preventDefault();\n        } else {\n            e.returnValue = false;\n        }\n\n        const {clientX: x, clientY: y} = e;\n\n        const container = this._container = document.createElement('div');\n        document.body.appendChild(container);\n        container.className = 'contextmenu';\n        container.style.zIndex = 10000;\n\n        window.addEventListener('keydown', this.onKeyDown, true);\n        window.addEventListener('mousedown', this.onMouseDown, true);\n        window.addEventListener('touchstart', this.onMouseDown, true);\n\n        for (let item of this.createItems()) {\n            container.appendChild(item);\n        }\n        this.setPosition(x, y);\n    }\n\n    hide() {\n        if (!this._container) {\n            return;\n        }\n        document.body.removeChild(this._container);\n        this._container = null;\n\n        window.removeEventListener('keydown', this.onKeyDown, true);\n        window.removeEventListener('mousedown', this.onMouseDown, true);\n        window.removeEventListener('touchstart', this.onMouseDown, true);\n    }\n\n    onKeyDown = (e) => {\n        if (e.keyCode === 27) {\n            this.hide();\n        }\n    };\n\n    onMouseDown = (e) => {\n        if (!isDescendant(this._container, e.target)) {\n            this.hide();\n        }\n    };\n\n    setPosition(x, y) {\n        const window_width = window.innerWidth,\n            window_height = window.innerHeight,\n            menu_width = this._container.offsetWidth,\n            menu_height = this._container.offsetHeight;\n        if (x + menu_width >= window_width) {\n            x -= menu_width;\n            if (x < 0) {\n               x = 0;\n            }\n        }\n        if (y + menu_height >= window_height) {\n            y -= menu_height;\n            if (y < 0) {\n                y = 0;\n            }\n        }\n        this._container.style.left = `${x}px`;\n        this._container.style.top = `${y}px`;\n    }\n\n    *createItems() {\n        let items = this.items;\n        if (typeof items === 'function') {\n            items = items();\n        }\n        for (let itemOptions of items) {\n            if (typeof itemOptions === 'function') {\n                itemOptions = itemOptions();\n            }\n            if (itemOptions === '-' || itemOptions.separator) {\n                yield this.createSeparator(itemOptions);\n            } else {\n                yield this.createItem(itemOptions);\n            }\n        }\n    }\n\n    createItem(itemOptions) {\n        const el = document.createElement('a');\n        let className = 'item';\n        if (itemOptions.disabled) {\n            className += ' disabled';\n        }\n        if (itemOptions.header) {\n            className += ' header';\n        }\n        el.innerHTML = itemOptions.text;\n\n        const callback = itemOptions.callback;\n        if (callback && !itemOptions.disabled) {\n            className += ' action';\n            el.addEventListener('click', this.onItemClick.bind(this, callback));\n        }\n        el.className = className;\n        return el;\n    }\n\n    onItemClick(callback, e) {\n        e.stopPropagation();\n        e.preventDefault();\n        this.hide();\n        callback(e);\n    }\n\n    createSeparator(itemOptions) {\n        const el = document.createElement('div');\n        el.className = 'separator';\n        if (itemOptions.text) {\n            el.innerHTML = `<span>${itemOptions.text}</span>`;\n        }\n        return el;\n    }\n}\n\nexport default Contextmenu;\n","function localStorageWorks() {\n    try {\n        window.localStorage.setItem('_testDummy', 'TEST');\n        return window.localStorage.getItem('_testDummy') === 'TEST';\n    } catch (e) {\n        return false;\n    }\n}\n\nlet storage; // eslint-disable-line import/no-mutable-exports\n\nif (localStorageWorks()) {\n    storage = window.localStorage;\n} else {\n    let _storage = {};\n    storage = {\n        length: 0,\n\n        key: function(n) {\n            return Object.keys(_storage)[n];\n        },\n\n        removeItem: function(key) {\n            delete _storage[key];\n        },\n\n        getItem: function(key) {\n            return storage[key];\n        },\n\n        setItem: function(key, value) {\n            storage[key] = value;\n        },\n\n        clear: function() {\n            _storage = {};\n        }\n    };\n}\n\nexport default storage;\n","import L from 'leaflet';\nimport './canvasMarkers.css';\nimport RBush from 'rbush';\nimport loadImage from 'image-promise';\nimport {wrapLatLngToTarget} from '~/lib/leaflet.fixes/fixWorldCopyJump';\n\n/*\n Marker definition:\n {\n latlng: L.Latlng,\n icon: {url: string, center: [x, y]} or function(marker) returning icon,\n label: string or function,\n tooltip: string or function,\n any other fields\n }\n */\n\nfunction calcIntersectionSum(rect, rects) {\n    let sum = 0,\n        left, right, top, bottom, rect2;\n\n    for (rect2 of rects) {\n        left = Math.max(rect.minX, rect2.minX);\n        right = Math.min(rect.maxX, rect2.maxX);\n        top = Math.max(rect.minY, rect2.minY);\n        bottom = Math.min(rect.maxY, rect2.maxY);\n        if (top < bottom && left < right) {\n            sum += ((right - left) * (bottom - top));\n        }\n    }\n    return sum;\n}\n\nclass MarkerRBush extends RBush {\n    toBBox(marker) {\n        const x = marker.latlng.lng;\n        const y = marker.latlng.lat;\n        return {\n            minX: x,\n            minY: y,\n            maxX: x,\n            maxY: y\n        };\n    }\n\n    compareMinX(a, b) {\n        return a.latlng.lng - b.latlng.lng;\n    }\n\n    compareMinY(a, b) {\n        return a.latlng.lat - b.latlng.lat;\n    }\n}\n\nL.Layer.CanvasMarkers = L.GridLayer.extend({\n        options: {\n            async: true,\n            labelFontName: 'Verdana, Arial, sans-serif',\n            labelFontSize: 10,\n            iconScale: 1,\n            pane: 'rasterMarker',\n            updateWhenZooming: !L.Browser.mobile,\n            iconsOpacity: 1,\n            labelShadowWidth: 1,\n        },\n\n        initialize: function(markers, options) {\n            L.GridLayer.prototype.initialize.call(this, options);\n            this.rtree = new MarkerRBush(9);\n            this._regions = new RBush();\n            this._iconPositions = {};\n            this._labelPositions = {};\n            this._labelPositionsZoom = null;\n            this.addMarkers(markers);\n            this._images = {};\n            this._tileQueue = [];\n            this._hoverMarker = null;\n            this.on('markerenter', this.onMarkerEnter, this);\n            this.on('markerleave', this.onMarkerLeave, this);\n        },\n\n        addMarkers: function(markers) {\n            if (markers) {\n                this.rtree.load(markers);\n                this.resetLabels();\n                setTimeout(() => this.redraw(), 0);\n            }\n        },\n\n        addMarker: function(marker) {\n            // FIXME: adding existing marker must be be noop\n            this.rtree.insert(marker);\n            this.resetLabels();\n            setTimeout(() => this.redraw(), 0);\n        },\n\n        removeMarker: function(marker) {\n            this.removeMarkers([marker]);\n        },\n\n        removeMarkers: function(markers) {\n            markers.forEach((marker) => this.rtree.remove(marker));\n            this.resetLabels();\n            setTimeout(() => this.redraw(), 0);\n        },\n\n        updateMarkers: function(markers) {\n            this.removeMarkers(markers);\n            this.addMarkers(markers);\n        },\n\n        updateMarker: function(marker) {\n            this.updateMarkers([marker]);\n        },\n\n        setMarkerPosition: function(marker, latlng) {\n            this.removeMarker(marker);\n            marker.latlng = latlng;\n            this.addMarker(marker);\n        },\n\n        getMarkers: function() {\n            return this.rtree.all();\n        },\n\n        findLabelPosition: function(iconCenter, iconSize, textWidth, textHeight, pixelExtents) {\n            const\n                verticalPadding = 0,\n                xPositions = [iconCenter[0] + iconSize[0] / 2 + 2, iconCenter[0] - iconSize[0] / 2 - textWidth - 2],\n                yPositions = [\n                    iconCenter[1] - textHeight / 2 + verticalPadding,\n                    iconCenter[1] - textHeight * 0.75 - iconSize[1] / 4 + verticalPadding,\n                    iconCenter[1] - textHeight / 4 + iconSize[1] / 4 + verticalPadding,\n                    iconCenter[1] - textHeight - iconSize[1] / 2 + verticalPadding,\n                    iconCenter[1] + iconSize[1] / 2 + verticalPadding\n                ];\n\n            let minIntersectionSum = Infinity;\n            let bestX = xPositions[0],\n                bestY = yPositions[0];\n            for (let x of xPositions) {\n                for (let y of yPositions) {\n                    const rect = {minX: x, minY: y, maxX: x + textWidth, maxY: y + textHeight};\n                    if (pixelExtents && (rect.minX < pixelExtents.tileW || rect.maxX > pixelExtents.tileE ||\n                        rect.minY < pixelExtents.tileN || rect.maxY > pixelExtents.tileS)) {\n                        continue;\n                    }\n                    let intersectionSum = calcIntersectionSum(rect, this._regions.search(rect));\n                    if (intersectionSum < minIntersectionSum) {\n                        minIntersectionSum = intersectionSum;\n                        bestX = x;\n                        bestY = y;\n                        if (minIntersectionSum === 0) {\n                            break;\n                        }\n                    }\n                }\n                if (minIntersectionSum === 0) {\n                    break;\n                }\n            }\n            return [bestX, bestY];\n        },\n\n        preloadIcons: function(urls) {\n            const newUrls = urls.filter((url) => !(url in this._images));\n            if (newUrls.length) {\n                return loadImage(newUrls).then((images) => {\n                        for (let image of images) {\n                            this._images[image.src] = image;\n                        }\n                    }\n                );\n            }\n            return Promise.resolve();\n        },\n\n        createTile: function(coords, done) {\n            const canvas = L.DomUtil.create('canvas', 'leaflet-tile');\n            canvas.width = this.options.tileSize;\n            canvas.height = this.options.tileSize;\n            setTimeout(() => {\n                    this.drawTile(canvas, coords).then(() => done(null, canvas));\n                }, 0\n            );\n            return canvas;\n        },\n\n        selectMarkersForDraw: function({tileN, tileS, tileE, tileW}, zoom, withoutPadding) {\n            // FIXME: padding should depend on options.iconScale and fontSize\n            if (!this._map) {\n                return {};\n            }\n            const\n                iconsHorPad = withoutPadding ? 0 : 520,\n                iconsVertPad = withoutPadding ? 0 : 50,\n                labelsHorPad = withoutPadding ? 0 : 256,\n                labelsVertPad = withoutPadding ? 0 : 20;\n            const\n                iconsBounds = L.latLngBounds(\n                    this._map.unproject(L.point(tileW - iconsHorPad, tileS + iconsHorPad), zoom),\n                    this._map.unproject(L.point(tileE + iconsHorPad, tileN - iconsVertPad), zoom)\n                ),\n                labelsBounds = L.latLngBounds(\n                    this._map.unproject(L.point(tileW - labelsHorPad, tileS + labelsHorPad), zoom),\n                    this._map.unproject(L.point(tileE + labelsHorPad, tileN - labelsVertPad), zoom)\n                );\n            const\n                iconUrls = [],\n                markerJobs = {};\n\n            // used only to preload icons\n            const pointsForMarkers = [];\n            for (let shift of [-360, 0, 360]) {\n                pointsForMarkers.push(...this.rtree.search({\n                    minX: iconsBounds.getWest() + shift,\n                    minY: iconsBounds.getSouth(),\n                    maxX: iconsBounds.getEast() + shift,\n                    maxY: iconsBounds.getNorth()\n                }));\n            }\n\n            // used to place labels\n            const pointsForLabels = [];\n            for (let shift of [-360, 0, 360]) {\n                pointsForLabels.push(...this.rtree.search({\n                    minX: labelsBounds.getWest() + shift,\n                    minY: labelsBounds.getSouth(),\n                    maxX: labelsBounds.getEast() + shift,\n                    maxY: labelsBounds.getNorth()\n                }));\n            }\n            const tileMidLongitude = this._map.unproject([(tileE + tileW) / 2, tileN], zoom);\n\n            for (let marker of pointsForMarkers) {\n                let latlng = marker.latlng;\n                if (this.options.noWrap) {\n                    latlng = wrapLatLngToTarget(latlng, tileMidLongitude);\n                }\n                const p = this._map.project(latlng, zoom);\n                let icon = marker.icon;\n                if (typeof icon === 'function') {\n                    icon = icon(marker);\n                }\n                iconUrls.push(icon.url);\n                let markerId = L.stamp(marker);\n                markerJobs[markerId] = {marker: marker, icon: icon, projectedXY: p};\n            }\n            return {iconUrls, markerJobs, pointsForLabels};\n        },\n\n        drawSelectedMarkers: function(canvas, pixelExtents, markerJobs, pointsForLabels, zoom, limitLabelsToImage) {\n            const {tileN, tileW, tileS, tileE} = pixelExtents;\n            const textHeight = this.options.labelFontSize * this.options.iconScale;\n            if (this._labelPositionsZoom !== zoom) {\n                this._labelPositionsZoom = zoom;\n                this.resetLabels();\n            }\n            const ctx = canvas.getContext('2d');\n            ctx.font = L.Util.template('bold {size}px {name}',\n                {name: this.options.labelFontName, size: this.options.labelFontSize * this.options.iconScale}\n            );\n            for (let [markerId, job] of Object.entries(markerJobs)) {\n                let img = this._images[job.icon.url];\n                job.img = img;\n                const imgW = Math.round(img.width * this.options.iconScale);\n                const imgH = Math.round(img.height * this.options.iconScale);\n                if (!(markerId in this._iconPositions)) {\n                    let x = job.projectedXY.x - job.icon.center[0] * this.options.iconScale;\n                    let y = job.projectedXY.y - job.icon.center[1] * this.options.iconScale;\n                    x = Math.round(x);\n                    y = Math.round(y);\n                    this._iconPositions[markerId] = [x, y];\n                    this._regions.insert({\n                        minX: x,\n                        minY: y,\n                        maxX: x + imgW,\n                        maxY: y + imgH,\n                        marker: job.marker,\n                        isLabel: false\n                    });\n                }\n                let [x, y] = this._iconPositions[markerId];\n                job.iconCenter = [x + imgW / 2, y + imgH / 2];\n                job.iconSize = [imgW, imgH];\n            }\n            for (let marker of pointsForLabels) {\n                const markerId = L.stamp(marker);\n                const job = markerJobs[markerId];\n                let label = job.marker.label;\n                if (typeof label === 'function') {\n                    label = label(job.marker, zoom);\n                }\n                if (label) {\n                    job.label = label;\n                    if (!(markerId in this._labelPositions)) {\n                        const textWidth = ctx.measureText(label).width;\n                        const p = this.findLabelPosition(job.iconCenter, job.iconSize, textWidth, textHeight,\n                            limitLabelsToImage ? pixelExtents : null);\n                        this._labelPositions[markerId] = p;\n                        let [x, y] = p;\n                        this._regions.insert({\n                            minX: x,\n                            minY: y,\n                            maxX: x + textWidth,\n                            maxY: y + textHeight,\n                            marker: job.marker,\n                            isLabel: true\n                        });\n                    }\n                } else {\n                    this._labelPositions[markerId] = null;\n                }\n            }\n\n            const regionsInTile = this._regions.search({minX: tileW, minY: tileN, maxX: tileE, maxY: tileS});\n            // draw labels\n            for (let region of regionsInTile) {\n                if (region.isLabel) {\n                    // TODO: set font name ant size in options\n                    const markerId = L.stamp(region.marker);\n                    const job = markerJobs[markerId];\n                    const p = this._labelPositions[markerId];\n                    const x = p[0] - tileW;\n                    const y = p[1] - tileN;\n                    ctx.textBaseline = 'bottom';\n                    ctx.shadowColor = '#fff';\n                    ctx.strokeStyle = '#fff';\n                    ctx.fillStyle = '#000';\n                    ctx.lineWidth = 1.2 * this.options.iconScale;\n                    ctx.shadowBlur = this.options.labelShadowWidth * this.options.iconScale;\n                    ctx.strokeText(job.label, x, y + textHeight);\n                    ctx.shadowBlur = 0;\n                    ctx.fillText(job.label, x, y + textHeight);\n                }\n            }\n            ctx.globalAlpha = this.options.iconsOpacity;\n            // draw icons\n            for (let region of regionsInTile) {\n                if (!region.isLabel) {\n                    const markerId = L.stamp(region.marker);\n                    const job = markerJobs[markerId];\n                    const p = this._iconPositions[markerId];\n                    const x = p[0] - tileW;\n                    const y = p[1] - tileN;\n                    ctx.drawImage(job.img, x, y, job.iconSize[0], job.iconSize[1]);\n                }\n            }\n            ctx.globalAlpha = 1;\n        },\n\n        drawTile: async function(canvas, coords) {\n            const\n                zoom = coords.z,\n                tileSize = this.options.tileSize,\n                tileN = coords.y * tileSize,\n                tileW = coords.x * tileSize,\n                tileS = tileN + tileSize,\n                tileE = tileW + tileSize;\n            const pixelExtents = {tileN, tileS, tileE, tileW};\n            const {iconUrls, markerJobs, pointsForLabels} = this.selectMarkersForDraw(pixelExtents, zoom);\n            if (!markerJobs) {\n                return;\n            }\n            await this.preloadIcons(iconUrls);\n            this.drawSelectedMarkers(canvas, pixelExtents, markerJobs, pointsForLabels, zoom);\n        },\n\n        resetLabels: function() {\n            this._iconPositions = {};\n            this._labelPositions = {};\n            this._regions.clear();\n        },\n\n        findMarkerFromMouseEvent: function(e) {\n            const\n                p = this._map.project(e.latlng.wrap()),\n                region = this._regions.search({minX: p.x, minY: p.y, maxX: p.x, maxY: p.y})[0];\n            let marker;\n            if (region) {\n                marker = region.marker;\n            } else {\n                marker = null;\n            }\n            return marker;\n        },\n\n        onMouseMove: function(e) {\n            const marker = this.findMarkerFromMouseEvent(e);\n            if (this._hoverMarker !== marker) {\n                if (this._hoverMarker) {\n                    this.fire('markerleave', {marker: this._hoverMarker});\n                }\n                if (marker) {\n                    this.fire('markerenter', {marker: marker});\n                }\n                this._hoverMarker = marker;\n            }\n        },\n\n        showTooltip: function(e) {\n            if (!e.marker.tooltip) {\n                return;\n            }\n            let text = e.marker.tooltip;\n            if (typeof text === 'function') {\n                text = text(e.marker);\n                if (!e.marker.tooltip) {\n                    return;\n                }\n            }\n            this.toolTip.innerHTML = text;\n            const p = this._map.latLngToLayerPoint(e.marker.latlng);\n            L.DomUtil.setPosition(this.toolTip, p);\n            L.DomUtil.addClass(this.toolTip, 'canvas-marker-tooltip-on');\n        },\n\n        onMarkerEnter: function(e) {\n            this._map._container.style.cursor = 'pointer';\n            this.showTooltip(e);\n        },\n\n        onMarkerLeave: function() {\n            this._map._container.style.cursor = '';\n            L.DomUtil.removeClass(this.toolTip, 'canvas-marker-tooltip-on');\n        },\n\n        onMouseOut: function() {\n            if (this._hoverMarker) {\n                const marker = this._hoverMarker;\n                this._hoverMarker = null;\n                this.fire('markerleave', {marker});\n            }\n        },\n\n        onClick: function(e) {\n            if (this._map.clickLocked) {\n                return;\n            }\n            const marker = this.findMarkerFromMouseEvent(e);\n            if (marker) {\n                L.extend(e, {marker: marker});\n                this.fire('markerclick', e);\n            }\n        },\n\n        onRightClick: function(e) {\n            const marker = this.findMarkerFromMouseEvent(e);\n            if (marker) {\n                L.extend(e, {marker: marker});\n                this.fire('markercontextmenu', e);\n            }\n        },\n\n        onAdd: function(map) {\n            if (this.options.pane === 'rasterMarker' && !map.getPane('rasterMarker')) {\n                map.createPane('rasterMarker').style.zIndex = 550;\n            }\n            L.GridLayer.prototype.onAdd.call(this, map);\n            map.on('mousemove', this.onMouseMove, this);\n            map.on('mouseout', this.onMouseOut, this);\n            map.on('click', this.onClick, this);\n            map.on('contextmenu', this.onRightClick, this);\n            this.toolTip = L.DomUtil.create('div', 'canvas-marker-tooltip', this._map.getPanes().markerPane);\n        },\n\n        onRemove: function(map) {\n            this._map.off('mousemove', this.onMouseMove, this);\n            this._map.off('mouseout', this.onMouseOut, this);\n            this._map.off('click', this.onClick, this);\n            this._map.off('contextmenu', this.onRightClick, this);\n            if (this._hoverMarker) {\n                this._hoverMarker = null;\n                this.fire('markerleave', {marker: this._hoverMarker});\n            }\n            this._map.getPanes().markerPane.removeChild(this.toolTip);\n            L.GridLayer.prototype.onRemove.call(this, map);\n        }\n    }\n);\n","import L from 'leaflet';\n\nfunction shiftLongitudeToTarget(lng, targetLng) {\n    if (targetLng instanceof L.LatLngBounds) {\n        if (!targetLng.isValid()) {\n            return 0;\n        }\n        targetLng = targetLng.getCenter().lng;\n    } else {\n        targetLng = targetLng.lng ?? targetLng;\n    }\n    let shift = 0;\n    if (Math.abs(lng + 360 - targetLng) < Math.abs(lng - targetLng)) {\n        shift = 360;\n    } else if (Math.abs(lng - 360 - targetLng) < Math.abs(lng - targetLng)) {\n        shift = -360;\n    }\n    return shift;\n}\n\nfunction wrapLatLngToTarget(latLng, targetLng) {\n    const shift = shiftLongitudeToTarget(latLng.lng, targetLng);\n    return L.latLng(latLng.lat, latLng.lng + shift);\n}\n\nfunction wrapLatLngBoundsToTarget(latLngBounds, targetLng) {\n    const shift = shiftLongitudeToTarget(latLngBounds.getCenter().lng, targetLng);\n    const p1 = latLngBounds.getSouthEast();\n    const p2 = latLngBounds.getNorthWest();\n    return L.latLngBounds([[p1.lat, p1.lng + shift], [p2.lat, p2.lng + shift]]);\n}\n\nfunction fixVectorMarkerWorldJump() {\n    L.Polyline.prototype.shiftProjectedFitMapView = function() {\n        const polylineBounds = this.getBounds();\n        let shift = null;\n        if (this._map && polylineBounds.isValid()) {\n            const worldWidth = this._map.getPixelWorldBounds().getSize().x;\n            const polylineCenter = polylineBounds.getCenter();\n            const mapCenter = this._map.getCenter();\n\n            if (polylineCenter.lng < mapCenter.lng - 180) {\n                shift = worldWidth;\n            } else if (polylineCenter.lng > mapCenter.lng + 180) {\n                shift = -worldWidth;\n            } else {\n                shift = 0;\n            }\n        }\n        return shift;\n    };\n\n    // Shift line points longitude by +360 or -360, to minimize distance between line center and map view center\n    // Longitude is changed only for display, longitude of pints is not changed\n    // Breaks dipslay of lines spanning more then one world copy\n    L.Polyline.prototype._projectLatlngs = function(latlngs, result, projectedBounds) {\n        var flat = latlngs[0] instanceof L.LatLng,\n            len = latlngs.length,\n            i, ring;\n        let shift = null;\n        if (this.options.projectedShift) {\n            shift = this.options.projectedShift();\n        }\n        if (shift === null) {\n            shift = this.shiftProjectedFitMapView();\n        }\n\n        if (flat) {\n            ring = [];\n            for (i = 0; i < len; i++) {\n                let p = this._map.latLngToLayerPoint(latlngs[i]);\n                p.x += shift;\n                ring[i] = p;\n                projectedBounds.extend(p);\n            }\n            result.push(ring);\n        } else {\n            for (i = 0; i < len; i++) {\n                this._projectLatlngs(latlngs[i], result, projectedBounds);\n            }\n        }\n    };\n\n    // Shift marker longitude by +360 or -360, which is closer to map view center\n    // Longitude is changed only for positioning html-element, Marker._latlng is not changed\n    // Breaks display of markers with huge longitudes like 750 (can be displayed only at zoom levels 0 or 1)\n    L.Marker.prototype.update = function() {\n        if (this._icon) {\n            var pos = this._map.latLngToLayerPoint(this._latlng).round();\n            let shift = null;\n            if (this.options.projectedShift) {\n                shift = this.options.projectedShift();\n            }\n            if (shift === null) {\n                const mapCenter = this._map.getCenter();\n                const worldWidth = this._map.getPixelWorldBounds().getSize().x;\n                if (this._latlng.lng < mapCenter.lng - 180) {\n                    shift = worldWidth;\n                } else if (this._latlng.lng > mapCenter.lng + 180) {\n                    shift = -worldWidth;\n                } else {\n                    shift = 0;\n                }\n            }\n            pos.x += shift;\n            this._setPos(pos);\n        }\n\n        return this;\n    };\n\n    // Emit viewreset event when longitude of map view center changes more then 90 degrees from prevoius reset\n    L.Map.addInitHook(function() {\n        this._lastResetLongitude = null;\n        this.on('viewreset', () => {\n            this._lastResetLongitude = this.getCenter().lng;\n        });\n\n        this.on('move', () => {\n            const lng = this.getCenter().lng;\n            if (this._lastResetLongitude === null) {\n                this._lastResetLongitude = lng;\n            } else if (Math.abs(lng - this._lastResetLongitude) > 90) {\n                this.fire('viewreset');\n            }\n        });\n    });\n\n    // Avoid marker longitude change from 180 to -180 while dragging.\n    L.Handler.MarkerDrag = L.Handler.extend({\n        _onDrag: function(e) {\n            var marker = this._marker,\n                shadow = marker._shadow,\n                iconPos = L.DomUtil.getPosition(marker._icon),\n                latlng = marker._map.layerPointToLatLng(iconPos);\n            // update shadow position\n            if (shadow) {\n                L.DomUtil.setPosition(shadow, iconPos);\n            }\n\n            latlng = wrapLatLngToTarget(latlng, marker._latlng);\n            marker._latlng = latlng;\n            e.latlng = latlng;\n            e.oldLatLng = this._oldLatLng;\n\n            // @event drag: Event\n            // Fired repeatedly while the user drags the marker.\n            marker\n                .fire('move', e)\n                .fire('drag', e);\n        }\n    });\n}\n\nexport {wrapLatLngToTarget, fixVectorMarkerWorldJump, wrapLatLngBoundsToTarget};\n","/* FileSaver.js\n * A saveAs() FileSaver implementation.\n * 1.3.8\n * 2018-03-22 14:03:47\n *\n * By Eli Grey, https://eligrey.com\n * License: MIT\n *   See https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md\n */\n\n/*global self */\n/*jslint bitwise: true, indent: 4, laxbreak: true, laxcomma: true, smarttabs: true, plusplus: true */\n\n/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/src/FileSaver.js */\n\nexport var saveAs = saveAs || (function(view) {\n        \"use strict\";\n        // IE <10 is explicitly unsupported\n        if (typeof view === \"undefined\" || typeof navigator !== \"undefined\" && /MSIE [1-9]\\./.test(navigator.userAgent)) {\n            return;\n        }\n        var\n            doc = view.document\n            // only get URL when necessary in case Blob.js hasn't overridden it yet\n            , get_URL = function() {\n                return view.URL || view.webkitURL || view;\n            }\n            , save_link = doc.createElementNS(\"http://www.w3.org/1999/xhtml\", \"a\")\n            , can_use_save_link = \"download\" in save_link\n            , click = function(node) {\n                var event = new MouseEvent(\"click\");\n                node.dispatchEvent(event);\n            }\n            , is_safari = /constructor/i.test(view.HTMLElement) || view.safari\n            , is_chrome_ios =/CriOS\\/[\\d]+/.test(navigator.userAgent)\n            , setImmediate = view.setImmediate || view.setTimeout\n            , throw_outside = function(ex) {\n                setImmediate(function() {\n                    throw ex;\n                }, 0);\n            }\n            , force_saveable_type = \"application/octet-stream\"\n            // the Blob API is fundamentally broken as there is no \"downloadfinished\" event to subscribe to\n            , arbitrary_revoke_timeout = 1000 * 40 // in ms\n            , revoke = function(file) {\n                var revoker = function() {\n                    if (typeof file === \"string\") { // file is an object URL\n                        get_URL().revokeObjectURL(file);\n                    } else { // file is a File\n                        file.remove();\n                    }\n                };\n                setTimeout(revoker, arbitrary_revoke_timeout);\n            }\n            , dispatch = function(filesaver, event_types, event) {\n                event_types = [].concat(event_types);\n                var i = event_types.length;\n                while (i--) {\n                    var listener = filesaver[\"on\" + event_types[i]];\n                    if (typeof listener === \"function\") {\n                        try {\n                            listener.call(filesaver, event || filesaver);\n                        } catch (ex) {\n                            throw_outside(ex);\n                        }\n                    }\n                }\n            }\n            , auto_bom = function(blob) {\n                // prepend BOM for UTF-8 XML and text/* types (including HTML)\n                // note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\n                if (/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n                    return new Blob([String.fromCharCode(0xFEFF), blob], {type: blob.type});\n                }\n                return blob;\n            }\n            , FileSaver = function(blob, name, no_auto_bom) {\n                if (!no_auto_bom) {\n                    blob = auto_bom(blob);\n                }\n                // First try a.download, then web filesystem, then object URLs\n                var\n                    filesaver = this\n                    , type = blob.type\n                    , force = type === force_saveable_type\n                    , object_url\n                    , dispatch_all = function() {\n                        dispatch(filesaver, \"writestart progress write writeend\".split(\" \"));\n                    }\n                    // on any filesys errors revert to saving with object URLs\n                    , fs_error = function() {\n                        if ((is_chrome_ios || (force && is_safari)) && view.FileReader) {\n                            // Safari doesn't allow downloading of blob urls\n                            var reader = new FileReader();\n                            reader.onloadend = function() {\n                                var url = is_chrome_ios ? reader.result : reader.result.replace(/^data:[^;]*;/, 'data:attachment/file;');\n                                var popup = view.open(url, '_blank');\n                                if(!popup) view.location.href = url;\n                                url=undefined; // release reference before dispatching\n                                filesaver.readyState = filesaver.DONE;\n                                dispatch_all();\n                            };\n                            reader.readAsDataURL(blob);\n                            filesaver.readyState = filesaver.INIT;\n                            return;\n                        }\n                        // don't create more object URLs than needed\n                        if (!object_url) {\n                            object_url = get_URL().createObjectURL(blob);\n                        }\n                        if (force) {\n                            view.location.href = object_url;\n                        } else {\n                            var opened = view.open(object_url, \"_blank\");\n                            if (!opened) {\n                                // Apple does not allow window.open, see https://developer.apple.com/library/safari/documentation/Tools/Conceptual/SafariExtensionGuide/WorkingwithWindowsandTabs/WorkingwithWindowsandTabs.html\n                                view.location.href = object_url;\n                            }\n                        }\n                        filesaver.readyState = filesaver.DONE;\n                        dispatch_all();\n                        revoke(object_url);\n                    }\n                    ;\n                filesaver.readyState = filesaver.INIT;\n\n                if (can_use_save_link) {\n                    object_url = get_URL().createObjectURL(blob);\n                    setImmediate(function() {\n                        save_link.href = object_url;\n                        save_link.download = name;\n                        save_link.target = '_self';\n                        click(save_link);\n                        dispatch_all();\n                        revoke(object_url);\n                        filesaver.readyState = filesaver.DONE;\n                    }, 0);\n                    return;\n                }\n\n                fs_error();\n            }\n            , FS_proto = FileSaver.prototype\n            , saveAs = function(blob, name, no_auto_bom) {\n                return new FileSaver(blob, name || blob.name || \"download\", no_auto_bom);\n            }\n            ;\n\n        // IE 10+ (native saveAs)\n        if (typeof navigator !== \"undefined\" && navigator.msSaveOrOpenBlob) {\n            return function(blob, name, no_auto_bom) {\n                name = name || blob.name || \"download\";\n\n                if (!no_auto_bom) {\n                    blob = auto_bom(blob);\n                }\n                return navigator.msSaveOrOpenBlob(blob, name);\n            };\n        }\n\n        // todo: detect chrome extensions & packaged apps\n        //save_link.target = \"_blank\";\n\n        FS_proto.abort = function(){};\n        FS_proto.readyState = FS_proto.INIT = 0;\n        FS_proto.WRITING = 1;\n        FS_proto.DONE = 2;\n\n        FS_proto.error =\n            FS_proto.onwritestart =\n                FS_proto.onprogress =\n                    FS_proto.onwrite =\n                        FS_proto.onabort =\n                            FS_proto.onerror =\n                                FS_proto.onwriteend =\n                                    null;\n\n        return saveAs;\n    }(\n        typeof self !== \"undefined\" && self\n        || typeof window !== \"undefined\" && window\n        || this\n    ));\n","import L from 'leaflet';\nimport ko from 'knockout';\nimport Contextmenu from '~/lib/contextmenu';\nimport '~/lib/knockout.component.progress/progress';\nimport './track-list.css';\nimport {selectFiles, readFiles} from '~/lib/file-read';\nimport parseGeoFile from './lib/parseGeoFile';\nimport loadFromUrl from './lib/loadFromUrl';\nimport * as geoExporters from './lib/geo_file_exporters';\nimport copyToClipboard from '~/lib/clipboardCopy';\nimport {saveAs} from '~/vendored/github.com/eligrey/FileSaver';\nimport '~/lib/leaflet.layer.canvasMarkers';\nimport '~/lib/leaflet.lineutil.simplifyLatLngs';\nimport iconFromBackgroundImage from '~/lib/iconFromBackgroundImage';\nimport '~/lib/controls-styles/controls-styles.css';\nimport {ElevationProfile, calcSamplingInterval} from '~/lib/leaflet.control.elevation-profile';\nimport '~/lib/leaflet.control.commons';\nimport {blobFromString} from '~/lib/binary-strings';\nimport '~/lib/leaflet.polyline-edit';\nimport '~/lib/leaflet.polyline-measure';\nimport * as logging from '~/lib/logging';\nimport {notify, query} from '~/lib/notifications';\nimport {fetch} from '~/lib/xhr-promise';\nimport config from '~/config';\nimport md5 from 'blueimp-md5';\nimport {wrapLatLngToTarget, wrapLatLngBoundsToTarget} from '~/lib/leaflet.fixes/fixWorldCopyJump';\nimport {splitLinesAt180Meridian} from \"./lib/meridian180\";\nimport {ElevationProvider} from '~/lib/elevations';\nimport JSZip from 'jszip';\nconst TRACKLIST_TRACK_COLORS = ['#77f', '#f95', '#0ff', '#FF0000', '#f7f', '#000', '#008000'];\n\nconst TrackSegment = L.MeasuredLine.extend({\n    includes: L.Polyline.EditMixin,\n\n    options: {\n        weight: 6,\n        lineCap: 'round',\n        opacity: 0.6,\n\n    }\n});\nTrackSegment.mergeOptions(L.Polyline.EditMixinOptions);\n\nfunction unwrapLatLngsCrossing180Meridian(latngs) {\n    if (latngs.length === 0) {\n        return [];\n    }\n    const unwrapped = [latngs[0]];\n    let lastUnwrapped;\n    let prevUnwrapped = latngs[0];\n    for (let i = 1; i < latngs.length; i++) {\n        lastUnwrapped = wrapLatLngToTarget(latngs[i], prevUnwrapped);\n        unwrapped.push(lastUnwrapped);\n        prevUnwrapped = lastUnwrapped;\n    }\n    return unwrapped;\n}\n\nfunction closestPointToLineSegment(latlngs, segmentIndex, point) {\n    const crs = L.CRS.EPSG3857;\n    point = crs.latLngToPoint(point);\n    const segStart = crs.latLngToPoint(latlngs[segmentIndex]);\n    const segEnd = crs.latLngToPoint(latlngs[segmentIndex + 1]);\n    return crs.pointToLatLng(L.LineUtil.closestPointOnSegment(point, segStart, segEnd));\n}\n\nfunction isPointCloserToStart(latlngs, latlng) {\n    const distToStart = latlng.distanceTo(latlngs[0]);\n    const distToEnd = latlng.distanceTo(latlngs[latlngs.length - 1]);\n    return distToStart < distToEnd;\n}\n\nL.Control.TrackList = L.Control.extend({\n        options: {\n            position: 'bottomright',\n            lineCursorStyle: {interactive: false, weight: 1.5, opacity: 1, dashArray: '7,7'},\n            lineCursorValidStyle: {color: 'green'},\n            lineCursorInvalidStyle: {color: 'red'},\n            splitExtensions: ['gpx', 'kml', 'kmz', 'wpt', 'rte', 'plt', 'fit', 'tmp', 'jpg', 'crdownload'],\n            splitExtensionsFirstStage: ['xml', 'txt', 'html', 'php', 'tmp', 'gz'],\n        },\n        includes: L.Evented,\n\n        colors: TRACKLIST_TRACK_COLORS,\n\n        initialize: function() {\n            L.Control.prototype.initialize.call(this);\n            this.currentGroup = ko.observable('');\n            this.tracks = ko.observableArray();\n            this.url = ko.observable('');\n            this.readingFiles = ko.observable(0);\n            this.readProgressRange = ko.observable();\n            this.readProgressDone = ko.observable();\n            this._lastTrackColor = 0;\n            this.trackListHeight = ko.observable(0);\n            this.isPlacingPoint = false;\n            this.trackAddingPoint = ko.observable(null);\n            this.trackAddingSegment = ko.observable(null);\n            this.filteredTracks = ko.computed(() => {\n                let current_group = this.currentGroup();\n                if (!current_group || current_group === '') {\n                    return this.tracks;\n                } else {\n                    return ko.utils.arrayFilter(this.tracks(), function(element) {\n                        return (element.group() === current_group);\n                    });\n                }\n            });\n\n            this.tracks.subscribe( (changes) => {\n                let group = '';\n                let shared = false;\n                changes.forEach( (el) => {\n                    if ( 'added' === el.status ) {\n                        group = el.value.group();\n                    }\n                    if ( 'deleted' === el.status ) {\n                        group = el.value.group();\n                    }\n                } );\n                this.setTab( group );\n\n\n                // если после изменения трэклиста не остатётся расшареных трэков - скрываем табы\n                this.tracks().forEach( (obj) => {\n                    if ( 'shared' === obj.group() ) {\n                        shared = true;\n                    }\n                } );\n                if ( ! shared ) {\n                    this.setTab( '' );\n                }\n\n            }, null, 'arrayChange');\n        },\n\n        setTab: function(tab, check_groups = false) {\n            if ( check_groups ) {\n                let shared_tracks_exists = false;\n                this.tracks().forEach( (obj) => {\n                    if ( 'shared' === obj.group() ) {\n                        shared_tracks_exists = true;\n                    }\n                } );\n                if ( ! shared_tracks_exists ) {\n                    tab = '';\n                }\n            }\n            this.setCurrentGroup(tab);\n\n            if ( 'default' === tab ) {\n                let base_loaded = document.querySelector('#tab-loaded');\n                let base_tab = document.querySelector('#tab-base');\n                base_loaded.classList.remove(\"tabs__link_active\");\n                base_tab.classList.add(\"tabs__link_active\");\n            }\n\n            if ( 'shared' === tab ) {\n                let base_loaded = document.querySelector('#tab-loaded');\n                let base_tab = document.querySelector('#tab-base');\n                base_tab.classList.remove(\"tabs__link_active\");\n                base_loaded.classList.add(\"tabs__link_active\");\n            }\n        },\n\n        setCurrentGroup: function(group) {\n            this.currentGroup( group );\n        },\n\n        onAdd: function(map) {\n            this.map = map;\n            this.tracks.removeAll();\n            var container = this._container = L.DomUtil.create('div', 'leaflet-control leaflet-control-tracklist');\n            this._stopContainerEvents();\n\n            /* eslint-disable max-len */\n            container.innerHTML = `\n                <div class=\"leaflet-control-button-toggle\" data-bind=\"click: setExpanded\"\n                 title=\"Load, edit and save tracks\"></div>\n                <div class=\"leaflet-control-content\">\n                <div class=\"header\">\n                    <div class=\"hint\"\n                     title=\"gpx kml Ozi zip YandexMaps GPSies Strava GPSLib Endomondo Etomesto Movescount GarminConnect SportsTracker OSM Tracedetrail OpenStreetMap.ru\">\n                        gpx kml Ozi zip YandexMaps GPSies Strava\n                        <span class=\"formats-hint-more\">&hellip;</span>\n                    </div>\n                    <div class=\"button-minimize\" data-bind=\"click: setMinimized\"></div>\n                </div>\n                <div class=\"inputs-row\" data-bind=\"visible: !readingFiles()\">\n                    <a class=\"button add-track\" title=\"Создать новый трэк\" data-bind=\"click: onButtonNewTrackClicked\"></a\n                    ><a class=\"button open-file\" title=\"Открыть файл с трэком\" data-bind=\"click: loadFilesFromDisk\"></a\n                    ><input type=\"text\" class=\"input-url\" placeholder=\"URL трэка\"\n                        data-bind=\"textInput: url, event: {keypress: onEnterPressedInInput, contextmenu: defaultEventHandle, mousemove: defaultEventHandle}\"\n                    ><a class=\"button download-url\" title=\"Загрузить трэк по URL\" data-bind=\"click: loadFilesFromUrl\"></a\n                    ><a class=\"button menu-icon\" data-bind=\"click: function(_,e){this.showMenu(e)}\" title=\"Меню\"></a>\n                </div>\n                <div style=\"text-align: center\">\n                    <div data-bind=\"\n                        component: {\n                        name: 'progress-indicator',\n                        params: {progressRange: readProgressRange, progressDone: readProgressDone}\n                        },\n                        visible: readingFiles\"></div>\n                </div>\n                <div class=\"tabs__nav\" data-bind=\"visible: currentGroup() !== ''\">\n                    <a id=\"tab-base\" data-bind=\"click: showDefaultTracklist\" class=\"tabs__link\" href=\"#content-1\">Мой трэклист</a>\n                    <a id=\"tab-loaded\" data-bind=\"click: showSharedTracklist\" class=\"tabs__link tabs__link_active\" href=\"#content-2\">Временный трэклист</a>\n                </div>\n                <div class=\"tracks-rows-wrapper\" data-bind=\"style: {maxHeight: trackListHeight}\">\n                <table class=\"tracks-rows\"><tbody data-bind=\"foreach: {data: filteredTracks(), as: 'track'}\">\n                    <tr data-bind=\"event: {\n                                       contextmenu: $parent.showTrackMenu.bind($parent),\n                                       mouseenter: $parent.onTrackRowMouseEnter.bind($parent, track),\n                                       mouseleave: $parent.onTrackRowMouseLeave.bind($parent, track)\n                                   },\n                                   css: {hover: hover() && $parent.tracks().length > 1, edit: isEdited() && $parent.tracks().length > 1}\">\n                        <td><input type=\"checkbox\" class=\"visibility-switch\" data-bind=\"checked: track.visible\"></td>\n                        <td><div class=\"color-sample\" data-bind=\"style: {backgroundColor: $parent.colors[track.color()]}, click: $parent.onColorSelectorClicked.bind($parent)\"></div></td>\n                        <td><div class=\"track-name-wrapper\"><div class=\"track-name\" data-bind=\"text: track.name, attr: {title: track.name}, click: $parent.setViewToTrack.bind($parent)\"></div></div></td>\n                        <td>\n                            <div class=\"button-length\" title=\"Show distance marks\" data-bind=\"\n                                text: $parent.formatLength(track.length()),\n                                css: {'ticks-enabled': track.measureTicksShown},\n                                click: $parent.switchMeasureTicksVisibility.bind($parent)\"></div>\n                        </td>\n                        <td><div class=\"button-add-track\" title=\"Добавить сегмент\" data-bind=\"click: $parent.onButtonAddSegmentClicked.bind($parent, track), css: {active: $parent.trackAddingSegment() === track}\"></div></td>\n                        <td><div class=\"button-add-point\" title=\"Добавить метку\" data-bind=\"click: $parent.onButtonAddPointClicked.bind($parent, track), css: {active: $parent.trackAddingPoint() === track}\"></div></td>\n                        <td><a class=\"track-text-button\" title=\"Действия\" data-bind=\"click: $parent.showTrackMenu.bind($parent)\">&hellip;</a></td>\n                    </tr>\n                </tbody></table>\n                </div>\n                </div>\n            `;\n            /* eslint-enable max-len */\n\n            ko.applyBindings(this, container);\n            // FIXME: add onRemove method and unsubscribe\n            L.DomEvent.addListener(map.getContainer(), 'drop', this.onFileDragDrop, this);\n            L.DomEvent.addListener(map.getContainer(), 'dragover', this.onFileDraging, this);\n            this.menu = new Contextmenu([\n                    {text: 'Копировать ссылку на все трэки', callback: this.copyAllTracksToClipboard.bind(this)},\n                    {text: 'Копировать ссылку на видимые трэки', callback: this.copyVisibleTracks.bind(this)},\n                    '-',\n                    {text: 'Скачать видимые трэки архивом', callback: this.downloadVisibleTracks.bind(this)},\n                    '-',\n                    {text: 'Удалить все трэки', callback: this.deleteAllTracks.bind(this)},\n                    {text: 'Удалить скрытые трэки', callback: this.deleteHiddenTracks.bind(this)}\n                ]\n            );\n            this._markerLayer = new L.Layer.CanvasMarkers(null, {\n                print: true,\n                scaleDependent: true,\n                zIndex: 1000,\n                printTransparent: true\n            }).addTo(map);\n            this._markerLayer.on('markerclick markercontextmenu', this.onMarkerClick, this);\n            this._markerLayer.on('markerenter', this.onMarkerEnter, this);\n            this._markerLayer.on('markerleave', this.onMarkerLeave, this);\n            map.on('resize', this._setAdaptiveHeight, this);\n            setTimeout(() => this._setAdaptiveHeight(), 0);\n            return container;\n        },\n\n        showDefaultTracklist: function(e) {\n            let base_loaded = document.querySelector('#tab-loaded');\n            let base_tab = document.querySelector('#tab-base');\n            base_loaded.classList.remove(\"tabs__link_active\");\n            base_tab.classList.add(\"tabs__link_active\");\n            this.currentGroup('default');\n            this.currentGroup.valueHasMutated();\n            this.tracks.valueHasMutated();\n        },\n\n        showSharedTracklist: function(e) {\n            let base_loaded = document.querySelector('#tab-loaded');\n            let base_tab = document.querySelector('#tab-base');\n            base_tab.classList.remove(\"tabs__link_active\");\n            base_loaded.classList.add(\"tabs__link_active\");\n            this.currentGroup('shared');\n            this.currentGroup.valueHasMutated();\n            this.tracks.valueHasMutated();\n        },\n\n        defaultEventHandle: function(_, e) {\n            L.DomEvent.stopPropagation(e);\n            return true;\n        },\n\n        _setAdaptiveHeight: function() {\n            const mapHeight = this._map.getSize().y;\n            let maxHeight;\n            maxHeight =\n                mapHeight -\n                this._container.offsetTop - // controls above\n                // controls below\n                (this._container.parentNode.offsetHeight - this._container.offsetTop - this._container.offsetHeight) -\n                525; // margin\n            this.trackListHeight(maxHeight + 'px');\n        },\n\n        setExpanded: function() {\n            L.DomUtil.removeClass(this._container, 'minimized');\n        },\n\n        setMinimized: function() {\n            L.DomUtil.addClass(this._container, 'minimized');\n        },\n\n        onFileDraging: function(e) {\n            L.DomEvent.stopPropagation(e);\n            L.DomEvent.preventDefault(e);\n            e.dataTransfer.dropEffect = 'copy';\n        },\n\n        onFileDragDrop: function(e) {\n            L.DomEvent.stopPropagation(e);\n            L.DomEvent.preventDefault(e);\n            const files = e.dataTransfer.files;\n            if (files && files.length) {\n                this.loadFilesFromFilesObject(files);\n            }\n        },\n\n        onEnterPressedInInput: function(this_, e) {\n            if (e.keyCode === 13) {\n                this_.loadFilesFromUrl();\n                L.DomEvent.stop(e);\n                return false;\n            }\n            return true;\n        },\n\n        getTrackPolylines: function(track) {\n            return track.feature.getLayers().filter(function(layer) {\n                    return layer instanceof L.Polyline;\n                }\n            );\n        },\n\n        getTrackPoints: function(track) {\n            return track.markers;\n        },\n\n        onButtonNewTrackClicked: function() {\n            let name = this.url().trim();\n            if (name.length > 0) {\n                this.url('');\n            } else {\n                name = 'Новый трэк';\n            }\n            this.addTrackAndEdit(name);\n        },\n\n        addSegmentAndEdit: function(track) {\n            this.stopPlacingPoint();\n            const segment = this.addTrackSegment(track);\n            this.startEditTrackSegement(segment);\n            segment.startDrawingLine();\n            this.trackAddingSegment(track);\n        },\n\n        addTrackAndEdit: function(name) {\n            const track = this.addTrack({name: name, color: 0});\n            this.addSegmentAndEdit(track);\n            return track;\n        },\n\n        loadFilesFromFilesObject: function(files) {\n            this.readingFiles(this.readingFiles() + 1);\n\n            readFiles(files).then(function(fileDataArray) {\n                const geodataArray = [];\n                for (let fileData of fileDataArray) {\n                    geodataArray.push(...parseGeoFile(fileData.filename, fileData.data));\n                }\n                this.readingFiles(this.readingFiles() - 1);\n\n                this.addTracksFromGeodataArray(geodataArray);\n            }.bind(this));\n        },\n\n        loadFilesFromDisk: function() {\n            logging.captureBreadcrumb('load track from disk');\n            selectFiles(true).then(this.loadFilesFromFilesObject.bind(this));\n        },\n\n        loadFilesFromUrl: function() {\n            var url = this.url().trim();\n            if (!url) {\n                return;\n            }\n\n            this.readingFiles(this.readingFiles() + 1);\n\n            logging.captureBreadcrumb('load track from url', {trackUrl: url});\n            loadFromUrl(url)\n                .then((geodata) => {\n                    this.addTracksFromGeodataArray(geodata);\n                    this.readingFiles(this.readingFiles() - 1);\n                });\n            this.url('');\n        },\n\n        whenLoadDone: function(cb) {\n            if (this.readingFiles() === 0) {\n                cb();\n                return;\n            }\n            const subscription = this.readingFiles.subscribe((value) => {\n                if (value === 0) {\n                    subscription.dispose();\n                    cb();\n                }\n            });\n        },\n\n        addTracksFromGeodataArray: function( geodata_array, origin = '' ) {\n            let hasData = false;\n            var messages = [];\n            if (geodata_array.length === 0) {\n                messages.push('No tracks loaded');\n            }\n            geodata_array.forEach(function(geodata) {\n                    var data_empty = !((geodata.tracks && geodata.tracks.length) ||\n                        (geodata.points && geodata.points.length));\n\n                    if (!data_empty) {\n                        if (geodata.tracks) {\n                            geodata.tracks = geodata.tracks.map(function(line) {\n                                    line = unwrapLatLngsCrossing180Meridian(line);\n                                    line = L.LineUtil.simplifyLatlngs(line, 360 / (1 << 24));\n                                    if (line.length === 1) {\n                                        line.push(line[0]);\n                                    }\n                                    return line;\n                                }\n                            );\n                        }\n                        hasData = true;\n                        let track = this.addTrack(geodata);\n                        if ( 'nktu' === origin ) {\n                            track.feature._map.fitBounds( track.feature.getBounds() );\n                        }\n                    }\n                    var error_messages = {\n                        CORRUPT: 'File \"{name}\" is corrupt',\n                        UNSUPPORTED: 'File \"{name}\" has unsupported format or is badly corrupt',\n                        NETWORK: 'Could not download file from url \"{name}\"',\n                        INVALID_URL: '\"{name}\"  is not of supported URL type',\n                    };\n                    var message;\n                    if (geodata.error) {\n                        message = error_messages[geodata.error] || geodata.error;\n                        if (data_empty) {\n                            message += ', no data could be loaded';\n                        } else {\n                            message += ', loaded data can be invalid or incomplete';\n                        }\n                    }\n                    if (message) {\n                        message = L.Util.template(message, {name: geodata.name});\n                        messages.push(message);\n                    }\n                }.bind(this)\n            );\n            if (messages.length) {\n                notify(messages.join('\\n'));\n            }\n            return hasData;\n        },\n\n        onTrackColorChanged: function(track) {\n            var color = this.colors[track.color()];\n            this.getTrackPolylines(track).forEach(\n                function(polyline) {\n                    polyline.setStyle({color: color});\n                }\n            );\n            var markers = this.getTrackPoints(track);\n            markers.forEach(this.setMarkerIcon.bind(this));\n            this._markerLayer.updateMarkers(markers);\n        },\n\n        onTrackVisibilityChanged: function(track) {\n            if (track.visible()) {\n                this.map.addLayer(track.feature);\n                this._markerLayer.addMarkers(track.markers);\n            } else {\n                if (this.trackAddingPoint() === track) {\n                    this.stopPlacingPoint();\n                }\n                this.map.removeLayer(track.feature);\n                this._markerLayer.removeMarkers(track.markers);\n            }\n            this.updateTrackHighlight();\n        },\n\n        onTrackSegmentNodesChanged: function(track, segment) {\n            if (segment.getFixedLatLngs().length > 0) {\n                this.trackAddingSegment(null);\n            }\n            this.recalculateTrackLength(track);\n        },\n\n        recalculateTrackLength: function(track) {\n            const lines = this.getTrackPolylines(track);\n            let length = 0;\n            for (let line of lines) {\n                length += line.getLength();\n            }\n            track.length(length);\n        },\n\n        formatLength: function(x) {\n            var digits = 0;\n            if (x < 10000) {\n                digits = 2;\n            } else if (x < 100000) {\n                digits = 1;\n            }\n            return (x / 1000).toFixed(digits) + ' km';\n        },\n\n        setTrackMeasureTicksVisibility: function(track) {\n            var visible = track.measureTicksShown(),\n                lines = this.getTrackPolylines(track);\n            lines.forEach((line) => line.setMeasureTicksVisible(visible));\n        },\n\n        switchMeasureTicksVisibility: function(track) {\n            track.measureTicksShown(!(track.measureTicksShown()));\n        },\n\n        onColorSelectorClicked: function(track, e) {\n            track._contextmenu.show(e);\n        },\n\n        setViewToTrack: function(track) {\n            this.setViewToBounds(this.getTrackBounds(track));\n        },\n\n        setViewToAllTracks: function(immediate) {\n            const bounds = L.latLngBounds([]);\n            for (let track of this.tracks()) {\n                bounds.extend(this.getTrackBounds(track));\n            }\n            this.setViewToBounds(bounds, immediate);\n        },\n\n        setViewToBounds: function(bounds, immediate) {\n            if (bounds && bounds.isValid()) {\n                bounds = wrapLatLngBoundsToTarget(bounds, this.map.getCenter());\n                if (L.Browser.mobile || immediate) {\n                    this.map.fitBounds(bounds, {maxZoom: 16});\n                } else {\n                    this.map.flyToBounds(bounds, {maxZoom: 16});\n                }\n            }\n        },\n\n        getTrackBounds: function(track) {\n            const lines = this.getTrackPolylines(track);\n            const points = this.getTrackPoints(track);\n            const bounds = L.latLngBounds([]);\n            if (lines.length || points.length) {\n                lines.forEach((l) => {\n                        if (l.getLatLngs().length > 1) {\n                            bounds.extend(wrapLatLngBoundsToTarget(l.getBounds(), bounds));\n                        }\n                    }\n                );\n                points.forEach((p) => {\n                        bounds.extend(wrapLatLngToTarget(p.latlng, bounds));\n                    }\n                );\n            }\n            return bounds;\n        },\n\n        attachColorSelector: function(track) {\n            var items = this.colors.map(function(color, index) {\n                    return {\n                        text: '<div style=\"display: inline-block; vertical-align: middle; width: 50px; height: 0; ' +\n                            'border-top: 4px solid ' + color + '\"></div>',\n                        callback: track.color.bind(null, index)\n                    };\n                }\n            );\n            track._contextmenu = new Contextmenu(items);\n        },\n\n        attachActionsMenu: function(track) {\n            var items = [\n                function() {\n                    return {text: `${track.name()}`, header: true};\n                },\n                '-',\n                {text: 'Переименовать', callback: this.renameTrack.bind(this, track)},\n                {text: 'Дублировать', callback: this.duplicateTrack.bind(this, track)},\n                {text: 'Реверсировать', callback: this.reverseTrack.bind(this, track)},\n                {text: 'Показать профиль высоты', callback: this.showElevationProfileForTrack.bind(this, track)},\n                '-',\n                {text: 'Удалить', callback: this.removeTrack.bind(this, track)},\n                '-',\n                {text: 'Скачать GPX', callback: this.saveTrackAsFile.bind(this, track, geoExporters.saveGpx, '.gpx')},\n                {text: 'Скачать KML', callback: this.saveTrackAsFile.bind(this, track, geoExporters.saveKml, '.kml')},\n                {text: 'Копировать ссылку на трэк', callback: this.copyTrackLinkToClipboard.bind(this, track)},\n                {text: 'Дополнительно', separator: true},\n                {\n                    text: 'Скачать GPX с добавлением высоты',\n                    callback: this.saveTrackAsFile.bind(this, track, geoExporters.saveGpxWithElevations, '.gpx', true),\n                },\n            ];\n            track._actionsMenu = new Contextmenu(items);\n        },\n\n        onButtonAddSegmentClicked: function(track) {\n            if (!track.visible()) {\n                return;\n            }\n            if (this.trackAddingSegment() === track) {\n                this.trackAddingSegment(null);\n                this.stopEditLine();\n            } else {\n                this.addSegmentAndEdit(track);\n            }\n        },\n\n        duplicateTrack: function(track) {\n            const segments = this.getTrackPolylines(track).map((line) =>\n                line.getLatLngs().map((latlng) => [latlng.lat, latlng.lng])\n            );\n            const points = this.getTrackPoints(track)\n                .map((point) => ({lat: point.latlng.lat, lng: point.latlng.lng, name: point.label}));\n            this.addTrack({name: track.name(), tracks: segments, points});\n        },\n\n        reverseTrackSegment: function(trackSegment) {\n            trackSegment.stopDrawingLine();\n            var latlngs = trackSegment.getLatLngs();\n            latlngs = latlngs.map(function(ll) {\n                    return [ll.lat, ll.lng];\n                }\n            );\n            latlngs.reverse();\n            var isEdited = (this._editedLine === trackSegment);\n            this.deleteTrackSegment(trackSegment);\n            var newTrackSegment = this.addTrackSegment(trackSegment._parentTrack, latlngs);\n            if (isEdited) {\n                this.startEditTrackSegement(newTrackSegment);\n            }\n        },\n\n        reverseTrack: function(track) {\n            var that = this;\n            this.getTrackPolylines(track).forEach(function(trackSegment) {\n                    that.reverseTrackSegment(trackSegment);\n                }\n            );\n        },\n\n        copyTracksLinkToClipboard: function(tracks, mouseEvent) {\n            if (!tracks.length) {\n                notify('No tracks to copy');\n                return;\n            }\n            let serialized = tracks.map((track) => this.trackToString(track)).join('/');\n            const hashDigest = md5(serialized, null, true);\n            const key = btoa(hashDigest).replace(/\\//ug, '_').replace(/\\+/ug, '-').replace(/=/ug, '');\n            const url = window.location + '&nktl=' + key;\n            copyToClipboard(url, mouseEvent);\n            fetch(`${config.tracksStorageServer}/${key}`, {\n                method: 'PUT',\n                data: serialized,\n                withCredentials: false\n            }).then(\n                null, (e) => {\n                    let message = e.message || e;\n                    if (e.xhr.status === 413) {\n                        message = 'track is too big';\n                    }\n                    logging.captureMessage('Failed to save track to server',\n                        {status: e.xhr.status, response: e.xhr.responseText});\n                    notify('Error making link: ' + message);\n                }\n            );\n        },\n\n        copyTrackLinkToClipboard: function(track, mouseEvent) {\n            this.copyTracksLinkToClipboard([track], mouseEvent);\n        },\n\n        saveTrackAsFile: async function(track, exporter, extension, addElevations = false) {\n            var lines = this.getTrackPolylines(track)\n                .map(function(line) {\n                        return line.getFixedLatLngs();\n                    }\n                );\n            lines = splitLinesAt180Meridian(lines);\n            var points = this.getTrackPoints(track);\n            let name = track.name();\n            // Browser (Chrome) removes leading dots.\n            name = name.replace(/^\\./u, '_');\n            for (let extensions of [this.options.splitExtensionsFirstStage, this.options.splitExtensions]) {\n                let i = name.lastIndexOf('.');\n                if (i > -1 && extensions.includes(name.slice(i + 1).toLowerCase())) {\n                    name = name.slice(0, i);\n                }\n            }\n            if (lines.length === 0 && points.length === 0) {\n                notify('Трэк пустой. Скачивание невозможно.');\n                return;\n            }\n\n            if (addElevations) {\n                const request = [\n                    ...points.map((p) => p.latlng),\n                    ...lines.reduce((acc, cur) => {\n                        acc.push(...cur);\n                        return acc;\n                    }, [])\n                ];\n                let elevations;\n                try {\n                    elevations = await new ElevationProvider().get(request);\n                } catch (e) {\n                    logging.captureException(e, 'error getting elevation for gpx');\n                    notify(`Failed to get elevation data: ${e.message}`);\n                }\n                let n = 0;\n                for (let p of points) {\n                    // we make copy of latlng as we are changing it\n                    p.latlng = L.latLng(p.latlng.lat, p.latlng.lng, elevations[n]);\n                    n += 1;\n                }\n                for (let line of lines) {\n                    for (let p of line) {\n                        // we do not need to create new LatLng since splitLinesAt180Meridian() have already done it\n                        p.alt = elevations[n];\n                        n += 1;\n                    }\n                }\n            }\n\n            var fileText = exporter(lines, name, points);\n            var filename = name + extension;\n            saveAs(blobFromString(fileText), filename, true);\n        },\n\n        renameTrack: function(track) {\n            var newName = query('Enter new name', track.name());\n            if (newName && newName.length) {\n                track.name(newName);\n            }\n        },\n\n        showTrackMenu: function(track, e) {\n            track._actionsMenu.show(e);\n        },\n\n        showMenu: function(e) {\n            this.menu.show(e);\n        },\n\n        stopEditLine: function() {\n            if (this._editedLine) {\n                this._editedLine.stopEdit();\n            }\n        },\n\n        onTrackSegmentClick: function(e) {\n            if (this.isPlacingPoint) {\n                return;\n            }\n            const trackSegment = e.target;\n            if (this._lineJoinActive) {\n                L.DomEvent.stopPropagation(e);\n                this.joinTrackSegments(trackSegment, isPointCloserToStart(e.target.getLatLngs(), e.latlng));\n            } else {\n                this.startEditTrackSegement(trackSegment);\n                L.DomEvent.stopPropagation(e);\n            }\n        },\n\n        startEditTrackSegement: function(polyline) {\n            if (this._editedLine && this._editedLine !== polyline) {\n                this.stopEditLine();\n            }\n            let group = polyline._parentTrack.group();\n            this.setTab( group, true );\n            polyline.startEdit();\n            this._editedLine = polyline;\n            polyline.once('editend', this.onLineEditEnd, this);\n            polyline.fire('startedit');\n\n            const track_row_element = document.querySelector('table.tracks-rows tr.edit');\n            const track_container = document.querySelector('.tracks-rows-wrapper');\n            this.scrollIfNeeded(track_row_element, track_container);\n        },\n        scrollIfNeeded(element, container) {\n            if (element.offsetTop < container.scrollTop) {\n                container.scrollTop = element.offsetTop;\n            } else {\n                const offsetBottom = element.offsetTop + element.offsetHeight;\n                const scrollBottom = container.scrollTop + container.offsetHeight;\n                if (offsetBottom > scrollBottom) {\n                    container.scrollTop = offsetBottom - container.offsetHeight;\n                }\n            }\n        },\n        onButtonAddPointClicked: function(track) {\n            if (!track.visible()) {\n                return;\n            }\n            if (this.trackAddingPoint() === track) {\n                this.stopPlacingPoint();\n            } else {\n                this.beginPointCreate(track);\n            }\n        },\n\n        _beginPointEdit: function() {\n            this.stopPlacingPoint();\n            this.stopEditLine();\n            L.DomUtil.addClass(this._map._container, 'leaflet-point-placing');\n            this.isPlacingPoint = true;\n            L.DomEvent.on(document, 'keydown', this.stopPlacingPointOnEscPressed, this);\n            this._map.fire('startedit');\n        },\n\n        beginPointMove: function(marker) {\n            this._beginPointEdit();\n            this._movingMarker = marker;\n            this.map.on('click', this.movePoint, this);\n        },\n\n        beginPointCreate: function(track) {\n            this._beginPointEdit();\n            this.map.on('click', this.createNewPoint, this);\n            this.trackAddingPoint(track);\n        },\n\n        movePoint: function(e) {\n            const marker = this._movingMarker;\n            const newLatLng = e.latlng.wrap();\n            this._markerLayer.setMarkerPosition(marker, newLatLng);\n            this.stopPlacingPoint();\n        },\n\n        getNewPointName: function(track) {\n            let maxNumber = 0;\n            for (let marker of track.markers) {\n                const label = marker.label;\n                if (label.match(/^\\d{3}([^\\d.]|$)/u)) {\n                    maxNumber = parseInt(label, 10);\n                }\n            }\n            return maxNumber === 999 ? '' : String(maxNumber + 1).padStart(3, '0');\n        },\n\n        createNewPoint: function(e) {\n            if (!this.isPlacingPoint) {\n                return;\n            }\n            const parentTrack = this.trackAddingPoint();\n            const name = e.suggested && this._map.suggestedPoint?.title || this.getNewPointName(parentTrack);\n            const newLatLng = e.latlng.wrap();\n            const marker = this.addPoint(parentTrack, {name: name, lat: newLatLng.lat, lng: newLatLng.lng});\n            this._markerLayer.addMarker(marker);\n            // we need to show prompt after marker is dispalyed;\n            // grid layer is updated in setTimout(..., 0)after adding marker\n            // it is better to do it on 'load' event but when it is fired marker is not yet displayed\n            setTimeout(() => {\n                this.renamePoint(marker);\n                this.beginPointCreate(parentTrack);\n            }, 10);\n        },\n\n        stopPlacingPointOnEscPressed: function(e) {\n            if (e.keyCode === 27) {\n                this.stopPlacingPoint();\n            }\n        },\n\n        stopPlacingPoint: function() {\n            this.isPlacingPoint = false;\n            this.trackAddingPoint(null);\n            L.DomUtil.removeClass(this._map._container, 'leaflet-point-placing');\n            L.DomEvent.off(document, 'keydown', this.stopPlacingPointOnEscPressed, this);\n            this.map.off('click', this.createNewPoint, this);\n            this.map.off('click', this.movePoint, this);\n        },\n\n        joinTrackSegments: function(newSegment, joinToStart) {\n            this.hideLineCursor();\n            var originalSegment = this._editedLine;\n            var latlngs = originalSegment.getLatLngs(),\n                latngs2 = newSegment.getLatLngs();\n            if (joinToStart === this._lineJoinFromStart) {\n                latngs2.reverse();\n            }\n            if (this._lineJoinFromStart) {\n                latlngs.unshift(...latngs2);\n            } else {\n                latlngs.push(...latngs2);\n            }\n            latlngs = latlngs.map(function(ll) {\n                    return [ll.lat, ll.lng];\n                }\n            );\n            this.deleteTrackSegment(originalSegment);\n            if (originalSegment._parentTrack === newSegment._parentTrack) {\n                this.deleteTrackSegment(newSegment);\n            }\n            this.addTrackSegment(originalSegment._parentTrack, latlngs);\n        },\n\n        onLineEditEnd: function(e) {\n            const polyline = e.target;\n            const track = polyline._parentTrack;\n            if (polyline.getLatLngs().length < 2) {\n                this.deleteTrackSegment(polyline);\n            }\n            if (this._editedLine === polyline) {\n                this._editedLine = null;\n            }\n            if (!this.getTrackPolylines(track).length && !this.getTrackPoints(track).length && e.userCancelled) {\n                this.removeTrack(track);\n            }\n        },\n\n        addTrackSegment: function(track, sourcePoints) {\n            var polyline = new TrackSegment(sourcePoints || [], {\n                    color: this.colors[track.color()],\n                    print: true\n                }\n            );\n            polyline._parentTrack = track;\n            polyline.setMeasureTicksVisible(track.measureTicksShown());\n            polyline.on('click', this.onTrackSegmentClick, this);\n            polyline.on('nodeschanged', this.onTrackSegmentNodesChanged.bind(this, track, polyline));\n            polyline.on('noderightclick', this.onNodeRightClickShowMenu, this);\n            polyline.on('segmentrightclick', this.onSegmentRightClickShowMenu, this);\n            polyline.on('mouseover', () => this.onTrackMouseEnter(track));\n            polyline.on('mouseout', () => this.onTrackMouseLeave(track));\n            polyline.on('editstart', () => this.onTrackEditStart(track));\n            polyline.on('editend', () => this.onTrackEditEnd(track));\n            polyline.on('drawend', this.onTrackSegmentDrawEnd, this);\n\n            // polyline.on('editingstart', polyline.setMeasureTicksVisible.bind(polyline, false));\n            // polyline.on('editingend', this.setTrackMeasureTicksVisibility.bind(this, track));\n            track.feature.addLayer(polyline);\n            this.recalculateTrackLength(track);\n            return polyline;\n        },\n\n        onNodeRightClickShowMenu: function(e) {\n            var items = [];\n            if (e.nodeIndex > 0 && e.nodeIndex < e.line.getLatLngs().length - 1) {\n                items.push({\n                        text: 'Разрезать',\n                        callback: this.splitTrackSegment.bind(this, e.line, e.nodeIndex, null)\n                    }\n                );\n            }\n            if (e.nodeIndex === 0 || e.nodeIndex === e.line.getLatLngs().length - 1) {\n                items.push({text: 'Соединить', callback: this.startLineJoinSelection.bind(this, e)});\n            }\n            items.push({text: 'Реверсировать', callback: this.reverseTrackSegment.bind(this, e.line)});\n            items.push({text: 'Укоротить', callback: this.startShortCutSelection.bind(this, e, true)});\n            items.push({text: 'Удалить сегмент', callback: this.deleteTrackSegment.bind(this, e.line)});\n            items.push({text: 'Новый трэк из сегмента', callback: this.newTrackFromSegment.bind(this, e.line)});\n            items.push('-');\n            items.push({\n                    text: 'Профиль высоты сегмента',\n                    callback: this.showElevationProfileForSegment.bind(this, e.line)\n                }\n            );\n\n            var menu = new Contextmenu(items);\n            menu.show(e.mouseEvent);\n        },\n\n        onSegmentRightClickShowMenu: function(e) {\n            var menu = new Contextmenu([\n                    {\n                        text: 'Разрезать',\n                        callback: this.splitTrackSegment.bind(this, e.line, e.nodeIndex, e.mouseEvent.latlng)\n                    },\n                    {text: 'Реверсировать', callback: this.reverseTrackSegment.bind(this, e.line)},\n                    {text: 'Укоротить', callback: this.startShortCutSelection.bind(this, e, false)},\n                    {text: 'Удалить сегмент', callback: this.deleteTrackSegment.bind(this, e.line)},\n                    {text: 'Новый трэк из сегмента', callback: this.newTrackFromSegment.bind(this, e.line)},\n                    '-',\n                    {\n                        text: 'Профиль высоты сегмента',\n                        callback: this.showElevationProfileForSegment.bind(this, e.line)\n                    }\n                ]\n            );\n            menu.show(e.mouseEvent);\n        },\n\n        showLineCursor: function(start, mousepos) {\n            this.hideLineCursor();\n            this._editedLine.stopDrawingLine();\n            this._lineCursor = L.polyline([start.clone(), mousepos], {\n                ...this.options.lineCursorStyle,\n                ...this.options.lineCursorInvalidStyle,\n            }).addTo(this._map);\n            this.map.on('mousemove', this.onMouseMoveOnMapForLineCursor, this);\n            this.map.on('click', this.hideLineCursor, this);\n            L.DomEvent.on(document, 'keyup', this.onKeyUpForLineCursor, this);\n            L.DomUtil.addClass(this.map.getContainer(), 'tracklist-line-cursor-shown');\n            this._editedLine.preventStopEdit = true;\n        },\n\n        hideLineCursor: function() {\n            if (this._lineCursor) {\n                this.map.off('mousemove', this.onMouseMoveOnMapForLineCursor, this);\n                this.map.off('click', this.hideLineCursor, this);\n                L.DomUtil.removeClass(this.map.getContainer(), 'tracklist-line-cursor-shown');\n                L.DomEvent.off(document, 'keyup', this.onKeyUpForLineCursor, this);\n                this.map.removeLayer(this._lineCursor);\n                this._lineCursor = null;\n                this._map.fire('linecursorhide');\n                this._editedLine.preventStopEdit = false;\n            }\n        },\n\n        onMouseMoveOnMapForLineCursor: function(e) {\n            this.updateLineCursor(e.latlng, false);\n        },\n\n        updateLineCursor: function(latlng, isValid) {\n            if (!this._lineCursor) {\n                return;\n            }\n            this._lineCursor.getLatLngs().splice(1, 1, latlng);\n            this._lineCursor.redraw();\n            this._lineCursor.setStyle(\n                isValid ? this.options.lineCursorValidStyle : this.options.lineCursorInvalidStyle\n            );\n        },\n\n        onKeyUpForLineCursor: function(e) {\n            if (e.target.tagName.toLowerCase() === 'input') {\n                return;\n            }\n            switch (e.keyCode) {\n                case 27:\n                case 13:\n                    this.hideLineCursor();\n                    L.DomEvent.stop(e);\n                    break;\n                default:\n            }\n        },\n\n        startLineJoinSelection: function(e) {\n            this._lineJoinFromStart = (e.nodeIndex === 0);\n            const cursorStart = this._editedLine.getLatLngs()[e.nodeIndex];\n            this.showLineCursor(cursorStart, e.mouseEvent.latlng);\n            this._map.on('linecursorhide', this.onLineCursorHideForJoin, this);\n            for (let track of this.tracks()) {\n                track.feature.on('mousemove', this.onMouseMoveOnLineForJoin, this);\n            }\n            this._lineJoinActive = true;\n            this._editedLine.disableEditOnLeftClick(true);\n        },\n\n        onMouseMoveOnLineForJoin: function(e) {\n            const latlngs = e.layer.getLatLngs();\n            const lineJoinToStart = isPointCloserToStart(latlngs, e.latlng);\n            const cursorEnd = lineJoinToStart ? latlngs[0] : latlngs[latlngs.length - 1];\n            L.DomEvent.stopPropagation(e);\n            this.updateLineCursor(cursorEnd, true);\n        },\n\n        onLineCursorHideForJoin: function() {\n            for (let track of this.tracks()) {\n                track.feature.off('mousemove', this.onMouseMoveOnLineForJoin, this);\n            }\n            this._map.off('linecursorhide', this.onLineCursorHideForJoin, this);\n            this._editedLine.disableEditOnLeftClick(false);\n            this._lineJoinActive = false;\n        },\n\n        startShortCutSelection: function(e, startFromNode) {\n            const line = this._editedLine;\n            this._shortCut = {startNodeIndex: e.nodeIndex, startFromNode};\n            let cursorStart;\n            if (startFromNode) {\n                cursorStart = line.getLatLngs()[e.nodeIndex];\n            } else {\n                cursorStart = closestPointToLineSegment(line.getLatLngs(), e.nodeIndex, e.mouseEvent.latlng);\n                this._shortCut.startLatLng = cursorStart;\n            }\n            this.showLineCursor(cursorStart, e.mouseEvent.latlng);\n            line.nodeMarkers.on('mousemove', this.onMouseMoveOnNodeMarkerForShortCut, this);\n            line.segmentOverlays.on('mousemove', this.onMouseMoveOnLineSegmentForShortCut, this);\n            this.map.on('mousemove', this.onMouseMoveOnMapForShortCut, this);\n            line.nodeMarkers.on('click', this.onClickNodeMarkerForShortCut, this);\n            line.segmentOverlays.on('click', this.onClickLineSegmentForShortCut, this);\n            this._map.on('linecursorhide', this.onLineCursorHideForShortCut, this);\n            line.disableEditOnLeftClick(true);\n        },\n\n        onMouseMoveOnLineSegmentForShortCut: function(e) {\n            this.updateShortCutSelection(e, false);\n        },\n\n        onMouseMoveOnNodeMarkerForShortCut: function(e) {\n            this.updateShortCutSelection(e, true);\n        },\n\n        onMouseMoveOnMapForShortCut: function() {\n            this._editedLine.highlighNodesForDeletion();\n        },\n\n        updateShortCutSelection: function(e, endAtNode) {\n            L.DomEvent.stopPropagation(e);\n            const line = this._editedLine;\n            const {firstNodeToDelete, lastNodeToDelete, rangeValid} = this.getShortCutNodes(e, endAtNode);\n            this.updateLineCursor(e.latlng, rangeValid);\n            if (rangeValid) {\n                line.highlighNodesForDeletion(firstNodeToDelete, lastNodeToDelete);\n            } else {\n                line.highlighNodesForDeletion();\n            }\n        },\n\n        onLineCursorHideForShortCut: function() {\n            const line = this._editedLine;\n            line.highlighNodesForDeletion();\n            line.nodeMarkers.off('mousemove', this.onMouseMoveOnNodeMarkerForShortCut, this);\n            line.segmentOverlays.off('mousemove', this.onMouseMoveOnLineSegmentForShortCut, this);\n            this.map.off('mousemove', this.onMouseMoveOnMapForShortCut, this);\n            line.nodeMarkers.off('click', this.onClickNodeMarkerForShortCut, this);\n            line.segmentOverlays.off('click', this.onClickLineSegmentForShortCut, this);\n            this._map.off('linecursorhide', this.onLineCursorHideForShortCut, this);\n            line.disableEditOnLeftClick(false);\n            this._shortCut = null;\n        },\n\n        onClickLineSegmentForShortCut: function(e) {\n            this.shortCutSegment(e, false);\n        },\n\n        onClickNodeMarkerForShortCut: function(e) {\n            this.shortCutSegment(e, true);\n        },\n\n        getShortCutNodes: function(e, endAtNode) {\n            const line = this._editedLine;\n            let startFromNode = this._shortCut.startFromNode;\n            let startNodeIndex = this._shortCut.startNodeIndex;\n            let endNodeIndex = line[endAtNode ? 'getMarkerIndex' : 'getSegmentOverlayIndex'](e.layer);\n            const newNodes = [];\n            if (!startFromNode) {\n                newNodes.push(this._shortCut.startLatLng);\n            }\n            if (!endAtNode) {\n                newNodes.push(closestPointToLineSegment(line.getLatLngs(), endNodeIndex, e.latlng));\n            }\n            let firstNodeToDelete, lastNodeToDelete;\n            if (endNodeIndex > startNodeIndex) {\n                firstNodeToDelete = startNodeIndex + 1;\n                lastNodeToDelete = endNodeIndex - 1;\n                if (!endAtNode) {\n                    lastNodeToDelete += 1;\n                }\n            } else {\n                newNodes.reverse();\n                firstNodeToDelete = endNodeIndex + 1;\n                lastNodeToDelete = startNodeIndex - 1;\n                if (!startFromNode) {\n                    lastNodeToDelete += 1;\n                }\n            }\n            return {firstNodeToDelete, lastNodeToDelete, newNodes, rangeValid: lastNodeToDelete >= firstNodeToDelete};\n        },\n\n        shortCutSegment: function(e, endAtNode) {\n            L.DomEvent.stopPropagation(e);\n            const line = this._editedLine;\n            const {firstNodeToDelete, lastNodeToDelete, newNodes, rangeValid} = this.getShortCutNodes(e, endAtNode);\n            if (!rangeValid) {\n                return;\n            }\n            this.stopEditLine();\n            line.spliceLatLngs(firstNodeToDelete, lastNodeToDelete - firstNodeToDelete + 1, ...newNodes);\n            this.startEditTrackSegement(line);\n        },\n\n        onTrackMouseEnter: function(track) {\n            track.hover(true);\n        },\n\n        onTrackMouseLeave: function(track) {\n            track.hover(false);\n        },\n\n        onTrackEditStart: function(track) {\n            track.isEdited(true);\n        },\n\n        onTrackEditEnd: function(track) {\n            track.isEdited(false);\n            this.hideLineCursor();\n            this._editedLine = null;\n        },\n\n        onTrackRowMouseEnter: function(track) {\n            this._highlightedTrack = track;\n            this.updateTrackHighlight();\n        },\n\n        onTrackRowMouseLeave: function(track) {\n            if (this._highlightedTrack === track) {\n                this._highlightedTrack = null;\n                this.updateTrackHighlight();\n            }\n        },\n\n        onTrackSegmentDrawEnd: function() {\n            this.trackAddingSegment(null);\n        },\n\n        splitTrackSegment: function(trackSegment, nodeIndex, latlng) {\n            var latlngs = trackSegment.getLatLngs();\n            latlngs = latlngs.map((latlng) => latlng.clone());\n            var latlngs1 = latlngs.slice(0, nodeIndex + 1),\n                latlngs2 = latlngs.slice(nodeIndex + 1);\n            if (latlng) {\n                latlng = closestPointToLineSegment(latlngs, nodeIndex, latlng);\n                latlngs1.push(latlng.clone());\n            } else {\n                latlng = latlngs[nodeIndex];\n            }\n            latlngs2.unshift(latlng.clone());\n            this.deleteTrackSegment(trackSegment);\n            var segment1 = this.addTrackSegment(trackSegment._parentTrack, latlngs1);\n            this.addTrackSegment(trackSegment._parentTrack, latlngs2);\n            this.startEditTrackSegement(segment1);\n        },\n\n        deleteTrackSegment: function(trackSegment) {\n            const track = trackSegment._parentTrack;\n            track.feature.removeLayer(trackSegment);\n            this.recalculateTrackLength(track);\n        },\n\n        newTrackFromSegment: function(trackSegment) {\n            var srcNodes = trackSegment.getLatLngs(),\n                newNodes = [],\n                i;\n            for (i = 0; i < srcNodes.length; i++) {\n                newNodes.push([srcNodes[i].lat, srcNodes[i].lng]);\n            }\n            this.addTrack({name: \"Новый трэк\", tracks: [newNodes]});\n        },\n\n        addTrack: function(geodata) {\n            var color;\n            color = geodata.color;\n            if (!(color >= 0 && color < this.colors.length)) {\n                color = this._lastTrackColor;\n                this._lastTrackColor = (this._lastTrackColor + 1) % this.colors.length;\n            }\n            var track = {\n                name: ko.observable(geodata.name),\n                color: ko.observable(color),\n                visible: ko.observable(!geodata.trackHidden),\n                length: ko.observable(0),\n                measureTicksShown: ko.observable(geodata.measureTicksShown || false),\n                feature: L.featureGroup([]),\n                markers: [],\n                group: ko.observable( geodata.group || 'default' ),\n                hover: ko.observable(false),\n                isEdited: ko.observable(false)\n            };\n            (geodata.tracks || []).forEach(this.addTrackSegment.bind(this, track));\n            (geodata.points || []).forEach(this.addPoint.bind(this, track));\n\n            this.tracks.push(track);\n\n            track.visible.subscribe(this.onTrackVisibilityChanged.bind(this, track));\n            track.measureTicksShown.subscribe(this.setTrackMeasureTicksVisibility.bind(this, track));\n            track.color.subscribe(this.onTrackColorChanged.bind(this, track));\n            if (!L.Browser.touch) {\n                track.feature.bindTooltip(() => track.name(), {sticky: true, delay: 500});\n            }\n\n            // this.onTrackColorChanged(track);\n            this.onTrackVisibilityChanged(track);\n            this.attachColorSelector(track);\n            this.attachActionsMenu(track);\n            return track;\n        },\n\n        updateTrackHighlight: function() {\n            if (L.Browser.touch) {\n                return;\n            }\n            if (this._trackHighlight) {\n                this._trackHighlight.removeFrom(this._map);\n                this._trackHighlight = null;\n            }\n            if (this._highlightedTrack && this._highlightedTrack.visible()) {\n                const trackHighlight = L.featureGroup([]);\n\n                this._highlightedTrack.feature.eachLayer((line) => {\n                    let latlngs = line.getFixedLatLngs();\n                    L.polyline(latlngs).addTo(trackHighlight);\n                });\n\n                trackHighlight.setStyle({\n                    color: 'yellow',\n                    weight: '15',\n                    opacity: 0.5\n                });\n                trackHighlight.addTo(this._map).bringToBack();\n                this._trackHighlight = trackHighlight;\n            }\n        },\n\n        setMarkerIcon: function(marker) {\n            var symbol = 'marker',\n                colorInd = marker._parentTrack.color() + 1,\n                className = 'symbol-' + symbol + '-' + colorInd;\n            marker.icon = iconFromBackgroundImage('track-waypoint ' + className);\n        },\n\n        setMarkerLabel: function(marker, label) {\n            marker.label = label;\n        },\n\n        addPoint: function(track, srcPoint) {\n            var marker = {\n                latlng: L.latLng([srcPoint.lat, srcPoint.lng]),\n                _parentTrack: track,\n            };\n            this.setMarkerIcon(marker);\n            this.setMarkerLabel(marker, srcPoint.name);\n            track.markers.push(marker);\n            marker._parentTrack = track;\n            return marker;\n        },\n\n        onMarkerClick: function(e) {\n            new Contextmenu([\n                    {text: e.marker.label, header: true},\n                    '-',\n                    {text: 'Переименовать', callback: this.renamePoint.bind(this, e.marker)},\n                    {text: 'Переместить', callback: this.beginPointMove.bind(this, e.marker)},\n                    {text: 'Удалить', callback: this.removePoint.bind(this, e.marker)},\n                ]\n            ).show(e);\n        },\n\n        onMarkerEnter: function(e) {\n            e.marker._parentTrack.hover(true);\n        },\n\n        onMarkerLeave: function(e) {\n            e.marker._parentTrack.hover(false);\n        },\n\n        removePoint: function(marker) {\n            this.stopPlacingPoint();\n            this._markerLayer.removeMarker(marker);\n            const markers = marker._parentTrack.markers;\n            const i = markers.indexOf(marker);\n            markers.splice(i, 1);\n        },\n\n        renamePoint: function(marker) {\n            this.stopPlacingPoint();\n            var newLabel = query('Название новой точки', marker.label);\n            if (newLabel !== null) {\n                this.setMarkerLabel(marker, newLabel);\n                this._markerLayer.updateMarker(marker);\n            }\n        },\n\n        removeTrack: function(track) {\n            track.visible(false);\n            this.tracks.remove(track);\n        },\n\n        deleteAllTracks: function() {\n            var tracks = this.tracks().slice(0),\n                i;\n            for (i = 0; i < tracks.length; i++) {\n                this.removeTrack(tracks[i]);\n            }\n        },\n\n        deleteHiddenTracks: function() {\n            var tracks = this.tracks().slice(0),\n                i, track;\n            for (i = 0; i < tracks.length; i++) {\n                track = tracks[i];\n                if (!track.visible()) {\n                    this.removeTrack(tracks[i]);\n                }\n            }\n        },\n\n        trackToString: function(track, forceVisible) {\n            var lines = this.getTrackPolylines(track).map(function(line) {\n                    var points = line.getFixedLatLngs();\n                    points = L.LineUtil.simplifyLatlngs(points, 360 / (1 << 24));\n                    return points;\n                }\n            );\n            return geoExporters.saveToString(lines, track.name(), track.color(), track.measureTicksShown(),\n                this.getTrackPoints(track), forceVisible ? false : !track.visible()\n            );\n        },\n\n        copyAllTracksToClipboard: function(mouseEvent) {\n            this.copyTracksLinkToClipboard(this.tracks(), mouseEvent);\n        },\n\n        copyVisibleTracks: function(mouseEvent) {\n            const tracks = this.tracks().filter((track) => track.visible());\n            this.copyTracksLinkToClipboard(tracks, mouseEvent);\n        },\n        downloadVisibleTracks: function(mouseEvent) {\n            const tracks = this.tracks().filter((track) => track.visible());\n            let zip = new JSZip();\n            let self = this;\n            let file_names = [];\n            tracks.forEach(function(track, i, arr){\n                let lines = self.getTrackPolylines(track)\n                    .map(function(line) {\n                            return line.getFixedLatLngs();\n                        }\n                    );\n                lines = splitLinesAt180Meridian(lines);\n                let points = self.getTrackPoints(track);\n                let name = track.name();\n                // Browser (Chrome) removes leading dots.\n                name = name.replace(/^\\./u, '_');\n                for (let extensions of [self.options.splitExtensionsFirstStage, self.options.splitExtensions]) {\n                    let i = name.lastIndexOf('.');\n                    if (i > -1 && extensions.includes(name.slice(i + 1).toLowerCase())) {\n                        name = name.slice(0, i);\n                    }\n                }\n                if (lines.length === 0 && points.length === 0) {\n                    return;\n                }\n                let fileText = geoExporters.saveGpx(lines, name, points);\n\n                if ( file_names.includes( name ) ) {\n                    name = name + i;\n                }\n                file_names.push(name);\n                let filename = name + '.gpx';\n                zip.file(filename, blobFromString(fileText));\n            });\n            zip.generateAsync({type:\"blob\"}).then(function (blob) {\n                saveAs(blob, \"tracks.zip\", true);\n            });\n        },\n\n        exportTracks: function(minTicksIntervalMeters) {\n            var that = this;\n            /* eslint-disable max-nested-callbacks */\n            return this.tracks()\n                .filter(function(track) {\n                        return that.getTrackPolylines(track).length;\n                    }\n                )\n                .map(function(track) {\n                        var capturedTrack = track.feature.getLayers().map(function(pl) {\n                                return pl.getLatLngs().map(function(ll) {\n                                        return [ll.lat, ll.lng];\n                                    }\n                                );\n                            }\n                        );\n                        var bounds = track.feature.getBounds();\n                        var capturedBounds = [\n                            [bounds.getSouth(), bounds.getWest()],\n                            [bounds.getNorth(), bounds.getEast()]\n                        ];\n                        return {\n                            color: track.color(),\n                            visible: track.visible(),\n                            segments: capturedTrack,\n                            bounds: capturedBounds,\n                            measureTicksShown: track.measureTicksShown(),\n                            measureTicks: [].concat(...track.feature.getLayers().map(function(pl) {\n                                    return pl.getTicksPositions(minTicksIntervalMeters);\n                                }\n                                )\n                            )\n                        };\n                    }\n                );\n            /* eslint-enable max-nested-callbacks */\n        },\n\n        showElevationProfileForSegment: function(line) {\n            this.hideElevationProfile();\n            this.stopEditLine();\n            this._elevationControl = new ElevationProfile(this._map, line.getLatLngs(), {\n                    samplingInterval: calcSamplingInterval(line.getLength())\n                }\n            );\n            this._map.fire('elevation-shown');\n        },\n\n        showElevationProfileForTrack: function(track) {\n            var lines = this.getTrackPolylines(track),\n                path = [],\n                i;\n            for (i = 0; i < lines.length; i++) {\n                if (lines[i] === this._editedLine) {\n                    this.stopEditLine();\n                }\n                path = path.concat(lines[i].getLatLngs());\n            }\n            this.hideElevationProfile();\n            this._elevationControl = new ElevationProfile(this._map, path, {\n                    samplingInterval: calcSamplingInterval(new L.MeasuredLine(path).getLength())\n                }\n            );\n            this._map.fire('elevation-shown');\n        },\n\n        hideElevationProfile: function() {\n            if (this._elevationControl) {\n                this._elevationControl.removeFrom(this._map);\n            }\n            this._elevationControl = null;\n        },\n\n        hasTracks: function() {\n            return this.tracks().length > 0;\n        }\n    }\n);\n\nexport {TRACKLIST_TRACK_COLORS};\n","function arrayItemsEqual(l1, l2) {\n    if (l1.length !== l2.length) {\n        return false;\n    }\n    for (var i = 0; i < l1.length; i++) {\n        if (l1[i] !== l2[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n\nfunction parseHashParams(s) {\n    const args = {},\n        i = s.indexOf('#');\n    if (i >= 0) {\n        s = s.substr(i + 1).trim();\n        let m, key, value;\n        for (let pair of s.split('&')) {\n            m = /^([^=]+?)(?:=(.*))?$/u.exec(pair);\n            if (m) {\n                [, key, value] = m;\n                if (value) {\n                    value = value.split('/');\n                } else {\n                    value = [];\n                }\n                args[key] = value;\n            }\n        }\n    }\n    return args;\n}\n\nconst hashState = {\n    _listeners: [],\n    _state: {},\n\n    addEventListener: function(key, callback) {\n        for (let [k, c] of this._listeners) {\n            if (k === key && c === callback) {\n                return;\n            }\n        }\n        this._listeners.push([key, callback]);\n    },\n\n    updateState: function(key, values) {\n        if (values) {\n            this._state[key] = values;\n        } else {\n            delete this._state[key];\n        }\n        this._saveStateToHash();\n    },\n\n    getState: function(key) {\n        return this._state[key];\n    },\n\n    hasKey: function(key) {\n        return this._state.hasOwnProperty(key);\n    },\n\n    _saveStateToHash: function() {\n        var stateItems = [];\n        for (let key of Object.keys(this._state)) {\n            if (this._state[key]) {\n                if (this._state[key].length) {\n                    var values = this._state[key].join('/');\n                    stateItems.push(key + '=' + values);\n                } else {\n                    stateItems.push(key);\n                }\n            }\n        }\n        const hash = stateItems.join('&');\n        const href = `${location.origin}${location.pathname}${location.search}#${hash}`;\n        this._ignoreChanges = true;\n        location.replace(href);\n        this._ignoreChanges = false;\n    },\n\n    onHashChanged: function() {\n        if (this._ignoreChanges) {\n            return;\n        }\n        const newState = parseHashParams(location.hash);\n        const changedKeys = {};\n        for (let key of Object.keys(newState)) {\n            if (!(key in this._state) || !arrayItemsEqual(newState[key], this._state[key])) {\n                changedKeys[key] = 1;\n            }\n        }\n\n        for (let key of Object.keys(this._state)) {\n            if (!(key in newState)) {\n                changedKeys[key] = 1;\n            }\n        }\n\n        for (let [key, callback] of this._listeners) {\n            if (key in changedKeys) {\n                callback(newState[key]);\n            }\n        }\n        this._state = newState;\n    }\n};\n\nfunction bindHashStateReadOnly(key, target) {\n    function onChange() {\n        target(hashState.getState(key));\n        hashState.updateState(key, null);\n    }\n    hashState.addEventListener(key, onChange);\n    onChange();\n}\n\nwindow.addEventListener('hashchange', hashState.onHashChanged.bind(hashState));\nhashState.onHashChanged();\n\nexport {hashState, bindHashStateReadOnly, parseHashParams};\n\n","class PrintStaticLayer {\n    _layerDummy = true;\n    _printProgressWeight = 0.01;\n\n    cloneForPrint() {\n        return this;\n    }\n\n    // printOptions = {\n    //     xhrOptions,\n    //     pixelBounds,\n    //     latLngBounds,\n    //     destPixelSize,\n    //     resolution,\n    //     scale,\n    //     zoom\n    // }\n    async getTilesInfo(printOptions) {\n        return {\n            iterateTilePromises: (function*() {\n                yield {\n                    tilePromise: Promise.resolve({\n                            draw: (canvas) => this._drawRaster(canvas, printOptions),\n                            isOverlay: true,\n                            overlaySolid: this.overlaySolid\n                        }\n                    ),\n                    abortLoading: () => {\n                        // no actions needed\n                    }\n                };\n            }).bind(this),\n            count: 1\n        };\n    }\n\n    _drawRaster(_unused_canvas, _unused_printOptions) {\n        throw new Error(\"Method not implemented\");\n    }\n}\n\nexport {PrintStaticLayer};\n","import './style.css';\nimport * as logging from '~/lib/logging';\nimport {query} from '~/lib/notifications';\n\nfunction showNotification(message, mouseEvent) {\n    var el = document.createElement('div');\n    el.innerHTML = message;\n    el.className = 'copy-clipboard-notification';\n    document.body.appendChild(el);\n    var w = el.offsetWidth,\n        h = el.offsetHeight,\n        x = mouseEvent.clientX - w - 8,\n        y = mouseEvent.clientY - h / 2;\n    if (x < 0) {\n        x = 0;\n    }\n    if (y < 0) {\n        y = 0;\n    }\n    el.style.top = y + 'px';\n    el.style.left = x + 'px';\n    setTimeout(function() {\n        document.body.removeChild(el);\n    }, 1000);\n}\n\nfunction copyToClipboard(s, mouseEvent) {\n    let success = false;\n    let ta;\n    try {\n        ta = document.createElement('textarea');\n        ta.value = s;\n        document.body.appendChild(ta);\n        ta.select();\n        success = document.execCommand('copy');\n        if (success) {\n            showNotification('Скопировано', mouseEvent);\n        }\n    } catch (e) {\n        logging.captureException(e, 'clipborad to copy failed');\n    } finally {\n        document.body.removeChild(ta);\n    }\n    if (!success) {\n        query(\"Copy to clipboard: Ctrl+C, Enter\", s);\n    }\n}\n\nexport default copyToClipboard;\n","import {Cache} from '~/lib/cache';\nimport {XHRQueue} from '~/lib/xhr-promise';\n\nclass TiledDataLoader {\n    constructor(cacheSize = 50) {\n        this._cache = new Cache(cacheSize);\n        this._pendingRequests = {};\n        this._xhrQueue = new XHRQueue();\n    }\n\n    makeTileKey(coords) {\n        return `${coords.x}:${coords.y}:${coords.z}`;\n    }\n\n    getFromCache(dataTileCoords) {\n        const key = this.makeTileKey(dataTileCoords);\n        const res = this._cache.get(key);\n        res['coords'] = dataTileCoords;\n        return res;\n    }\n\n    layerTileToDataTileCoords(layerTileCoords) {\n        return {...layerTileCoords};\n    }\n\n    makeRequestData(_unused_dataTileCoords) {\n        throw new Error('Not implemented');\n        // return {\n        //     url,\n        //     options\n        // }\n    }\n\n    processResponse(_unused_xhr, _unused_originalDataTileCoords) {\n        throw new Error('Not implemented');\n        // return {\n        //     tileData,\n        //     coords\n        // }\n    }\n\n    calcAdjustment(layerTileCoords, dataTileCoords) {\n        if (layerTileCoords.x === dataTileCoords.x &&\n            layerTileCoords.y === dataTileCoords.y &&\n            layerTileCoords.z === dataTileCoords.z) {\n            return null;\n        }\n        if (dataTileCoords.z > layerTileCoords.z) {\n            const multiplier = 1 << (dataTileCoords.z - layerTileCoords.z);\n            return {multiplier: 1 / multiplier, offsetX: 0, offsetY: 0};\n        }\n        const multiplier = 1 << (layerTileCoords.z - dataTileCoords.z);\n        return {\n            multiplier,\n            offsetX: (layerTileCoords.x - dataTileCoords.x * multiplier),\n            offsetY: (layerTileCoords.y - dataTileCoords.y * multiplier)\n        };\n    }\n\n    requestTileData(layerTileCoords) {\n        const dataTileCoords = this.layerTileToDataTileCoords(layerTileCoords);\n        let res = this.getFromCache(dataTileCoords);\n        if (res.found) {\n            return {\n                dataPromise: Promise.resolve({\n                        coords: res.coords,\n                        tileData: res.value,\n                        adjustment: this.calcAdjustment(layerTileCoords, res.coords)\n                    }\n                ),\n                abortLoading: () => {\n                    // no need to abort Promise which is resolved immediately\n                }\n            };\n        }\n\n        const dataTileKey = this.makeTileKey(dataTileCoords);\n        if (!(dataTileKey in this._pendingRequests)) {\n            const {url, options} = this.makeRequestData(dataTileCoords);\n            const fetchPromise = this._xhrQueue.put(url, options);\n            const dataPromise = (async() => {\n                let xhr;\n                try {\n                    xhr = await fetchPromise;\n                } catch (e) {\n                    return {error: e};\n                } finally {\n                    delete this._pendingRequests[dataTileKey];\n                }\n                const {tileData, coords} = await this.processResponse(xhr, dataTileCoords);\n                this._cache.put(this.makeTileKey(coords), tileData);\n                return {tileData, coords};\n            })();\n            const pendingRequest = this._pendingRequests[dataTileKey] = {\n                dataPromise,\n                refCount: 0\n            };\n            pendingRequest.abortLoading = () => {\n                pendingRequest.refCount -= 1;\n                if (pendingRequest.refCount < 1) {\n                    fetchPromise.abort();\n                    delete this._pendingRequests[dataTileKey];\n                }\n            };\n        }\n\n        let pendingRequest = this._pendingRequests[dataTileKey];\n        pendingRequest.refCount += 1;\n\n        return {\n            dataPromise: pendingRequest.dataPromise.then((data) => {\n                    if (data.error) {\n                        return data;\n                    }\n                    return {\n                        coords: data.coords,\n                        tileData: data.tileData,\n                        adjustment: this.calcAdjustment(layerTileCoords, data.coords)\n                    };\n            }),\n            abortLoading: () => pendingRequest.abortLoading()\n        };\n    }\n}\n\nexport {TiledDataLoader};\n","import parsers from './parsers';\n\nfunction parseGeoFile(name, data) {\n    for (var i = 0; i < parsers.length; i++) {\n        var parsed = parsers[i](data, name);\n        if (parsed !== null) {\n            return parsed;\n        }\n    }\n    return [{name: name, error: 'UNSUPPORTED'}];\n}\n\nexport default parseGeoFile;\n","export default function stripBom(s) {\n    if (s.substr(0, 3) === '\\xef\\xbb\\xbf') {\n        s = s.substr(3);\n    }\n    return s;\n}\n","import services from './services';\n\nasync function loadFromUrl(url) {\n    for (let ServiceClass of services) {\n        let service = new ServiceClass(url);\n        if (service.isOurUrl()) {\n            return service.geoData();\n        }\n    }\n    return [{name: url, error: 'INVALID_URL'}];\n}\n\nexport default loadFromUrl;\n","import Pbf from 'pbf';\nimport {TrackView} from './nktk_pb';\nimport {arrayBufferToString, stringToArrayBuffer} from '~/lib/binary-strings';\nimport utf8 from 'utf8';\nimport * as urlSafeBase64 from './urlSafeBase64';\n\nconst arcUnit = ((1 << 24) - 1) / 360;\n\nfunction PackedStreamReader(s) {\n    this._string = s;\n    this.position = 0;\n}\n\nfunction unpackNumber(s, position) {\n    var x,\n        n = 0;\n    x = s.charCodeAt(position);\n    if (isNaN(x)) {\n        throw new Error('Unexpected end of line while unpacking number');\n    }\n    if (x < 128) {\n        n = x - 64;\n        return [n, 1];\n    }\n    n = x & 0x7f;\n    x = s.charCodeAt(position + 1);\n    if (isNaN(x)) {\n        throw new Error('Unexpected end of line while unpacking number');\n    }\n    if (x < 128) {\n        n |= x << 7;\n        n -= 8192;\n        return [n, 2];\n    }\n    n |= (x & 0x7f) << 7;\n    x = s.charCodeAt(position + 2);\n    if (isNaN(x)) {\n        throw new Error('Unexpected end of line while unpacking number');\n    }\n    if (x < 128) {\n        n |= x << 14;\n        n -= 1048576;\n        return [n, 3];\n    }\n    n |= (x & 0x7f) << 14;\n    x = s.charCodeAt(position + 3);\n    if (isNaN(x)) {\n        throw new Error('Unexpected end of line while unpacking number');\n    }\n    n |= x << 21;\n    n -= 268435456;\n    return [n, 4];\n}\n\nPackedStreamReader.prototype.readNumber = function() {\n    var n = unpackNumber(this._string, this.position);\n    this.position += n[1];\n    return n[0];\n};\n\nPackedStreamReader.prototype.readString = function(size) {\n    var s = this._string.slice(this.position, this.position + size);\n    this.position += size;\n    return s;\n};\n\nfunction deltaEncodeSegment(points) {\n    let deltaLats = [],\n        deltaLons = [];\n    let lastLon = 0,\n        lastLat = 0,\n        lon, lat;\n    for (let i = 0, len = points.length; i < len; i++) {\n        let p = points[i];\n        lon = Math.round(p.lng * arcUnit);\n        lat = Math.round(p.lat * arcUnit);\n        let deltaLon = lon - lastLon;\n        let deltaLat = lat - lastLat;\n        deltaLats.push(deltaLat);\n        deltaLons.push(deltaLon);\n        lastLon = lon;\n        lastLat = lat;\n    }\n    return {deltaLats, deltaLons};\n}\n\nfunction deltaDecodeSegment(deltaLats, deltaLons) {\n    let encodedLat = 0,\n        encodedLon = 0;\n    const points = [];\n    for (let i = 0; i < deltaLats.length; i++) {\n        encodedLat += deltaLats[i];\n        encodedLon += deltaLons[i];\n        points.push({lat: encodedLat / arcUnit, lng: encodedLon / arcUnit});\n    }\n    return points;\n}\n\nfunction saveNktk(segments, name, color, measureTicksShown, waypoints, trackHidden) {\n    const trackView = {\n        view: {\n            color,\n            shown: !trackHidden,\n            ticksShown: measureTicksShown,\n        }\n    };\n    const track = trackView.track = {name};\n    if (segments && segments.length) {\n        let deltaEncodedSegments = [];\n        for (let segment of segments) {\n            let {deltaLats, deltaLons} = deltaEncodeSegment(segment);\n            deltaEncodedSegments.push({lats: deltaLats, lons: deltaLons});\n        }\n        track.segments = deltaEncodedSegments;\n    }\n    if (waypoints && waypoints.length) {\n        let midLon = 0,\n            midLat = 0;\n        waypoints.forEach((wp) => {\n                midLon += wp.latlng.lng;\n                midLat += wp.latlng.lat;\n            }\n        );\n        midLon = Math.round(midLon * arcUnit / waypoints.length);\n        midLat = Math.round(midLat * arcUnit / waypoints.length);\n        track.waypoints = {\n            midLat, midLon\n        };\n\n        let packedWaypoints = [];\n        for (let waypoint of waypoints) {\n            packedWaypoints.push({\n                name: waypoint.label,\n                lat: Math.round(waypoint.latlng.lat * arcUnit) - midLat,\n                lon: Math.round(waypoint.latlng.lng * arcUnit) - midLon\n            });\n        }\n        track.waypoints.waypoints = packedWaypoints;\n    }\n    const pbf = new Pbf();\n    const versionStr = String.fromCharCode(4 + 64);\n    TrackView.write(trackView, pbf);\n    const s = versionStr + arrayBufferToString(pbf.finish());\n    return urlSafeBase64.encode(s);\n}\n\nfunction parseNktkOld(s, version) {\n    var name,\n        n,\n        segments = [],\n        segment,\n        segmentsCount,\n        pointsCount,\n        arcUnit = ((1 << 24) - 1) / 360,\n        x, y,\n        error, midX, midY, /* symbol,*/ waypointName,\n        wayPoints = [],\n        color, measureTicksShown,\n        trackHidden = false;\n    s = new PackedStreamReader(s);\n    try {\n        n = s.readNumber();\n        name = s.readString(n);\n        name = utf8.decode(name);\n        segmentsCount = s.readNumber();\n        for (let i = 0; i < segmentsCount; i++) {\n            segment = [];\n            pointsCount = s.readNumber();\n            x = 0;\n            y = 0;\n            for (let j = 0; j < pointsCount; j++) {\n                x += s.readNumber();\n                y += s.readNumber();\n                segment.push({lng: x / arcUnit, lat: y / arcUnit});\n            }\n            segments.push(segment);\n            segment = null;\n        }\n    } catch (e) {\n        if (e.message.match('Unexpected end of line while unpacking number')) {\n            error = ['CORRUPT'];\n            if (segment) {\n                segments.push(segment);\n            }\n        } else {\n            throw e;\n        }\n    }\n    try {\n        color = s.readNumber();\n        measureTicksShown = s.readNumber();\n    } catch (e) {\n        if (e.message.match('Unexpected end of line while unpacking number')) {\n            color = 0;\n            measureTicksShown = 0;\n            if (version > 0) {\n                error = ['CORRUPT'];\n            }\n        } else {\n            throw e;\n        }\n    }\n    if (version >= 3) {\n        try {\n            trackHidden = Boolean(s.readNumber());\n        } catch (e) {\n            if (e.message.match('Unexpected end of line while unpacking number')) {\n                error = ['CORRUPT'];\n            } else {\n                throw e;\n            }\n        }\n    }\n    if (version >= 2) {\n        try {\n            pointsCount = s.readNumber();\n            if (pointsCount) {\n                midX = s.readNumber();\n                midY = s.readNumber();\n            }\n            for (let i = 0; i < pointsCount; i++) {\n                n = s.readNumber();\n                waypointName = s.readString(n);\n                waypointName = utf8.decode(waypointName);\n\n                // let symbol = s.readNumber();\n                s.readNumber();\n\n                x = s.readNumber() + midX;\n                y = s.readNumber() + midY;\n                wayPoints.push({\n                        name: waypointName,\n                        lat: y / arcUnit,\n                        lng: x / arcUnit,\n\n                    }\n                );\n            }\n        } catch (e) {\n            if (e.message.match('Unexpected end of line while unpacking number')) {\n                error = ['CORRUPT'];\n            } else {\n                throw e;\n            }\n        }\n    }\n    var geoData = {\n        name: name || \"Text encoded track\",\n        tracks: segments,\n        error: error,\n        points: wayPoints,\n        color: color,\n        group: 'default',\n        measureTicksShown: measureTicksShown,\n        trackHidden: trackHidden\n    };\n    return [geoData];\n}\n\nfunction parseTrackUrlData(s) {\n    s = urlSafeBase64.decode(s);\n    if (!s) {\n        return [{name: 'Text encoded track', error: ['CORRUPT']}];\n    }\n    return parseNktkOld(s, 0);\n}\n\nfunction parseNktkProtobuf(s, group = 'default') {\n    const pbf = new Pbf(stringToArrayBuffer(s));\n    let trackView;\n    try {\n        trackView = TrackView.read(pbf);\n    } catch (e) {\n        return [{name: 'Text encoded track', error: ['CORRUPT']}];\n    }\n    const geoData = {\n        name: trackView.track.name || \"Text encoded track\",\n        color: trackView.view.color,\n        trackHidden: !trackView.view.shown,\n        group: group,\n        measureTicksShown: trackView.view.ticksShown,\n    };\n    const segments = trackView.track.segments;\n    if (segments && segments.length) {\n        geoData.tracks = segments.map((segment) => deltaDecodeSegment(segment.lats, segment.lons));\n    }\n    if (trackView.track.waypoints && trackView.track.waypoints.waypoints.length) {\n        const waypoints = geoData.points = [];\n        for (let waypoint of trackView.track.waypoints.waypoints) {\n            waypoints.push({\n                name: waypoint.name,\n                lat: (waypoint.lat + trackView.track.waypoints.midLat) / arcUnit,\n                lng: (waypoint.lon + trackView.track.waypoints.midLon) / arcUnit\n            });\n        }\n    }\n    return [geoData];\n}\n\nfunction parseNktkFragment(s, group = 'default') {\n    s = urlSafeBase64.decode(s);\n    if (!s) {\n        return [{name: 'Text encoded track', error: ['CORRUPT']}];\n    }\n    const reader = new PackedStreamReader(s);\n    let version = reader.readNumber();\n    if (version === 1 || version === 2 || version === 3) {\n        return parseNktkOld(s.substring(reader.position), version);\n    } else if (version === 4) {\n        return parseNktkProtobuf(s.substring(reader.position), group);\n    }\n    return [{name: 'Text encoded track', error: ['CORRUPT']}];\n}\n\nfunction parseNktkSequence(s, group = 'default' ) {\n    let track_data = s.split('/');\n    let data = [];\n    track_data.forEach(function(element, index){\n        let arr = parseNktkFragment(element, group);\n        arr.forEach(function(element2){\n            data.push(element2);\n        });\n    });\n\n    return data;\n}\n\nexport {saveNktk, parseTrackUrlData, parseNktkSequence, parseNktkFragment};\n","function onElementResize(element, cb) {\n    if (window.ResizeObserver) {\n        const observer = new ResizeObserver(() => cb());\n        observer.observe(element);\n    } else {\n        let width = element.offsetWidth;\n        let height = element.offsetHeight;\n        setInterval(function () {\n            const newWidth = element.offsetWidth;\n            const newHeight = element.offsetHeight;\n            if (newWidth !== width || newHeight !== height) {\n                width = newWidth;\n                height = newHeight;\n                cb();\n            }\n        }, 200);\n    }\n}\n\nexport {onElementResize};\n","import ko from 'knockout';\nimport './style.css';\nimport '~/lib/controls-styles/controls-styles.css';\n\nko.components.register('progress-indicator', {\n    template: `\n        <div class=\"ko-progress-unknown icon-spinner-nuclear\" data-bind=\"visible: progress() === undefined\"></div>\n        <div class=\"ko-progress\" data-bind=\"visible: progress() !== undefined\">\n            <div class=\"ko-progress-bkg\">\n                <div class=\"ko-progress-bar\"  data-bind=\"style: {width: progress() + '%'}\"></div>\n            </div>\n        </div>`,\n    viewModel: function(params) {\n        this.progress = ko.pureComputed(function() {\n            var range = params.progressRange(),\n                done = params.progressDone();\n            return done === undefined ? undefined : done * 100 / range;\n        });\n    }\n});\n","import L from 'leaflet';\nimport './TileLayer';\nimport './Bing';\nimport './Yandex';\nimport './Google';\nimport './WestraPasses';\nimport './CanvasMarkers';\nimport './MeasuredLine';\nimport './RetinaTileLayer';\n\nfunction getTempMap(zoom, fullSize, pixelBounds) {\n    const container = L.DomUtil.create('div', '', document.body);\n    let width, height, center;\n    if (fullSize) {\n        const size = pixelBounds.getSize();\n        width = size.x;\n        height = size.y;\n        center = pixelBounds.min.add(size.divideBy(2));\n        center = L.CRS.EPSG3857.pointToLatLng(center, zoom);\n    } else {\n        width = 100;\n        height = 100;\n        center = L.latLng(0, 0);\n    }\n\n    Object.assign(container.style, {\n            width: `${width}px`,\n            height: `${height}px`,\n            position: 'absolute',\n            left: '0',\n            top: '0',\n            visibility: 'hidden',\n        }\n    );\n\n    const map = L.map(container, {fadeAnimation: false, zoomAnimation: false, inertia: false, maxZoom: 18});\n    map.setView(center, zoom);\n    return map;\n}\n\nfunction disposeMap(map) {\n    const container = map._container;\n    map.remove();\n    L.DomUtil.remove(container);\n}\n\nexport {getTempMap, disposeMap};\n","import L from 'leaflet';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\nimport {imgFromDataString} from './imgFromDataString';\n\nfunction noop() {\n    // dummy function\n}\n\nconst GridLayerGrabMixin = {\n    tileImagePromiseFromCoords: function(_unused_coords) {\n        throw new Error('Method not implemented');\n    },\n\n    waitTilesReadyToGrab: function() {\n        return Promise.resolve(null);\n    },\n\n    getTilesInfo: async function(printOptions) {\n        await this.waitTilesReadyToGrab();\n        const {pixelBounds} = printOptions;\n        const tileRange = this._pxBoundsToTileRange(pixelBounds);\n        const topLeft = pixelBounds.min;\n        const tilePromiseIterator = (function*() {\n            for (let j = tileRange.min.y; j <= tileRange.max.y; j++) {\n                for (let i = tileRange.min.x; i <= tileRange.max.x; i++) {\n                    let coords = new L.Point(i, j);\n                    coords.z = this._tileZoom;\n                    if (!this._isValidTile(coords)) {\n                        continue;\n                    }\n                    let tilePos = this._getTilePos(coords);\n                    const coordsPlusOne = coords.add(L.point(1, 1));\n                    coordsPlusOne.z = coords.z;\n                    const tilePlusOne = this._getTilePos(coordsPlusOne);\n                    const tileSize = tilePlusOne.subtract(tilePos);\n                    const latLngBounds = L.latLngBounds(\n                        this._map.unproject(tilePos.add(this._level.origin)),\n                        this._map.unproject(tilePlusOne.add(this._level.origin)));\n                    tilePos = tilePos.add(this._level.origin).subtract(topLeft);\n                    let {tilePromise, abortLoading} = this.tileImagePromiseFromCoords(\n                        this._wrapCoords(coords), printOptions);\n                    yield {\n                        tilePromise: tilePromise.then((image) => ({image, tilePos, tileSize, latLngBounds})),\n                        abortLoading\n                    };\n                }\n            }\n        }).bind(this);\n        return {\n            iterateTilePromises: tilePromiseIterator,\n            count: (tileRange.max.x - tileRange.min.x + 1) * (tileRange.max.y - tileRange.min.y + 1)\n        };\n    }\n};\n\nconst TileLayerGrabMixin = L.Util.extend({}, GridLayerGrabMixin, {\n        cloneForPrint: function(options) {\n            return L.tileLayer(this._url, L.Util.extend({}, this.options, options));\n        },\n\n        tileImagePromiseFromCoords: function(coords, printOptions) {\n            let {xhrOptions} = printOptions;\n            let url = this.getTileUrl(coords);\n            if (!url) {\n                return {tilePromise: Promise.resolve(null), abortLoading: noop};\n            }\n            if (this.options.noCors) {\n                url = urlViaCorsProxy(url);\n            }\n            let promise = this.options.xhrQueue.put(url, xhrOptions);\n\n            return {\n                tilePromise: printOptions.rawData ? promise : promise.then(imgFromDataString),\n                abortLoading: () => promise.abort()\n            };\n        }\n    }\n);\n\n// CanvasLayerGrabMixin has been deleted\n\nL.TileLayer.include(TileLayerGrabMixin);\n","import L from 'leaflet';\nimport './style.css';\n\nconst yandexCrs = L.CRS.EPSG3395;\n\nL.Layer.Yandex = L.TileLayer.extend({\n        options: {\n            subdomains: '1234',\n            className: L.Browser.retina ? '' : 'yandex-tile-layer',\n            yandexScale: L.Browser.retina ? 2 : 1\n        },\n\n        _getTilePos: function(coords) {\n            const tilePosLatLng = yandexCrs.pointToLatLng(coords.scaleBy(this.getTileSize()), coords.z);\n            return this._map.project(tilePosLatLng, coords.z).subtract(this._level.origin).round();\n        },\n\n        _pxBoundsToTileRange: function(bounds) {\n            const zoom = this._tileZoom;\n            const bounds2 = new L.Bounds(\n                yandexCrs.latLngToPoint(this._map.unproject(bounds.min, zoom), zoom),\n                yandexCrs.latLngToPoint(this._map.unproject(bounds.max, zoom), zoom));\n            return L.TileLayer.prototype._pxBoundsToTileRange.call(this, bounds2);\n        },\n\n        createTile: function(coords, done) {\n            const tile = L.TileLayer.prototype.createTile.call(this, coords, done);\n            const coordsBelow = L.point(coords).add([0, 1]);\n            coordsBelow.z = coords.z;\n            tile._adjustHeight = this._getTilePos(coordsBelow).y - this._getTilePos(coords).y;\n            return tile;\n        },\n\n        _initTile: function(tile) {\n            L.TileLayer.prototype._initTile.call(this, tile);\n            tile.style.height = `${tile._adjustHeight}px`;\n        }\n    }\n);\n\nL.Layer.Yandex.Map = L.Layer.Yandex.extend({\n    initialize: function(options) {\n        L.Layer.Yandex.prototype.initialize.call(\n            this,\n            'https://vec0{s}.maps.yandex.net/tiles?l=map&x={x}&y={y}&z={z}&scale={yandexScale}',\n            options\n        );\n    },\n});\n\nL.Layer.Yandex.Sat = L.Layer.Yandex.extend({\n    initialize: function(options) {\n        L.Layer.Yandex.prototype.initialize.call(\n            this,\n            'https://sat0{s}.maps.yandex.net/tiles?l=sat&x={x}&y={y}&z={z}',\n            options\n        );\n    },\n});\n\nL.Layer.Yandex.Tracks = L.Layer.Yandex.extend({\n    initialize: function(options) {\n        options = {minZoom: 10, maxNativeZoom: 16, ...options};\n        L.Layer.Yandex.prototype.initialize.call(\n            this,\n            'https://core-gpstiles.maps.yandex.net/tiles?style=point&x={x}&y={y}&z={z}',\n            options\n        );\n    },\n});\n","import L from \"leaflet\";\n\nL.Layer.GoogleBase = L.TileLayer.extend({\n    options: {\n        subdomains: '0123'\n    },\n\n    getTileUrl: function(coords) {\n        const data = {\n            x: coords.x,\n            y: coords.y,\n            z: 17 - this._getZoomForUrl(),\n            s: this._getSubdomain(coords),\n            lang: navigator.language || ''\n        };\n        return L.Util.template(this._url, data);\n    }\n});\n\nL.Layer.GoogleMap = L.Layer.GoogleBase.extend({\n    initialize: function(options) {\n        L.Layer.GoogleBase.prototype.initialize.call(\n            this, 'https://mt{s}.google.com/vt/lyrs=m@169000000&hl={lang}&x={x}&y={y}&zoom={z}', options);\n    }\n});\n\nL.Layer.GoogleTerrain = L.Layer.GoogleBase.extend({\n    initialize: function(options) {\n        L.Layer.GoogleBase.prototype.initialize.call(\n            this, 'https://mt{s}.google.com/vt/lyrs=t@130,r@206000000&hl={lang}&x={x}&y={y}&zoom={z}', options);\n    }\n});\n\nL.Layer.GoogleHybrid = L.Layer.GoogleBase.extend({\n    initialize: function(options) {\n        L.Layer.GoogleBase.prototype.initialize.call(\n            this, 'https://mt{s}.google.com/vt/lyrs=h@169000000&hl={lang}&x={x}&y={y}&zoom={z}', options);\n    }\n});\n\nL.Layer.GoogleSat = L.TileLayer.extend({\n    options: {\n        subdomains: '0123'\n    },\n\n    initialize: function(options) {\n        L.TileLayer.prototype.initialize.call(\n            this, 'https://mt{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', options);\n    }\n});\n","import L from 'leaflet';\nimport '~/lib/leaflet.layer.canvasMarkers';\nimport {openPopupWindow} from '~/lib/popup-window';\nimport escapeHtml from 'escape-html';\nimport {saveAs} from '~/vendored/github.com/eligrey/FileSaver';\nimport iconFromBackgroundImage from '~/lib/iconFromBackgroundImage';\nimport {fetch} from '~/lib/xhr-promise';\nimport {notify} from '~/lib/notifications';\nimport * as logging from '~/lib/logging';\n\nconst WestraPassesMarkers = L.Layer.CanvasMarkers.extend({\n        options: {\n            filePasses: 'westra_passes.json',\n            scaleDependent: true\n        },\n\n        initialize: function(baseUrl, options) {\n            L.Layer.CanvasMarkers.prototype.initialize.call(this, null, options);\n            this.on('markerclick', this.showPassDescription, this);\n            this._baseUrl = baseUrl;\n            this.url = baseUrl + this.options.filePasses;\n        },\n\n        loadData: function() {\n            if (this._downloadStarted) {\n                return;\n            }\n            this._downloadStarted = true;\n            fetch(this.url)\n                .then(\n                    (xhr) => this._loadMarkers(xhr),\n                    (e) => {\n                        this._downloadStarted = false;\n                        logging.captureException(e, 'failed to get westra passes');\n                        notify('Failed to get Westra passes data');\n                    }\n                );\n        },\n\n        onAdd: function(map) {\n            L.Layer.CanvasMarkers.prototype.onAdd.call(this, map);\n            this.loadData();\n        },\n\n        _makeTooltip: function(marker) {\n            var properties = marker.properties,\n                toolTip = properties.grade || '';\n            if (toolTip && properties.elevation) {\n                toolTip += ', ';\n            }\n            toolTip += properties.elevation || '';\n            if (toolTip) {\n                toolTip = ' (' + toolTip + ')';\n            }\n            toolTip = (properties.name || 'без названия') + toolTip;\n            toolTip = (properties.is_summit ? 'Вершина ' : 'Перевал ') + toolTip;\n            return toolTip;\n        },\n\n        _passToGpx: function(marker) {\n            let label = marker.tooltip;\n            if (typeof label === 'function') {\n                label = label(marker);\n            }\n            label = escapeHtml(label);\n            const gpx = `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\" ?>\n                <gpx xmlns=\"http://www.topografix.com/GPX/1/1\"\n                     creator=\"http://nakarte.me\"\n                     xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n                     xsi:schemaLocation=\"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd\"\n                     version=\"1.1\">\n                    <wpt lat=\"${marker.latlng.lat.toFixed(6)}\" lon=\"${marker.latlng.lng.toFixed(6)}\">\n                        <name>${label}</name>\n                    </wpt>\n                </gpx>\n            `;\n            var filename = marker.properties.name || 'Без названия';\n            saveAs(new Blob([gpx], {type: 'application/gpx+xml'}), filename + '.gpx', true);\n        },\n\n        _passToKml: function(marker) {\n            let label = marker.tooltip;\n            if (typeof label === 'function') {\n                label = label(marker);\n            }\n            label = escapeHtml(label);\n            const kml = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n                <kml xmlns=\"http://www.opengis.net/kml/2.2\">\n                    <Placemark>\n                        <name>${label}</name>\n                        <Point>\n                            <coordinates>\n                                ${marker.latlng.lng.toFixed(6)},${marker.latlng.lat.toFixed(6)},0\n                            </coordinates>\n                        </Point>\n                    </Placemark>\n                </kml>\n            `;\n            var filename = marker.properties.name || 'Без названия';\n            saveAs(new Blob([kml], {type: 'application/vnd.google-earth.kml+xml'}), filename + '.kml', true);\n        },\n\n        _makeIcon: function(marker) {\n            var className;\n            className = 'westra-pass-marker ';\n            if (marker.properties.is_summit) {\n                className += 'westra-pass-marker-summit';\n            } else {\n                className += 'westra-pass-marker-' + marker.properties.grade_eng;\n            }\n            return iconFromBackgroundImage(className);\n        },\n\n        _loadMarkers: function(xhr) {\n            var markers = [],\n                features = JSON.parse(xhr.response),\n                feature, i, marker;\n            for (i = 0; i < features.length; i++) {\n                feature = features[i];\n                marker = {\n                    latlng: {\n                        lat: feature.latlon[0],\n                        lng: feature.latlon[1]\n                    },\n                    label: feature.name || \"\",\n                    icon: this._makeIcon,\n                    tooltip: this._makeTooltip.bind(this),\n                    properties: feature\n                };\n                markers.push(marker);\n            }\n            this.addMarkers(markers);\n            this._dataLoaded = true;\n            this.fire('data-loaded');\n        },\n\n        showPassDescription: function(e) {\n            if (!this._map) {\n                return;\n            }\n            const properties = e.marker.properties,\n                latLng = e.marker.latlng,\n                url = 'https://westra.ru/passes/Passes/' + properties.id;\n            let altnames = '',\n                connects = '',\n                comments = '';\n            if (properties.altnames) {\n                altnames = `\n                    <tr>\n                        <td>Другие названия</td>\n                        <td>${properties.altnames}</td>\n                    </tr>`;\n            }\n\n            if (!properties.is_summit) {\n                connects = `\n                    <tr>\n                        <td>Соединяет</td>\n                        <td>${properties.connects || \"неизвестнo\"}</td>\n                    </tr>`;\n            }\n\n            if (properties.comments) {\n                for (let comment of properties.comments) {\n                    let user = '';\n                    if (comment.user) {\n                        user = `<span class=\"westra-passes-description-comment-author\">${comment.user}:</span>`;\n                    }\n                    comments += `<p class=\"westra-passes-description-comment\">${user}${comment.content}</p>`;\n                }\n                comments = `\n                    <tr>\n                        <td>Комментарии</td>\n                        <td>${comments}</td>\n                    </tr>`;\n            }\n            let reports;\n            if (properties.reports_total) {\n                reports =\n                    `<br>Отчетов: ${properties.reports_total}, ` +\n                    `с фото: ${properties.reports_photo || 0}, ` +\n                    `с описанием: ${properties.reports_tech || 0}`;\n            } else {\n                reports = '<br>Отчетов нет';\n            }\n            let description = `\n                <table class=\"pass-details\">\n                    <tr>\n                        <td>${properties.is_summit ? 'Вершина ' : 'Перевал '}</td>\n                        <td>${properties.name || 'название неизвестно'}</td>\n                    </tr>\n                    ${altnames}\n                    <tr>\n                        <td>Категория</td>\n                        <td>${properties.grade || \"неизвестная\"}</td>\n                    </tr>\n                    <tr>\n                        <td>Высота</td>\n                        <td>${properties.elevation ? (properties.elevation + ' м') : 'неизвестная'}</td>\n                    </tr>\n                    ${connects}\n                    <tr>\n                        <td>Характеристика склонов</td>\n                        <td>${properties.slopes || \"неизвестная\"}</td>\n                    </tr>\n                    <tr>\n                        <td>Координаты</td>\n                        <td>\n                            <table class=\"coords\">\n                                <tr class=\"header\">\n                                    <td>Широта</td>\n                                    <td>Долгота</td>\n                                </tr>\n                                <tr>\n                                    <td>${latLng.lat.toFixed(5)}</td>\n                                    <td>${latLng.lng.toFixed(5)}</td>\n                                    <td><a id=\"westra-pass-gpx\" title=\"Сохранить\">gpx</a></td>\n                                    <td><a id=\"westra-pass-kml\" title=\"Сохранить\">kml</a></td>\n                                </tr>\n                            </table>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>На сайте Вестры</td>\n                        <td><a id=\"westra-pass-link\" href=\"${url}\">${url}</a>${reports}</td></tr>\n                    <tr>\n                        <td>Добавил</td>\n                        <td>${properties.author || \"неизвестно\"}</td>\n                    </tr>\n                    ${comments}\n                </table>`;\n            this._map.openPopup(description, latLng, {maxWidth: 500});\n            document.getElementById('westra-pass-link').onclick = function() {\n                openPopupWindow(url, 780, 'westra-details');\n                return false;\n            };\n            document.getElementById('westra-pass-gpx').onclick = function() {\n                this._passToGpx(e.marker);\n                return false;\n            }.bind(this);\n            document.getElementById('westra-pass-kml').onclick = function() {\n                this._passToKml(e.marker);\n                return false;\n            }.bind(this);\n        }\n    }\n);\n\nexport {WestraPassesMarkers};\n","import {notify} from '~/lib/notifications';\n\nfunction openPopupWindow(url, width, uniqName = null) {\n    var left, top, height,\n        screenLeft = screen.availLeft || 0,\n        bordersWidth = 8;\n    // if browser window is in the right half of screen, place new window on left half\n    if (window.screenX - screenLeft - bordersWidth * 1.5 > width) {\n        left = window.screenX - width - bordersWidth * 1.5;\n        // if browser window is in the left half of screen, place new window on right half\n    } else if (window.screenX + window.outerWidth + width + bordersWidth * 1.5 < screenLeft + screen.availWidth) {\n        left = window.screenX + window.outerWidth + bordersWidth;\n        // if screen is small or browser window occupies whole screen, place new window on top of current window\n    } else {\n        left = window.screenX + window.outerWidth / 2 - width / 2;\n        if (left < 0) {\n            left = 0;\n        }\n    }\n    top = window.screenY;\n    height = window.innerHeight;\n    var features = 'width=' + width + ',height=' + height + ',left=' + left + ',top=' + top;\n    features += ',resizable,scrollbars';\n    var newWindow = window.open(url, uniqName, features);\n    if (!newWindow || newWindow.closed) {\n        notify('Всплывающее окно заблокировано браузером.\\n' +\n            'Для полноценной работы сайта необходимо разрешить всплывающие окна в настройках браузера для сайта.\\n\\n' +\n            'Pop-up window was blocked by the browser.\\n' +\n            'If you want to use the full functionality of this site, ' +\n            'turn off blocking pop-ups in the browser settings for this site.');\n    } else {\n        newWindow.focus();\n    }\n}\n\nexport {openPopupWindow};\n","function cached(f) {\n    var cache = {};\n    return function(arg) {\n        if (!(arg in cache)) {\n            cache[arg] = f(arg);\n        }\n        return cache[arg];\n    };\n}\n\nfunction iconFromBackgroundImage(className) {\n    const container = document.createElement('div');\n    container.style.position = 'absolute';\n    document.body.appendChild(container);\n    const el = document.createElement('div');\n    el.className = className;\n    container.appendChild(el);\n    const st = window.getComputedStyle(el),\n        url = st.backgroundImage.replace(/^url\\(\"?/u, '').replace(/\"?\\)$/u, '');\n    let icon = {url: url, center: [-el.offsetLeft, -el.offsetTop]};\n    document.body.removeChild(container);\n    container.removeChild(el);\n    return icon;\n}\n\nexport default cached(iconFromBackgroundImage);\n","import L from \"leaflet\";\nimport '~/lib/leaflet.layer.canvasMarkers';\n\nL.Layer.CanvasMarkers.include({\n        _printProgressWeight: 0.1,\n\n        cloneMarker: function(marker) {\n            return {\n                latlng: {lat: marker.latlng.lat, lng: marker.latlng.lng},\n                label: marker.label,\n                icon: marker.icon\n            };\n        },\n\n        cloneMarkers: function() {\n            const markers = this.rtree.all();\n\n            const markersCopy = markers.map(this.cloneMarker);\n            return markersCopy;\n        },\n\n        cloneForPrint: function(options) {\n            options = L.Util.extend({}, this.options, {noWrap: true});\n            if (options.printIconsOpacity !== undefined) {\n                options.iconsOpacity = options.printIconsOpacity;\n            }\n            return new L.Layer.CanvasMarkers(this.cloneMarkers(), options);\n        },\n\n        getTilesInfo: async function(printOptions) {\n            this.options.iconScale = printOptions.resolution / 90 * 0.75;\n            const scale = printOptions.pixelBounds.getSize().x / printOptions.destPixelSize.x;\n            const pixelExtents = {\n                tileN: printOptions.pixelBounds.getTopRight().y / scale,\n                tileS: printOptions.pixelBounds.getBottomLeft().y / scale,\n                tileE: printOptions.pixelBounds.getTopRight().x / scale,\n                tileW: printOptions.pixelBounds.getBottomLeft().x / scale\n            };\n            const crs = L.CRS.EPSG3857;\n            if (!this._map) {\n                const dummyMap = {\n                    project: crs.latLngToPoint.bind(crs),\n                    unproject: crs.pointToLatLng.bind(crs),\n                };\n                this._map = dummyMap;\n            }\n            const zoom = crs.zoom((1 / scale) * crs.scale(printOptions.zoom));\n            const {iconUrls, markerJobs, pointsForLabels} = this.selectMarkersForDraw(pixelExtents, zoom, true);\n            await this.preloadIcons(iconUrls);\n            return {\n                iterateTilePromises: (function*() {\n                    yield {\n                        tilePromise: Promise.resolve({\n                                draw: (canvas) => {\n                                    this.resetLabels();\n                                    this.drawSelectedMarkers(canvas, pixelExtents, markerJobs, pointsForLabels, zoom,\n                                        true);\n                                },\n                                isOverlay: true,\n                                overlaySolid: !this.options.printTransparent\n                            }\n                        ),\n                        abortLoading: () => {\n                            // no actions needed\n                        }\n                    };\n                }).bind(this),\n                count: 1\n            };\n        }\n    }\n);\n","import L from 'leaflet';\nimport './measured_line.css';\n\nfunction pointOnSegmentAtDistance(p1, p2, dist) {\n    // FIXME: we should place markers along projected line to avoid transformation distortions\n    var q = dist / p1.distanceTo(p2),\n        x = p1.lng + (p2.lng - p1.lng) * q,\n        y = p1.lat + (p2.lat - p1.lat) * q;\n    return L.latLng(y, x);\n}\n\nfunction sinCosFromLatLonSegment(segment) {\n    const\n        p1 = L.CRS.EPSG3857.project(segment[0]),\n        p2 = L.CRS.EPSG3857.project(segment[1]),\n        dx = p2.x - p1.x,\n        dy = p1.y - p2.y,\n        len = Math.sqrt(dx * dx + dy * dy),\n        sin = dy / len,\n        cos = dx / len;\n    return [sin, cos];\n}\n\nL.MeasuredLine = L.Polyline.extend({\n        options: {\n            minTicksIntervalMm: 15,\n        },\n\n        onAdd: function(map) {\n            L.Polyline.prototype.onAdd.call(this, map);\n            this._ticks = {};\n            this.updateTicks();\n            this._map.on('zoomend', this.updateTicks, this);\n            // markers are created only for visible part of map, need to update when it changes\n            this._map.on('moveend', this.updateTicks, this);\n            this.on('nodeschanged', this.updateTicksLater, this);\n        },\n\n        updateTicksLater: function() {\n            setTimeout(this.updateTicks.bind(this), 0);\n        },\n\n        onRemove: function(map) {\n            this._map.off('zoomend', this.updateTicks, this);\n            this._map.off('moveend', this.updateTicks, this);\n            this.off('nodeschanged', this.updateTicks, this);\n            this._clearTicks();\n            L.Polyline.prototype.onRemove.call(this, map);\n        },\n\n        _clearTicks: function() {\n            if (this._map) {\n                Object.values(this._ticks).forEach((tick) => this._map.removeLayer(tick));\n                this._ticks = {};\n            }\n        },\n\n        _addTick: function(tick, marker) {\n            var transformMatrixString = 'matrix(' + tick.transformMatrix.join(',') + ')';\n            if (marker) {\n                marker._icon.childNodes[0].style.transform = transformMatrixString;\n                marker.setLatLng(tick.position);\n            } else {\n                var labelText = Math.round((tick.distanceValue / 10)) / 100 + ' km',\n                    icon = L.divIcon(\n                        {\n                            html: '<div class=\"measure-tick-icon-text\" style=\"transform:' +\n                                transformMatrixString + '\">' +\n                            labelText + '</div>',\n                            className: 'measure-tick-icon'\n                        }\n                    );\n                marker = L.marker(tick.position, {\n                    icon: icon,\n                    interactive: false,\n                    keyboard: false,\n                    projectedShift: () => this.shiftProjectedFitMapView(),\n                });\n                marker.addTo(this._map);\n            }\n            this._ticks[tick.distanceValue.toString()] = marker;\n        },\n\n        setMeasureTicksVisible: function(visible) {\n            this.options.measureTicksShown = visible;\n            this.updateTicks();\n        },\n\n        getTicksPositions: function(minTicksIntervalMeters, bounds) {\n            var steps = [500, 1000, 2000, 5000, 10000, 20000, 50000, 100000, 200000, 500000, 1000000];\n            var ticks = [];\n\n            const that = this;\n            function addTick(position, segment, distanceValue) {\n                if (bounds) {\n                    // create markers only in visible part of map\n                    const normalizedBounds = that._map.wrapLatLngBounds(bounds);\n                    const normalizedPosition = position.wrap();\n                    // account for worldCopyJump\n                    const positionMinus360 = L.latLng(normalizedPosition.lat, normalizedPosition.lng - 360);\n                    const positionPlus360 = L.latLng(normalizedPosition.lat, normalizedPosition.lng + 360);\n                    if (\n                        !normalizedBounds.contains(normalizedPosition) &&\n                        !normalizedBounds.contains(positionMinus360) &&\n                        !normalizedBounds.contains(positionPlus360)\n                    ) {\n                        return;\n                    }\n                }\n\n                var sinCos = sinCosFromLatLonSegment(segment),\n                    sin = sinCos[0],\n                    cos = sinCos[1],\n                    transformMatrix;\n\n                if (sin > 0) {\n                    transformMatrix = [sin, -cos, cos, sin, 0, 0];\n                } else {\n                    transformMatrix = [-sin, cos, -cos, -sin, 0, 0];\n                }\n                ticks.push({position: position, distanceValue: distanceValue, transformMatrix: transformMatrix});\n            }\n\n            let step;\n            for (step of steps) {\n                if (step >= minTicksIntervalMeters) {\n                    break;\n                }\n            }\n\n            var lastTickMeasure = 0,\n                lastPointMeasure = 0,\n                points = this._latlngs,\n                points_n = points.length,\n                nextPointMeasure,\n                segmentLength;\n            if (points_n < 2) {\n                return ticks;\n            }\n\n            for (var i = 1; i < points_n; i++) {\n                segmentLength = points[i].distanceTo(points[i - 1]);\n                nextPointMeasure = lastPointMeasure + segmentLength;\n                if (nextPointMeasure >= lastTickMeasure + step) {\n                    while (lastTickMeasure + step <= nextPointMeasure) {\n                        lastTickMeasure += step;\n                        addTick(\n                            pointOnSegmentAtDistance(points[i - 1], points[i], lastTickMeasure - lastPointMeasure),\n                            [points[i - 1], points[i]],\n                            lastTickMeasure\n                        );\n                    }\n                }\n                lastPointMeasure = nextPointMeasure;\n            }\n            // remove last mark if it is close to track end\n            if (lastPointMeasure - lastTickMeasure < minTicksIntervalMeters / 2) {\n                ticks.pop();\n            }\n            // special case: if track is versy short, do not add starting mark\n            if (lastPointMeasure > minTicksIntervalMeters / 2) {\n                addTick(points[0], [points[0], points[1]], 0);\n            }\n            addTick(points[points_n - 1], [points[points_n - 2], points[points_n - 1]], lastPointMeasure);\n            return ticks;\n        },\n\n        updateTicks: function() {\n            if (!this._map) {\n                return;\n            }\n            if (!this.options.measureTicksShown) {\n                this._clearTicks();\n                return;\n            }\n            var bounds = this._map.getBounds().pad(1),\n                rad = Math.PI / 180,\n                dpi = 96,\n                mercatorMetersPerPixel = 20003931 / (this._map.project([180, 0]).x),\n                referencePoint = this.getLatLngs().length ? this.getBounds().getCenter() : this._map.getCenter(),\n                realMetersPerPixel = mercatorMetersPerPixel * Math.cos(referencePoint.lat * rad),\n                mapScale = 1 / dpi * 2.54 / 100 / realMetersPerPixel,\n                minTicksIntervalMeters = this.options.minTicksIntervalMm / mapScale / 1000,\n                ticks = this.getTicksPositions(minTicksIntervalMeters, bounds),\n                oldTicks = this._ticks;\n            this._ticks = {};\n            ticks.forEach(function(tick) {\n                    var oldMarker = oldTicks[tick.distanceValue.toString()];\n                    this._addTick(tick, oldMarker);\n                    if (oldMarker) {\n                        delete oldTicks[tick.distanceValue.toString()];\n                    }\n                }.bind(this)\n            );\n            Object.values(oldTicks).forEach((tick) => this._map.removeLayer(tick));\n        },\n\n        getLength: function() {\n            var points = this._latlngs,\n                points_n = points.length,\n                length = 0;\n\n            for (var i = 1; i < points_n; i++) {\n                length += points[i].distanceTo(points[i - 1]);\n            }\n            return length;\n        }\n    }\n);\n\nL.measuredLine = function(latlngs, options) {\n    return new L.MeasuredLine(latlngs, options);\n};\n","import L from 'leaflet';\n\nclass RetinaTileLayer extends L.TileLayer {\n    constructor(urls, options, hiRes = 'auto') {\n        let url, tileSizeMultiplicator;\n        const useHiResTiles = hiRes === 'auto' ? L.Browser.retina : hiRes;\n        const newOptions = L.extend({}, options);\n        if (useHiResTiles) {\n            url = urls[1];\n            tileSizeMultiplicator = 2;\n        } else {\n            tileSizeMultiplicator = 1;\n            url = urls[0];\n        }\n        if (options.retinaOptionsOverrides) {\n            L.extend(newOptions, options.retinaOptionsOverrides[useHiResTiles ? 1 : 0]);\n        }\n        super(url, newOptions);\n        this.urls = urls;\n        this.tileSizeMultiplicator = tileSizeMultiplicator;\n    }\n}\n\nexport {RetinaTileLayer};\n","import declination from './declination.json';\nimport {stringToArrayBuffer} from '~/lib/binary-strings';\n\nlet data;\n\nfunction mod(x, n) {\n    return ((x % n) + n) % n;\n}\n\nfunction loadData() {\n    const ar1 = new Uint8Array(stringToArrayBuffer(atob(declination.array)));\n    const ar2 = new Float32Array(ar1.length);\n    const scale = declination.valueScale;\n    const offset = declination.valueOffset;\n    for (let i = 0; i < ar1.length; i++) {\n        ar2[i] = ar1[i] / scale - offset;\n    }\n    return ar2;\n}\n\nfunction getArrayValue(row, col) {\n    if (row < 0 || col < 0 || col >= declination.colsCount || row >= declination.rowsCount) {\n        throw new Error(`Invalid col/row value col=${col} row=${row}`);\n    }\n    const ind = row * declination.colsCount + col;\n    if (ind >= data.length) {\n        throw new Error('Index value out of range');\n    }\n    return data[ind];\n}\n\nfunction getDeclination(lat, lon) {\n    if (lat < declination.minLat || lat > declination.maxLat) {\n        return null;\n    }\n    lon = mod(lon + 180, 360) - 180;\n    const row1 = Math.floor((lat - declination.minLat) / declination.step);\n    const row2 = row1 + 1;\n    const dlat = (lat - (row1 * declination.step + declination.minLat)) / declination.step;\n    let col1 = Math.floor((lon + 180) / declination.step);\n    let col2 = col1 + 1;\n    const dlon = (lon - (col1 * declination.step - 180)) / declination.step;\n    col1 %= declination.colsCount;\n    col2 %= declination.colsCount;\n    let a1 = getArrayValue(row1, col1);\n    let a2 = getArrayValue(row1, col2);\n    const v1 = a1 * (1 - dlon) + a2 * dlon;\n    if (row2 >= declination.rowsCount) {\n        return v1;\n    }\n    a1 = getArrayValue(row2, col1);\n    a2 = getArrayValue(row2, col2);\n    const v2 = a1 * (1 - dlon) + a2 * dlon;\n    const v = v1 * (1 - dlat) + v2 * dlat;\n    return v;\n}\n\ndata = loadData();\n\nexport {getDeclination};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from \"leaflet\";\n\nconst DragEvents = L.Evented.extend({\n        options: {\n            dragTolerance: 2,\n            dragButtons: [0],\n            stopOnLeave: false,\n        },\n\n        initialize: function(element, options) {\n            L.setOptions(this, options);\n            this.element = element;\n\n            this.dragButton = null;\n            this.startEvent = null;\n            this.prevEvent = null;\n            this.isDragging = false;\n\n            L.DomEvent.on(element, 'mousedown', this.onMouseDown, this);\n        },\n\n        onMouseDown: function(e) {\n            if (this.dragButton === null && this.options.dragButtons.includes(e.button)) {\n                this.dragButton = e.button;\n                this.startEvent = e;\n                this.prevEvent = e;\n                L.DomUtil.disableImageDrag();\n                L.DomUtil.disableTextSelection();\n                this._moveHandler = this.onMouseMove.bind(this);\n                document.addEventListener('mousemove', this._moveHandler, true);\n                L.DomEvent.on(document, 'mouseup', this.onMouseUp, this);\n                if (this.options.stopOnLeave) {\n                    L.DomEvent.on(this.element, 'mouseleave', this.onMouseLeave, this);\n                }\n            }\n        },\n\n        onMouseUp: function(e) {\n            if (this.dragButton === e.button) {\n                if (this.isDragging) {\n                    this.fireDragEvent('dragend', e);\n                } else {\n                    this.fire('click', {originalEvent: e, target: this.element});\n                }\n                this.finishDrag();\n            }\n        },\n\n        onMouseMove: function(e) {\n            var that = this;\n            function exceedsTolerance() {\n                var tolerance = that.options.dragTolerance;\n                return Math.abs(e.clientX - that.startEvent.clientX) > tolerance ||\n                    Math.abs(e.clientY - that.startEvent.clientY) > tolerance;\n            }\n\n            if (this.isDragging) {\n                this.fireDragEvent('drag', e);\n                this.prevEvent = e;\n            } else if (this.dragButton !== null && exceedsTolerance()) {\n                this.isDragging = true;\n                this.fireDragEvent('dragstart', this.startEvent);\n                this.fireDragEvent('drag', e);\n                this.prevEvent = e;\n            }\n        },\n\n        onMouseLeave: function(e) {\n            if (this.isDragging) {\n                this.fireDragEvent('dragend', e);\n                this.finishDrag();\n            }\n        },\n\n        fireDragEvent: function(type, originalEvent) {\n            const prevPos = L.point(this.prevEvent.clientX, this.prevEvent.clientY);\n            const pos = L.point(originalEvent.clientX, originalEvent.clientY);\n            const data = {\n                dragButton: this.dragButton,\n                originalEvent,\n                dragMovement: pos.subtract(prevPos) // e.movementX is not available in Safari\n            };\n            this.fire(type, data);\n        },\n\n        finishDrag: function() {\n            this.isDragging = false;\n            this.dragButton = null;\n            L.DomUtil.enableImageDrag();\n            L.DomUtil.enableTextSelection();\n            document.removeEventListener('mousemove', this._moveHandler, true);\n            L.DomEvent.off(document, 'mouseup', this.onMouseUp, this);\n            L.DomEvent.off(this.element, 'mouseleave', this.onMouseLeave, this);\n        }\n    }\n);\n\nexport {DragEvents};\n","function xmlGetNodeText(node) {\n    if (node) {\n        return Array.prototype.slice.call(node.childNodes)\n            .map(function(node) {\n                    return node.nodeValue;\n                }\n            )\n            .join('');\n    }\n    return null;\n}\n\nexport {xmlGetNodeText};\n","(function (GLOBAL) {\n    function decodeUTF8(s){\n        return decodeURIComponent(escape(s));\n    }\n\n    var JSUnzip = function (fileContents) {\n        this.fileContents = new JSUnzip.BigEndianBinaryStream(fileContents);\n    }\n    GLOBAL.JSUnzip = JSUnzip;\n    JSUnzip.MAGIC_NUMBER = 0x04034b50;\n\n    JSUnzip.prototype = {\n        readEntries: function () {\n            if (!this.isZipFile()) {\n                throw new Error(\"File is not a Zip file.\");\n            }\n\n            this.entries = [];\n            var e = new JSUnzip.ZipEntry(this.fileContents);\n            while (typeof(e.data) === \"string\") {\n                this.entries.push(e);\n                e = new JSUnzip.ZipEntry(this.fileContents);\n            }\n        },\n\n        isZipFile: function () {\n            return this.fileContents.getByteRangeAsNumber(0, 4) === JSUnzip.MAGIC_NUMBER;\n        }\n    }\n\n    JSUnzip.ZipEntry = function (binaryStream) {\n        this.signature          = binaryStream.getNextBytesAsNumber(4);\n        if (this.signature !== JSUnzip.MAGIC_NUMBER) {\n            return;\n        }\n\n        this.versionNeeded      = binaryStream.getNextBytesAsNumber(2);\n        this.bitFlag            = binaryStream.getNextBytesAsNumber(2);\n        this.compressionMethod  = binaryStream.getNextBytesAsNumber(2);\n        this.timeBlob           = binaryStream.getNextBytesAsNumber(4);\n\n        if (this.isEncrypted()) {\n            throw \"File contains encrypted entry. Not supported.\";\n        }\n\n\n        this.crc32              = binaryStream.getNextBytesAsNumber(4);\n        this.compressedSize     = binaryStream.getNextBytesAsNumber(4);\n        this.uncompressedSize   = binaryStream.getNextBytesAsNumber(4);\n\n        if (this.isUsingZip64()) {\n            throw \"File is using Zip64 (4gb+ file size). Not supported\";\n        }\n\n        this.fileNameLength     = binaryStream.getNextBytesAsNumber(2);\n        this.extraFieldLength   = binaryStream.getNextBytesAsNumber(2);\n\n        this.fileName  = binaryStream.getNextBytesAsString(this.fileNameLength);\n        this.extra     = binaryStream.getNextBytesAsString(this.extraFieldLength);\n        this.data      = binaryStream.getNextBytesAsString(this.compressedSize);\n\n        if (this.isUsingBit3TrailingDataDescriptor()) {\n            if (typeof(console) !== \"undefined\") {\n                console.log( \"File is using bit 3 trailing data descriptor. Not supported.\");\n            }\n            binaryStream.getNextBytesAsNumber(16);  //Skip the descriptor and move to beginning of next ZipEntry\n        }\n\n        if (this.isUsingUtf8()) {\n            this.fileName = decodeUTF8(this.fileName);\n        }\n\n    }\n\n    JSUnzip.ZipEntry.prototype = {\n        isEncrypted: function () {\n            return (this.bitFlag & 0x01) === 0x01;\n        },\n\n        isUsingUtf8: function () {\n            return (this.bitFlag & 0x0800) === 0x0800;\n        },\n\n        isUsingBit3TrailingDataDescriptor: function () {\n            return (this.bitFlag & 0x0008) === 0x0008;\n        },\n\n        isUsingZip64: function () {\n            return this.compressedSize === 0xFFFFFFFF ||\n                this.uncompressedSize === 0xFFFFFFFF;\n        }\n    }\n\n    JSUnzip.BigEndianBinaryStream = function (stream) {\n        this.stream = stream;\n        this.resetByteIndex();\n    }\n\n    JSUnzip.BigEndianBinaryStream.prototype = {\n        // The index of the current byte, used when we step through the byte\n        // with getNextBytesAs*.\n        resetByteIndex: function () {\n            this.currentByteIndex = 0;\n        },\n\n        getByteAt: function (index) {\n            return this.stream.charCodeAt(index);\n        },\n\n        getNextBytesAsNumber: function (steps) {\n            var res = this.getByteRangeAsNumber(this.currentByteIndex, steps);\n            this.currentByteIndex += steps;\n            return res;\n        },\n\n        getNextBytesAsString: function (steps) {\n            var res = this.getByteRangeAsString(this.currentByteIndex, steps);\n            this.currentByteIndex += steps;\n            return res;\n        },\n\n        // Big endian, so we're going backwards.\n        getByteRangeAsNumber: function (index, steps) {\n            var result = 0;\n            var i = index + steps - 1;\n            while (i >= index) {\n                result = (result << 8) + this.getByteAt(i);\n                i--;\n            }\n            return result;\n        },\n\n        getByteRangeAsString: function (index, steps) {\n            var result = \"\";\n            var max = index + steps;\n            var i = index;\n            while (i < max) {\n                var charCode = this.getByteAt(i);\n                result += String.fromCharCode(charCode);\n                // Accounting for multi-byte strings.\n                max -= Math.floor(charCode / 0x100);\n                i++;\n            }\n            return result;\n        }\n    }\n}(this));\n","import tynyInflate from 'tiny-inflate';\nimport {stringToArrayBuffer, arrayBufferToString} from '~/lib/binary-strings';\n\nfunction jsInflate(compressed, originalSize) {\n    if (originalSize === 0) {\n        return '';\n    }\n    const out = new Uint8Array(originalSize);\n    tynyInflate(new Uint8Array(stringToArrayBuffer(compressed)), out);\n    return arrayBufferToString(out);\n}\n\nexport default jsInflate;\n","function decode866(s) {\n    var c, i,\n        s2 = [];\n    for (i = 0; i < s.length; i++) {\n        c = s.charCodeAt(i);\n        if (c >= 128 && c <= 175) {\n            c += (0x410 - 128);\n        } else if (c >= 224 && c <= 239) {\n            c += (0x440 - 224);\n        } else if (c === 240) {\n            c = 0x0401;\n        } else if (c === 241) {\n            c = 0x0451;\n        }\n        s2.push(String.fromCharCode(c));\n    }\n    return s2.join('');\n}\n\nfunction decodeCP1251(s) {\n    var c, i,\n        s2 = [];\n    for (i = 0; i < s.length; i++) {\n        c = s.charCodeAt(i);\n        if (c >= 192 && c <= 255) {\n            c += (0x410 - 192);\n        } else if (c === 168) {\n            c = 0x0401;\n        } else if (c === 184) {\n            c = 0x0451;\n        }\n        s2.push(String.fromCharCode(c));\n    }\n    return s2.join('');\n}\n\nexport {decode866, decodeCP1251};\n\n","import BaseService from '../baseService';\nimport {parseNktkSequence, parseTrackUrlData, parseNktkFragment} from '../../parsers/nktk';\nimport config from '~/config';\nimport {parseHashParams} from '~/lib/leaflet.hashState/hashState';\nimport loadFromUrl from '../../loadFromUrl';\nimport loadTracksFromJson from './loadTracksFromJson';\nimport {fetch} from '~/lib/xhr-promise';\n\nfunction flattenArray(ar) {\n    const res = [];\n    for (const it of ar) {\n        res.push(...it);\n    }\n    return res;\n}\n\nfunction parsePointFromHashValues(values) {\n    if (values.length < 2) {\n        return [{name: 'Point in url', error: 'CORRUPT'}];\n    }\n    const lat = parseFloat(values[0]);\n    const lng = parseFloat(values[1]);\n    if (isNaN(lat) || isNaN(lng) || lat < -90 || lat > 90 || lng < -180 || lng > 180) {\n        return [{name: 'Point in url', error: 'CORRUPT'}];\n    }\n    const name = ((values[2] || '').trim()) || 'Point';\n    return [{name, points: [{name, lat, lng}]}];\n}\n\nclass NakarteTrack extends BaseService {\n    isOurUrl() {\n        return this.origUrl.indexOf('track://') > -1;\n    }\n\n    requestOptions() {\n        return [];\n    }\n\n    parseResponse() {\n        const i = this.origUrl.indexOf('track://');\n        return parseTrackUrlData(this.origUrl.substring(i + 8));\n    }\n}\n\nclass NakarteUrlLoader {\n    constructor() {\n        this.loaders = {\n            nktk: this.loadFromTextEncodedTrack,\n            nktl: this.loadFromTextEncodedTrackId,\n            nktu: this.loadFromUrlencodedUrls,\n            nktp: this.loadPoint,\n            nktj: this.loadFromJSON\n        };\n    }\n\n    paramNames() {\n        return Object.keys(this.loaders);\n    }\n\n    async geoData(paramName, values) {\n        const loader = this.loaders[paramName];\n        return loader.call(this, values);\n    }\n\n    async loadFromTextEncodedTrack(values) {\n        return flattenArray(values.map(parseNktkFragment));\n    }\n\n    async loadFromTextEncodedTrackId(values) {\n        const requests = values.map((trackId) =>\n            fetch( `${config.tracksStorageServer}/${trackId}`, {\n                responseType: 'binarystring',\n                method: 'POST',\n                withCredentials: false\n            } )\n        );\n        let responses;\n        try {\n            responses = await Promise.all(requests);\n        } catch (e) {\n            return [{name: 'Track from nakarte server', error: 'NETWORK'}];\n        }\n        return flattenArray(responses.map((r) => parseNktkSequence(r.responseBinaryText, 'shared')));\n    }\n\n    async loadFromJSON(values) {\n        return flattenArray(await Promise.all(values.map(loadTracksFromJson)));\n    }\n\n    async loadFromUrlencodedUrls(values) {\n        return flattenArray(await Promise.all(values.map(decodeURIComponent).map(loadFromUrl)));\n    }\n\n    async loadPoint(values) {\n        return parsePointFromHashValues(values.map(decodeURIComponent));\n    }\n}\n\nclass NakarteUrl {\n    constructor(url) {\n        const paramNames = new NakarteUrlLoader().paramNames();\n        this._params = Object.entries(parseHashParams(url))\n            .filter(([name]) => paramNames.includes(name));\n    }\n\n    isOurUrl() {\n        return this._params.length > 0;\n    }\n\n    async geoData() {\n        const promises = this._params.map(([paramName, value]) => new NakarteUrlLoader().geoData(paramName, value));\n        return flattenArray(await Promise.all(promises));\n    }\n}\n\nexport {NakarteTrack, NakarteUrl, NakarteUrlLoader};\n","function encode(s) {\n    return (btoa(s)\n            .replace(/\\+/ug, '-')\n            .replace(/\\//ug, '_')\n        // .replace(/=+$/, '')\n    );\n}\n\nfunction decode(s) {\n    var decoded;\n    s = s\n        .replace(/[\\n\\r \\t]/ug, '')\n        .replace(/-/ug, '+')\n        .replace(/_/ug, '/');\n    try {\n        decoded = atob(s);\n    } catch (e) {\n        // will return null for malformed data\n    }\n    if (decoded && decoded.length) {\n        return decoded;\n    }\n    return null;\n}\n\nexport {encode, decode};\n","import L from 'leaflet';\nimport './elevation-profile.css';\nimport {ElevationProvider} from '~/lib/elevations';\nimport '~/lib/leaflet.control.commons';\nimport {notify} from '~/lib/notifications';\nimport * as logging from '~/lib/logging';\nimport {DragEvents} from '~/lib/leaflet.events.drag';\nimport config from '~/config';\n\nfunction calcSamplingInterval(length) {\n    var targetPointsN = 2000;\n    var maxPointsN = 9999;\n    var samplingIntgerval = length / targetPointsN;\n    if (samplingIntgerval < 10) {\n        samplingIntgerval = 10;\n    }\n    if (samplingIntgerval > 50) {\n        samplingIntgerval = 50;\n    }\n    if (length / samplingIntgerval > maxPointsN) {\n        samplingIntgerval = length / maxPointsN;\n    }\n    return samplingIntgerval;\n}\n\nfunction createSvg(tagName, attributes, parent) {\n    var element = document.createElementNS('http://www.w3.org/2000/svg', tagName);\n    if (attributes) {\n        var keys = Object.keys(attributes),\n            key, value;\n        for (var i = 0; i < keys.length; i++) {\n            key = keys[i];\n            value = attributes[key];\n            element.setAttribute(key, value);\n        }\n    }\n    if (parent) {\n        parent.appendChild(element);\n    }\n    return element;\n}\n\nfunction pointOnSegmentAtDistance(p1, p2, dist) {\n    // FIXME: we should place markers along projected line to avoid transformation distortions\n    var q = dist / p1.distanceTo(p2),\n        x = p1.lng + (p2.lng - p1.lng) * q,\n        y = p1.lat + (p2.lat - p1.lat) * q;\n    return L.latLng(y, x);\n}\n\nfunction gradientToAngle(g) {\n    return Math.round(Math.atan(g) * 180 / Math.PI);\n}\n\nfunction pathRegularSamples(latlngs, step) {\n    if (!latlngs.length) {\n        return [];\n    }\n    var samples = [],\n        lastSampleDist = 0,\n        lastPointDistance = 0,\n        nextPointDistance = 0,\n        segmentLength, i;\n\n    samples.push(latlngs[0]);\n    for (i = 1; i < latlngs.length; i++) {\n        segmentLength = latlngs[i].distanceTo(latlngs[i - 1]);\n        nextPointDistance = lastPointDistance + segmentLength;\n        if (nextPointDistance >= lastSampleDist + step) {\n            while (lastSampleDist + step <= nextPointDistance) {\n                lastSampleDist += step;\n                samples.push(\n                    pointOnSegmentAtDistance(latlngs[i - 1], latlngs[i], lastSampleDist - lastPointDistance)\n                );\n            }\n        }\n        lastPointDistance = nextPointDistance;\n    }\n    if (samples.length < 2) {\n        samples.push(latlngs[latlngs.length - 1]);\n    }\n    return samples;\n}\n\nconst ElevationProfile = L.Class.extend({\n        options: {\n            samplingInterval: 50,\n            sightLine: false\n        },\n\n        includes: L.Evented,\n\n        initialize: function(map, latlngs, options) {\n            L.setOptions(this, options);\n            this.path = latlngs;\n            var samples = this.samples = pathRegularSamples(this.path, this.options.samplingInterval);\n            samples = samples.map((latlng) => latlng.wrap());\n            if (!samples.length) {\n                notify('Track is empty');\n                return;\n            }\n            let crimea_bounds = L.latLngBounds( L.latLng( config.crimeaBounds.topLeft ), L.latLng( config.crimeaBounds.bottomRight ) );\n            for (let i=0; i<samples.length; i+=50) {\n                if ( ! crimea_bounds.contains( L.latLng( samples[i] ) ) ) {\n                    notify( 'Трэк частично или полностью находится за пределами Крыма. Построение профиля высоты работает только в пределах полуострова.' );\n                    return false;\n                }\n            }\n\n            let that = this;\n            this.horizZoom = 1;\n            this.dragStart = null;\n            new ElevationProvider().get(samples)\n                .then(function(values) {\n                        that.values = values;\n                        that._addTo(map);\n                    }\n                )\n                .catch((e) => {\n                    logging.captureException(e, 'error getting elevation');\n                    notify(`Failed to get elevation data: ${e.message}`);\n                });\n            this.values = null;\n        },\n\n        _onWindowResize: function() {\n            this._resizeGraph();\n        },\n\n        _resizeGraph: function() {\n            const newSvgWidth = this.drawingContainer.clientWidth * this.horizZoom;\n            if (this.svgWidth < this.drawingContainer.clientWidth) {\n                this.svgWidth = newSvgWidth;\n                this.svg.setAttribute('width', this.svgWidth + 'px');\n                this.updateGraph();\n                this.updateGraphSelection();\n            }\n        },\n\n        _addTo: function(map) {\n            this._map = map;\n            var container = this._container = L.DomUtil.create('div', 'elevation-profile-container');\n            L.Control.prototype._stopContainerEvents.call(this);\n            this._map._controlContainer.appendChild(container);\n            this.setupContainerLayout();\n            this.updateGraph();\n            const icon = L.divIcon({\n                    className: 'elevation-profile-marker',\n                    html:\n                        '<div class=\"elevation-profile-marker-icon\"></div>' +\n                        '<div class=\"elevation-profile-marker-label\"></div>'\n                }\n            );\n            this.trackMarker = L.marker([1000, 0], {interactive: false, icon: icon});\n            this.polyline = L.polyline(this.path, {weight: 30, opacity: 0}).addTo(map);\n            this.polyline.on('mousemove', this.onLineMouseMove, this);\n            this.polyline.on('mouseover', this.onLineMouseEnter, this);\n            this.polyline.on('mouseout', this.onLineMouseLeave, this);\n            this.polyLineSelection = L.polyline([], {weight: 20, opacity: 0.5, color: 'yellow', lineCap: 'butt'});\n            return this;\n        },\n\n        setupContainerLayout: function() {\n            var horizZoom = this.horizZoom = 1;\n            var container = this._container;\n            this.propsContainer = L.DomUtil.create('div', 'elevation-profile-properties', container);\n            this.leftAxisLables = L.DomUtil.create('div', 'elevation-profile-left-axis', container);\n            this.closeButton = L.DomUtil.create('div', 'elevation-profile-close', container);\n            L.DomEvent.on(this.closeButton, 'click', this.onCloseButtonClick, this);\n            this.drawingContainer = L.DomUtil.create('div', 'elevation-profile-drawingContainer', container);\n            this.graphCursor = L.DomUtil.create('div', 'elevation-profile-cursor elevation-profile-cursor-hidden',\n                this.drawingContainer\n            );\n            this.graphCursorLabel =\n                L.DomUtil.create('div', 'elevation-profile-cursor-label elevation-profile-cursor-hidden',\n                    this.drawingContainer\n                );\n            this.graphSelection = L.DomUtil.create('div', 'elevation-profile-selection elevation-profile-cursor-hidden',\n                this.drawingContainer\n            );\n            var svgWidth = this.svgWidth = this.drawingContainer.clientWidth * horizZoom,\n                svgHeight = this.svgHeight = this.drawingContainer.clientHeight;\n            var svg = this.svg = createSvg('svg', {width: svgWidth, height: svgHeight}, this.drawingContainer);\n            L.DomEvent.on(svg, 'mousemove', this.onSvgMouseMove, this);\n            // We should handle mouseenter event, but due to a\n            // bug in Chrome (https://bugs.chromium.org/p/chromium/issues/detail?id=846738)\n            // this event is emitted while resizing window by dragging right window frame\n            // which causes cursor to appeat while resizing\n            L.DomEvent.on(svg, 'mousemove', this.onSvgEnter, this);\n            L.DomEvent.on(svg, 'mouseleave', this.onSvgLeave, this);\n            L.DomEvent.on(svg, 'mousewheel', this.onSvgMouseWheel, this);\n            this.svgDragEvents = new DragEvents(this.svg, {dragButtons: [0, 2], stopOnLeave: true});\n            this.svgDragEvents.on('dragstart', this.onSvgDragStart, this);\n            this.svgDragEvents.on('dragend', this.onSvgDragEnd, this);\n            this.svgDragEvents.on('drag', this.onSvgDrag, this);\n            this.svgDragEvents.on('click', this.onSvgClick, this);\n            L.DomEvent.on(svg, 'dblclick', this.onSvgDblClick, this);\n            L.DomEvent.on(window, 'resize', this._onWindowResize, this);\n        },\n\n        removeFrom: function(map) {\n            if (this.abortLoading) {\n                this.abortLoading();\n            }\n            if (!this._map) {\n                return this;\n            }\n            this._map._controlContainer.removeChild(this._container);\n            map.removeLayer(this.polyline);\n            map.removeLayer(this.trackMarker);\n            map.removeLayer(this.polyLineSelection);\n            L.DomEvent.off(window, 'resize', this._onWindowResize, this);\n            this._map = null;\n            return this;\n        },\n\n        onSvgDragStart: function(e) {\n            if (e.dragButton === 0) {\n                // FIXME: restore hiding when we make display of selection on map\n                // this.cursorHide();\n                this.polyLineSelection.addTo(this._map).bringToBack();\n                this.selStartIndex = this.roundedSampleIndexFromMouseEvent(e);\n            }\n        },\n\n        graphContainerOffsetFromMouseEvent: function(e) {\n            if (e.originalEvent) {\n                e = e.originalEvent;\n            }\n            let x = e.clientX - this.svg.getBoundingClientRect().left;\n            if (x < 0) {\n                x = 0;\n            }\n            if (x > this.svgWidth - 1) {\n                x = this.svgWidth - 1;\n            }\n            return x;\n        },\n\n        sampleIndexFromMouseEvent: function(e) {\n            const x = this.graphContainerOffsetFromMouseEvent(e);\n            return x / (this.svgWidth - 1) * (this.values.length - 1);\n        },\n\n        roundedSampleIndexFromMouseEvent: function(e) {\n            return Math.round(this.sampleIndexFromMouseEvent(e));\n        },\n\n        setTrackMarkerLabel: function(label) {\n            const icon = this.trackMarker._icon;\n            if (!icon) {\n                return;\n            }\n            icon.getElementsByClassName('elevation-profile-marker-label')[0].innerHTML = label;\n        },\n\n        setGraphSelection: function(cursorIndex) {\n            this.selMinInd = Math.min(cursorIndex, this.selStartIndex);\n            this.selMaxInd = Math.max(cursorIndex, this.selStartIndex);\n\n            if (this.selMinInd < 0) {\n                this.selMinInd = 0;\n            }\n            if (this.selMaxInd > this.values.length - 1) {\n                this.selMaxInd = this.values.length - 1;\n            }\n            this.updateGraphSelection();\n            L.DomUtil.removeClass(this.graphSelection, 'elevation-profile-cursor-hidden');\n        },\n\n        updateGraphSelection: function() {\n            const selStart = this.selMinInd * (this.svgWidth - 1) / (this.values.length - 1);\n            const selEnd = this.selMaxInd * (this.svgWidth - 1) / (this.values.length - 1);\n            this.graphSelection.style.left = selStart + 'px';\n            this.graphSelection.style.width = (selEnd - selStart) + 'px';\n        },\n\n        onSvgDragEnd: function(e) {\n            if (e.dragButton === 0) {\n                this.cursorShow();\n                this.setGraphSelection(this.roundedSampleIndexFromMouseEvent(e));\n                var stats = this.calcProfileStats(this.values.slice(this.selMinInd, this.selMaxInd + 1));\n                this.updatePropsDisplay(stats);\n                L.DomUtil.addClass(this.propsContainer, 'elevation-profile-properties-selected');\n            }\n            if (e.dragButton === 2) {\n                this.drawingContainer.scrollLeft -= e.dragMovement.x;\n            }\n        },\n\n        onSvgDrag: function(e) {\n            if (e.dragButton === 0) {\n                this.setGraphSelection(this.roundedSampleIndexFromMouseEvent(e));\n                this.polyLineSelection.setLatLngs(this.samples.slice(this.selMinInd, this.selMaxInd + 1));\n            }\n            if (e.dragButton === 2) {\n                this.drawingContainer.scrollLeft -= e.dragMovement.x;\n            }\n        },\n\n        onSvgClick: function(e) {\n            const button = e.originalEvent.button;\n            if (button === 0) {\n                this.dragStart = null;\n                L.DomUtil.addClass(this.graphSelection, 'elevation-profile-cursor-hidden');\n                L.DomUtil.removeClass(this.propsContainer, 'elevation-profile-properties-selected');\n                this._map.removeLayer(this.polyLineSelection);\n                if (this.stats) {\n                    this.updatePropsDisplay(this.stats);\n                }\n            }\n            if (button === 2) {\n                this.setMapPositionAtIndex(this.roundedSampleIndexFromMouseEvent(e));\n            }\n        },\n\n        onSvgDblClick: function(e) {\n            this.setMapPositionAtIndex(this.roundedSampleIndexFromMouseEvent(e));\n        },\n\n        setMapPositionAtIndex: function(ind) {\n            var latlng = this.samples[ind];\n            if (latlng) {\n                this._map.panTo(latlng);\n            }\n        },\n\n        onSvgMouseWheel: function(e) {\n            var oldHorizZoom = this.horizZoom;\n            this.horizZoom += L.DomEvent.getWheelDelta(e) > 0 ? 1 : -1;\n            if (this.horizZoom < 1) {\n                this.horizZoom = 1;\n            }\n            if (this.horizZoom > 10) {\n                this.horizZoom = 10;\n            }\n\n            var ind = this.sampleIndexFromMouseEvent(e);\n\n            var newScrollLeft = this.drawingContainer.scrollLeft +\n                this.graphContainerOffsetFromMouseEvent(e) * (this.horizZoom / oldHorizZoom - 1);\n            if (newScrollLeft < 0) {\n                newScrollLeft = 0;\n            }\n\n            this.svgWidth = this.drawingContainer.clientWidth * this.horizZoom;\n            this.svg.setAttribute('width', this.svgWidth + 'px');\n            this.setupGraph();\n            if (newScrollLeft > this.svgWidth - this.drawingContainer.clientWidth) {\n                newScrollLeft = this.svgWidth - this.drawingContainer.clientWidth;\n            }\n            this.drawingContainer.scrollLeft = newScrollLeft;\n\n            this.cursorHide();\n            this.setCursorPosition(ind);\n            this.cursorShow();\n            this.updateGraphSelection();\n        },\n\n        updateGraph: function() {\n            if (!this._map || !this.values) {\n                return;\n            }\n\n            this.stats = this.calcProfileStats(this.values);\n            this.updatePropsDisplay(this.stats);\n            this.setupGraph();\n        },\n\n        updatePropsDisplay: function(stats) {\n            if (!this._map) {\n                return;\n            }\n            let d;\n            if (stats.noData) {\n                d = {\n                    maxElev: '-',\n                    minElev: '-',\n                    startElev: '-',\n                    endElev: '-',\n                    change: '-',\n                    ascentAngleStr: '-',\n                    descentAngleStr: '-',\n                    ascent: '-',\n                    descent: '-',\n                    startApprox: '',\n                    endApprox: '',\n                    approx: '',\n                    incomplete: 'No elevation data',\n                };\n            } else {\n                d = {\n                    maxElev: Math.round(stats.max),\n                    minElev: Math.round(stats.min),\n                    startElev: Math.round(stats.start),\n                    endElev: Math.round(stats.end),\n                    change: Math.round(stats.finalAscent),\n                    ascentAngleStr: isNaN(stats.angleAvgAscent) ? '-' : L.Util.template('{avg} / {max}&deg;',\n                            {avg: stats.angleAvgAscent, max: stats.angleMaxAscent}\n                        ),\n                    descentAngleStr: isNaN(stats.angleAvgDescent) ? '-' : L.Util.template('{avg} / {max}&deg;',\n                            {avg: stats.angleAvgDescent, max: stats.angleMaxDescent}\n                        ),\n                    ascent: Math.round(stats.ascent),\n                    descent: Math.round(stats.descent),\n                    dist: (stats.distance / 1000).toFixed(1),\n                    startApprox: stats.dataLostAtStart > 0.02 ? '~ ' : '',\n                    endApprox: stats.dataLostAtEnd > 0.02 ? '~ ' : '',\n                    approx: stats.dataLost > 0.02 ? '~ ' : '',\n                    incomplete: stats.dataLost > 0.02 ? 'Some elevation data missing' : '',\n                };\n            }\n            d.dist = (stats.distance / 1000).toFixed(1);\n\n            this.propsContainer.innerHTML = `\n                <table>\n                <tr><td>Максимальная высота:</td><td>${d.maxElev}</td></tr>\n                <tr><td>Минимальная высота:</td><td>${d.minElev}</td></tr>\n                <tr class=\"start-group\"><td>Высота в начале:</td><td>${d.startApprox}${d.startElev}</td></tr>\n                <tr><td>Высота в конце:</td><td>${d.endApprox}${d.endElev}</td></tr>\n                <tr><td>Разница:</td><td>${d.startApprox || d.endApprox}${d.change}</td></tr>\n                <tr class=\"start-group\"><td>Сред. / Макс. наклон подъёма:</td><td>${d.ascentAngleStr}</td></tr>\n                <tr><td>Сред. / Макс. наклон спуска:</td><td>${d.descentAngleStr}</td></tr>\n                <tr class=\"start-group\"><td>Набор высоты:</td><td>${d.approx}${d.ascent}</td></tr>\n                <tr><td>Сброс высоты:</td><td>${d.approx}${d.descent}</td></tr>\n                <tr class=\"start-group\"><td>Дистанция:</td><td>${d.dist} km</td></tr>\n                <tr><td colspan=\"2\" style=\"text-align: center\">${d.incomplete}</td></tr>\n                </table>\n                `;\n        },\n\n        calcGridValues: function(minValue, maxValue) {\n            var ticksNs = [3, 4, 5],\n                tickSteps = [1, 2, 5, 10, 20, 50, 100, 200, 500, 1000, 2000, 5000, 10000],\n                ticks = [],\n                i, j, k, ticksN, tickStep, tick1, tick2,\n                matchFound = false;\n\n            for (i = 0; i < tickSteps.length; i++) {\n                tickStep = tickSteps[i];\n                for (j = 0; j < ticksNs.length; j++) {\n                    ticksN = ticksNs[j];\n                    tick1 = Math.floor(minValue / tickStep);\n                    tick2 = Math.ceil(maxValue / tickStep);\n                    if ((tick2 - tick1) < ticksN) {\n                        matchFound = true;\n                        break;\n                    }\n                }\n                if (matchFound) {\n                    break;\n                }\n            }\n            for (k = tick1; k < tick1 + ticksN; k++) {\n                ticks.push(k * tickStep);\n            }\n            return ticks;\n        },\n\n        filterElevations: function(values, tolerance) {\n            var filtered = values.slice(0);\n            if (filtered.length < 3) {\n                return filtered;\n            }\n            var scanStart, scanEnd, job, linearValue, linearDelta, maxError, maxErrorInd, i, error;\n            var queue = [[0, filtered.length - 1]];\n            while (queue.length) {\n                job = queue.pop();\n                scanStart = job[0];\n                scanEnd = job[1];\n                linearValue = filtered[scanStart];\n                linearDelta = (filtered[scanEnd] - filtered[scanStart]) / (scanEnd - scanStart);\n                maxError = null;\n                maxErrorInd = null;\n                for (i = scanStart + 1; i < scanEnd; i++) {\n                    linearValue += linearDelta;\n                    if (filtered[i] === null) {\n                        continue;\n                    }\n                    error = Math.abs(filtered[i] - linearValue);\n                    if (error === null || error > maxError) {\n                        maxError = error;\n                        maxErrorInd = i;\n                    }\n                }\n                if (maxError > tolerance) {\n                    if (scanEnd > scanStart + 2) {\n                        queue.push([scanStart, maxErrorInd]);\n                        queue.push([maxErrorInd, scanEnd]);\n                    }\n                } else {\n                    filtered.splice(scanStart + 1, scanEnd - scanStart - 1);\n                }\n            }\n            return filtered;\n        },\n\n        calcProfileStats: function(values) {\n            const stats = {\n                distance: (values.length - 1) * this.options.samplingInterval\n            };\n            const notNullValues = values.filter((value) => value !== null);\n            if (notNullValues.length === 0) {\n                stats.noData = true;\n                return stats;\n            }\n            stats.min = Math.min(...notNullValues);\n            stats.max = Math.max(...notNullValues);\n            let firstNotNullIndex = true,\n                lastNotNullIndex = true,\n                firstNotNullValue,\n                lastNotNullValue;\n            for (let i = 0; i < values.length; i++) {\n                let value = values[i];\n                if (value !== null) {\n                    firstNotNullValue = value;\n                    firstNotNullIndex = i;\n                    break;\n                }\n            }\n            for (let i = values.length - 1; i >= 0; i--) {\n                let value = values[i];\n                if (value !== null) {\n                    lastNotNullValue = value;\n                    lastNotNullIndex = i;\n                    break;\n                }\n            }\n            stats.finalAscent = lastNotNullValue - firstNotNullValue;\n\n            const ascents = [],\n                descents = [];\n            let prevNotNullValue = values[firstNotNullIndex],\n                prevNotNullIndex = firstNotNullIndex;\n            for (let i = firstNotNullIndex + 1; i <= lastNotNullIndex; i++) {\n                let value = values[i];\n                if (value === null) {\n                    continue;\n                }\n                let length = i - prevNotNullIndex;\n                let gradient = (value - prevNotNullValue) / length;\n                if (gradient > 0) {\n                    for (let j = 0; j < length; j++) {\n                        ascents.push(gradient);\n                    }\n                } else if (gradient < 0) {\n                    for (let j = 0; j < length; j++) {\n                        descents.push(-gradient);\n                    }\n                }\n                prevNotNullIndex = i;\n                prevNotNullValue = value;\n            }\n            function sum(a, b) {\n                return a + b;\n            }\n            if (ascents.length !== 0) {\n                stats.gradientAvgAscent = ascents.reduce(sum, 0) / ascents.length / this.options.samplingInterval;\n                stats.gradientMinAscent = Math.min(...ascents) / this.options.samplingInterval;\n                stats.gradientMaxAscent = Math.max(...ascents) / this.options.samplingInterval;\n                stats.angleAvgAscent = gradientToAngle(stats.gradientAvgAscent);\n                stats.angleMinAscent = gradientToAngle(stats.gradientMinAscent);\n                stats.angleMaxAscent = gradientToAngle(stats.gradientMaxAscent);\n            }\n            if (descents.length !== 0) {\n                stats.gradientAvgDescent = descents.reduce(sum, 0) / descents.length / this.options.samplingInterval;\n                stats.gradientMinDescent = Math.min(...descents) / this.options.samplingInterval;\n                stats.gradientMaxDescent = Math.max(...descents) / this.options.samplingInterval;\n                stats.angleAvgDescent = gradientToAngle(stats.gradientAvgDescent);\n                stats.angleMinDescent = gradientToAngle(stats.gradientMinDescent);\n                stats.angleMaxDescent = gradientToAngle(stats.gradientMaxDescent);\n            }\n\n            stats.start = firstNotNullValue;\n            stats.end = lastNotNullValue;\n            stats.distance = (values.length - 1) * this.options.samplingInterval;\n            stats.dataLostAtStart = firstNotNullIndex / values.length;\n            stats.dataLostAtEnd = 1 - lastNotNullIndex / (values.length - 1);\n            stats.dataLost = 1 - notNullValues.length / values.length;\n\n            const filterTolerance = 5;\n            const filtered = this.filterElevations(values.slice(firstNotNullIndex, lastNotNullIndex), filterTolerance);\n            let ascent = 0,\n                descent = 0,\n                delta;\n            for (let i = 1; i < filtered.length; i++) {\n                delta = filtered[i] - filtered[i - 1];\n                if (delta < 0) {\n                    descent += -delta;\n                } else {\n                    ascent += delta;\n                }\n            }\n            stats.ascent = ascent;\n            stats.descent = descent;\n\n            return stats;\n        },\n\n        setCursorPosition: function(ind) {\n            if (!this._map || !this.values) {\n                return;\n            }\n            const samplingInterval = this.options.samplingInterval;\n            const distanceKm = samplingInterval * ind / 1000;\n            const distanceStr = `${distanceKm.toFixed(2)} km`;\n            const sample1 = this.values[Math.ceil(ind)];\n            const sample2 = this.values[Math.floor(ind)];\n            let angleStr;\n            if (sample1 !== null && sample2 !== null) {\n                const gradient = (sample2 - sample1) / samplingInterval;\n                angleStr = `${Math.round(Math.atan(gradient) * 180 / Math.PI)}&deg`;\n            } else {\n                angleStr = '-';\n            }\n\n            const x = Math.round(ind / (this.values.length - 1) * (this.svgWidth - 1));\n            const indInt = Math.round(ind);\n            let elevation = this.values[indInt];\n            if (elevation === null) {\n                elevation = sample1;\n            }\n            if (elevation === null) {\n                elevation = sample2;\n            }\n            const elevationStr = (elevation === null) ? '-' : `${elevation} m`;\n\n            const cursorLabel = `${elevationStr}<br>${distanceStr}<br>${angleStr}`;\n\n            this.graphCursorLabel.innerHTML = cursorLabel;\n\n            this.graphCursor.style.left = x + 'px';\n            this.graphCursorLabel.style.left = x + 'px';\n            if (this.drawingContainer.getBoundingClientRect().left - this.drawingContainer.scrollLeft + x +\n                this.graphCursorLabel.offsetWidth >= this.drawingContainer.getBoundingClientRect().right) {\n                L.DomUtil.addClass(this.graphCursorLabel, 'elevation-profile-cursor-label-left');\n            } else {\n                L.DomUtil.removeClass(this.graphCursorLabel, 'elevation-profile-cursor-label-left');\n            }\n\n            let markerPos;\n            if (ind <= 0) {\n                markerPos = this.samples[0];\n            } else if (ind >= this.samples.length - 1) {\n                markerPos = this.samples[this.samples.length - 1];\n            } else {\n                const p1 = this.samples[Math.floor(ind)],\n                    p2 = this.samples[Math.ceil(ind)],\n                    indFrac = ind - Math.floor(ind);\n                markerPos = [p1.lat + (p2.lat - p1.lat) * indFrac, p1.lng + (p2.lng - p1.lng) * indFrac];\n            }\n            this.trackMarker.setLatLng(markerPos);\n\n            this.setTrackMarkerLabel(cursorLabel);\n        },\n\n        onSvgMouseMove: function(e) {\n            if (!this.values) {\n                return;\n            }\n            this.setCursorPosition(this.sampleIndexFromMouseEvent(e));\n        },\n\n        cursorShow: function() {\n            L.DomUtil.removeClass(this.graphCursor, 'elevation-profile-cursor-hidden');\n            L.DomUtil.removeClass(this.graphCursorLabel, 'elevation-profile-cursor-hidden');\n            this._map.addLayer(this.trackMarker);\n        },\n\n        cursorHide: function() {\n            L.DomUtil.addClass(this.graphCursor, 'elevation-profile-cursor-hidden');\n            L.DomUtil.addClass(this.graphCursorLabel, 'elevation-profile-cursor-hidden');\n            this._map.removeLayer(this.trackMarker);\n        },\n\n        onSvgEnter: function() {\n            this.cursorShow();\n        },\n\n        onSvgLeave: function() {\n            this.cursorHide();\n        },\n\n        onLineMouseEnter: function() {\n            this.cursorShow();\n        },\n\n        onLineMouseLeave: function() {\n            this.cursorHide();\n        },\n\n        onLineMouseMove: function(e) {\n            function sqrDist(latlng1, latlng2) {\n                var dx = (latlng1.lng - latlng2.lng);\n                var dy = (latlng1.lat - latlng2.lat);\n                return dx * dx + dy * dy;\n            }\n\n            var nearestInd = null,\n                ind,\n                minDist = null,\n                mouseLatlng = e.latlng,\n                i, sampleLatlng, dist, di;\n            let nextDist,\n                nextSampleDist,\n                prevDist,\n                prevSampleDist;\n            for (i = 0; i < this.samples.length; i++) {\n                sampleLatlng = this.samples[i];\n                dist = sqrDist(sampleLatlng, mouseLatlng);\n                if (nearestInd === null || dist < minDist) {\n                    nearestInd = i;\n                    minDist = dist;\n                }\n            }\n\n            if (nearestInd !== null) {\n                ind = nearestInd;\n                if (nearestInd > 0) {\n                    prevDist = sqrDist(mouseLatlng, this.samples[nearestInd - 1]);\n                    prevSampleDist = sqrDist(this.samples[nearestInd], this.samples[nearestInd - 1]);\n                }\n                if (nearestInd < this.samples.length - 1) {\n                    nextDist = sqrDist(mouseLatlng, this.samples[nearestInd + 1]);\n                    nextSampleDist = sqrDist(this.samples[nearestInd], this.samples[nearestInd + 1]);\n                }\n\n                if (nearestInd === 0) {\n                    if (nextDist < minDist + nextSampleDist) {\n                        di = (minDist - nextDist) / 2 / nextSampleDist + 1 / 2;\n                    } else {\n                        di = 0.001;\n                    }\n                } else if (nearestInd === this.samples.length - 1) {\n                    if (prevDist < minDist + prevSampleDist) {\n                        di = -((minDist - prevDist) / 2 / prevSampleDist + 1 / 2);\n                    } else {\n                        di = -0.001;\n                    }\n                } else {\n                    if (prevDist < nextDist) {\n                        di = -((minDist - prevDist) / 2 / prevSampleDist + 1 / 2);\n                    } else {\n                        di = (minDist - nextDist) / 2 / nextSampleDist + 1 / 2;\n                    }\n                }\n                if (di < -1) {\n                    di = -1;\n                }\n                if (di > 1) {\n                    di = 1;\n                }\n                this.setCursorPosition(ind + di);\n            }\n        },\n\n        setupGraph: function() {\n            if (!this._map || !this.values) {\n                return;\n            }\n\n            while (this.svg.hasChildNodes()) {\n                this.svg.removeChild(this.svg.lastChild);\n            }\n            while (this.leftAxisLables.hasChildNodes()) {\n                this.leftAxisLables.removeChild(this.leftAxisLables.lastChild);\n            }\n\n            var maxValue = Math.max.apply(null, this.values),\n                minValue = Math.min.apply(null, this.values),\n                svg = this.svg,\n                path, i, horizStep, verticalMultiplier, x, y, gridValues, label;\n\n            var paddingBottom = 8 + 16,\n                paddingTop = 8;\n\n            gridValues = this.calcGridValues(minValue, maxValue);\n            var gridStep = (this.svgHeight - paddingBottom - paddingTop) / (gridValues.length - 1);\n            for (i = 0; i < gridValues.length; i++) {\n                y = Math.round(i * gridStep - 0.5) + 0.5 + paddingTop;\n                path = L.Util.template('M{x1} {y} L{x2} {y}', {x1: 0, x2: this.svgWidth * this.horizZoom, y: y});\n                createSvg(\n                    'path',\n                    {'d': path, 'stroke-width': '1px', 'stroke': 'green', 'fill': 'none', 'stroke-opacity': '0.5'},\n                    svg\n                );\n\n                label = L.DomUtil.create('div', 'elevation-profile-grid-label', this.leftAxisLables);\n                label.innerHTML = gridValues[gridValues.length - i - 1];\n                label.style.top = (gridStep * i + paddingTop) + 'px';\n            }\n\n            horizStep = this.svgWidth / (this.values.length - 1);\n            verticalMultiplier =\n                (this.svgHeight - paddingTop - paddingBottom) / (gridValues[gridValues.length - 1] - gridValues[0]);\n\n            path = [];\n            const valueToSvgCoord = (el) => {\n                const y = (el - gridValues[0]) * verticalMultiplier;\n                return this.svgHeight - y - paddingBottom;\n            };\n\n            let startNewSegment = true;\n            for (i = 0; i < this.values.length; i++) {\n                let value = this.values[i];\n                if (value === null) {\n                    startNewSegment = true;\n                    continue;\n                }\n                path.push(startNewSegment ? 'M' : 'L');\n                x = i * horizStep;\n                y = valueToSvgCoord(value);\n                path.push(x + ' ' + y + ' ');\n                startNewSegment = false;\n            }\n            path = path.join('');\n            createSvg('path', {'d': path, 'stroke-width': '1px', 'stroke': 'brown', 'fill': 'none'}, svg);\n            // sightline\n            if (this.options.sightLine) {\n                path = L.Util.template('M{x1} {y1} L{x2} {y2}', {\n                        x1: 0,\n                        x2: this.svgWidth * this.horizZoom,\n                        y1: valueToSvgCoord(this.values[0]),\n                        y2: valueToSvgCoord(this.values[this.values.length - 1])\n                    }\n                );\n                createSvg(\n                    'path',\n                    {'d': path, 'stroke-width': '3px', 'stroke': '#94b1ff', 'fill': 'none', 'stroke-opacity': '0.5'},\n                    svg\n                );\n            }\n        },\n\n        onCloseButtonClick: function() {\n            this.removeFrom(this._map);\n        }\n    }\n);\n\nexport {ElevationProfile, calcSamplingInterval};\n","import config from '~/config';\nimport {fetch} from '~/lib/xhr-promise';\n\nclass ElevationProvider {\n    chunkSize = 10000;\n\n    constructor(serverUrl = config.elevationsServer) {\n        this.url = serverUrl;\n    }\n\n    async get(latlngs) {\n        const result = [];\n        for (let i = 0; i < latlngs.length; i += this.chunkSize) {\n            const chunk = latlngs.slice(i, i + this.chunkSize);\n            const request = chunk.map((ll) => `${ll.lat.toFixed(6)} ${ll.lng.toFixed(6)}`).join('\\n');\n            const xhr = await fetch(this.url, {method: 'POST', data: request, withCredentials: false});\n            const respValues = xhr.responseText.split('\\n').map((line) => (line === 'NULL' ? null : parseFloat(line)));\n            result.push(...respValues);\n        }\n        return result;\n    }\n}\n\nexport {ElevationProvider};\n","import L from 'leaflet';\nimport './style.css';\n\nfunction enableTopRow(control) {\n    const originalOnAdd = control.onAdd;\n    if (control._topRowEnabled) {\n        return;\n    }\n\n    L.Util.extend(control, {\n        _topRowEnabled: true,\n\n        onAdd: function(map) {\n            const container = originalOnAdd.call(this, map);\n            setTimeout(() => this.__injectTopRow(), 0);\n            return container;\n        },\n\n        __injectTopRow: function() {\n            this._topRow = L.DomUtil.create('div', 'leaflet-control-layers-top-row');\n            this._section.parentNode.insertBefore(this._topRow, this._section);\n        }\n\n    });\n    if (control._map) {\n        control.__injectTopRow();\n    }\n}\n\nexport default enableTopRow;\n","export default \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMzAgMzAiPgogICAgPGc+CiAgICAgICAgPGVsbGlwc2Ugcnk9IjE1IiByeD0iMTUiIGN5PSIxNSIgY3g9IjE1IiBmaWxsPSIjNzc3IiBmaWxsLW9wYWNpdHk9IjAuNSIvPgogICAgICAgIDxlbGxpcHNlIHJ5PSIzIiByeD0iMyIgY3k9IjE1IiBjeD0iMTUiIGZpbGw9IiMzMzg4ZmYiIC8+CiAgICA8L2c+Cjwvc3ZnPg==\"","import L from 'leaflet';\n\nimport '~/lib/leaflet.hashState/leaflet.hashState';\n\nimport './style.css';\n\nconst Placemark = L.Marker.extend({\n    initialize: function(latlng, title) {\n        this.title = title;\n        const icon = L.divIcon({\n            html: '<div class=\"lealfet-placemark-title\"></div>',\n            className: 'leaflet-placemark',\n        });\n        L.Marker.prototype.initialize.call(this, latlng, {icon});\n    },\n\n    getTitle: function() {\n        return this.title;\n    },\n\n    onAdd: function(map) {\n        L.Marker.prototype.onAdd.call(this, map);\n        this.getElement().children[0].innerHTML = this.title;\n        this.on('click', this.onClick, this);\n        map.on('click', this.onMapClick, this);\n        map.suggestedPoint = {latlng: this.getLatLng(), title: this.title};\n    },\n\n    onRemove: function(map) {\n        this._map.off('move', this.onMapMove, this);\n        this._map.off('click', this.onMapClick, this);\n        this._map.suggestedPoint = null;\n        L.Marker.prototype.onRemove.call(this, map);\n    },\n\n    onClick: function() {\n        this._map.fire('click', {latlng: this.getLatLng(), suggested: true});\n        this._map.removeLayer(this);\n    },\n\n    onMapClick: function(e) {\n        if (!e.suggested) {\n            this._map.removeLayer(this);\n        }\n    },\n});\n\nL.Map.include({\n    showPlacemark: function(latlng, title) {\n        if (this._placemark) {\n            this.removeLayer(this._placemark);\n        }\n        this._placemark = new Placemark(latlng, title);\n        this.addLayer(this._placemark);\n        this.fire('placemarkshow');\n        this._placemark.on('remove', this.onPlacemarkRemove, this);\n    },\n\n    onPlacemarkRemove: function() {\n        this._placemark = null;\n        this.fire('placemarkhide');\n    },\n});\n\nconst PlacemarkHashStateInterface = L.Class.extend({\n    includes: L.Mixin.HashState,\n\n    stateChangeEvents: ['placemarkshow', 'placemarkhide'],\n\n    initialize: function(map) {\n        this.map = map;\n        this.stateChangeEventsSource = 'map';\n    },\n\n    serializeState: function() {\n        const placemark = this.map._placemark;\n        if (!placemark) {\n            return null;\n        }\n        const latlng = placemark.getLatLng();\n        return [latlng.lat.toFixed(6), latlng.lng.toFixed(6), encodeURIComponent(placemark.getTitle())];\n    },\n\n    unserializeState: function(values) {\n        if (!values) {\n            return false;\n        }\n        const lat = parseFloat(values[0]);\n        const lng = parseFloat(values[1]);\n        const title = decodeURIComponent(values[2] ?? '');\n        if (isNaN(lat) || isNaN(lng) || lat < -90 || lat > 90 || lng < -180 || lng > 180) {\n            return false;\n        }\n        this.map.showPlacemark(L.latLng(lat, lng), title);\n        return true;\n    },\n});\n\nL.Map.include({\n    getPlacemarkHashStateInterface: function() {\n        return new PlacemarkHashStateInterface(this);\n    },\n});\n","import './index.css';\nimport * as App from './App';\nimport config from './config';\n\nfunction getUid() {\n    const cookie = document.cookie;\n    const cookieUid = cookie.match(/\\buid=([^;]+)/u)[1];\n    const uidRaw = atob(cookieUid);\n    const l = [];\n    for (let i = 0; i < uidRaw.length; i++) {\n        l.push(uidRaw.charCodeAt(i));\n    }\n    const l2 = [];\n    l2.push(...l.slice(0, 4).reverse());\n    l2.push(...l.slice(4, 8).reverse());\n    l2.push(...l.slice(8, 12).reverse());\n    l2.push(...l.slice(12).reverse());\n    const uid = l2.map((c) => (\"0\" + c.toString(16)).slice(-2)).join('').toUpperCase();\n    return uid;\n}\n\nfunction preconnect(url) {\n    const preconnectLink = document.createElement('link');\n    preconnectLink.rel = 'preconnect';\n    preconnectLink.href = url;\n    document.head.appendChild(preconnectLink);\n\n    const dnsPrefetchLink = document.createElement('link');\n    dnsPrefetchLink.rel = 'dns-prefetch';\n    dnsPrefetchLink.href = url;\n    document.head.appendChild(dnsPrefetchLink);\n}\n\npreconnect(config.apiServer);\npreconnect(config.CORSProxyUrl);\n\nconsole.log('Version:', RELEASE_VER); // eslint-disable-line no-console\n\nlet uid;\ntry {\n    uid = getUid();\n} catch (e) {\n    // ignore error\n}\nconsole.log('UID:', uid); // eslint-disable-line no-console\n\nApp.setUp();\n\n","// extracted by mini-css-extract-plugin\nexport {};","import './App.css';\nimport './leaflet-fixes.css';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport {MapWithSidebars} from '~/lib/leaflet.map.sidebars';\nimport '~/lib/leaflet.control.printPages/control';\nimport '~/lib/leaflet.control.caption';\nimport config from './config';\nimport '~/lib/leaflet.control.coordinates';\nimport enableLayersControlHotKeys from '~/lib/leaflet.control.layers.hotkeys';\nimport '~/lib/leaflet.hashState/Leaflet.Map';\nimport '~/lib/leaflet.hashState/Leaflet.Control.Layers';\nimport {fixAll} from '~/lib/leaflet.fixes';\nimport './adaptive.css';\nimport '~/lib/leaflet.control.panoramas';\nimport '~/lib/leaflet.control.track-list/track-list';\nimport '~/lib/leaflet.control.track-list/control-ruler';\nimport '~/lib/leaflet.control.track-list/track-list.hash-state';\nimport '~/lib/leaflet.control.track-list/track-list.localstorage';\nimport enableLayersMinimize from '~/lib/leaflet.control.layers.minimize';\nimport enableLayersConfig from '~/lib/leaflet.control.layers.configure';\nimport raiseControlsOnFocus from '~/lib/leaflet.controls.raise-on-focus';\nimport {getLayers} from './layers';\nimport '~/lib/leaflet.control.layers.events';\nimport '~/lib/leaflet.control.jnx';\nimport '~/lib/leaflet.control.jnx/hash-state';\nimport '~/lib/leaflet.control.azimuth';\nimport {hashState, bindHashStateReadOnly} from '~/lib/leaflet.hashState/hashState';\nimport {LocateControl} from '~/lib/leaflet.control.locate';\nimport {notify} from '~/lib/notifications';\nimport ZoomDisplay from '~/lib/leaflet.control.zoom-display';\nimport * as logging from '~/lib/logging';\nimport safeLocalStorage from '~/lib/safe-localstorage';\nimport '~/lib/leaflet.placemark';\nimport '~/lib/leaflet.control.weather';\nimport {SearchControl} from '~/lib/leaflet.control.search';\n\nconst locationErrorMessage = {\n    0: 'Ваш браузер не поддерживает геолокацию.',\n    1: 'Геолокация для этого сайта заблокирована. Пожалуйста, включите в настройках браузера.',\n    2: 'Не удалось получить позицию по неизвестной причине.',\n};\n\nfunction setUp() {\n    const startInfo = {\n        href: window.location.href,\n        localStorageKeys: Object.keys(safeLocalStorage),\n        mobile: L.Browser.mobile,\n    };\n    fixAll();\n\n    const map = new MapWithSidebars('map', {\n            zoomControl: false,\n            fadeAnimation: false,\n            attributionControl: false,\n            inertiaMaxSpeed: 1500,\n            worldCopyJump: true,\n            maxZoom: 18,\n            tap: false // фикс бага с двойным кликом в сафари\n        }\n    );\n\n    const tracklist = new L.Control.TrackList();\n\n    /* controls top-left corner */\n    // Поле с информацией\n    new L.Control.Caption(config.caption, {\n            position: 'topleft'\n        }\n    ).addTo(map);\n\n    new ZoomDisplay().addTo(map);\n\n    const searchControl = new SearchControl({position: 'topleft', stackHorizontally: true, maxMapWidthToMinimize: 620})\n        .addTo(map);\n        //.enableHashState('q');\n\n    map.getPlacemarkHashStateInterface().enableHashState('r');\n\n    new L.Control.Coordinates({position: 'topleft'}).addTo(map);\n\n    new L.Control.Weather().addTo(map);\n\n    const locateControl = new LocateControl({\n        position: 'topleft',\n        showError: function({code, message}) {\n            let customMessage = locationErrorMessage[code];\n            if (!customMessage) {\n                customMessage = `Geolocation error: ${message}`;\n            }\n            notify(customMessage);\n        }\n    }).addTo(map);\n    let state_map = hashState.getState('m');\n    if (typeof state_map === 'undefined') {\n        // если не заданы координаты в урле, то берём из локалстораджа\n        state_map = safeLocalStorage.getItem('state-m');\n    }\n    if (typeof state_map === 'string') {\n        state_map = state_map.split(',');\n    }\n    let {lat, lng, zoom, valid: validPositionInHash} = map.validateState(state_map);\n    locateControl.moveMapToCurrentLocation(config.defaultZoom, L.latLng(config.defaultLocation),\n        validPositionInHash ? L.latLng(lat, lng) : null, validPositionInHash ? zoom : null);\n    map.enableHashState('m');\n\n    const panoramas = new L.Control.Panoramas().addTo(map); // eslint-disable-line\n\n    /* controls top-right corner */\n\n    const layersControl = L.control.layers(null, null, {collapsed: false})\n        .addTo(map);\n    enableLayersControlHotKeys(layersControl);\n    enableLayersMinimize(layersControl);\n    enableLayersConfig(layersControl, getLayers());\n    let state_layers = hashState.getState('l');\n    if (typeof state_layers === 'undefined') {\n        // если не задан слой в урле, то берём из локалстораджа\n        state_layers = safeLocalStorage.getItem('state-l');\n        if (typeof state_layers === 'string') {\n            state_layers = state_layers.split(',');\n            hashState.updateState('l', state_layers);\n        }\n    }\n    layersControl.enableHashState('l');\n\n    /* controls bottom-left corner */\n\n    const attribution = L.control.attribution({\n        position: 'bottomleft',\n        prefix: false,\n    });\n    map.on('resize', function() {\n        if (map.getSize().y > 567) {\n            map.addControl(attribution);\n            // Hack to keep control at the bottom of the map\n            const container = attribution._container;\n            const parent = container.parentElement;\n            parent.appendChild(container);\n        } else {\n            map.removeControl(attribution);\n        }\n    });\n    if (map.getSize().y > 567) {\n        map.addControl(attribution);\n    }\n    // ewfefwef\n\n    /* controls bottom-right corner */\n\n    function trackNames() {\n        return tracklist.tracks().map((track) => track.name());\n    }\n    tracklist.addTo(map);\n    const tracksHashParams = tracklist.hashParams();\n\n    let hasTrackParamsInHash = false;\n    for (let param of tracksHashParams) {\n        if (hashState.hasKey(param)) {\n            hasTrackParamsInHash = true;\n            break;\n        }\n    }\n    if (!hasTrackParamsInHash) {\n        //tracklist.loadTracksFromStorage();\n    }\n    tracklist.loadTracksFromStorage();\n    startInfo.tracksAfterLoadFromStorage = trackNames();\n\n    for (let param of tracksHashParams) {\n        bindHashStateReadOnly(param, tracklist.loadTrackFromParam.bind(tracklist, param));\n    }\n    startInfo.tracksAfterLoadFromHash = trackNames();\n\n    if (!validPositionInHash) {\n        tracklist.whenLoadDone(() => tracklist.setViewToAllTracks(true));\n    }\n\n    /* adaptive layout */\n\n    if (L.Browser.mobile) {\n        layersControl.setMinimized();\n        if (!tracklist.hasTracks()) {\n            tracklist.setMinimized();\n        }\n    }\n\n    if (L.Browser.mobile) {\n        map.on('mousedown dragstart', () => layersControl.setMinimized());\n        // при активации погоды - скрываем большие контроллы\n        map.on('weather_rendered', () => {layersControl.setMinimized();tracklist.setMinimized();})\n    }\n\n    raiseControlsOnFocus(map);\n\n    /* save state at unload */\n    L.DomEvent.on(window, 'beforeunload', () => {\n        logging.logEvent('saveTracksToStorage begin', {\n            localStorageKeys: Object.keys(safeLocalStorage),\n            trackNames: trackNames(),\n        });\n        let localStorageKeys;\n        try {\n            tracklist.saveTracksToStorage();\n            safeLocalStorage.setItem('state-m', hashState.getState('m'));\n            safeLocalStorage.setItem('state-l', hashState.getState('l'));\n            localStorageKeys = Object.keys(safeLocalStorage); // eslint-disable-line\n        } catch (e) {\n            logging.logEvent('saveTracksToStorage failed', {error: e});\n            return; // eslint-disable-line\n        }\n    });\n}\n\nexport {setUp};\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\n\nimport './style.css';\nimport {onElementResize} from '~/lib/anyElementResizeEvent';\n\nconst MapWithSidebars = L.Map.extend({\n    initialize: function (id, options) {\n        this._sidebarsContainer = L.DomUtil.get(id);\n        this.setupSidebarsLayout(this._sidebarsContainer);\n        L.Map.prototype.initialize.call(this, this._mapContainer, options);\n        onElementResize(this._mapContainer, L.Util.requestAnimFrame.bind(null, this.invalidateSize.bind(this)));\n    },\n\n    setupSidebarsLayout: function (container) {\n        this._sidebarContainers = {};\n        const sidebars = this._sidebarContainers;\n        L.DomUtil.addClass(container, 'leaflet-map-sidebars-container');\n        sidebars['left'] = L.DomUtil.create('div', 'leaflet-map-sidebar-left', this._sidebarsContainer);\n        const midColumn = L.DomUtil.create('div', 'leaflet-map-sidebar-mid-column', this._sidebarsContainer);\n        sidebars['right'] = L.DomUtil.create('div', 'leaflet-map-sidebar-right', this._sidebarsContainer);\n        sidebars['top'] = L.DomUtil.create('div', 'leaflet-map-sidebar-top', midColumn);\n        this._mapContainer = L.DomUtil.create('div', 'leaflet-map-container-with-sidebars', midColumn);\n        sidebars['bottom'] = L.DomUtil.create('div', 'leaflet-map-sidebar-bottom', midColumn);\n    },\n\n    addElementToSidebar: function (barName, element) {\n        this._sidebarContainers[barName].appendChild(element);\n    },\n\n    removeElementFromSidebar: function (barName, element) {\n        this._sidebarContainers[barName].removeChild(element);\n    },\n});\n\nexport {MapWithSidebars};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport ko from 'knockout';\nimport '~/lib/knockout.component.progress/progress';\nimport '~/lib/controls-styles/controls-styles.css';\nimport './control.css';\nimport PageFeature from './pageFeature';\nimport Contextmenu from '~/lib/contextmenu';\nimport {renderPages} from './map-render';\nimport formHtml from './form.html';\nimport {notify} from '~/lib/notifications';\nimport {makePdf} from './pdf';\nimport {saveAs} from '~/vendored/github.com/eligrey/FileSaver';\nimport {blobFromString} from '~/lib/binary-strings';\nimport '~/lib/leaflet.hashState/leaflet.hashState';\nimport '~/lib/leaflet.control.commons';\nimport * as logging from '~/lib/logging';\nimport {MagneticMeridians} from './decoration.magnetic-meridians';\nimport {OverlayScale} from './decoration.scale';\nimport {Grid} from './decoration.grid';\n\nko.extenders.checkNumberRange = function(target, range) {\n    return ko.pureComputed({\n            read: target,  // always return the original observables value\n            write: function(newValue) {\n                newValue = parseFloat(newValue);\n                if (newValue >= range[0] && newValue <= range[1]) {\n                    target(newValue);\n                } else {\n                    target.notifySubscribers(target());\n                }\n            }\n        }\n    ).extend({notify: 'always'});\n};\n\nfunction savePagesPdf(imagesInfo, resolution, fileName) {\n    let pdf = makePdf(imagesInfo, resolution);\n    pdf = blobFromString(pdf);\n    saveAs(pdf, fileName, true);\n}\n\nfunction savePageJpg(page, fileName) {\n    saveAs(blobFromString(page.data), fileName, true);\n}\n\nL.Control.PrintPages = L.Control.extend({\n        options: {\n            position: 'bottomleft',\n            defaultMargin: 7,\n        },\n\n        includes: [L.Evented, L.Mixin.HashState],\n\n        stateChangeEvents: ['change'],\n\n        pageSizes: [\n            {name: 'A1', width: 594, height: 841},\n            {name: 'A2', width: 420, height: 594},\n            {name: 'A3', width: 297, height: 420},\n            {name: 'A4', width: 210, height: 297},\n            {name: 'A5', width: 148, height: 210}\n        ],\n\n        zoomLevels: ['auto', 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18],\n\n        initialize: function(options) {\n            L.Control.prototype.initialize.call(this, options);\n            this.pages = [];\n            this.scale = ko.observable(500).extend({checkNumberRange: [1, 1000000]});\n            this.resolution = ko.observable(300).extend({checkNumberRange: [10, 9999]});\n            this.zoomLevel = ko.observable('auto');\n            this.pageWidth = ko.observable(210).extend({checkNumberRange: [10, 9999]});\n            this.pageHeight = ko.observable(297).extend({checkNumberRange: [10, 9999]});\n            this.settingsExpanded = ko.observable(false);\n            this.makingPdf = ko.observable(false);\n            this.downloadProgressRange = ko.observable();\n            this.downloadProgressDone = ko.observable();\n            this.marginLeft = ko.observable(this.options.defaultMargin).extend({checkNumberRange: [0, 99]});\n            this.marginRight = ko.observable(this.options.defaultMargin).extend({checkNumberRange: [0, 99]});\n            this.marginTop = ko.observable(this.options.defaultMargin).extend({checkNumberRange: [0, 99]});\n            this.marginBottom = ko.observable(this.options.defaultMargin).extend({checkNumberRange: [0, 99]});\n            this.autoZoomLevels = ko.observable({});\n            this.printSize = ko.pureComputed(this._printSize, this);\n            this.printSize.subscribe(this.onPageSizeChanged, this);\n            this.scale.subscribe(this.onPageSizeChanged, this);\n            this.resolution.subscribe(this.onPageSizeChanged, this);\n            this.pageSizeDescription = ko.pureComputed(this._displayPageSize, this);\n            this.pagesNum = ko.observable(0);\n            this.pagesNumLabel = ko.pureComputed(this._pagesNumLabel, this);\n            this.gridOn = ko.observable(false);\n            this.magneticMeridiansOn = ko.observable(false);\n\n            // hash state notifications\n            this.scale.subscribe(this.notifyChange, this);\n            this.printSize.subscribe(this.notifyChange, this);\n            this.resolution.subscribe(this.notifyChange, this);\n            this.zoomLevel.subscribe(this.notifyChange, this);\n            this.gridOn.subscribe(this.notifyChange, this);\n            this.magneticMeridiansOn.subscribe(this.notifyChange, this);\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            const container = this._container =\n                L.DomUtil.create('div', 'leaflet-control control-form control-print-pages');\n            this._stopContainerEvents();\n\n            map.on('move', this.updateFormZooms, this);\n            container.innerHTML = formHtml;\n            ko.applyBindings(this, container);\n            this.updateFormZooms();\n            return container;\n        },\n\n        setExpanded: function() {\n            L.DomUtil.removeClass(this._container, 'minimized');\n        },\n\n        setMinimized: function() {\n            L.DomUtil.addClass(this._container, 'minimized');\n        },\n\n        addPage: function(isLandscape, center) {\n            let [pageWidth, pageHeight] = this.printSize();\n            if (isLandscape) {\n                [pageWidth, pageHeight] = [pageHeight, pageWidth];\n            }\n            if (!center) {\n                center = this._map.getCenter();\n            }\n            const page = new PageFeature(center, [pageWidth, pageHeight],\n                this.scale(), (this.pages.length + 1).toString()\n            );\n            page._rotated = isLandscape;\n            page.addTo(this._map);\n            this.pages.push(page);\n            this.pagesNum(this.pages.length);\n            let cm = new Contextmenu(this.makePageContexmenuItems.bind(this, page));\n            page.on('contextmenu', cm.show, cm);\n            page.on('click', this.rotatePage.bind(this, page));\n            page.on('move', this.updateFormZooms, this);\n            page.on('moveend', this.notifyChange, this);\n            this.updateFormZooms();\n            this.notifyChange();\n            return page;\n        },\n\n        addLandscapePage: function() {\n            this.addPage(true);\n        },\n\n        addPortraitPage: function() {\n            this.addPage(false);\n        },\n\n        removePage: function(page) {\n            let i = this.pages.indexOf(page);\n            this.pages.splice(i, 1);\n            this.pagesNum(this.pages.length);\n            this._map.removeLayer(page);\n            for (; i < this.pages.length; i++) {\n                this.pages[i].setLabel((i + 1).toString());\n            }\n            this.notifyChange();\n            this.updateFormZooms();\n        },\n\n        removePages: function() {\n            this.pages.forEach((page) => page.removeFrom(this._map));\n            this.pages = [];\n            this.pagesNum(this.pages.length);\n            this.notifyChange();\n            this.updateFormZooms();\n        },\n\n        onSavePdfClicked: function() {\n            if (!this.pages.length) {\n                notify('Add some pages to print');\n                return;\n            }\n            this.savePdf();\n        },\n\n        zoomForPrint: function() {\n            let zoom = this.zoomLevel();\n            if (zoom === 'auto') {\n                zoom = this.suggestZooms();\n            } else {\n                zoom = {mapZoom: zoom, satZoom: zoom};\n            }\n            return zoom;\n        },\n\n        incrementProgress: function(inc, range) {\n            this.downloadProgressRange(range);\n            this.downloadProgressDone((this.downloadProgressDone() || 0) + inc);\n        },\n\n        savePdf: function() {\n            logging.captureBreadcrumb('start save pdf');\n            if (!this._map) {\n                return;\n            }\n            this.downloadProgressRange(1000);\n            this.downloadProgressDone(undefined);\n            this.makingPdf(true);\n            const pages = this.pages.map((page) => ({\n                        latLngBounds: page.getLatLngBounds(),\n                        printSize: page.getPrintSize(),\n                        label: page.getLabel()\n            }));\n            const resolution = this.resolution();\n            const decorationLayers = [];\n            if (this.gridOn()) {\n                decorationLayers.push(new Grid());\n            }\n            if (this.magneticMeridiansOn()) {\n                decorationLayers.push(new MagneticMeridians());\n            }\n            decorationLayers.push(new OverlayScale());\n            const scale = this.scale();\n            const width = this.pageWidth();\n            const height = this.pageHeight();\n            const eventId = logging.randId();\n            const zooms = this.zoomForPrint();\n            this.fire('mapRenderStart', {\n                action: 'pdf',\n                eventId,\n                scale,\n                resolution,\n                pages,\n                zooms\n            });\n            renderPages({\n                    map: this._map,\n                    pages,\n                    zooms,\n                    resolution,\n                    scale,\n                    decorationLayers,\n                    progressCallback: this.incrementProgress.bind(this)\n                }\n            ).then(({images, renderedLayers}) => {\n                    if (images) {\n                        const fileName = this.getFileName({\n                            renderedLayers,\n                            scale,\n                            width,\n                            height,\n                            extension: 'pdf'\n                        });\n                        savePagesPdf(images, resolution, fileName);\n                        this.fire('mapRenderEnd', {eventId, success: true});\n                    }\n                }\n            ).catch((e) => {\n                    logging.captureException(e, 'raster creation failed');\n                    this.fire('mapRenderEnd', {eventId, success: false, error: e});\n                    notify(`Failed to create PDF: ${e.message}`);\n                }\n            ).then(() => this.makingPdf(false));\n        },\n\n        savePageJpg: function(page) {\n            logging.captureBreadcrumb('start save page jpg', {pageNumber: page.getLabel()});\n            const pages = [{\n                latLngBounds: page.getLatLngBounds(),\n                printSize: page.getPrintSize(),\n                label: page.getLabel()\n            }];\n            const decorationLayers = [];\n            if (this.gridOn()) {\n                decorationLayers.push(new Grid());\n            }\n            if (this.magneticMeridiansOn()) {\n                decorationLayers.push(new MagneticMeridians());\n            }\n            decorationLayers.push(new OverlayScale());\n            this.downloadProgressRange(1000);\n            this.downloadProgressDone(undefined);\n            this.makingPdf(true);\n            const resolution = this.resolution();\n            const scale = this.scale();\n            const width = this.pageWidth();\n            const height = this.pageHeight();\n            const eventId = logging.randId();\n            const zooms = this.zoomForPrint();\n            this.fire('mapRenderStart', {\n                action: 'jpg',\n                eventId,\n                scale,\n                resolution,\n                pages,\n                zooms\n            });\n            renderPages({\n                    map: this._map,\n                    pages,\n                    zooms,\n                    resolution,\n                    scale,\n                    decorationLayers,\n                    progressCallback: this.incrementProgress.bind(this)\n                }\n            )\n                .then(({images, renderedLayers}) => {\n                    const fileName = this.getFileName({\n                        renderedLayers,\n                        scale,\n                        width,\n                        height,\n                        extension: 'jpg'\n                    });\n                    savePageJpg(images[0], fileName);\n                    this.fire('mapRenderEnd', {eventId, success: true});\n                })\n                .catch((e) => {\n                        logging.captureException(e, 'raster creation failed');\n                        this.fire('mapRenderEnd', {eventId, success: false, error: e});\n                        notify(`Failed to create JPEG from page: ${e.message}`);\n                    }\n                ).then(() => this.makingPdf(false));\n        },\n\n        onPageSizeChanged: function() {\n            let [pageWidth, pageHeight] = this.printSize();\n            this.pages.forEach((page) => {\n                    let [w, h] = [pageWidth, pageHeight];\n                    if (page._rotated) {\n                        [w, h] = [h, w];\n                    }\n                    page.setSize([w, h], this.scale());\n                }\n            );\n            this.updateFormZooms();\n        },\n\n        onPagesNumLabelClick: function() {\n            if (this.pages.length > 0) {\n                const bounds = L.latLngBounds([]);\n                for (let page of this.pages) {\n                    bounds.extend(page.latLngBounds);\n                }\n                this._map.fitBounds(bounds.pad(0.2));\n            }\n        },\n\n        makePageContexmenuItems: function(page) {\n            const items = [\n                {text: 'Rotate', callback: this.rotatePage.bind(this, page)},\n                '-',\n                {text: 'Delete', callback: this.removePage.bind(this, page)},\n                '-',\n                {text: 'Save image', callback: this.savePageJpg.bind(this, page), disabled: this.makingPdf()}\n            ];\n            if (this.pages.length > 1) {\n                items.push({text: 'Change order', separator: true});\n                this.pages.forEach((p, i) => {\n                        if (p !== page) {\n                            items.push({\n                                    text: (i + 1).toString(),\n                                    callback: this.renumberPage.bind(this, page, i)\n                                }\n                            );\n                        }\n                    }\n                );\n            }\n            return items;\n        },\n\n        rotatePage: function(page) {\n            page._rotated = !page._rotated;\n            page.rotate();\n            this.notifyChange();\n        },\n\n        renumberPage: function(page, newIndex) {\n            const oldIndex = this.pages.indexOf(page);\n            this.pages.splice(oldIndex, 1);\n            this.pages.splice(newIndex, 0, page);\n            for (let i = Math.min(oldIndex, newIndex); i < this.pages.length; i++) {\n                this.pages[i].setLabel((i + 1).toString());\n            }\n            this.notifyChange();\n        },\n\n        _printSize: function() {\n            return [this.pageWidth() - this.marginLeft() - this.marginRight(),\n                this.pageHeight() - this.marginTop() - this.marginBottom()];\n        },\n\n        suggestZooms: function() {\n            const scale = this.scale(),\n                resolution = this.resolution();\n            let referenceLat;\n            if (this.pages.length > 0) {\n                let absLats = this.pages.map((page) => Math.abs(page.getLatLngBounds().getCenter().lat));\n                referenceLat = Math.min(...absLats);\n            } else {\n                if (!this._map) {\n                    return [null, null];\n                }\n                referenceLat = this._map.getCenter().lat;\n            }\n            let targetMetersPerPixel = scale / (resolution / 2.54);\n            let mapUnitsPerPixel = targetMetersPerPixel / Math.cos(referenceLat * Math.PI / 180);\n            let satZoom = Math.ceil(Math.log(40075016.4 / 256 / mapUnitsPerPixel) / Math.LN2);\n\n            targetMetersPerPixel = scale / (90 / 2.54) / 1.5;\n            mapUnitsPerPixel = targetMetersPerPixel / Math.cos(referenceLat * Math.PI / 180);\n            let mapZoom = Math.round(Math.log(40075016.4 / 256 / mapUnitsPerPixel) / Math.LN2);\n            mapZoom = Math.min(mapZoom, 18);\n            satZoom = Math.min(satZoom, 18);\n            mapZoom = Math.max(mapZoom, 0);\n            satZoom = Math.max(satZoom, 0);\n            return {mapZoom, satZoom};\n        },\n\n        updateFormZooms: function() {\n            this.autoZoomLevels(this.suggestZooms());\n        },\n\n        _displayPageSize: function() {\n            const width = this.pageWidth(),\n                height = this.pageHeight();\n            for (let size of this.pageSizes) {\n                if (size.width === width && size.height === height) {\n                    return size.name;\n                }\n            }\n            return `${width} x ${height} mm`;\n        },\n\n        notifyChange: function() {\n            this.fire('change');\n        },\n\n        hasPages: function() {\n            return this.pages.length > 0;\n        },\n\n        _pagesNumLabel: function() {\n            const n = this.pagesNum();\n            let label = '';\n            if (n) {\n                label += n;\n            } else {\n                label = 'No';\n            }\n            label += ' page';\n            if (n === 0 || n > 1) {\n                label += 's';\n            }\n            return label;\n        },\n\n        serializeState: function() {\n            const pages = this.pages;\n            let state = null;\n            if (pages.length) {\n                state = [];\n                state.push(this.scale().toString());\n                state.push(this.resolution().toString());\n                state.push(this.zoomLevel().toString());\n                state.push(this.pageWidth().toString());\n                state.push(this.pageHeight().toString());\n                state.push(this.marginLeft().toString());\n                state.push(this.marginRight().toString());\n                state.push(this.marginTop().toString());\n                state.push(this.marginBottom().toString());\n                for (let page of pages) {\n                    let latLng = page.getLatLng().wrap();\n                    state.push(latLng.lat.toFixed(5));\n                    state.push(latLng.lng.toFixed(5));\n                    state.push(page._rotated ? '1' : '0');\n                }\n                let flags =\n                    (this.magneticMeridiansOn() ? 1 : 0) |\n                    (this.gridOn() ? 2 : 0);\n                state.push(flags.toString());\n            }\n            return state;\n        },\n\n        unserializeState: function(state) {\n            if (!state || !state.length) {\n                return false;\n            }\n            this.removePages();\n            state = [...state];\n            this.scale(state.shift());\n            this.resolution(state.shift());\n            this.zoomLevel(state.shift());\n            this.pageWidth(state.shift());\n            this.pageHeight(state.shift());\n            this.marginLeft(state.shift());\n            this.marginRight(state.shift());\n            this.marginTop(state.shift());\n            this.marginBottom(state.shift());\n            let lat, lng, rotated;\n            while (state.length >= 3) {\n                lat = parseFloat(state.shift());\n                lng = parseFloat(state.shift());\n                rotated = parseInt(state.shift(), 10);\n                if (isNaN(lat) || isNaN(lng) || lat < -85 || lat > 85 || lng < -180 || lng > 180) {\n                    break;\n                }\n                this.addPage(Boolean(rotated), L.latLng(lat, lng));\n            }\n            if (state.length) {\n                const flags = parseInt(state.shift(), 10);\n                if (flags >= 0 && flags <= 3) {\n                    this.magneticMeridiansOn(Boolean(flags & 1));\n                    this.gridOn(Boolean(flags & 2));\n                }\n            }\n            return true;\n        },\n\n        getFileName: function({renderedLayers, scale, width, height, extension}) {\n            let fileName = '';\n\n            let opaqueLayer;\n            const transparentOverlayLayers = [];\n\n            renderedLayers.forEach((layer) => {\n                const {\n                    options: {\n                        isOverlay,\n                        isOverlayTransparent,\n                        shortName\n                    }\n                } = layer;\n\n                if (!shortName) {\n                    return;\n                }\n\n                if (isOverlay) {\n                    if (isOverlayTransparent) {\n                        transparentOverlayLayers.push(layer);\n                    } else {\n                        opaqueLayer = layer;\n                    }\n                } else if (!opaqueLayer) {\n                    opaqueLayer = layer;\n                }\n            });\n\n            function appendLayerShortName(layer) {\n                fileName += `${layer.options.shortName}_`;\n            }\n            if (opaqueLayer) {\n                appendLayerShortName(opaqueLayer);\n            }\n            transparentOverlayLayers.forEach(appendLayerShortName);\n\n            fileName += `${scale}m`;\n\n            const currentPageSize = this.pageSizes.find(\n                (pageSize) => width === pageSize.width && height === pageSize.height\n            );\n\n            if (currentPageSize) {\n                fileName += `_${currentPageSize.name}`;\n            }\n\n            return `${fileName}.${extension}`;\n        }\n    }\n);\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport './page-feature.css';\n\nconst PageFeature = L.Marker.extend({\n        initialize: function(centerLatLng, paperSize, scale, label) {\n            this.paperSize = paperSize;\n            this.scale = scale;\n            var icon = L.divIcon({className: \"print-page-marker\", html: label});\n            L.Marker.prototype.initialize.call(this, centerLatLng, {\n                    icon: icon,\n                    draggable: true,\n                    title: 'Left click to rotate, right click for menu'\n                }\n            );\n            this.on('drag', this.updateView.bind(this, undefined));\n        },\n\n        onAdd: function(map) {\n            L.Marker.prototype.onAdd.call(this, map);\n            map.on('viewreset', () => this.updateView());\n            this.rectangle = L.rectangle([[0, 0], [0, 0]],\n                {color: '#ff7800', weight: 2, opacity: 0.7, fillOpacity: 0.2}\n            ).addTo(map);\n            this.updateView();\n        },\n\n        onRemove: function(map) {\n            map.off('viewreset', this.updateView, this);\n            L.Marker.prototype.onRemove.call(this, map);\n            this.rectangle.removeFrom(map);\n        },\n\n        getLatLngBounds: function() {\n            return this.latLngBounds;\n        },\n\n        _getLatLngBounds: function() {\n            const centerLatLng = this.getLatLng();\n            const centerMerc = L.Projection.SphericalMercator.project(centerLatLng);\n            const mercatorScale =\n                (Math.cos((centerLatLng.lat * Math.PI) / 180) * L.CRS.Earth.R) / L.Projection.SphericalMercator.R;\n            const mercatorPageSize = L.point(...this.paperSize).multiplyBy(this.scale / 10 / mercatorScale);\n            let sw = centerMerc.subtract(mercatorPageSize.divideBy(2));\n            let ne = centerMerc.add(mercatorPageSize.divideBy(2));\n            sw = L.Projection.SphericalMercator.unproject(sw);\n            ne = L.Projection.SphericalMercator.unproject(ne);\n            return L.latLngBounds([sw, ne]);\n        },\n\n        _animateZoom: function(e) {\n            L.Marker.prototype._animateZoom.call(this, e);\n            this.updateView(e.zoom);\n        },\n\n        updateView: function(newZoom) {\n            if (!this._map) {\n                return;\n            }\n            if (newZoom === undefined) {\n                newZoom = this._map.getZoom();\n            }\n            var bounds = this.latLngBounds = this._getLatLngBounds();\n            var pixel_sw = this._map.project(bounds.getSouthWest(), newZoom);\n            var pixel_ne = this._map.project(bounds.getNorthEast(), newZoom);\n            var pixel_center = this._map.project(this.getLatLng(), newZoom);\n            var st = this._icon.style;\n            var pixel_width = pixel_ne.x - pixel_sw.x;\n            var pixel_height = pixel_sw.y - pixel_ne.y;\n            st.width = `${pixel_width}px`;\n            st.height = `${pixel_height}px`;\n            st.marginLeft = `${pixel_sw.x - pixel_center.x}px`;\n            st.marginTop = `${pixel_ne.y - pixel_center.y}px`;\n            st.fontSize = `${Math.min(pixel_width, pixel_height, 500) / 2}px`;\n            st.lineHeight = `${pixel_height}px`;\n            this.rectangle.setBounds(bounds);\n        },\n\n        setLabel: function(s) {\n            this._icon.innerHTML = s;\n        },\n\n        getLabel: function() {\n            return this._icon.innerHTML;\n        },\n\n        setSize: function(paperSize, scale) {\n            this.paperSize = paperSize;\n            this.scale = scale;\n            this.updateView();\n        },\n\n        getPrintSize: function() {\n            return L.point(...this.paperSize);\n        },\n\n        rotate: function() {\n            this.paperSize = [this.paperSize[1], this.paperSize[0]];\n            this.updateView();\n        }\n\n    }\n);\n\nexport default PageFeature;\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {getTempMap, disposeMap} from '~/lib/leaflet.layer.rasterize';\nimport {XHRQueue} from '~/lib/xhr-promise';\n\nfunction getLayersForPrint(map, xhrQueue) {\n    function getZIndex(el) {\n        return parseInt(window.getComputedStyle(el).zIndex, 10) || 0;\n    }\n\n    function compare(i1, i2) {\n        if (i1 < i2) {\n            return -1;\n        } else if (i1 > i2) {\n            return 1;\n        }\n        return 0;\n    }\n\n    function getLayerZOrder(layer) {\n        let el = layer._container || layer._path;\n        if (!el) {\n            throw new TypeError('Unsupported layer type');\n        }\n        const order = [];\n        while (el !== layer._map._container) {\n            order.push(getZIndex(el));\n            el = el.parentNode;\n        }\n        return order.reverse();\n    }\n\n    function compareArrays(ar1, ar2) {\n        const len = Math.min(ar1.length, ar2.length);\n        for (let i = 0; i < len; i++) {\n            let c = compare(ar1[i], ar2[i]);\n            if (c) {\n                return c;\n            }\n        }\n        return compare(ar1.length, ar2.length);\n    }\n\n    function compareLayersOrder(layer1, layer2) {\n        return compareArrays(getLayerZOrder(layer1), getLayerZOrder(layer2));\n    }\n\n    let layers = [];\n    map.eachLayer((layer) => {\n            if (layer.options.print) {\n                layers.push(layer);\n            } else {\n                if (layer.meta && layer.options.isOverlay === false) {\n                    throw new Error(`Print disabled for layer ${layer.meta.title}`);\n                }\n            }\n        }\n    );\n    layers.sort(compareLayersOrder);\n    layers = layers.map((l) => l.cloneForPrint({xhrQueue}));\n    return layers;\n}\n\nfunction blendMultiplyCanvas(src, dest) {\n    if (src.width !== dest.width || src.height !== dest.height) {\n        throw new Error('Canvas size mismatch');\n    }\n    var s_data = src.getContext('2d').getImageData(0, 0, src.width, src.height).data;\n    src.width = 0;\n    src.height = 0;\n    var d_image_data = dest.getContext('2d').getImageData(0, 0, dest.width, dest.height);\n    var d_data = d_image_data.data;\n    var data_length = s_data.length,\n        sr, sg, sb, sa, sa1,\n        dr, dg, db,\n        l;\n    for (var i = 0; i < data_length; i += 4) {\n        sa = s_data[i + 3] / 255;\n        if (sa) {\n            sr = s_data[i];\n            sg = s_data[i + 1];\n            sb = s_data[i + 2];\n            dr = d_data[i];\n            dg = d_data[i + 1];\n            db = d_data[i + 2];\n\n            l = (dr + dg + db) / 3;\n            l = l / 255 * 0.5 + 0.5;\n            sa1 = 1 - sa;\n            dr = sr * l * sa + sa1 * dr;\n            dg = sg * l * sa + sa1 * dg;\n            db = sb * l * sa + sa1 * db;\n\n            d_data[i] = dr;\n            d_data[i + 1] = dg;\n            d_data[i + 2] = db;\n        }\n    }\n    s_data = null;\n    dest.getContext('2d').putImageData(d_image_data, 0, 0);\n}\n\nclass PageComposer {\n    constructor(destSize, pixelBoundsAtZoom24) {\n        this.destSize = destSize;\n        this.projectedBounds = pixelBoundsAtZoom24;\n        this.currentCanvas = null;\n        this.currentZoom = null;\n        this.currentTileScale = null;\n        this.targetCanvas = this.createCanvas(destSize);\n    }\n\n    createCanvas(size) {\n        const canvas = L.DomUtil.create('canvas');\n        canvas.width = size.x;\n        canvas.height = size.y;\n        return canvas;\n    }\n\n    putTile(tileInfo) {\n        if (!tileInfo.isOverlay && !tileInfo.image) {\n            return;\n        }\n        let zoom;\n        if (tileInfo.isOverlay) {\n            zoom = tileInfo.overlaySolid ? 'solidOverlay' : 'overlay';\n        } else {\n            zoom = tileInfo.zoom;\n        }\n        if (zoom !== this.currentZoom || tileInfo.tileScale !== this.currentTileScale) {\n            this.mergeCurrentCanvas();\n            this.setupCurrentCanvas(zoom, tileInfo.tileScale);\n        }\n        if (tileInfo.isOverlay) {\n            tileInfo.draw(this.currentCanvas);\n        } else {\n            const ctx = this.currentCanvas.getContext('2d');\n            const {tilePos, tileSize} = tileInfo;\n            ctx.drawImage(\n                tileInfo.image,\n                tilePos.x * tileInfo.tileScale,\n                tilePos.y * tileInfo.tileScale,\n                tileSize.x * tileInfo.tileScale,\n                tileSize.y * tileInfo.tileScale\n            );\n        }\n    }\n\n    setupCurrentCanvas(zoom, tileScale) {\n        let size;\n        if (zoom === 'overlay' || zoom === 'solidOverlay') {\n            size = this.destSize;\n        } else {\n            const q = 1 << (24 - zoom);\n            const\n                topLeft = this.projectedBounds.min.divideBy(q).round(),\n                bottomRight = this.projectedBounds.max.divideBy(q).round();\n            size = bottomRight.subtract(topLeft).multiplyBy(tileScale);\n        }\n        this.currentCanvas = this.createCanvas(size);\n        this.currentZoom = zoom;\n        this.currentTileScale = tileScale;\n    }\n\n    mergeCurrentCanvas() {\n        if (!this.currentCanvas) {\n            return;\n        }\n        if (this.currentZoom === 'overlay') {\n            blendMultiplyCanvas(this.currentCanvas, this.targetCanvas);\n        } else {\n            this.targetCanvas.getContext('2d').drawImage(this.currentCanvas, 0, 0,\n                this.destSize.x, this.destSize.y\n            );\n        }\n        this.currentCanvas.width = 0;\n        this.currentCanvas.height = 0;\n        this.currentCanvas = null;\n    }\n\n    getDataUrl() {\n        this.mergeCurrentCanvas();\n        const dataUrl = this.targetCanvas.toDataURL(\"image/jpeg\");\n        this.targetCanvas.width = 0;\n        this.targetCanvas.height = 0;\n        this.targetCanvas = null;\n        return dataUrl;\n    }\n}\n\nasync function* iterateLayersTiles(\n    layers,\n    latLngBounds,\n    destPixelSize,\n    resolution,\n    scale,\n    zooms,\n    pageLabel,\n    pagesCount\n) {\n    const defaultXHROptions = {\n        responseType: 'blob',\n        timeout: 20000,\n        isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 404\n    };\n    let doStop;\n    for (let layer of layers) {\n        let zoom;\n        if (layer.options && layer.options.scaleDependent) {\n            zoom = zooms.mapZoom;\n        } else {\n            zoom = zooms.satZoom;\n        }\n        let pixelBounds = L.bounds(\n            L.CRS.EPSG3857.latLngToPoint(latLngBounds.getNorthWest(), zoom).round(),\n            L.CRS.EPSG3857.latLngToPoint(latLngBounds.getSouthEast(), zoom).round()\n        );\n        let map;\n        if (!layer._layerDummy) {\n            map = getTempMap(zoom, layer._rasterizeNeedsFullSizeMap, pixelBounds);\n            map.addLayer(layer);\n        }\n        let {iterateTilePromises, count, tileScale = 1} = await layer.getTilesInfo({\n                xhrOptions: defaultXHROptions,\n                pixelBounds,\n                latLngBounds,\n                destPixelSize,\n                resolution,\n                scale,\n                zoom,\n                pageLabel,\n                pagesCount\n            }\n        );\n        let layerPromises = [];\n        for (let tilePromise of iterateTilePromises()) {\n            layerPromises.push(tilePromise.tilePromise);\n            let progressInc = (layer._printProgressWeight || 1) / count;\n            tilePromise.tilePromise = tilePromise.tilePromise.then((tileInfo) => ({\n                zoom,\n                progressInc,\n                layer,\n                tileScale,\n                ...tileInfo,\n            }));\n            doStop = yield tilePromise;\n            if (doStop) {\n                tilePromise.abortLoading();\n                break;\n            }\n        }\n        if (!layer._layerDummy) {\n            if (doStop) {\n                disposeMap(map);\n                break;\n            } else {\n                Promise.all(layerPromises).then(() => disposeMap(map));\n            }\n        }\n    }\n}\n\nasync function* promiseQueueBuffer(source, maxActive) {\n    const queue = [];\n    while (queue.length < maxActive) {\n        let {value, done} = await source.next();\n        if (done) {\n            break;\n        }\n        queue.push(value);\n    }\n\n    while (queue.length) {\n        let doStop = yield queue.shift();\n        if (doStop) {\n            let {value, done} = await source.next(true);\n            if (!done) {\n                queue.push(value);\n            }\n            for (let {abortLoading} of queue) {\n                abortLoading();\n            }\n\n            return;\n        }\n        let {value, done} = await source.next();\n        if (!done) {\n            queue.push(value);\n        }\n    }\n}\n\nasync function renderPages({map, pages, zooms, resolution, scale, progressCallback, decorationLayers}) {\n    const xhrQueue = new XHRQueue();\n    const layers = getLayersForPrint(map, xhrQueue);\n    layers.push(...decorationLayers);\n    let progressRange = 0;\n    for (let layer of layers) {\n        progressRange += layer._printProgressWeight || 1;\n    }\n    progressRange *= pages.length;\n    const pageImagesInfo = [];\n    const renderedLayers = new Set();\n    for (let page of pages) {\n        let destPixelSize = page.printSize.multiplyBy(resolution / 25.4).round();\n        let pixelBounds = L.bounds(\n            map.project(page.latLngBounds.getNorthWest(), 24).round(),\n            map.project(page.latLngBounds.getSouthEast(), 24).round()\n        );\n\n        const composer = new PageComposer(destPixelSize, pixelBounds);\n        let tilesIterator = await iterateLayersTiles(layers, page.latLngBounds, destPixelSize, resolution, scale, zooms,\n            page.label, pages.length);\n        let queuedTilesIterator = promiseQueueBuffer(tilesIterator, 20);\n        while (true) {\n            let {value: tilePromise, done} = await queuedTilesIterator.next();\n            if (done) {\n                break;\n            }\n            let tileInfo;\n            try {\n                tileInfo = await tilePromise.tilePromise;\n            } catch (e) {\n                queuedTilesIterator.next(true);\n                throw e;\n            }\n            progressCallback(tileInfo.progressInc, progressRange);\n            composer.putTile(tileInfo);\n            const {image, draw, layer} = tileInfo;\n            if ((image || draw) && !layer._layerDummy) {\n                renderedLayers.add(layer);\n            }\n        }\n        const dataUrl = composer.getDataUrl();\n        let data = dataUrl.substring(dataUrl.indexOf(',') + 1);\n        data = atob(data);\n        pageImagesInfo.push({\n                data,\n                width: destPixelSize.x,\n                height: destPixelSize.y\n            }\n        );\n    }\n    return {images: pageImagesInfo, renderedLayers};\n}\n\nexport {renderPages};\n","const secrets = {\n    bingKey: '0000000000000000000000000000000000000000000000000000000000000000',\n    thunderforestKey: '00000000000000000000000000000000',\n    sentryDSN: 'https://00000000000000000000000000000000@sentry.io/111111',\n    mapillary: 'ejd0bUg5dzlTZ0VscTZKeTQySHVONDowMzJhZTkzODNiYzVjY2Qz',\n    flickr: '00000000000000000000000000000000',\n    google: 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXX'\n};\n\nexport default secrets;\n","function imgFromDataString(xhr) {\n    if (xhr.status === 200 && xhr.response.size) {\n        const image = new Image();\n        let blobUrl = window.URL.createObjectURL(xhr.response);\n        const promise = new Promise((resolve, reject) => {\n                image.onload = () => {\n                    resolve(image);\n                    window.URL.revokeObjectURL(blobUrl);\n                };\n                image.onerror = () => {\n                    reject(new Error('Image corrupt'));\n                    window.URL.revokeObjectURL(blobUrl);\n                };\n            }\n        );\n        image.src = blobUrl;\n        return promise;\n    }\n    return null;\n}\n\nexport {imgFromDataString};\n","import L from 'leaflet';\nimport {BingLayer} from '~/lib/leaflet.layer.bing';\n\nBingLayer.include({\n        waitTilesReadyToGrab: function() {\n            if (this._url) {\n                return Promise.resolve();\n            }\n            return new Promise((resolve) => {\n                    let i = setInterval(() => {\n                            if (this._url) {\n                                clearInterval(i);\n                                resolve();\n                            }\n                        }, 50\n                    );\n                }\n            );\n        },\n\n        cloneForPrint: function(options) {\n            return new BingLayer(this._key, L.Util.extend({}, this.options, options));\n        },\n    }\n);\n","import L from 'leaflet';\n\nfunction tile2quad(x, y, z) {\n    var quad = '';\n    for (var i = z; i > 0; i--) {\n        var digit = 0;\n        var mask = 1 << (i - 1);\n        if ((x & mask) !== 0) {\n            digit += 1;\n        }\n        if ((y & mask) !== 0) {\n            digit += 2;\n        }\n        quad += digit;\n    }\n    return quad;\n}\n\nconst BingLayer = L.TileLayer.extend({\n    options: {\n        subdomains: [0, 1, 2, 3],\n        type: 'Aerial',\n        attribution: 'Bing',\n        culture: ''\n    },\n\n    initialize: function(key, options) {\n        L.Util.setOptions(this, options);\n\n        this._key = key;\n        this._url = null;\n        this._providers = [];\n        this.metaRequested = false;\n    },\n\n    getTileUrl: function(tilePoint) {\n        var zoom = this._getZoomForUrl();\n        var subdomains = this.options.subdomains,\n            s = this.options.subdomains[Math.abs((tilePoint.x + tilePoint.y) % subdomains.length)];\n        return this._url.replace('{subdomain}', s)\n            .replace('{quadkey}', tile2quad(tilePoint.x, tilePoint.y, zoom))\n            .replace('{culture}', this.options.culture);\n    },\n\n    loadMetadata: function() {\n        if (this.metaRequested) {\n            return;\n        }\n        this.metaRequested = true;\n        var that = this;\n        var cbid = '_bing_metadata_' + L.Util.stamp(this);\n        window[cbid] = function(meta) {\n            window[cbid] = undefined;\n            var e = document.getElementById(cbid);\n            e.parentNode.removeChild(e);\n            if (meta.errorDetails) {\n                throw new Error(meta.errorDetails);\n            }\n            that.initMetadata(meta);\n        };\n        var urlScheme = 'https';\n        var url = urlScheme + '://dev.virtualearth.net/REST/v1/Imagery/Metadata/' +\n            this.options.type + '?include=ImageryProviders&jsonp=' + cbid +\n            '&key=' + this._key + '&UriScheme=' + urlScheme;\n        var script = document.createElement('script');\n        script.type = 'text/javascript';\n        script.src = url;\n        script.id = cbid;\n        document.getElementsByTagName('head')[0].appendChild(script);\n    },\n\n    initMetadata: function(meta) {\n        var r = meta.resourceSets[0].resources[0];\n        this.options.subdomains = r.imageUrlSubdomains;\n        this._url = r.imageUrl;\n        if (r.imageryProviders) {\n            for (var i = 0; i < r.imageryProviders.length; i++) {\n                var p = r.imageryProviders[i];\n                for (var j = 0; j < p.coverageAreas.length; j++) {\n                    var c = p.coverageAreas[j];\n                    var coverage = {zoomMin: c.zoomMin, zoomMax: c.zoomMax, active: false};\n                    var bounds = new L.LatLngBounds(\n                        new L.LatLng(c.bbox[0] + 0.01, c.bbox[1] + 0.01),\n                        new L.LatLng(c.bbox[2] - 0.01, c.bbox[3] - 0.01)\n                    );\n                    coverage.bounds = bounds;\n                    coverage.attrib = p.attribution;\n                    this._providers.push(coverage);\n                }\n            }\n        }\n        this._update();\n    },\n\n    _update: function() {\n        if (this._url === null || !this._map) {\n            return;\n        }\n        this._update_attribution();\n        L.TileLayer.prototype._update.apply(this, []);\n    },\n\n    _update_attribution: function() {\n        var bounds = L.latLngBounds(\n            this._map.getBounds().getSouthWest().wrap(),\n            this._map.getBounds().getNorthEast().wrap()\n        );\n        var zoom = this._map.getZoom();\n        for (var i = 0; i < this._providers.length; i++) {\n            var p = this._providers[i];\n            if ((zoom <= p.zoomMax && zoom >= p.zoomMin) &&\n                bounds.intersects(p.bounds)) {\n                if (!p.active && this._map.attributionControl) {\n                    this._map.attributionControl.addAttribution(p.attrib);\n                }\n                p.active = true;\n            } else {\n                if (p.active && this._map.attributionControl) {\n                    this._map.attributionControl.removeAttribution(p.attrib);\n                }\n                p.active = false;\n            }\n        }\n    },\n\n    onAdd: function(map) {\n        this.loadMetadata();\n        L.TileLayer.prototype.onAdd.apply(this, [map]);\n    },\n\n    onRemove: function(map) {\n        for (var i = 0; i < this._providers.length; i++) {\n            var p = this._providers[i];\n            if (p.active && this._map.attributionControl) {\n                this._map.attributionControl.removeAttribution(p.attrib);\n                p.active = false;\n            }\n        }\n        L.TileLayer.prototype.onRemove.apply(this, [map]);\n    }\n});\n\nexport {BingLayer, tile2quad};\n","import L from 'leaflet';\nimport '~/lib/leaflet.layer.yandex';\n\nL.Layer.Yandex.Map.include({\n    cloneForPrint: function(options) {\n        return new L.Layer.Yandex.Map({...this.options, ...options, yandexScale: 2});\n    },\n\n    getTilesInfo: async function(printOptions) {\n        const tilesInfo = await L.TileLayer.prototype.getTilesInfo.call(this, printOptions);\n        tilesInfo.tileScale = 2;\n        return tilesInfo;\n    },\n});\n\nL.Layer.Yandex.Sat.include({\n    cloneForPrint: function(options) {\n        return new L.Layer.Yandex.Sat({...this.options, ...options});\n    },\n});\n\nL.Layer.Yandex.Tracks.include({\n    cloneForPrint: function(options) {\n        return new L.Layer.Yandex.Tracks({...this.options, ...options});\n    },\n});\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport '~/lib/leaflet.layer.google';\n\nL.Layer.GoogleBase.include({\n    cloneForPrint: function(options) {\n        return new L.Layer.GoogleBase(this._url, L.Util.extend({}, this.options, options));\n    },\n});\n\n","import L from \"leaflet\";\nimport '~/lib/leaflet.layer.westraPasses';\nimport {WestraPassesMarkers} from '~/lib/leaflet.layer.westraPasses/westraPassesMarkers';\nimport '~/lib/leaflet.layer.canvasMarkers';\nimport './CanvasMarkers';\n\nL.Layer.WestraPasses.addInitHook(function() {\n    this.markers.options.print = this.options.print;\n    this.options.print = false;\n});\n\nWestraPassesMarkers.include({\n    waitDataReady: function() {\n        if (this._dataLoaded) {\n            return Promise.resolve();\n        }\n        return new Promise((resolve) => {\n           this.on('data-loaded', resolve);\n        });\n    },\n\n    cloneForPrint: function(options) {\n        options = L.Util.extend({}, this.options, options);\n        return new WestraPassesMarkers(this._baseUrl, options);\n    },\n\n    getTilesInfo: async function(printOptions) {\n        await this.waitDataReady();\n        return L.Layer.CanvasMarkers.prototype.getTilesInfo.call(this, printOptions);\n    }\n});\n","import L from 'leaflet';\nimport './westraPasses.css';\nimport '~/lib/leaflet.layer.geojson-ajax';\nimport {WestraPassesMarkers} from './westraPassesMarkers';\n\nL.Layer.WestraPasses = L.Layer.extend({\n        options: {\n            fileCoverage: 'westra_coverage.json',\n            fileLabels1: 'westra_regions_labels1.json',\n            fileLabels2: 'westra_regions_labels2.json',\n            scaleDependent: true,\n            labels2Zoom: 6,\n            markersZoom: 10,\n            labels1Zoom: 2\n\n        },\n\n        initialize: function(baseUrl, options) {\n            L.setOptions(this, options);\n            this.markers = new WestraPassesMarkers(baseUrl, options.markersOptions);\n            this.coverage = new L.Layer.GeoJSONAjax(baseUrl + this.options.fileCoverage, {\n                className: 'westra-coverage-polygon',\n                onEachFeature: this._setEventsForRegion.bind(this)\n            });\n            this.labels1 = new L.Layer.GeoJSONAjax(baseUrl + this.options.fileLabels1, {\n                pointToLayer: this._makeMarker,\n                onEachFeature: this._setEventsForRegion.bind(this)\n            });\n            this.labels2 = new L.Layer.GeoJSONAjax(baseUrl + this.options.fileLabels2, {\n                pointToLayer: this._makeMarker,\n                onEachFeature: this._setEventsForRegion.bind(this)\n            });\n        },\n\n        _setEventsForRegion: function(feature, layer) {\n            layer.on('click', this._onRegionClick, this);\n        },\n\n        _makeMarker: function(geojsonPoint, latlng) {\n            const icon = L.divIcon({\n                    className: 'westra-region-label',\n                    html: '<span>' + geojsonPoint.properties.name + '</span>'\n                }\n            );\n            const marker = L.marker(latlng, {icon: icon});\n            return marker;\n        },\n\n        _onRegionClick: function(e) {\n            const layer = e.target;\n            const latlng = layer.getLatLng ? layer.getLatLng() : e.latlng;\n            const zoom = this._map.getZoom();\n            let newZoom;\n            if (zoom < this.options.labels2Zoom) {\n                newZoom = this.options.labels2Zoom;\n            } else {\n                newZoom = this.options.markersZoom;\n            }\n            this._map.setView(latlng, newZoom);\n        },\n\n        setLayersVisibility: function(e) {\n            if (!this._map) {\n                return;\n            }\n            var newZoom;\n            var zoomFinished = e ? (e.type !== 'zoomanim') : true;\n            if (e && e.zoom !== undefined) {\n                newZoom = e.zoom;\n            } else {\n                newZoom = this._map.getZoom();\n            }\n            if (newZoom < this.options.labels1Zoom) {\n                this._map.removeLayer(this.markers);\n                this._map.addLayer(this.coverage);\n                this._map.removeLayer(this.labels1);\n                this._map.removeLayer(this.labels2);\n            } else if (newZoom < this.options.labels2Zoom) {\n                this._map.removeLayer(this.markers);\n                this._map.addLayer(this.coverage);\n                this._map.addLayer(this.labels1);\n                this._map.removeLayer(this.labels2);\n            } else if (newZoom < this.options.markersZoom) {\n                this._map.removeLayer(this.markers);\n                this._map.addLayer(this.coverage);\n                this._map.removeLayer(this.labels1);\n                this._map.addLayer(this.labels2);\n            } else {\n                if (zoomFinished) {\n                    this._map.addLayer(this.markers);\n                }\n                this._map.removeLayer(this.coverage);\n                this._map.removeLayer(this.labels1);\n                this._map.removeLayer(this.labels2);\n            }\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            this.markers.loadData();\n            this.coverage.loadData();\n            this.labels1.loadData();\n            this.labels2.loadData();\n            this.setLayersVisibility();\n            map.on('zoomend', this.setLayersVisibility, this);\n            map.on('zoomanim', this.setLayersVisibility, this);\n        },\n\n        onRemove: function() {\n            this._map.removeLayer(this.markers);\n            this._map.removeLayer(this.coverage);\n            this._map.removeLayer(this.labels1);\n            this._map.removeLayer(this.labels2);\n            this._map.off('zoomend', this.setLayersVisibility, this);\n            this._map.off('zoomanim', this.setLayersVisibility, this);\n            this._map = null;\n        }\n    }\n);\n\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {fetch} from '~/lib/xhr-promise';\nimport {notify} from '~/lib/notifications';\nimport * as logging from '~/lib/logging';\n\nL.Layer.GeoJSONAjax = L.GeoJSON.extend({\n        options: {\n            requestTimeout: 30000\n        },\n\n        initialize: function(url, options) {\n            L.GeoJSON.prototype.initialize.call(this, null, options);\n            this.url = url;\n        },\n\n        // Promise can be rejected if json invalid or addData fails\n        loadData: function() {\n            if (this._loadStarted) {\n                return;\n            }\n            this._loadStarted = true;\n            fetch(this.url, {timeout: this.options.requestTimeout})\n                .then(\n                    (xhr) => {\n                        this.addData(JSON.parse(xhr.response));\n                    },\n                    (e) => {\n                        logging.captureException(e, 'failed to get geojson');\n                        notify(`Failed to get GeoJSON data from ${this.url}: ${e.message}`);\n                    }\n                );\n        },\n\n        onAdd: function(map) {\n            L.GeoJSON.prototype.onAdd.call(this, map);\n            this.loadData();\n        }\n    }\n);\n\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport '~/lib/leaflet.polyline-measure';\n\nL.Polyline.include({\n        _printProgressWeight: 0.1,\n        printWidthMm: 1,\n\n        cloneForPrint: function(options) {\n            options = L.Util.extend({}, this.options, options);\n            const latlngs = this.getLatLngs().map((latlng) => latlng.clone());\n            return new L.Polyline(latlngs, options);\n        },\n\n        _makelatLngToCanvasPixelTransformer: function(printOptions, shift) {\n            const projectedBounds = printOptions.pixelBounds;\n            const scale = projectedBounds.getSize().unscaleBy(printOptions.destPixelSize);\n            const origin = projectedBounds.min;\n            return function(latlng) {\n                return L.CRS.EPSG3857.latLngToPoint(latlng, printOptions.zoom)\n                    .subtract(origin)\n                    .add(L.point([shift, 0]))\n                    .unscaleBy(scale);\n            };\n        },\n\n        _shift: function(targetBounds, zoom) {\n            const polylineBounds = this.getBounds();\n            let shift = 0;\n            const worldWidth = L.CRS.EPSG3857.getProjectedBounds(zoom).getSize().x;\n            if (polylineBounds.isValid()) {\n                const polylineCenter = polylineBounds.getCenter();\n                const targetCenter = targetBounds.getCenter();\n\n                if (polylineCenter.lng < targetCenter.lng - 180) {\n                    shift = 1;\n                } else if (polylineCenter.lng > targetCenter.lng + 180) {\n                    shift = -1;\n                } else {\n                    shift = 0;\n                }\n            }\n            return {lng: shift * 360, projected: worldWidth * shift};\n        },\n\n        _drawRaster: function(canvas, printOptions) {\n            const latlngs = this.getLatLngs();\n            const shift = this._shift(printOptions.latLngBounds, printOptions.zoom);\n            const lineBounds = this.getBounds();\n            if (latlngs.length < 2) {\n                return false;\n            }\n            const shiftedLineBounds = L.latLngBounds([\n                [lineBounds.getNorth(), lineBounds.getWest() + shift.lng],\n                [lineBounds.getSouth(), lineBounds.getEast() + shift.lng]\n            ]);\n            if (!shiftedLineBounds.intersects(printOptions.latLngBounds)) {\n                return false;\n            }\n\n            const ctx = canvas.getContext('2d');\n            ctx.lineWidth = this.printWidthMm / 25.4 * printOptions.resolution;\n            ctx.lineJoin = 'round';\n            ctx.lineCap = 'round';\n            ctx.strokeStyle = this.options.color;\n            const transform = this._makelatLngToCanvasPixelTransformer(printOptions, shift.projected);\n            let point;\n            ctx.beginPath();\n\n            point = transform(latlngs[0]);\n            ctx.moveTo(point.x, point.y);\n            for (let i = 1; i < latlngs.length; i++) {\n                point = transform(latlngs[i]);\n                ctx.lineTo(point.x, point.y);\n            }\n            ctx.stroke();\n            return true;\n        },\n\n        getTilesInfo: async function(printOptions) {\n            return {\n                iterateTilePromises: (function*() {\n                    yield {\n                        tilePromise: Promise.resolve({\n                                draw: (canvas) => this._drawRaster(canvas, printOptions),\n                                isOverlay: true\n                            }\n                        ),\n                        abortLoading: () => {\n                            // no actions needed\n                        }\n                    };\n                }).bind(this),\n                count: 1\n            };\n        }\n    }\n);\n\nL.MeasuredLine.include({\n        tickFontSizeMm: 2.5,\n\n        cloneForPrint: function(options) {\n            options = L.Util.extend({}, this.options, options);\n            const latlngs = this.getLatLngs().map((latlng) => latlng.clone());\n            return new L.MeasuredLine(latlngs, options);\n        },\n\n        _drawRaster: function(canvas, printOptions) {\n            if (!L.Polyline.prototype._drawRaster.call(this, canvas, printOptions)) {\n                return;\n            }\n            if (!this.options.measureTicksShown) {\n                return;\n            }\n            const minTicksIntervalMeters = printOptions.scale * 1.5;\n            const ctx = canvas.getContext('2d');\n            const ticks = this.getTicksPositions(minTicksIntervalMeters);\n            const ticksPixelSize = this.tickFontSizeMm / 25.4 * printOptions.resolution;\n            const shift = this._shift(printOptions.latLngBounds, printOptions.zoom);\n            const transform = this._makelatLngToCanvasPixelTransformer(printOptions, shift.projected);\n            ctx.font = `bold ${ticksPixelSize}px verdana`;\n            ctx.fillStyle = this.options.color;\n            for (let tick of ticks) {\n                let m = tick.transformMatrix;\n                let label = '\\u2501\\u2501 ' + Math.round((tick.distanceValue / 10)) / 100 + ' km';\n                let position = transform(tick.position);\n                ctx.setTransform(m[0], m[1], m[2], m[3], position.x, position.y);\n                ctx.fillText(label, 0, ticksPixelSize * 0.3);\n                ctx.setTransform(1, 0, 0, 1, 0, 0);\n            }\n        }\n    }\n);\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\n\nimport {RetinaTileLayer} from '~/lib/leaflet.layer.RetinaTileLayer';\nimport './TileLayer';\n\nRetinaTileLayer.include({\n    cloneForPrint: function(options) {\n        const newOptions = L.Util.extend({}, this.options, options);\n        return new RetinaTileLayer(this.urls, newOptions, newOptions.scaleDependent);\n    },\n\n    getTilesInfo: async function(printOptions) {\n        const tilesInfo = await L.TileLayer.prototype.getTilesInfo.call(this, printOptions);\n        tilesInfo.tileScale = this.tileSizeMultiplicator;\n        return tilesInfo;\n    },\n});\n","export default \"<div class=\\\"leaflet-control-button-toggle\\\" title=\\\"Print map\\\"\\n     data-bind=\\\"click: setExpanded, css: {'icon-spinner-nuclear': makingPdf, 'icon-printer': !makingPdf()}\\\">\\n    </div>\\n<div class=\\\"leaflet-control-content\\\">\\n<table class=\\\"layout\\\">\\n    <tbody>\\n    <tr><td colspan=\\\"2\\\">\\n        <a title=\\\"Add page in portrait orientation\\\" class=\\\"button-add-page-vert image-button\\\"\\n           data-bind=\\\"click: addPortraitPage\\\"></a>\\n        <a title=\\\"Add page in landscape orientation\\\" class=\\\"button-add-page-horiz image-button\\\"\\n           data-bind=\\\"click: addLandscapePage\\\"></a>\\n        <span class=\\\"pages-num\\\" data-bind=\\\"text: pagesNumLabel, click: onPagesNumLabelClick, css: {'pages-not-null': pagesNum() > 0}\\\"></span>\\n        <a title=\\\"Remove all pages\\\" class=\\\"button-remove-pages image-button\\\"\\n           data-bind=\\\"click: removePages\\\"></a>\\n    </td></tr>\\n    <tr>\\n        <td class=\\\"label\\\">Print scale</td>\\n        <td>\\n            <div class=\\\"preset-values\\\" >\\n                <a data-bind=\\\"click: function() {scale(100)}, css: {selected: scale() === 100}\\\">100 m</a>\\n                <a data-bind=\\\"click: function() {scale(500)}, css: {selected: scale() === 500}\\\">500 m</a>\\n                <a data-bind=\\\"click: function() {scale(1000)}, css: {selected: scale() === 1000}\\\">1 km</a>\\n            </div>\\n            <input type=\\\"text\\\" class=\\\"scale\\\" maxlength=\\\"6\\\" data-bind=\\\"value: scale\\\">&nbsp;m in 1 cm\\n        </td>\\n    </tr>\\n    <tr data-bind=\\\"visible: settingsExpanded\\\">\\n        <td class=\\\"label\\\">Page size</td>\\n        <td>\\n            <div class=\\\"preset-values\\\" data-bind=\\\"foreach: {data: pageSizes, as: 'size'}\\\">\\n                <a data-bind=\\\"click: function() {$root.pageWidth(size.width); $root.pageHeight(size.height)},\\n                              text: size.name,\\n                              css: {selected: size.name === $root.pageSizeDescription() }\\\"></a>\\n            </div>\\n            <input type=\\\"text\\\" maxlength=\\\"4\\\" title=\\\"width\\\" placeholder=\\\"width\\\" class=\\\"page-size\\\" data-bind=\\\"value: pageWidth\\\">\\n            x <input type=\\\"text\\\" maxlength=\\\"4\\\" title=\\\"height\\\" placeholder=\\\"height\\\" class=\\\"page-size\\\" data-bind=\\\"value: pageHeight\\\"> mm\\n        </td>\\n    </tr>\\n    <tr data-bind=\\\"visible: settingsExpanded\\\">\\n        <td class=\\\"label-high\\\">Margins</td>\\n        <td>\\n            <table class=\\\"margins\\\">\\n                <tr>\\n                    <td></td>\\n                    <td><input type=\\\"text\\\" maxlength=\\\"2\\\" value=\\\"3\\\" data-bind=\\\"value: marginTop\\\"></td>\\n                    <td></td>\\n                </tr>\\n                <tr>\\n                    <td><input type=\\\"text\\\" maxlength=\\\"2\\\" value=\\\"3\\\" data-bind=\\\"value: marginLeft\\\"></td>\\n                    <td></td><td><input type=\\\"text\\\" maxlength=\\\"2\\\" value=\\\"3\\\" data-bind=\\\"value: marginRight\\\"> mm</td>\\n                </tr>\\n                <tr><td></td><td><input type=\\\"text\\\" maxlength=\\\"2\\\" value=\\\"3\\\" data-bind=\\\"value: marginBottom\\\"></td><td></td></tr>\\n            </table>\\n        </td>\\n    </tr>\\n    <tr data-bind=\\\"visible: settingsExpanded\\\">\\n        <td class=\\\"label\\\">Resolution</td>\\n        <td><input type=\\\"text\\\" maxlength=\\\"4\\\" class=\\\"resolution\\\" data-bind=\\\"value: resolution\\\"> dpi</td>\\n    </tr>\\n    <tr data-bind=\\\"visible: settingsExpanded\\\">\\n        <td class=\\\"label\\\">Source zoom<br />level</td>\\n        <td>\\n            <select name=\\\"srczoom\\\"\\n                    data-bind=\\\"options: zoomLevels, value: zoomLevel\\\">\\n            </select>\\n        </td>\\n    </tr>\\n    <tr>\\n        <td colspan=\\\"2\\\">\\n            <label><input type=\\\"checkbox\\\" data-bind=\\\"checked: magneticMeridiansOn\\\"> Magnetic meridians</label>\\n            <label><input type=\\\"checkbox\\\" data-bind=\\\"checked: gridOn\\\"> Kilometers grid</label>\\n        </td>\\n    </tr>\\n    <tr><td colspan=\\\"2\\\">\\n        <a class=\\\"button-settings image-button\\\" data-bind=\\\"click: function() {settingsExpanded(!settingsExpanded())}\\\"\\n            title=\\\"More settings\\\"></a>\\n        <div class=\\\"settings-summary\\\">\\n            <span data-bind=\\\"text: pageSizeDescription\\\"></span><br/>\\n            <span data-bind=\\\"text: resolution\\\"></span>&nbsp;dpi,\\n            zoom&nbsp;<span data-bind=\\\"text: zoomLevel\\\"></span>\\n            <!-- ko if: zoomLevel()=== \\\"auto\\\" -->\\n            (<span title=\\\"Zoom for satellite and scanned imagery\\\" data-bind=\\\"text: autoZoomLevels().satZoom\\\"></span>&nbsp;\\n            /&nbsp;<span title=\\\"Zoom for maps like OSM and Google\\\" data-bind=\\\"text: autoZoomLevels().mapZoom\\\"></span>)\\n            <!-- /ko -->\\n        </div>\\n    </td></tr>\\n    <tr><td colspan=\\\"2\\\">\\n        <div class=\\\"download-button-row\\\">\\n            <div class=\\\"button-minimize\\\" data-bind=\\\"click: setMinimized\\\"></div>\\n            <a class=\\\"text-button button-save\\\" data-bind=\\\"\\n                                click: onSavePdfClicked,\\n                                visible: !makingPdf()\\\">Save PDF</a>\\n            <div data-bind=\\\"\\n                                component: { \\n                                    name: 'progress-indicator',\\n                                    params: {progressRange: downloadProgressRange, progressDone: downloadProgressDone}\\n                                },\\n                                visible: makingPdf()\\\"></div>\\n        </div>\\n    </td></tr>\\n    </tbody>\\n</table>\\n</div>\\n\";","function header() {\n    return '%PDF-1.3';\n}\n\nfunction eof() {\n    return '%%EOF\\n';\n}\n\nfunction recCatalog() {\n    return (\n`1 0 obj\n<< /Type /Catalog\n/Pages 2 0 R\n>>\nendobj`);\n}\n\nfunction recPages(count) {\n    let kidsIds = [];\n    for (let i = 0; i < count; i++) {\n        kidsIds.push(`${i * 3 + 3} 0 R`);\n    }\n    kidsIds = kidsIds.join(' ');\n    return (\n`2 0 obj\n<< /Type /Pages        \n/Kids [ ${kidsIds} ]\n/Count ${count}\n>>\nendobj`);\n}\n\nfunction recPage(serialNum, width, height) {\n    const pageRecId = serialNum * 3 + 3;\n    const contentRecId = pageRecId + 1;\n    const imageRecId = pageRecId + 2;\n    return (\n`${pageRecId} 0 obj\n<< /Type /Page\n/Parent 2 0 R\n/MediaBox [0 0 ${width} ${height}]\n/Contents ${contentRecId} 0 R\n/Rotate ${width > height ? 90 : 0}\n/Resources <<\n    /XObject << /Im${serialNum} ${imageRecId} 0 R >>\n    /ProcSet [ /PDF /Text /ImageC ] \n    >>\n>>\nendobj`);\n}\n\nfunction recContent(serialNum, width, height) {\n    const pageRecId = serialNum * 3 + 3;\n    const contentRecId = pageRecId + 1;\n    const contents = (\n`q\n${width} 0 0 ${height} 0 0 cm\n/Im${serialNum} Do\nQ   `);\n    return (\n`${contentRecId} 0 obj\n<<\n/Length ${contents.length + 1}\n>>\nstream\n${contents}   \nendstream\nendobj`);\n}\n\nfunction recImage(serialNum, widthPixels, heightPixels, data) {\n    const pageRecId = serialNum * 3 + 3;\n    const imageRecId = pageRecId + 2;\n\n    return (\n`${imageRecId} 0 obj\n<< /Type /XObject\n/Subtype /Image\n/Name /Im${serialNum}\n/Filter [ /DCTDecode ]\n/Width ${widthPixels}\n/Height ${heightPixels}\n/ColorSpace /DeviceRGB\n/BitsPerComponent 8\n/Length ${data.length}\n>>\nstream\n${data}\nendstream\nendobj`);\n}\n\nfunction recTrailer(recOffsets, currentOffset) {\n    const trailer = [];\n    trailer.push(\n`xref\n0 ${recOffsets.length + 1}\n0000000000 65535 f `);\n    const zeroes = '0000000000';\n    for (let offset of recOffsets) {\n        offset = offset.toString();\n        let padding = zeroes.substr(offset.length);\n        trailer.push(`${padding}${offset} 00000 n `);\n    }\n\n    trailer.push(\n`trailer\n<< /Root 1 0 R\n/Size ${recOffsets.length + 1}\n>>\nstartxref\n${currentOffset}`);\n    return trailer.join('\\n');\n}\n\nfunction makePdf(imagesInfo, resolution) {\n    let offset = 0;\n    const offsets = [];\n    let pdf = [];\n\n    function addRec(s, skipOffset) {\n        pdf.push(s);\n        if (!skipOffset) {\n            offsets.push(offset);\n        }\n        offset += s.length;\n    }\n\n    addRec(header(), true);\n    addRec(recCatalog());\n    addRec(recPages(imagesInfo.length));\n    for (let [i, {data, width, height}] of imagesInfo.entries()) {\n        let widthPoints = width / resolution * 72,\n            heightPoints = height / resolution * 72;\n        addRec(recPage(i, widthPoints, heightPoints));\n        addRec(recContent(i, widthPoints, heightPoints));\n        addRec(recImage(i, width, height, data));\n    }\n    addRec(recTrailer(offsets, offset), true);\n    addRec(eof(), true);\n\n    pdf = pdf.join('\\n');\n    return pdf;\n}\n\nexport {makePdf};\n\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {getDeclination} from '~/lib/magnetic-declination';\nimport {PrintStaticLayer} from './decorations';\n\nfunction radians(degrees) {\n    return degrees * Math.PI / 180;\n}\n\nfunction movePoint(p, angle, dist) {\n    angle = radians(angle);\n    return L.point(p.x + Math.sin(angle) * dist, p.y - Math.cos(angle) * dist);\n}\n\nclass MagneticMeridians extends PrintStaticLayer {\n    lineThicknessMm = 0.2;\n    lineIntervalMm = 50;\n    samplingIntervalMm = 15;\n    color = '#66c2ff';\n    overlaySolid = false;\n\n    _makeCanvasToLatLngTransformer(printOptions) {\n        const projectedBounds = printOptions.pixelBounds;\n        const scale = projectedBounds.getSize().unscaleBy(printOptions.destPixelSize);\n        const origin = projectedBounds.min;\n        return function(pixel) {\n            return L.CRS.EPSG3857.pointToLatLng(pixel.scaleBy(scale).add(origin), printOptions.zoom);\n        };\n    }\n\n    _drawRaster(canvas, printOptions) {\n        const toLatLng = this._makeCanvasToLatLngTransformer(printOptions);\n        const ctx = canvas.getContext('2d');\n        ctx.beginPath();\n        ctx.strokeStyle = this.color;\n        ctx.lineWidth = this.lineThicknessMm / 25.4 * printOptions.resolution;\n        const intervalPx = this.lineIntervalMm / 25.4 * printOptions.resolution;\n        const samplingPx = this.samplingIntervalMm / 25.4 * printOptions.resolution;\n        const pageDiagonal = Math.sqrt(\n            printOptions.destPixelSize.x * printOptions.destPixelSize.x +\n            printOptions.destPixelSize.y * printOptions.destPixelSize.y\n        );\n        const maxSegments = pageDiagonal / 2 / samplingPx;\n\n        function drawLine(p, directionDown) {\n            ctx.moveTo(p.x, p.y);\n\n            for (let i = 0; i <= maxSegments; i++) {\n                let latLng = toLatLng(p);\n                let declination = getDeclination(latLng.lat, latLng.lng);\n                if (declination === null) {\n                    break;\n                }\n                if (directionDown) {\n                    declination += 180;\n                }\n                p = movePoint(p, declination, samplingPx);\n                ctx.lineTo(p.x, p.y);\n            }\n        }\n\n        const center = printOptions.destPixelSize.divideBy(2);\n        const maxLines = pageDiagonal / 2 / intervalPx;\n\n        drawLine(center);\n        drawLine(center, true);\n\n        let p = center;\n        for (let i = 0; i <= maxLines; i++) {\n            let latLng = toLatLng(p);\n            let declination = getDeclination(latLng.lat, latLng.lng);\n            if (declination === null) {\n                declination = 0;\n            }\n            p = movePoint(p, declination + 90, intervalPx);\n            drawLine(p);\n            drawLine(p, true);\n        }\n        p = center;\n        for (let i = 0; i <= maxLines; i++) {\n            let latLng = toLatLng(p);\n            let declination = getDeclination(latLng.lat, latLng.lng);\n            if (declination === null) {\n                declination = 0;\n            }\n            p = movePoint(p, declination - 90, intervalPx);\n            drawLine(p);\n            drawLine(p, true);\n        }\n\n        ctx.stroke();\n    }\n}\n\nexport {MagneticMeridians};\n","import {PrintStaticLayer} from './decorations';\n\nfunction pageScaleRange(printOptions) {\n    const pageSize = printOptions.destPixelSize.divideBy(printOptions.resolution / 25.4);\n    const bounds = printOptions.latLngBounds;\n    const southLen = bounds.getSouthEast().distanceTo(bounds.getSouthWest());\n    const northLen = bounds.getNorthEast().distanceTo(bounds.getNorthWest());\n    const nScale = Math.round(northLen / pageSize.x * 10);\n    const sScale = Math.round(southLen / pageSize.x * 10);\n    return {\n        min: Math.min(nScale, sScale, printOptions.scale),\n        max: Math.max(nScale, sScale, printOptions.scale)\n    };\n}\n\nfunction formatScale(nominalScale, scaleRange) {\n    const threshold = 0.05;\n    if (\n        Math.abs(nominalScale - scaleRange.min) / nominalScale > threshold ||\n        Math.abs(nominalScale - scaleRange.max) / nominalScale > threshold\n    ) {\n        let unit;\n        scaleRange = {...scaleRange};\n        if (scaleRange.min >= 1000) {\n            scaleRange.min /= 1000;\n            scaleRange.max /= 1000;\n            unit = 'km';\n        } else {\n            unit = 'm';\n        }\n        return `${scaleRange.min} – ${scaleRange.max} ${unit} in 1 cm`;\n    }\n    let unit;\n    if (nominalScale >= 1000) {\n        nominalScale /= 1000;\n        unit = 'km';\n    } else {\n        unit = 'm';\n    }\n    return `${nominalScale} ${unit} in 1 cm`;\n}\n\nclass OverlayScale extends PrintStaticLayer {\n    fontSizeMm = 3;\n    font = 'verdana';\n    paddingMm = 1;\n    overlaySolid = true;\n\n    _drawRaster(canvas, printOptions) {\n        const ctx = canvas.getContext('2d');\n        let caption = formatScale(printOptions.scale, pageScaleRange(printOptions));\n        if (printOptions.pagesCount > 1) {\n            caption += ` | Page ${printOptions.pageLabel} / ${printOptions.pagesCount}`;\n        }\n        const fontSize = this.fontSizeMm / 25.4 * printOptions.resolution;\n        const padding = this.paddingMm / 25.4 * printOptions.resolution;\n        ctx.font = `${fontSize}px ${this.font}`;\n        const textWidth = ctx.measureText(caption).width;\n        ctx.textBaseline = 'bottom';\n        ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';\n        ctx.fillRect(0, 0, textWidth + 2 * padding, fontSize + 2 * padding);\n        ctx.fillStyle = '#000000';\n        ctx.fillText(caption, padding, fontSize + padding);\n    }\n}\n\nexport {OverlayScale};\n","import {PrintStaticLayer} from './decorations';\nimport L from 'leaflet';\n\nfunction radians(degrees) {\n    return degrees * Math.PI / 180;\n}\n\nclass Grid extends PrintStaticLayer {\n    minGridIntervalMm = 15;\n\n    fontSizeMm = 3;\n    font = 'verdana';\n    paddingMm = 1;\n\n    /* eslint-disable array-element-newline*/\n    intervals = [\n        1, 1.5, 2, 3.3, 5, 7.5,\n        10, 15, 20, 33, 50, 75,\n        100, 150, 200, 333, 500, 750,\n        1000, 1500, 2000, 4000, 5000, 7500,\n        10000, 15000, 20000, 40000, 50000, 75000,\n        100000, 150000, 200000, 400000, 500000, 750000,\n        1000000, 1500000, 2000000, 4000000, 5000000, 7500000\n    ];\n    /* eslint-enable array-element-newline*/\n\n    getGridInterval(printOptions) {\n        const minGridIntervalM = this.minGridIntervalMm / 10 * printOptions.scale;\n        let intervalM;\n        for (intervalM of this.intervals) {\n            if (intervalM > minGridIntervalM) {\n                break;\n            }\n        }\n        return intervalM;\n    }\n\n    formatDistance(x) {\n        let unit;\n        if (x < 1000) {\n            unit = 'm';\n        } else {\n            x /= 1000;\n            unit = 'km';\n        }\n        if (x % 1) {\n            x = x.toFixed(1);\n        }\n        return `${x} ${unit}`;\n    }\n\n    _drawGrid(canvas, printOptions) {\n        const metersPerDegree = L.Projection.SphericalMercator.R * Math.PI / 180;\n        const ctx = canvas.getContext('2d');\n        ctx.beginPath();\n        const pixelsPerMm = 1 / 25.4 * printOptions.resolution;\n        const intervalM = this.getGridInterval(printOptions);\n        const width = printOptions.destPixelSize.x;\n        const height = printOptions.destPixelSize.y;\n        const mercatorBounds = L.bounds(\n            L.Projection.SphericalMercator.project(printOptions.latLngBounds.getNorthWest()),\n            L.Projection.SphericalMercator.project(printOptions.latLngBounds.getSouthEast())\n        );\n        const canvasToMercatorScale = mercatorBounds.getSize().unscaleBy(printOptions.destPixelSize);\n        const rows = [];\n        let y = height;\n        while (true) {\n            let yMerc = mercatorBounds.max.y - y * canvasToMercatorScale.y;\n            let lat = L.Projection.SphericalMercator.unproject(L.point(0, yMerc)).lat;\n            rows.push({lat, y});\n            if (y < 0) {\n                break;\n            }\n            let lat2 = lat + intervalM / metersPerDegree;\n            let yMerc2 = L.Projection.SphericalMercator.project(L.latLng(lat2, 0)).y;\n            y = (mercatorBounds.max.y - yMerc2) / canvasToMercatorScale.y;\n        }\n        const lineWidthMm = 0.15;\n        let lineWidthPx = lineWidthMm * pixelsPerMm;\n        for (let {color, offset} of [\n            {color: '#D9D9D9', offset: lineWidthPx / 2},\n            {color: '#8C8C8C', offset: -lineWidthPx / 2},\n        ]) {\n            ctx.beginPath();\n\n            ctx.lineWidth = lineWidthPx;\n            ctx.strokeStyle = color;\n\n            for ({y} of rows) {\n                ctx.moveTo(0, y + offset);\n                ctx.lineTo(width, y + offset);\n            }\n            const pageCanvasCenterX = printOptions.destPixelSize.x / 2;\n            for (let direction of [-1, 1]) {\n                let colN = 0;\n                while (true) {\n                    let firstRow = true;\n                    let hasPointInPage = false;\n                    for (let {lat, y} of rows) {\n                        let dx = colN * intervalM / Math.cos(radians(lat)) / canvasToMercatorScale.x;\n                        // eslint-disable-next-line max-depth\n                        if (dx < pageCanvasCenterX) {\n                            hasPointInPage = true;\n                        }\n                        // eslint-disable-next-line max-depth\n                        if (firstRow) {\n                            ctx.moveTo(pageCanvasCenterX + dx * direction + offset, y);\n                        } else {\n                            ctx.lineTo(pageCanvasCenterX + dx * direction + offset, y);\n                        }\n                        firstRow = false;\n                    }\n                    if (!hasPointInPage) {\n                        break;\n                    }\n                    colN += 1;\n                }\n            }\n            ctx.stroke();\n        }\n    }\n\n    _drawLabel(canvas, printOptions) {\n        const intervalM = this.getGridInterval(printOptions);\n        const height = printOptions.destPixelSize.y;\n        const ctx = canvas.getContext('2d');\n        const caption = 'Grid ' + this.formatDistance(intervalM);\n        const fontSize = this.fontSizeMm / 25.4 * printOptions.resolution;\n        const padding = this.paddingMm / 25.4 * printOptions.resolution;\n        ctx.font = `${fontSize}px ${this.font}`;\n        const textWidth = ctx.measureText(caption).width;\n        ctx.textBaseline = 'bottom';\n        ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';\n        ctx.fillRect(0, height - fontSize - 2 * padding, textWidth + 2 * padding, fontSize + 2 * padding);\n        ctx.fillStyle = '#000000';\n        ctx.fillText(caption, padding, height - padding);\n    }\n\n    async getTilesInfo(printOptions) {\n        return {\n            iterateTilePromises: (function*() {\n                yield {\n                    tilePromise: Promise.resolve({\n                            draw: (canvas) => this._drawGrid(canvas, printOptions),\n                            isOverlay: true,\n                            overlaySolid: false\n                        }\n                    ),\n                    abortLoading: () => {\n                        // no actions needed\n                    }\n                };\n                yield {\n                    tilePromise: Promise.resolve({\n                            draw: (canvas) => this._drawLabel(canvas, printOptions),\n                            isOverlay: true,\n                            overlaySolid: true\n                        }\n                    ),\n                    abortLoading: () => {\n                        // no actions needed\n                    }\n                };\n            }).bind(this),\n            count: 2\n        };\n    }\n}\n\nexport {Grid};\n","import L from 'leaflet';\nimport './style.css';\nimport '~/lib/leaflet.control.commons';\n\nL.Control.Caption = L.Control.extend({\n    options: {\n        position: 'bottomright',\n        className: 'leaflet-control-caption'\n    },\n\n    initialize: function(contents, options) {\n        L.setOptions(this, options);\n        this._contents = contents;\n    },\n\n    onAdd: function(map) {\n        this._map = map;\n        this._container = L.DomUtil.create('div', this.options.className);\n        this._container.innerHTML = this._contents;\n        L.DomEvent.on(this._container, 'contextmenu', (e) => {\n            L.DomEvent.stopPropagation(e);\n            e.returnValue = true;\n            return true;\n        });\n        return this._container;\n    },\n\n    setContents: function(contents) {\n        this._contents = contents;\n        if (this._map) {\n            this._container.innerHTML = this._contents;\n        }\n    }\n\n});\n\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport ko from 'knockout';\nimport './coordinates.css';\nimport copyToClipboard from '~/lib/clipboardCopy';\nimport Contextmenu from '~/lib/contextmenu';\nimport {makeButtonWithBar} from '~/lib/leaflet.control.commons';\nimport safeLocalStorage from '~/lib/safe-localstorage';\nimport '~/lib/controls-styles/controls-styles.css';\nimport * as formats from './formats';\n\nconst DEFAULT_FORMAT = formats.DEGREES;\nconst UNKNOWN_COORDINATES = {\n    lat: '-------',\n    lng: '-------'\n};\n\nL.Control.Coordinates = L.Control.extend({\n        options: {\n            position: 'bottomleft'\n        },\n\n        formats: [\n            formats.SIGNED_DEGREES,\n            formats.DEGREES,\n            formats.DEGREES_AND_MINUTES,\n            formats.DEGREES_AND_MINUTES_AND_SECONDS\n        ],\n\n        initialize: function(options) {\n            L.Control.prototype.initialize.call(this, options);\n\n            this.latlng = ko.observable();\n            this.format = ko.observable(DEFAULT_FORMAT);\n            this.formatCode = ko.pureComputed({\n                read: () => this.format().code,\n                write: (value) => {\n                    for (let format of this.formats) {\n                        if (value === format.code) {\n                            this.format(format);\n                            break;\n                        }\n                    }\n                }\n            });\n\n            this.formattedCoordinates = ko.pureComputed(() => {\n                if (this.latlng()) {\n                    return formats.formatLatLng(this.latlng().wrap(), this.format());\n                }\n                return UNKNOWN_COORDINATES;\n            }, this);\n\n            this.wrapperClass = ko.pureComputed(() => this.format().wrapperClass, this);\n\n            this.formatCode.subscribe(this.saveStateToStorage, this);\n        },\n\n        onAdd: function(map) {\n            const {container, link, barContainer} = makeButtonWithBar(\n                'leaflet-contol-coordinates',\n                'Показать координаты под курсором',\n                'icon-coordinates'\n            );\n\n            this._map = map;\n            this._container = container;\n            this._link = link;\n\n            barContainer.innerHTML = `\n                <div data-bind=\"css: wrapperClass\">\n                    <div class=\"leaflet-coordinates-container\" data-bind=\"with: formattedCoordinates()\">\n                        <span class=\"leaflet-coordinates-latitude\" data-bind=\"html: lat\"></span>\n                        <span class=\"leaflet-coordinates-longitude\" data-bind=\"html: lng\"></span>\n                    </div>\n                    <hr class=\"leaflet-coordinates-divider\" />\n                    <div data-bind=\"foreach: formats\">\n                        <div>\n                            <label title=\"\">\n                                <input type=\"radio\" data-bind=\"checked: $parent.formatCode, value: code\" \n                                       class=\"leaflet-coordinates-format-radio\"/>\n                                <span data-bind=\"html: label\"></span>\n                            </label>\n                        </div>\n                    </div>\n                </div>\n            `;\n\n            barContainer.title = \"Правый клик для копирования координат\";\n\n            this.loadStateFromStorage();\n            ko.applyBindings(this, container);\n            L.DomEvent.on(link, 'click', this.onClick, this);\n\n            return container;\n        },\n\n        onRemove: function() {\n            L.DomEvent.off(this._link, 'click', this.onClick, this);\n        },\n\n        loadStateFromStorage: function() {\n            const active = safeLocalStorage.leafletCoordinatesActive === '1';\n            const code = safeLocalStorage.leafletCoordinatesFmt || DEFAULT_FORMAT.code;\n\n            this.formatCode(code);\n            this.setEnabled(active);\n        },\n\n        saveStateToStorage: function() {\n            safeLocalStorage.leafletCoordinatesActive = this.isEnabled() ? '1' : '0';\n            safeLocalStorage.leafletCoordinatesFmt = this.formatCode();\n        },\n\n        onMouseMove: function(e) {\n            this.latlng(e.latlng);\n        },\n\n        setEnabled: function(enabled) {\n            if (Boolean(enabled) === this.isEnabled()) {\n                return;\n            }\n            const classFunc = enabled ? 'addClass' : 'removeClass';\n            const eventFunc = enabled ? 'on' : 'off';\n            L.DomUtil[classFunc](this._container, 'active');\n            L.DomUtil[classFunc](this._container, 'highlight');\n            L.DomUtil[classFunc](this._map._container, 'coordinates-control-active');\n            this._map[eventFunc]('mousemove', this.onMouseMove, this);\n            this._map[eventFunc]('contextmenu', this.onMapRightClick, this);\n            this._isEnabled = Boolean(enabled);\n            this.latlng(null);\n        },\n\n        onMapRightClick: function(e) {\n            L.DomEvent.stop(e);\n\n            function createItem(format, options = {}) {\n                const {lat, lng} = formats.formatLatLng(e.latlng.wrap(), format);\n                const coordinates = `${lat} ${lng}`;\n\n                return {text: `${coordinates} <span class=\"leaflet-coordinates-menu-fmt\">${format.label}</span>`,\n                    callback: () => copyToClipboard(coordinates, e.originalEvent),\n                    ...options};\n            }\n\n            const header = createItem(this.format(), {\n                text: '<b>Скопировать в буфер обмена</b>',\n                header: true,\n            });\n            const items = this.formats.map((format) => createItem(format));\n            items.unshift(header, '-');\n\n            new Contextmenu(items).show(e);\n        },\n\n        isEnabled: function() {\n            return Boolean(this._isEnabled);\n        },\n\n        onClick: function() {\n            this.setEnabled(!this.isEnabled());\n            this.saveStateToStorage();\n        }\n    }\n);\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","function truncToFixed(x, precision) {\n    let s = x.toString();\n    let point = s.indexOf('.');\n    if (point === -1) {\n        point = s.length;\n        s += '.';\n    }\n    let sliceEnd = point + precision;\n    if (precision > 0) {\n        s = s.padEnd(point + precision + 1, '0');\n        sliceEnd += 1;\n    }\n    s = s.slice(0, sliceEnd);\n    return s;\n}\n\nfunction formatNumber(value, size, precision = 0) {\n    if (value < 0) {\n      throw new Error('Negative values not supported');\n    }\n\n    if (precision > 0) {\n        size += 1;\n    }\n    return truncToFixed(value, precision).padStart(size + precision, '0');\n}\n\nfunction coordinatePresentations(coordinate, isLat) {\n    const degrees = Math.abs(coordinate);\n    const intDegrees = Math.floor(degrees);\n    const minutes = (degrees - intDegrees) * 60;\n    const intMinutes = Math.floor(minutes);\n    const seconds = (minutes - intMinutes) * 60;\n\n    let direction;\n    if (isLat) {\n        direction = (coordinate < 0) ? 'S' : 'N';\n    } else {\n        direction = (coordinate < 0) ? 'W' : 'E';\n    }\n\n    return {\n        signedDegrees: coordinate.toFixed(5),\n        degrees: formatNumber(degrees, 0, 5),\n        intDegrees: formatNumber(intDegrees, 0),\n        minutes: formatNumber(minutes, 2, 3),\n        intMinutes: formatNumber(intMinutes, 2),\n        seconds: formatNumber(seconds, 2, 2),\n        direction\n    };\n}\n\nfunction formatLatLng(latlng, format) {\n    return {\n        lat: format.formatter(coordinatePresentations(latlng.lat, true)),\n        lng: format.formatter(coordinatePresentations(latlng.lng, false))\n    };\n}\n\nconst SIGNED_DEGREES = {\n    code: 'd',\n    label: '±ddd.ddddd',\n    wrapperClass: 'leaflet-coordinates-wrapper-signed-degrees',\n    formatter: ({signedDegrees}) => signedDegrees\n};\n\nconst DEGREES = {\n    code: 'D',\n    label: 'ddd.ddddd°',\n    wrapperClass: 'leaflet-coordinates-wrapper-degrees',\n    formatter: ({degrees, direction}) => `${direction} ${degrees}°`\n};\n\nconst DEGREES_AND_MINUTES = {\n    code: 'DM',\n    label: 'ddd°mm.mmm′',\n    wrapperClass: 'leaflet-coordinates-wrapper-degrees-and-minutes',\n    formatter: ({intDegrees, minutes, direction}) => `${direction} ${intDegrees}°${minutes}′`\n};\n\nconst DEGREES_AND_MINUTES_AND_SECONDS = {\n    code: 'DMS',\n    label: 'ddd°mm′ss.s″',\n    wrapperClass: 'leaflet-coordinates-wrapper-degrees-and-minutes-and-seconds',\n    formatter: ({intDegrees, intMinutes, seconds, direction}) => `${direction} ${intDegrees}°${intMinutes}′${seconds}″`\n};\n\nexport {\n    SIGNED_DEGREES,\n    DEGREES,\n    DEGREES_AND_MINUTES,\n    DEGREES_AND_MINUTES_AND_SECONDS,\n    formatLatLng\n};\n","import L from 'leaflet';\nimport './style.css';\n\nfunction getLayerHotkey(layer) {\n    if (!layer || !layer.options) {\n        return null;\n    }\n    let hotkey = layer.options.hotkey;\n    if (hotkey) {\n        return hotkey;\n    }\n    hotkey = layer.options.code;\n    if (hotkey && hotkey.length === 1) {\n        return hotkey;\n    }\n    return null;\n}\n\nfunction extendLayerName(name, layer) {\n    if (layer.options) {\n        const hotkey = getLayerHotkey(layer);\n        if (hotkey) {\n            name += `<span class=\"layers-control-hotkey\">${hotkey}</span>`;\n        }\n    }\n    return name;\n}\n\nfunction enableHotKeys(control) {\n    const originalOnAdd = control.onAdd;\n    const originalOnRemove = control.onRemove;\n    const originalAddItem = control._addItem;\n\n    if (control._hotKeysEnabled) {\n        return control;\n    }\n\n    L.Util.extend(control, {\n            _hotKeysEnabled: true,\n\n            _addItem: function(obj) {\n                if (!L.Browser.touch || !L.Browser.mobile) {\n                    obj = L.Util.extend({}, obj);\n                    obj.name = extendLayerName(obj.name, obj.layer);\n                }\n                return originalAddItem.call(this, obj);\n            },\n\n            onAdd: function(map) {\n                var result = originalOnAdd.call(this, map);\n                this._addHotketEvents();\n                return result;\n            },\n\n            onRemove: function(map) {\n                L.DomEvent.off(document, 'keyup', this._onHotkeyUp, this);\n                L.DomEvent.off(document, 'keydown', this.onKeyDown, this);\n                originalOnRemove.call(this, map);\n            },\n\n            _addHotKetEvents: function() {\n                L.DomEvent.on(document, 'keyup', this._onHotkeyUp, this);\n                L.DomEvent.on(document, 'keydown', this.onKeyDown, this);\n            },\n\n            onKeyDown: function(e) {\n                if (e.altKey || e.ctrlKey || e.shiftKey) {\n                    return;\n                }\n                this._keyDown = e.keyCode;\n            },\n\n            _onHotkeyUp: function(e) {\n                const pressedKey = this._keyDown;\n                this._keyDown = null;\n                const targetTag = e.target.tagName.toLowerCase();\n                if (\n                    (targetTag === 'input' && ['text', 'search'].includes(e.target.type)) ||\n                    targetTag === 'textarea' ||\n                    pressedKey !== e.keyCode\n                ) {\n                    return;\n                }\n                let key = String.fromCharCode(e.keyCode);\n                // Клавиша \"D\" - default - активирует слой по умолчанию\n                if ( 'D' === key ) {\n                    key = 'O'; // на данный момент, слой по умолчанию это OSM - клавиша \"O\"\n                }\n                for (let layer of this._layers) {\n                    let layerId = L.stamp(layer.layer);\n                    const layerHotkey = getLayerHotkey(layer.layer);\n                    if (layerHotkey === key) {\n                        const inputs = this._container.getElementsByTagName('input');\n                        for (let input of [...inputs]) {\n                            if (input.layerId === layerId) {\n                                input.click();\n                                break;\n                            }\n                        }\n                        break;\n                    }\n                }\n            }\n        }\n    );\n    for (let layer of control._layers) {\n        layer.name = extendLayerName(layer.name, layer.layer);\n    }\n    control._addHotKetEvents();\n    control._update();\n    return control;\n}\n\nexport default enableHotKeys;\n\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport './leaflet.hashState';\n\nL.Map.include(L.Mixin.HashState);\n\nL.Map.include({\n        stateChangeEvents: ['moveend'],\n\n        serializeState: function() {\n            var center = this.getCenter();\n            var zoom = this.getZoom();\n            var precision = 5;\n            var state = [\n                zoom.toString(),\n                center.lat.toFixed(precision),\n                center.lng.toFixed(precision)\n            ];\n            return state;\n        },\n\n        validateState: function(values) {\n            if (!values || values.length !== 3) {\n                return {valid: false};\n            }\n            let zoom = parseInt(values[0], 10),\n                lat = parseFloat(values[1]),\n                lng = parseFloat(values[2]);\n            if (isNaN(zoom) || isNaN(lat) || isNaN(lng) || zoom < 0 || zoom > 32 || lat < -90 || lat > 90) {\n                return {valid: false};\n            }\n            return {lat, lng, zoom, valid: true};\n        },\n\n        unserializeState: function(values) {\n            let {lat, lng, zoom, valid} = this.validateState(values);\n            if (valid) {\n                this.setView([lat, lng], zoom);\n                return true;\n            }\n            return false;\n        }\n    }\n);\n\n","import L from 'leaflet';\nimport './leaflet.hashState';\n\nL.Control.Layers.include(L.Mixin.HashState);\n\nL.Control.Layers.include({\n        stateChangeEvents: ['baselayerchange', 'overlayadd', 'overlayremove'],\n        stateChangeEventsSource: '_map',\n\n        serializeState: function() {\n            const keys = [];\n            this._map.eachLayer((layer) => {\n                    let key = layer.options.code;\n                    if (key) {\n                        keys.push([key, layer.options.zIndex]);\n                    }\n                }\n            );\n            keys.sort((k1, k2) => k1[1] - k2[1]);\n            const state = keys.map((k) => k[0]);\n            return state;\n        },\n\n        unserializeState: function(values) {\n            if (!values || values.length === 0) {\n                return false;\n            }\n\n            let hasBaselayer;\n            for (let layer of this._layers) {\n                if (layer.layer.options && values.includes(layer.layer.options.code) && !layer.overlay) {\n                    hasBaselayer = true;\n                    break;\n                }\n            }\n\n            if (!hasBaselayer) {\n                return false;\n            }\n\n            for (let layer of this._layers) {\n                if (layer.layer.options && values.includes(layer.layer.options.code)) {\n                    this._map.addLayer(layer.layer);\n                } else {\n                    this._map.removeLayer(layer.layer);\n                }\n            }\n            return true;\n        }\n    }\n);\n\n","import L from 'leaflet';\nimport './style.css';\nimport {fixVectorMarkerWorldJump} from './fixWorldCopyJump';\n\n// https://github.com/Leaflet/Leaflet/issues/3575\nfunction fixPanAnimationBug() {\n    if (!L.Browser.chrome) {\n        return;\n    }\n    if (L.PosAnimation.prototype.__panAnimationFixed) {\n        return;\n    }\n\n    const originalStep = L.PosAnimation.prototype._step;\n    L.PosAnimation.prototype._step = function() {\n        return originalStep.call(this, true);\n    };\n    L.PosAnimation.prototype.__panAnimationFixed = true;\n}\n\nfunction fixTouchDetection() {\n    L.Browser.touch &= ((navigator.pointerEnabled && !L.Browser.ie) || navigator.maxTouchPoints);\n}\n\nfunction fixMapKeypressEvent() {\n    const originalHandleDOMEvent = L.Map.prototype._handleDOMEvent;\n    L.Map.prototype._handleDOMEvent = function(e) {\n        if (e.type === 'keypress' && e.keyCode === 13) {\n            this._fireDOMEvent(e, e.type);\n        } else {\n            originalHandleDOMEvent.call(this, e);\n        }\n    };\n}\n\nfunction fixVectorDrawWhileAnimation() {\n    if (L.Renderer.__animationFixed) {\n        return;\n    }\n\n    const resetInterval = 300;\n\n    const originalGetEvents = L.Renderer.prototype.getEvents;\n\n    function onZoom() {\n        const now = Date.now();\n        if (!this._lastReset || (now - this._lastReset > resetInterval)) {\n            this._reset();\n            this._lastReset = now;\n        } else {\n            L.Renderer.prototype._onZoom.call(this);\n        }\n    }\n\n    function onMove() {\n        const now = Date.now();\n        if (!this._lastReset || (now - this._lastReset > resetInterval)) {\n            this._reset();\n            this._lastReset = now;\n        }\n    }\n\n    function getEvents() {\n        const result = originalGetEvents.call(this);\n        result.move = onMove;\n        result.zoom = onZoom;\n        return result;\n    }\n\n    L.Renderer.prototype.getEvents = getEvents;\n    L.Renderer.__animationFixed = true;\n}\n\nfunction allowControlHorizontalStacking() {\n    const original_addTo = L.Control.prototype.addTo;\n    L.Control.prototype.addTo = function(map) {\n        const result = original_addTo.call(this, map);\n        if (this.options.stackHorizontally) {\n            L.DomUtil.addClass(this._container, 'leaflet-control-horizontal-stack');\n        }\n        return result;\n    };\n}\n\nfunction addTooltipDelay() {\n    const origOpenTooltip = L.Layer.prototype._openTooltip;\n    L.Layer.prototype._openTooltip = function(e) {\n        if (this._tooltip.options.delay) {\n            const that = this;\n            this._pendingTooltip = setTimeout(() => origOpenTooltip.call(that, e), this._tooltip.options.delay);\n        } else {\n            origOpenTooltip.call(this, e);\n        }\n    };\n\n    const origCloseTooltip = L.Layer.prototype.closeTooltip;\n    L.Layer.prototype.closeTooltip = function() {\n        clearInterval(this._pendingTooltip);\n        origCloseTooltip.call(this);\n    };\n}\n\nfunction fixAll() {\n    fixPanAnimationBug();\n    fixTouchDetection();\n    fixMapKeypressEvent();\n    fixVectorDrawWhileAnimation();\n    fixVectorMarkerWorldJump();\n    allowControlHorizontalStacking();\n    addTooltipDelay();\n}\n\nexport {fixAll};\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport ko from 'knockout';\nimport '~/lib/leaflet.hashState/leaflet.hashState';\n\nimport './style.css';\nimport '~/lib/controls-styles/controls-styles.css';\nimport {makeButtonWithBar} from '~/lib/leaflet.control.commons';\nimport mapillaryProvider from './lib/mapillary';\nimport wikimediaProvider from './lib/wikimedia';\nimport {DragEvents} from '~/lib/leaflet.events.drag';\nimport {onElementResize} from '~/lib/anyElementResizeEvent';\nimport safeLocalStorage from '~/lib/safe-localstorage';\n\nconst PanoMarker = L.Marker.extend({\n    options: {\n        zIndexOffset: 10000\n    },\n\n    initialize: function() {\n        const icon = L.divIcon({\n                className: 'leaflet-panorama-marker-wraper',\n                html: '<div class=\"leaflet-panorama-marker\"></div>'\n            }\n        );\n        L.Marker.prototype.initialize.call(this, [0, 0], {icon, interactive: false});\n    },\n\n    getIcon: function() {\n        let markerIcon = this.getElement();\n        markerIcon = markerIcon.children[0];\n        return markerIcon;\n    },\n\n    setHeading: function(angle) {\n        const markerIcon = this.getIcon();\n        markerIcon.style.transform = `rotate(${angle || 0}deg)`;\n    },\n\n    setType: function(markerType) {\n        const className = {\n            slim: 'leaflet-panorama-marker-circle',\n            normal: 'leaflet-panorama-marker-binocular'\n        }[markerType];\n        this.getIcon().className = className;\n    }\n});\n\nL.Control.Panoramas = L.Control.extend({\n        includes: L.Evented,\n\n        options: {\n            position: 'topleft',\n            splitVerically: true,\n            splitSizeFraction: 0.5,\n            minViewerSize: 30,\n        },\n\n        getProviders: function() {\n            return [\n                {\n                    name: 'wikimedia',\n                    title: 'Фотки Wikimedia',\n                    provider: wikimediaProvider,\n                    layerOptions: {opacity: 0.7, zIndex: 9},\n                    code: 'w',\n                    selected: ko.observable(true),\n                    mapMarkerType: 'slim'\n                },\n                {\n                    name: 'mapillary',\n                    title: 'Панорамы Mapillary',\n                    provider: mapillaryProvider,\n                    layerOptions: {opacity: 0.7, zIndex: 8},\n                    code: 'm',\n                    selected: ko.observable(false),\n                    mapMarkerType: 'normal'\n                },\n            ];\n        },\n\n        initialize: function(options) {\n            L.Control.prototype.initialize.call(this, options);\n            this.loadSettings();\n            this._panoramasContainer = L.DomUtil.create('div', 'panoramas-container');\n            onElementResize(\n                this._panoramasContainer,\n                L.Util.requestAnimFrame.bind(null, this.onContainerResize.bind(this))\n            );\n            this.providers = this.getProviders();\n            for (let provider of this.providers) {\n                provider.selected.subscribe(this.updateCoverageVisibility, this);\n                provider.container = L.DomUtil.create('div', 'panorama-container', this._panoramasContainer);\n            }\n            this.nearbyPoints = [];\n        },\n\n        loadSettings: function() {\n            let storedSettings;\n            try {\n                storedSettings = JSON.parse(safeLocalStorage.panoramaSettings);\n            } catch {\n                // ignore\n            }\n            this._splitVerically = storedSettings?.spitVertically ?? this.options.splitVerically;\n            const fraction = storedSettings?.splitSizeFraction;\n            this._splitSizeFraction = isNaN(fraction) ? this.options.splitSizeFraction : fraction;\n        },\n\n        saveSetting: function() {\n            safeLocalStorage.panoramaSettings = JSON.stringify({\n                spitVertically: this._splitVerically,\n                splitSizeFraction: this._splitSizeFraction\n            });\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n\n            this._splitterDragging = false;\n            const splitter = L.DomUtil.create('div', 'panorama-splitter', this._panoramasContainer);\n            L.DomUtil.create('div', 'splitter-border', splitter);\n            const splitterButton = L.DomUtil.create('div', 'button', splitter);\n            new DragEvents(splitter, null, {trackOutsideElement: true}).on({\n                dragstart: this.onSplitterDragStart,\n                dragend: this.onSplitterDragEnd,\n                drag: this.onSplitterDrag,\n            }, this);\n            new DragEvents(splitterButton, null, {trackOutsideElement: true}).on({\n                click: this.onSplitterClick\n            }, this);\n            this.setupViewerLayout();\n            const {container, link, barContainer} = makeButtonWithBar(\n                'leaflet-contol-panoramas', 'Панорамы и фотки (Alt-P)', 'icon-panoramas');\n            map.on('resize', this.onMapResize, this);\n            this._container = container;\n            L.DomEvent.on(link, 'click', this.onButtonClick, this);\n            L.DomEvent.on(document, 'keyup', this.onKeyUp, this);\n            barContainer.innerHTML = `\n                 <div class=\"panoramas-list\" data-bind=\"foreach: providers\">\n                     <div>\n                         <label>\n                             <input type=\"checkbox\" data-bind=\"checked: selected\"><span data-bind=\"text: title\"></span>\n                         </label>\n                     </div>\n                 </div>\n             `;\n\n            ko.applyBindings(this, container);\n            map.createPane('rasterOverlay').style.zIndex = 300;\n            return container;\n        },\n\n        onSplitterDrag: function(e) {\n            const minSize = this.options.minViewerSize;\n            const container = this._panoramasContainer;\n            const oldSize = container[this._splitVerically ? 'offsetWidth' : 'offsetHeight'];\n            let newSize = oldSize + e.dragMovement[this._splitVerically ? 'x' : 'y'];\n            const mapSize = this._map._container[this._splitVerically ? 'offsetWidth' : 'offsetHeight'];\n            if (newSize < minSize) {\n                newSize = this.options.minViewerSize;\n            }\n            const maxSize = oldSize + mapSize - minSize;\n            if (newSize > maxSize) {\n                newSize = maxSize;\n            }\n            this.setContainerSizePixels(newSize);\n        },\n\n        onSplitterClick: function() {\n            this._splitVerically = !this._splitVerically;\n            this.saveSetting();\n            this.setupViewerLayout();\n        },\n\n        onButtonClick: function() {\n            this.switchControl();\n        },\n\n        switchControl: function() {\n            if (this.controlEnabled) {\n                this.disableControl();\n            } else {\n                this.enableControl();\n            }\n        },\n\n        onKeyUp: function(e) {\n            if (e.keyCode === 'P'.codePointAt(0) && e.altKey) {\n                this.switchControl();\n            }\n        },\n\n        enableControl: function() {\n            if (this.controlEnabled) {\n                return;\n            }\n            this.controlEnabled = true;\n            L.DomUtil.addClass(this._container, 'active');\n            this.updateCoverageVisibility();\n            this._map.on('click', this.onMapClick, this);\n            L.DomUtil.addClass(this._map._container, 'panoramas-control-active');\n            this.notifyChanged();\n        },\n\n        disableControl: function() {\n            if (!this.controlEnabled) {\n                return;\n            }\n            this.controlEnabled = false;\n            L.DomUtil.removeClass(this._container, 'active');\n            this.updateCoverageVisibility();\n            this._map.off('click', this.onMapClick, this);\n            this.hidePanoViewer();\n            L.DomUtil.removeClass(this._map._container, 'panoramas-control-active');\n            this.notifyChanged();\n        },\n\n        updateCoverageVisibility: function() {\n            if (!this._map) {\n                return;\n            }\n            for (let provider of this.providers) {\n                if (this.controlEnabled && provider.selected()) {\n                    if (!provider.coverageLayer) {\n                        const options = L.extend({pane: 'rasterOverlay'}, provider.layerOptions);\n                        provider.coverageLayer = provider.provider.getCoverageLayer(options);\n                    }\n                    provider.coverageLayer.addTo(this._map);\n                } else {\n                    if (provider.coverageLayer) {\n                        this._map.removeLayer(provider.coverageLayer);\n                    }\n                }\n            }\n            this.notifyChanged();\n        },\n\n        showPanoramaContainer: function() {\n            L.DomUtil.addClass(this._panoramasContainer, 'enabled');\n        },\n\n        panoramaVisible: function() {\n            if (L.DomUtil.hasClass(this._panoramasContainer, 'enabled')) {\n                for (let provider of this.providers) {\n                    if (L.DomUtil.hasClass(provider.container, 'enabled')) {\n                        return provider;\n                    }\n                }\n            }\n            return false;\n        },\n\n        setupNearbyPoints: function(points) {\n            for (let point of this.nearbyPoints) {\n                this._map.removeLayer(point);\n            }\n            this.nearbyPoints = [];\n            if (points) {\n                const icon = L.divIcon({className: 'leaflet-panorama-marker-point'});\n                for (let latlng of points) {\n                    this.nearbyPoints.push(L.marker(latlng, {icon}).addTo(this._map));\n                }\n            }\n        },\n\n        hidePano: function(provider) {\n            L.DomUtil.removeClass(provider.container, 'enabled');\n            if (provider.viewer) {\n                provider.viewer.deactivate();\n            }\n            this.setupNearbyPoints();\n        },\n\n        showPano: async function(provider, data) {\n            this.showPanoramaContainer();\n            for (let otherProvider of this.providers) {\n                if (otherProvider !== provider) {\n                    this.hidePano(otherProvider);\n                }\n            }\n            L.DomUtil.addClass(provider.container, 'enabled');\n            if (!provider.viewer) {\n                // eslint-disable-next-line require-atomic-updates\n                provider.viewer = await provider.provider.getViewer(provider.container);\n                this.setupViewerEvents(provider);\n            }\n            if (data) {\n                // wait for panorama container become of right size, needed for viewer setup\n                setTimeout(() => provider.viewer.showPano(data), 0);\n            }\n            provider.viewer.activate();\n            this.notifyChanged();\n        },\n\n        setupViewerEvents: function(provider) {\n            provider.viewer.on({\n                change: this.onPanoramaChangeView.bind(this, provider),\n                closeclick: this.onPanoramaCloseClick\n            }, this);\n        },\n\n        hidePanoViewer: function() {\n            for (let provider of this.providers) {\n                this.hidePano(provider);\n            }\n            L.DomUtil.removeClass(this._panoramasContainer, 'enabled');\n            this.hideMarker();\n            this.notifyChanged();\n        },\n\n        placeMarker: function(latlng, heading) {\n            if (!this.panoramaVisible()) {\n                return;\n            }\n            if (!this.marker) {\n                this.marker = new PanoMarker();\n            }\n            this._map.addLayer(this.marker);\n            this.marker.setLatLng(latlng);\n            this.marker.setHeading(heading);\n        },\n\n        hideMarker: function() {\n            if (this.marker) {\n                this._map.removeLayer(this.marker);\n            }\n        },\n        notifyChanged: function() {\n            this._map.fire('panoramachanged');\n        },\n\n        onPanoramaChangeView: function(provider, e) {\n            if (!this._map.getBounds().pad(-0.05).contains(e.latlng)) {\n                this._map.panTo(e.latlng);\n            }\n            this.placeMarker(e.latlng, e.heading);\n            this.marker.setType(provider.mapMarkerType);\n            this.setupNearbyPoints(e.latlngs);\n            this.notifyChanged();\n        },\n\n        onPanoramaCloseClick: function() {\n            this.hidePanoViewer();\n        },\n\n        onMapClick: async function(e) {\n            const\n                searchRadiusPx = 24,\n                p = this._map.project(e.latlng).add([searchRadiusPx, 0]),\n                searchRadiusMeters = e.latlng.distanceTo(this._map.unproject(p)),\n                promises = [];\n            for (let provider of this.providers) {\n                if (provider.selected()) {\n                    promises.push({\n                        promise: provider.provider.getPanoramaAtPos(e.latlng, searchRadiusMeters),\n                        provider: provider\n                    });\n                }\n            }\n\n            for (let {promise, provider} of promises) {\n                let searchResult = await promise;\n                if (searchResult.found) {\n                    this.showPano(provider, searchResult.data);\n                    return;\n                }\n            }\n        },\n\n        setupViewerLayout: function() {\n            let sidebar;\n            if (this._splitVerically) {\n                L.DomUtil.addClass(this._panoramasContainer, 'split-vertical');\n                L.DomUtil.removeClass(this._panoramasContainer, 'split-horizontal');\n                sidebar = 'left';\n                this._panoramasContainer.style.height = '100%';\n            } else {\n                L.DomUtil.addClass(this._panoramasContainer, 'split-horizontal');\n                L.DomUtil.removeClass(this._panoramasContainer, 'split-vertical');\n                sidebar = 'top';\n                this._panoramasContainer.style.width = '100%';\n            }\n            this._map.addElementToSidebar(sidebar, this._panoramasContainer);\n            this.updateContainerSize();\n        },\n\n        setContainerSizePixels: function(size) {\n            size = Math.round(size);\n            this._panoramasContainer.style[this._splitVerically ? 'width' : 'height'] = `${size}px`;\n            setTimeout(() => { // map size has not updated yet\n                const mapSize = this._map._container[this._splitVerically ? 'offsetWidth' : 'offsetHeight'];\n                this._splitSizeFraction = size / (mapSize + size);\n                this.saveSetting();\n            }, 0);\n        },\n\n        updateContainerSize: function() {\n            const fraction = this._splitSizeFraction;\n            const container = this._panoramasContainer;\n            const containerSize = container[this._splitVerically ? 'offsetWidth' : 'offsetHeight'];\n            const mapSize = this._map._container[this._splitVerically ? 'offsetWidth' : 'offsetHeight'];\n            const newSize = Math.round(fraction * (mapSize + containerSize));\n            container.style[this._splitVerically ? 'width' : 'height'] = `${newSize}px`;\n        },\n\n        onContainerResize: function() {\n            const provider = this.panoramaVisible();\n            if (provider && provider.viewer) {\n                provider.viewer.invalidateSize();\n            }\n        },\n\n        onMapResize: function() {\n            if (!this._splitterDragging) {\n                this.updateContainerSize();\n            }\n        },\n\n        onSplitterDragStart: function() {\n            this._splitterDragging = true;\n        },\n\n        onSplitterDragEnd: function() {\n            this._splitterDragging = false;\n        },\n    },\n);\n\nL.Control.Panoramas.include(L.Mixin.HashState);\nL.Control.Panoramas.include({\n        stateChangeEvents: ['panoramachanged'],\n\n        serializeState: function() {\n            let state = null;\n            if (this.controlEnabled) {\n                state = [];\n                let coverageCode = '_';\n                for (let provider of this.providers) {\n                    if (provider.selected()) {\n                        coverageCode += provider.code;\n                    }\n                }\n                state.push(coverageCode);\n                const provider = this.panoramaVisible();\n                if (provider && provider.viewer) {\n                    let viewerState = provider.viewer.getState();\n                    if (viewerState) {\n                        state.push(provider.code);\n                        state.push(...viewerState);\n                    }\n                }\n            }\n            return state;\n        },\n\n        unserializeState: function(state) {\n            if (!state) {\n                this.disableControl();\n                return true;\n            }\n\n            const coverageCode = state[0];\n            if (!coverageCode || coverageCode[0] !== '_') {\n                return false;\n            }\n            this.enableControl();\n            for (let provider of this.providers) {\n                provider.selected(coverageCode.includes(provider.code));\n            }\n            if (state.length > 2) {\n                const panoramaVisible = state[1];\n                for (let provider of this.providers) {\n                    if (panoramaVisible === provider.code) {\n                        this.showPano(provider).then(() => {\n                            const success = provider.viewer.setState(state.slice(2));\n                            if (!success) {\n                                this.hidePanoViewer();\n                            }\n                        });\n                        break;\n                    }\n                }\n            }\n            return true;\n        }\n    }\n);\n\nL.Control.Panoramas.hashStateUpgrader = function(panoramasControl) {\n    return L.Util.extend({}, L.Mixin.HashState, {\n        unserializeState: function(oldState) {\n            if (oldState) {\n                const upgradedState = ['_g'];\n                if (oldState.length) {\n                    upgradedState.push('g', ...oldState);\n                }\n                setTimeout(() => panoramasControl.unserializeState(upgradedState), 0);\n            }\n            return false;\n        },\n\n        serializeState: function() {\n            return null;\n        },\n    });\n};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {MapillaryCoverage} from './mapillary-coverage-layer';\nimport {fetch} from '~/lib/xhr-promise';\nimport config from '~/config';\nimport './style.css';\nimport {CloseButtonMixin, DateLabelMixin} from '../common';\n\nfunction getCoverageLayer(options) {\n    return new MapillaryCoverage(options);\n}\n\nfunction getMapillary() {\n    return new Promise((resolve) => {\n        require.ensure(['mapillary-js/dist/mapillary.min.js', 'mapillary-js/dist/mapillary.min.css'], () => {\n            require('mapillary-js/dist/mapillary.min.css');\n            resolve(require('mapillary-js/dist/mapillary.min.js'));\n        }, 'mapillary');\n    });\n}\n\nasync function getPanoramaAtPos(latlng, searchRadiusMeters) {\n    const url = `https://a.mapillary.com/v3/images?` +\n        `client_id=${config.mapillary}&closeto=${latlng.lng},${latlng.lat}&radius=${searchRadiusMeters}`;\n    const resp = await fetch(url, {responseType: 'json', timeout: 10000});\n    if (resp.status === 200 && resp.responseJSON.features.length) {\n        return {found: true, data: resp.responseJSON.features[0].properties.key};\n    }\n    return {found: false};\n}\n\nconst Viewer = L.Evented.extend({\n        includes: [CloseButtonMixin, DateLabelMixin],\n\n        initialize: function(mapillary, container) {\n            const id = `container-${L.stamp(container)}`;\n            container.id = id;\n            const viewer = this.viewer = new mapillary.Viewer(\n                id, config.mapillary, null, {component: {cover: false, bearing: false}});\n            window.addEventListener('resize', function() {\n                    viewer.resize();\n                }\n            );\n            viewer.on('nodechanged', this.onNodeChanged.bind(this));\n            viewer.on('bearingchanged', this.onBearingChanged.bind(this));\n            this.createDateLabel(container);\n            this.createCloseButton(container);\n            this._bearing = 0;\n            this._zoom = 0;\n            this._center = [0, 0];\n            this.invalidateSize = L.Util.throttle(this._invalidateSize, 100, this);\n        },\n\n        showPano: function(data) {\n            this.deactivate();\n            this.activate();\n            this.viewer.moveToKey(data).then(() => {\n                this.viewer.setZoom(0);\n                this.updateZoomAndCenter();\n            });\n        },\n\n        onNodeChanged: function(node) {\n            if (this._node && (node.key === this._node.key)) {\n                return;\n            }\n            this._node = node;\n            this.fireChangeEvent();\n            this.updateDateLabel(node.capturedAt);\n        },\n\n        getBearingCorrection: function() {\n            if (this._node && 'computedCA' in this._node) {\n                return (this._node.computedCA - this._node.originalCA);\n            }\n            return 0;\n        },\n\n        onBearingChanged: function(bearing) {\n            bearing -= this.getBearingCorrection();\n            if (this._bearing === bearing) {\n                return;\n            }\n            this._bearing = bearing;\n            this.fireChangeEvent();\n        },\n\n        fireChangeEvent: function() {\n            if (this._node) {\n                const latlon = this._node.originalLatLon;\n                this.fire('change', {\n                        latlng: L.latLng(latlon.lat, latlon.lon),\n                        heading: this._bearing,\n                        pitch: this._pitch,\n                        zoom: this._zoom\n                    }\n                );\n            }\n        },\n\n        deactivate: function() {\n            this.viewer.activateCover();\n            if (this._updateHandler) {\n                clearInterval(this._updateHandler);\n                this._updateHandler = null;\n            }\n        },\n\n        updateZoomAndCenter: function() {\n            this.viewer.getZoom().then((zoom) => {\n                this._zoom = zoom;\n            });\n            this.viewer.getCenter().then((center) => {\n                this._center = center;\n            });\n            this.viewer.getBearing().then((bearing) => {\n                this.onBearingChanged(bearing);\n            });\n        },\n\n        activate: function() {\n            this.viewer.resize();\n            this.viewer.deactivateCover();\n            if (!this._updateHandler) {\n                this._updateHandler = setInterval(() => this.updateZoomAndCenter(), 200);\n            }\n        },\n\n        getState: function() {\n            if (!this._node) {\n                return [];\n            }\n            const {lat, lon} = this._node.originalLatLon;\n            return [\n                lat.toFixed(6),\n                lon.toFixed(6),\n                this._center[0].toFixed(4),\n                this._center[1].toFixed(4),\n                this._zoom.toFixed(2)\n            ];\n        },\n\n        setState: function(state) {\n            const lat = parseFloat(state[0]);\n            const lng = parseFloat(state[1]);\n            const center0 = parseFloat(state[2]);\n            const center1 = parseFloat(state[3]);\n            const zoom = parseFloat(state[4]);\n            if (!isNaN(lat) && !isNaN(lng) && !isNaN(center0) && !isNaN(center1) && !isNaN(zoom)) {\n                this.viewer.moveCloseTo(lat, lng).then(() => {\n                    this.viewer.setCenter([center0, center1]);\n                    this.viewer.setZoom(zoom);\n                });\n                return true;\n            }\n            return false;\n        },\n\n        _invalidateSize: function() {\n            this.viewer.resize();\n        }\n    }\n);\n\nasync function getViewer(container) {\n    const mapillary = await getMapillary();\n    return new Viewer(mapillary, container);\n}\n\nconst mapillaryProvider = {getCoverageLayer, getPanoramaAtPos, getViewer};\nexport default mapillaryProvider;\n","import L from 'leaflet';\nimport {MapillaryLoader} from './mapillary-loader';\n\nconst MapillaryCoverage = L.GridLayer.extend({\n        options: {\n            tileSize: 1024,\n            updateWhenIdle: true,\n            color: '#00cfb1'\n        },\n\n        initialize: function(options) {\n            L.GridLayer.prototype.initialize.call(this, options);\n            this.loader = new MapillaryLoader(this.options.url, 12);\n        },\n\n        onAdd: function(map) {\n            L.GridLayer.prototype.onAdd.call(this, map);\n            this.on('tileunload', this.onTileUnload, this);\n        },\n\n        onRemove: function(map) {\n            L.GridLayer.prototype.onRemove.call(this, map);\n            this.off('tileunload', this.onTileUnload, this);\n        },\n\n        onTileUnload: function(e) {\n            const tile = e.tile;\n            tile._abortLoading();\n            delete tile._tileData;\n            delete tile._adjustment;\n        },\n\n        drawOverview: function(canvas) {\n            const\n                tileData = canvas._tileData;\n            if (!tileData['mapillary-sequence-overview']) {\n                return;\n            }\n            let {multiplier, offsetX, offsetY} = canvas._adjustment;\n            const canvasCtx = canvas.getContext('2d');\n            canvasCtx.fillStyle = this.options.color;\n            for (let feature of tileData['mapillary-sequence-overview']) {\n                if (feature.geometry.type !== 'Point') {\n                    throw new Error(`Invalid sequence overview geometry type \"${feature.geometry.type}\"`);\n                }\n                canvasCtx.beginPath();\n                let x = feature.geometry.coordinates[0] * multiplier - offsetX;\n                let y = feature.geometry.coordinates[1] * multiplier - offsetY;\n                canvasCtx.arc(x, y, 5, 0, 2 * Math.PI);\n                canvasCtx.fill();\n            }\n        },\n\n        drawSequences: function(canvas, lineWidth) {\n            let\n                tileData = canvas._tileData,\n                adjustment = canvas._adjustment;\n\n            if (!tileData['mapillary-sequences']) {\n                return;\n            }\n            const canvasCtx = canvas.getContext('2d');\n            canvasCtx.beginPath();\n            canvasCtx.strokeStyle = this.options.color;\n            canvasCtx.lineWidth = lineWidth;\n            // canvasCtx.lineWidth = thinLines ? 1 : 1;\n            canvasCtx.lineCap = \"round\";\n            canvasCtx.lineJoin = \"bevel\";\n            for (let feature of tileData['mapillary-sequences']) {\n                if (feature.geometry.type !== 'MultiLineString') {\n                    throw new Error(`Invalid sequence geometry type \"${feature.geometry.type}\"`);\n                }\n                let {multiplier, offsetX, offsetY} = adjustment;\n\n                let lines = feature.geometry.coordinates;\n                for (let lineI = 0; lineI < lines.length; lineI++) {\n                    let line = lines[lineI];\n                    if (!line.length) {\n                        continue;\n                    }\n                    let x = line[0][0] * multiplier - offsetX;\n                    let y = line[0][1] * multiplier - offsetY;\n                    canvasCtx.moveTo(x, y);\n                    if (line.length === 1) {\n                        canvasCtx.lineTo(x, y);\n                    }\n                    for (let pointI = 0; pointI < line.length; pointI++) {\n                        let x = line[pointI][0] * multiplier - offsetX;\n                        let y = line[pointI][1] * multiplier - offsetY;\n                        canvasCtx.lineTo(x, y);\n                    }\n                }\n            }\n            canvasCtx.stroke();\n        },\n\n        drawImages: function(canvas) {\n            let\n                tileData = canvas._tileData,\n                adjustment = canvas._adjustment;\n            if (!tileData['mapillary-images']) {\n                return;\n            }\n            let {multiplier, offsetX, offsetY} = adjustment;\n            const canvasCtx = canvas.getContext('2d');\n            canvasCtx.beginPath();\n            canvasCtx.fillStyle = this.options.color;\n            for (let feature of tileData['mapillary-images']) {\n                if (feature.geometry.type !== 'Point') {\n                    throw new Error(`Invalid image geometry type \"${feature.geometry.type}\"`);\n                }\n                canvasCtx.beginPath();\n                let x = feature.geometry.coordinates[0] * multiplier - offsetX;\n                let y = feature.geometry.coordinates[1] * multiplier - offsetY;\n                canvasCtx.arc(x, y, 4, 0, 2 * Math.PI);\n                canvasCtx.fill();\n            }\n        },\n\n        drawTile: function(canvas, coords) {\n            if (!this._map) {\n                return;\n            }\n            if (!canvas._tileData) {\n                return;\n            }\n            if (coords.z < 6 + 2) {\n                this.drawOverview(canvas);\n            } else if (coords.z < 14 + 2) {\n                let width = coords.z < 14 ? 10 : 5;\n                this.drawSequences(canvas, width);\n            } else {\n                this.drawSequences(canvas, 2);\n                this.drawImages(canvas);\n            }\n        },\n\n        createTile: function(coords, done) {\n            const canvas = L.DomUtil.create('canvas', 'leaflet-tile');\n            canvas.width = this.options.tileSize;\n            canvas.height = this.options.tileSize;\n            let {dataPromise, abortLoading} = this.loader.requestTileData(coords);\n            dataPromise.then((data) => {\n                if (!data.error) {\n                    canvas._tileData = data.tileData;\n                    canvas._adjustment = data.adjustment || {multiplier: 1, offsetX: 0, offsetY: 0};\n                    setTimeout(() => {\n                        this.drawTile(canvas, coords);\n                        done(null, canvas);\n                    }, 1);\n                }\n            });\n            canvas._abortLoading = abortLoading;\n            return canvas;\n        },\n\n    }\n);\n\nexport {MapillaryCoverage};\n","import L from 'leaflet';\nimport {TiledDataLoader} from '~/lib/tiled-data-loader';\nimport {decodeMvt} from './mvt';\n\nclass MapillaryLoader extends TiledDataLoader {\n    url = 'https://d25uarhxywzl1j.cloudfront.net/v0.1/{z}/{x}/{y}.mvt';\n    maxZoom = 14;\n\n    getTileUrl(coords) {\n        const data = {\n            x: coords.x,\n            z: coords.z,\n            y: coords.y\n        };\n        return L.Util.template(this.url, data);\n    }\n\n    layerTileToDataTileCoords(layerTileCoords) {\n        let z = layerTileCoords.z - 2;\n        let z2 = null;\n        if (z > 6 && z <= 10) {\n            z2 = 6;\n        } else if (z >= 11 && z < 14) {\n            z2 = z - 4;\n        } else if (z < 0) {\n            z2 = 0;\n        } else if (z > this.maxZoom) {\n            z2 = this.maxZoom;\n        } else {\n            return {z, x: layerTileCoords.x, y: layerTileCoords.y};\n        }\n\n        let multiplier = 1 << (z - z2);\n        return {\n            x: Math.floor(layerTileCoords.x / multiplier),\n            y: Math.floor(layerTileCoords.y / multiplier),\n            z: z2\n        };\n    }\n\n    makeRequestData(dataTileCoords) {\n        return {\n            url: this.getTileUrl(dataTileCoords),\n            options: {\n                responseType: 'arraybuffer',\n                timeout: 10000,\n                isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403\n            }\n        };\n    }\n\n    calcAdjustment(layerTileCoords, dataTileCoords) {\n        let adjustment = super.calcAdjustment(\n            {x: layerTileCoords.x, y: layerTileCoords.y, z: layerTileCoords.z - 2},\n            dataTileCoords\n        );\n        if (adjustment) {\n            adjustment.offsetX *= 1024;\n            adjustment.offsetY *= 1024;\n        }\n        return adjustment;\n    }\n\n    async processResponse(xhr, originalDataTileCoords) {\n        return this._processResponse(xhr, originalDataTileCoords);\n    }\n\n    async _processResponse(xhr, originalDataTileCoords) {\n        let tileData;\n        if (xhr.status === 200 && xhr.response) {\n            const layers = decodeMvt(xhr.response, 1024);\n            tileData = {};\n            for (let layer of layers) {\n                tileData[layer.name] = layer.features;\n            }\n        } else {\n            tileData = null;\n        }\n\n        return {\n            tileData,\n            coords: originalDataTileCoords\n        };\n    }\n}\n\nexport {MapillaryLoader};\n","class Cache {\n    constructor(maxSize) {\n        this._maxSize = maxSize;\n        this._store = {};\n        this._size = 0;\n    }\n\n    get(key) {\n        if (key in this._store) {\n            const value = this._store[key];\n            delete this._store[key];\n            this._store[key] = value;\n            return {value, found: true};\n        }\n        return {found: false};\n    }\n\n    put(key, value) {\n        if (key in this._store) {\n            delete this._store[key];\n        } else {\n            this._size += 1;\n        }\n        this._store[key] = value;\n        if (this._size > this._maxSize) {\n            delete this._store[Object.keys(this._store)[0]];\n            this._size -= 1;\n        }\n    }\n}\n\nexport {Cache};\n","import Pbf from 'pbf';\nimport {Tile as TileProto} from './vector_tile_pb';\n\nfunction decodeCoordinate(x) {\n    return ((x >> 1) ^ (-(x & 1)));\n}\n\nfunction parseGeometry(geometryType, ints, coordinatesScale) { // eslint-disable-line complexity\n    if (geometryType !== TileProto.GeomType.POINT && geometryType !== TileProto.GeomType.LINESTRING &&\n        geometryType !== TileProto.GeomType.POLYGON) {\n        throw new Error(`Unknown feature geometry type ${geometryType}`);\n    }\n    const len = ints.length;\n    let pos = 0;\n    const lineStrings = [];\n    let line;\n    let x = 0,\n        y = 0;\n    while (pos < len) {\n        let i = ints[pos];\n        let cmd = i & 0x7;\n        let cmdRepeat = i >> 3;\n        switch (cmd) {\n            case 1: // MoveTo\n                if (cmdRepeat !== 1) {\n                    throw new Error(`repeat=${cmdRepeat} for command MoveTo`);\n                }\n                if (pos + 2 > len) {\n                    throw new Error('Not enough elements for MoveTo arguments');\n                }\n                if (line) {\n                    lineStrings.push(line);\n                }\n                x += decodeCoordinate(ints[pos + 1]);\n                y += decodeCoordinate(ints[pos + 2]);\n                line = [[x * coordinatesScale, y * coordinatesScale]];\n                pos += 3;\n                break;\n            case 2: // LineTo\n                if (cmdRepeat < 1) {\n                    throw new Error(`repeat=${cmdRepeat} for command LineTo`);\n                }\n                if (!line) {\n                    throw new Error('LineTo with empty linestring');\n                }\n                pos += 1;\n                for (let cmdN = 0; cmdN < cmdRepeat; cmdN++) {\n                    if (pos + 2 > len) {\n                        throw new Error('Not enough elements for LineTo arguments');\n                    }\n                    x += decodeCoordinate(ints[pos]);\n                    y += decodeCoordinate(ints[pos + 1]);\n                    line.push([x * coordinatesScale, y * coordinatesScale]);\n                    pos += 2;\n                }\n                break;\n            case 7: // ClosePath\n                if (geometryType !== TileProto.GeomType.POLYGON) {\n                    throw new Error(`ClosePath command for non-polygon type ${geometryType}`);\n                }\n                if (!line) {\n                    throw new Error('ClosePath with empty linestring');\n                }\n                if (cmdRepeat !== 1) {\n                    throw new Error(`ClosePath repeats ${cmdRepeat} times`);\n                }\n                line.push(line[0]);\n                pos += 1;\n                break;\n            default:\n                throw new Error(`Unknown command ${i} & 0x7 = ${cmd}`);\n        }\n    }\n    if (line) {\n        lineStrings.push(line);\n    }\n    const geometry = {};\n    switch (geometryType) {\n        case TileProto.GeomType.POINT:\n            if (lineStrings.length !== 1 || lineStrings[0].length !== 1) {\n                throw new Error('Invalid coordinates number for point');\n            }\n            geometry.type = 'Point';\n            geometry.coordinates = lineStrings[0][0];\n            break;\n        case TileProto.GeomType.LINESTRING:\n            geometry.type = 'MultiLineString';\n            geometry.coordinates = lineStrings;\n            break;\n        case TileProto.GeomType.POLYGON:\n            geometry.type = 'Polygon';\n            geometry.coordinates = lineStrings;\n            break;\n        default:\n    }\n    return geometry;\n}\n\nfunction parseFeatures(layer, coordinatesScale) {\n    const features = [];\n    for (let feature of layer.features) {\n        const geometry = parseGeometry(feature.type, feature.geometry, coordinatesScale);\n        features.push({geometry});\n    }\n    return features;\n}\n\nfunction decodeMvt(ar, tileExtent = 256) {\n    const\n        pbf = new Pbf(new Uint8Array(ar)),\n        tileData = TileProto.read(pbf);\n    const parsedLayers = [];\n    for (let layer of tileData.layers) {\n        let scale = tileExtent / layer.extent;\n        parsedLayers.push({\n            name: layer.name,\n            features: parseFeatures(layer, scale)\n        });\n    }\n    return parsedLayers;\n}\n\nexport {decodeMvt};\n","// code generated by pbf v3.0.5\n\n// Tile ========================================\n\nvar Tile = exports.Tile = {};\n\nTile.read = function (pbf, end) {\n    return pbf.readFields(Tile._readField, {layers: []}, end);\n};\nTile._readField = function (tag, obj, pbf) {\n    if (tag === 3) obj.layers.push(Tile.Layer.read(pbf, pbf.readVarint() + pbf.pos));\n};\n\nTile.GeomType = {\n    \"UNKNOWN\": 0,\n    \"POINT\": 1,\n    \"LINESTRING\": 2,\n    \"POLYGON\": 3\n};\n\n\n// Tile.Feature ========================================\n\nTile.Feature = {};\n\nTile.Feature.read = function (pbf, end) {\n    return pbf.readFields(Tile.Feature._readField, {id: 0, tags: [], type: 0, geometry: []}, end);\n};\nTile.Feature._readField = function (tag, obj, pbf) {\n    if (tag === 3) obj.type = pbf.readVarint();\n    else if (tag === 4) pbf.readPackedVarint(obj.geometry);\n};\n\n// Tile.Layer ========================================\n\nTile.Layer = {};\n\nTile.Layer.read = function (pbf, end) {\n    return pbf.readFields(Tile.Layer._readField, {version: 0, name: \"\", features: [], keys: [], values: [], extent: 0}, end);\n};\nTile.Layer._readField = function (tag, obj, pbf) {\n    if (tag === 15) obj.version = pbf.readVarint();\n    else if (tag === 1) obj.name = pbf.readString();\n    else if (tag === 2) obj.features.push(Tile.Feature.read(pbf, pbf.readVarint() + pbf.pos));\n    else if (tag === 5) obj.extent = pbf.readVarint();\n};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport './style.css';\n\nconst CloseButtonMixin = {\n    createCloseButton: function(container) {\n        this.closeButton = L.DomUtil.create('div', 'photo-viewer-button-close', container);\n        L.DomEvent.on(this.closeButton, 'click', this.onCloseClick, this);\n    },\n\n    onCloseClick: function() {\n        this.fire('closeclick');\n    },\n};\n\nfunction formatDateTime(ts) {\n    const d = new Date(ts);\n    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n    return `${d.getDate()} ${months[d.getMonth()]} ${d.getFullYear()}`;\n}\n\nconst DateLabelMixin = {\n    createDateLabel: function(container) {\n        this.dateLabel = L.DomUtil.create('div', 'mapillary-viewer-date-overlay', container);\n    },\n\n    updateDateLabel: function(timestamp) {\n        this.dateLabel.innerHTML = formatDateTime(timestamp);\n    }\n};\n\nexport {CloseButtonMixin, DateLabelMixin};\n","import L from 'leaflet';\nimport {MultiLayer, WikimediaVectorCoverage} from './coverage-layer';\nimport {fetch} from '~/lib/xhr-promise';\nimport './style.css';\nimport '../common/style.css';\nimport config from '~/config';\n\nfunction getCoverageLayer(options) {\n    const url = config.wikimediaCommonsCoverageUrl;\n    return new MultiLayer([\n        {layer: L.tileLayer(url, L.extend({}, options, {tms: true})), minZoom: 0, maxZoom: 10},\n        {layer: new WikimediaVectorCoverage(url, options), minZoom: 11, maxZoom: 18}\n    ]);\n}\n\nfunction parseSearchResponse(resp) { // eslint-disable-line complexity\n    const images = [];\n    if (resp && resp.query && resp.query.pages && resp.query.pages) {\n        for (let page of Object.values(resp.query.pages)) {\n            if (!page.coordinates || page.title.slice(-4).toLowerCase() !== '.jpg') {\n                continue;\n            }\n\n            const iinfo = page.imageinfo[0];\n            let imageDescription = iinfo.extmetadata.ImageDescription ? iinfo.extmetadata.ImageDescription.value : null;\n            let objectDescription = iinfo.extmetadata.ObjectName ? iinfo.extmetadata.ObjectName.value : null;\n            if (imageDescription && /^<table (.|\\n)+<\\/table>$/u.test(imageDescription)) {\n                imageDescription = null;\n            }\n            if (imageDescription) {\n                imageDescription = imageDescription.replace(/<[^>]+>/ug, '');\n                imageDescription = imageDescription.replace(/[\\n\\r]/ug, '');\n            }\n            if (\n                imageDescription &&\n                objectDescription &&\n                objectDescription.toLowerCase().includes(imageDescription.toLowerCase())\n            ) {\n                imageDescription = null;\n            }\n            if (\n                objectDescription &&\n                imageDescription &&\n                imageDescription.toLowerCase().includes(objectDescription.toLowerCase())\n            ) {\n                objectDescription = null;\n            }\n            let description = 'Wikimedia commons';\n            if (objectDescription || imageDescription) {\n                description = '';\n                if (objectDescription) {\n                    description = objectDescription;\n                }\n                if (imageDescription) {\n                    // eslint-disable-next-line max-depth\n                    if (objectDescription) {\n                        description += '</br>';\n                    }\n                    description += imageDescription;\n                }\n            }\n\n            let author = iinfo.extmetadata.Artist ? iinfo.extmetadata.Artist.value : null;\n            if (author && /^<table (.|\\n)+<\\/table>$/u.test(author)) {\n                author = `See author info at <a href=\"${iinfo.descriptionurl}\">Wikimedia commons</a>`;\n            }\n\n            // original images can be rotated, 90 degrees\n            // thumbnails are always oriented right\n            // so we request thumbnail of original image size\n            let url = iinfo.thumburl.replace('134px', `${iinfo.width}px`);\n            images.push({\n                url,\n                width: iinfo.width,\n                height: iinfo.height,\n                lat: page.coordinates[0].lat,\n                lng: page.coordinates[0].lon,\n                author: author,\n                timeOriginal: iinfo.extmetadata.DateTimeOriginal ? iinfo.extmetadata.DateTimeOriginal.value : null,\n                time: iinfo.extmetadata.DateTime ? iinfo.extmetadata.DateTime.value : null,\n                description: description,\n                pageUrl: iinfo.descriptionurl,\n                pageId: page.pageid.toString()\n            });\n        }\n        if (images.length) {\n            return images;\n        }\n    }\n    return null;\n}\n\nfunction isCloser(target, a, b) {\n    const d1 = target.distanceTo(a);\n    const d2 = target.distanceTo(b);\n    if (d1 < d2) {\n        return -1;\n    } else if (d1 === d2) {\n        return 0;\n    }\n    return 1;\n}\n\nasync function getPanoramaAtPos(latlng, searchRadiusMeters) {\n    latlng = L.latLng(latlng.lat, latlng.lng); // make independent copy\n\n    const clusterSize = 10;\n    const urlTemplate = 'https://commons.wikimedia.org/w/api.php?' +\n                        'origin=*&format=json&action=query&generator=geosearch&' +\n                        'ggsprimary=all&ggsnamespace=6&ggslimit=10&iilimit=1&coprimary=all&' +\n                        'ggsradius={radius}&ggscoord={lat}|{lng}&' +\n                        'iiurlwidth=134&' +\n                        'prop=imageinfo|coordinates&' +\n                        'iiprop=url|mime|size|extmetadata|commonmetadata|metadata';\n    searchRadiusMeters += clusterSize;\n    if (searchRadiusMeters < 10) {\n        searchRadiusMeters = 10;\n    }\n    if (searchRadiusMeters > 10000) {\n        searchRadiusMeters = 10000;\n    }\n    const url = L.Util.template(urlTemplate, {lat: latlng.lat, lng: latlng.lng, radius: Math.ceil(searchRadiusMeters)});\n    const resp = await fetch(url, {responseType: 'json', timeout: 10000});\n    if (resp.status === 200) {\n        let photos = parseSearchResponse(resp.responseJSON);\n        if (photos) {\n            photos.sort(isCloser.bind(null, latlng));\n            const nearestLatlng = L.latLng(photos[0].lat, photos[0].lng);\n            photos = photos.filter((photo) => nearestLatlng.distanceTo(L.latLng(photo.lat, photo.lng)) <= clusterSize);\n            return {\n                found: true,\n                data: photos\n            };\n        }\n        return {found: false};\n    }\n    return {found: false};\n}\n\nfunction formatDateTime(dateStr) {\n    const m = /^(\\d+)-(\\d+)-(\\d+)/u.exec(dateStr);\n    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n    if (m) {\n        let [year, month, day] = m.slice(1);\n        return `${day} ${months[month - 1]} ${year}`;\n    }\n    return dateStr;\n}\n\nconst Viewer = L.Evented.extend({\n    initialize: function(container) {\n        container = L.DomUtil.create('div', 'wikimedia-viewer-container', container);\n        const mapContainer = this.mapContainer = L.DomUtil.create('div', 'wikimedia-viewer-map-container', container);\n        this.pageButtonContainer = L.DomUtil.create('div', 'wikimedia-viewer-page-buttons-container', container);\n\n        this.map = L.map(mapContainer, {\n            maxBoundsViscosity: 1,\n            crs: L.CRS.Simple,\n            zoomControl: false,\n            attributionControl: false,\n            zoomSnap: 0,\n        });\n\n        this.map.on('zoomend', this.notifyChange, this);\n        this.map.on('moveend', this.notifyChange, this);\n\n        this.infoLabel = L.DomUtil.create('div', 'wikimedia-viewer-info-overlay', mapContainer);\n        this.closeButton = L.DomUtil.create('div', 'photo-viewer-button-close', container);\n        this.prevPhotoButton = L.DomUtil.create('div', 'wikimedia-viewer-button-prev', mapContainer);\n        this.nextPhotoButton = L.DomUtil.create('div', 'wikimedia-viewer-button-next', mapContainer);\n        L.DomEvent.on(this.prevPhotoButton, 'click', () => {\n            this.switchPhoto(this._imageIdx - 1);\n        });\n        L.DomEvent.on(this.nextPhotoButton, 'click', () => {\n            this.switchPhoto(this._imageIdx + 1);\n        });\n        L.DomEvent.on(this.closeButton, 'click', this.onCloseClick, this);\n    },\n\n    setupPageButtons: function(count) {\n        if (this._buttons) {\n            for (let button of this._buttons) {\n                this.pageButtonContainer.removeChild(button);\n            }\n        }\n        this._buttons = [];\n        if (count > 1) {\n            L.DomUtil.addClass(this.pageButtonContainer, 'enabled');\n\n            for (let i = 0; i < count; i++) {\n                let button = L.DomUtil.create('div', 'wikimedia-viewer-page-button', this.pageButtonContainer);\n                button.innerHTML = String(i + 1);\n                this._buttons.push(button);\n                L.DomEvent.on(button, 'click', () => this.switchPhoto(i));\n            }\n        } else {\n            L.DomUtil.removeClass(this.pageButtonContainer, 'enabled');\n        }\n    },\n\n    switchPhoto: function(imageIdx, imagePos = null) {\n        this._imageIdx = imageIdx;\n        if (this.imageLayer) {\n            this.map.removeLayer(this.imageLayer);\n        }\n        let image = this.images[imageIdx];\n        let mapSize = this.map.getSize();\n        if (!mapSize.x || !mapSize.y) {\n            mapSize = {x: 500, y: 500};\n        }\n        let maxZoom = Math.log2(Math.max(image.width / mapSize.x, image.height / mapSize.y)) + 2;\n        if (maxZoom < 1) {\n            maxZoom = 1;\n        }\n        let\n            southWest = this.map.unproject([0, image.height], maxZoom - 2),\n            northEast = this.map.unproject([image.width, 0], maxZoom - 2);\n        const bounds = new L.LatLngBounds(southWest, northEast);\n        this.map.setMaxZoom(maxZoom);\n        this.map.setMaxBounds(bounds);\n        if (imagePos) {\n            this.map.setView(imagePos.center, imagePos.zoom, {animate: false});\n        } else {\n            this.map.fitBounds(bounds, {animate: false});\n        }\n\n        this.imageLayer = L.imageOverlay(null, bounds);\n        L.DomUtil.addClass(this.mapContainer, 'loading');\n        this.imageLayer.on('load', () => {\n            L.DomUtil.removeClass(this.mapContainer, 'loading');\n        });\n        this.imageLayer.setUrl(image.url);\n        this.imageLayer.addTo(this.map);\n        let caption = [];\n\n        if (image.timeOriginal) {\n            caption.push(formatDateTime(image.timeOriginal));\n        }\n        if (image.author) {\n            caption.push(image.author);\n        }\n        caption.push(`<a href=\"${image.pageUrl}\">${image.description}</a>`);\n        caption = caption.join('</br>');\n        this.infoLabel.innerHTML = caption;\n\n        if (imageIdx > 0) {\n            L.DomUtil.addClass(this.prevPhotoButton, 'enabled');\n        } else {\n            L.DomUtil.removeClass(this.prevPhotoButton, 'enabled');\n        }\n        if (imageIdx < this.images.length - 1) {\n            L.DomUtil.addClass(this.nextPhotoButton, 'enabled');\n        } else {\n            L.DomUtil.removeClass(this.nextPhotoButton, 'enabled');\n        }\n        for (let [i, button] of this._buttons.entries()) {\n            ((i === imageIdx) ? L.DomUtil.addClass : L.DomUtil.removeClass)(button, 'active');\n        }\n        this.notifyChange();\n    },\n\n    notifyChange: function() {\n        if (this.images && this._active) {\n            const image = this.images[this._imageIdx];\n            this.fire('change', {\n                    latlng: L.latLng(image.lat, image.lng),\n                    latlngs: this.images.map((image) => L.latLng(image.lat, image.lng))\n                }\n            );\n        }\n    },\n\n    _showPano: function(images, imageIdx = 0, imagePos = null) {\n        this.images = images;\n        this.setupPageButtons(images.length);\n        this.switchPhoto(imageIdx, imagePos);\n    },\n\n    showPano: function(images) {\n        this._showPano(images);\n    },\n\n    onCloseClick: function() {\n        this.fire('closeclick');\n    },\n\n    activate: function() {\n        this._active = true;\n    },\n\n    deactivate: function() {\n        this._active = false;\n    },\n\n    setState: function(state) {\n        const lat = parseFloat(state[0]);\n        const lng = parseFloat(state[1]);\n        const pageId = state[2];\n        const y = parseFloat(state[3]);\n        const x = parseFloat(state[4]);\n        const zoom = parseFloat(state[5]);\n        if (!isNaN(lat) && !isNaN(lng) && !isNaN(x) && !isNaN(y) && !isNaN(zoom)) {\n            let imageIdx = -1;\n            getPanoramaAtPos({lat, lng}, 0).then((resp) => {\n                if (!resp.found) {\n                    return;\n                }\n                for (let [i, image] of resp.data.entries()) {\n                    if (image.pageId === pageId) {\n                        imageIdx = i;\n                        break;\n                    }\n                }\n                if (imageIdx > -1) {\n                    this._showPano(resp.data, imageIdx, {center: L.latLng(y, x), zoom});\n                }\n            });\n            return true;\n        }\n        return false;\n    },\n\n    getState: function() {\n        if (!this.images) {\n            return [];\n        }\n        const center = this.map.getCenter();\n        return [\n            this.images[0].lat.toFixed(6),\n            this.images[0].lng.toFixed(6),\n            this.images[this._imageIdx].pageId,\n            center.lat.toFixed(2),\n            center.lng.toFixed(2),\n            this.map.getZoom().toFixed(1)\n        ];\n    },\n\n    invalidateSize: function() {\n        this.map.invalidateSize();\n    }\n});\n\nfunction getViewer(container) {\n    return new Viewer(container);\n}\n\nconst wikimediaProvider = {getCoverageLayer, getPanoramaAtPos, getViewer};\nexport default wikimediaProvider;\n","import L from 'leaflet';\nimport {TiledDataLoader} from '~/lib/tiled-data-loader';\n\nconst MultiLayer = L.Layer.extend({\n    initialize: function(layers) {\n        this.layers = layers;\n    },\n\n    setLayersVisibility: function(e) {\n        if (!this._map) {\n            return;\n        }\n\n        let newZoom;\n        if (e && e.zoom !== undefined) {\n            newZoom = e.zoom;\n        } else {\n            newZoom = this._map.getZoom();\n        }\n\n        for (let layer of this.layers) {\n            if (layer.minZoom <= newZoom && newZoom <= layer.maxZoom) {\n                this._map.addLayer(layer.layer);\n            } else {\n                this._map.removeLayer(layer.layer);\n            }\n        }\n    },\n\n    onAdd: function(map) {\n        this._map = map;\n        this.setLayersVisibility();\n        map.on('zoomend', this.setLayersVisibility, this);\n    },\n\n    onRemove: function() {\n        for (let layer of this.layers) {\n            this._map.removeLayer(layer.layer);\n        }\n        this._map.off('zoomend', this.setLayersVisibility, this);\n        this._map.off('zoomanim', this.setLayersVisibility, this);\n        this._map = null;\n    }\n\n});\n\nclass WikimediaLoader extends TiledDataLoader {\n    constructor(urlTemplate, zoom) {\n        super();\n        this.url = urlTemplate;\n        this.maxZoom = zoom;\n    }\n\n    getTileUrl(coords) {\n        const data = {\n            x: coords.x,\n            z: coords.z,\n            y: 2 ** coords.z - 1 - coords.y\n        };\n        return L.Util.template(this.url, data);\n    }\n\n    layerTileToDataTileCoords(layerTileCoords) {\n        let z = layerTileCoords.z;\n        let z2 = null;\n        if (z > this.maxZoom) {\n            z2 = this.maxZoom;\n        } else {\n            return {z, x: layerTileCoords.x, y: layerTileCoords.y};\n        }\n\n        let multiplier = 1 << (z - z2);\n        return {\n            x: Math.floor(layerTileCoords.x / multiplier),\n            y: Math.floor(layerTileCoords.y / multiplier),\n            z: z2\n        };\n    }\n\n    makeRequestData(dataTileCoords) {\n        return {\n            url: this.getTileUrl(dataTileCoords),\n            options: {\n                responseType: 'arraybuffer',\n                timeout: 10000,\n                isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 404\n            }\n        };\n    }\n\n    async processResponse(xhr, originalDataTileCoords) {\n        let tileData;\n        if (originalDataTileCoords.z >= this.maxZoom && xhr.status === 200 && xhr.response) {\n            tileData = new Uint16Array(xhr.response);\n        } else {\n            tileData = null;\n        }\n\n        return {\n            tileData,\n            coords: originalDataTileCoords\n        };\n    }\n}\n\nconst WikimediaVectorCoverage = L.GridLayer.extend({\n        options: {\n            tileSize: 256,\n            // updateWhenIdle: true,\n            color: '#ff00ff',\n        },\n\n        initialize: function(url, options) {\n            L.GridLayer.prototype.initialize.call(this, options);\n            this.loader = new WikimediaLoader(url, 11);\n        },\n\n        onAdd: function(map) {\n            L.GridLayer.prototype.onAdd.call(this, map);\n            this.on('tileunload', this.onTileUnload, this);\n        },\n\n        onRemove: function(map) {\n            L.GridLayer.prototype.onRemove.call(this, map);\n            this.off('tileunload', this.onTileUnload, this);\n        },\n\n        onTileUnload: function(e) {\n            const tile = e.tile;\n            tile._abortLoading();\n            delete tile._tileData;\n            delete tile._adjustment;\n        },\n\n        drawTile: function(canvas, _unused_coords) {\n            if (!this._map) {\n                return;\n            }\n            if (!canvas._tileData) {\n                return;\n            }\n            const dataOffset = 5000;\n            const dataExtent = 65535 - 2 * dataOffset;\n            const tileData = canvas._tileData;\n            let {multiplier, offsetX, offsetY} = canvas._adjustment;\n            const canvasCtx = canvas.getContext('2d');\n            const pixelScale = multiplier * 256 / dataExtent;\n            canvasCtx.fillStyle = this.options.color;\n            for (let i = 0, l = tileData.length; i < l; i += 2) {\n                let x = (tileData[i] - dataOffset) * pixelScale - offsetX * 256;\n                let y = (tileData[i + 1] - dataOffset) * pixelScale - offsetY * 256;\n                canvasCtx.beginPath();\n                canvasCtx.arc(x, y, 5, 0, 2 * Math.PI);\n                canvasCtx.fill();\n            }\n        },\n\n        createTile: function(coords, done) {\n            const canvas = L.DomUtil.create('canvas', 'leaflet-tile');\n            canvas.width = this.options.tileSize;\n            canvas.height = this.options.tileSize;\n            let {dataPromise, abortLoading} = this.loader.requestTileData(coords);\n            dataPromise.then((data) => {\n                if (!data.error) {\n                    canvas._tileData = data.tileData;\n                    canvas._adjustment = data.adjustment || {multiplier: 1, offsetX: 0, offsetY: 0};\n                    setTimeout(() => {\n                        this.drawTile(canvas, coords);\n                        done(null, canvas);\n                    }, 1);\n                }\n            });\n\n            canvas._abortLoading = abortLoading;\n            return canvas;\n        },\n    }\n);\n\nexport {MultiLayer, WikimediaVectorCoverage};\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import {arrayBufferToString} from '~/lib/binary-strings';\n\nconst selectFiles = (() => {\n    let fileInput;\n    return function selectFiles(multiple = false) {\n        if (fileInput) {\n            document.body.removeChild(fileInput);\n        }\n        fileInput = document.createElement('input');\n        document.body.appendChild(fileInput);\n        fileInput.type = 'file';\n        fileInput.multiple = Boolean(multiple);\n        fileInput.style.display = 'none';\n\n        const result = new Promise(function(resolve) {\n                fileInput.addEventListener('change', function() {\n                        resolve(fileInput.files);\n                    }\n                );\n            }\n        );\n        fileInput.click();\n        return result;\n    };\n})();\n\nfunction readFile(file) {\n    return new Promise(function(resolve) {\n            var reader = new FileReader();\n            reader.onload = function(e) {\n                resolve({\n                        data: arrayBufferToString(e.target.result),\n                        filename: file.name\n                    }\n                );\n            };\n            reader.readAsArrayBuffer(file);\n        }\n    );\n}\n\nfunction readFiles(files) {\n    files = Array.prototype.slice.apply(files);\n    return Promise.all(files.map(readFile));\n}\n\nexport {selectFiles, readFiles};\n","import parseGpx from './gpx';\nimport parseZip from './zip';\nimport {parseKmz, parseKml} from './kml';\nimport {parseOziPlt, parseOziRte, parseOziWpt} from './ozi';\n\nconst parsers = [\n    parseKmz,\n    parseZip,\n    parseGpx,\n    parseOziRte,\n    parseOziPlt,\n    parseOziWpt,\n    parseKml,\n];\n\nexport default parsers;\n","import {JSUnzip} from '~/vendored/github.com/augustl/js-unzip/js-unzip';\nimport jsInflate from './jsInflate';\nimport {decode866} from './codePages';\nimport parseGeoFile from '../parseGeoFile';\n\nfunction parseZip(txt, _unused_name) {\n    let unzipper;\n    try {\n        unzipper = new JSUnzip(txt);\n    } catch (e) {\n        return null;\n    }\n    if (!unzipper.isZipFile()) {\n        return null;\n    }\n    try {\n        unzipper.readEntries();\n    } catch (e) {\n        return null;\n    }\n    var geodata_array = [];\n    for (var i = 0; i < unzipper.entries.length; i++) {\n        var entry = unzipper.entries[i];\n        var uncompressed;\n        if (entry.compressionMethod === 0) {\n            uncompressed = entry.data;\n        } else if (entry.compressionMethod === 8) {\n            uncompressed = jsInflate(entry.data, entry.uncompressedSize);\n        } else {\n            return null;\n        }\n        var file_name = decode866(entry.fileName);\n        var geodata = parseGeoFile(file_name, uncompressed);\n        for (let item of geodata) {\n            if (item.error === 'UNSUPPORTED' && item.name.match(/(\\.(pdf|doc|txt|jpg))|\\/$/ui)) {\n                continue;\n            }\n            geodata_array.push(item);\n        }\n    }\n    return geodata_array;\n}\n\nexport default parseZip;\n","import {decode as utf8_decode} from 'utf8';\nimport {xmlGetNodeText} from './xmlUtils';\nimport stripBom from '~/lib/stripBom';\nimport JSUnzip from '~/vendored/github.com/augustl/js-unzip/js-unzip';\nimport jsInflate from './jsInflate';\n\nfunction parseKml(txt, name) {\n    var error;\n    function getSegmentPoints(coordinates_element) {\n        // convert multiline text value of tag to single line\n        var coordinates_string = xmlGetNodeText(coordinates_element);\n        var points_strings = coordinates_string.split(/\\s+/u);\n        var points = [];\n        for (var i = 0; i < points_strings.length; i++) {\n            if (points_strings[i].length) {\n                var point = points_strings[i].split(',');\n                var lat = parseFloat(point[1]);\n                var lng = parseFloat(point[0]);\n                if (isNaN(lat) || isNaN(lng)) {\n                    error = 'CORRUPT';\n                    break;\n                }\n                points.push({lat: lat, lng: lng});\n            }\n        }\n        return points;\n    }\n\n    function getTrackSegments(xml) {\n        var segments_elements = xml.getElementsByTagName('LineString');\n        var segments = [];\n        for (var i = 0; i < segments_elements.length; i++) {\n            var coordinates_element = segments_elements[i].getElementsByTagName('coordinates');\n            if (coordinates_element.length) {\n                var segment_points = getSegmentPoints(coordinates_element[0]);\n                if (segment_points.length) {\n                    segments.push(segment_points);\n                }\n            }\n        }\n        return segments;\n    }\n\n    function getPoints(dom) {\n        var points = [],\n            placemarks, i, coord, name, lat, lng, pointObjs;\n        placemarks = dom.getElementsByTagName('Placemark');\n        for (i = 0; i < placemarks.length; i++) {\n            pointObjs = placemarks[i].getElementsByTagName('Point');\n            if (pointObjs.length === 0) {\n                continue;\n            } else if (pointObjs.length > 1) {\n                error = 'CORRUPT';\n                break;\n            }\n            coord = pointObjs[0].getElementsByTagName('coordinates');\n            if (coord.length !== 1) {\n                error = 'CORRUPT';\n                break;\n            }\n            coord = xmlGetNodeText(coord[0]);\n            coord = coord.split(',');\n            lat = parseFloat(coord[1]);\n            lng = parseFloat(coord[0]);\n            if (isNaN(lat) || isNaN(lng)) {\n                error = 'CORRUPT';\n                break;\n            }\n            name = '';\n            const nameTags = placemarks[i].getElementsByTagName('name');\n            if (nameTags[0]) {\n                try {\n                    name = xmlGetNodeText(nameTags[0]);\n                    name = utf8_decode(name);\n                } catch (e) {\n                    error = 'CORRUPT';\n                }\n            }\n            points.push({\n                    name: name,\n                    lat: lat,\n                    lng: lng\n                }\n            );\n        }\n        return points;\n    }\n\n    txt = stripBom(txt);\n    txt = txt.replace(/<([^ >]+):([^ >]+)/ug, '<$1_$2');\n    let dom;\n    try {\n        dom = (new DOMParser()).parseFromString(txt, \"text/xml\");\n    } catch (e) {\n        return null;\n    }\n    if (dom.documentElement.nodeName === 'parsererror') {\n        return null;\n    }\n    if (dom.getElementsByTagName('kml').length === 0) {\n        return null;\n    }\n\n    return [{name: name, tracks: getTrackSegments(dom), points: getPoints(dom), error: error}];\n}\n\nfunction parseKmz(txt, name) {\n    var uncompressed;\n    let unzipper;\n    try {\n        unzipper = new JSUnzip(txt);\n    } catch (e) {\n        return null;\n    }\n    var tracks = [],\n        points = [],\n        geodata,\n        error;\n    var hasDocKml = false;\n    if (!unzipper.isZipFile()) {\n        return null;\n    }\n    try {\n        unzipper.readEntries();\n    } catch (e) {\n        return null;\n    }\n    var i, entry;\n    for (i = 0; i < unzipper.entries.length; i++) {\n        entry = unzipper.entries[i];\n        if (entry.fileName === 'doc.kml') {\n            hasDocKml = true;\n            break;\n        }\n    }\n    if (!hasDocKml) {\n        return null;\n    }\n\n    for (i = 0; i < unzipper.entries.length; i++) {\n        entry = unzipper.entries[i];\n        if (entry.fileName.match(/\\.kml$/iu)) {\n            if (entry.compressionMethod === 0) {\n                uncompressed = entry.data;\n            } else if (entry.compressionMethod === 8) {\n                uncompressed = jsInflate(entry.data, entry.uncompressedSize);\n            } else {\n                return null;\n            }\n            geodata = parseKml(uncompressed, 'dummmy');\n            if (geodata) {\n                error = error || geodata[0].error;\n                tracks.push(...geodata[0].tracks);\n                points.push(...geodata[0].points);\n            }\n        }\n    }\n\n    geodata = [{name: name, error: error, tracks: tracks, points: points}];\n    return geodata;\n}\n\nexport {parseKml, parseKmz};\n","import {decodeCP1251} from './codePages';\nimport stripBom from '~/lib/stripBom';\n\nfunction parseOziRte(txt, name) {\n    let error,\n        segments = [];\n    txt = stripBom(txt);\n    const lines = txt.split('\\n');\n    if (lines[0].indexOf('OziExplorer Route File') !== 0) {\n        return null;\n    }\n    let currentSegment = [];\n    for (let i = 4; i < lines.length; i++) {\n        let line = lines[i].trim();\n        if (!line) {\n            continue;\n        }\n        let fields = line.split(',');\n        if (fields[0] === 'R') {\n            if (currentSegment.length) {\n                segments.push(currentSegment);\n            }\n            currentSegment = [];\n        } else if (fields[0] === 'W') {\n            let lat = parseFloat(fields[5]);\n            let lng = parseFloat(fields[6]);\n            if (isNaN(lat) || isNaN(lng)) {\n                error = 'CORRUPT';\n                break;\n            }\n            currentSegment.push({lat, lng});\n        } else {\n            error = 'CORRUPT';\n            break;\n        }\n    }\n    if (currentSegment.length) {\n        segments.push(currentSegment);\n    }\n    return [{name, tracks: segments, error}];\n}\n\nfunction parseOziPlt(txt, name) {\n    var error;\n    var segments = [];\n    txt = stripBom(txt);\n    var lines = txt.split('\\n');\n    if (lines[0].indexOf('OziExplorer Track Point File') !== 0) {\n        return null;\n    }\n    var expected_points_num = parseInt(lines[5], 10);\n    var current_segment = [];\n    var total_points_num = 0;\n    for (var i = 6; i < lines.length; i++) {\n        var line = lines[i].trim();\n        if (!line) {\n            continue;\n        }\n        var fields = line.split(',');\n        var lat = parseFloat(fields[0]);\n        var lon = parseFloat(fields[1]);\n        var is_start_of_segment = parseInt(fields[2], 10);\n        if (isNaN(lat) || isNaN(lon) || isNaN(is_start_of_segment)) {\n            error = 'CORRUPT';\n            break;\n        }\n        if (is_start_of_segment) {\n            current_segment = [];\n        }\n        if (!current_segment.length) {\n            segments.push(current_segment);\n        }\n        current_segment.push({lat: lat, lng: lon});\n        total_points_num += 1;\n    }\n    if (isNaN(expected_points_num) || (expected_points_num !== 0 && expected_points_num !== total_points_num)) {\n        error = 'CORRUPT';\n    }\n    return [{name: name, tracks: segments, error: error}];\n}\n\nfunction parseOziWpt(txt, name) {\n    var points = [],\n        error,\n        lines, line,\n        i,\n        lat, lng, pointName, fields;\n    txt = stripBom(txt);\n    lines = txt.split('\\n');\n    if (lines[0].indexOf('OziExplorer Waypoint File') !== 0) {\n        return null;\n    }\n    for (i = 4; i < lines.length; i++) {\n        line = lines[i].trim();\n        if (!line) {\n            continue;\n        }\n        fields = line.split(',');\n        lat = parseFloat(fields[2]);\n        lng = parseFloat(fields[3]);\n        pointName = decodeCP1251(fields[1]).trim();\n        if (isNaN(lat) || isNaN(lng)) {\n            error = 'CORRUPT';\n            break;\n        }\n        points.push({\n                lat: lat,\n                lng: lng,\n                name: pointName\n            }\n        );\n    }\n    return [{name: name, points: points, error: error}];\n}\n\nexport {parseOziPlt, parseOziRte, parseOziWpt};\n","import SimpleService from './simpleService';\nimport Endomondo from './endomondo';\nimport Etomesto from './etomesto';\nimport Gpsies from './gpsies';\nimport Gpslib from './gpslib';\nimport Osm from './osm';\nimport Strava from './strava';\nimport Tracedetrail from './tracedetrail';\nimport {YandexRuler} from './yandex';\nimport {NakarteTrack, NakarteUrl} from './nakarte';\nimport {MovescountMove, MovescountRoute} from './movescount';\nimport {GarminActivity, GarminRoute} from './garmin';\nimport {SportsTrackerActivity} from './sportstracker';\nimport OpenStreetMapRu from './openstreetmapRu';\n\nconst services = [\n    YandexRuler,\n    NakarteTrack,\n    NakarteUrl,\n    Endomondo,\n    Etomesto,\n    Gpsies,\n    Gpslib,\n    Osm,\n    Strava,\n    Tracedetrail,\n    MovescountMove,\n    MovescountRoute,\n    GarminActivity,\n    GarminRoute,\n    SportsTrackerActivity,\n    OpenStreetMapRu,\n    SimpleService\n];\n\nexport default services;\n","import BaseService from './baseService';\nimport parseGeoFile from '../parseGeoFile';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nclass SimpleService extends BaseService {\n    isOurUrl() {\n        return Boolean(this.origUrl.match(/^https?:\\/\\/.+/u));\n    }\n\n    requestOptions() {\n        return [{\n            url: urlViaCorsProxy(this.origUrl),\n            options: {responseType: 'binarystring'}\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        return parseGeoFile(this.nameFromUrl(response.responseURL), response.responseBinaryText);\n    }\n}\n\nexport default SimpleService;\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nclass Endomondo extends BaseService {\n    urlRegexps = [\n        /^https?:\\/\\/(?:www\\.)?endomondo\\.com\\/users\\/(\\d+)\\/workouts\\/(\\d+)/u,\n        /^https?:\\/\\/(?:www\\.)?endomondo\\.com\\/workouts\\/(\\d+)\\/(\\d+)/u\n    ];\n\n    isOurUrl() {\n        return this.urlRegexps.some((re) => re.test(this.origUrl));\n    }\n\n    requestOptions() {\n        let userId, trackId;\n        let m = this.urlRegexps[0].exec(this.origUrl);\n        if (m) {\n            [userId, trackId] = [m[1], m[2]];\n        } else {\n            m = this.urlRegexps[1].exec(this.origUrl);\n            [trackId, userId] = [m[1], m[2]];\n        }\n        return [{\n            url: urlViaCorsProxy(`https://www.endomondo.com/rest/v1/users/${userId}/workouts/${trackId}`),\n            options: {\n                responseType: 'json',\n                isResponseSuccess: (xhr) => (xhr.status === 200 || xhr.status === 404)\n            },\n\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        if (response.status === 404) {\n            return [{error: 'Invalid link or user disabled viewing this workout track'}];\n        }\n\n        const data = response.responseJSON;\n        if (!data) {\n            return [{name: 'Endomondo activity', error: 'UNSUPPORTED'}];\n        }\n        if (!data.points || !data.points.points) {\n            return [{error: 'Endomondo user disabled viewing this workout track'}];\n        }\n\n        const track = data.points.points\n            .filter((p) => p.latitude)\n            .map((p) => ({\n                        lat: p.latitude,\n                        lng: p.longitude\n            }));\n        if (track.length === 0) {\n            return [{error: 'Endomondo user disabled viewing this workout track'}];\n        }\n\n        const date = data.local_start_time.split('T')[0];\n        const dist = `${data.distance.toFixed(1)} km`;\n        let trackName = `${date}, ${dist}`;\n        if (data.author && data.author.name) {\n            trackName += ` ${data.author.name}`;\n        }\n        if (data.title) {\n            trackName += `: ${data.title}`;\n        }\n        return [{\n            name: trackName,\n            tracks: [track]\n        }];\n    }\n}\n\nexport default Endomondo;\n","import urlViaCorsProxy from '~/lib/CORSProxy';\nimport BaseService from './baseService';\nimport parseGpx from '../parsers/gpx';\n\nclass Etomesto extends BaseService {\n    urlRe = /^https?:\\/\\/(?:www\\.)?etomesto\\.ru\\/track([a-z0-9]+)/u;\n\n    getTrackId() {\n        const m = this.urlRe.exec(this.origUrl);\n        return m[1];\n    }\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const trackId = this.getTrackId();\n        return [{\n            url: urlViaCorsProxy(`http://www.etomesto.ru/save/${trackId}.gpx`),\n            options: {\n                responseType: 'binarystring',\n                isResponseSuccess: (xhr) => (\n                    xhr.status === 200 &&\n                    !xhr.responseBinaryText.startsWith('ERROR'))\n            }\n        }];\n    }\n\n    parseResponse(responses) {\n        const trackId = this.getTrackId();\n        const response = responses[0];\n        const name = `Etomesto track ${trackId}`;\n        return parseGpx(response.responseBinaryText, name, true) || [{name: name, error: 'UNSUPPORTED'}];\n    }\n}\n\nexport default Etomesto;\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\nimport parseGpx from '../parsers/gpx';\nimport urlEncode from './urlEncode';\n\nclass Gpsies extends BaseService {\n    urlRe = /^https?:\\/\\/www\\.gpsies\\.com\\/map\\.do[^?]*\\?fileId=([a-z]+)/u;\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = m[1];\n        const newUrl = urlViaCorsProxy('https://www.gpsies.com/download.do');\n        return [{\n            url: newUrl,\n            options: {\n                method: 'POST',\n                data: urlEncode({\n                        fileId: trackId,\n                        speed: '10',\n                        dataType: '3',\n                        filetype: 'gpxTrk',\n                        submitButton: '',\n                        inappropriate: ''\n                    }\n                ),\n                headers: [[\"Content-type\", \"application/x-www-form-urlencoded\"]],\n                responseType: 'binarystring'\n            }\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        return parseGpx(response.responseBinaryText, this.nameFromUrl(response.responseURL), true) ||\n            [{name: name, error: 'UNSUPPORTED'}];\n    }\n}\n\nexport default Gpsies;\n","function urlEncode(d) {\n    return Object.entries(d).map(([k, v]) => `${k}=${encodeURIComponent(v)}`).join('&');\n}\n\nexport default urlEncode;\n","import urlViaCorsProxy from '~/lib/CORSProxy';\nimport BaseService from './baseService';\nimport parseGpx from '../parsers/gpx';\n\nclass Gpslib extends BaseService {\n    urlRe = /^https?:\\/\\/(?:.+\\.)?gpslib\\.[^.]+\\/tracks\\/info\\/(\\d+)/u;\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[1];\n        return [{\n            url: urlViaCorsProxy(`https://www.gpslib.ru/tracks/download/${trackId}.gpx`),\n            options: {responseType: 'binarystring'}\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        return parseGpx(response.responseBinaryText, `GPSLib ${this.trackId}`, true) ||\n            [{name: name, error: 'UNSUPPORTED'}];\n    }\n}\n\nexport default Gpslib;\n","import urlViaCorsProxy from '~/lib/CORSProxy';\nimport BaseService from './baseService';\nimport parseGpx from '../parsers/gpx';\n\nclass Osm extends BaseService {\n    urlRe = /^https?:\\/\\/(?:www\\.)?openstreetmap\\.org\\/user\\/(?:.*)\\/traces\\/(\\d+)/u;\n\n    getTrackId() {\n        const m = this.urlRe.exec(this.origUrl);\n        return m[1];\n    }\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const trackId = this.getTrackId();\n        return [{\n            url: urlViaCorsProxy(`https://www.openstreetmap.org/trace/${trackId}/data`),\n            options: {responseType: 'binarystring'}\n        }];\n    }\n\n    parseResponse(responses) {\n        const trackId = this.getTrackId();\n        const response = responses[0];\n        return parseGpx(response.responseBinaryText, `OSM track ${trackId}`, true) ||\n            [{name: name, error: 'UNSUPPORTED'}];\n    }\n}\n\nexport default Osm;\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nclass Strava extends BaseService {\n    urlRe = /^https?:\\/\\/(?:.+\\.)?strava\\.com\\/activities\\/(\\d+)/u;\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[1];\n        function isResponseSuccess(response) {\n            return [200, 401, 404].includes(response.status);\n        }\n        return [\n            {\n                url: urlViaCorsProxy(`https://www.strava.com/activities/${trackId}?hl=en-GB`),\n                options: {\n                    isResponseSuccess\n                }\n            },\n            {\n                url: urlViaCorsProxy(`https://www.strava.com/stream/${trackId}?streams%5B%5D=latlng`),\n                options: {\n                    responseType: 'json',\n                    isResponseSuccess\n                }\n            }\n        ];\n    }\n\n    parseResponse(responses) {\n        const statusMessages = {\n            401: 'Requested Strava activity marked as private',\n            404: 'Requested Strava activity could not be found'\n        };\n        const [pageResponse, trackResponse] = responses;\n        if (trackResponse.status !== 200) {\n            return [{error: statusMessages[trackResponse.status]}];\n        }\n        let name = `Strava ${this.trackId}`;\n        const latlngs = trackResponse.responseJSON?.latlng;\n        if (!latlngs || !Array.isArray(latlngs)) {\n            return [{name, error: 'UNSUPPORTED'}];\n        }\n        const tracks = [latlngs.map((p) => ({lat: p[0], lng: p[1]}))];\n        let dom;\n        try {\n            dom = (new DOMParser()).parseFromString(pageResponse.response, 'text/html');\n        } catch (e) {\n            // will use default name\n        }\n        if (dom) {\n            const userName = (dom.querySelector('a.minimal[href*=\"/athletes/\"]')?.textContent ?? '').trim();\n            const activityTitle = (dom.querySelector('h1.activity-name')?.textContent ?? '').trim();\n            let date = dom.querySelector('time')?.textContent ?? '';\n            date = date.split(',')[1] ?? '';\n            date = date.trim();\n            if (userName && activityTitle && date) {\n                name = `${userName} - ${activityTitle} ${date}`;\n            }\n        }\n        return [{\n            name,\n            tracks\n        }];\n    }\n}\n\nexport default Strava;\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\nimport L from 'leaflet';\n\nclass Tracedetrail extends BaseService {\n    urlRe = /^https?:\\/\\/(?:www\\.)?tracedetrail\\.[a-z]{2,}.*\\/trace\\/trace\\/([0-9]+)/u;\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[1];\n\n        return [{\n            url: urlViaCorsProxy(`https://tracedetrail.com/en/trace/geomSections/${trackId}`),\n            options: {responseType: 'json'}\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        let name = `Tracedetrail track ${this.trackId}`;\n        try {\n            name = response.responseJSON.nom_fr || name;\n            const geometry = JSON.parse(response.responseJSON.geometry);\n            const proj = L.CRS.EPSG3857;\n            const points = geometry.map((item) => proj.unproject(L.point(item.lon, item.lat)));\n\n            return [{\n                name,\n                tracks: [points]\n            }];\n        } catch (e) {\n            let error = 'UNSUPPORTED';\n\n            if (response.status === 200) {\n                error = `Track with id ${this.trackId} was deleted or did not exist`;\n            }\n\n            return [{name, error}];\n        }\n    }\n}\n\nexport default Tracedetrail;\n","import BaseService from './baseService';\n\nclass YandexRuler extends BaseService {\n    urlRe = /yandex\\..+[?&]rl=([^&]+)/u;\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        return [];\n    }\n\n    parseResponse() {\n        let last_lat = 0;\n        let last_lng = 0;\n        let error;\n        const points = [];\n        let s = this.urlRe.exec(this.origUrl)[1];\n        s = s.replace(/%2C/iug, ',');\n        const points_str = s.split('~');\n        for (let i = 0; i < points_str.length; i++) {\n            let point = points_str[i].split(',');\n            let lng = parseFloat(point[0]);\n            let lat = parseFloat(point[1]);\n            if (isNaN(lat) || isNaN(lng)) {\n                error = 'CORRUPT';\n                break;\n            }\n            last_lng += lng;\n            last_lat += lat;\n            points.push({lat: last_lat, lng: last_lng});\n        }\n        return [{\n            error: error,\n            tracks: [points],\n            name: 'Yandex ruler'\n        }];\n    }\n}\n\n// function parseYandexMap(txt) {\n//     var start_tag = '<script id=\"vpage\" type=\"application/json\">';\n//     var json_start = txt.indexOf(start_tag);\n//     if (json_start === -1) {\n//         return null;\n//     }\n//     json_start += start_tag.length;\n//     var json_end = txt.indexOf('</script>', json_start);\n//     if (json_end === -1) {\n//         return null;\n//     }\n//     var map_data = txt.substring(json_start, json_end);\n//     map_data = JSON.parse(map_data);\n//     console.log(map_data);\n//     if (!('request' in map_data)) {\n//         return null;\n//     }\n//     var name = 'YandexMap';\n//     var segments = [];\n//     var error;\n//     if (map_data.vpage && map_data.vpage.data && map_data.vpage.data.objects && map_data.vpage.data.objects.length) {\n//         var mapName = ('' + (map_data.vpage.data.name || '')).trim();\n//         if (mapName.length > 3) {\n//             name = '';\n//         } else if (mapName.length) {\n//             name += ': ';\n//         }\n//         name += fileutils.decodeUTF8(mapName);\n//         map_data.vpage.data.objects.forEach(function(obj){\n//             if (obj.pts && obj.pts.length) {\n//                 var segment = [];\n//                 for (var i=0; i< obj.pts.length; i++) {\n//                     var pt = obj.pts[i];\n//                     var lng = parseFloat(pt[0]);\n//                     var lat = parseFloat(pt[1]);\n//                     if (isNaN(lat) || isNaN(lng)) {\n//                         error = 'CORRUPT';\n//                         break;\n//                     }\n//                     segment.push({lat: lat, lng:lng});\n//                 }\n//                 if (segment.length) {\n//                     segments.push(segment);\n//                 }\n//             }\n//         });\n//     }\n//     if (map_data.request.args && map_data.request.args.rl) {\n//         var res = parseYandexRulerString(map_data.request.args.rl);\n//         error = error || res.error;\n//         if (res.points && res.points.length) {\n//             segments.push(res.points);\n//         }\n//     }\n//     return [{name: name, error: error, tracks: segments}];\n// }\n\nexport {YandexRuler};\n","'use strict'; // code generated by pbf v3.0.5\n\n// Segment ========================================\n\nvar self = exports;\n\nvar Segment = self.Segment = {};\n\nSegment.read = function (pbf, end) {\n    return pbf.readFields(Segment._readField, {lats: [], lons: []}, end);\n};\nSegment._readField = function (tag, obj, pbf) {\n    if (tag === 1) pbf.readPackedSVarint(obj.lats);\n    else if (tag === 2) pbf.readPackedSVarint(obj.lons);\n};\nSegment.write = function (obj, pbf) {\n    if (obj.lats) pbf.writePackedSVarint(1, obj.lats);\n    if (obj.lons) pbf.writePackedSVarint(2, obj.lons);\n};\n\n// Waypoint ========================================\n\nvar Waypoint = self.Waypoint = {};\n\nWaypoint.read = function (pbf, end) {\n    return pbf.readFields(Waypoint._readField, {lat: 0, lon: 0, name: \"\"}, end);\n};\nWaypoint._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.lat = pbf.readSVarint();\n    else if (tag === 2) obj.lon = pbf.readSVarint();\n    else if (tag === 3) obj.name = pbf.readString();\n};\nWaypoint.write = function (obj, pbf) {\n    if (obj.lat) pbf.writeSVarintField(1, obj.lat);\n    if (obj.lon) pbf.writeSVarintField(2, obj.lon);\n    if (obj.name) pbf.writeStringField(3, obj.name);\n};\n\n// Waypoints ========================================\n\nvar Waypoints = self.Waypoints = {};\n\nWaypoints.read = function (pbf, end) {\n    return pbf.readFields(Waypoints._readField, {midLat: 0, midLon: 0, waypoints: []}, end);\n};\nWaypoints._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.midLat = pbf.readSVarint();\n    else if (tag === 2) obj.midLon = pbf.readSVarint();\n    else if (tag === 3) obj.waypoints.push(Waypoint.read(pbf, pbf.readVarint() + pbf.pos));\n};\nWaypoints.write = function (obj, pbf) {\n    if (obj.midLat) pbf.writeSVarintField(1, obj.midLat);\n    if (obj.midLon) pbf.writeSVarintField(2, obj.midLon);\n    if (obj.waypoints) for (var i = 0; i < obj.waypoints.length; i++) pbf.writeMessage(3, Waypoint.write, obj.waypoints[i]);\n};\n\n// Track ========================================\n\nvar Track = self.Track = {};\n\nTrack.read = function (pbf, end) {\n    return pbf.readFields(Track._readField, {name: \"\", segments: [], waypoints: null}, end);\n};\nTrack._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.name = pbf.readString();\n    else if (tag === 2) obj.segments.push(Segment.read(pbf, pbf.readVarint() + pbf.pos));\n    else if (tag === 3) obj.waypoints = Waypoints.read(pbf, pbf.readVarint() + pbf.pos);\n};\nTrack.write = function (obj, pbf) {\n    if (obj.name) pbf.writeStringField(1, obj.name);\n    if (obj.segments) for (var i = 0; i < obj.segments.length; i++) pbf.writeMessage(2, Segment.write, obj.segments[i]);\n    if (obj.waypoints) pbf.writeMessage(3, Waypoints.write, obj.waypoints);\n};\n\n// View ========================================\n\nvar View = self.View = {};\n\nView.read = function (pbf, end) {\n    return pbf.readFields(View._readField, {color: 0, shown: false, ticksShown: false}, end);\n};\nView._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.color = pbf.readVarint(true);\n    else if (tag === 2) obj.shown = pbf.readBoolean();\n    else if (tag === 3) obj.ticksShown = pbf.readBoolean();\n};\nView.write = function (obj, pbf) {\n    if (obj.color) pbf.writeVarintField(1, obj.color);\n    if (obj.shown) pbf.writeBooleanField(2, obj.shown);\n    if (obj.ticksShown) pbf.writeBooleanField(3, obj.ticksShown);\n};\n\n// TrackView ========================================\n\nvar TrackView = self.TrackView = {};\n\nTrackView.read = function (pbf, end) {\n    return pbf.readFields(TrackView._readField, {view: null, track: null}, end);\n};\nTrackView._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.view = View.read(pbf, pbf.readVarint() + pbf.pos);\n    else if (tag === 2) obj.track = Track.read(pbf, pbf.readVarint() + pbf.pos);\n};\nTrackView.write = function (obj, pbf) {\n    if (obj.view) pbf.writeMessage(1, View.write, obj.view);\n    if (obj.track) pbf.writeMessage(2, Track.write, obj.track);\n};\n","import * as urlSafeBase64 from '../../parsers/urlSafeBase64';\nimport {TRACKLIST_TRACK_COLORS} from '../../../track-list';\nimport loadFromUrl from '../../loadFromUrl';\n\nfunction parseWaypoint(rawPoint) {\n    let name = rawPoint.n;\n    let lat = Number(rawPoint.lt);\n    let lng = Number(rawPoint.ln);\n    if (typeof name !== 'string' || !name || isNaN(lat) || isNaN(lng) ||\n        lat < -90 || lat > 90 || lng < -180 || lng > 180) {\n        return {valid: false};\n    }\n    return {\n        valid: true,\n        point: {lat, lng, name}\n    };\n}\n\nfunction parseTrack(rawTrack) {\n    if (!rawTrack.length) {\n        return {valid: false};\n    }\n    const track = [];\n    for (let rawSegment of rawTrack) {\n        let segment = [];\n        if (!rawSegment || !rawSegment.length) {\n            return {valid: false};\n        }\n        for (let rawPoint of rawSegment) {\n            if (!rawPoint || rawPoint.length !== 2) {\n                return {valid: false};\n            }\n            let [lat, lng] = rawPoint.map(Number);\n            if (isNaN(lat) || isNaN(lng) || lat < -90 || lat > 90) {\n                return {valid: false};\n            }\n            segment.push({lat, lng});\n        }\n        track.push(segment);\n    }\n    return {valid: true, track};\n}\n\nasync function loadTracksFromJson(value) { // eslint-disable-line complexity\n    const errCorrupt = [{name: 'Track in url', error: 'CORRUPT'}];\n\n    const jsonString = urlSafeBase64.decode(value);\n    let data;\n    try {\n        data = JSON.parse(jsonString);\n    } catch (e) {\n        return errCorrupt;\n    }\n    if (!data || !data.length) {\n        return errCorrupt;\n    }\n    const geoDataArray = [];\n\n    for (let el of data) {\n        // Each track should contain either url or at least one of tracks and points\n        if (!el.u && !(el.p || el.t)) {\n            return errCorrupt;\n        }\n        let geodata;\n        if (el.u) {\n            geodata = await\n                loadFromUrl(el.u);\n            if (el.n && geodata.length === 1 && !geodata[0].error) {\n                geodata[0].name = el.n;\n            }\n        } else {\n            geodata = {};\n            geodata.name = el.n || 'Track';\n            if (el.t) {\n                const res = parseTrack(el.t);\n                if (!res.valid) {\n                    return errCorrupt;\n                }\n                geodata.tracks = res.track;\n            }\n            if (el.p) {\n                geodata.points = [];\n                for (let rawPoint of el.p) {\n                    let res = parseWaypoint(rawPoint);\n                    // eslint-disable-next-line max-depth\n                    if (!res.valid) {\n                        return errCorrupt;\n                    }\n                    geodata.points.push(res.point);\n                }\n            }\n            geodata = [geodata];\n        }\n        let viewProps = {};\n        if ('c' in el) {\n            let color = Number(el.c);\n            if (color < 0 || color >= TRACKLIST_TRACK_COLORS.length) {\n                return errCorrupt;\n            }\n            viewProps.color = color;\n        }\n        if ('v' in el) {\n            viewProps.trackHidden = !el.v;\n        }\n        if ('m' in el) {\n            viewProps.measureTicksShown = Boolean(el.m);\n        }\n        geodata.forEach((el) => Object.assign(el, viewProps));\n        geoDataArray.push(...geodata);\n    }\n    return geoDataArray;\n}\n\nexport default loadTracksFromJson;\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nclass MovescountBase extends BaseService {\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n}\n\nclass MovescountRoute extends MovescountBase {\n    urlRe = /^https?:\\/\\/(?:www\\.)?movescount\\.com\\/([a-z]{2}\\/)?map.*[?&]route=(\\d+)/u;\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[2];\n        return [{\n            url: urlViaCorsProxy(`http://www.movescount.com/Move/Route/${trackId}`),\n            options: {\n                responseType: 'json',\n                isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403\n            },\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        if (response.status === 403) {\n            return [{error: 'Movescount user disabled viewing this route'}];\n        }\n        let name = `Movescount route ${this.trackId}`;\n        const data = response.responseJSON;\n        if (!data) {\n            return [{name, error: 'UNSUPPORTED'}];\n        }\n\n        let points = [];\n        let track = [];\n\n        for (let i = 0; i < data.points.latitudes.length; i++) {\n            const latlng = {\n                lat: data.points.latitudes[i],\n                lng: data.points.longitudes[i]\n            };\n            track.push(latlng);\n            const point = data.points.data[i];\n            if (point) {\n                points.push({...latlng, name: point.name});\n            }\n        }\n\n        name = data.routeName ? data.routeName : name;\n\n        return [{\n            name,\n            points,\n            tracks: [track]\n        }];\n    }\n}\n\nclass MovescountMove extends MovescountBase {\n    urlRe = /^https?:\\/\\/(?:www\\.)?movescount\\.com\\/([a-z]{2}\\/)?moves\\/move(\\d+)/u;\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[2];\n        return [\n            {\n                url: urlViaCorsProxy(`http://www.movescount.com/Move/Track2/${trackId}`),\n                options: {\n                    responseType: 'json',\n                    isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403\n                }\n            },\n            {\n                url: urlViaCorsProxy(`https://www.movescount.com/moves/move${trackId}`),\n                options: {\n                    isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403 || xhr.status === 404\n                }\n            }\n        ];\n    }\n\n    parseResponse(responses) {\n        const [trackResponse, pageResponse] = responses;\n        if (trackResponse.status === 403) {\n            return [{error: 'Movescount user disabled viewing this activity'}];\n        }\n        let name = `Movescount move ${this.trackId}`;\n        const data = trackResponse.responseJSON;\n        if (!data) {\n            return [{name, error: 'UNSUPPORTED'}];\n        }\n\n        const track = data.TrackPoints.map((trackPoint) => ({\n                lat: trackPoint.Latitude,\n                lng: trackPoint.Longitude\n            })\n        );\n\n        const dom = (new DOMParser()).parseFromString(pageResponse.response, \"text/html\");\n        try {\n            const title = dom.querySelector('title').text.trim();\n            name = title ? title : name;\n        } catch (_) {\n            // use previously constructed name\n        }\n\n        return [{\n            name,\n            tracks: [track]\n        }];\n    }\n}\n\nexport {MovescountRoute, MovescountMove};\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nclass GarminBase extends BaseService {\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n}\n\nclass GarminRoute extends GarminBase {\n    urlRe = /^https?:\\/\\/connect\\.garmin\\.com\\/modern\\/course\\/(\\d+)/u;\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[1];\n        return [{\n            url: urlViaCorsProxy(`https://connect.garmin.com/modern/proxy/course-service/course/${trackId}`),\n            options: {\n                responseType: 'json',\n                isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403 || xhr.status === 404\n            },\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        if (response.status === 403) {\n            return [{error: 'Garmin Connect user disabled viewing this route'}];\n        }\n        if (response.status === 404) {\n            return [{error: 'Garmin Connect route does not exist'}];\n        }\n        let name = `Garmin Connect route ${this.trackId}`;\n        const data = response.responseJSON;\n        if (!data) {\n            return [{name, error: 'UNSUPPORTED'}];\n        }\n        let points = data.coursePoints.map((pt) => ({name: pt.name, lat: pt.lat, lng: pt.lon}));\n        let track = data.geoPoints.map((obj) => ({lat: obj.latitude, lng: obj.longitude}));\n        name = data.courseName ? data.courseName : name;\n        return [{\n            name,\n            points,\n            tracks: [track]\n        }];\n    }\n}\n\nclass GarminActivity extends GarminBase {\n    urlRe = /^https?:\\/\\/connect\\.garmin\\.com\\/modern\\/activity\\/(\\d+)/u;\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[1];\n        return [\n            {\n                url: urlViaCorsProxy(\n                    `https://connect.garmin.com/modern/proxy/activity-service/activity/${trackId}/details`),\n                options: {\n                    responseType: 'json',\n                    isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403 || xhr.status === 404\n                }\n            }\n        ];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        if (response.status === 403) {\n            return [{error: 'Garmin Connect user disabled viewing this activity'}];\n        }\n        if (response.status === 404) {\n            return [{error: 'Garmin Connect activity does not exist'}];\n        }\n        let name = `Garmin Connect activity ${this.trackId}`;\n        const data = response.responseJSON;\n        if (!data) {\n            return [{name, error: 'UNSUPPORTED'}];\n        }\n        let track = data.geoPolylineDTO.polyline.map((obj) => ({lat: obj.lat, lng: obj.lon}));\n        return [{\n            name,\n            tracks: [track]\n        }];\n    }\n}\n\nexport {GarminRoute, GarminActivity};\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\nimport utf8 from 'utf8';\n\nclass SportsTrackerBase extends BaseService {\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n}\n\nclass SportsTrackerActivity extends SportsTrackerBase {\n    urlRe = /^https?:\\/\\/(www\\.)?sports-tracker\\.com\\/workout\\/([^/]+)\\/([a-z0-9]+)/u;\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const activityId = m[3];\n        return [\n            {\n                url: urlViaCorsProxy(\n                    `https://api.sports-tracker.com/apiserver/v1/workouts/${activityId}/data?samples=100000`\n                ),\n                options: {\n                    responseType: 'binarystring',\n                    isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403\n                }\n            },\n            {\n                url: urlViaCorsProxy(`https://api.sports-tracker.com/apiserver/v1/workouts/${activityId}/combined`),\n                options: {\n                    responseType: 'binarystring',\n                    isResponseSuccess: (xhr) => [200, 403, 404].includes(xhr.status)\n                }\n            }\n        ];\n    }\n\n    parseResponse(responses) {\n        const [dataResponse, metadataResponse] = responses;\n        if (metadataResponse.status === 404) {\n            return [{error: 'Sports Tracker activity not found'}];\n        }\n        if (dataResponse.status === 403) {\n            return [{error: 'Sports Tracker user disabled viewing this activity'}];\n        }\n        let data, metadata;\n        let name = `Sports Tracker activity`;\n        try {\n            data = JSON.parse(utf8.decode(dataResponse.responseBinaryText));\n            metadata = JSON.parse(utf8.decode(metadataResponse.responseBinaryText));\n        } catch (e) {\n            return [{name, error: 'UNSUPPORTED'}];\n        }\n        const track = data.payload.locations.map((location) => ({\n                lat: location.la,\n                lng: location.ln\n            })\n        );\n        if (data.payload.description) {\n            name = data.payload.description;\n        } else {\n            const startTime = new Date(metadata.payload.startTime).toDateString();\n            name = `${metadata.payload.fullname} on ${startTime}`;\n        }\n\n        return [{\n            name,\n            tracks: [track]\n        }];\n    }\n}\n\nexport {SportsTrackerActivity};\n","import urlViaCorsProxy from '~/lib/CORSProxy';\nimport BaseService from './baseService';\nimport parseGpx from '../parsers/gpx';\n\nclass OpenStreetMapRu extends BaseService {\n    urlRe = /^https?:\\/\\/(?:www\\.)?openstreetmap\\.ru\\/\\?mapid=(\\d+)/u;\n\n    getTrackId() {\n        const m = this.urlRe.exec(this.origUrl);\n        return m[1];\n    }\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const trackId = this.getTrackId();\n        return [{\n            url: urlViaCorsProxy(`https://openstreetmap.ru/mymap.php?id=${trackId}&format=gpx`),\n            options: {responseType: 'binarystring'}\n        }];\n    }\n\n    parseResponse(responses) {\n        const trackId = this.getTrackId();\n        const response = responses[0];\n        const geodata = parseGpx(response.responseBinaryText, `PersonalMap ${trackId}`, true);\n        if (!geodata) {\n            return [{name: name, error: 'UNSUPPORTED'}];\n        }\n        if (geodata[0].tracks.length === 0 && geodata[0].points.length === 0) {\n            return [{error: 'Personal map is empty or does not exist'}];\n        }\n        return geodata;\n    }\n}\n\nexport default OpenStreetMapRu;\n","import utf8 from 'utf8';\nimport escapeHtml from 'escape-html';\nimport {saveNktk} from './parsers/nktk';\n\nfunction saveGpx(segments, name, points, withElevations = false) {\n    const gpx = [];\n    const fakeTime = '1970-01-01T00:00:01.000Z';\n\n    gpx.push('<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\" ?>');\n    gpx.push(\n        '<gpx xmlns=\"http://www.topografix.com/GPX/1/1\" creator=\"http://nakarte.me\" ' +\n        'xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://www.topografix.com/GPX/1/1 ' +\n        'http://www.topografix.com/GPX/1/1/gpx.xsd\" version=\"1.1\">'\n    );\n    points.forEach(function(marker) {\n            var label = marker.label;\n            label = escapeHtml(label);\n            label = utf8.encode(label);\n            gpx.push(`\\t<wpt lat=\"${marker.latlng.lat.toFixed(6)}\" lon=\"${marker.latlng.lng.toFixed(6)}\">`);\n            if (withElevations && marker.latlng.alt !== null) {\n                gpx.push(`\\t\\t<ele>${marker.latlng.alt.toFixed(1)}</ele>`);\n            }\n            gpx.push(`\\t\\t<name>${label}</name>`);\n            gpx.push('\\t</wpt>');\n        }\n    );\n    if (segments.length > 0) {\n        name = name || 'Track';\n        name = escapeHtml(name);\n        name = utf8.encode(name);\n        gpx.push('\\t<trk>');\n        gpx.push('\\t\\t<name>' + name + '</name>');\n\n        for (let segment of segments) {\n            gpx.push('\\t\\t<trkseg>');\n            for (let point of segment) {\n                let x = point.lng.toFixed(6);\n                let y = point.lat.toFixed(6);\n                const elevation = (withElevations && point.alt !== null)\n                    ? `<ele>${point.alt.toFixed(1)}</ele>` : '';\n                // time element is not necessary, added for compatibility to Garmin Connect only\n                gpx.push(`\\t\\t\\t<trkpt lat=\"${y}\" lon=\"${x}\">${elevation}<time>${fakeTime}</time></trkpt>`);\n            }\n            gpx.push('\\t\\t</trkseg>');\n        }\n        gpx.push('\\t</trk>');\n    }\n    gpx.push('</gpx>');\n    return gpx.join('\\n');\n}\n\nfunction saveGpxWithElevations(segments, name, points) {\n    return saveGpx(segments, name, points, true);\n}\n\nfunction saveKml(segments, name, points) {\n    const kml = [];\n\n    name = name || 'Track';\n    name = escapeHtml(name);\n    name = utf8.encode(name);\n\n    kml.push('<?xml version=\"1.0\" encoding=\"UTF-8\"?>');\n    kml.push('<kml xmlns=\"http://www.opengis.net/kml/2.2\">');\n    kml.push('\\t<Document>');\n    kml.push(`\\t\\t<name>${name}</name>`);\n\n    for (let [i, segment] of segments.entries()) {\n        kml.push('\\t\\t<Placemark>');\n        kml.push(`\\t\\t\\t<name>Line ${(i + 1)}</name>`);\n        kml.push('\\t\\t\\t<LineString>');\n        kml.push('\\t\\t\\t\\t<tessellate>1</tessellate>');\n        kml.push('\\t\\t\\t\\t<coordinates>');\n\n        for (let point of segment) {\n            let x = point.lng.toFixed(6);\n            let y = point.lat.toFixed(6);\n            kml.push(`\\t\\t\\t\\t\\t${x},${y}`);\n        }\n\n        kml.push('\\t\\t\\t\\t</coordinates>');\n        kml.push('\\t\\t\\t</LineString>');\n        kml.push('\\t\\t</Placemark>');\n    }\n\n    points.forEach(function(marker) {\n            var label = marker.label;\n            label = escapeHtml(label);\n            label = utf8.encode(label);\n            var coordinates = marker.latlng.lng.toFixed(6) + ',' + marker.latlng.lat.toFixed(6) + ',0';\n\n            kml.push('\\t\\t<Placemark>');\n            kml.push('\\t\\t\\t<name>' + label + '</name>');\n            kml.push('\\t\\t\\t<Point>');\n            kml.push('\\t\\t\\t\\t<coordinates>' + coordinates + '</coordinates>');\n            kml.push('\\t\\t\\t</Point>');\n            kml.push('\\t\\t</Placemark>');\n        }\n    );\n\n    kml.push('\\t</Document>');\n    kml.push('\\t</kml>');\n\n    return kml.join('\\n');\n}\n\nexport {saveGpx, saveGpxWithElevations, saveKml, saveNktk as saveToString};\n\n","import L from 'leaflet';\n\nL.LineUtil.simplifyLatlngs = function simplifyLatlngs(points, tolerance) {\n    function latlngToXy(p) {\n        return {\n            x: p.lng,\n            y: p.lat\n        };\n    }\n\n    function xyToLatlng(p) {\n        return {\n            lat: p.y,\n            lng: p.x\n        };\n    }\n\n    points = points.map(latlngToXy);\n    points = L.LineUtil.simplify(points, tolerance);\n    points = points.map(xyToLatlng);\n    return points;\n};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport './edit_line.css';\nimport {wrapLatLngToTarget} from '~/lib/leaflet.fixes/fixWorldCopyJump';\n\nL.Polyline.EditMixinOptions = {\n    className: 'leaflet-editable-line'\n};\n\nL.Polyline.EditMixin = {\n    _nodeMarkersZOffset: 10000,\n\n    startEdit: function() {\n        if (this._map && !this._editing) {\n            this._editing = true;\n            this._drawingDirection = 0;\n            this.setupMarkers();\n            this.on('remove', this.stopEdit.bind(this));\n            this._map\n                .on('click', this.onMapClick, this)\n                .on('dragend', this.onMapEndDrag, this);\n            L.DomEvent.on(document, 'keyup', this.onKeyPress, this);\n            this._storedStyle = {weight: this.options.weight, opacity: this.options.opacity};\n            if (this._latlngs.length) {\n                this.setStyle({weight: 1.5, opacity: 1});\n            }\n            L.DomUtil.addClass(this._map._container, 'leaflet-line-editing');\n            this.fire('editstart', {target: this});\n        }\n    },\n\n    stopEdit: function(userCancelled) {\n        if (this._editing) {\n            this.stopDrawingLine();\n            this._editing = false;\n            this.removeMarkers();\n            L.DomEvent.off(document, 'keyup', this.onKeyPress, this);\n            this.off('remove', this.stopEdit.bind(this));\n            this._map\n                .off('click', this.onMapClick, this)\n                .off('dragend', this.onMapEndDrag, this);\n            if (this._latlngs.length) {\n                this.setStyle(this._storedStyle);\n            }\n            L.DomUtil.removeClass(this._map._container, 'leaflet-line-editing');\n            this.fire('editend', {target: this, userCancelled});\n        }\n    },\n\n    removeMarkers: function() {\n        this.getLatLngs().forEach(function(node) {\n                if (node._nodeMarker) {\n                    this.nodeMarkers.removeLayer(node._nodeMarker);\n                    delete node._nodeMarker._lineNode;\n                    delete node._nodeMarker;\n                }\n                if (node._segmentOverlay) {\n                    this.segmentOverlays.removeLayer(node._segmentOverlay);\n                    delete node._segmentOverlay._lineNode;\n                    delete node._segmentOverlay;\n                }\n            }.bind(this)\n        );\n    },\n\n    getMarkerIndex: function(marker) {\n        return this.getLatLngs().indexOf(marker._lineNode);\n    },\n\n    getSegmentOverlayIndex: function(segmentOverlay) {\n        return this.getLatLngs().indexOf(segmentOverlay._lineNode);\n    },\n\n    onNodeMarkerDragEnd: function(e) {\n        var marker = e.target,\n            nodeIndex = this.getMarkerIndex(marker);\n        this.replaceNode(nodeIndex, marker.getLatLng());\n        this._setupEndMarkers();\n    },\n\n    onNodeMarkerMovedChangeNode: function(e) {\n        var marker = e.target,\n            latlng = marker.getLatLng(),\n            node = marker._lineNode;\n        node.lat = latlng.lat;\n        node.lng = latlng.lng;\n        this.redraw();\n        this.fire('nodeschanged');\n    },\n\n    onNodeMarkerDblClickedRemoveNode: function(e) {\n        if (this._disableEditOnLeftClick) {\n            return;\n        }\n        if (this.getLatLngs().length < 2 || (this._drawingDirection && this.getLatLngs().length === 2)) {\n            return;\n        }\n        var marker = e.target,\n            nodeIndex = this.getMarkerIndex(marker);\n        this.removeNode(nodeIndex);\n        this._setupEndMarkers();\n    },\n\n    onMapClick: function(e) {\n        if (this._drawingDirection) {\n            let newNodeIndex,\n                refNodeIndex;\n            if (this._drawingDirection === -1) {\n                newNodeIndex = 1;\n                refNodeIndex = 0;\n            } else {\n                newNodeIndex = this._latlngs.length - 1;\n                refNodeIndex = this._latlngs.length - 1;\n            }\n            this.addNode(newNodeIndex, wrapLatLngToTarget(e.latlng, this._latlngs[refNodeIndex]));\n        } else {\n            if (!this.preventStopEdit) {\n                this.stopEdit(true);\n            }\n        }\n    },\n\n    onMapEndDrag: function(e) {\n        if (e.distance < 15) {\n            // get mouse position from map drag handler\n            var handler = e.target.dragging._draggable;\n            var mousePos = handler._startPoint.add(handler._newPos).subtract(handler._startPos);\n            var latlng = e.target.mouseEventToLatLng({clientX: mousePos.x, clientY: mousePos.y});\n            this.onMapClick({latlng: latlng});\n        }\n    },\n\n    startDrawingLine: function(direction, e) {\n        if (!this._editing) {\n            return;\n        }\n        if (direction === undefined) {\n            direction = 1;\n        }\n        if (this._drawingDirection === direction) {\n            return;\n        }\n        this.stopDrawingLine();\n        this._drawingDirection = direction;\n        if (e) {\n            var newNodeIndex = this._drawingDirection === -1 ? 0 : this.getLatLngs().length;\n            this.spliceLatLngs(newNodeIndex, 0, e.latlng);\n            this._setupEndMarkers();\n        }\n\n        this._map.on('mousemove', this.onMouseMoveFollowEndNode, this);\n        L.DomUtil.addClass(this._map._container, 'leaflet-line-drawing');\n        this._map.clickLocked = true;\n    },\n\n    stopDrawingLine: function() {\n        if (!this._drawingDirection) {\n            return;\n        }\n        this._map.off('mousemove', this.onMouseMoveFollowEndNode, this);\n        var nodeIndex = this._drawingDirection === -1 ? 0 : this.getLatLngs().length - 1;\n        this.spliceLatLngs(nodeIndex, 1);\n        this._drawingDirection = 0;\n        L.DomUtil.removeClass(this._map._container, 'leaflet-line-drawing');\n        this._map.clickLocked = false;\n        this._setupEndMarkers();\n        this.fire('drawend');\n    },\n\n    onKeyPress: function(e) {\n        if (e.target.tagName.toLowerCase() === 'input') {\n            return;\n        }\n        var code = e.keyCode;\n        switch (code) {\n            case 27:\n            case 13:\n                if (this._drawingDirection) {\n                    this.stopDrawingLine();\n                } else {\n                    if (!this.preventStopEdit) {\n                        this.stopEdit(true);\n                    }\n                }\n                L.DomEvent.stop(e);\n                break;\n            case 8:\n            case 46:\n                if (this._drawingDirection && this.getLatLngs().length > 2) {\n                    const nodeIndex = this._drawingDirection === 1 ? this.getLatLngs().length - 2 : 1;\n                    this.removeNode(nodeIndex);\n                    L.DomEvent.preventDefault(e);\n                }\n                break;\n\n            default:\n        }\n    },\n\n    onMouseMoveFollowEndNode: function(e) {\n        var nodeIndex = this._drawingDirection === -1 ? 0 : this.getLatLngs().length - 1;\n        let latlng = e.latlng;\n        if (this._latlngs.length > 0) {\n            latlng = wrapLatLngToTarget(latlng, this._latlngs[nodeIndex]);\n        }\n        this.spliceLatLngs(nodeIndex, 1, latlng);\n    },\n\n    makeNodeMarker: function(nodeIndex) {\n        // если кликнули по созданию нового трэка, то делаем линию тоньше только когда появятся 2 точки\n        if (this._latlngs.length === 2) {\n            this.setStyle({weight: 1.5, opacity: 1});\n        }\n        var node = this.getLatLngs()[nodeIndex],\n            marker = L.marker(node.clone(), {\n                    icon: L.divIcon({\n                        className: 'line-editor-node-marker-halo',\n                        html: '<div class=\"line-editor-node-marker\"></div>'\n                    }),\n                    draggable: true,\n                    zIndexOffset: this._nodeMarkersZOffset,\n                    projectedShift: () => this.shiftProjectedFitMapView()\n                }\n            );\n        marker\n            .on('drag', this.onNodeMarkerMovedChangeNode, this)\n            // .on('dragstart', this.fire.bind(this, 'editingstart'))\n            .on('dragend', this.onNodeMarkerDragEnd, this)\n            .on('dblclick', this.onNodeMarkerDblClickedRemoveNode, this)\n            .on('click', this.onNodeMarkerClickStartStopDrawing, this)\n            .on('contextmenu', function(e) {\n                    this.stopDrawingLine();\n                    this.fire('noderightclick', {\n                            nodeIndex: this.getMarkerIndex(marker),\n                            line: this,\n                            mouseEvent: e\n                        }\n                    );\n                }, this\n            );\n        marker._lineNode = node;\n        node._nodeMarker = marker;\n        marker.addTo(this.nodeMarkers);\n    },\n\n    onNodeMarkerClickStartStopDrawing: function(e) {\n        if (this._disableEditOnLeftClick) {\n            return;\n        }\n        var marker = e.target,\n            latlngs = this.getLatLngs(),\n            latlngs_n = latlngs.length,\n            nodeIndex = this.getMarkerIndex(marker);\n        if ((this._drawingDirection === -1 && nodeIndex === 1) ||\n            ((this._drawingDirection === 1 && nodeIndex === latlngs_n - 2))) {\n            this.stopDrawingLine();\n        } else if (nodeIndex === this.getLatLngs().length - 1) {\n            this.startDrawingLine(1, e);\n        } else if (nodeIndex === 0) {\n            this.startDrawingLine(-1, e);\n        }\n    },\n\n    makeSegmentOverlay: function(nodeIndex) {\n        const latlngs = this.getLatLngs(),\n            p1 = latlngs[nodeIndex],\n            p2 = latlngs[nodeIndex + 1];\n        if (!p2) {\n            return;\n        }\n        const segmentOverlay = L.polyline([p1, p2], {\n            weight: 10,\n            opacity: 0.0,\n            projectedShift: () => this.shiftProjectedFitMapView()\n        });\n        segmentOverlay.on('mousedown', this.onSegmentMouseDownAddNode, this);\n        segmentOverlay.on('contextmenu', function(e) {\n                this.stopDrawingLine();\n                this.fire('segmentrightclick', {\n                        nodeIndex: this.getSegmentOverlayIndex(segmentOverlay),\n                        mouseEvent: e,\n                        line: this\n                    }\n                );\n            }, this\n        );\n        segmentOverlay._lineNode = p1;\n        p1._segmentOverlay = segmentOverlay;\n        segmentOverlay.addTo(this.segmentOverlays);\n    },\n\n    onSegmentMouseDownAddNode: function(e) {\n        if (e.originalEvent.button !== 0 || this._disableEditOnLeftClick) {\n            return;\n        }\n        var segmentOverlay = e.target,\n            latlngs = this.getLatLngs(),\n            nodeIndex = this.getSegmentOverlayIndex(segmentOverlay) + 1;\n        const midPoint = L.latLngBounds(latlngs[nodeIndex], latlngs[nodeIndex - 1]).getCenter();\n        this.addNode(nodeIndex, wrapLatLngToTarget(e.latlng, midPoint));\n        if (L.Draggable._dragging) {\n            L.Draggable._dragging.finishDrag();\n        }\n        latlngs[nodeIndex]._nodeMarker.dragging._draggable._onDown(e.originalEvent);\n    },\n\n    addNode: function(index, latlng) {\n        var nodes = this.getLatLngs(),\n            isAddingLeft = (index === 1 && this._drawingDirection === -1),\n            isAddingRight = (index === nodes.length - 1 && this._drawingDirection === 1);\n        latlng = latlng.clone();\n        this.spliceLatLngs(index, 0, latlng);\n        this.makeNodeMarker(index);\n        if (!isAddingLeft && (index >= 1)) {\n            if (!isAddingRight) {\n                var prevNode = nodes[index - 1];\n                this.segmentOverlays.removeLayer(prevNode._segmentOverlay);\n                delete prevNode._segmentOverlay._lineNode;\n                delete prevNode._segmentOverlay;\n            }\n            this.makeSegmentOverlay(index - 1);\n        }\n        if (!isAddingRight) {\n            this.makeSegmentOverlay(index);\n        }\n        if (nodes.length < 3) {\n            this._setupEndMarkers();\n        }\n    },\n\n    removeNode: function(index) {\n        var nodes = this.getLatLngs(),\n            node = nodes[index],\n            marker = node._nodeMarker;\n        delete node._nodeMarker;\n        delete marker._lineNode;\n        this.spliceLatLngs(index, 1);\n        this.nodeMarkers.removeLayer(marker);\n        if (node._segmentOverlay) {\n            this.segmentOverlays.removeLayer(node._segmentOverlay);\n            delete node._segmentOverlay._lineNode;\n            delete node._segmentOverlay;\n        }\n        var prevNode = nodes[index - 1];\n        if (prevNode && prevNode._segmentOverlay) {\n            this.segmentOverlays.removeLayer(prevNode._segmentOverlay);\n            delete prevNode._segmentOverlay._lineNode;\n            delete prevNode._segmentOverlay;\n            if ((index < nodes.length - 1) || (index < nodes.length && this._drawingDirection !== 1)) {\n                this.makeSegmentOverlay(index - 1);\n            }\n        }\n    },\n\n    replaceNode: function(index, latlng) {\n        var nodes = this.getLatLngs(),\n            oldNode = nodes[index],\n            oldMarker = oldNode._nodeMarker;\n        this.nodeMarkers.removeLayer(oldNode._nodeMarker);\n        delete oldNode._nodeMarker;\n        delete oldMarker._lineNode;\n        latlng = latlng.clone();\n        this.spliceLatLngs(index, 1, latlng);\n        this.makeNodeMarker(index);\n        if (oldNode._segmentOverlay) {\n            this.segmentOverlays.removeLayer(oldNode._segmentOverlay);\n            delete oldNode._segmentOverlay._lineNode;\n            delete oldNode._segmentOverlay;\n            this.makeSegmentOverlay(index);\n        }\n        var prevNode = nodes[index - 1];\n        if (prevNode && prevNode._segmentOverlay) {\n            this.segmentOverlays.removeLayer(prevNode._segmentOverlay);\n            delete prevNode._segmentOverlay._lineNode;\n            delete prevNode._segmentOverlay;\n            this.makeSegmentOverlay(index - 1);\n        }\n    },\n\n    _setupEndMarkers: function() {\n        const nodesCount = this._latlngs.length;\n        if (nodesCount === 0) {\n            return;\n        }\n        const startIndex = this._drawingDirection === -1 ? 1 : 0;\n        const endIndex = this._drawingDirection === 1 ? nodesCount - 2 : nodesCount - 1;\n        const startIcon = this._latlngs[startIndex]._nodeMarker._icon;\n        L.DomUtil[this._drawingDirection === -1 ? 'removeClass' : 'addClass'](\n            startIcon, 'line-editor-node-marker-start'\n        );\n        if (endIndex >= 0) {\n            const endIcon = this._latlngs[endIndex]._nodeMarker._icon;\n            let func;\n            if (this._drawingDirection !== 1 && endIndex > 0) {\n                func = L.DomUtil.addClass;\n            } else {\n                func = L.DomUtil.removeClass;\n            }\n            func(endIcon, 'line-editor-node-marker-end');\n        }\n    },\n\n    setupMarkers: function() {\n        if (!this.segmentOverlays) {\n            this.segmentOverlays = L.featureGroup().addTo(this._map);\n        }\n        if (!this.nodeMarkers) {\n            this.nodeMarkers = L.featureGroup().addTo(this._map);\n        }\n        this.removeMarkers();\n        var latlngs = this.getLatLngs(),\n            startNode = 0,\n            endNode = latlngs.length - 1;\n        if (this._drawingDirection === -1) {\n            startNode += 1;\n        }\n        if (this._drawingDirection === 1) {\n            endNode -= 1;\n        }\n        for (var i = startNode; i <= endNode; i++) {\n            this.makeNodeMarker(i);\n            if (i < endNode) {\n                this.makeSegmentOverlay(i);\n            }\n        }\n        this._setupEndMarkers();\n    },\n\n    spliceLatLngs: function(...args) {\n        const latlngs = this.getLatLngs();\n        const res = latlngs.splice(...args);\n        this.setLatLngs(latlngs);\n        this.fire('nodeschanged');\n        return res;\n        // this._latlngs.splice(...args);\n        // this.redraw();\n    },\n\n    getFixedLatLngs: function() {\n        const start = this._drawingDirection === -1 ? 1 : 0;\n        let end = this._latlngs.length;\n        if (this._drawingDirection === 1) {\n            end -= 1;\n        }\n        return this._latlngs.slice(start, end);\n    },\n\n    disableEditOnLeftClick: function(disable) {\n        this._disableEditOnLeftClick = disable;\n    },\n\n    highlighNodesForDeletion: function(startNodeIndex, endNodeIndex) {\n        if (!this._editing) {\n            return;\n        }\n        const nodes = this.getLatLngs();\n        for (let i = 0; i < nodes.length; i++) {\n            const node = nodes[i];\n            const icon = node._nodeMarker._icon;\n            L.DomUtil[i >= startNodeIndex && i <= endNodeIndex ? 'addClass' : 'removeClass'](icon, 'highlight-delete');\n        }\n    }\n};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from \"leaflet\";\n\nfunction getSegmentSplitPointLat(latLng1, latLng2, lng) {\n    const deltaLat = latLng2.lat - latLng1.lat;\n    const deltaLng = latLng2.lng - latLng1.lng;\n    return latLng1.lat + deltaLat / deltaLng * (lng - latLng1.lng);\n}\n\nfunction splitLineAt180Meridian(latLngs) {\n    // this function also creates new LatLng object for all elements\n    const wrappedLatLngs = latLngs.map((ll) => ll.wrap());\n    const newLines = [];\n    if (latLngs.length < 2) {\n        return newLines;\n    }\n\n    let newLine = [wrappedLatLngs[0]];\n    newLines.push(newLine);\n    for (let i = 1; i < wrappedLatLngs.length; i++) {\n        let latLng = wrappedLatLngs[i];\n        let prevLatLng = wrappedLatLngs[i - 1];\n        if (Math.abs(latLng.lng - prevLatLng.lng) <= 180) {\n            newLine.push(latLng);\n        } else {\n            let positiveLng = L.Util.wrapNum(latLng.lng, [0, 360]);\n            let positivePrevLng = L.Util.wrapNum(prevLatLng.lng, [0, 360]);\n            let splitLng = 180 - 0.000001 * Math.sign(latLng.lng);\n            let splitPrevLng = 180 - 0.000001 * Math.sign(prevLatLng.lng);\n            let splitLat = getSegmentSplitPointLat(\n                L.latLng(prevLatLng.lat, positivePrevLng),\n                L.latLng(latLng.lat, positiveLng),\n                splitLng\n            );\n            let splitPrevLat = getSegmentSplitPointLat(\n                L.latLng(prevLatLng.lat, positivePrevLng),\n                L.latLng(latLng.lat, positiveLng),\n                splitPrevLng\n            );\n            newLine.push(L.latLng(splitPrevLat, splitPrevLng).wrap());\n            newLine = [L.latLng(splitLat, splitLng).wrap(), latLng];\n            newLines.push(newLine);\n        }\n    }\n    return newLines;\n}\n\nfunction splitLinesAt180Meridian(lines) {\n    return (lines || [])\n        .map((segment) => splitLineAt180Meridian(segment))\n        .reduce((acc, cur) => {\n            acc.push(...cur);\n            return acc;\n        }, []);\n}\n\nexport {splitLinesAt180Meridian};\n","import L from 'leaflet';\nimport './track-list';\nimport './ruler.css';\nimport {makeButton} from '~/lib/leaflet.control.commons';\n\nL.Control.TrackList.Ruler = L.Control.extend({\n    options: {\n        position: 'topleft'\n    },\n\n    initialize: function(trackList, options) {\n        L.Control.prototype.initialize.call(this, options);\n        this._trackList = trackList;\n    },\n\n    onAdd: function(map) {\n        this._map = map;\n        let {container} = makeButton('', 'Measure distance', 'icon-ruler');\n        this._container = container;\n        L.DomEvent.on(container, 'click', this.onClick, this);\n        return container;\n    },\n\n    onClick: function() {\n        this._trackList.setExpanded();\n        this._trackList.addTrackAndEdit('Ruler').measureTicksShown(true);\n    }\n\n});\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {NakarteUrlLoader} from './lib/services/nakarte';\n\nL.Control.TrackList.include({\n        hashParams: function() {\n            return new NakarteUrlLoader().paramNames();\n        },\n\n        loadTrackFromParam: async function(paramName, values) {\n            if (!values || !values.length) {\n                return;\n            }\n            this.readingFiles(this.readingFiles() + 1);\n            const geodata = await new NakarteUrlLoader().geoData(paramName, values);\n            const notEmpty = this.addTracksFromGeodataArray(geodata, paramName);\n            this.readingFiles(this.readingFiles() - 1);\n            if (notEmpty) {\n                this.setExpanded();\n            }\n        },\n    }\n);\n\n","import './track-list';\nimport L from 'leaflet';\nimport {parseNktkSequence} from './lib/parsers/nktk';\nimport safeLocalStorage from '~/lib/safe-localstorage';\nimport * as logging from '~/lib/logging';\n\nL.Control.TrackList.include({\n        maxLocalStorageSessions: 5,\n\n        saveTracksToStorage: function() {\n            var tracks = this.tracks(),\n                serialized = [],\n                i, track, s, key;\n\n            key = 'trackList_1';\n\n            if (tracks.length === 0) {\n                safeLocalStorage.setItem(key, '');\n                return;\n            }\n            for (i = 0; i < tracks.length; i++) {\n                track = tracks[i];\n                if ( 'default' !== track.group() ) {\n                    continue;\n                }\n                s = this.trackToString(track);\n                serialized.push(s);\n            }\n            if (serialized.length === 0) {\n                return;\n            }\n            s = '#nktk=' + serialized.join('/');\n\n            safeLocalStorage.setItem(key, s);\n        },\n\n        loadTracksFromStorage: function() {\n            let key = 'trackList_1';\n            let s = safeLocalStorage.getItem(key);\n            //safeLocalStorage.removeItem(key);\n            if (s) {\n                logging.captureBreadcrumb('load track from localStorage');\n                s = s.slice(6); // remove \"#nktk=\" prefix\n                let geodata = parseNktkSequence(s);\n                this.addTracksFromGeodataArray(geodata);\n            }\n        }\n    }\n);\n","import L from 'leaflet';\nimport './style.css';\nimport '~/lib/controls-styles/controls-styles.css';\nimport enableTopRow from '~/lib/leaflet.control.layers.top-row';\n\nfunction enableMinimize(control) {\n    const originalOnAdd = control.onAdd;\n    if (control._minimizeEnabled) {\n        return;\n    }\n    enableTopRow(control);\n\n    L.Util.extend(control, {\n            _minimizeEnabled: true,\n\n            onAdd: function(map) {\n                const container = originalOnAdd.call(this, map);\n                setTimeout(() => this.__injectMinimizeButtons(), 0);\n                return container;\n            },\n\n            __injectMinimizeButtons: function() {\n                const container = this._container;\n                const contentsWrapper = L.DomUtil.create('div', 'leaflet-control-content');\n                while (container.childNodes.length) {\n                    contentsWrapper.appendChild(container.childNodes[0]);\n                }\n                container.appendChild(contentsWrapper);\n                const minimizeButton = L.DomUtil.create('div', 'button-minimize');\n                this._topRow.appendChild(minimizeButton);\n                const expandButton = L.DomUtil.create('div', 'leaflet-control-button-toggle', container);\n                expandButton.title = 'Select layers';\n                L.DomEvent.on(expandButton, 'click', this.setExpanded, this);\n                L.DomEvent.on(minimizeButton, 'click', this.setMinimized, this);\n            },\n\n            setExpanded: function() {\n                L.DomUtil.removeClass(this._container, 'minimized');\n            },\n\n            setMinimized: function() {\n                L.DomUtil.addClass(this._container, 'minimized');\n            }\n        }\n    );\n    if (control._map) {\n        control.__injectMinimizeButtons();\n    }\n}\n\nexport default enableMinimize;\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport './style.css';\nimport enableTopRow from '~/lib/leaflet.control.layers.top-row';\nimport './customLayer';\n\nfunction enableConfig(control, {layers}) {\n    const originalOnAdd = control.onAdd;\n    const originalUnserializeState = control.unserializeState;\n    let layers_loaded = false;\n    if (control._configEnabled) {\n        return;\n    }\n    enableTopRow(control);\n\n    L.Util.extend(control, {\n            _configEnabled: true,\n            _allLayersGroups: layers,\n            _allLayers: [].concat(...layers.map((group) => group.layers)),\n\n            onAdd: function(map) {\n                const container = originalOnAdd.call(this, map);\n                return container;\n            },\n\n            _initializeLayersState: function() {\n                this.updateEnabledLayers(); // eslint-disable-line\n            },\n\n            updateEnabledLayers: function(addedLayers) {\n                let hasBaselayerOnMap = false;\n                const enabledLayers = [...this._allLayers];\n                enabledLayers.sort((l1, l2) => l1.order - l2.order);\n                enabledLayers.forEach((l) => {\n                        l.layer._justAdded = addedLayers && addedLayers.includes(l);\n                        const {layer: {options: {isOverlay}}} = l;\n                        if (isOverlay) {\n                            this.addOverlay(l.layer, l.title);\n                        } else {\n                            this.addBaseLayer(l.layer, l.title);\n                        }\n                        if (!isOverlay && this._map.hasLayer(l.layer)) {\n                              hasBaselayerOnMap = true;\n                        }\n                    }\n                );\n                // если нет активного базового слоя, включить первый, если он есть\n                if (!hasBaselayerOnMap) {\n                    for (let layer of enabledLayers) {\n                        if (!layer.layer.options.isOverlay) {\n                            this._map.addLayer(layer.layer);\n                            break;\n                        }\n                    }\n                }\n                layers_loaded = true;\n                /* this.storeEnabledLayers(); */\n            },\n\n            unserializeState: function(values) {\n                if ( ! layers_loaded ) {\n                    this.updateEnabledLayers();\n                }\n\n                return originalUnserializeState.call(this, values);\n            },\n        }\n    );\n}\n\nexport default enableConfig;\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\n\nL.Layer.CustomLayer = L.TileLayer.extend({\n    getTileUrl: function(coords) {\n        const z = this._getZoomForUrl();\n        var data = {\n            r: L.Browser.retina ? '@2x' : '',\n            s: this._getSubdomain(coords),\n            x: coords.x,\n            y: coords.y,\n            z: z,\n            z_1: z + 1,\n            x_1024: Math.floor(coords.x / 1024),\n            y_1024: Math.floor(coords.y / 1024),\n        };\n        if (this._map && !this._map.options.crs.infinite) {\n            var invertedY = this._globalTileRange.max.y - coords.y;\n            if (this.options.tms) {\n                data['y'] = invertedY;\n                data['y_1024'] = Math.floor(invertedY / 1024);\n            }\n            data['-y'] = invertedY;\n        }\n\n        return L.Util.template(this._url, L.extend(data, this.options));\n    },\n\n    cloneForPrint: function(options) {\n        return new L.Layer.CustomLayer(this._url, L.Util.extend({}, this.options, options));\n    },\n\n});\n","import './style.css';\nimport L from 'leaflet';\n\nfunction raiseControlsOnFocus(map) {\n    const selectors = [\n        '.leaflet-top.leaflet-right',\n        '.leaflet-bottom.leaflet-right',\n        '.leaflet-top.leaflet-left',\n        '.leaflet-bottom.leaflet-left'\n    ];\n    let elements = map._container.querySelectorAll(selectors.join(','));\n\n    function raise(target) {\n        for (let cornerDiv of elements) {\n            if (cornerDiv === target) {\n                L.DomUtil.addClass(cornerDiv, 'leaflet-controls-corner-raised');\n            } else {\n                L.DomUtil.removeClass(cornerDiv, 'leaflet-controls-corner-raised');\n            }\n        }\n    }\n\n    [...elements].forEach((el) => L.DomEvent.on(el, 'mouseenter', raise.bind(null, el)));\n}\n\nexport default raiseControlsOnFocus;\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport '~/lib/leaflet.layer.yandex';\nimport '~/lib/leaflet.layer.google';\nimport '~/lib/leaflet.layer.soviet-topomaps-grid';\nimport '~/lib/leaflet.layer.wikimapia';\nimport {RetinaTileLayer} from '~/lib/leaflet.layer.RetinaTileLayer';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nconst layersDefs = [\n    {\n        title: 'OpenStreetMap',\n        description: 'OSM default style',\n        isDefault: true,\n        layer: L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n            {\n                code: 'O',\n                isOverlay: false,\n                scaleDependent: true,\n                print: true,\n                jnx: true,\n                shortName: 'osm',\n                attribution: '© Участники <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> '\n            }\n        )\n    },\n    {\n        title: 'OpenCycleMap',\n        description: '<a href=\"https://www.opencyclemap.org/docs/\">(Info and key)</a>',\n        isDefault: false,\n        layer: L.tileLayer('https://{s}.tile.thunderforest.com/cycle/{z}/{x}/{y}.png',\n            {\n                code: 'Ocm',\n                isOverlay: false,\n                scaleDependent: true,\n                print: true,\n                hotkey: 'H',\n                jnx: true,\n                shortName: 'opencyclemap',\n                attribution: 'Thunderforest <a href=\"https://www.opencyclemap.org/\">OpenCycleMap</a>'\n            }\n        )\n    },\n    {\n        title: 'OpenTopoMap',\n        isDefault: true,\n        layer: L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png',\n            {\n                code: 'Otm',\n                isOverlay: false,\n                maxNativeZoom: 17,\n                scaleDependent: true,\n                print: true,\n                jnx: true,\n                noCors: false,\n                shortName: 'opentopo',\n                attribution: '<a href=\"https://opentopomap.org/\">OpenTopoMap</a>'\n            }\n        )\n    },\n    {\n        title: 'Yandex Спутник',\n        isDefault: true,\n        layer: new L.Layer.Yandex.Sat(\n            {\n                scaleDependent: false,\n                code: 'S',\n                isOverlay: false,\n                print: true,\n                jnx: true,\n                shortName: 'yandex_sat',\n                attribution: '<a href=\"https://yandex.ru/maps/?l=sat\">Yandex</a>'\n            }\n        )\n    },\n    {\n        title: 'Google Спутник',\n        isDefault: true,\n        layer: new L.Layer.GoogleSat(\n            {\n                code: 'L',\n                isOverlay: false,\n                scaleDependent: false,\n                print: true,\n                jnx: true,\n                shortName: 'google_sat',\n                attribution: '<a href=\"https://www.google.com/maps/@45.0000194,34.336961,9z\">Google</a>'\n            }\n        )\n    },\n    {\n        title: 'ESRI Спутник',\n        isDefault: true,\n        layer: L.tileLayer(\n            'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',\n            {\n                code: 'E',\n                isOverlay: false,\n                scaleDependent: false,\n                maxNativeZoom: 18,\n                print: true,\n                jnx: true,\n                shortName: 'esri',\n                attribution: 'ESRI World Imagery for <a href=\"https://www.arcgis.com/\">ArcGIS</a>'\n            }\n        )\n    },\n    {\n        title: 'Советская карта (zoom ≥ 12)',\n        isDefault: true,\n        layer: L.tileLayer('https://{s}.tiles.nakarte.me/topo500/{z}/{x}/{y}',\n            {\n                code: 'B',\n                isOverlay: true,\n                isOverlayTransparent: false,\n                tms: true,\n                scaleDependent: false,\n                maxNativeZoom: 14,\n                minZoom: 12,\n                print: true,\n                jnx: true,\n                shortName: 'topo_500'\n            }\n        )\n    },\n    {\n        title: 'Разбивка на квадраты',\n        isDefault: true,\n        layer: new L.Layer.SovietTopoGrid({\n            code: 'Ng',\n            isOverlay: true,\n            print: false,\n            jnx: false\n        })\n    },\n    {\n        title: 'Wikimapia',\n        isDefault: true,\n        layer: new L.Wikimapia({\n            code: 'W',\n            hotkey: 'W',\n            isOverlay: true,\n            print: false,\n            jnx: false\n        })\n    },\n    {\n        title: 'OpenStreetMap GPS трэки',\n        isDefault: false,\n        layer: L.tileLayer('https://{s}.gps-tile.openstreetmap.org/lines/{z}/{x}/{y}.png',\n            {\n                code: 'Ot',\n                isOverlay: true,\n                isOverlayTransparent: true,\n                scaleDependent: true,\n                print: true,\n                jnx: false,\n                shortName: 'osm_gps_traces'\n            }\n        )\n    },\n    {\n        title: 'Strava трэки',\n        isDefault: false,\n        layer: new RetinaTileLayer(\n            [\n                urlViaCorsProxy(\n                    'https://heatmap-external-a.strava.com/tiles-auth/all/hot/{z}/{x}/{y}.png?px=256'\n                ),\n                urlViaCorsProxy(\n                    'https://heatmap-external-a.strava.com/tiles-auth/all/hot/{z}/{x}/{y}.png?px=512'\n                ),\n            ],\n            {\n                code: 'Sa',\n                hotkey: 'T',\n                isOverlay: true,\n                isOverlayTransparent: true,\n                scaleDependent: false,\n                print: true,\n                jnx: false,\n                subdomains: 'abc',\n                noCors: true,\n                shortName: 'strava_all',\n                retinaOptionsOverrides: [{maxNativeZoom: 16}, {maxNativeZoom: 15}],\n            }\n        )\n    },\n    {\n        title: 'Маркированные маршруты',\n        description: '<a href=\"https://hiking.waymarkedtrails.org/\">https://hiking.waymarkedtrails.org</a>',\n        isDefault: false,\n        layer: L.tileLayer('https://tile.waymarkedtrails.org/hiking/{z}/{x}/{y}.png',\n            {\n                code: 'Wh',\n                isOverlay: true,\n                tms: false,\n                print: true,\n                jnx: false,\n                scaleDependent: true,\n                shortName: 'hiking_trails',\n                isOverlayTransparent: true\n            })\n    },\n    {\n        title: 'Yandex трэки (zoom ≥ 10)',\n        isDefault: false,\n        layer: new L.Layer.Yandex.Tracks(\n            {\n                scaleDependent: true,\n                code: 'Ytr',\n                isOverlay: true,\n                isOverlayTransparent: true,\n                print: true,\n                jnx: false,\n                shortName: 'yandex_tracks',\n                noCors: true,\n            }\n        )\n    },\n];\n\nfunction getLayers() {\n    // set metadata\n    for (let layer of layersDefs) {\n        layer.layer.meta = {title: layer.title};\n    }\n\n    // divide layers by groups\n    const grouppedLayers = [];\n    let group = {group: 'title', layers: layersDefs};\n    grouppedLayers.push(group);\n\n    return {\n        layers: grouppedLayers,\n    };\n}\n\nexport {getLayers};\n","import L from 'leaflet';\nimport './style.css';\nimport Contextmenu from '~/lib/contextmenu';\nimport copyToClipboard from '~/lib/clipboardCopy';\n\nfunction zeroPad(num, size) {\n    var s = String(num);\n    while (s.length < size) {\n        s = \"0\" + s;\n    }\n    return s;\n}\n\nconst bigLetterReplacers = [\n    /* eslint-disable quote-props */\n    {\n        '1': 'А',\n        '2': 'Б',\n        '3': 'В',\n        '4': 'Г'\n    },\n    {\n        '1': 'A',\n        '2': 'B',\n        '3': 'C',\n        '4': 'D'\n    }\n    /* eslint-enable quote-props */\n];\n\nvar Nomenclature = {\n    getQuadName1m: function(column, row, join) {\n        var name = '';\n        if (row < 0) {\n            row = -row - 1;\n            name += 'x';\n        }\n        column += 31;\n        name += 'ABCDEFGHIJKLMNOPQRSTUV'[row] + '-' + zeroPad(column, 2);\n        for (var n = 1; n <= join - 1; n++) {\n            name += ',' + zeroPad(column + n, 2);\n        }\n        return [name];\n    },\n\n    getQuadName500k: function(column, row, join) {\n        var name1 = this.getQuadName1m(Math.floor(column / 2), Math.floor(row / 2), 1)[0];\n        var subquad = 2 - (row & 1) * 2 + (column & 1) + 1;\n        let name2 = '-' + subquad;\n        if (join > 1) {\n            name2 += ',' + (subquad + 1);\n        }\n        if (join === 4) {\n            name2 +=\n                ',' + this.getQuadName1m(Math.floor((column + 2) / 2), Math.floor(row / 2), 1) + '-' + subquad +\n                ',' + (subquad + 1);\n        }\n        const names = [name1 + name2];\n        for (let replacer of bigLetterReplacers) {\n            let name3 = name2.replace(/\\b[1-4]\\b/gu, (s) => replacer[s]);\n            names.push(name1 + name3);\n        }\n        return names;\n    },\n\n    getQuadName100k: function(column, row, join) {\n        var name = this.getQuadName1m(Math.floor(column / 12), Math.floor(row / 12), 1);\n        const subRow = row - Math.floor(row / 12) * 12;\n        const subColumn = column - Math.floor(column / 12) * 12;\n        var subquad = 132 - subRow * 12 + subColumn + 1;\n        name = name + '-' + zeroPad(subquad, 3);\n        if (join > 1) {\n            name += ',' + zeroPad(subquad + 1, 3);\n        }\n        if (join === 4) {\n            name += ',' + zeroPad(subquad + 2, 3) + ',' + zeroPad(subquad + 3, 3);\n        }\n\n        return [name];\n    },\n\n    getQuadName050k: function(column, row, join) {\n        var name1 = this.getQuadName100k(Math.floor(column / 2), Math.floor(row / 2), 1);\n        var subquad = 2 - (row & 1) * 2 + (column & 1) + 1;\n        let name2 = '-' + subquad;\n        if (join > 1) {\n            name2 += ',' + (subquad + 1);\n        }\n        if (join === 4) {\n            name2 += ',' + this.getQuadName100k(Math.floor((column + 2) / 2), Math.floor(row / 2), 1) + '-' +\n                subquad + ',' + (subquad + 1);\n        }\n        const names = [name1 + name2];\n        for (let replacer of bigLetterReplacers) {\n            let name3 = name2.replace(/\\b[1-4]\\b/gu, (s) => replacer[s]);\n            names.push(name1 + name3);\n        }\n        return names;\n    },\n\n    _getQuads: function(bounds, row_height, column_width, name_factory) {\n        bounds = L.latLngBounds(bounds);\n        var quads = [];\n        var min_lat = Math.max(bounds.getSouth(), -84);\n        var max_lat = Math.min(bounds.getNorth(), 84);\n        var min_row = Math.floor(min_lat / row_height);\n        const maxCols = 360 / column_width;\n        for (var row = min_row; row * row_height < max_lat; row++) {\n            var row_south = row * row_height;\n            var row_north = row_south + row_height;\n            var joined_quads;\n            if (row_south >= 76 || row_north <= -76) {\n                joined_quads = 4;\n            } else if (row_south >= 60 || row_north <= -60) {\n                joined_quads = 2;\n            } else {\n                joined_quads = 1;\n            }\n            var min_lon = bounds.getWest();\n            var max_lon = bounds.getEast();\n            var min_column = Math.floor((min_lon + 180) / column_width / joined_quads) * joined_quads -\n                Math.round(180 / column_width);\n            for (var column = min_column; column * column_width < max_lon; column += joined_quads) {\n                var column_west = column * column_width;\n                var column_east = column_west + column_width * joined_quads;\n                var quad_bounds = L.latLngBounds([[row_south, column_west], [row_north, column_east]]);\n                // shift column to positive numbers, calc modulo, shift back\n                const wrappedColumn = ((column + maxCols / 2) % maxCols + maxCols) % maxCols - maxCols / 2;\n                var names = name_factory(wrappedColumn, row, joined_quads);\n                quads.push({names: names, bounds: quad_bounds});\n            }\n        }\n        return quads;\n    },\n\n    getQuads1m: function(bounds) {\n        return this._getQuads(bounds, 4, 6, this.getQuadName1m);\n    },\n\n    getQuads500k: function(bounds) {\n        return this._getQuads(bounds, 2, 3, this.getQuadName500k.bind(this));\n    },\n\n    getQuads100k: function(bounds) {\n        return this._getQuads(bounds, 4 / 12, 6 / 12, this.getQuadName100k.bind(this));\n    },\n\n    getQuads050k: function(bounds) {\n        return this._getQuads(bounds, 4 / 12 / 2, 6 / 12 / 2, this.getQuadName050k.bind(this));\n    }\n\n};\n\nL.Layer.SovietTopoGrid = L.LayerGroup.extend({\n        options: {},\n\n        initialize: function(options) {\n            L.LayerGroup.prototype.initialize.call(this);\n            L.Util.setOptions(this, options);\n            this.renderer = L.svg({padding: 0.5});\n            this._quads = {};\n            this._updateRenderer = L.Util.throttle(this._updateRenderer, 100, this);\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            map.on('zoomend', this._reset, this);\n            map.on('move', this._update, this);\n            map.on('move', this._updateRenderer, this);\n            this._update();\n        },\n\n        onRemove: function(map) {\n            map.off('zoomend', this._reset, this);\n            map.off('move', this._update, this);\n            this._cleanupQuads(true);\n        },\n\n        _addQuad: function(bounds, id, titles, color, layer, scale) {\n            if (id in this._quads) {\n                return;\n            }\n            var rect_options = {\n                smoothFactor: 0,\n                noClip: true,\n                interactive: false,\n                fill: false,\n                opacity: {1: 0.7, 2: 0.4}[layer],\n                color: color,\n                weight: {1: 1, 2: 3}[layer],\n                renderer: this.renderer\n            };\n\n            var rect = L.rectangle(bounds, rect_options);\n            this.addLayer(rect);\n            if (layer === 1) {\n                rect.bringToBack();\n            }\n            var objects = [rect];\n            const title = titles[0].replace(/-/gu, ' &ndash; ');\n            var html = L.Util.template(`<span style=\"color:{color}\">{title}</span>`, {color: color, title: title});\n            var icon = L.divIcon({html: html, className: 'leaflet-sovietgrid-quadtitle-' + layer, iconSize: null});\n            var marker = L.marker(L.latLngBounds(bounds).getCenter(), {icon: icon});\n            this.addLayer(marker);\n            objects.push(marker);\n            this._quads[id] = objects;\n            marker.on('click contextmenu', this._showContextMenu.bind(this, scale, titles));\n        },\n\n        _showContextMenu: function(scale, titles, e) {\n            const scaleString = {\n                '1m': '1:1 000 000',\n                '500k': '1:500 000',\n                '100k': '1:100 000',\n                '050k': '1:50 000'\n            }[scale];\n            const items = [\n                {text: scaleString, header: true},\n                {text: 'Копировать в буфер обмена', header: true},\n                {\n                    text: titles[0],\n                    callback: () => {\n                        copyToClipboard(titles[0], e.originalEvent);\n                    }\n                }\n            ];\n            if (titles.length > 1) {\n                items.push({\n                        text: titles[1] + ' <span class=\"leaflet-sovietgrid-lang\">RUS</span>',\n                        callback: () => {\n                            copyToClipboard(titles[1], e.originalEvent);\n                        }\n                    }\n                );\n                items.push({\n                        text: titles[2] + ' <span class=\"leaflet-sovietgrid-lang\">LAT</span>',\n                        callback: () => {\n                            copyToClipboard(titles[2], e.originalEvent);\n                        }\n                    }\n                );\n            }\n            const menu = new Contextmenu(items);\n            menu.show(e);\n        },\n\n        _removeQuad: function(id) {\n            this._quads[id].forEach(this.removeLayer.bind(this));\n            delete this._quads[id];\n        },\n\n        _addQuads: function(quads, scale, color, layer) {\n            quads.forEach(function(quad) {\n                    var id = scale + quad.names[0];\n                    this._addQuad(quad.bounds, id, quad.names, color, layer, scale);\n                }.bind(this)\n            );\n        },\n\n        _addGrid: function() {\n            var quads;\n            var layer;\n            var map_bbox = this._map.getBounds();\n            var zoom = this._map.getZoom();\n\n            if (zoom >= 10) {\n                quads = Nomenclature.getQuads050k(map_bbox);\n                layer = (zoom >= 12) ? 2 : 1;\n                this._addQuads(quads, '050k', '#50d', layer);\n            }\n\n            if (zoom >= 8 && zoom < 12) {\n                quads = Nomenclature.getQuads100k(map_bbox);\n                layer = (zoom >= 10) ? 2 : 1;\n                this._addQuads(quads, '100k', '#d50', layer);\n            }\n\n            if (zoom >= 6 && zoom < 10) {\n                quads = Nomenclature.getQuads500k(map_bbox);\n                layer = (zoom >= 8) ? 2 : 1;\n                this._addQuads(quads, '500k', '#099', layer);\n            }\n\n            if (zoom >= 4 && zoom < 8) {\n                layer = (zoom >= 6) ? 2 : 1;\n                quads = Nomenclature.getQuads1m(map_bbox);\n                this._addQuads(quads, '1m', 'blue', layer);\n            }\n        },\n\n        _reset: function() {\n            this._update(true);\n        },\n\n        _cleanupQuads: function(reset) {\n            if (reset === true) {\n                this.clearLayers();\n                this._quads = {};\n            } else {\n                var map_bbox = this._map.getBounds();\n                for (var quad_id of Object.keys(this._quads)) {\n                    var rect = this._quads[quad_id][0];\n                    if (!map_bbox.intersects(rect.getBounds())) {\n                        this._removeQuad(quad_id);\n                    }\n                }\n            }\n        },\n\n        _updateRenderer: function() {\n            if (this.renderer._map) {\n                this.renderer._update();\n            }\n        },\n\n        _update: function(reset) {\n            this._cleanupQuads(reset);\n            this._addGrid();\n        }\n    }\n);\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {WikimapiaLoader} from './wikimapia-loader';\nimport './style.css';\nimport {openPopupWindow} from '~/lib/popup-window';\n\nfunction isPointInPolygon(polygon, p) {\n    var inside = false;\n    var prevNode = polygon[polygon.length - 1],\n        node, i;\n    for (i = 0; i < polygon.length; i++) {\n        node = polygon[i];\n        if (\n            ((node[0] <= p[0] && p[0] < prevNode[0]) || (prevNode[0] <= p[0] && p[0] < node[0])) &&\n            p[1] < (prevNode[1] - node[1]) * (p[0] - node[0]) / (prevNode[0] - node[0]) + node[1]\n        ) {\n            inside = !inside;\n        }\n        prevNode = node;\n    }\n    return inside;\n}\n\nL.Wikimapia = L.GridLayer.extend({\n        options: {\n            tileSize: 1024,\n            updateWhenIdle: true\n        },\n\n        initialize: function(options) {\n            L.GridLayer.prototype.initialize.call(this, options);\n            this.loader = null;\n        },\n\n        onAdd: function(map) {\n            if (!this.loader) {\n                this.loader = new WikimapiaLoader(map);\n            }\n            L.GridLayer.prototype.onAdd.call(this, map);\n            this.on('tileunload', this.onTileUnload, this);\n            map.on('mousemove', this.onMouseMove, this);\n            map.on('click', this.onClick, this);\n        },\n\n        onRemove: function(map) {\n            map.off('mousemove', this.onMouseMove, this);\n            map.off('click', this.onClick, this);\n            if (this.highlightedPlace) {\n                this._map.removeLayer(this.highlightedPlace.polygon);\n                this._map.removeLayer(this.highlightedPlace.label);\n                this.highlightedPlace = null;\n            }\n            L.TileLayer.prototype.onRemove.call(this, map);\n            this.off('tileunload', this.onTileUnload, this);\n        },\n\n        drawTile: function(canvas) {\n            if (!this._map) {\n                return;\n            }\n            const\n                tileData = canvas._tileData,\n                adjustment = canvas._adjustment;\n            if (!tileData) {\n                return;\n            }\n\n            const canvasCtx = canvas.getContext('2d');\n            canvasCtx.beginPath();\n            canvasCtx.strokeStyle = '#CFA600';\n            canvasCtx.lineWidth = 1;\n            for (let place of tileData.places) {\n                let polygon = place.localPolygon;\n                if (!polygon) {\n                    continue;\n                }\n                if (adjustment) {\n                    let {multiplier, offsetX, offsetY} = adjustment,\n                        polygon2 = [];\n                    for (let i = 0; i < polygon.length; i++) {\n                        let p = polygon[i];\n                        polygon2.push({\n                                x: p.x * multiplier - offsetX,\n                                y: p.y * multiplier - offsetY\n                            }\n                        );\n                    }\n                    polygon = polygon2;\n                }\n                canvasCtx.moveTo(polygon[0].x, polygon[0].y);\n                let p;\n                for (let i = 1; i < polygon.length; i++) {\n                    p = polygon[i];\n                    canvasCtx.lineTo(p.x, p.y);\n                }\n                canvasCtx.lineTo(polygon[0].x, polygon[0].y);\n            }\n            canvasCtx.stroke();\n        },\n\n        createTile: function(coords, done) {\n            const canvas = L.DomUtil.create('canvas', 'leaflet-tile');\n            canvas.width = this.options.tileSize;\n            canvas.height = this.options.tileSize;\n            let {dataPromise, abortLoading} = this.loader.requestTileData(coords);\n            dataPromise.then((data) => {\n                if (!data.error) {\n                    canvas._tileData = data.tileData;\n                    canvas._adjustment = data.adjustment;\n                    this.drawTile(canvas);\n                    this._tileOnLoad(done, canvas);\n                }\n            });\n\n            canvas._abortLoading = abortLoading;\n            return canvas;\n        },\n\n        _tileOnLoad: function(done, tile) {\n            // For https://github.com/Leaflet/Leaflet/issues/3332\n            if (L.Browser.ielt9) {\n                setTimeout(L.bind(done, this, null, tile), 0);\n            } else {\n                done(null, tile);\n            }\n        },\n\n        onTileUnload: function(e) {\n            const tile = e.tile;\n            tile._abortLoading();\n            delete tile._tileData;\n            delete tile._adjustment;\n        },\n\n        _tileCoordsFromEvent: function(e) {\n            const layerPoint = this._map.getPixelOrigin().add(e.layerPoint);\n            const tileSize = this.options.tileSize;\n            let coords = {\n                x: Math.floor(layerPoint.x / tileSize),\n                y: Math.floor(layerPoint.y / tileSize),\n                z: this._map.getZoom()\n            };\n\n            return coords;\n        },\n\n        getPlaceAtMousePos: function(e) {\n            const tileCoords = this._tileCoordsFromEvent(e);\n            let tile = this._tiles[this._tileCoordsToKey(tileCoords)];\n            if (!tile) {\n                return null;\n            }\n            const tileData = tile.el._tileData;\n            if (!tileData) {\n                return null;\n            }\n            return this.getPlaceAtLatlng(e.latlng.wrap(), tileData.places);\n        },\n\n        onMouseMove: function(e) {\n            const place = this.getPlaceAtMousePos(e);\n            if (this.highlightedPlace && (!place || this.highlightedPlace.id !== place.id)) {\n                this._map.removeLayer(this.highlightedPlace.polygon);\n                this._map.removeLayer(this.highlightedPlace.label);\n                this.highlightedPlace = null;\n            }\n\n            if (place && !this.highlightedPlace) {\n                this.highlightedPlace = {\n                    id: place.id,\n                    polygon: L.polygon(place.polygon, {\n                            weight: 0,\n                            color: '#E6B800'\n                        }\n                    ),\n                    label: L.tooltip({className: 'wikimapia-tooltip-wrapper'}, null)\n                };\n                this.highlightedPlace.label.setLatLng(e.latlng);\n                this.highlightedPlace.polygon.addTo(this._map).bringToBack();\n                this.highlightedPlace.label.setContent(`<div class=\"wikimapia-tooltip\">${place.title}</div>`);\n                this._map.addLayer(this.highlightedPlace.label);\n            }\n            if (this.highlightedPlace) {\n                this.highlightedPlace.label.setLatLng(e.latlng);\n            }\n        },\n\n        onClick: function(e) {\n            if (this._map.clickLocked) {\n                return;\n            }\n            const place = this.getPlaceAtMousePos(e);\n            if (place) {\n                const url = `http://wikimapia.org/${place.id}/ru/`;\n                openPopupWindow(url, 564, 'wikimapia-details');\n            }\n        },\n\n        getPlaceAtLatlng: function(latlng, places) {\n            let {lat, lng} = latlng,\n                bounds, place;\n            for (let i = places.length - 1; i >= 0; i--) {\n                place = places[i];\n                bounds = place.boundsWESN;\n                if (lng >= bounds[0] && lng <= bounds[1] && lat >= bounds[2] && lat <= bounds[3] &&\n                    isPointInPolygon(place.polygon, [lat, lng])) {\n                    return place;\n                }\n            }\n            return null;\n        }\n\n    }\n);\n","import {TiledDataLoader} from '~/lib/tiled-data-loader';\nimport * as wmUtils from './wm-utils';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nclass WikimapiaLoader extends TiledDataLoader {\n    maxZoom = 15;\n    minZoom = 1;\n    tileSize = 1024;\n\n    constructor(projectObj) {\n        super();\n        this._projectObj = projectObj;\n    }\n\n    getFromCache(dataTileCoords) {\n        dataTileCoords = {...dataTileCoords};\n        let exactMatch = true;\n        while (dataTileCoords.z >= 0) {\n            let key = this.makeTileKey(dataTileCoords);\n            let res = this._cache.get(key);\n            if (res.found) {\n                if (exactMatch || !res.value.hasChildren) {\n                    res['coords'] = dataTileCoords;\n                    return res;\n                }\n                break;\n            }\n            dataTileCoords.z -= 1;\n            dataTileCoords.x = Math.floor(dataTileCoords.x / 2);\n            dataTileCoords.y = Math.floor(dataTileCoords.y / 2);\n            exactMatch = false;\n        }\n        return {found: false};\n    }\n\n    layerTileToDataTileCoords(layerTileCoords) {\n        let z = layerTileCoords.z - 2;\n        if (z > this.maxZoom) {\n            let z2 = this.maxZoom,\n                multiplier = 1 << (z - z2);\n            return {\n                x: Math.floor(layerTileCoords.x / multiplier),\n                y: Math.floor(layerTileCoords.y / multiplier),\n                z: z2\n            };\n        } else if (z < this.minZoom) {\n            let z2 = this.minZoom,\n                multiplier = 1 / (1 << (z2 - z));\n            return {\n                x: Math.floor(layerTileCoords.x / multiplier),\n                y: Math.floor(layerTileCoords.y / multiplier),\n                z: z2\n            };\n        }\n        return {z, x: layerTileCoords.x, y: layerTileCoords.y};\n    }\n\n    makeRequestData(dataTileCoords) {\n        let url = wmUtils.makeTileUrl(dataTileCoords);\n        url = urlViaCorsProxy(url);\n        return {\n            url,\n            options: {timeout: 20000}\n        };\n    }\n\n    processResponse(xhr) {\n        return wmUtils.parseTile(xhr.response, this._projectObj)\n            .then((tileData) => ({\n                        tileData,\n                        coords: tileData.coords\n            }));\n    }\n\n    calcAdjustment(layerTileCoords, dataTileCoords) {\n        const adjustment = super.calcAdjustment(\n            {x: layerTileCoords.x, y: layerTileCoords.y, z: layerTileCoords.z - 2},\n            dataTileCoords\n        );\n        if (adjustment) {\n            adjustment.offsetX *= 1024;\n            adjustment.offsetY *= 1024;\n        }\n        return adjustment;\n    }\n}\n\nexport {WikimapiaLoader};\n","import L from 'leaflet';\n\n// (1233,130,5) -> \"032203\"\nfunction getTileId({x, y, z}) {\n    let id = [];\n    y = (1 << z) - y - 1;\n    z += 1;\n    while (z) {\n        id.push((x & 1) + (y & 1) * 2);\n        x >>= 1;\n        y >>= 1;\n        z -= 1;\n    }\n    return id.reverse().join('');\n}\n\nfunction makeTileUrl(coords) {\n    const\n        tileId = getTileId(coords),\n        urlPath = tileId.replace(/(\\d{3})(?!$)/gu, '$1/'); // \"033331022\" -> \"033/331/022\"\n    return `http://wikimapia.org/z1/itiles/${urlPath}.xy?342342`;\n}\n\nfunction tileIdToCoords(tileId) {\n    const z = tileId.length - 1;\n    let x = 0,\n        y = 0;\n    for (let i = 0; i < tileId.length; i++) {\n        let c = parseInt(tileId[i], 10);\n        x <<= 1;\n        y <<= 1;\n        x += c & 1;\n        y += c >> 1;\n    }\n    y = (1 << z) - y - 1;\n    return {x, y, z};\n}\n\nfunction getWikimapiaTileCoords(coords, viewTileSize) {\n    let z = coords.z - 2;\n    if (z < 0) {\n        z = 0;\n    }\n    if (z > 15) {\n        z = 15;\n    }\n    const q = 2 ** (z - coords.z + Math.log2(viewTileSize / 256));\n    let x = Math.floor(coords.x * q),\n        y = Math.floor(coords.y * q);\n    return {x, y, z};\n}\n\nfunction decodeTitles(s) {\n    const titles = {};\n    for (let title of s.split('\\x1f')) {\n        if (title.length > 2) {\n            let langCode = title.charCodeAt(0) - 32;\n            titles[langCode.toString()] = title.substring(1);\n        }\n    }\n    return titles;\n}\n\nfunction chooseTitle(titles) {\n    var popularLanguages = ['1', '0', '3', '2', '5', '4', '9', '28', '17', '27'];\n    for (let langCode of popularLanguages) {\n        if (langCode in titles) {\n            return titles[langCode];\n        }\n    }\n    for (let langCode of Object.keys(titles)) {\n        return titles[langCode];\n    }\n    return \"\";\n}\n\nfunction decodePolygon(s) {\n    var i = 0,\n        coords = [],\n        lat = 0,\n        lng = 0;\n    while (i < s.length) {\n        var p,\n            l = 0,\n            c = 0;\n        do {\n            p = s.charCodeAt(i++) - 63; // eslint-disable-line no-plusplus\n            c |= (p & 31) << l;\n            l += 5;\n        } while (p >= 32);\n        lng += c & 1 ? ~(c >> 1) : c >> 1;\n        l = 0;\n        c = 0;\n        do {\n            p = s.charCodeAt(i++) - 63; // eslint-disable-line no-plusplus\n            c |= (p & 31) << l;\n            l += 5;\n        } while (p >= 32);\n        lat += c & 1 ? ~(c >> 1) : c >> 1;\n        coords.push([lat / 1e6, lng / 1e6]);\n    }\n    return coords;\n}\n\nfunction makeCoordsLocal(line, tileCoords, projectObj) {\n    const {x: tileX, y: tileY, z: tileZ} = tileCoords,\n        x0 = tileX * 1024,\n        y0 = tileY * 1024,\n        localCoords = [];\n    let latlon, p;\n    for (let i = 0; i < line.length; i++) {\n        latlon = line[i];\n        p = projectObj.project(latlon, tileZ + 2);\n        p.x -= x0;\n        p.y -= y0;\n        localCoords.push(p);\n    }\n    return localCoords;\n}\n\nfunction asap() {\n    return new Promise((resolve) => setTimeout(resolve, 0));\n}\n\nfunction simplifyPolygon(latlngs, tileCoords, tileHasChildren, projectObj) {\n    const\n        x = tileCoords.x * 1024,\n        y = tileCoords.y * 1024,\n        p0 = projectObj.unproject([x, y], tileCoords.z + 2),\n        p1 = projectObj.unproject([x + 1, y + 1], tileCoords.z + 2);\n    let pixelDegSize = p0.lat - p1.lat;\n    if (!tileHasChildren && tileCoords.z < 15) {\n        pixelDegSize /= (1 << (15 - tileCoords.z));\n    }\n    let points = [];\n    for (let i = 0; i < latlngs.length; i++) {\n        let ll = latlngs[i];\n        points.push({x: ll[0], y: ll[1]});\n    }\n    points = L.LineUtil.simplify(points, pixelDegSize * 2);\n    latlngs = [];\n    for (let i = 0; i < points.length; i++) {\n        let p = points[i];\n        latlngs.push([p.x, p.y]);\n    }\n    return latlngs;\n}\n\nasync function parseTile(s, projectObj) {\n    const tile = {};\n    const places = tile.places = [];\n    const lines = s.split('\\n');\n    if (lines.length < 1) {\n        throw new Error('No data in tile');\n    }\n    const fields = lines[0].split('|');\n    const tileId = fields[0];\n    if (!tileId || !tileId.match(/^[0-3]+$/u)) {\n        throw new Error('Invalid tile header');\n    }\n    tile.tileId = tileId;\n    tile.coords = tileIdToCoords(tileId);\n    tile.hasChildren = fields[1] === '1';\n\n    // FIXME: ignore some errors\n    let prevTime = Date.now();\n    for (let line of lines.slice(2)) {\n        let curTime = Date.now();\n        if (curTime - prevTime > 20) {\n            await asap();\n            prevTime = Date.now();\n        }\n        const place = {};\n        const fields = line.split('|');\n        if (fields.length < 6) {\n            continue;\n        }\n        let placeId = fields[0];\n        if (!placeId.match(/^\\d+$/u)) {\n            // throw new Error('Invalid place id');\n            continue;\n        }\n        place.id = parseInt(placeId, 10);\n        place.title = chooseTitle(decodeTitles(fields[5]));\n        if (fields[6] !== '1') {\n            throw new Error(`Unknown wikimapia polygon encoding type: \"${fields[6]}\"`);\n        }\n\n        let bounds = fields[2].match(/^([-\\d]+),([-\\d]+),([-\\d]+),([-\\d]+)$/u);\n        if (!bounds) {\n            throw new Error('Invalid place bounds');\n        }\n        place.boundsWESN = bounds.slice(1).map((x) => parseInt(x, 10) / 1e7);\n\n        let coords = fields.slice(7).join('|');\n\n        coords = decodePolygon(coords);\n        if (coords.length < 3) {\n            throw new Error(`Polygon has ${coords.length} points`);\n        }\n        let polygon = simplifyPolygon(coords, tile.coords, tile.hasChildren, projectObj);\n        place.polygon = polygon;\n        place.localPolygon = makeCoordsLocal(polygon, tile.coords, projectObj);\n        places.push(place);\n    }\n    return tile;\n}\n\n// быстрое проектирование полигонов\n// TODO: каждые 50-100 мс отдавать управление\n// projectPlacesForZoom: function(tile, viewZoom) {\n//     if (viewZoom < tile.coords.z) {\n//         throw new Error('viewZoom < tile.zoom');\n//     }\n//     if (tile.places && tile.places[0] && tile.places[0].projectedPolygons &&\n//         tile.places[0].projectedPolygons[viewZoom]) {\n//         return;\n//     }\n//     const virtualTileSize = 256 * (2 ** (viewZoom - tile.coords.z));\n//     const p1 = L.point([tile.coords.x * virtualTileSize, tile.coords.y * virtualTileSize]),\n//         p2 = L.point([(tile.coords.x + 1) * virtualTileSize, (tile.coords.y + 1) * virtualTileSize]),\n//         latlng1 = this._map.unproject(p1, viewZoom),\n//         latlng2 = this._map.unproject(p2, viewZoom),\n//         lat0 = latlng1.lat,\n//         lng0 = latlng1.lng;\n//     const qx = (p2.x - p1.x) / (latlng2.lng - latlng1.lng),\n//         qy = (p2.y - p1.y) / (latlng2.lat - latlng1.lat);\n//\n//     const offsets = [],\n//         offsetsStep = virtualTileSize / 64;\n//     const y0 = p1.y;\n//     for (let y = -virtualTileSize; y <= 2 * virtualTileSize; y += offsetsStep) {\n//         let lat = y / qy + lat0;\n//         let offset = this._map.project([lat, lng0], viewZoom).y - y0 - y;\n//         offsets.push(offset);\n//     }\n//\n//     let ll, offset, offsetPos, offsetIndex, offsetIndexDelta, x, y;\n//     const x0 = p1.x;\n//     for (let place of tile.places) {\n//         let polygon = place.polygon;\n//         if (polygon.length < 3) {\n//             continue;\n//         }\n//         let projectedPolygon = [];\n//         for (let i = 0; i < polygon.length; i++) {\n//             ll = polygon[i];\n//             x = (ll[1] - lng0) * qx;\n//             y = (ll[0] - lat0) * qy;\n//             offsetPos = (y + virtualTileSize) / offsetsStep;\n//             offsetIndex = Math.floor(offsetPos);\n//             offsetIndexDelta = offsetPos - offsetIndex;\n//             offset = offsets[offsetIndex] * (1 - offsetIndexDelta) + offsets[offsetIndex + 1] * offsetIndexDelta;\n//             projectedPolygon.push([x + x0, y + offset + y0]);\n//         }\n//         projectedPolygon = projectedPolygon.map(L.point);\n//         projectedPolygon = L.LineUtil.simplify(projectedPolygon, 1.5);\n//         if (!place.projectedPolygons) {\n//             place.projectedPolygons = [];\n//         }\n//         place.projectedPolygons[viewZoom] = projectedPolygon;\n//     }\n// },\n\nexport {getTileId, getWikimapiaTileCoords, parseTile, makeTileUrl};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport '~/lib/leaflet.control.commons';\n\nconst originalLayerOnAdd = L.Control.Layers.prototype.onAdd;\n\nL.Control.Layers.include({\n    onAdd: function(map) {\n        const container = originalLayerOnAdd.call(this, map);\n        this._stopContainerEvents();\n        return container;\n    }\n});\n\nconst originalZoomOnAdd = L.Control.Zoom.prototype.onAdd;\n\nL.Control.Zoom.include({\n    onAdd: function(map) {\n        const container = originalZoomOnAdd.call(this, map);\n        this._container = container;\n        this._stopContainerEvents();\n        return container;\n    }\n});\n","import L from 'leaflet';\nimport ko from 'knockout';\nimport './style.css';\nimport '~/lib/leaflet.control.commons';\nimport {RectangleSelect} from './selector';\nimport Contextmenu from '~/lib/contextmenu';\nimport {makeJnxFromLayer, minZoom} from './jnx-maker';\nimport {saveAs} from '~/vendored/github.com/eligrey/FileSaver';\nimport {notify} from '~/lib/notifications';\nimport * as logging from '~/lib/logging';\n\nL.Control.JNX = L.Control.extend({\n        includes: L.Evented,\n\n        initialize: function(layersControl, options) {\n            L.Control.prototype.initialize.call(this, options);\n            this._layersControl = layersControl;\n            this.makingJnx = ko.observable(false);\n            this.downloadProgressRange = ko.observable(1);\n            this.downloadProgressDone = ko.observable(0);\n            this.contextMenu = new Contextmenu(() => this.makeMenuItems());\n        },\n\n        getLayerForJnx: function() {\n            let selectedLayer = {};\n            for (let layerRec of this._layersControl._layers) {\n                let layer = layerRec.layer;\n                if (this._map.hasLayer(layer) && layer.options && layer.options.jnx) {\n                    selectedLayer = {\n                        layer,\n                        layerName: layerRec.name\n                    };\n                }\n            }\n            return selectedLayer;\n        },\n\n        estimateTilesCount: function(maxZoom) {\n            let tilesCount = 0;\n            const bounds = this._selector.getBounds();\n            for (let zoom = minZoom(maxZoom); zoom <= maxZoom; zoom++) {\n                const topLeftTile = this._map.project(bounds.getNorthWest(), zoom).divideBy(256).floor();\n                const bottomRightTile = this._map.project(bounds.getSouthEast(), zoom).divideBy(256).ceil();\n                tilesCount += Math.ceil((bottomRightTile.x - topLeftTile.x) * (bottomRightTile.y - topLeftTile.y));\n            }\n            return tilesCount;\n        },\n\n        makeMenuItems: function() {\n            const {layer, layerName} = this.getLayerForJnx();\n            if (!layer) {\n                return [{text: 'No supported layers'}];\n            }\n            const maxLevel = layer.options.maxNativeZoom || layer.options.maxZoom || 18;\n            const minLevel = Math.max(0, maxLevel - 6);\n\n            const equatorLength = 40075016;\n            const lat = this._selector.getBounds().getCenter().lat;\n            let metersPerPixel = equatorLength / 2 ** maxLevel / 256 * Math.cos(lat / 180 * Math.PI);\n\n            const items = [{text: layerName, header: true}];\n            for (let zoom = maxLevel; zoom >= minLevel; zoom -= 1) {\n                let tilesCount = this.estimateTilesCount(zoom);\n                let fileSizeMb = tilesCount * 0.02;\n                let itemClass = tilesCount > 50000 ? 'jnx-menu-warning' : '';\n                let resolutionString = metersPerPixel.toFixed(2);\n                let sizeString = fileSizeMb.toFixed(fileSizeMb > 1 ? 0 : 1);\n                let item = {\n                    text: `<span class=\"${itemClass}\">Zoom ${zoom} (${resolutionString} m/pixel) &mdash; ${tilesCount} tiles (~${sizeString} Mb)</span>`, // eslint-disable-line max-len\n                    callback: () => this.makeJnx(layer, layerName, zoom),\n                    disabled: this.makingJnx()\n                };\n                items.push(item);\n                metersPerPixel *= 2;\n            }\n            return items;\n        },\n\n        notifyProgress: function(value, maxValue) {\n            this.downloadProgressDone(this.downloadProgressDone() + value);\n            this.downloadProgressRange(maxValue);\n        },\n\n        makeJnx: function(layer, layerName, zoom) {\n            logging.captureBreadcrumb('start making jnx');\n            this.makingJnx(true);\n            this.downloadProgressDone(0);\n\n            const bounds = this._selector.getBounds();\n            const sanitizedLayerName = layerName.toLowerCase().replace(/[ ()]+/u, '_');\n            const fileName = `nakarte.me_${sanitizedLayerName}_z${zoom}.jnx`;\n            const eventId = logging.randId();\n            this.fire('tileExportStart', {\n                eventId,\n                layer,\n                zoom,\n                bounds,\n            });\n            makeJnxFromLayer(layer, layerName, zoom, bounds, this.notifyProgress.bind(this))\n                .then((fileData) => {\n                    saveAs(fileData, fileName, true);\n                    this.fire('tileExportEnd', {eventId, success: true});\n                })\n                .catch((e) => {\n                    logging.captureException(e, 'Failed to create JNX');\n                    this.fire('tileExportEnd', {\n                        eventId,\n                        success: false,\n                        error: e\n                    });\n                    notify(`Failed to create JNX: ${e.message}`);\n                })\n                .then(() => this.makingJnx(false));\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            const container = this._container = L.DomUtil.create('div', 'leaflet-control leaflet-control-jnx');\n            container.innerHTML = `\n                <a class=\"button\" data-bind=\"visible: !makingJnx(), click: onButtonClicked\"\n                 title=\"Make JNX for Garmin receivers\">JNX</a>\n                <div data-bind=\"\n                    component:{\n                        name: 'progress-indicator',\n                        params: {progressRange: downloadProgressRange, progressDone: downloadProgressDone}\n                    },\n                    visible: makingJnx()\"></div>`;\n            ko.applyBindings(this, container);\n            this._stopContainerEvents();\n            return container;\n        },\n\n        removeSelector: function() {\n            if (this._selector) {\n                this._map.removeLayer(this._selector);\n                this._selector = null;\n                this.fire('selectionchange');\n            }\n        },\n\n        addSelector: function(bounds) {\n            if (!bounds) {\n                bounds = this._map.getBounds().pad(-0.25);\n            }\n            this._selector = new RectangleSelect(bounds)\n                .addTo(this._map)\n                .on('change', () => this.fire('selectionchange'))\n                .on('click contextmenu', (e) => {\n                    L.DomEvent.stop(e);\n                    this.contextMenu.show(e);\n                });\n            this.fire('selectionchange');\n        },\n\n        onButtonClicked: function() {\n            if (this._selector) {\n                if (this._selector.getBounds().intersects(this._map.getBounds().pad(-0.05))) {\n                    this.removeSelector();\n                } else {\n                    this.removeSelector();\n                    this.addSelector();\n                }\n            } else {\n                this.addSelector();\n            }\n        },\n    }\n);\n\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\n\nconst RectangleSelect = L.Rectangle.extend({\n        includes: L.Evented,\n\n        options: {\n            opacity: 1,\n            weight: 0.5,\n            fillOpacity: 0.2,\n            color: '#3388ff',\n            fillColor: '#3388ff',\n\n        },\n\n        onAdd: function(map) {\n            L.Rectangle.prototype.onAdd.call(this, map);\n            this.markers = [];\n            for (let position of ['top', 'right', 'bottom', 'left']) {\n                let marker = L.marker([0, 0], {\n                        icon: L.divIcon({className: `leaflet-rectangle-select-edge edge-${position}`}),\n                        draggable: true\n                    }\n                )\n                    .addTo(map);\n                marker.on({\n                        drag: this.onMarkerDrag,\n                        dragend: this.onMarkerDragEnd\n                    }, this\n                );\n                this.markers[position] = marker;\n            }\n            this.placeMarkers();\n            map.on('zoomend', this.placeMarkers, this);\n        },\n\n        placeMarkers: function() {\n            const bounds = this.getBounds();\n            const topLeftPixel = this._map.project(bounds.getNorthWest());\n            const bottomRightPixel = this._map.project(bounds.getSouthEast());\n            const size = bottomRightPixel.subtract(topLeftPixel);\n            let center = topLeftPixel.add(size.divideBy(2));\n            center = this._map.unproject(center);\n            this.markers['top'].setLatLng([bounds.getNorth(), center.lng]);\n            this.markers['top']._icon.style.width = `${size.x}px`;\n            this.markers['top']._icon.style.marginLeft = `-${size.x / 2}px`;\n            this.markers['right'].setLatLng([center.lat, bounds.getEast()]);\n            this.markers['right']._icon.style.height = `${size.y}px`;\n            this.markers['right']._icon.style.marginTop = `-${size.y / 2}px`;\n            this.markers['bottom'].setLatLng([bounds.getSouth(), center.lng]);\n            this.markers['bottom']._icon.style.width = `${size.x}px`;\n            this.markers['bottom']._icon.style.marginLeft = `-${size.x / 2}px`;\n            this.markers['left'].setLatLng([center.lat, bounds.getWest()]);\n            this.markers['left']._icon.style.height = `${size.y}px`;\n            this.markers['left']._icon.style.marginTop = `-${size.y / 2}px`;\n        },\n\n        onRemove: function(map) {\n            for (let marker of Object.values(this.markers)) {\n                this._map.removeLayer(marker);\n            }\n            this.markers = null;\n            map.off('zoomend', this.placeMarkers, this);\n            L.Rectangle.prototype.onRemove.call(this, map);\n        },\n\n        setBoundsFromMarkers: function() {\n            this.setBounds(\n                [\n                    [this.markers['top'].getLatLng().lat, this.markers['left'].getLatLng().lng],\n                    [this.markers['bottom'].getLatLng().lat, this.markers['right'].getLatLng().lng]\n                ]\n            );\n        },\n        onMarkerDrag: function() {\n            this.setBoundsFromMarkers();\n        },\n\n        onMarkerDragEnd: function() {\n            this.setBoundsFromMarkers();\n            this.placeMarkers();\n            this.fire('change');\n        }\n    }\n);\n\nexport {RectangleSelect};\n","import L from 'leaflet';\nimport {JnxWriter} from './jnx-encoder';\nimport {getTempMap, disposeMap} from '~/lib/leaflet.layer.rasterize';\nimport {XHRQueue} from '~/lib/xhr-promise';\nimport {arrayBufferToString, stringToArrayBuffer} from '~/lib/binary-strings';\n\nconst defaultXHROptions = {\n    responseType: 'arraybuffer',\n    timeout: 20000,\n    isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 404\n};\n\nfunction minZoom(maxZoom) {\n    return Math.max(maxZoom - 4, 0);\n}\n\nfunction imageFromarrayBuffer(arr) {\n    const dataUrl = 'data:image/png;base64,' + btoa(arrayBufferToString(arr));\n    const image = new Image();\n    return new Promise(function(resolve, reject) {\n            image.onload = () => resolve(image);\n            image.onerror = () => reject(new Error('Tile image corrupt'));\n            image.src = dataUrl;\n        }\n    );\n}\n\nasync function convertToJpeg(image) {\n    try {\n        image = await imageFromarrayBuffer(image);\n    } catch (e) {\n        return null;\n    }\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = image.width;\n    canvas.height = image.height;\n    const ctx = canvas.getContext(\"2d\");\n    ctx.drawImage(image, 0, 0);\n    const dataURL = canvas.toDataURL(\"image/jpeg\");\n    const s = atob(dataURL.replace(/^data:image\\/jpeg;base64,/u, \"\"));\n    return stringToArrayBuffer(s);\n}\n\nfunction ensureImageJpg(image) {\n    if (!image) {\n        return null;\n    }\n    if (arrayBufferToString(image.slice(0, 4)) === '\\x89PNG' &&\n        arrayBufferToString(image.slice(-8)) === 'IEND\\xae\\x42\\x60\\x82') {\n        return convertToJpeg(image);\n    } else if (arrayBufferToString(image.slice(0, 2)) === '\\xff\\xd8' &&\n        arrayBufferToString(image.slice(-2)) === '\\xff\\xd9') {\n        return Promise.resolve(image);\n    }\n    return null;\n}\n\nasync function makeJnxFromLayer(srcLayer, layerName, maxZoomLevel, latLngBounds, progress) {\n    const jnxProductId = L.stamp(srcLayer);\n    const jnxZOrder = Math.min(jnxProductId, 100);\n    const writer = new JnxWriter(layerName, jnxProductId, jnxZOrder);\n    const xhrQueue = new XHRQueue();\n    let doStop = false;\n    let error;\n    const minZoomLevel = minZoom(maxZoomLevel);\n    let progressWeight = 1;\n    for (let zoom = maxZoomLevel; zoom >= minZoomLevel; zoom--) {\n        let pixelBounds = L.bounds(\n            L.CRS.EPSG3857.latLngToPoint(latLngBounds.getNorthWest(), zoom).round(),\n            L.CRS.EPSG3857.latLngToPoint(latLngBounds.getSouthEast(), zoom).round()\n        );\n\n        let promises = [];\n        let layer = srcLayer.cloneForPrint({xhrQueue});\n        let tempMap = getTempMap(zoom, layer._rasterizeNeedsFullSizeMap, pixelBounds);\n        tempMap.addLayer(layer);\n        let {iterateTilePromises, count: tilesCount} = await layer.getTilesInfo({\n                xhrOptions: defaultXHROptions,\n                pixelBounds,\n                rawData: true\n            }\n        );\n        for (let tilePromiseRec of iterateTilePromises()) {\n            promises.push(tilePromiseRec);\n        }\n        for (let {tilePromise} of promises) {\n            let imageRec;\n            try {\n                imageRec = await tilePromise;\n            } catch (e) {\n                error = e;\n                doStop = true;\n                break;\n            }\n            let xhr = imageRec.image;\n\n            if (xhr === null || xhr.status !== 200 || !xhr.response || !xhr.response.byteLength) {\n                continue;\n            }\n            let image = await ensureImageJpg(xhr.response);\n            if (!image) {\n                error = new Error('Tile image invalid');\n                doStop = true;\n                break;\n            }\n            writer.addTile(image, zoom, imageRec.latLngBounds);\n            progress(progressWeight / tilesCount, 4 / 3);\n        }\n        disposeMap(tempMap);\n        if (doStop) {\n            promises.forEach((promiseRec) => promiseRec.abortLoading());\n            throw error;\n        }\n        progressWeight /= 4;\n    }\n\n    return writer.getJnx();\n}\n\nexport {makeJnxFromLayer, minZoom};\n","import L from 'leaflet';\nimport {BinStream} from './binary-stream';\n\nfunction jnxCoordinates(extents) {\n    function toJnx(x) {\n        return Math.round(x / 180.0 * 0x7fffffff);\n    }\n\n    return [toJnx(extents.north), toJnx(extents.east), toJnx(extents.south), toJnx(extents.west)];\n}\n\nconst JnxWriter = L.Class.extend({\n        initialize: function(productName, productId, zOrder) {\n            this.tiles = {};\n            this.productName = productName || 'Raster map';\n            this.productId = productId || 0;\n            this.zOrder = zOrder;\n        },\n\n        addTile: function(tileData, level, latLngBounds) {\n            this.tiles[level] = this.tiles[level] || [];\n            tileData = new Blob([tileData]).slice(2);\n            const extents = {\n                west: latLngBounds.getWest(),\n                north: latLngBounds.getNorth(),\n                south: latLngBounds.getSouth(),\n                east: latLngBounds.getEast(),\n\n            };\n            this.tiles[level].push({data: tileData, extents: extents});\n        },\n\n        getJnx: function() {\n            const HEADER_SIZE = 52,\n                LEVEL_INFO_SIZE = 17,\n                TILE_INFO_SIZE = 28;\n\n            let totalTilesCount = 0;\n            for (let levelTiles of Object.values(this.tiles)) {\n                totalTilesCount += levelTiles.length;\n            }\n            if (totalTilesCount === 0) {\n                throw new Error('No tiles collected, JNX is empty');\n            }\n            if (totalTilesCount > 50000) {\n                throw new Error('Too many tiles found (more then 50000)');\n            }\n\n            let west = 1e10,\n                east = -1e10,\n                north = -1e10,\n                south = 1e10,\n                levels_n = Object.keys(this.tiles).length,\n                level, tiles, extents,\n                i, tile;\n            for (let levelTiles of Object.values(this.tiles)) {\n                for (let tile of levelTiles) {\n                    west = (west < tile.extents.west) ? west : tile.extents.west;\n                    east = (east > tile.extents.east) ? east : tile.extents.east;\n                    north = (north > tile.extents.north) ? north : tile.extents.north;\n                    south = (south < tile.extents.south) ? south : tile.extents.south;\n                }\n            }\n            const stream = new BinStream(1024, true);\n            // header\n            stream.writeInt32(4); // version\n            stream.writeInt32(0); // device id\n            extents = jnxCoordinates({south: south, north: north, west: west, east: east});\n            stream.writeInt32(extents[0]); // north\n            stream.writeInt32(extents[1]); // west\n            stream.writeInt32(extents[2]); // south\n            stream.writeInt32(extents[3]); // east\n            stream.writeInt32(levels_n); // number of zoom levels\n            stream.writeInt32(0); // expiration date\n            stream.writeInt32(this.productId);\n            stream.writeInt32(0); // tiles CRC32\n            stream.writeInt32(0); // signature version\n            stream.writeUint32(0); // signature offset\n            stream.writeInt32(this.zOrder);\n            stream.seek(HEADER_SIZE + LEVEL_INFO_SIZE * levels_n);\n            // map description\n            stream.writeInt32(9); // section version\n            stream.writeString('12345678-1234-1234-1234-123456789ABC', true); // GUID\n            stream.writeString(this.productName, true);\n            stream.writeString('', true);\n            stream.writeInt16(this.productId);\n            stream.writeString(this.productName, true);\n            stream.writeInt32(levels_n);\n            // levels descriptions\n            for (level of Object.keys(this.tiles)) {\n                stream.writeString('', true);\n                stream.writeString('', true);\n                stream.writeString('', true);\n                stream.writeInt32(level);\n            }\n            let tileDescriptorOffset = stream.tell();\n            // level info\n            let jnxScale;\n            stream.seek(HEADER_SIZE);\n            for (level of Object.keys(this.tiles)) {\n                level = parseInt(level, 10);\n                stream.writeInt32(this.tiles[level].length);\n                stream.writeUint32(tileDescriptorOffset);\n                // jnxScale = JnxScales[level + 3];\n                jnxScale = 34115555 / (2 ** level) * Math.cos((north + south) / 2 / 180 * Math.PI) / 1.1;\n                stream.writeInt32(jnxScale);\n                stream.writeInt32(2);\n                stream.writeUint8(0);\n                tileDescriptorOffset += TILE_INFO_SIZE * this.tiles[level].length;\n            }\n            // tiles descriptors\n            stream.seek(stream.size);\n            let tileDataOffset = tileDescriptorOffset;\n            for (level of Object.keys(this.tiles)) {\n                tiles = this.tiles[level];\n                for (i = 0; i < tiles.length; i++) {\n                    tile = tiles[i];\n                    extents = jnxCoordinates(tile.extents);\n                    stream.writeInt32(extents[0]); // north\n                    stream.writeInt32(extents[1]); // west\n                    stream.writeInt32(extents[2]); // south\n                    stream.writeInt32(extents[3]); // east\n                    stream.writeInt16(256); // width\n                    stream.writeInt16(256); // height\n                    stream.writeInt32(tile.data.size);\n                    stream.writeUint32(tileDataOffset);\n                    tileDataOffset += tile.data.size;\n                }\n            }\n\n            const blob = [];\n            blob.push(stream.getBuffer());\n            for (level of Object.keys(this.tiles)) {\n                tiles = this.tiles[level];\n                for (i = 0; i < tiles.length; i++) {\n                    tile = tiles[i];\n                    blob.push(tile.data);\n                }\n            }\n\n            blob.push('BirdsEye');\n            return new Blob(blob);\n        }\n    }\n);\n\nexport {JnxWriter};\n","import utf8 from 'utf8';\n\nclass BinStream {\n    constructor(size, littlEndian) {\n        this.maxSize = 1024;\n        this.dv = new DataView(new ArrayBuffer(this.maxSize));\n        this._pos = 0;\n        this.size = 0;\n        this.littlEndian = littlEndian;\n    }\n\n    grow() {\n        this.maxSize *= 2;\n        const old_buffer = this.dv.buffer;\n        this.dv = new DataView(new ArrayBuffer(this.maxSize));\n        const newAr = new Uint8Array(this.dv.buffer);\n        const oldAr = new Uint8Array(old_buffer);\n        for (let i = 0; i < oldAr.length; i++) {\n            newAr[i] = oldAr[i];\n        }\n    }\n\n    checkSize(size) {\n        if (this._pos + size >= this.maxSize) {\n            this.grow();\n        }\n        const newPos = this._pos + size;\n        this.size = (newPos > this.size) ? newPos : this.size;\n    }\n\n    writeUint8(value) {\n        this.checkSize(1);\n        this.dv.setUint8(this._pos, value);\n        this._pos += 1;\n    }\n\n    writeInt8(value) {\n        this.checkSize(1);\n        this.dv.setInt8(this._pos, value);\n        this._pos += 1;\n    }\n\n    writeInt16(value) {\n        this.checkSize(2);\n        this.dv.setInt16(this._pos, value, this.littlEndian);\n        this._pos += 2;\n    }\n\n    writeUint16(value) {\n        this.checkSize(2);\n        this.dv.setUint16(this._pos, value, this.littlEndian);\n        this._pos += 2;\n    }\n\n    writeInt32(value) {\n        this.checkSize(4);\n        this.dv.setInt32(this._pos, value, this.littlEndian);\n        this._pos += 4;\n    }\n\n    writeUint32(value) {\n        this.checkSize(4);\n        this.dv.setUint32(this._pos, value, this.littlEndian);\n        this._pos += 4;\n    }\n\n    writeString(s, zeroTerminated) {\n        s = utf8.encode(s);\n        for (let i = 0; i < s.length; i++) {\n            this.writeUint8(s.charCodeAt(i));\n        }\n        if (zeroTerminated) {\n            this.writeUint8(0);\n        }\n    }\n\n    tell() {\n        return this._pos;\n    }\n\n    seek(pos) {\n        this._pos = pos;\n    }\n\n    getBuffer() {\n        return this.dv.buffer.slice(0, this.size);\n    }\n}\n\nexport {BinStream};\n","import L from 'leaflet';\nimport '~/lib/leaflet.hashState/leaflet.hashState';\n\nL.Control.JNX.include(L.Mixin.HashState);\nL.Control.JNX.include({\n        stateChangeEvents: ['selectionchange'],\n\n        serializeState: function() {\n            let state;\n            if (this._selector) {\n                const bounds = this._selector.getBounds();\n                state = [\n                    bounds.getSouth().toFixed(5),\n                    bounds.getWest().toFixed(5),\n                    bounds.getNorth().toFixed(5),\n                    bounds.getEast().toFixed(5)\n                ];\n            }\n            return state;\n        },\n\n        unserializeState: function(values) {\n            function validateFloat(value) {\n                value = parseFloat(value);\n                if (isNaN(value)) {\n                    throw new Error('INVALID VALUE');\n                }\n                return value;\n            }\n\n            function validateFloatRange(value, min, max) {\n                value = validateFloat(value);\n                if (value < min || value > max) {\n                    throw new Error('INVALID VALUE');\n                }\n                return value;\n            }\n\n            if (values && values.length === 4) {\n                let south, west, north, east;\n                try {\n                        south = validateFloatRange(values[0], -86, 86);\n                        west = validateFloat(values[1]);\n                        north = validateFloatRange(values[2], -86, 86);\n                        east = validateFloat(values[3]);\n                } catch (e) {\n                    if (e.message === 'INVALID VALUE') {\n                        return false;\n                    }\n                    throw e;\n                }\n                this.removeSelector();\n                this.addSelector([[south, west], [north, east]]);\n                return true;\n            }\n            return false;\n        }\n    }\n);\n","import L from 'leaflet';\nimport ko from 'knockout';\nimport {makeButtonWithBar} from '~/lib/leaflet.control.commons';\nimport layout from './control.html';\nimport '~/lib/controls-styles/controls-styles.css';\nimport './style.css';\nimport {getDeclination} from '~/lib/magnetic-declination';\nimport 'leaflet-rotatedmarker'; // eslint-disable-line import/no-unassigned-import\nimport iconPointer from './pointer.svg';\nimport iconPointerStart from './pointer-start.svg';\nimport iconPointerEnd from './pointer-end.svg';\nimport {ElevationProfile, calcSamplingInterval} from '~/lib/leaflet.control.elevation-profile';\n\nfunction radians(x) {\n    return x / 180 * Math.PI;\n}\n\nfunction degrees(x) {\n    return x / Math.PI * 180;\n}\n\nfunction calcAzimuth(latlng1, latlng2) {\n    const lat1 = radians(latlng1.lat);\n    const lat2 = radians(latlng2.lat);\n    const lng1 = radians(latlng1.lng);\n    const lng2 = radians(latlng2.lng);\n\n    const y = Math.sin(lng2 - lng1) * Math.cos(lat2);\n    const x = Math.cos(lat1) * Math.sin(lat2) -\n        Math.sin(lat1) * Math.cos(lat2) * Math.cos(lng2 - lng1);\n    let brng = Math.atan2(y, x);\n    brng = degrees(brng);\n    return brng;\n}\n\nfunction calcAngle(latlng1, latlng2) {\n    const p1 = L.Projection.SphericalMercator.project(latlng1);\n    const p2 = L.Projection.SphericalMercator.project(latlng2);\n    const delta = p2.subtract(p1);\n    const angle = Math.atan2(delta.x, delta.y);\n    return degrees(angle);\n}\n\nfunction roundAzimuth(a) {\n    return (Math.round(a) + 360) % 360;\n}\n\nL.Control.Azimuth = L.Control.extend({\n        options: {\n            position: 'bottomleft'\n        },\n\n        includes: L.Evented,\n\n        initialize: function(options) {\n            L.Control.prototype.initialize.call(this, options);\n            this.trueAzimuth = ko.observable(null);\n            this.magneticAzimuth = ko.observable(null);\n            this.distance = ko.observable(null);\n            this.points = {\n                start: null,\n                end: null\n            };\n            const iconSingle = L.icon({iconUrl: iconPointer, iconSize: [30, 30]});\n            const iconStart = L.icon({iconUrl: iconPointerStart, iconSize: [30, 30]});\n            const iconEnd = L.icon({iconUrl: iconPointerEnd, iconSize: [30, 45]});\n            this.azimuthLine = L.polyline([], {interactive: false, weight: 1.5});\n            this.markers = {\n                single: L.marker([0, 0], {icon: iconSingle, draggable: true, which: 'start'})\n                    .on('drag', this.onMarkerDrag, this)\n                    .on('click', L.DomEvent.stopPropagation),\n                start: L.marker([0, 0], {\n                    icon: iconStart,\n                    draggable: true,\n                    which: 'start',\n                    rotationOrigin: 'center center',\n                    projectedShift: () => this.azimuthLine.shiftProjectedFitMapView()\n                })\n                    .on('drag', this.onMarkerDrag, this)\n                    .on('click', L.DomEvent.stopPropagation)\n                    .on('dragend', this.onMarkerDragEnd, this),\n                end: L.marker([0, 0], {\n                    icon: iconEnd,\n                    draggable: true,\n                    which: 'end',\n                    rotationOrigin: 'center center',\n                    projectedShift: () => this.azimuthLine.shiftProjectedFitMapView()\n                })\n                    .on('drag', this.onMarkerDrag, this)\n                    .on('click', L.DomEvent.stopPropagation)\n                    .on('dragend', this.onMarkerDragEnd, this)\n            };\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            const {container, link, barContainer} = makeButtonWithBar(\n                'leaflet-control-azimuth', 'Measure bearing, display line of sight', 'icon-azimuth');\n            this._container = container;\n            L.DomEvent.on(link, 'click', this.onClick, this);\n\n            barContainer.innerHTML = layout;\n            ko.applyBindings(this, barContainer);\n            return container;\n        },\n\n        onClick: function() {\n            if (this.isEnabled()) {\n                this.disableControl();\n            } else {\n                this.enableControl();\n            }\n        },\n\n        onMarkerDrag: function(e) {\n            const marker = e.target;\n            this.setPoints({[marker.options.which]: marker.getLatLng()});\n        },\n\n        onMarkerDragEnd: function() {\n            if (this.elevationControl) {\n                this.showProfile();\n            }\n        },\n\n        enableControl: function() {\n            L.DomUtil.addClass(this._container, 'active');\n            L.DomUtil.addClass(this._container, 'highlight');\n            L.DomUtil.addClass(this._map._container, 'azimuth-control-active');\n            this._map.on('click', this.onMapClick, this);\n            this.fire('enabled');\n            this._map.clickLocked = true;\n            this._enabled = true;\n        },\n\n        disableControl: function() {\n            L.DomUtil.removeClass(this._container, 'active');\n            L.DomUtil.removeClass(this._container, 'highlight');\n            this.hideProfile();\n            this.setPoints({start: null, end: null});\n            L.DomUtil.removeClass(this._map._container, 'azimuth-control-active');\n            this._map.off('click', this.onMapClick, this);\n            this._map.clickLocked = false;\n            this._enabled = false;\n        },\n\n        isEnabled: function() {\n            return Boolean(this._enabled);\n        },\n\n        setPoints: function(points) {\n            Object.assign(this.points, points);\n            points = this.points;\n            if (points.start && !points.end) {\n                this.markers.single\n                    .setLatLng(points.start)\n                    .addTo(this._map);\n            } else {\n                this.markers.single.removeFrom(this._map);\n            }\n            if (points.start && points.end) {\n                const angle = calcAngle(points.start, points.end);\n                this.markers.start\n                    .setLatLng(points.start)\n                    .addTo(this._map)\n                    .setRotationAngle(angle);\n                this.markers.end\n                    .setLatLng(points.end)\n                    .addTo(this._map)\n                    .setRotationAngle(angle);\n                this.azimuthLine\n                    .setLatLngs([[points.start, points.end]])\n                    .addTo(this._map);\n            } else {\n                this.markers.start.removeFrom(this._map);\n                this.markers.end.removeFrom(this._map);\n                this.azimuthLine.removeFrom(this._map);\n            }\n            this.updateValuesDisplay();\n        },\n\n        updateValuesDisplay: function() {\n            if (this.points.start && this.points.end) {\n                const points = this.points;\n                const azimuth = calcAzimuth(points.start, points.end);\n                this.trueAzimuth(roundAzimuth(azimuth));\n                const declination = getDeclination(points.start.lat, points.start.lng);\n                if (declination === null) {\n                    this.magneticAzimuth(null);\n                } else {\n                    this.magneticAzimuth(roundAzimuth(azimuth - declination));\n                }\n                this.distance(points.start.distanceTo(points.end));\n            } else {\n                this.distance(null);\n                this.trueAzimuth(null);\n                this.magneticAzimuth(null);\n            }\n        },\n\n        onMapClick: function(e) {\n            if (!this.points.start && !this.points.end) {\n                this.setPoints({start: e.latlng});\n            } else if (this.points.start && !this.points.end) {\n                this.setPoints({end: e.latlng});\n            } else if (this.points.start && this.points.end) {\n                this.hideProfile();\n                this.setPoints({start: e.latlng, end: null});\n            }\n        },\n\n        showProfile: function() {\n            if (!this.points.end) {\n                return;\n            }\n            if (this.elevationControl) {\n                this.elevationControl.removeFrom(this._map);\n            }\n\n            const dist = this.points.start.distanceTo(this.points.end);\n            this.elevationControl = new ElevationProfile(this._map, [this.points.start, this.points.end], {\n                samplingInterval: calcSamplingInterval(dist),\n                sightLine: true\n            });\n            this.elevationControl.on('remove', () => {\n                this.elevationControl = null;\n            });\n            this.fire('elevation-shown');\n        },\n\n        hideProfile: function() {\n            if (this.elevationControl) {\n                this.elevationControl.removeFrom(this._map);\n            }\n            this.elevationControl = null;\n        },\n\n        onProfileButtonClick: function() {\n            this.showProfile();\n        },\n\n        onReverseButtonClick: function() {\n            if (this.points.end && this.points.start) {\n                this.setPoints({start: this.points.end, end: this.points.start});\n                if (this.elevationControl) {\n                    this.showProfile();\n                }\n            }\n        }\n\n    }\n);\n\n","export default \"<div class=\\\"contents\\\">\\n    <table>\\n        <tr>\\n            <td>True azimuth</td>\\n            <td data-bind=\\\"text: trueAzimuth() !== null ? Math.round(trueAzimuth()) + '&deg;' : '--'\\\"></td>\\n        </tr>\\n        <tr>\\n            <td>Magnetic azimuth</td>\\n            <td data-bind=\\\"text: magneticAzimuth() !== null ? magneticAzimuth() + '&deg;' : '--'\\\"></td>\\n        </tr>\\n        <tr>\\n            <td>Distance</td>\\n            <td data-bind=\\\"text: distance() === null ? '--' :\\n                distance() > 2000 ? (distance() / 1000).toFixed(2) + ' km' : Math.round(distance()) + ' m'\\\"></td>\\n        </tr>\\n    </table>\\n\\n    <div class=\\\"buttons\\\">\\n        <div class=\\\"button\\\" data-bind=\\\"click: onReverseButtonClick\\\">Reverse</div>\\n        <div class=\\\"button\\\" data-bind=\\\"click: onProfileButtonClick\\\">Elevation / Sightline</div>\\n    </div>\\n</div>\";","// extracted by mini-css-extract-plugin\nexport {};","export default \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMzAgMzAiPgogICAgPGc+CiAgICAgICAgPGVsbGlwc2Ugcnk9IjE1IiByeD0iMTUiIGN5PSIxNSIgY3g9IjE1IiBmaWxsPSIjNzc3IiBmaWxsLW9wYWNpdHk9IjAuNSIvPgogICAgICAgIDxlbGxpcHNlIHJ5PSIzIiByeD0iMyIgY3k9IjE1IiBjeD0iMTUiIGZpbGw9IiMzMzg4ZmYiIC8+CiAgICA8L2c+Cjwvc3ZnPg==\"","export default \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMzAgNDUiPgogICAgPGc+CiAgICAgICAgPGVsbGlwc2Ugcnk9IjE1IiByeD0iMTUiIGN5PSIyNiIgY3g9IjE1IiBmaWxsPSIjNzc3IiBmaWxsLW9wYWNpdHk9IjAuNSIvPgogICAgICAgIDxwYXRoIGQ9Ik0xNSwyMCBsLTUsMTIgbDEwLDAgeiIgZmlsbD0iIzMzODhmZiIvPgogICAgPC9nPgo8L3N2Zz4=\"","import L from 'leaflet';\nimport {makeButton} from '~/lib/leaflet.control.commons';\nimport './style.css';\nimport localStorage from '~/lib/safe-localstorage';\n\nconst STATE_DISABLED = 'disabled';\nconst STATE_LOCATING = 'locating';\nconst STATE_ENABLED = 'enabled';\nconst STATE_ENABLED_FOLLOWING = 'enabled_following';\nconst STATE_MOVING_TO_FOLLOWING = 'moving_to_following';\nconst STATE_MOVING_TO_FOLLOWING_FIRST = 'moving_to_following_first';\nconst STATE_UPDATING_FOLLOWING = 'updating_following';\n\nconst EVENT_INIT = 'init';\nconst EVENT_BUTTON_CLICK = 'button_click';\nconst EVENT_LOCATION_RECEIVED = 'location_received';\nconst EVENT_LOCATION_ERROR = 'location_error';\nconst EVENT_MAP_MOVE = 'user_move';\nconst EVENT_MAP_MOVE_END = 'map_move_end';\n\nconst LOCALSTORAGE_POSITION = 'leaflet_locate_position';\n\nconst PositionMarker = L.LayerGroup.extend({\n    initialize: function(options) {\n        L.LayerGroup.prototype.initialize.call(this, options);\n        this._locationSet = false;\n        this._elements = {\n            accuracyCircle: L.circle([0, 0], {\n                radius: 1,\n                interactive: false,\n                fillColor: '#4271a8',\n                color: '#2ba3f7',\n                weight: 2\n            }),\n            markerCircle: L.circleMarker([0, 0], {\n                interactive: false,\n                radius: 10,\n                color: '#2ba3f7',\n                weight: 2.5,\n                fill: null,\n                opacity: 0.8\n            }),\n            markerPoint: L.circleMarker([0, 0], {\n                interactive: false,\n                radius: 2,\n                weight: 0,\n                color: '#2ba3f7',\n                fillOpacity: 0.8\n            }),\n        };\n        this.addLayer(this._elements.accuracyCircle);\n    },\n\n    onAdd: function(map) {\n        L.LayerGroup.prototype.onAdd.call(this, map);\n        map.on('zoom', this._onZoom, this);\n        this._updatePrecisionState();\n    },\n\n    onRemove: function(map) {\n        map.off('zoom', this._onZoom, this);\n        L.LayerGroup.prototype.onRemove.call(this, map);\n    },\n\n    _updatePrecisionState: function() {\n        if (!this._map || !this._locationSet) {\n            return;\n        }\n        const precise = this._elements.accuracyCircle._radius <= this._elements.markerCircle.options.radius * 0.8;\n        if (precise !== this._precise) {\n            if (precise) {\n                this._elements.accuracyCircle.setStyle({opacity: 0, fillOpacity: 0});\n                this.addLayer(this._elements.markerPoint);\n                this.addLayer(this._elements.markerCircle);\n            } else {\n                this._elements.accuracyCircle.setStyle({opacity: 0.8, fillOpacity: 0.4});\n                this.removeLayer(this._elements.markerPoint);\n                this.removeLayer(this._elements.markerCircle);\n            }\n            this._precise = precise;\n        }\n    },\n\n    setLocation: function(latlng, accuracy) {\n        this._elements.accuracyCircle.setLatLng(latlng);\n        this._elements.accuracyCircle.setRadius(accuracy);\n        this._elements.markerCircle.setLatLng(latlng);\n        this._elements.markerPoint.setLatLng(latlng);\n        this._locationSet = true;\n        this._updatePrecisionState();\n    },\n\n    _onZoom: function() {\n        this._updatePrecisionState();\n    }\n\n});\n\nconst LocateControl = L.Control.extend({\n        // button click behavior:\n        // if button turned off -- turn on, maps follows marker\n        // if button turned on\n        //     if map is following marker -- turn off\n        //     if map not following marker -- center map at marker, start following\n\n        options: {\n            locationAcquireTimeoutMS: Infinity,\n            showError: ({message}) => {\n                alert(message);\n            },\n            maxAutoZoom: 17,\n            minAutoZoomDeltaForAuto: 4,\n            minDistForAutoZoom: 2 // in average screen sizes\n        },\n\n        initialize: function(options) {\n            L.Control.prototype.initialize.call(this, options);\n            this._events = [];\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            const {container, link} = makeButton('leaflet-control-locate', 'Где я сейчас?', 'icon-position');\n            this._container = container;\n            L.DomEvent.on(link, 'click', () => this._handleEvent(EVENT_BUTTON_CLICK));\n            this._marker = new PositionMarker();\n            this._handleEvent(EVENT_INIT);\n            return container;\n        },\n\n        moveMapToCurrentLocation: function(zoom, fallbackLatLng, forceLatLng, forceZoom) {\n            let storedPosition;\n            try {\n                storedPosition = JSON.parse(localStorage.getItem(LOCALSTORAGE_POSITION));\n                let {lat, lon} = storedPosition;\n                if (lat && lon) {\n                    storedPosition = L.latLng(lat, lon);\n                } else {\n                    storedPosition = null;\n                }\n            } catch (e) {\n                // ignore invalid data from localstorage\n            }\n\n            if (storedPosition) {\n                this._map.setView(forceLatLng ? forceLatLng : storedPosition, forceZoom ? forceZoom : zoom, {\n                    animate: false,\n                });\n                if (!('geolocation' in navigator)) {\n                    return;\n                }\n                navigator.geolocation.getCurrentPosition(\n                    (pos) => {\n                        this._storePositionToLocalStorage(pos);\n                        if (!forceLatLng) {\n                            // TODO: check if map has not moved\n                            this._map.setView(L.latLng(pos.coords.latitude, pos.coords.longitude), zoom, {\n                                animate: false,\n                            });\n                        }\n                    },\n                    (e) => {\n                        if (e.code === 1) {\n                            localStorage.removeItem(LOCALSTORAGE_POSITION);\n                        }\n                    }, {\n                    enableHighAccuracy: false,\n                    timeout: 500,\n                    maximumAge: 0\n                });\n            } else {\n                this._map.setView(forceLatLng ? forceLatLng : fallbackLatLng, forceZoom ? forceZoom : zoom,\n                    {animate: false});\n            }\n        },\n\n        _startLocating: function() {\n            if (!('geolocation' in navigator) || !('watchPosition' in navigator.geolocation)) {\n                const error = {code: 0, message: 'Geolocation not supported'};\n                setTimeout(() => {\n                        this._onLocationError(error);\n                    }, 0\n                );\n            }\n            this._watchID = navigator.geolocation.watchPosition(\n                this._onLocationSuccess.bind(this), this._onLocationError.bind(this),\n                {\n                    enableHighAccuracy: true,\n                    timeout: this.options.locationAcquireTimeoutMS,\n                }\n            );\n        },\n\n        _storePositionToLocalStorage: function(pos) {\n            const coords = {lat: pos.coords.latitude, lon: pos.coords.longitude};\n            localStorage.setItem(LOCALSTORAGE_POSITION, JSON.stringify(coords));\n        },\n\n        _onLocationSuccess: function(pos) {\n            this._handleEvent(EVENT_LOCATION_RECEIVED, pos);\n            this._storePositionToLocalStorage(pos);\n        },\n\n        _onLocationError: function(e) {\n            this._handleEvent(EVENT_LOCATION_ERROR, e);\n            if (e.code === 1) {\n                localStorage.removeItem(LOCALSTORAGE_POSITION);\n            }\n        },\n\n        _stopLocating: function() {\n            if (this._watchID && navigator.geolocation) {\n                navigator.geolocation.clearWatch(this._watchID);\n            }\n        },\n\n        _storeLocation: function(position) {\n            this._latlng = L.latLng(position.coords.latitude, position.coords.longitude);\n            this._accuracy = position.coords.accuracy;\n        },\n\n        _updateMarkerLocation: function() {\n            this._marker.setLocation(this._latlng, this._accuracy);\n        },\n\n        _updateMapPositionWhileFollowing: function() {\n            this._updateFollowingStartPosition = this._map.getCenter();\n            this._updateFollowingDestPosition = this._latlng;\n            this._map.panTo(this._latlng);\n        },\n\n        _setViewToLocation: function(preferAutoZoom) {\n            if (!this._map || !this._latlng) {\n                return;\n            }\n\n            // autoZoom -- to fit accuracy cirlce on screen, but not more then options.maxAutoZoom (17)\n            // if current zoom more then options.minAutoZoomDeltaForAuto less then autoZoom, set autoZoom\n            // if map center far from geolocation, set autoZoom\n            // if map center not far from geolocation\n            //      if accuracy circle does not fit at current zoom, zoom out to fit\n            //      if  current zoom is less then minAutoZoomDeltaForAuto less then autoZoom\n            //          or >= autoZoom and circle fits screen, keep current zoom\n\n            const currentZoom = this._map.getZoom();\n            let zoomFitAccuracy = this._map.getBoundsZoom(this._latlng.toBounds(this._accuracy * 2));\n            let autoZoom = zoomFitAccuracy;\n            let newZoom;\n            autoZoom = Math.min(autoZoom, this.options.maxAutoZoom);\n\n            if (preferAutoZoom || autoZoom - currentZoom >= this.options.minAutoZoomDeltaForAuto) {\n                newZoom = autoZoom;\n            } else {\n                const p1 = this._map.project(this._map.getCenter());\n                const p2 = this._map.project(this._latlng);\n                const screenSize = this._map.getSize();\n                const averageScreenSize = (screenSize.x + screenSize.y) / 2;\n                if (p1.distanceTo(p2) > averageScreenSize * this.options.minDistForAutoZoom) {\n                    newZoom = autoZoom;\n                } else {\n                    newZoom = currentZoom > zoomFitAccuracy ? zoomFitAccuracy : currentZoom;\n                }\n            }\n            this._map.setView(this._latlng, newZoom);\n        },\n\n        _onMapMove: function() {\n            this._handleEvent(EVENT_MAP_MOVE);\n        },\n\n        _onMapMoveEnd: function() {\n            const ll = this._map.getCenter();\n            setTimeout(() => {\n                    if (this._map.getCenter().equals(ll)) {\n                        this._handleEvent(EVENT_MAP_MOVE_END);\n                    }\n                }, 100\n            );\n        },\n\n        _isMapOffsetFromFollowingSegment: function() {\n            if (this._updateFollowingStartPosition) {\n                const p = this._map.project(this._map.getCenter());\n                const p1 = this._map.project(this._updateFollowingStartPosition);\n                const p2 = this._map.project(this._updateFollowingDestPosition);\n                return L.LineUtil.pointToSegmentDistance(p, p1, p2) > 5;\n            }\n            return true;\n        },\n\n        _isMapCenteredAtLocation: function() {\n            if (!this._latlng || !this._map) {\n                return false;\n            }\n            let p1 = this._map.project(this._latlng);\n            let p2 = this._map.project(this._map.getCenter());\n            return p1.distanceTo(p2) < 5;\n        },\n\n        _updateButtonClasses: function(add, remove) {\n            for (let cls of add) {\n                L.DomUtil.addClass(this._container, cls);\n            }\n            for (let cls of remove) {\n                L.DomUtil.removeClass(this._container, cls);\n            }\n        },\n\n        _setEvents: function(on) {\n            const f = on ? 'on' : 'off';\n            this._map[f]('move', this._onMapMove, this);\n            this._map[f]('moveend', this._onMapMoveEnd, this);\n        },\n\n        _handleEvent: function(event, data) {\n            this._events.push({event, data});\n            if (!this._processingEvent) {\n                this._processingEvent = true;\n                while (this._events.length) {\n                    this._processEvent(this._events.shift());\n                }\n                this._processingEvent = false;\n            }\n        },\n\n        _processEvent: function({event, data}) { // eslint-disable-line complexity\n            // console.log('PROCESS EVENT', event);\n            const state = this._state;\n            switch (event) {\n                case EVENT_INIT:\n                    this._setState(STATE_DISABLED);\n                    break;\n                case EVENT_BUTTON_CLICK:\n                    if (state === STATE_DISABLED) {\n                        this._setState(STATE_LOCATING);\n                    } else if (state === STATE_ENABLED) {\n                        this._setState(STATE_MOVING_TO_FOLLOWING);\n                        this._setViewToLocation();\n                    } else {\n                        this._setState(STATE_DISABLED);\n                    }\n                    break;\n                case EVENT_LOCATION_RECEIVED:\n                    if (state === STATE_DISABLED) {\n                        return;\n                    }\n                    this._storeLocation(data);\n                    this._updateMarkerLocation();\n                    if (state === STATE_LOCATING || state === STATE_MOVING_TO_FOLLOWING_FIRST) {\n                        this._setViewToLocation(true);\n                        this._setState(STATE_MOVING_TO_FOLLOWING_FIRST);\n                    } else if (state === STATE_MOVING_TO_FOLLOWING) {\n                        this._setViewToLocation();\n                    } else if (this._state === STATE_ENABLED_FOLLOWING || state === STATE_UPDATING_FOLLOWING) {\n                        this._updateMapPositionWhileFollowing();\n                        this._setState(STATE_UPDATING_FOLLOWING);\n                    }\n                    break;\n                case EVENT_LOCATION_ERROR:\n                    if (state === STATE_DISABLED) {\n                        return;\n                    }\n                    this.options.showError(data);\n                    this._setState(STATE_DISABLED);\n                    break;\n                case EVENT_MAP_MOVE:\n                    if (state === STATE_ENABLED_FOLLOWING) {\n                        if (!this._isMapCenteredAtLocation() && this._isMapOffsetFromFollowingSegment()) {\n                            this._setState(STATE_ENABLED);\n                        }\n                    }\n                    break;\n                case EVENT_MAP_MOVE_END:\n                    if (state === STATE_MOVING_TO_FOLLOWING) {\n                        if (this._isMapCenteredAtLocation()) {\n                            this._setState(STATE_ENABLED_FOLLOWING);\n                        } else {\n                            this._setState(STATE_ENABLED);\n                        }\n                    } else if (state === STATE_UPDATING_FOLLOWING || state === STATE_MOVING_TO_FOLLOWING_FIRST) {\n                        if (this._isMapCenteredAtLocation() || !this._isMapOffsetFromFollowingSegment()) {\n                            this._setState(STATE_ENABLED_FOLLOWING);\n                        } else {\n                            this._setState(STATE_ENABLED);\n                        }\n                    }\n                    break;\n                default:\n            }\n        },\n\n        _setState: function(newState) {\n            const oldState = this._state;\n            if (oldState === newState) {\n                return;\n            }\n            // console.log(`STATE: ${oldState} -> ${newState}`);\n            switch (newState) {\n                case STATE_LOCATING:\n                    this._startLocating();\n                    this._updateButtonClasses(['requesting'], ['active', 'following']);\n                    this._setEvents(true);\n                    break;\n                case STATE_DISABLED:\n                    this._stopLocating();\n                    this._marker.removeFrom(this._map);\n                    this._setEvents(false);\n                    this._updateButtonClasses([], ['active', 'highlight', 'following', 'requesting']);\n                    break;\n                case STATE_ENABLED:\n                    this._updateButtonClasses(['active', 'highlight'], ['following', 'requesting']);\n                    break;\n                case STATE_MOVING_TO_FOLLOWING_FIRST:\n                    this._marker.addTo(this._map);\n                    break;\n                case STATE_ENABLED_FOLLOWING:\n                    this._updateButtonClasses(['active', 'highlight', 'following'], ['requesting']);\n                    break;\n                default:\n            }\n            this._state = newState;\n        },\n    }\n);\n\nexport {LocateControl};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport './style.css';\n\nconst ZoomWithDisplay = L.Control.Zoom.extend({\n    onAdd: function(map) {\n        const container = L.Control.Zoom.prototype.onAdd.call(this, map);\n        this._display = L.DomUtil.create('div', 'leaflet-control-zoom-display');\n        container.insertBefore(this._display, this._zoomOutButton);\n        map.on('zoomend', this._updateDisplay, this);\n        this._updateDisplay();\n        return container;\n    },\n\n    onRemove: function(map) {\n        L.Control.Zoom.prototype.onRemove.call(this, map);\n        map.off('zoomend', this._updateDisplay, this);\n    },\n\n    _updateDisplay: function() {\n        this._display.innerHTML = this._map.getZoom();\n    }\n\n});\n\nexport default ZoomWithDisplay;\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport './style.css';\nimport config from '~/config';\nimport '~/lib/leaflet.control.commons';\nimport {fetch} from '~/lib/xhr-promise';\nimport {notify} from '~/lib/notifications';\nimport iconPointer from '../leaflet.control.azimuth/pointer.svg';\nimport waterImage from './images/humidity.svg';\n\nL.Control.Weather = L.Control.extend({\n    options: {\n        position: 'topleft',\n    },\n\n    onAdd: function (map) {\n        this.places = null; // места\n        this.data = null; // данные по погоде\n        this.periods = null; // соответствие timestamp дате\n\n        this.icon_map = {\n            '01d' : 'skc_d',\n            '02d' : 'bkn_d',\n            '03d' : 'ovc',\n            '04d' : 'ovc',\n            '09d' : 'ovc_ra',\n            '10d' : 'bkn_ra_d',\n            '11d' : 'ovc_+ra',\n            '13d' : 'bkn_+sn_d',\n            '50d' : 'ovc',\n            '01n' : 'skc_n',\n            '02n' : 'bkn_n',\n            '03n' : 'ovc',\n            '04n' : 'ovc',\n            '09n' : 'ovc_ra',\n            '10n' : 'bkn_ra_n',\n            '11n' : 'ovc_+ra',\n            '13n' : 'bkn_+sn_n',\n            '50n' : 'ovc',\n        }\n\n\n        this.layerGroup = L.layerGroup();\n        this.layerGroup.addTo( map );\n\n        this._map = map;\n\n        this.container = L.DomUtil.create('div', 'leaflet-control button-with-bar leaflet-control-weather');\n        let link_container = L.DomUtil.create('div', 'leaflet-bar leaflet-control-single-button', this.container);\n        this.link = L.DomUtil.create('a', 'leaflet-control-weather-button leaflet-bar-part ', link_container);\n        this.link.href = '#';\n        L.DomEvent.on(this.link, 'click', this.load, this);\n\n        return this.container;\n    },\n    load: function(map) {\n        if ( map._simulated ) {\n            return this.stopPropagation(map);\n        }\n        if ( L.DomUtil.hasClass( this.link, 'leaflet-control-weather-loading' ) ) {\n            return this.stopPropagation(map);\n        }\n\n        if ( L.DomUtil.hasClass( this.container, 'active' ) ) {\n            this.unload();\n            return this.stopPropagation(map);\n        }\n        L.DomUtil.addClass( this.link, 'leaflet-control-weather-loading' );\n        const url = config.weatherServer;\n        let self = this;\n        if ( self.places ) {\n            setTimeout( function() {\n                self.showControl(map);\n            }, 100 );\n        } else {\n            fetch(url, {method: 'POST', withCredentials: false}).then(function(response) {\n                if ( response.status !== 200 ) {\n                    notify( 'Данные о погоде временно не доступны' );\n                    return false;\n                }\n                let res = JSON.parse( response.responseJSON );\n                self.places = res.objects;\n                self.data = res.data;\n                self.periods = res.periods;\n\n                //console.log(self.places, self.data, self.periods);\n                self.showControl(map);\n            });\n        }\n\n        return this.stopPropagation(map);\n    },\n    stopPropagation: function(map) {\n        map.preventDefault();\n        map.stopPropagation();\n        return false;\n    },\n    renderMarkerIcon: function( place, current_weather ) {\n        let temp = Math.round( current_weather.t );\n        let rain = '';\n        if ( temp > 0 ) {\n            temp = '+' + temp;\n        }\n        if ( typeof current_weather.r !== 'undefined' ) {\n            rain = ' <img class=\"icon water-icon\" src=\"'+waterImage+'\"> ' + current_weather.r + ' мм.';\n        }\n        let html = '<div class=\"balloon\">\\n' +\n            '<a tabindex=\"0\" href=\"#\">\\n' +\n            '<img class=\"icon\" src=\"https://yastatic.net/weather/i/icons/blueye/color/svg/'+self.icon_map[current_weather.i]+'.svg\">' +\n            '<span class=\"balloon__temp\">'+temp+'°'+rain+'</span>' +\n            '<span class=\"balloon__name\">'+place.name+'</span>' +\n            '</a>\\n' +\n            '</div>\\n';\n\n        return html;\n    },\n    renderPlaces: function( period_index = 0 ) {\n        self = this;\n        const iconSingle = L.icon({iconUrl: iconPointer, iconSize: [30, 30]});\n        for ( let place in self.places ) {\n            let current_period = Object.keys(self.data)[period_index];\n            let current_weather = self.data[current_period][place];\n            if ( typeof current_weather === 'undefined' ) {\n                continue;\n            }\n            let icon = L.divIcon({\n                className: \"marker-default\",\n                html: self.renderMarkerIcon( self.places[place], current_weather )\n            });\n            let marker = L.marker([self.places[place].lat, self.places[place].lng], {icon: icon});\n            self.layerGroup.addLayer( marker );\n        }\n        document.querySelectorAll(\".balloon\").forEach(function(baloon ) {\n            baloon.addEventListener(\"mouseenter\", function(e) {\n                baloon.querySelector(\".balloon__name\").style.display = 'inline-block';\n                //baloon.querySelector(\".baloon-content\").style.display = 'block';\n                let marker = baloon.closest('.marker-default');\n                marker.dataset.zindex = marker.style['z-index'];\n                marker.style['z-index'] = 99999;\n                marker.style['min-width'] = '150px';\n            });\n            baloon.addEventListener(\"mouseleave\", function(e) {\n                baloon.querySelector(\".balloon__name\").style.display = 'none';\n                //baloon.querySelector(\".baloon-content\").style.display = 'none';\n                let marker = baloon.closest('.marker-default');\n                marker.style['z-index'] = marker.dataset.zindex;\n                marker.style['min-width'] = 'inherit';\n            });\n            baloon.addEventListener(\"click\", function(e) {\n                e.stopPropagation();\n                e.preventDefault();\n            });\n        });\n\n    },\n    showControl: function(map) {\n        L.DomUtil.removeClass( this.link, 'leaflet-control-weather-loading' );\n\n        L.DomUtil.addClass(this.container, 'active');\n        this._map.fire( 'weather_rendered' );\n\n        this.renderPlaces();\n\n        this.controlContainer = L.DomUtil.create('div', 'leaflet-bar bar leaflet-control-weather-bar', this.container);\n\n        this.positionSliderLabel = L.DomUtil.create('label', 'leaflet-control-weather-label leaflet-bar-part', this.controlContainer);\n        this.positionSliderLabel.for = \"rainviewer-positionslider\";\n        this.positionSliderLabel.textContent = '';\n\n        this.positionSlider = L.DomUtil.create('input', 'leaflet-control-weather-positionslider leaflet-bar-part', this.controlContainer);\n        this.positionSlider.type = \"range\";\n        this.positionSlider.id = \"rainviewer-positionslider\";\n        this.positionSlider.min = 0;\n        this.positionSlider.max = Object.keys(this.data).length-1;\n        this.positionSlider.value = 0;\n        L.DomEvent.on(this.positionSlider, 'input', function(e) {\n            this.setCurrentPeriod( e.target.value );\n        }, this);\n        this.setCurrentPeriod( 0 );\n        L.DomEvent.disableClickPropagation(this.positionSlider);\n\n        this.closeButton = L.DomUtil.create('div', 'leaflet-control-weather-close', this.container);\n        L.DomEvent.on(this.closeButton, 'click', this.unload, this);\n    },\n    unload: function(e) {\n        L.DomUtil.remove(this.controlContainer);\n        L.DomUtil.remove(this.closeButton);\n        L.DomUtil.removeClass(this.container, 'active');\n        this.layerGroup.clearLayers();\n    },\n    setCurrentPeriod( period_index = 0 ) {\n        this.layerGroup.clearLayers();\n        let current_period = Object.keys(this.data)[period_index];\n        this.renderPlaces(period_index);\n        this.positionSliderLabel.textContent = this.periods[current_period];\n    },\n    onRemove: function (map) {\n        // Nothing to do here\n    }\n});","// extracted by mini-css-extract-plugin\nexport {};","export default \"data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjUxMnB0IiB2aWV3Qm94PSItOCAwIDUxMiA1MTIiIHdpZHRoPSI1MTJwdCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJtMzU2Ljk0NTMxMiAzMjkuNzc3MzQ0YzAgOTYuNDk2MDk0LTc4LjIyNjU2MiAxNzQuNzE4NzUtMTc0LjcyMjY1NiAxNzQuNzE4NzVzLTE3NC43MTg3NS03OC4yMjI2NTYtMTc0LjcxODc1LTE3NC43MTg3NSAxNzQuNzE4NzUtMzE3LjY3NTc4MiAxNzQuNzE4NzUtMzE3LjY3NTc4MiAxNzQuNzIyNjU2IDIyMS4xNzk2ODggMTc0LjcyMjY1NiAzMTcuNjc1Nzgyem0wIDAiIGZpbGw9IiM5NmQxZjMiLz48cGF0aCBkPSJtMzcyLjcxODc1IDEyLjEwNTQ2OXMtNTguNjE3MTg4IDc0LjIxMDkzNy05Mi4xODM1OTQgMTM5LjgwODU5M2MzOS43NDIxODggNjMuMjg5MDYzIDc2LjQxMDE1NiAxMzMuNjYwMTU3IDc2LjQxMDE1NiAxNzcuODYzMjgyIDAgMS44NjMyODEtLjAzOTA2MiAzLjcxNDg0NC0uMDk3NjU2IDUuNTYyNSA1LjE4NzUuNzE0ODQ0IDEwLjQ4NDM3NSAxLjA5Mzc1IDE1Ljg3MTA5NCAxLjA5Mzc1IDYzLjU1ODU5NCAwIDExNS4wODU5MzgtNTEuNTI3MzQ0IDExNS4wODU5MzgtMTE1LjA4NTkzOHMtMTE1LjA4NTkzOC0yMDkuMjQyMTg3LTExNS4wODU5MzgtMjA5LjI0MjE4N3ptMCAwIiBmaWxsPSIjOTZkMWYzIi8+PHBhdGggZD0ibTM3LjUxNTYyNSAzMjkuNzc3MzQ0YzAtNzkuMDg5ODQ0IDExNy4zNjcxODctMjQxLjkzNzUgMTU5LjcxMDkzNy0yOTguMTEzMjgyLTkuMzE2NDA2LTEyLjM1OTM3NC0xNS4wMDM5MDYtMTkuNTYyNS0xNS4wMDM5MDYtMTkuNTYyNXMtMTc0LjcxODc1IDIyMS4xNzk2ODgtMTc0LjcxODc1IDMxNy42NzU3ODIgNzguMjIyNjU2IDE3NC43MTg3NSAxNzQuNzE4NzUgMTc0LjcxODc1YzUuMDU0Njg4IDAgMTAuMDU4NTk0LS4yMjY1NjMgMTUuMDAzOTA2LS42NDg0MzgtODkuNDY4NzUtNy42MDkzNzUtMTU5LjcxMDkzNy04Mi42Mjg5MDYtMTU5LjcxMDkzNy0xNzQuMDcwMzEyem0wIDAiIGZpbGw9IiMzY2E2ZTYiLz48cGF0aCBkPSJtMzg2Ljg1OTM3NSAzMzUuMzM1OTM4Yy4wNTg1OTQtMS44NDc2NTcuMDk3NjU2LTMuNjk1MzEzLjA5NzY1Ni01LjU1ODU5NCAwLTQ0LjIwMzEyNS0zNi42NzE4NzUtMTE0LjU3NDIxOS03Ni40MTAxNTYtMTc3Ljg2MzI4MiAyMi45Mjk2ODctNDQuODA4NTkzIDU3LjUzOTA2My05My42Mjg5MDYgNzcuMTc5Njg3LTEyMC4wNzgxMjQtOS4xMDkzNzQtMTIuMjY1NjI2LTE1LjAwNzgxMi0xOS43MzQzNzYtMTUuMDA3ODEyLTE5LjczNDM3NnMtNTguNjE3MTg4IDc0LjIxNDg0NC05Mi4xNzk2ODggMTM5LjgxMjVjMzkuNzM4MjgyIDYzLjI4OTA2MyA3Ni40MDYyNSAxMzMuNjU2MjUgNzYuNDA2MjUgMTc3Ljg2MzI4MiAwIDEuODU5Mzc1LS4wMzkwNjIgMy43MTA5MzctLjA5NzY1NiA1LjU1ODU5NCA1LjE5MTQwNi43MTg3NSAxMC40ODgyODIgMS4wOTc2NTYgMTUuODcxMDk0IDEuMDk3NjU2IDUuMTA5Mzc1IDAgMTAuMTM2NzE5LS4zMzk4NDQgMTUuMDcwMzEyLS45ODQzNzUtLjMxMjUtLjAzOTA2My0uNjI1LS4wNzAzMTMtLjkyOTY4Ny0uMTEzMjgxem0wIDAiIGZpbGw9IiMzY2E2ZTYiLz48cGF0aCBkPSJtMjA2LjE5OTIxOSA0NjMuMTQ0NTMxaC0xNS4wMDM5MDd2LTE1LjAwMzkwNmgxNS4wMDM5MDd6bS0yNS4wMDc4MTMgMGgtMTUuMDAzOTA2di0xNS4wMDM5MDZoMTUuMDAzOTA2em0wIDAiIGZpbGw9IiNmZmYiLz48cGF0aCBkPSJtMTgyLjIyMjY1NiAwYy01My4xNDQ1MzEgNjcuMjc3MzQ0LTE4Mi4yMjI2NTYgMjQ0LjE5MTQwNi0xODIuMjIyNjU2IDMyOS43NzczNDQgMCAxMDAuNDc2NTYyIDgxLjc0NjA5NCAxODIuMjIyNjU2IDE4Mi4yMjI2NTYgMTgyLjIyMjY1NiAxMDAuNDgwNDY5IDAgMTgyLjIyMjY1Ni04MS43NDYwOTQgMTgyLjIyMjY1Ni0xODIuMjIyNjU2IDAtODUuNTg1OTM4LTEyOS4wNzgxMjQtMjYyLjUwMzkwNi0xODIuMjIyNjU2LTMyOS43NzczNDR6bTAgNDk2Ljk5NjA5NGMtOTIuMjAzMTI1IDAtMTY3LjIxODc1LTc1LjAxNTYyNS0xNjcuMjE4NzUtMTY3LjIxODc1IDAtODIuOTMzNTk0IDEzNi44OTA2MjUtMjY1LjkxMDE1NiAxNjcuMjE4NzUtMzA1LjQyNTc4MiAzMC4zMjgxMjUgMzkuNTExNzE5IDE2Ny4yMTg3NSAyMjIuNDcyNjU3IDE2Ny4yMTg3NSAzMDUuNDI1NzgyIDAgOTIuMjAzMTI1LTc1LjAxNTYyNSAxNjcuMjE4NzUtMTY3LjIxODc1IDE2Ny4yMTg3NXptMCAwIi8+PHBhdGggZD0ibTMzNC40Mzc1IDMyOS43NzczNDRjMC0yNC40MzM1OTQtMTQuNDg4MjgxLTc1LjkxNDA2My04My40OTIxODgtMTgyLjM5ODQzOGwtMTIuNTkzNzUgOC4xNjAxNTZjNzMuMTc5Njg4IDExMi45MjE4NzYgODEuMDc4MTI2IDE1OS40Njg3NSA4MS4wNzgxMjYgMTc0LjIzODI4MnptMCAwIi8+PHBhdGggZD0ibTQ2NS4yOTY4NzUgMjIxLjM0NzY1NmMwLTkuOTE0MDYyLTUuMjM0Mzc1LTQxLjA1NDY4Ny01My42Nzk2ODctMTE1LjgzNTkzN2wtMTIuNTkzNzUgOC4xNjAxNTZjNDguNzkyOTY4IDc1LjMxNjQwNiA1MS4yNjU2MjQgMTAyLjkxMDE1NiA1MS4yNjU2MjQgMTA3LjY3NTc4MXptMCAwIi8+PHBhdGggZD0ibTM3OC42MDU0NjkgNy40NTMxMjUtNS44ODY3MTktNy40NTMxMjVjLTM0LjgzOTg0NCA0NC4xMDkzNzUtNjQuNDE3OTY5IDg4LjAzMTI1LTgzLjUyNzM0NCAxMjAuNjUyMzQ0bDEyLjk0NTMxMyA3LjU4NTkzN2MyNS42NTYyNS00My43OTY4NzUgNTcuNjA1NDY5LTg2LjgzNTkzNyA3MC41ODIwMzEtMTAzLjg1NTQ2OSAzMC40MzM1OTQgMzkuODkwNjI2IDEwNy41ODIwMzEgMTQ3LjM1OTM3NiAxMDcuNTgyMDMxIDE5Ni45NjQ4NDQgMCA1NS40ODQzNzUtNDEuNTcwMzEyIDEwMS41LTk2LjY5NTMxMiAxMDcuMDM1MTU2bDEuNSAxNC45MzM1OTRjNjIuMTY0MDYyLTYuMjQ2MDk0IDExMC4xOTkyMTktNTguNzIyNjU2IDExMC4xOTkyMTktMTIxLjk2ODc1IDAtNjUuNDE0MDYyLTExMS45MzM1OTQtMjA3Ljg2MzI4MS0xMTYuNjk5MjE5LTIxMy44OTQ1MzF6bTAgMCIvPjwvc3ZnPg==\"","import ko from 'knockout';\nimport L from 'leaflet';\n\nimport '~/lib/leaflet.placemark'; // eslint-disable-line import/no-unassigned-import\nimport {stopContainerEvents} from '~/lib/leaflet.control.commons';\nimport '~/lib/leaflet.hashState/leaflet.hashState'; // eslint-disable-line import/no-unassigned-import\n\nimport controlTemplate from './control.html';\nimport {providers, magicProviders} from './providers';\nimport './style.css';\n\nko.bindingHandlers.hasFocusNested = {\n    init: function (element, valueAccessor) {\n        function hasFocusNested() {\n            let active = document.activeElement;\n            while (active) {\n                if (element === active) {\n                    return true;\n                }\n                active = active.parentElement;\n            }\n            return false;\n        }\n\n        function handleFocusChange() {\n            // wait for all related focus/blur events to fire\n            setTimeout(() => {\n                valueAccessor()(hasFocusNested());\n            }, 0);\n        }\n        element.addEventListener('focus', handleFocusChange, true);\n        element.addEventListener('blur', handleFocusChange, true);\n    },\n};\n\nclass SearchViewModel {\n    query = ko.observable('');\n    inputPlaceholder = ko.observable(null);\n    helpText = ko.observable(null);\n    items = ko.observableArray([]);\n    error = ko.observable(null);\n    inputHasFocus = ko.observable(false);\n    controlOrChildHasFocus = ko.observable(false);\n    highlightedIndex = ko.observable(null);\n    attribution = ko.observable(null);\n\n    allowMinimize = ko.observable(true);\n\n    /* eslint-disable no-invalid-this */\n    controlHasFocus = ko.pureComputed(function () {\n        return this.inputHasFocus() || this.controlOrChildHasFocus();\n    }, this);\n\n    showResults = ko.pureComputed(function () {\n        return this.items().length > 0 && this.controlHasFocus();\n    }, this);\n\n    showError = ko.pureComputed(function () {\n        return this.error() !== null && this.controlHasFocus();\n    }, this);\n\n    isQueryLengthOk = ko.computed(function () {\n        return this.query().trim().length >= this.minSearchQueryLength;\n    }, this);\n\n    showWarningTooShort = ko.pureComputed(function () {\n        return this.controlHasFocus() && this.query() && !this.isQueryLengthOk();\n    }, this);\n\n    minimizeToButton = ko.pureComputed(function () {\n        return this.allowMinimize() && !this.controlHasFocus();\n    }, this);\n\n    onItemMouseOver = (item) => {\n        this.highlightedIndex(this.items.indexOf(item));\n    };\n\n    onItemClick = (item) => {\n        this.itemSelected(item);\n    };\n\n    onButtonClick = (_, e) => {\n        L.DomEvent.preventDefault(e);\n        this.inputHasFocus(true);\n    };\n\n    onShowResults(show) {\n        if (show) {\n            this.highlightedIndex(0);\n        }\n    }\n\n    onControlHasFocusChange(active) {\n        if (!active) {\n            this.items.removeAll();\n            this.error(null);\n        }\n    }\n\n    onInputHasFocusChange(active) {\n        if (active) {\n            this.maybeRequestSearch(this.query());\n        }\n    }\n\n    onClearClick() {\n        this.query('');\n        this.inputHasFocus(true);\n    }\n\n    defaultEventHandle(_, e) {\n        L.DomEvent.stopPropagation(e);\n        return true;\n    }\n\n    onQueryChange() {\n        this.items.removeAll();\n        this.error(null);\n        this.searchAborted(null);\n        this.maybeRequestSearch();\n    }\n\n    onKeyDown = (_, e) => {\n        let n;\n        switch (e.which) {\n            case 38: // up\n                n = this.highlightedIndex();\n                if (n === null) {\n                    n = this.items().length - 1;\n                } else {\n                    n -= 1;\n                }\n                if (n === -1) {\n                    n = this.items().length - 1;\n                }\n                this.highlightedIndex(n);\n                break;\n            case 40: // down\n                n = this.highlightedIndex();\n                if (n === null) {\n                    n = 0;\n                } else {\n                    n += 1;\n                }\n                if (n === this.items().length) {\n                    n = 0;\n                }\n                this.highlightedIndex(n);\n                break;\n            case 13: // enter\n                if (this.items().length > 0) {\n                    this.itemSelected(this.items()[this.highlightedIndex()]);\n                }\n                break;\n            case 27: // esc\n                this.escapePressed(null);\n                break;\n            default:\n                return true;\n        }\n        return false;\n    };\n    /* eslint-enable no-invalid-this */\n\n    maybeRequestSearch() {\n        if (this.isQueryLengthOk() && this.controlHasFocus()) {\n            this.searchRequested(null);\n        }\n    }\n\n    // public events\n    itemSelected = ko.observable().extend({notify: 'always'});\n    searchRequested = ko.observable().extend({notify: 'always'});\n    searchAborted = ko.observable().extend({notify: 'always'});\n    escapePressed = ko.observable().extend({notify: 'always'});\n\n    // public methods\n    setResult(items, attribution) {\n        this.items.splice(0, this.items().length, ...items);\n        this.error(null);\n        this.attribution(attribution);\n    }\n\n    setResultError(error) {\n        this.items.removeAll();\n        this.error(error);\n    }\n\n    setFocus() {\n        this.inputHasFocus(true);\n    }\n\n    setInputPlaceholder(s) {\n        this.inputPlaceholder(s);\n    }\n\n    setHelpText(s) {\n        this.helpText(s);\n    }\n\n    setMinimizeAllowed(allowed) {\n        this.allowMinimize(allowed);\n    }\n\n    constructor(minSearchQueryLength) {\n        this.minSearchQueryLength = minSearchQueryLength;\n        this.query.subscribe(this.onQueryChange.bind(this));\n        this.showResults.subscribe(this.onShowResults.bind(this));\n        this.controlHasFocus.subscribe(this.onControlHasFocusChange.bind(this));\n        this.inputHasFocus.subscribe(this.onInputHasFocusChange.bind(this));\n    }\n}\n\nconst SearchControl = L.Control.extend({\n    includes: L.Evented,\n\n    options: {\n        provider: 'mapycz',\n        providerOptions: {\n            maxResponses: 5,\n        },\n        minQueryLength: 3,\n        hotkey: 'L',\n        maxMapHeightToMinimize: 567,\n        maxMapWidthToMinimize: 450,\n        tooltip: 'Поиск по Крыму',\n        help: 'Введите поисковую фразу или координаты в любом формате',\n    },\n\n    initialize: function (options) {\n        L.Control.prototype.initialize.call(this, options);\n        this.provider = new providers[this.options.provider](this.options.providerOptions);\n        this.magicProviders = magicProviders.map((Cls) => new Cls());\n        this.searchPromise = null;\n        this.viewModel = new SearchViewModel(this.options.minQueryLength);\n        this.viewModel.setInputPlaceholder(L.Util.template(this.options.tooltip, this.options));\n        this.viewModel.setHelpText(this.options.help);\n        this.viewModel.searchRequested.subscribe(this.onSearchRequested.bind(this));\n        this.viewModel.searchAborted.subscribe(this.onSearchAborted.bind(this));\n        this.viewModel.itemSelected.subscribe(this.onResultItemClicked.bind(this));\n        this.viewModel.query.subscribe(() => this._map.fire('querychange'));\n        this.viewModel.escapePressed.subscribe(this.setFocusToMap.bind(this));\n    },\n\n    onAdd: function (map) {\n        this._map = map;\n        const container = L.DomUtil.create('div', 'leaflet-search-container');\n        container.innerHTML = controlTemplate;\n        stopContainerEvents(container);\n        ko.applyBindings(this.viewModel, container);\n\n        this.searchPromise = null;\n\n        L.DomEvent.on(document, 'keyup', this.onDocumentKeyUp, this);\n        map.on('resize', this.updateMinimizeAllowed, this);\n        this.updateMinimizeAllowed();\n\n        // enable setting focus to map container\n        const mapContainer = map.getContainer();\n        if (mapContainer.tabIndex === undefined) {\n            mapContainer.tabIndex = -1;\n        }\n        return container;\n    },\n\n    setFocusToMap: function () {\n        this._map.getContainer().focus();\n    },\n\n    onSearchRequested: async function () {\n        const query = this.viewModel.query();\n        const searchOptions = {\n            bbox: this._map.getBounds(),\n            latlng: this._map.getCenter(),\n            zoom: this._map.getZoom(),\n        };\n        let provider = this.provider;\n        for (const magicProvider of this.magicProviders) {\n            if (magicProvider.isOurQuery(query)) {\n                provider = magicProvider;\n            }\n        }\n        this.searchPromise = provider.search(query, searchOptions);\n        const searchPromise = this.searchPromise;\n        const result = await searchPromise;\n        this._map.fire('resultreceived', {provider: provider.name, query, result});\n        if (this.searchPromise === searchPromise) {\n            if (result.error) {\n                this.viewModel.setResultError(result.error);\n            } else if (result.results.length === 0) {\n                this.viewModel.setResultError('Ничего не найдено.');\n            } else {\n                this.viewModel.setResult(result.results, provider.attribution);\n            }\n        }\n    },\n\n    onSearchAborted: function () {\n        this.searchPromise = null;\n    },\n\n    onResultItemClicked: function (item) {\n        if (item.bbox) {\n            this._map.fitBounds(item.bbox);\n        } else {\n            this._map.setView(item.latlng, item.zoom);\n        }\n        this._map.showPlacemark(item.latlng, item.title);\n        this.setFocusToMap();\n    },\n\n    onDocumentKeyUp: function (e) {\n        if (e.keyCode === this.options.hotkey.codePointAt(0) && e.altKey) {\n            this.viewModel.setFocus();\n        }\n    },\n\n    updateMinimizeAllowed: function () {\n        const mapSize = this._map.getSize();\n        this.viewModel.setMinimizeAllowed(\n            mapSize.y < this.options.maxMapHeightToMinimize || mapSize.x < this.options.maxMapWidthToMinimize\n        );\n    },\n});\n\nSearchControl.include(L.Mixin.HashState);\nSearchControl.include({\n    stateChangeEvents: ['querychange'],\n\n    serializeState: function () {\n        const query = this.viewModel.query();\n        if (query) {\n            return [encodeURIComponent(query)];\n        }\n        return null;\n    },\n\n    unserializeState: function (state) {\n        if (state?.length === 1) {\n            this.viewModel.query(decodeURIComponent(state[0]));\n            return true;\n        }\n        return false;\n    },\n});\n\nexport {SearchControl};\n","export default \"<!-- ko if: minimizeToButton -->\\n<div class=\\\"leaflet-search-button leaflet-bar leaflet-control-single-button\\\"\\n     data-bind=\\\"attr: {title: inputPlaceholder}\\\">\\n    <a href=\\\"#\\\" data-bind=\\\"click: onButtonClick\\\">\\n        <div class=\\\"icon-search\\\"></div>\\n    </a>\\n</div>\\n<!-- /ko -->\\n<!-- ko ifnot: minimizeToButton -->\\n<div class=\\\"leaflet-search-placeholder\\\"></div>\\n<div class=\\\"leaflet-search\\\"\\n    tabindex=\\\"-1\\\"\\n    data-bind=\\\"\\n        css: {hasresults: showResults() || showError() || showWarningTooShort()},\\n        hasFocusNested: controlOrChildHasFocus,\\n        event: {keydown: onKeyDown}\\\">\\n    <div class=\\\"leaflet-search-input-wrapper\\\">\\n        <input\\n            tabindex=\\\"-1\\\"\\n            type=\\\"search\\\"\\n            maxlength=\\\"4096\\\"\\n            class=\\\"leaflet-search-input\\\"\\n            data-bind=\\\"\\n                textInput: query,\\n                event: {\\n                    contextmenu: defaultEventHandle,\\n                    mousemove: defaultEventHandle\\n                },\\n                hasFocus: inputHasFocus,\\n                attr: {\\n                    placeholder: inputPlaceholder,\\n                    title: helpText,\\n                },\\n            \\\">\\n        <div class=\\\"leaflet-search-clear-button\\\" data-bind=\\\"visible: query, click: onClearClick\\\"></div>\\n    </div>\\n    <ul class=\\\"leaflet-search-results\\\" data-bind=\\\"visible: showResults\\\">\\n        <!-- ko foreach: {data: items} -->\\n        <li data-bind=\\\"\\n            event: {mouseover: $root.onItemMouseOver},\\n            click: $root.onItemClick,\\n            css: {highlighted: $index() === $root.highlightedIndex()}\\\">\\n            <p><span class=\\\"title\\\" data-bind=\\\"text: title\\\"></span>&nbsp;&nbsp;<img class=\\\"icon\\\" data-bind=\\\"visible: icon, attr: {src: icon}\\\"><span class=\\\"category\\\" data-bind=\\\"text: category\\\"></span></p>\\n            <p class=\\\"address\\\" data-bind=\\\"text: address\\\"></p>\\n        </li>\\n        <!-- /ko -->\\n        <!-- ko if: attribution -->\\n        <li class=\\\"search-provider-attribution\\\">\\n            Данные предоставляет <a data-bind=\\\"\\n                text: attribution().text,\\n                attr: {href: attribution().url},\\n                event: {contextmenu: defaultEventHandle}\\\"></a>\\n        </li>\\n        <!-- /ko -->\\n    </ul>\\n    <div class=\\\"leaflet-search-error\\\" data-bind=\\\"visible: showError, text: error\\\"></div>\\n    <div class=\\\"leaflet-search-error\\\" data-bind=\\\"visible: showWarningTooShort\\\">Введите минимум 3 символа</div>\\n</div>\\n<!-- /ko -->\\n\";","import {CoordinatesProvider} from './coordinates';\nimport {MapyCzProvider} from './mapycz';\n//import {PhotonProvider} from './photon';\n\nconst providers = {\n    mapycz: MapyCzProvider,\n};\n\nconst magicProviders = [CoordinatesProvider];\n\nexport {providers, magicProviders};\n","import L from 'leaflet';\n\nconst reInteger = '\\\\d+';\nconst reFractional = '\\\\d+(?:\\\\.\\\\d+)?';\nconst reSignedFractional = '-?\\\\d+(?:\\\\.\\\\d+)?';\nconst reHemisphere = '[NWSE]';\n\nclass Coordinates {\n    getLatitudeLetter() {\n        return this.latIsSouth ? 'S' : 'N';\n    }\n\n    getLongitudeLetter() {\n        return this.lonIsWest ? 'W' : 'E';\n    }\n\n    static parseHemispheres(h1, h2, h3, allowEmpty = false) {\n        function isLat(h) {\n            return h === 'N' || h === 'S';\n        }\n        let swapLatLon = false;\n        let hLat, hLon;\n        if (h1 && h2 && !h3) {\n            hLat = h1.trim();\n            hLon = h2.trim();\n        } else if (h1 && !h2 && h3) {\n            hLat = h1.trim();\n            hLon = h3.trim();\n        } else if (!h1 && h2 && h3) {\n            hLat = h2.trim();\n            hLon = h3.trim();\n        } else if (allowEmpty && !h1 && !h2 && !h3) {\n            return {empty: true};\n        } else {\n            return {error: true};\n        }\n        if (isLat(hLat) === isLat(hLon)) {\n            return {error: true};\n        }\n        if (isLat(hLon)) {\n            [hLat, hLon] = [hLon, hLat];\n            swapLatLon = true;\n        }\n        const latIsSouth = hLat === 'S';\n        const lonIsWest = hLon === 'W';\n        return {swapLatLon, latIsSouth, lonIsWest};\n    }\n}\n\nclass CoordinatesDMS extends Coordinates {\n    static regexp = new RegExp(\n        // eslint-disable-next-line max-len\n        `^(${reHemisphere} )?(${reInteger}) (${reInteger}) (${reFractional}) (${reHemisphere} )?(${reInteger}) (${reInteger}) (${reFractional})( ${reHemisphere})?$`,\n        'u'\n    );\n\n    constructor(latDeg, latMin, latSec, latIsSouth, lonDeg, lonMin, lonSec, lonIsWest) {\n        super();\n        Object.assign(this, {latDeg, latMin, latSec, latIsSouth, lonDeg, lonMin, lonSec, lonIsWest});\n    }\n\n    equalTo(other) {\n        return (\n            this.latDeg === other.latDeg &&\n            this.latMin === other.latMin &&\n            this.latSec === other.latSec &&\n            this.latIsSouth === other.latIsSouth &&\n            this.lonDeg === other.lonDeg &&\n            this.lonMin === other.lonMin &&\n            this.lonSec === other.lonSec &&\n            this.lonIsWest === other.lonIsWest\n        );\n    }\n\n    format() {\n        return {\n            latitude: `${this.getLatitudeLetter()} ${this.latDeg}°${this.latMin}′${this.latSec}″`,\n            longitude: `${this.getLongitudeLetter()} ${this.lonDeg}°${this.lonMin}′${this.lonSec}″`,\n        };\n    }\n\n    isValid() {\n        return (\n            this.latDeg >= 0 &&\n            this.latDeg <= 90 &&\n            this.latMin >= 0 &&\n            this.latMin <= 59 &&\n            this.latSec >= 0 &&\n            this.latSec < 60 &&\n            this.lonDeg >= 0 &&\n            this.lonDeg <= 180 &&\n            this.lonMin >= 0 &&\n            this.lonMin <= 59 &&\n            this.lonSec >= 0 &&\n            this.lonSec < 60 &&\n            (this.latDeg <= 89 || (this.latMin === 0 && this.latSec === 0)) &&\n            (this.lonDeg <= 179 || (this.lonMin === 0 && this.lonSec === 0))\n        );\n    }\n\n    getLatLng() {\n        let lat = this.latDeg + this.latMin / 60 + this.latSec / 3600;\n        if (this.latIsSouth) {\n            lat = -lat;\n        }\n        let lon = this.lonDeg + this.lonMin / 60 + this.lonSec / 3600;\n        if (this.lonIsWest) {\n            lon = -lon;\n        }\n        return L.latLng(lat, lon);\n    }\n\n    static fromString(s) {\n        const m = s.match(CoordinatesDMS.regexp);\n        if (!m) {\n            return {error: true};\n        }\n        const [h1, d1Str, m1Str, s1Str, h2, d2Str, m2Str, s2Str, h3] = m.slice(1);\n        const hemispheres = CoordinatesDMS.parseHemispheres(h1, h2, h3, true);\n        if (hemispheres.error) {\n            return {error: true};\n        }\n        let [d1, m1, s1, d2, m2, s2] = [d1Str, m1Str, s1Str, d2Str, m2Str, s2Str].map(parseFloat);\n        const coords = [];\n        if (hemispheres.empty) {\n            const coord1 = new CoordinatesDMS(d1, m1, s1, false, d2, m2, s2, false);\n            const coord2 = new CoordinatesDMS(d2, m2, s2, false, d1, m1, s1, false);\n            if (coord1.isValid()) {\n                coords.push(coord1);\n            }\n            if (!coord1.equalTo(coord2) && coord2.isValid()) {\n                coords.push(coord2);\n            }\n        } else {\n            if (hemispheres.swapLatLon) {\n                [d1, m1, s1, d2, m2, s2] = [d2, m2, s2, d1, m1, s1];\n            }\n            const coord = new CoordinatesDMS(d1, m1, s1, hemispheres.latIsSouth, d2, m2, s2, hemispheres.lonIsWest);\n            if (coord.isValid()) {\n                coords.push(coord);\n            }\n        }\n        if (coords.length > 0) {\n            return {coordinates: coords};\n        }\n        return {error: true};\n    }\n}\n\nclass CoordinatesDM extends Coordinates {\n    static regexp = new RegExp(\n        `^(${reHemisphere} )?(${reInteger}) (${reFractional}) (${reHemisphere} )?(${reInteger}) (${reFractional})( ${reHemisphere})?$`, // eslint-disable-line max-len\n        'u'\n    );\n\n    constructor(latDeg, latMin, latIsSouth, lonDeg, lonMin, lonIsWest) {\n        super();\n        Object.assign(this, {latDeg, latMin, latIsSouth, lonDeg, lonMin, lonIsWest});\n    }\n\n    equalTo(other) {\n        return (\n            this.latDeg === other.latDeg &&\n            this.latMin === other.latMin &&\n            this.latIsSouth === other.latIsSouth &&\n            this.lonDeg === other.lonDeg &&\n            this.lonMin === other.lonMin &&\n            this.lonIsWest === other.lonIsWest\n        );\n    }\n\n    format() {\n        return {\n            latitude: `${this.getLatitudeLetter()} ${this.latDeg}°${this.latMin}′`,\n            longitude: `${this.getLongitudeLetter()} ${this.lonDeg}°${this.lonMin}′`,\n        };\n    }\n\n    isValid() {\n        return (\n            this.latDeg >= 0 &&\n            this.latDeg <= 90 &&\n            this.latMin >= 0 &&\n            this.latMin < 60 &&\n            this.lonDeg >= 0 &&\n            this.lonDeg <= 180 &&\n            this.lonMin >= 0 &&\n            this.lonMin < 60 &&\n            (this.latDeg <= 89 || this.latMin === 0) &&\n            (this.lonDeg <= 179 || this.lonMin === 0)\n        );\n    }\n\n    getLatLng() {\n        let lat = this.latDeg + this.latMin / 60;\n        if (this.latIsSouth) {\n            lat = -lat;\n        }\n        let lon = this.lonDeg + this.lonMin / 60;\n        if (this.lonIsWest) {\n            lon = -lon;\n        }\n        return L.latLng(lat, lon);\n    }\n\n    static fromString(s) {\n        const m = s.match(CoordinatesDM.regexp);\n        if (!m) {\n            return {error: true};\n        }\n        const [h1, d1Str, m1Str, h2, d2Str, m2Str, h3] = m.slice(1);\n        const hemispheres = CoordinatesDM.parseHemispheres(h1, h2, h3, true);\n        if (hemispheres.error) {\n            return {error: true};\n        }\n        let [d1, m1, d2, m2] = [d1Str, m1Str, d2Str, m2Str].map(parseFloat);\n        const coords = [];\n        if (hemispheres.empty) {\n            const coord1 = new CoordinatesDM(d1, m1, false, d2, m2, false);\n            const coord2 = new CoordinatesDM(d2, m2, false, d1, m1, false);\n            if (coord1.isValid()) {\n                coords.push(coord1);\n            }\n            if (!coord1.equalTo(coord2) && coord2.isValid()) {\n                coords.push(coord2);\n            }\n        } else {\n            if (hemispheres.swapLatLon) {\n                [d1, m1, d2, m2] = [d2, m2, d1, m1];\n            }\n            const coord = new CoordinatesDM(d1, m1, hemispheres.latIsSouth, d2, m2, hemispheres.lonIsWest);\n            if (coord.isValid()) {\n                coords.push(coord);\n            }\n        }\n        if (coords.length > 0) {\n            return {coordinates: coords};\n        }\n        return {error: true};\n    }\n}\n\nclass CoordinatesD extends Coordinates {\n    static regexp = new RegExp(\n        `^(${reHemisphere} )?(${reFractional}) (${reHemisphere} )?(${reFractional})( ${reHemisphere})?$`,\n        'u'\n    );\n\n    constructor(latDeg, latIsSouth, lonDeg, lonIsWest) {\n        super();\n        Object.assign(this, {latDeg, latIsSouth, lonDeg, lonIsWest});\n    }\n\n    format() {\n        return {\n            latitude: `${this.getLatitudeLetter()} ${this.latDeg}°`,\n            longitude: `${this.getLongitudeLetter()} ${this.lonDeg}°`,\n        };\n    }\n\n    equalTo(other) {\n        return (\n            this.latDeg === other.latDeg &&\n            this.latIsSouth === other.latIsSouth &&\n            this.lonDeg === other.lonDeg &&\n            this.lonIsWest === other.lonIsWest\n        );\n    }\n\n    isValid() {\n        return this.latDeg >= 0 && this.latDeg <= 90 && this.lonDeg >= 0 && this.lonDeg <= 180;\n    }\n\n    getLatLng() {\n        let lat = this.latDeg;\n        if (this.latIsSouth) {\n            lat = -lat;\n        }\n        let lon = this.lonDeg;\n        if (this.lonIsWest) {\n            lon = -lon;\n        }\n        return L.latLng(lat, lon);\n    }\n\n    static fromString(s) {\n        const m = s.match(CoordinatesD.regexp);\n        if (!m) {\n            return {error: true};\n        }\n        const [h1, d1Str, h2, d2Str, h3] = m.slice(1);\n        const hemispheres = CoordinatesD.parseHemispheres(h1, h2, h3);\n        if (hemispheres.error) {\n            return {error: true};\n        }\n        let [d1, d2] = [d1Str, d2Str].map(parseFloat);\n        if (hemispheres.swapLatLon) {\n            [d1, d2] = [d2, d1];\n        }\n        const coord = new CoordinatesD(d1, hemispheres.latIsSouth, d2, hemispheres.lonIsWest);\n        if (coord.isValid()) {\n            return {\n                coordinates: [coord],\n            };\n        }\n        return {error: true};\n    }\n}\n\nclass CoordinatesDSigned extends Coordinates {\n    static regexp = new RegExp(`^(${reSignedFractional}) (${reSignedFractional})$`, 'u');\n\n    constructor(latDegSigned, lonDegSigned) {\n        super();\n        Object.assign(this, {latDegSigned, lonDegSigned});\n    }\n\n    equalTo(other) {\n        return this.latDegSigned === other.latDegSigned && this.lonDegSigned === other.lonDegSigned;\n    }\n\n    isValid() {\n        return (\n            this.latDegSigned >= -90 && this.latDegSigned <= 90 && this.lonDegSigned >= -180 && this.lonDegSigned <= 180\n        );\n    }\n\n    format() {\n        return {\n            latitude: `${this.latDegSigned}°`,\n            longitude: `${this.lonDegSigned}°`,\n        };\n    }\n\n    getLatLng() {\n        return L.latLng(this.latDegSigned, this.lonDegSigned);\n    }\n\n    static fromString(s) {\n        const m = s.match(CoordinatesDSigned.regexp);\n        if (!m) {\n            return {error: true};\n        }\n        const coords = [];\n        const [d1, d2] = m.slice(1).map(parseFloat);\n        const coord1 = new CoordinatesDSigned(d1, d2);\n        if (coord1.isValid()) {\n            coords.push(coord1);\n        }\n        const coord2 = new CoordinatesDSigned(d2, d1);\n        if (!coord1.equalTo(coord2)) {\n            if (coord2.isValid()) {\n                coords.push(coord2);\n            }\n        }\n        if (coords.length === 0) {\n            return {error: true};\n        }\n        return {\n            coordinates: coords,\n        };\n    }\n}\n\nclass CoordinatesProvider {\n    name = 'Coordinates';\n\n    static regexps = {\n        // This regexp wag generated using script at https://gist.github.com/wladich/3d15edc8fcd8b735ac883ef60fe10bfe\n        // It matches all unicode characters except Lu (Uppercase Letter), Ll (Lowercase Letter)\n        // and [0123456789,.-]. It ignores unassigned code points (Cn) and characters that are removed after NFKC\n        // normalization.\n        // Manually added: \"oO\" (lat), \"оО\" (rus)\n        // eslint-disable-next-line max-len, no-control-regex, no-misleading-character-class\n        symbols: /[OoОо\\u0000-\\u002b\\u002f\\u003a-\\u0040\\u005b-\\u0060\\u007b-\\u00bf\\u00d7\\u00f7\\u01bb\\u01c0-\\u01cc\\u0294\\u02b9-\\u036f\\u0375\\u03f6\\u0482-\\u0489\\u0559-\\u055f\\u0589-\\u109f\\u10fb\\u10fc\\u1100-\\u139f\\u1400-\\u1c7f\\u1cc0-\\u1cff\\u1d2f-\\u1d6a\\u1dc0-\\u1dff\\u1f88-\\u1f8f\\u1f98-\\u1f9f\\u1fa8-\\u1faf\\u1fbc-\\u1fc1\\u1fcc-\\u1fcf\\u1ffc-\\u2131\\u213a-\\u214d\\u214f-\\u2182\\u2185-\\u2bff\\u2ce5-\\u2cea\\u2cef-\\u2cf1\\u2cf9-\\u2cff\\u2d30-\\ua63f\\ua66e-\\ua67f\\ua69e-\\ua721\\ua788-\\ua78a\\ua78f\\ua7f7-\\ua7f9\\ua7fb-\\uab2f\\uab5b-\\uab5f\\uabc0-\\uffff]/gu,\n        northernHemishphere: /[Nn]|[СсCc] *[Шш]?/gu,\n        southernHemishphere: /[Ss]|[Юю] *[Шш]?/gu,\n        westernHemishphere: /[Ww]|[Зз] *[Дд]?/gu,\n        easternHemishphere: /[EeЕе]|[ВвB] *[Дд]?/gu, // second Ее is cyrillic\n    };\n\n    static parsers = [CoordinatesDMS, CoordinatesDM, CoordinatesD, CoordinatesDSigned];\n\n    normalizeInput(inp) {\n        let s = inp.normalize('NFKC'); // convert subscripts and superscripts to normal chars\n        s = ' ' + s + ' ';\n        // replace everything that is not letter, number, minus, dot or comma to space\n        s = s.replace(CoordinatesProvider.regexps.symbols, ' ');\n        // remove all dots and commas if they are not between digits\n        s = s.replace(/[,.](?=\\D)/gu, ' ');\n        s = s.replace(/(\\D)[,.]/gu, '$1 '); // lookbehind is not supported in all browsers\n        // if dot is likely to be used as decimal separator, remove all commas\n        if (s.includes('.')) {\n            s = s.replace(/,/gu, ' ');\n        } else {\n            // otherwise comma is decimal separator\n            s = s.replace(/,/gu, '.');\n        }\n        s = s.replace(/-(?=\\D)/gu, ' '); // remove all minuses that are not in the beginning of number\n        s = s.replace(/([^ ])-/gu, '$1 '); // lookbehind is not supported in all browsers\n\n        s = s.replace(CoordinatesProvider.regexps.northernHemishphere, ' N ');\n        s = s.replace(CoordinatesProvider.regexps.southernHemishphere, ' S ');\n        s = s.replace(CoordinatesProvider.regexps.westernHemishphere, ' W ');\n        s = s.replace(CoordinatesProvider.regexps.easternHemishphere, ' E ');\n\n        s = s.replace(/ +/gu, ' '); // compress whitespaces\n        s = s.trim();\n        return s;\n    }\n\n    isOurQuery(query) {\n        const coordFieldRe = new RegExp(`^((${reHemisphere})|(${reSignedFractional}))$`, 'u');\n        const coordNumbersFieldRe = new RegExp(`^(${reSignedFractional})$`, 'u');\n        const fields = this.normalizeInput(query).split(' ');\n        return (\n            fields.length > 1 &&\n            fields.every((field) => field.match(coordFieldRe)) &&\n            fields.some((field) => field.match(coordNumbersFieldRe))\n        );\n    }\n\n    async search(query) {\n        const s = this.normalizeInput(query);\n        for (const parser of CoordinatesProvider.parsers) {\n            const result = parser.fromString(s);\n            if (!result.error) {\n                const resultItems = result.coordinates.map((it) => {\n                    const coordStrings = it.format();\n                    return {\n                        title: `${coordStrings.latitude} ${coordStrings.longitude}`,\n                        latlng: it.getLatLng(),\n                        zoom: 17,\n                        category: 'Координаты',\n                        address: null,\n                        icon: null,\n                    };\n                });\n                return {\n                    results: resultItems,\n                };\n            }\n        }\n        return {error: 'Некорректные координаты'};\n    }\n}\n\nexport {CoordinatesProvider};\n","import L from 'leaflet';\n\nimport * as logging from '~/lib/logging';\nimport {fetch} from '~/lib/xhr-promise';\n\nimport {BaseProvider} from '../remoteBase';\nimport _categories from './categories.csv';\nimport icons from './icons.json';\nimport config from '~/config';\n\nconst categories = Object.assign({}, ..._categories.map((it) => ({[String(it.id)]: it})));\n\nconst MapyCzProvider = BaseProvider.extend({\n    name: 'Mapy.cz',\n\n    options: {\n        apiUrl: 'https://api.mapy.cz/suggest/',\n        attribution: {\n            text: 'Mapy.cz',\n            url: 'https://mapy.cz',\n        },\n        delay: 300,\n        languages: ['en', 'ru'],\n        categoriesLanguages: ['en', 'ru'],\n        defaultLanguage: 'ru',\n    },\n\n    initialize: function (options) {\n        BaseProvider.prototype.initialize.call(this, options);\n        this.langStr = this.getRequestLanguages(this.options.languages).join(',');\n        this.categoriesLanguage = this.getRequestLanguages(\n            this.options.categoriesLanguages,\n            this.options.defaultLanguage\n        )[0];\n    },\n\n    search: async function (query, {latlng, zoom}) {\n        if (!(await this.waitNoNewRequestsSent())) {\n            return {error: 'Request cancelled'};\n        }\n        const url = new URL(this.options.apiUrl);\n        url.searchParams.append('phrase', query);\n        url.searchParams.append('lat', config.defaultLocation[0]);\n        url.searchParams.append('lon', config.defaultLocation[1]);\n        url.searchParams.append('zoom', 13);\n        url.searchParams.append('lang', this.langStr);\n        if (this.options.maxResponses) {\n            url.searchParams.append('count', this.options.maxResponses);\n        }\n        let xhr;\n        try {\n            xhr = await fetch(url.href, {responseType: 'json', timeout: 5000});\n        } catch (e) {\n            if (e.name === 'XMLHttpRequestPromiseError') {\n                logging.captureException(e, 'Error response from mapy.cz search api');\n                return {error: `Search failed: ${e.message}`};\n            }\n            throw e;\n        }\n        let crimea_bounds = L.latLngBounds( L.latLng( config.crimeaBounds.topLeft ), L.latLng( config.crimeaBounds.bottomRight ) );\n        const places = xhr.responseJSON.result\n            .filter((it) => {\n                if ( it.userData.suggestSecondRow === 'Poloha' ) {\n                    return false;\n                }\n                let coords = L.latLng( it.userData.latitude, it.userData.longitude );\n                if ( ! crimea_bounds.contains( coords ) ) {\n                    return false;\n                }\n\n                return true;\n            })\n            .map((it) => {\n                it.userData.suggestSecondRow = it.userData.suggestSecondRow.replace( 'Украина', 'Россия' ); // Крым наш\n                const data = it.userData;\n                const iconId = icons[data.poiTypeId];\n                const icon = iconId ? `https://api.mapy.cz/poiimg/icon/${iconId}?scale=1` : null;\n                const place = {\n                    latlng: L.latLng(data.latitude, data.longitude),\n                    title: data.suggestFirstRow,\n                    address: data.suggestSecondRow,\n                    category: categories[data.poiTypeId]?.[this.categoriesLanguage] || data.suggestThirdRow || null,\n                    icon,\n                };\n                if (data.bbox) {\n                    place.bbox = L.latLngBounds([data.bbox[0], data.bbox[1]], [data.bbox[2], data.bbox[3]]);\n                } else {\n                    place.zoom = 17;\n                }\n                return place;\n            });\n        const poiIds = xhr.responseJSON.result\n            .filter((it) => Boolean(it.userData.poiTypeId))\n            .map((it) => ({\n                typeId: it.userData.poiTypeId,\n                poiId: it.userData.id,\n                source: it.userData.source,\n            }));\n        if (poiIds.length > 0) {\n            logging.logEvent('SearchMapyCzPoiIds', {poiIds});\n        }\n        return {results: places};\n    },\n});\n\nexport {MapyCzProvider};\n","import L from 'leaflet';\n\nfunction sleep(ms) {\n    return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\nconst BaseProvider = L.Class.extend({\n    options: {\n        maxResponses: null,\n        attribution: null,\n        delay: 500,\n    },\n\n    initialize: function (options) {\n        L.setOptions(this, options);\n        this.attribution = this.options.attribution;\n    },\n\n    getRequestLanguages: function (supportedLanguages, defaultLanguage) {\n        let languages = (navigator.languages ?? [])\n            .map((s) => s.split('-')[0])\n            .filter((value, index, arr) => arr.indexOf(value) === index)\n            .filter((lang) => supportedLanguages.includes(lang));\n        if (languages.length === 0) {\n            languages = [defaultLanguage];\n        }\n        return languages;\n    },\n\n    waitNoNewRequestsSent: async function () {\n        if (this.options.delay) {\n            this._sleep = sleep(this.options.delay);\n            const sleepPromise = this._sleep;\n            await sleepPromise;\n            return this._sleep === sleepPromise;\n        }\n        return true;\n    },\n});\n\nexport {BaseProvider};\n","module.exports = [{\"id\":2,\"en\":\"Area\",\"ru\":\"Территория\"},{\"id\":3,\"en\":\"Island\",\"ru\":\"Остров\"},{\"id\":4,\"en\":\"Mountain range\",\"ru\":\"Горная область\"},{\"id\":6,\"en\":\"Protected area\",\"ru\":\"Охраняемная территория\"},{\"id\":7,\"en\":\"Water body\",\"ru\":\"Водоём\"},{\"id\":9,\"en\":\"Local name\",\"ru\":\"Местное название\"},{\"id\":10,\"en\":\"National park\",\"ru\":\"Национальный парк\"},{\"id\":12,\"en\":\"Name of the forest or field\",\"ru\":\"Урочище\"},{\"id\":13,\"en\":\"Historic Territory\",\"ru\":\"Историческая территория\"},{\"id\":15,\"en\":\"City district\",\"ru\":\"Район города\"},{\"id\":21,\"en\":\"Road\",\"ru\":\"Дорога\"},{\"id\":40,\"en\":\"Postal code\",\"ru\":\"Почтовый индекс\"},{\"id\":101,\"en\":\"Continent\",\"ru\":\"Континент\"},{\"id\":102,\"en\":\"Sea\",\"ru\":\"Море\"},{\"id\":103,\"en\":\"Ocean\",\"ru\":\"Океан\"},{\"id\":104,\"en\":\"Bay\",\"ru\":\"Залив\"},{\"id\":105,\"en\":\"Glacier\",\"ru\":\"Ледник\"},{\"id\":106,\"en\":\"Swamp\",\"ru\":\"Болото\"},{\"id\":107,\"en\":\"Peninsula\",\"ru\":\"Полуостров\"},{\"id\":108,\"en\":\"Desert\",\"ru\":\"Пустыня\"},{\"id\":109,\"en\":\"Strait, channel\",\"ru\":\"Пролив\"},{\"id\":110,\"en\":\"Underwater formation\",\"ru\":\"Подводное образование\"},{\"id\":111,\"en\":\"Low land\",\"ru\":\"Низменность\"},{\"id\":112,\"en\":\"Valley\",\"ru\":\"Долина\"},{\"id\":113,\"en\":\"Fjord\",\"ru\":\"Фьорд\"},{\"id\":114,\"en\":\"River\",\"ru\":\"Река\"},{\"id\":115,\"en\":\"Canal\",\"ru\":\"Канал\"},{\"id\":116,\"en\":\"Stream\",\"ru\":\"Ручей\"},{\"id\":117,\"en\":\"Military area\",\"ru\":\"Военный полигон\"},{\"id\":118,\"en\":\"Administrative structure\",\"ru\":\"Регион\"},{\"id\":119,\"en\":\"Inhabited area\",\"ru\":\"Населенный пункт\"},{\"id\":120,\"en\":\"Industrial zone\",\"ru\":\"Промзона\"},{\"id\":122,\"en\":\"District\",\"ru\":\"Пригород\"},{\"id\":127,\"en\":\"Cape\",\"ru\":\"Мыс\"},{\"id\":128,\"en\":\"Archipelago\",\"ru\":\"Архипелаг\"},{\"id\":201,\"en\":\"Capital city\",\"ru\":\"Столица\"},{\"id\":202,\"en\":\"Town\",\"ru\":\"Город\"},{\"id\":203,\"en\":\"Municipality\",\"ru\":\"Город\"},{\"id\":204,\"en\":\"Village\",\"ru\":\"Деревня\"},{\"id\":205,\"en\":\"City\",\"ru\":\"Город\"},{\"id\":206,\"en\":\"Village\",\"ru\":\"Деревня\"},{\"id\":210,\"en\":\"Country\",\"ru\":\"Страна\"},{\"id\":220,\"en\":\"Attraction\",\"ru\":\"Достопримечательность\"},{\"id\":230,\"en\":\"Аddress\",\"ru\":\"Адрес\"},{\"id\":250,\"en\":\"City district\",\"ru\":\"Район города\"},{\"id\":251,\"en\":\"Quarter\",\"ru\":\"Квартал\"},{\"id\":1012,\"en\":\"Border crossing\",\"ru\":\"Погранпереход\"},{\"id\":1014,\"en\":\"Border crossing\",\"ru\":\"Погранпереход\"},{\"id\":1015,\"en\":\"Cableway\",\"ru\":\"Канатная дорога\"},{\"id\":1016,\"en\":\"International airport\",\"ru\":\"Международный аэропорт\"},{\"id\":1017,\"en\":\"Airport\",\"ru\":\"Аэропорт\"},{\"id\":1018,\"en\":\"Airport\",\"ru\":\"Аэропорт\"},{\"id\":1019,\"en\":\"Airport Terminal\",\"ru\":\"Терминал аэропорта\"},{\"id\":1022,\"en\":\"Subway station\",\"ru\":\"Станция метро\"},{\"id\":1023,\"en\":\"Helipad\",\"ru\":\"Вертолетная площадка\"},{\"id\":1024,\"en\":\"Ski lift\",\"ru\":\"Горнолыжный подъемник\"},{\"id\":1030,\"en\":\"Port\",\"ru\":\"Порт\"},{\"id\":1042,\"en\":\"Subway line\",\"ru\":\"Линия метро\"},{\"id\":1043,\"en\":\"Ski piste\",\"ru\":\"Горнолыжная трасса\"},{\"id\":1045,\"en\":\"Subway line\",\"ru\":\"Линия метро\"},{\"id\":1065,\"en\":\"Parking meter\",\"ru\":\"Паркомат\"},{\"id\":1071,\"en\":\"Tollhouse\",\"ru\":\"Касса\"},{\"id\":1113,\"en\":\"Rest area\",\"ru\":\"Место для отдыха\"},{\"id\":1114,\"en\":\"Tourist signpost\",\"ru\":\"Указатель троп\"},{\"id\":1115,\"en\":\"Bunker\",\"ru\":\"Бункер\"},{\"id\":1116,\"en\":\"Shelter\",\"ru\":\"Укрытие\"},{\"id\":1117,\"en\":\"Tourist signpost\",\"ru\":\"Указатель троп\"},{\"id\":1118,\"en\":\"Observation tower\",\"ru\":\"Обзорная башня\"},{\"id\":1119,\"en\":\"Mine\",\"ru\":\"Шахта\"},{\"id\":1122,\"en\":\"High building\",\"ru\":\"Высокое здание\"},{\"id\":1127,\"en\":\"Transmission tower\",\"ru\":\"Радио башня\"},{\"id\":1130,\"en\":\"Drift, shaft\",\"ru\":\"Штольня, шахта\"},{\"id\":1131,\"en\":\"Attraction\",\"ru\":\"Достопримечательность\"},{\"id\":1133,\"en\":\"Bridge\",\"ru\":\"Мост\"},{\"id\":1134,\"en\":\"Playground\",\"ru\":\"Игровая площадка\"},{\"id\":1136,\"en\":\"Tunnel\",\"ru\":\"Тонель\"},{\"id\":1138,\"en\":\"Dam\",\"ru\":\"Плотина\"},{\"id\":1210,\"en\":\"Archeological site\",\"ru\":\"Археологические раскопки\"},{\"id\":1212,\"en\":\"Castle\",\"ru\":\"Замок\"},{\"id\":1216,\"en\":\"Monastery\",\"ru\":\"Монастырь\"},{\"id\":1217,\"en\":\"Church\",\"ru\":\"Церковь\"},{\"id\":1218,\"en\":\"Cross\",\"ru\":\"Крест\"},{\"id\":1224,\"en\":\"Memorial\",\"ru\":\"Памятник\"},{\"id\":1229,\"en\":\"Chateau\",\"ru\":\"Замок, дворец\"},{\"id\":1231,\"en\":\"Ruin\",\"ru\":\"Развалины\"},{\"id\":1233,\"en\":\"Cabin\",\"ru\":\"Хижина\"},{\"id\":1234,\"en\":\"Park\",\"ru\":\"Парк\"},{\"id\":1236,\"en\":\"Cemetery\",\"ru\":\"Кладбище\"},{\"id\":1242,\"en\":\"Mosque\",\"ru\":\"Мечеть\"},{\"id\":1246,\"en\":\"Castle\",\"ru\":\"Замок\"},{\"id\":1249,\"en\":\"Temple\",\"ru\":\"Храм/Синагога/Мечеть\"},{\"id\":1250,\"en\":\"Attraction\",\"ru\":\"Достопримечательность\"},{\"id\":1255,\"en\":\"Planetarium\",\"ru\":\"Планетарий\"},{\"id\":1256,\"en\":\"Battlefield\",\"ru\":\"Историческое поле сражения\"},{\"id\":1258,\"en\":\"Memorial plaque\",\"ru\":\"Мемориальная доска\"},{\"id\":1261,\"en\":\"Amusement park\",\"ru\":\"Парк развлечений\"},{\"id\":1271,\"en\":\"Garden\",\"ru\":\"Сад\"},{\"id\":1310,\"en\":\"UNESCO site\",\"ru\":\"объект ЮНЕСКО\"},{\"id\":1411,\"en\":\"Mountain\",\"ru\":\"Вершина\"},{\"id\":1412,\"en\":\"Information board\",\"ru\":\"Информационный стенд\"},{\"id\":1413,\"en\":\"Protected area\",\"ru\":\"Охраняемная территория\"},{\"id\":1414,\"en\":\"Cave\",\"ru\":\"Пещера\"},{\"id\":1415,\"en\":\"Water body\",\"ru\":\"Водоём\"},{\"id\":1416,\"en\":\"Mountain, volcano\",\"ru\":\"Вершина, вулкан\"},{\"id\":1417,\"en\":\"Natural swimming pool\",\"ru\":\"Место купания\"},{\"id\":1418,\"en\":\"Water reservoir\",\"ru\":\"Водохранилише или водонапорная башня\"},{\"id\":1427,\"en\":\"Mountain pass\",\"ru\":\"Перевал\"},{\"id\":1428,\"en\":\"Rocks\",\"ru\":\"Скалы\"},{\"id\":1429,\"en\":\"Well, spring\",\"ru\":\"Источник\"},{\"id\":1430,\"en\":\"Waterfall\",\"ru\":\"Водопад\"},{\"id\":1433,\"en\":\"Beach\",\"ru\":\"Пляж\"},{\"id\":1441,\"en\":\"Geyser\",\"ru\":\"Гейзер\"},{\"id\":1443,\"en\":\"Scenic viewpoint\",\"ru\":\"Обзорная точка\"},{\"id\":1445,\"en\":\"Significant tree\",\"ru\":\"Примечательное дерево\"},{\"id\":1447,\"en\":\"Cave\",\"ru\":\"Пещера\"},{\"id\":1642,\"en\":\"Cycling route\",\"ru\":\"Велосипедный маршрут\"},{\"id\":1643,\"en\":\"Hiking trail\",\"ru\":\"Пешеходный маршрут\"},{\"id\":4100,\"en\":\"Part of building\",\"ru\":\"Корпус здания\"},{\"id\":5018,\"en\":\"Power plant\",\"ru\":\"Электростанция\"},{\"id\":5112,\"en\":\"Police station\",\"ru\":\"Отделение полиции\"},{\"id\":5114,\"en\":\"Post office\",\"ru\":\"Почта\"},{\"id\":5115,\"en\":\"School\",\"ru\":\"Школа\"},{\"id\":5116,\"en\":\"University\",\"ru\":\"Университет\"},{\"id\":5118,\"en\":\"Administrative office\",\"ru\":\"Администрация\"},{\"id\":5123,\"en\":\"Kindergarten\",\"ru\":\"Детский сад\"},{\"id\":5124,\"en\":\"Fire station\",\"ru\":\"Пожарное депо\"},{\"id\":5210,\"en\":\"Botanical garden\",\"ru\":\"Ботанический сад\"},{\"id\":5211,\"en\":\"Theatre\",\"ru\":\"Театр\"},{\"id\":5213,\"en\":\"Information center\",\"ru\":\"Инфоцентр\"},{\"id\":5214,\"en\":\"Cimena\",\"ru\":\"Кинотеатр\"},{\"id\":5215,\"en\":\"Library\",\"ru\":\"Библиотека\"},{\"id\":5216,\"en\":\"Museum\",\"ru\":\"Музей\"},{\"id\":5217,\"en\":\"Zoo\",\"ru\":\"Зоопарк\"},{\"id\":5222,\"en\":\"Community or social centre\",\"ru\":\"Дом культуры\"},{\"id\":5223,\"en\":\"Social service\",\"ru\":\"Социальная служба\"},{\"id\":5306,\"en\":\"Money exchange\",\"ru\":\"Обмен валют\"},{\"id\":5307,\"en\":\"Car wash\",\"ru\":\"Мойка машин\"},{\"id\":5309,\"en\":\"LPG station\",\"ru\":\"Газовая заправка\"},{\"id\":5310,\"en\":\"Auto service\",\"ru\":\"Автосервис\"},{\"id\":5311,\"en\":\"ATM\",\"ru\":\"Банкомат\"},{\"id\":5312,\"en\":\"Bank\",\"ru\":\"Банк\"},{\"id\":5313,\"en\":\"Petrol station\",\"ru\":\"Заправка\"},{\"id\":5315,\"en\":\"Shopping mall\",\"ru\":\"Торговый центр\"},{\"id\":5319,\"en\":\"Bike shop\",\"ru\":\"Веломагазин\"},{\"id\":5322,\"en\":\"Restaurant\",\"ru\":\"Ресторан\"},{\"id\":5324,\"en\":\"Fastfood\",\"ru\":\"Фастфуд\"},{\"id\":5326,\"en\":\"Cafe\",\"ru\":\"Кафе\"},{\"id\":5328,\"en\":\"Bar\",\"ru\":\"Бар\"},{\"id\":5329,\"en\":\"Pub\",\"ru\":\"Пивная\"},{\"id\":5401,\"en\":\"Indoor pool\",\"ru\":\"Крытый бассейн\"},{\"id\":5403,\"en\":\"Sauna\",\"ru\":\"Сауна\"},{\"id\":5410,\"en\":\"Stadium\",\"ru\":\"Стадион\"},{\"id\":5415,\"en\":\"Pool\",\"ru\":\"Бассейн\"},{\"id\":5417,\"en\":\"Gym\",\"ru\":\"Тренажерный зал\"},{\"id\":5418,\"en\":\"Sports ground\",\"ru\":\"Спортивная площадка\"},{\"id\":5448,\"en\":\"Volleyball field\",\"ru\":\"Волейбольное поле\"},{\"id\":5455,\"en\":\"Rugby clubs\",\"ru\":\"Клуб регби\"},{\"id\":5464,\"en\":\"BMX ground\",\"ru\":\"Площадка для BMX\"},{\"id\":5511,\"en\":\"Hotel\",\"ru\":\"Гостиница\"},{\"id\":5512,\"en\":\"Camp or camp site\",\"ru\":\"Лагерь или место ночевки\"},{\"id\":5513,\"en\":\"Camp or Campsite\",\"ru\":\"Лагерь или место ночевки\"},{\"id\":5514,\"en\":\"Motel\",\"ru\":\"Мотель\"},{\"id\":5515,\"en\":\"Accommodation\",\"ru\":\"Место размещения\"},{\"id\":5516,\"en\":\"Guest house\",\"ru\":\"Гостевой дом\"},{\"id\":5518,\"en\":\"Hostel\",\"ru\":\"Хостел\"},{\"id\":5520,\"en\":\"Shelter\",\"ru\":\"Укрытие\"},{\"id\":5521,\"en\":\"Apartments\",\"ru\":\"Апартаменты\"},{\"id\":5522,\"en\":\"Holiday house\",\"ru\":\"Гостевой дом\"},{\"id\":5611,\"en\":\"Pharmacy\",\"ru\":\"Аптека\"},{\"id\":5613,\"en\":\"Hospital\",\"ru\":\"Больница\"},{\"id\":5616,\"en\":\"Vet's office\",\"ru\":\"Ветеринар\"},{\"id\":5619,\"en\":\"Wine shop\",\"ru\":\"Вино\"},{\"id\":5622,\"en\":\"Electric cars charging station\",\"ru\":\"Станция заряда электроавтомобилей\"},{\"id\":5623,\"en\":\"Electrical supplies\",\"ru\":\"Электротовары\"},{\"id\":5624,\"en\":\"Hobby shop\",\"ru\":\"Товары для дома\"},{\"id\":5626,\"en\":\"Furniture store\",\"ru\":\"Мебельный магазин\"},{\"id\":5627,\"en\":\"Sports equipment\",\"ru\":\"Спортивный магазин\"},{\"id\":5628,\"en\":\"Grocery store\",\"ru\":\"Продуктовый магазин\"},{\"id\":5630,\"en\":\"Auto service\",\"ru\":\"Автосервис\"},{\"id\":5631,\"en\":\"Travel service\",\"ru\":\"Туристические услуги\"},{\"id\":5632,\"en\":\"Accounting and tax records\",\"ru\":\"Бухгалтерия и налоги\"},{\"id\":5633,\"en\":\"Shop\",\"ru\":\"Магазин\"},{\"id\":5634,\"en\":\"Advertising and marketing services\",\"ru\":\"Рекламные услуги\"},{\"id\":5635,\"en\":\"Sales of heat pumps\",\"ru\":\"Продажа тепловых насосов\"},{\"id\":5636,\"en\":\"Factory\",\"ru\":\"Фабрика\"},{\"id\":5638,\"en\":\"Real estate agents\",\"ru\":\"Агент по недвижимости\"},{\"id\":5639,\"en\":\"Application service providers\",\"ru\":\"Application service providers\"},{\"id\":5641,\"en\":\"Construction works\",\"ru\":\"Строительные работы\"},{\"id\":5642,\"en\":\"Sale of pharmaceuticals\",\"ru\":\"Продажа лекарств\"},{\"id\":5653,\"en\":\"Waste disposal\",\"ru\":\"Утилизация отходов\"},{\"id\":5656,\"en\":\"Alergologist\",\"ru\":\"Алерголог\"},{\"id\":5666,\"en\":\"Barbershop\",\"ru\":\"Парикмахерская\"},{\"id\":5668,\"en\":\"Cosmetics\",\"ru\":\"Косметика\"},{\"id\":5669,\"en\":\"Sales of paints\",\"ru\":\"Продажа красок\"},{\"id\":5673,\"en\":\"Engineering services\",\"ru\":\"Инженерные работы\"},{\"id\":5676,\"en\":\"Construction company\",\"ru\":\"Строительная компания\"},{\"id\":5679,\"en\":\"Joinery and carpentry\",\"ru\":\"Столярные работы\"},{\"id\":5683,\"en\":\"Jewelry\",\"ru\":\"Ювелирный магазин\"},{\"id\":5684,\"en\":\"Sale of cosmetics\",\"ru\":\"Продажа косметики\"},{\"id\":5685,\"en\":\"Clothes shop\",\"ru\":\"Магазин одежды\"},{\"id\":5686,\"en\":\"Bakery\",\"ru\":\"Пекарня\"},{\"id\":5687,\"en\":\"Tobacco shop\",\"ru\":\"Табачный магазин\"},{\"id\":5688,\"en\":\"Butcher shop\",\"ru\":\"Мясной магазин\"},{\"id\":5690,\"en\":\"Beverage & liquor\",\"ru\":\"Алкогольный магазин\"},{\"id\":5691,\"en\":\"Bookshop\",\"ru\":\"Книжный магазин\"},{\"id\":5692,\"en\":\"Gift shop\",\"ru\":\"Магазин сувениров\"},{\"id\":5694,\"en\":\"Fruits, vegetables\",\"ru\":\"Офощи-фрукты\"},{\"id\":5697,\"en\":\"Pet supplies\",\"ru\":\"Зоомагазин\"},{\"id\":5699,\"en\":\"Printing house\",\"ru\":\"Типография\"},{\"id\":5701,\"en\":\"Shoe shop\",\"ru\":\"Обувбной магазин\"},{\"id\":5753,\"en\":\"Building\",\"ru\":\"Здание\"},{\"id\":5755,\"en\":\"Driving school\",\"ru\":\"Автошкола\"},{\"id\":5759,\"en\":\"Water treatment facility\",\"ru\":\"Станция подготовки воды\"},{\"id\":5760,\"en\":\"Scientific workplace\",\"ru\":\"Научная лаборатория\"},{\"id\":6000,\"en\":\"Tram stop\",\"ru\":\"Остановка трамвая\"},{\"id\":6001,\"en\":\"Bus stop\",\"ru\":\"Остановка автобуса\"},{\"id\":6002,\"en\":\"Trolleybus stop\",\"ru\":\"Остановка тролейбуса\"},{\"id\":6506,\"en\":\"Tram stop\",\"ru\":\"Остановка трамвая\"},{\"id\":6507,\"en\":\"Bus stop\",\"ru\":\"Остановка автобуса\"},{\"id\":6508,\"en\":\"Trolleybus stop\",\"ru\":\"Остановка тролейбуса\"},{\"id\":6511,\"en\":\"Train station\",\"ru\":\"Ж/д станция\"},{\"id\":6512,\"en\":\"Train station\",\"ru\":\"Ж/д станция\"},{\"id\":6513,\"en\":\"Bus terminal\",\"ru\":\"Автовокзал\"},{\"id\":6519,\"en\":\"Ski lift station\",\"ru\":\"Станция канатной дороги\"},{\"id\":11425,\"en\":\"Mountain ridge\",\"ru\":\"Хребет\"},{\"id\":15118,\"en\":\"Administrative office\",\"ru\":\"Администрация\"}]","// extracted by mini-css-extract-plugin\nexport {};"],"sourceRoot":""}