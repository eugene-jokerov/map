{"version":3,"sources":["webpack:///./src/lib/CORSProxy/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/baseService.js","webpack:///./src/lib/xhr-promise/index.js","webpack:///./src/lib/leaflet.control.commons/index.js","webpack:///./src/lib/logging/index.js","webpack:///./src/config.js","webpack:///./src/lib/notifications/index.js","webpack:///./src/lib/binary-strings/index.js","webpack:///./src/lib/controls-styles/controls-styles.css","webpack:///./src/lib/leaflet.hashState/leaflet.hashState.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/gpx.js","webpack:///./src/lib/contextmenu/index.js","webpack:///./src/lib/safe-localstorage/index.js","webpack:///./src/lib/leaflet.layer.canvasMarkers/index.js","webpack:///./src/lib/leaflet.fixes/fixWorldCopyJump.js","webpack:///./src/vendored/github.com/eligrey/FileSaver.js","webpack:///./src/lib/leaflet.control.track-list/track-list.js","webpack:///./src/lib/leaflet.hashState/hashState.js","webpack:///./src/lib/leaflet.control.printPages/decorations.js","webpack:///./src/lib/clipboardCopy/index.js","webpack:///./src/lib/tiled-data-loader/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/parseGeoFile.js","webpack:///./src/lib/stripBom/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/loadFromUrl.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/nktk.js","webpack:///./src/lib/anyElementResizeEvent/index.js","webpack:///./src/lib/knockout.component.progress/progress.js","webpack:///./src/lib/leaflet.layer.rasterize/index.js","webpack:///./src/lib/leaflet.layer.rasterize/TileLayer.js","webpack:///./src/lib/leaflet.layer.yandex/index.js","webpack:///./src/lib/leaflet.layer.google/index.js","webpack:///./src/lib/leaflet.layer.westraPasses/westraPassesMarkers.js","webpack:///./src/lib/popup-window/index.js","webpack:///./src/lib/iconFromBackgroundImage/index.js","webpack:///./src/lib/leaflet.layer.rasterize/CanvasMarkers.js","webpack:///./src/lib/leaflet.polyline-measure/index.js","webpack:///./src/lib/leaflet.layer.RetinaTileLayer/index.js","webpack:///./src/lib/magnetic-declination/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/common/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/common/style.css","webpack:///./src/lib/leaflet.events.drag/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/xmlUtils.js","webpack:///./src/vendored/github.com/augustl/js-unzip/js-unzip.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/jsInflate.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/codePages.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/nakarte/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/urlSafeBase64.js","webpack:///./src/lib/leaflet.control.elevation-profile/index.js","webpack:///./src/lib/elevations/index.js","webpack:///./src/lib/leaflet.control.layers.top-row/index.js","webpack:///./src/index.js","webpack:///./src/index.css","webpack:///./src/App.js","webpack:///./src/App.css","webpack:///./src/leaflet-fixes.css","webpack:///./src/lib/leaflet.map.sidebars/index.js","webpack:///./src/lib/leaflet.map.sidebars/style.css","webpack:///./src/lib/leaflet.control.printPages/control.js","webpack:///./src/lib/knockout.component.progress/style.css","webpack:///./src/lib/leaflet.control.printPages/control.css","webpack:///./src/lib/leaflet.control.printPages/pageFeature.js","webpack:///./src/lib/leaflet.control.printPages/page-feature.css","webpack:///./src/lib/contextmenu/contextmenu.css","webpack:///./src/lib/leaflet.control.printPages/map-render.js","webpack:///./src/secrets.js","webpack:///./src/lib/leaflet.layer.rasterize/imgFromDataString.js","webpack:///./src/lib/leaflet.layer.rasterize/Bing.js","webpack:///./src/lib/leaflet.layer.bing/index.js","webpack:///./src/lib/leaflet.layer.rasterize/Yandex.js","webpack:///./src/lib/leaflet.layer.yandex/style.css","webpack:///./src/lib/leaflet.layer.rasterize/Google.js","webpack:///./src/lib/leaflet.layer.rasterize/WestraPasses.js","webpack:///./src/lib/leaflet.layer.westraPasses/index.js","webpack:///./src/lib/leaflet.layer.westraPasses/westraPasses.css","webpack:///./src/lib/leaflet.layer.geojson-ajax/index.js","webpack:///./src/lib/notifications/style.css","webpack:///./src/lib/leaflet.layer.canvasMarkers/canvasMarkers.css","webpack:///./src/lib/leaflet.layer.rasterize/MeasuredLine.js","webpack:///./src/lib/leaflet.polyline-measure/measured_line.css","webpack:///./src/lib/leaflet.layer.rasterize/RetinaTileLayer.js","webpack:///./src/lib/leaflet.control.printPages/form.html","webpack:///./src/lib/leaflet.control.printPages/pdf.js","webpack:///./src/lib/leaflet.control.commons/style.css","webpack:///./src/lib/leaflet.control.printPages/decoration.magnetic-meridians.js","webpack:///./src/lib/leaflet.control.printPages/decoration.scale.js","webpack:///./src/lib/leaflet.control.printPages/decoration.grid.js","webpack:///./src/lib/leaflet.control.caption/index.js","webpack:///./src/lib/leaflet.control.caption/style.css","webpack:///./src/lib/leaflet.control.coordinates/index.js","webpack:///./src/lib/leaflet.control.coordinates/coordinates.css","webpack:///./src/lib/clipboardCopy/style.css","webpack:///./src/lib/leaflet.control.coordinates/formats.js","webpack:///./src/lib/leaflet.control.layers.hotkeys/index.js","webpack:///./src/lib/leaflet.control.layers.hotkeys/style.css","webpack:///./src/lib/leaflet.hashState/Leaflet.Map.js","webpack:///./src/lib/leaflet.hashState/Leaflet.Control.Layers.js","webpack:///./src/lib/leaflet.fixes/index.js","webpack:///./src/lib/leaflet.fixes/style.css","webpack:///./src/adaptive.css","webpack:///./src/lib/leaflet.control.panoramas/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/google/index.js","webpack:///./src/lib/googleMapsApi/index.js","webpack:///./src/lib/leaflet.control.panoramas/style.css","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/mapillary-coverage-layer.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/mapillary-loader.js","webpack:///./src/lib/cache/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/mvt.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/vector_tile_pb.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/style.css","webpack:///./src/lib/leaflet.control.panoramas/lib/wikimedia/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/wikimedia/coverage-layer.js","webpack:///./src/lib/leaflet.control.panoramas/lib/wikimedia/style.css","webpack:///./src/lib/leaflet.control.panoramas/lib/mapycz/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapycz/apiLoader.js","webpack:///./src/lib/leaflet.control.track-list/track-list.css","webpack:///./src/lib/file-read/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/zip.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/kml.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/ozi.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/simpleService.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/endomondo.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/etomesto.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/gpsies.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/urlEncode.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/gpslib.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/osm.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/strava.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/tracedetrail.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/yandex.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/nktk_pb.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/nakarte/loadTracksFromJson.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/movescount.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/garmin.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/sportstracker.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/openstreetmapRu.js","webpack:///./src/lib/leaflet.control.track-list/lib/geo_file_exporters.js","webpack:///./src/lib/leaflet.lineutil.simplifyLatLngs/index.js","webpack:///./src/lib/leaflet.control.elevation-profile/elevation-profile.css","webpack:///./src/lib/leaflet.polyline-edit/index.js","webpack:///./src/lib/leaflet.polyline-edit/edit_line.css","webpack:///./src/lib/leaflet.control.track-list/lib/meridian180.js","webpack:///./src/lib/leaflet.control.track-list/control-ruler.js","webpack:///./src/lib/leaflet.control.track-list/ruler.css","webpack:///./src/lib/leaflet.control.track-list/track-list.hash-state.js","webpack:///./src/lib/leaflet.control.track-list/track-list.localstorage.js","webpack:///./src/lib/leaflet.control.layers.minimize/index.js","webpack:///./src/lib/leaflet.control.layers.minimize/style.css","webpack:///./src/lib/leaflet.control.layers.top-row/style.css","webpack:///./src/lib/leaflet.control.layers.configure/index.js","webpack:///./src/lib/leaflet.control.layers.configure/style.css","webpack:///./src/lib/leaflet.control.layers.configure/customLayer.js","webpack:///./src/lib/leaflet.controls.raise-on-focus/index.js","webpack:///./src/lib/leaflet.controls.raise-on-focus/style.css","webpack:///./src/layers.js","webpack:///./src/lib/leaflet.layer.soviet-topomaps-grid/index.js","webpack:///./src/lib/leaflet.layer.soviet-topomaps-grid/style.css","webpack:///./src/lib/leaflet.layer.wikimapia/index.js","webpack:///./src/lib/leaflet.layer.wikimapia/wikimapia-loader.js","webpack:///./src/lib/leaflet.layer.wikimapia/wm-utils.js","webpack:///./src/lib/leaflet.layer.wikimapia/style.css","webpack:///./src/lib/leaflet.control.layers.events/index.js","webpack:///./src/lib/leaflet.control.jnx/index.js","webpack:///./src/lib/leaflet.control.jnx/style.css","webpack:///./src/lib/leaflet.control.jnx/selector.js","webpack:///./src/lib/leaflet.control.jnx/jnx-maker.js","webpack:///./src/lib/leaflet.control.jnx/jnx-encoder.js","webpack:///./src/lib/leaflet.control.jnx/binary-stream.js","webpack:///./src/lib/leaflet.control.jnx/hash-state.js","webpack:///./src/lib/leaflet.control.azimuth/index.js","webpack:///./src/lib/leaflet.control.azimuth/control.html","webpack:///./src/lib/leaflet.control.azimuth/style.css","webpack:///./src/lib/leaflet.control.azimuth/pointer.svg","webpack:///./src/lib/leaflet.control.azimuth/pointer-start.svg","webpack:///./src/lib/leaflet.control.azimuth/pointer-end.svg","webpack:///./src/lib/leaflet.control.locate/index.js","webpack:///./src/lib/leaflet.control.locate/style.css","webpack:///./src/lib/leaflet.control.zoom-display/index.js","webpack:///./src/lib/leaflet.control.zoom-display/style.css","webpack:///./src/lib/leaflet.placemark/index.js","webpack:///./src/lib/leaflet.placemark/style.css"],"names":["url","config","CORSProxyUrl","replace","this","origUrl","Error","isOurUrl","requests","requestOptions","map","it","fetch","options","Promise","all","responses","name","error","parseResponse","decodeURIComponent","e","split","pop","promise","XMLHttpRequestPromise","send","successIfStatus200","xhr","status","retryIfNetworkErrorOrServerError","XMLHttpRequestPromiseError","message","method","data","responseType","timeout","maxTries","retryTimeWait","isResponseSuccess","responseNeedsRetry","headers","withCredentials","resolve","reject","_resolve","_reject","then","bind","postData","_isResponseSuccess","_responseNeedsRetry","_retryTimeWait","triesLeft","XMLHttpRequest","onreadystatechange","_onreadystatechange","_open","k","v","setRequestHeader","open","readyState","_aborted","responseBinaryText","response","byteLength","arrayBufferToString","responseJSON","JSON","parse","_timerId","setTimeout","clearTimeout","abort","XHRQueue","maxSimultaneousRequests","_maxConnections","_queue","_activeCount","_originalAbort","_abortPromise","push","_processQueue","i","indexOf","splice","length","shift","_onRequestReady","containerClass","title","iconClass","cls","container","L","DomUtil","create","makeButton","buttonContainer","link","icon","appendChild","barContainer","stopContainerEvents","DomEvent","disableClickPropagation","disableScrollPropagation","on","stop","noControlClass","href","preventDefault","Control","include","_stopContainerEvents","_container","msg","extra","window","location","toString","console","log","Sentry","withScope","scope","setExtras","captureMessage","description","setTag","setExtra","captureException","addBreadcrumb","eventName","randId","Math","random","substring","caption","defaultLocation","defaultZoom","googleApiUrl","secrets","google","westraDataBaseUrl","elevationsServer","wikimediaCommonsCoverageUrl","geocachingSuUrl","tracksStorageServer","onOk","alertify","alert","value","result","prompt","activeElement","document","tagName","blur","stringToArrayBuffer","s","buf","ArrayBuffer","arr","Uint8Array","charCodeAt","arBuf","chunk","subarray","String","fromCharCode","apply","join","Blob","Mixin","HashState","enableHashState","key","defaultInitialState","_hashStateKey","eventSource","stateChangeEventsSource","stateChangeEvents","forEach","event","_onControlStateChanged","hashState","addEventListener","state","_onExternalStateChanged","getState","unserializeState","updateState","serializeState","logging","txt","preferNameFromFile","dom","getSegmentPoints","segment_element","points_elements","getElementsByTagName","points","point_element","lat","parseFloat","getAttribute","lng","isNaN","getRoutePoints","rte_element","DOMParser","parseFromString","documentElement","nodeName","trkName","xmlGetNodeText","tracks","xml","segments","segments_elements","segment_points","getTrackSegments","concat","routes","rte_elements","rte_points","getRoutes","waypoint_elements","waypoints","waypoint_element","waypoint","wptName","symbol_name","getWaypoints","items","keyCode","hide","parent","child","parentNode","isDescendant","target","originalEvent","returnValue","x","clientX","y","clientY","createElement","body","className","style","zIndex","onKeyDown","onMouseDown","createItems","item","setPosition","removeChild","removeEventListener","window_width","innerWidth","window_height","innerHeight","menu_width","offsetWidth","menu_height","offsetHeight","left","top","itemOptions","separator","createSeparator","createItem","el","disabled","header","innerHTML","text","callback","onItemClick","stopPropagation","storage","localStorage","setItem","getItem","localStorageWorks","_storage","n","Object","keys","removeItem","clear","calcIntersectionSum","rect","rects","right","bottom","rect2","sum","max","minX","min","maxX","minY","maxY","MarkerRBush","marker","latlng","a","b","RBush","Layer","CanvasMarkers","GridLayer","extend","async","labelFontName","labelFontSize","iconScale","pane","updateWhenZooming","Browser","mobile","iconsOpacity","labelShadowWidth","initialize","markers","prototype","call","rtree","_regions","_iconPositions","_labelPositions","_labelPositionsZoom","addMarkers","_images","_tileQueue","_hoverMarker","onMarkerEnter","onMarkerLeave","load","resetLabels","redraw","addMarker","insert","removeMarker","removeMarkers","remove","updateMarkers","updateMarker","setMarkerPosition","getMarkers","findLabelPosition","iconCenter","iconSize","textWidth","textHeight","pixelExtents","xPositions","yPositions","minIntersectionSum","Infinity","bestX","bestY","tileW","tileE","tileN","tileS","intersectionSum","search","preloadIcons","urls","newUrls","filter","images","image","src","createTile","coords","done","canvas","width","tileSize","height","drawTile","selectMarkersForDraw","zoom","withoutPadding","_map","iconsHorPad","iconsVertPad","labelsHorPad","labelsVertPad","iconsBounds","latLngBounds","unproject","point","labelsBounds","iconUrls","markerJobs","pointsForMarkers","getWest","getSouth","getEast","getNorth","pointsForLabels","tileMidLongitude","noWrap","wrapLatLngToTarget","p","project","stamp","projectedXY","drawSelectedMarkers","limitLabelsToImage","ctx","getContext","font","Util","template","size","entries","markerId","job","img","imgW","round","imgH","center","isLabel","label","measureText","regionsInTile","region","textBaseline","shadowColor","strokeStyle","fillStyle","lineWidth","shadowBlur","strokeText","fillText","globalAlpha","drawImage","z","findMarkerFromMouseEvent","wrap","onMouseMove","fire","showTooltip","tooltip","toolTip","latLngToLayerPoint","addClass","cursor","removeClass","onMouseOut","onClick","clickLocked","onRightClick","onAdd","getPane","createPane","getPanes","markerPane","onRemove","off","Polyline","shiftProjectedFitMapView","polylineBounds","getBounds","isValid","worldWidth","getPixelWorldBounds","getSize","polylineCenter","getCenter","mapCenter","_projectLatlngs","latlngs","projectedBounds","ring","flat","LatLng","len","projectedShift","Marker","update","_icon","pos","_latlng","_setPos","Map","addInitHook","_lastResetLongitude","abs","Handler","MarkerDrag","_onDrag","_marker","shadow","_shadow","iconPos","getPosition","layerPointToLatLng","oldLatLng","_oldLatLng","targetLng","shiftLongitudeToTarget","p1","getSouthEast","p2","getNorthWest","LatLngBounds","latLng","saveAs","view","navigator","test","userAgent","doc","get_URL","URL","webkitURL","save_link","createElementNS","can_use_save_link","is_safari","HTMLElement","safari","is_chrome_ios","setImmediate","throw_outside","ex","revoke","file","revokeObjectURL","auto_bom","blob","type","FileSaver","no_auto_bom","object_url","filesaver","force","dispatch_all","event_types","listener","dispatch","INIT","createObjectURL","node","download","MouseEvent","dispatchEvent","DONE","FileReader","reader","onloadend","undefined","readAsDataURL","fs_error","FS_proto","msSaveOrOpenBlob","WRITING","onwritestart","onprogress","onwrite","onabort","onerror","onwriteend","self","TRACKLIST_TRACK_COLORS","TrackSegment","MeasuredLine","includes","EditMixin","weight","lineCap","opacity","closestPointToLineSegment","segmentIndex","crs","CRS","EPSG3857","latLngToPoint","segStart","segEnd","pointToLatLng","LineUtil","closestPointOnSegment","isPointCloserToStart","distanceTo","mergeOptions","EditMixinOptions","TrackList","position","lineCursorStyle","interactive","dashArray","lineCursorValidStyle","color","lineCursorInvalidStyle","splitExtensions","splitExtensionsFirstStage","Evented","colors","ko","observableArray","observable","readingFiles","readProgressRange","readProgressDone","_lastTrackColor","trackListHeight","isPlacingPoint","trackAddingPoint","trackAddingSegment","removeAll","applyBindings","addListener","getContainer","onFileDragDrop","onFileDraging","menu","Contextmenu","copyAllTracksToClipboard","copyVisibleTracks","deleteAllTracks","deleteHiddenTracks","_markerLayer","print","scaleDependent","printTransparent","addTo","onMarkerClick","_setAdaptiveHeight","defaultEventHandle","_","maxHeight","offsetTop","setExpanded","setMinimized","dataTransfer","dropEffect","files","loadFilesFromFilesObject","onEnterPressedInInput","this_","loadFilesFromUrl","getTrackPolylines","track","feature","getLayers","layer","getTrackPoints","onButtonNewTrackClicked","trim","addTrackAndEdit","addSegmentAndEdit","stopPlacingPoint","segment","addTrackSegment","startEditTrackSegement","startDrawingLine","addTrack","readFiles","fileDataArray","geodataArray","fileData","filename","addTracksFromGeodataArray","loadFilesFromDisk","captureBreadcrumb","selectFiles","trackUrl","geodata","whenLoadDone","cb","subscription","subscribe","dispose","geodata_array","hasData","messages","data_empty","line","latngs","lastUnwrapped","unwrapped","prevUnwrapped","unwrapLatLngsCrossing180Meridian","simplifyLatlngs","CORRUPT","UNSUPPORTED","NETWORK","INVALID_URL","notify","onTrackColorChanged","polyline","setStyle","setMarkerIcon","onTrackVisibilityChanged","visible","addLayer","removeLayer","updateTrackHighlight","onTrackSegmentNodesChanged","getFixedLatLngs","recalculateTrackLength","getLength","formatLength","digits","toFixed","setTrackMeasureTicksVisibility","measureTicksShown","setMeasureTicksVisible","switchMeasureTicksVisibility","onColorSelectorClicked","_contextmenu","show","setViewToTrack","setViewToBounds","getTrackBounds","setViewToAllTracks","immediate","bounds","wrapLatLngBoundsToTarget","fitBounds","maxZoom","flyToBounds","lines","l","getLatLngs","attachColorSelector","index","attachActionsMenu","renameTrack","duplicateTrack","reverseTrack","showElevationProfileForTrack","removeTrack","saveTrackAsFile","geoExporters","saveGpx","saveKml","copyTrackLinkToClipboard","saveGpxWithElevations","_actionsMenu","onButtonAddSegmentClicked","stopEditLine","reverseTrackSegment","trackSegment","stopDrawingLine","ll","reverse","isEdited","_editedLine","deleteTrackSegment","newTrackSegment","_parentTrack","that","copyTracksLinkToClipboard","mouseEvent","serialized","trackToString","hashDigest","btoa","responseText","exporter","extension","addElevations","splitLinesAt180Meridian","extensions","lastIndexOf","slice","toLowerCase","request","reduce","acc","cur","ElevationProvider","get","elevations","alt","fileText","blobFromString","newName","query","showTrackMenu","showMenu","stopEdit","onTrackSegmentClick","_lineJoinActive","joinTrackSegments","startEdit","once","onLineEditEnd","onButtonAddPointClicked","beginPointCreate","_beginPointEdit","stopPlacingPointOnEscPressed","beginPointMove","_movingMarker","movePoint","createNewPoint","newLatLng","getNewPointName","maxNumber","match","parseInt","padStart","parentTrack","suggested","suggestedPoint","addPoint","renamePoint","newSegment","joinToStart","hideLineCursor","originalSegment","latngs2","_lineJoinFromStart","unshift","userCancelled","sourcePoints","onNodeRightClickShowMenu","onSegmentRightClickShowMenu","onTrackMouseEnter","onTrackMouseLeave","onTrackEditStart","onTrackEditEnd","onTrackSegmentDrawEnd","nodeIndex","splitTrackSegment","startLineJoinSelection","startShortCutSelection","newTrackFromSegment","showElevationProfileForSegment","showLineCursor","start","mousepos","_lineCursor","clone","onMouseMoveOnMapForLineCursor","onKeyUpForLineCursor","preventStopEdit","updateLineCursor","cursorStart","onLineCursorHideForJoin","onMouseMoveOnLineForJoin","disableEditOnLeftClick","cursorEnd","startFromNode","_shortCut","startNodeIndex","startLatLng","nodeMarkers","onMouseMoveOnNodeMarkerForShortCut","segmentOverlays","onMouseMoveOnLineSegmentForShortCut","onMouseMoveOnMapForShortCut","onClickNodeMarkerForShortCut","onClickLineSegmentForShortCut","onLineCursorHideForShortCut","updateShortCutSelection","highlighNodesForDeletion","endAtNode","getShortCutNodes","firstNodeToDelete","lastNodeToDelete","rangeValid","shortCutSegment","endNodeIndex","newNodes","spliceLatLngs","hover","onTrackRowMouseEnter","_highlightedTrack","onTrackRowMouseLeave","latlngs1","latlngs2","segment1","srcNodes","trackHidden","featureGroup","touch","bindTooltip","sticky","delay","_trackHighlight","removeFrom","trackHighlight","eachLayer","bringToBack","setMarkerLabel","srcPoint","removePoint","newLabel","forceVisible","saveToString","exportTracks","minTicksIntervalMeters","capturedTrack","pl","capturedBounds","measureTicks","getTicksPositions","hideElevationProfile","_elevationControl","ElevationProfile","samplingInterval","calcSamplingInterval","path","hasTracks","arrayItemsEqual","l1","l2","parseHashParams","args","m","substr","pair","exec","onChange","_listeners","_state","c","values","_saveStateToHash","hasKey","hasOwnProperty","stateItems","hash","origin","pathname","_ignoreChanges","onHashChanged","newState","changedKeys","PrintStaticLayer","printOptions","iterateTilePromises","tilePromise","draw","_drawRaster","isOverlay","overlaySolid","abortLoading","count","_unused_canvas","_unused_printOptions","ta","success","select","execCommand","w","h","showNotification","TiledDataLoader","cacheSize","_cache","Cache","_pendingRequests","_xhrQueue","dataTileCoords","makeTileKey","res","layerTileCoords","_unused_dataTileCoords","_unused_xhr","_unused_originalDataTileCoords","multiplier","offsetX","offsetY","layerTileToDataTileCoords","getFromCache","found","dataPromise","tileData","adjustment","calcAdjustment","dataTileKey","makeRequestData","fetchPromise","put","processResponse","pendingRequest","refCount","parsers","parsed","services","ServiceClass","service","geoData","trackView","shown","ticksShown","deltaEncodedSegments","deltaEncodeSegment","deltaLats","deltaLons","lats","lons","midLon","midLat","wp","arcUnit","packedWaypoints","lon","pbf","Pbf","versionStr","TrackView","write","finish","urlSafeBase64","encode","decode","parseNktkOld","parseNktkFragment","PackedStreamReader","_string","lastLon","lastLat","deltaLon","deltaLat","version","segmentsCount","pointsCount","midX","midY","waypointName","wayPoints","readNumber","readString","utf8","j","Boolean","parseNktkProtobuf","read","encodedLat","encodedLon","deltaDecodeSegment","unpackNumber","element","ResizeObserver","observe","setInterval","newWidth","newHeight","components","register","viewModel","params","progress","pureComputed","range","progressRange","progressDone","fullSize","pixelBounds","add","divideBy","assign","visibility","fadeAnimation","zoomAnimation","inertia","setView","noop","GridLayerGrabMixin","tileImagePromiseFromCoords","_unused_coords","waitTilesReadyToGrab","getTilesInfo","tileRange","_pxBoundsToTileRange","topLeft","tilePromiseIterator","Point","_tileZoom","_isValidTile","tilePos","_getTilePos","coordsPlusOne","tilePlusOne","subtract","_level","_wrapCoords","TileLayerGrabMixin","cloneForPrint","tileLayer","_url","xhrOptions","getTileUrl","noCors","xhrQueue","rawData","imgFromDataString","TileLayer","yandexCrs","EPSG3395","Yandex","subdomains","retina","yandexScale","tilePosLatLng","scaleBy","getTileSize","bounds2","Bounds","tile","coordsBelow","_adjustHeight","_initTile","Sat","Tracks","minZoom","maxNativeZoom","GoogleBase","_getZoomForUrl","_getSubdomain","lang","language","GoogleMap","GoogleTerrain","GoogleHybrid","GoogleSat","WestraPassesMarkers","filePasses","baseUrl","showPassDescription","_baseUrl","loadData","_downloadStarted","_loadMarkers","_makeTooltip","properties","grade","elevation","is_summit","_passToGpx","gpx","_passToKml","kml","_makeIcon","grade_eng","features","latlon","_dataLoaded","reports","id","altnames","connects","comments","comment","user","content","reports_total","reports_photo","reports_tech","slopes","author","openPopup","maxWidth","getElementById","onclick","openPopupWindow","uniqName","screenLeft","screen","availLeft","bordersWidth","screenX","outerWidth","availWidth","screenY","newWindow","closed","focus","f","cache","getComputedStyle","backgroundImage","offsetLeft","arg","_printProgressWeight","cloneMarker","cloneMarkers","printIconsOpacity","resolution","scale","destPixelSize","getTopRight","getBottomLeft","dummyMap","minTicksIntervalMm","_ticks","updateTicks","updateTicksLater","_clearTicks","tick","_addTick","transformMatrixString","transformMatrix","childNodes","transform","setLatLng","labelText","distanceValue","divIcon","html","keyboard","step","ticks","addTick","normalizedBounds","wrapLatLngBounds","normalizedPosition","positionMinus360","positionPlus360","contains","sinCos","dx","dy","sqrt","sinCosFromLatLonSegment","sin","cos","nextPointMeasure","q","lastTickMeasure","lastPointMeasure","_latlngs","points_n","pad","rad","PI","mercatorMetersPerPixel","referencePoint","mapScale","oldTicks","oldMarker","measuredLine","RetinaTileLayer","tileSizeMultiplicator","hiRes","useHiResTiles","newOptions","retinaOptionsOverrides","declination","minLat","maxLat","row1","floor","row2","dlat","col1","col2","dlon","colsCount","a1","getArrayValue","a2","v1","rowsCount","row","col","ind","ar1","atob","array","ar2","Float32Array","valueScale","offset","valueOffset","CloseButtonMixin","createCloseButton","closeButton","onCloseClick","DateLabelMixin","createDateLabel","dateLabel","updateDateLabel","timestamp","d","Date","getDate","getMonth","getFullYear","DragEvents","dragTolerance","dragButtons","stopOnLeave","setOptions","dragButton","startEvent","prevEvent","isDragging","button","disableImageDrag","disableTextSelection","_moveHandler","onMouseUp","onMouseLeave","fireDragEvent","finishDrag","tolerance","prevPos","dragMovement","enableImageDrag","enableTextSelection","Array","nodeValue","JSUnzip","fileContents","BigEndianBinaryStream","MAGIC_NUMBER","readEntries","isZipFile","ZipEntry","getByteRangeAsNumber","binaryStream","signature","getNextBytesAsNumber","versionNeeded","bitFlag","compressionMethod","timeBlob","isEncrypted","crc32","compressedSize","uncompressedSize","isUsingZip64","fileNameLength","extraFieldLength","fileName","getNextBytesAsString","isUsingBit3TrailingDataDescriptor","isUsingUtf8","escape","stream","resetByteIndex","currentByteIndex","getByteAt","steps","getByteRangeAsString","charCode","compressed","originalSize","out","s2","flattenArray","ar","parsePointFromHashValues","NakarteTrack","parseTrackUrlData","BaseService","NakarteUrlLoader","loaders","nktk","loadFromTextEncodedTrack","nktl","loadFromTextEncodedTrackId","nktu","loadFromUrlencodedUrls","nktp","loadPoint","nktj","loadFromJSON","paramName","loader","trackId","r","parseNktkSequence","loadTracksFromJson","loadFromUrl","NakarteUrl","paramNames","_params","promises","decoded","samplingIntgerval","createSvg","attributes","setAttribute","gradientToAngle","g","atan","Class","sightLine","samples","lastSampleDist","lastPointDistance","nextPointDistance","pathRegularSamples","horizZoom","dragStart","_addTo","_onWindowResize","_resizeGraph","newSvgWidth","drawingContainer","clientWidth","svgWidth","svg","updateGraph","updateGraphSelection","_controlContainer","setupContainerLayout","trackMarker","onLineMouseMove","onLineMouseEnter","onLineMouseLeave","polyLineSelection","propsContainer","leftAxisLables","onCloseButtonClick","graphCursor","graphCursorLabel","graphSelection","svgHeight","clientHeight","onSvgMouseMove","onSvgEnter","onSvgLeave","onSvgMouseWheel","svgDragEvents","onSvgDragStart","onSvgDragEnd","onSvgDrag","onSvgClick","onSvgDblClick","selStartIndex","roundedSampleIndexFromMouseEvent","graphContainerOffsetFromMouseEvent","getBoundingClientRect","sampleIndexFromMouseEvent","setTrackMarkerLabel","getElementsByClassName","setGraphSelection","cursorIndex","selMinInd","selMaxInd","selStart","selEnd","cursorShow","stats","calcProfileStats","updatePropsDisplay","scrollLeft","setLatLngs","setMapPositionAtIndex","panTo","oldHorizZoom","getWheelDelta","newScrollLeft","setupGraph","cursorHide","setCursorPosition","noData","maxElev","minElev","startElev","endElev","change","ascentAngleStr","descentAngleStr","ascent","descent","startApprox","endApprox","approx","incomplete","end","finalAscent","angleAvgAscent","avg","angleMaxAscent","angleAvgDescent","angleMaxDescent","dist","distance","dataLostAtStart","dataLostAtEnd","dataLost","calcGridValues","minValue","maxValue","ticksN","tickStep","tick1","ticksNs","tickSteps","matchFound","ceil","filterElevations","scanStart","scanEnd","linearValue","linearDelta","maxError","maxErrorInd","filtered","queue","notNullValues","firstNotNullValue","lastNotNullValue","firstNotNullIndex","lastNotNullIndex","ascents","descents","prevNotNullValue","prevNotNullIndex","gradient","gradientAvgAscent","gradientMinAscent","gradientMaxAscent","angleMinAscent","gradientAvgDescent","gradientMinDescent","gradientMaxDescent","angleMinDescent","delta","angleStr","distanceStr","sample1","sample2","indInt","markerPos","elevationStr","cursorLabel","indFrac","sqrDist","latlng1","latlng2","di","nextDist","nextSampleDist","prevDist","prevSampleDist","nearestInd","minDist","mouseLatlng","hasChildNodes","lastChild","horizStep","verticalMultiplier","gridValues","gridStep","x1","x2","valueToSvgCoord","startNewSegment","y1","y2","serverUrl","chunkSize","respValues","control","originalOnAdd","_topRowEnabled","__injectTopRow","_topRow","_section","insertBefore","uid","preconnect","preconnectLink","rel","head","dnsPrefetchLink","init","dsn","sentryDSN","release","RELEASE_VER","cookieUid","cookie","uidRaw","toUpperCase","getUid","configureScope","setUser","App","setUp","startInfo","localStorageKeys","safeLocalStorage","fixAll","MapWithSidebars","zoomControl","attributionControl","inertiaMaxSpeed","worldCopyJump","tracklist","Caption","ZoomDisplay","getPlacemarkHashStateInterface","Coordinates","locateControl","LocateControl","showError","code","customMessage","locationErrorMessage","validateState","validPositionInHash","valid","moveMapToCurrentLocation","layersControl","layers","collapsed","trackNames","tracksHashParams","hashParams","hasTrackParamsInHash","param","loadTracksFromStorage","tracksAfterLoadFromStorage","bindHashStateReadOnly","loadTrackFromParam","tracksAfterLoadFromHash","logEvent","saveTracksToStorage","0","1","2","_sidebarsContainer","setupSidebarsLayout","_mapContainer","onElementResize","requestAnimFrame","invalidateSize","_sidebarContainers","sidebars","midColumn","addElementToSidebar","barName","removeElementFromSidebar","extenders","checkNumberRange","newValue","notifySubscribers","PrintPages","defaultMargin","pageSizes","zoomLevels","pages","zoomLevel","pageWidth","pageHeight","settingsExpanded","makingPdf","downloadProgressRange","downloadProgressDone","marginLeft","marginRight","marginTop","marginBottom","autoZoomLevels","printSize","_printSize","onPageSizeChanged","pageSizeDescription","_displayPageSize","pagesNum","pagesNumLabel","_pagesNumLabel","gridOn","magneticMeridiansOn","notifyChange","updateFormZooms","formHtml","addPage","isLandscape","page","PageFeature","_rotated","cm","makePageContexmenuItems","rotatePage","addLandscapePage","addPortraitPage","removePage","setLabel","removePages","onSavePdfClicked","savePdf","zoomForPrint","suggestZooms","mapZoom","satZoom","incrementProgress","inc","getLatLngBounds","getPrintSize","getLabel","decorationLayers","Grid","MagneticMeridians","OverlayScale","eventId","zooms","action","renderPages","progressCallback","renderedLayers","getFileName","imagesInfo","pdf","makePdf","savePagesPdf","savePageJpg","pageNumber","setSize","onPagesNumLabelClick","renumberPage","rotate","newIndex","oldIndex","referenceLat","absLats","targetMetersPerPixel","mapUnitsPerPixel","LN2","hasPages","getLatLng","flags","rotated","opaqueLayer","transparentOverlayLayers","appendLayerShortName","shortName","isOverlayTransparent","currentPageSize","find","pageSize","centerLatLng","paperSize","draggable","updateView","rectangle","fillOpacity","_getLatLngBounds","centerMerc","Projection","SphericalMercator","mercatorScale","Earth","R","mercatorPageSize","multiplyBy","sw","ne","_animateZoom","newZoom","getZoom","pixel_sw","getSouthWest","pixel_ne","getNorthEast","pixel_center","st","pixel_width","pixel_height","fontSize","lineHeight","setBounds","getLayersForPrint","getZIndex","compare","i1","i2","getLayerZOrder","_path","TypeError","order","meta","sort","layer1","layer2","compareArrays","PageComposer","destSize","pixelBoundsAtZoom24","currentCanvas","currentZoom","currentTileScale","targetCanvas","createCanvas","tileInfo","tileScale","mergeCurrentCanvas","setupCurrentCanvas","dest","s_data","getImageData","sr","sg","sb","sa","sa1","dr","dg","db","d_image_data","d_data","data_length","putImageData","blendMultiplyCanvas","dataUrl","toDataURL","iterateLayersTiles","pageLabel","pagesCount","defaultXHROptions","_layerDummy","getTempMap","_rasterizeNeedsFullSizeMap","layerPromises","progressInc","doStop","disposeMap","promiseQueueBuffer","source","maxActive","next","pageImagesInfo","Set","composer","tilesIterator","queuedTilesIterator","putTile","getDataUrl","bingKey","thunderforestKey","mapillary","flickr","Image","blobUrl","onload","BingLayer","clearInterval","_key","tile2quad","quad","digit","mask","attribution","culture","_providers","metaRequested","tilePoint","loadMetadata","cbid","errorDetails","initMetadata","urlScheme","script","resourceSets","resources","imageUrlSubdomains","imageUrl","imageryProviders","coverageAreas","coverage","zoomMin","zoomMax","active","bbox","attrib","_update","_update_attribution","intersects","addAttribution","removeAttribution","tilesInfo","WestraPasses","waitDataReady","fileCoverage","fileLabels1","fileLabels2","labels2Zoom","markersZoom","labels1Zoom","markersOptions","GeoJSONAjax","onEachFeature","_setEventsForRegion","labels1","pointToLayer","_makeMarker","labels2","_onRegionClick","geojsonPoint","setLayersVisibility","zoomFinished","GeoJSON","requestTimeout","_loadStarted","addData","printWidthMm","_makelatLngToCanvasPixelTransformer","unscaleBy","_shift","targetBounds","getProjectedBounds","targetCenter","projected","lineBounds","lineJoin","beginPath","moveTo","lineTo","stroke","tickFontSizeMm","ticksPixelSize","setTransform","recPage","serialNum","pageRecId","contentRecId","imageRecId","recContent","contents","recImage","widthPixels","heightPixels","offsets","addRec","skipOffset","kidsIds","recPages","widthPoints","heightPoints","recOffsets","currentOffset","trailer","padding","recTrailer","angle","pixel","toLatLng","_makeCanvasToLatLngTransformer","lineThicknessMm","intervalPx","lineIntervalMm","samplingPx","samplingIntervalMm","pageDiagonal","maxSegments","drawLine","directionDown","getDeclination","maxLines","formatScale","nominalScale","scaleRange","unit","southLen","northLen","nScale","sScale","pageScaleRange","fontSizeMm","paddingMm","fillRect","intervalM","minGridIntervalM","minGridIntervalMm","intervals","metersPerDegree","pixelsPerMm","getGridInterval","mercatorBounds","canvasToMercatorScale","rows","yMerc","lat2","yMerc2","lineWidthPx","pageCanvasCenterX","direction","colN","firstRow","hasPointInPage","formatDistance","_drawGrid","_drawLabel","_contents","setContents","DEFAULT_FORMAT","formats","DEGREES","UNKNOWN_COORDINATES","SIGNED_DEGREES","DEGREES_AND_MINUTES","DEGREES_AND_MINUTES_AND_SECONDS","format","formatCode","formattedCoordinates","formatLatLng","wrapperClass","saveStateToStorage","makeButtonWithBar","_link","loadStateFromStorage","leafletCoordinatesActive","leafletCoordinatesFmt","setEnabled","isEnabled","enabled","classFunc","eventFunc","onMapRightClick","_isEnabled","coordinates","truncToFixed","precision","sliceEnd","padEnd","formatNumber","coordinatePresentations","coordinate","isLat","degrees","intDegrees","minutes","intMinutes","seconds","signedDegrees","formatter","getLayerHotkey","hotkey","extendLayerName","originalOnRemove","originalAddItem","_addItem","_hotKeysEnabled","obj","_addHotketEvents","_onHotkeyUp","_addHotKetEvents","altKey","ctrlKey","shiftKey","_keyDown","pressedKey","targetTag","_layers","layerId","inputs","_form","input","click","Layers","k1","k2","hasBaselayer","overlay","chrome","PosAnimation","__panAnimationFixed","originalStep","_step","fixPanAnimationBug","pointerEnabled","ie","maxTouchPoints","originalHandleDOMEvent","_handleDOMEvent","_fireDOMEvent","Renderer","__animationFixed","resetInterval","originalGetEvents","getEvents","onZoom","now","_lastReset","_reset","_onZoom","onMove","move","fixVectorDrawWhileAnimation","fixVectorMarkerWorldJump","original_addTo","stackHorizontally","origOpenTooltip","_openTooltip","_tooltip","_pendingTooltip","origCloseTooltip","closeTooltip","addTooltipDelay","PanoMarker","zIndexOffset","getIcon","markerIcon","getElement","children","setHeading","setType","markerType","slim","normal","Panoramas","splitVerically","splitSizeFraction","minViewerSize","getProviders","provider","googleProvider","layerOptions","selected","mapMarkerType","wikimediaProvider","mapillaryProvider","mapyczProvider","loadSettings","_panoramasContainer","onContainerResize","providers","updateCoverageVisibility","nearbyPoints","storedSettings","panoramaSettings","_splitVerically","spitVertically","fraction","_splitSizeFraction","saveSetting","stringify","_splitterDragging","splitter","splitterButton","trackOutsideElement","dragstart","onSplitterDragStart","dragend","onSplitterDragEnd","drag","onSplitterDrag","onSplitterClick","setupViewerLayout","onMapResize","onButtonClick","onKeyUp","minSize","oldSize","newSize","mapSize","maxSize","setContainerSizePixels","switchControl","controlEnabled","disableControl","enableControl","codePointAt","onMapClick","notifyChanged","hidePanoViewer","coverageLayer","getCoverageLayer","showPanoramaContainer","panoramaVisible","hasClass","setupNearbyPoints","hidePano","viewer","deactivate","showPano","otherProvider","getViewer","setupViewerEvents","activate","onPanoramaChangeView","closeclick","onPanoramaCloseClick","hideMarker","placeMarker","heading","searchRadiusMeters","getPanoramaAtPos","searchResult","sidebar","updateContainerSize","containerSize","coverageCode","viewerState","setState","hashStateUpgrader","panoramasControl","oldState","upgradedState","getStreetViewService","maps","StreetViewService","getPanorama","radius","preference","StreetViewPreference","NEAREST","StreetViewStatus","OK","Viewer","panorama","StreetViewPanorama","enableCloseButton","imageDateControl","motionTracking","motionTrackingControl","throttle","_invalidateSize","setZoom","_active","pov","getPov","pitch","setVisible","setPov","trigger","_google","_pending","getMapillary","require","resp","component","cover","bearing","resize","onNodeChanged","onBearingChanged","_bearing","_zoom","_center","moveToKey","updateZoomAndCenter","_node","fireChangeEvent","capturedAt","getBearingCorrection","computedCA","originalCA","originalLatLon","_pitch","activateCover","_updateHandler","getBearing","deactivateCover","center0","center1","moveCloseTo","setCenter","MapillaryCoverage","updateWhenIdle","MapillaryLoader","onTileUnload","_abortLoading","_tileData","_adjustment","drawOverview","canvasCtx","geometry","arc","fill","drawSequences","lineI","pointI","drawImages","requestTileData","z2","originalDataTileCoords","_processResponse","decodeMvt","_maxSize","_store","_size","tileExtent","TileProto","parsedLayers","extent","parseFeatures","decodeCoordinate","parseGeometry","geometryType","ints","coordinatesScale","GeomType","POINT","LINESTRING","POLYGON","lineStrings","cmd","cmdRepeat","cmdN","Tile","exports","readFields","_readField","tag","readVarint","Feature","tags","readPackedVarint","parseSearchResponse","iinfo","imageinfo","imageDescription","extmetadata","ImageDescription","objectDescription","ObjectName","Artist","descriptionurl","thumburl","timeOriginal","DateTimeOriginal","time","DateTime","pageUrl","pageId","pageid","isCloser","d1","d2","clusterSize","photos","nearestLatlng","photo","formatDateTime","dateStr","year","month","day","mapContainer","pageButtonContainer","maxBoundsViscosity","Simple","zoomSnap","infoLabel","prevPhotoButton","nextPhotoButton","switchPhoto","_imageIdx","setupPageButtons","_buttons","imageIdx","imagePos","imageLayer","log2","southWest","northEast","setMaxZoom","setMaxBounds","animate","imageOverlay","setUrl","_showPano","MultiLayer","tms","WikimediaVectorCoverage","WikimediaLoader","urlTemplate","Uint16Array","dataOffset","pixelScale","getSMap","smap","Pano","getBest","Coords","fromWGS84","orig_windowAddEventListener","Scene","yaw","getCamera","setCamera","fov","updatePositionAndView","camera","place","getPlace","getCoords","toWGS84","syncPort","oldPlaceId","_placeId","oldHeading","_heading","getId","placeIdChanged","headingChanged","loaderUrl","Loader","pano","SMap","loadApi","readFile","fileInput","multiple","display","readAsArrayBuffer","parseKmz","parseZip","parseGpx","parseOziRte","parseOziPlt","parseOziWpt","parseKml","_unused_name","unzipper","uncompressed","entry","file_name","decode866","hasDocKml","coordinates_element","points_strings","placemarks","coord","pointObjs","nameTags","getPoints","expected_points_num","current_segment","total_points_num","fields","is_start_of_segment","currentSegment","pointName","decodeCP1251","YandexRuler","Endomondo","Etomesto","Gpsies","Gpslib","Osm","Strava","Tracedetrail","MovescountMove","MovescountRoute","GarminActivity","GarminRoute","SportsTrackerActivity","OpenStreetMapRu","SimpleService","nameFromUrl","responseURL","urlRegexps","some","re","userId","latitude","longitude","date","local_start_time","trackName","urlRe","getTrackId","startsWith","fileId","speed","dataType","filetype","submitButton","inappropriate","encodeURIComponent","pageResponse","trackResponse","401","404","isArray","userName","querySelector","textContent","activityTitle","nom_fr","proj","last_lat","last_lng","points_str","Segment","readPackedSVarint","writePackedSVarint","Waypoint","readSVarint","writeSVarintField","writeStringField","Waypoints","writeMessage","Track","View","readBoolean","writeVarintField","writeBooleanField","parseWaypoint","rawPoint","Number","lt","ln","parseTrack","rawTrack","rawSegment","errCorrupt","jsonString","geoDataArray","u","t","viewProps","MovescountBase","latitudes","longitudes","routeName","TrackPoints","trackPoint","Latitude","Longitude","GarminBase","coursePoints","pt","geoPoints","courseName","geoPolylineDTO","activityId","metadata","dataResponse","metadataResponse","payload","locations","la","startTime","toDateString","fullname","withElevations","fakeTime","simplify","_nodeMarkersZOffset","_editing","_drawingDirection","setupMarkers","onMapEndDrag","onKeyPress","_storedStyle","_nodeMarker","_lineNode","_segmentOverlay","getMarkerIndex","getSegmentOverlayIndex","segmentOverlay","onNodeMarkerDragEnd","replaceNode","_setupEndMarkers","onNodeMarkerMovedChangeNode","onNodeMarkerDblClickedRemoveNode","_disableEditOnLeftClick","removeNode","newNodeIndex","refNodeIndex","addNode","handler","dragging","_draggable","mousePos","_startPoint","_newPos","_startPos","mouseEventToLatLng","onMouseMoveFollowEndNode","makeNodeMarker","onNodeMarkerClickStartStopDrawing","latlngs_n","makeSegmentOverlay","onSegmentMouseDownAddNode","midPoint","Draggable","_dragging","_onDown","nodes","isAddingLeft","isAddingRight","prevNode","oldNode","nodesCount","startIndex","endIndex","startIcon","endIcon","startNode","endNode","disable","latLngs","wrappedLatLngs","newLines","newLine","prevLatLng","positiveLng","wrapNum","positivePrevLng","splitLng","sign","splitPrevLng","splitLat","getSegmentSplitPointLat","splitPrevLat","splitLineAt180Meridian","latLng1","latLng2","deltaLng","Ruler","trackList","_trackList","notEmpty","maxLocalStorageSessions","maxKey","_minimizeEnabled","__injectMinimizeButtons","contentsWrapper","minimizeButton","expandButton","originalUnserializeState","_configEnabled","_allLayersGroups","_allLayers","group","_initializeLayersState","updateEnabledLayers","addedLayers","hasBaselayerOnMap","enabledLayers","_justAdded","addOverlay","addBaseLayer","hasLayer","CustomLayer","z_1","x_1024","y_1024","infinite","invertedY","_globalTileRange","elements","querySelectorAll","raise","cornerDiv","layersDefs","grouppedLayers","isDefault","jnx","SovietTopoGrid","Wikimapia","zeroPad","num","bigLetterReplacers","Nomenclature","getQuadName1m","column","getQuadName500k","name1","subquad","name2","names","replacer","name3","getQuadName100k","getQuadName050k","_getQuads","row_height","column_width","name_factory","quads","min_lat","max_lat","maxCols","joined_quads","row_south","row_north","min_lon","max_lon","column_west","column_east","quad_bounds","getQuads1m","getQuads500k","getQuads100k","getQuads050k","LayerGroup","renderer","_quads","_updateRenderer","_cleanupQuads","_addQuad","titles","rect_options","smoothFactor","noClip","objects","_showContextMenu","_removeQuad","_addQuads","_addGrid","map_bbox","reset","clearLayers","quad_id","isPointInPolygon","polygon","inside","WikimapiaLoader","highlightedPlace","places","localPolygon","polygon2","_tileOnLoad","ielt9","_tileCoordsFromEvent","layerPoint","getPixelOrigin","getPlaceAtMousePos","tileCoords","_tiles","_tileCoordsToKey","getPlaceAtLatlng","setContent","boundsWESN","projectObj","_projectObj","exactMatch","hasChildren","wmUtils","makeTileUrl","parseTile","viewTileSize","urlPath","getTileId","tileIdToCoords","tileId","decodeTitles","chooseTitle","langCode","decodePolygon","makeCoordsLocal","tileX","tileY","tileZ","x0","y0","localCoords","asap","simplifyPolygon","tileHasChildren","p0","pixelDegSize","prevTime","placeId","originalLayerOnAdd","originalZoomOnAdd","Zoom","JNX","_layersControl","makingJnx","contextMenu","makeMenuItems","getLayerForJnx","selectedLayer","layerRec","layerName","estimateTilesCount","tilesCount","_selector","topLeftTile","bottomRightTile","maxLevel","minLevel","metersPerPixel","fileSizeMb","itemClass","resolutionString","sizeString","makeJnx","notifyProgress","sanitizedLayerName","makeJnxFromLayer","removeSelector","addSelector","RectangleSelect","onButtonClicked","Rectangle","fillColor","onMarkerDrag","onMarkerDragEnd","placeMarkers","topLeftPixel","setBoundsFromMarkers","imageFromarrayBuffer","dataURL","ensureImageJpg","convertToJpeg","srcLayer","maxZoomLevel","jnxProductId","jnxZOrder","writer","JnxWriter","minZoomLevel","progressWeight","tempMap","tilePromiseRec","imageRec","addTile","promiseRec","getJnx","jnxCoordinates","extents","toJnx","north","east","south","west","productName","productId","zOrder","tiles","level","totalTilesCount","levels_n","BinStream","writeInt32","writeUint32","seek","writeString","writeInt16","jnxScale","tileDescriptorOffset","tell","writeUint8","tileDataOffset","getBuffer","littlEndian","dv","DataView","_pos","old_buffer","buffer","newAr","oldAr","grow","newPos","checkSize","setUint8","setInt8","setInt16","setUint16","setInt32","setUint32","zeroTerminated","validateFloat","validateFloatRange","radians","roundAzimuth","Azimuth","trueAzimuth","magneticAzimuth","iconSingle","iconUrl","iconPointer","iconStart","iconPointerStart","iconEnd","iconPointerEnd","azimuthLine","single","which","rotationOrigin","layout","setPoints","elevationControl","showProfile","_enabled","hideProfile","atan2","setRotationAngle","updateValuesDisplay","azimuth","lat1","lng1","lng2","onProfileButtonClick","onReverseButtonClick","STATE_DISABLED","STATE_LOCATING","STATE_ENABLED","STATE_ENABLED_FOLLOWING","STATE_MOVING_TO_FOLLOWING","STATE_MOVING_TO_FOLLOWING_FIRST","STATE_UPDATING_FOLLOWING","EVENT_INIT","EVENT_BUTTON_CLICK","EVENT_LOCATION_RECEIVED","EVENT_LOCATION_ERROR","EVENT_MAP_MOVE","EVENT_MAP_MOVE_END","LOCALSTORAGE_POSITION","PositionMarker","_locationSet","_elements","accuracyCircle","circle","markerCircle","circleMarker","markerPoint","_updatePrecisionState","precise","_radius","_precise","setLocation","accuracy","setRadius","locationAcquireTimeoutMS","maxAutoZoom","minAutoZoomDeltaForAuto","minDistForAutoZoom","_events","_handleEvent","fallbackLatLng","forceLatLng","forceZoom","storedPosition","geolocation","getCurrentPosition","_storePositionToLocalStorage","enableHighAccuracy","maximumAge","_startLocating","_onLocationError","_watchID","watchPosition","_onLocationSuccess","_stopLocating","clearWatch","_storeLocation","_accuracy","_updateMarkerLocation","_updateMapPositionWhileFollowing","_updateFollowingStartPosition","_updateFollowingDestPosition","_setViewToLocation","preferAutoZoom","zoomFitAccuracy","getBoundsZoom","toBounds","autoZoom","screenSize","averageScreenSize","_onMapMove","_onMapMoveEnd","equals","_isMapOffsetFromFollowingSegment","pointToSegmentDistance","_isMapCenteredAtLocation","_updateButtonClasses","_setEvents","_processingEvent","_processEvent","_setState","_display","_zoomOutButton","_updateDisplay","Placemark","getTitle","onMapMove","showPlacemark","_placemark","onPlacemarkRemove","PlacemarkHashStateInterface","placemark"],"mappings":"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","file":"static/js/app.a7be9e2a.js","sourcesContent":["import config from '~/config';\n\nexport default function urlViaCorsProxy(url) {\n    return config.CORSProxyUrl + url.replace(/^(https?):\\/\\//u, '$1/');\n}\n","import {fetch} from '~/lib/xhr-promise';\n\nclass BaseService {\n    constructor(url) {\n        this.origUrl = url;\n    }\n\n    isOurUrl() {\n        throw new Error('Method not implemented');\n    }\n\n    requestOptions() {\n        throw new Error('Method not implemented');\n    }\n\n    parseResponse() {\n        throw new Error('Method not implemented');\n    }\n\n    async geoData() {\n        if (!this.isOurUrl()) {\n            throw new Error('Unsupported url');\n        }\n        const requests = this.requestOptions().map((it) => fetch(it.url, it.options));\n        let responses;\n        try {\n            responses = await Promise.all(requests);\n        } catch (e) {\n            return [{name: this.origUrl, error: 'NETWORK'}];\n        }\n\n        return this.parseResponse(responses);\n    }\n\n    nameFromUrl(url) {\n        try {\n            url = decodeURIComponent(url);\n        } catch (e) {\n            // leave url as is\n        }\n\n        return url\n            .split('#')[0]\n            .split('?')[0]\n            .replace(/\\/*$/u, '')\n            .split('/')\n            .pop();\n    }\n}\n export default BaseService;\n","import {arrayBufferToString} from '~/lib/binary-strings';\n\nfunction successIfStatus200(xhr) {\n    return xhr.status >= 200 && xhr.status <= 299;\n}\n\nfunction retryIfNetworkErrorOrServerError(xhr) {\n    return (xhr.status === 0 || xhr.status >= 500);\n}\n\nclass XMLHttpRequestPromiseError extends Error {\n    constructor(xhr) {\n        super();\n        this.xhr = xhr;\n        this.name = 'XMLHttpRequestPromiseError';\n\n        this.message = xhr.status === 0 ? 'network error' : `server response is ${xhr.status}`;\n    }\n}\n\nclass XMLHttpRequestPromise {\n    constructor(\n        url, {method = 'GET', data = null, responseType = '', timeout = 30000, maxTries = 3, retryTimeWait = 500,\n            isResponseSuccess = successIfStatus200, responseNeedsRetry = retryIfNetworkErrorOrServerError,\n            headers = null, withCredentials = false} = {}) {\n        // console.log('promise constructor', url);\n        const promise = new Promise((resolve, reject) => {\n                this._resolve = resolve;\n                this._reject = reject;\n            }\n        );\n        this.then = promise.then.bind(promise);\n        this.catch = promise.catch.bind(promise);\n        this.method = method;\n        this.url = url;\n        this.responseType = responseType;\n        this.postData = data;\n        this._isResponseSuccess = isResponseSuccess;\n        this._responseNeedsRetry = responseNeedsRetry;\n        this._retryTimeWait = retryTimeWait;\n        this.triesLeft = maxTries;\n\n        const xhr = this.xhr = new XMLHttpRequest();\n        xhr.onreadystatechange = () => this._onreadystatechange();\n        this._open();\n        xhr.timeout = timeout;\n        if (responseType === 'binarystring') {\n            xhr.responseType = 'arraybuffer';\n        } else {\n            xhr.responseType = responseType;\n        }\n        if (headers) {\n            for (let [k, v] of headers) {\n                xhr.setRequestHeader(k, v);\n            }\n        }\n        xhr.withCredentials = withCredentials;\n    }\n\n    _open() {\n        // console.log('open', this.url);\n        this.xhr.open(this.method, this.url);\n    }\n\n    _onreadystatechange() {\n        const xhr = this.xhr;\n        if (xhr.readyState === 4 && !this._aborted) {\n            // console.log('ready state 4', this.url);\n            xhr.responseBinaryText = '';\n            if (this.responseType === 'binarystring' && xhr.response && xhr.response.byteLength) {\n                xhr.responseBinaryText = arrayBufferToString(xhr.response);\n            }\n            // IE doesnot support responseType=json\n            if (this.responseType === 'json' && (typeof xhr.response) === 'string') {\n                try {\n                    // xhr.response is readonly\n                    xhr.responseJSON = JSON.parse(xhr.response);\n                } catch (e) {\n                    xhr.responseJSON = null;\n                }\n            } else {\n                xhr.responseJSON = xhr.response;\n            }\n            if (this._isResponseSuccess(xhr)) {\n                // console.log('success', this.url);\n                this._resolve(xhr);\n            } else {\n                if (this.triesLeft > 0 && this._responseNeedsRetry(xhr)) {\n                    // console.log('retry', this.url);\n                    this._open();\n                    this._timerId = setTimeout(() => this.send(), this._retryTimeWait);\n                } else {\n                    // console.log('failed', this.url);\n                    this._reject(new XMLHttpRequestPromiseError(xhr));\n                }\n            }\n        }\n    }\n\n    abort() {\n        // console.log('abort', this.url);\n        this._aborted = true;\n        clearTimeout(this._timerId);\n        this.xhr.abort();\n    }\n\n    send() {\n        // console.log('send', this.url);\n        this.triesLeft -= 1;\n        this.xhr.send(this.postData);\n    }\n}\n\nclass XHRQueue {\n    constructor(maxSimultaneousRequests = 6) {\n        this._maxConnections = maxSimultaneousRequests;\n        this._queue = [];\n        this._activeCount = 0;\n    }\n\n    put(url, options) {\n        const promise = new XMLHttpRequestPromise(url, options);\n        promise._originalAbort = promise.abort;\n        promise.abort = () => this._abortPromise(promise);\n        this._queue.push(promise);\n        this._processQueue();\n        return promise;\n    }\n\n    _abortPromise(promise) {\n        const i = this._queue.indexOf(promise);\n        if (i > -1) {\n            // console.log('ABORT IN QUEUE');\n            this._queue.splice(i, 1);\n        } else {\n            if (promise.xhr.readyState === 4) {\n                // console.log('ABORT COMPLETED');\n            } else {\n                // console.log('ABORT ACTIVE');\n                promise._originalAbort();\n                this._activeCount -= 1;\n                setTimeout(() => this._processQueue(), 0);\n            }\n        }\n    }\n\n    _processQueue() {\n        if (this._activeCount >= this._maxConnections || this._queue.length === 0) {\n            return;\n        }\n        const promise = this._queue.shift();\n        promise\n            .catch(() => {\n                // do not throw if XHR request fails\n            })\n            .then(() => this._onRequestReady(promise));\n        this._activeCount += 1;\n        promise.send();\n    }\n\n    _onRequestReady(promise) {\n        if (!promise._aborted) {\n            this._activeCount -= 1;\n        }\n        setTimeout(() => this._processQueue(), 0);\n    }\n}\n\nfunction fetch(url, options) {\n    // console.log('fetch', url);\n    const promise = new XMLHttpRequestPromise(url, options);\n    promise.send();\n    return promise;\n}\n\nexport {fetch, XHRQueue};\n\n","import L from 'leaflet';\nimport './style.css';\n\nfunction stopContainerEvents(container) {\n    L.DomEvent.disableClickPropagation(container);\n    L.DomEvent.disableScrollPropagation(container);\n    L.DomEvent.on(container, 'mousemove contextmenu', L.DomEvent.stop);\n}\n\nL.Control.include({\n    _stopContainerEvents: function() {\n        stopContainerEvents(this._container);\n    }\n});\n\nfunction makeButton(containerClass, title, iconClass, noControlClass) {\n    let cls = 'leaflet-bar leaflet-control-single-button';\n    if (!noControlClass) {\n        cls += ' leafletControl';\n    }\n    if (containerClass) {\n        cls += ' ' + containerClass;\n    }\n    const container = L.DomUtil.create('div', cls);\n    stopContainerEvents(container);\n    const link = L.DomUtil.create('a', null, container);\n    link.href = '#';\n    L.DomEvent.on(link, 'click', L.DomEvent.preventDefault);\n    if (title) {\n        link.title = title;\n    }\n    const icon = L.DomUtil.create('div', iconClass, link);\n    return {container, link, icon};\n}\n\nfunction makeButtonWithBar(containerClass, title, iconClass) {\n    let cls = 'leaflet-control button-with-bar';\n    if (containerClass) {\n        cls += ' ' + containerClass;\n    }\n    const container = L.DomUtil.create('div', cls);\n    const {container: buttonContainer, link, icon} = makeButton(null, title, iconClass, true);\n    container.appendChild(buttonContainer);\n\n    const barContainer = L.DomUtil.create('div', 'leaflet-bar bar', container);\n    stopContainerEvents(barContainer);\n    return {container, buttonContainer, link, icon, barContainer};\n}\n\nexport {stopContainerEvents, makeButton, makeButtonWithBar};\n","import * as Sentry from '@sentry/browser';\n\nfunction randId() {\n    return Math.random().toString(36).substring(2, 13);\n}\n\nconst sessionId = randId(); // eslint-disable-line\n\nfunction captureMessage(msg, extra = {}) {\n    extra.url = window.location.toString();\n    console.log('captureMessage', msg, extra); // eslint-disable-line no-console\n    Sentry.withScope(function(scope) {\n        scope.setExtras(extra);\n        Sentry.captureMessage(msg);\n    });\n}\n\nfunction captureException(e, description) {\n    console.log('captureException', e, description); // eslint-disable-line no-console\n    Sentry.withScope(function(scope) {\n        if (description) {\n            scope.setTag('description', description);\n        }\n        scope.setExtra('url', window.location.toString());\n        Sentry.captureException(e);\n    });\n}\nfunction captureBreadcrumb(message, data = {}) {\n    data.url = window.location.toString();\n    Sentry.addBreadcrumb({\n        message, data\n    });\n}\n\nfunction logEvent(eventName, extra) { // eslint-disable-line\n    console.log(eventName, extra); // eslint-disable-line\n}\n\nexport {captureMessage, captureException, captureBreadcrumb, logEvent, randId};\n","import secrets from './secrets';\n\nconst config = {\n    caption: ``,\n    defaultLocation: [44.47716, 33.91960],\n    defaultZoom: 12,\n    googleApiUrl: `https://maps.googleapis.com/maps/api/js?v=3&key=${secrets.google}`,\n    westraDataBaseUrl: 'https://nakarte.me/westraPasses/',\n    CORSProxyUrl: 'https://proxy.nakarte.me/',\n    elevationsServer: 'https://elevation.nakarte.me/',\n    wikimediaCommonsCoverageUrl: 'https://tiles.nakarte.me/wikimedia_commons_images/{z}/{x}/{y}',\n    geocachingSuUrl: 'https://nakarte.me/geocachingSu/geocaching_su2.json',\n    tracksStorageServer: 'https://tracks.nakarte.me',\n    ...secrets\n};\n\nexport default config;\n","import alertify from 'alertify.js';\nimport './style.css';\n\nfunction notify(message, onOk) {\n    alertify.alert(message, onOk);\n}\n\nfunction query(message, value) {\n    function removeFocusFromInput() {\n        const activeElement = document.activeElement;\n        if (activeElement?.tagName === 'INPUT') {\n            activeElement.blur();\n        }\n    }\n\n    const result = window.prompt(message, value);\n    // There is a bug in Chrome on Android: after closing the prompt, it sets focus to last active input element\n    setTimeout(removeFocusFromInput, 0);\n    return result;\n}\n\nexport {notify, query};\n","function arrayBufferToString(arBuf) {\n    const\n        arr = new Uint8Array(arBuf),\n        s = [];\n    for (let i = 0; i < arr.length; i += 4096) {\n        let chunk = arr.subarray(i, i + 4096);\n        chunk = String.fromCharCode.apply(null, chunk);\n        s.push(chunk);\n    }\n    return s.join('');\n}\n\nfunction stringToArrayBuffer(s) {\n    const\n        length = s.length,\n        buf = new ArrayBuffer(length),\n        arr = new Uint8Array(buf);\n    for (let i = 0; i < length; i++) {\n        arr[i] = s.charCodeAt(i);\n    }\n    return buf;\n}\n\nfunction blobFromString(s) {\n    const arr = stringToArrayBuffer(s);\n    return new Blob([arr]);\n}\n\nexport {arrayBufferToString, blobFromString, stringToArrayBuffer};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {hashState} from './hashState';\nimport * as logging from '~/lib/logging';\n\nL.Mixin.HashState = {\n    enableHashState: function(key, defaultInitialState = null) {\n        this._hashStateKey = key;\n        const eventSource = this.stateChangeEventsSource ? this[this.stateChangeEventsSource] : this;\n\n        // setup event listeners\n        if (this.stateChangeEvents) {\n            this.stateChangeEvents.forEach((event) => {\n                    eventSource.on(event, this._onControlStateChanged, this);\n                }\n            );\n        }\n\n        hashState.addEventListener(key, (state) => this._onExternalStateChanged(state));\n\n        // initialize control state from hash\n\n        const state = hashState.getState(key) || defaultInitialState;\n        if (!state || !this.unserializeState(state)) {\n            this.unserializeState(defaultInitialState);\n        }\n        hashState.updateState(this._hashStateKey, this.serializeState());\n        return this;\n    },\n\n    _onControlStateChanged: function() {\n        const state = this.serializeState();\n        hashState.updateState(this._hashStateKey, state);\n    },\n\n    _onExternalStateChanged: function(state) {\n        if (!this.unserializeState(state)) { // state from hash is invalid, update hash from component state\n            logging.captureMessage(`Invalid state in hash string (key \"${this._hashStateKey}\")`);\n            hashState.updateState(this._hashStateKey, this.serializeState());\n        }\n    }\n\n    // TODO: disableHashState\n};\n","import {decode as utf8_decode} from 'utf8';\nimport {xmlGetNodeText} from './xmlUtils';\nimport stripBom from '~/lib/stripBom';\n\nfunction parseGpx(txt, name, preferNameFromFile) {\n    var error;\n\n    function getSegmentPoints(segment_element) {\n        var points_elements = segment_element.getElementsByTagName('trkpt');\n        var points = [];\n        for (var i = 0; i < points_elements.length; i++) {\n            var point_element = points_elements[i];\n            var lat = parseFloat(point_element.getAttribute('lat'));\n            var lng = parseFloat(point_element.getAttribute('lon'));\n            if (isNaN(lat) || isNaN(lng)) {\n                error = 'CORRUPT';\n                break;\n            }\n            points.push({lat: lat, lng: lng});\n        }\n        return points;\n    }\n\n    function getTrackSegments(xml) {\n        var segments = [];\n        var segments_elements = xml.getElementsByTagName('trkseg');\n        for (var i = 0; i < segments_elements.length; i++) {\n            var segment_points = getSegmentPoints(segments_elements[i]);\n            if (segment_points.length) {\n                segments.push(segment_points);\n            }\n        }\n        return segments;\n    }\n\n    function getRoutePoints(rte_element) {\n        var points_elements = rte_element.getElementsByTagName('rtept');\n        var points = [];\n        for (var i = 0; i < points_elements.length; i++) {\n            var point_element = points_elements[i];\n            var lat = parseFloat(point_element.getAttribute('lat'));\n            var lng = parseFloat(point_element.getAttribute('lon'));\n            if (isNaN(lat) || isNaN(lng)) {\n                error = 'CORRUPT';\n                break;\n            }\n            points.push({lat: lat, lng: lng});\n        }\n        return points;\n    }\n\n    function getRoutes(xml) {\n        var routes = [];\n        var rte_elements = xml.getElementsByTagName('rte');\n        for (var i = 0; i < rte_elements.length; i++) {\n            var rte_points = getRoutePoints(rte_elements[i]);\n            if (rte_points.length) {\n                routes.push(rte_points);\n            }\n        }\n        return routes;\n    }\n\n    function getWaypoints(xml) {\n        var waypoint_elements = xml.getElementsByTagName('wpt');\n        var waypoints = [];\n        for (var i = 0; i < waypoint_elements.length; i++) {\n            var waypoint_element = waypoint_elements[i];\n            var waypoint = {};\n            waypoint.lat = parseFloat(waypoint_element.getAttribute('lat'));\n            waypoint.lng = parseFloat(waypoint_element.getAttribute('lon'));\n            if (isNaN(waypoint.lat) || isNaN(waypoint.lng)) {\n                error = 'CORRUPT';\n                continue;\n            }\n            let wptName = xmlGetNodeText(waypoint_element.getElementsByTagName('name')[0]) || '';\n            try {\n                wptName = utf8_decode((wptName));\n            } catch (e) {\n                error = 'CORRUPT';\n                wptName = '__invalid point name__';\n            }\n            waypoint.name = wptName;\n            waypoint.symbol_name = xmlGetNodeText(waypoint_element.getElementsByTagName('sym')[0]);\n            waypoints.push(waypoint);\n        }\n        return waypoints;\n    }\n\n    txt = stripBom(txt);\n    // remove namespaces\n    txt = txt.replace(/<([^ >]+):([^ >]+)/ug, '<$1_$2');\n    let dom;\n    try {\n        dom = (new DOMParser()).parseFromString(txt, \"text/xml\");\n    } catch (e) {\n        return null;\n    }\n    if (dom.documentElement.nodeName === 'parsererror') {\n        return null;\n    }\n    if (dom.getElementsByTagName('gpx').length === 0) {\n        return null;\n    }\n    if (preferNameFromFile) {\n        for (let trk of [...dom.getElementsByTagName('trk')]) {\n            let trkName = trk.getElementsByTagName('name')[0];\n            if (trkName) {\n                try {\n                    trkName = utf8_decode(xmlGetNodeText(trkName));\n                } catch (e) {\n                    error = 'CORRUPT';\n                }\n                if (trkName.length) {\n                    name = trkName;\n                    break;\n                }\n            }\n        }\n    }\n    return [{\n        name: name,\n        tracks: getTrackSegments(dom).concat(getRoutes(dom)),\n        points: getWaypoints(dom),\n        error: error\n    }];\n}\n\nexport default parseGpx;\n","import './contextmenu.css';\n\n/*\n    items = [\n        {text: 'Hello', disabled: true},\n        '-',\n        {text: 'World', callback: fn},\n        {text: 'section', separator: true},\n    ]\n */\n\nfunction isDescendant(parent, child) {\n    if (!parent) {\n        return false;\n    }\n    while (child) {\n        if (child === parent) {\n            return true;\n        }\n        child = child.parentNode;\n    }\n    return false;\n}\n\nclass Contextmenu {\n    constructor(items) {\n        this.items = items;\n    }\n\n    show(e) {\n        if (this._container) {\n            return;\n        }\n        if (e.originalEvent) {\n            e = e.originalEvent;\n        }\n        if (e.preventDefault) {\n            e.preventDefault();\n        } else {\n            e.returnValue = false;\n        }\n\n        const {clientX: x, clientY: y} = e;\n\n        const container = this._container = document.createElement('div');\n        document.body.appendChild(container);\n        container.className = 'contextmenu';\n        container.style.zIndex = 10000;\n\n        window.addEventListener('keydown', this.onKeyDown, true);\n        window.addEventListener('mousedown', this.onMouseDown, true);\n        window.addEventListener('touchstart', this.onMouseDown, true);\n\n        for (let item of this.createItems()) {\n            container.appendChild(item);\n        }\n        this.setPosition(x, y);\n    }\n\n    hide() {\n        if (!this._container) {\n            return;\n        }\n        document.body.removeChild(this._container);\n        this._container = null;\n\n        window.removeEventListener('keydown', this.onKeyDown, true);\n        window.removeEventListener('mousedown', this.onMouseDown, true);\n        window.removeEventListener('touchstart', this.onMouseDown, true);\n    }\n\n    onKeyDown = (e) => {\n        if (e.keyCode === 27) {\n            this.hide();\n        }\n    };\n\n    onMouseDown = (e) => {\n        if (!isDescendant(this._container, e.target)) {\n            this.hide();\n        }\n    };\n\n    setPosition(x, y) {\n        const window_width = window.innerWidth,\n            window_height = window.innerHeight,\n            menu_width = this._container.offsetWidth,\n            menu_height = this._container.offsetHeight;\n        if (x + menu_width >= window_width) {\n            x -= menu_width;\n            if (x < 0) {\n               x = 0;\n            }\n        }\n        if (y + menu_height >= window_height) {\n            y -= menu_height;\n            if (y < 0) {\n                y = 0;\n            }\n        }\n        this._container.style.left = `${x}px`;\n        this._container.style.top = `${y}px`;\n    }\n\n    *createItems() {\n        let items = this.items;\n        if (typeof items === 'function') {\n            items = items();\n        }\n        for (let itemOptions of items) {\n            if (typeof itemOptions === 'function') {\n                itemOptions = itemOptions();\n            }\n            if (itemOptions === '-' || itemOptions.separator) {\n                yield this.createSeparator(itemOptions);\n            } else {\n                yield this.createItem(itemOptions);\n            }\n        }\n    }\n\n    createItem(itemOptions) {\n        const el = document.createElement('a');\n        let className = 'item';\n        if (itemOptions.disabled) {\n            className += ' disabled';\n        }\n        if (itemOptions.header) {\n            className += ' header';\n        }\n        el.innerHTML = itemOptions.text;\n\n        const callback = itemOptions.callback;\n        if (callback && !itemOptions.disabled) {\n            className += ' action';\n            el.addEventListener('click', this.onItemClick.bind(this, callback));\n        }\n        el.className = className;\n        return el;\n    }\n\n    onItemClick(callback, e) {\n        e.stopPropagation();\n        e.preventDefault();\n        this.hide();\n        callback(e);\n    }\n\n    createSeparator(itemOptions) {\n        const el = document.createElement('div');\n        el.className = 'separator';\n        if (itemOptions.text) {\n            el.innerHTML = `<span>${itemOptions.text}</span>`;\n        }\n        return el;\n    }\n}\n\nexport default Contextmenu;\n","function localStorageWorks() {\n    try {\n        window.localStorage.setItem('_testDummy', 'TEST');\n        return window.localStorage.getItem('_testDummy') === 'TEST';\n    } catch (e) {\n        return false;\n    }\n}\n\nlet storage; // eslint-disable-line import/no-mutable-exports\n\nif (localStorageWorks()) {\n    storage = window.localStorage;\n} else {\n    let _storage = {};\n    storage = {\n        length: 0,\n\n        key: function(n) {\n            return Object.keys(_storage)[n];\n        },\n\n        removeItem: function(key) {\n            delete _storage[key];\n        },\n\n        getItem: function(key) {\n            return storage[key];\n        },\n\n        setItem: function(key, value) {\n            storage[key] = value;\n        },\n\n        clear: function() {\n            _storage = {};\n        }\n    };\n}\n\nexport default storage;\n","import L from 'leaflet';\nimport './canvasMarkers.css';\nimport RBush from 'rbush';\nimport loadImage from 'image-promise';\nimport {wrapLatLngToTarget} from '~/lib/leaflet.fixes/fixWorldCopyJump';\n\n/*\n Marker definition:\n {\n latlng: L.Latlng,\n icon: {url: string, center: [x, y]} or function(marker) returning icon,\n label: string or function,\n tooltip: string or function,\n any other fields\n }\n */\n\nfunction calcIntersectionSum(rect, rects) {\n    let sum = 0,\n        left, right, top, bottom, rect2;\n\n    for (rect2 of rects) {\n        left = Math.max(rect.minX, rect2.minX);\n        right = Math.min(rect.maxX, rect2.maxX);\n        top = Math.max(rect.minY, rect2.minY);\n        bottom = Math.min(rect.maxY, rect2.maxY);\n        if (top < bottom && left < right) {\n            sum += ((right - left) * (bottom - top));\n        }\n    }\n    return sum;\n}\n\nclass MarkerRBush extends RBush {\n    toBBox(marker) {\n        const x = marker.latlng.lng;\n        const y = marker.latlng.lat;\n        return {\n            minX: x,\n            minY: y,\n            maxX: x,\n            maxY: y\n        };\n    }\n\n    compareMinX(a, b) {\n        return a.latlng.lng - b.latlng.lng;\n    }\n\n    compareMinY(a, b) {\n        return a.latlng.lat - b.latlng.lat;\n    }\n}\n\nL.Layer.CanvasMarkers = L.GridLayer.extend({\n        options: {\n            async: true,\n            labelFontName: 'Verdana, Arial, sans-serif',\n            labelFontSize: 10,\n            iconScale: 1,\n            pane: 'rasterMarker',\n            updateWhenZooming: !L.Browser.mobile,\n            iconsOpacity: 1,\n            labelShadowWidth: 1,\n        },\n\n        initialize: function(markers, options) {\n            L.GridLayer.prototype.initialize.call(this, options);\n            this.rtree = new MarkerRBush(9);\n            this._regions = new RBush();\n            this._iconPositions = {};\n            this._labelPositions = {};\n            this._labelPositionsZoom = null;\n            this.addMarkers(markers);\n            this._images = {};\n            this._tileQueue = [];\n            this._hoverMarker = null;\n            this.on('markerenter', this.onMarkerEnter, this);\n            this.on('markerleave', this.onMarkerLeave, this);\n        },\n\n        addMarkers: function(markers) {\n            if (markers) {\n                this.rtree.load(markers);\n                this.resetLabels();\n                setTimeout(() => this.redraw(), 0);\n            }\n        },\n\n        addMarker: function(marker) {\n            // FIXME: adding existing marker must be be noop\n            this.rtree.insert(marker);\n            this.resetLabels();\n            setTimeout(() => this.redraw(), 0);\n        },\n\n        removeMarker: function(marker) {\n            this.removeMarkers([marker]);\n        },\n\n        removeMarkers: function(markers) {\n            markers.forEach((marker) => this.rtree.remove(marker));\n            this.resetLabels();\n            setTimeout(() => this.redraw(), 0);\n        },\n\n        updateMarkers: function(markers) {\n            this.removeMarkers(markers);\n            this.addMarkers(markers);\n        },\n\n        updateMarker: function(marker) {\n            this.updateMarkers([marker]);\n        },\n\n        setMarkerPosition: function(marker, latlng) {\n            this.removeMarker(marker);\n            marker.latlng = latlng;\n            this.addMarker(marker);\n        },\n\n        getMarkers: function() {\n            return this.rtree.all();\n        },\n\n        findLabelPosition: function(iconCenter, iconSize, textWidth, textHeight, pixelExtents) {\n            const\n                verticalPadding = 0,\n                xPositions = [iconCenter[0] + iconSize[0] / 2 + 2, iconCenter[0] - iconSize[0] / 2 - textWidth - 2],\n                yPositions = [\n                    iconCenter[1] - textHeight / 2 + verticalPadding,\n                    iconCenter[1] - textHeight * 0.75 - iconSize[1] / 4 + verticalPadding,\n                    iconCenter[1] - textHeight / 4 + iconSize[1] / 4 + verticalPadding,\n                    iconCenter[1] - textHeight - iconSize[1] / 2 + verticalPadding,\n                    iconCenter[1] + iconSize[1] / 2 + verticalPadding\n                ];\n\n            let minIntersectionSum = Infinity;\n            let bestX = xPositions[0],\n                bestY = yPositions[0];\n            for (let x of xPositions) {\n                for (let y of yPositions) {\n                    const rect = {minX: x, minY: y, maxX: x + textWidth, maxY: y + textHeight};\n                    if (pixelExtents && (rect.minX < pixelExtents.tileW || rect.maxX > pixelExtents.tileE ||\n                        rect.minY < pixelExtents.tileN || rect.maxY > pixelExtents.tileS)) {\n                        continue;\n                    }\n                    let intersectionSum = calcIntersectionSum(rect, this._regions.search(rect));\n                    if (intersectionSum < minIntersectionSum) {\n                        minIntersectionSum = intersectionSum;\n                        bestX = x;\n                        bestY = y;\n                        if (minIntersectionSum === 0) {\n                            break;\n                        }\n                    }\n                }\n                if (minIntersectionSum === 0) {\n                    break;\n                }\n            }\n            return [bestX, bestY];\n        },\n\n        preloadIcons: function(urls) {\n            const newUrls = urls.filter((url) => !(url in this._images));\n            if (newUrls.length) {\n                return loadImage(newUrls).then((images) => {\n                        for (let image of images) {\n                            this._images[image.src] = image;\n                        }\n                    }\n                );\n            }\n            return Promise.resolve();\n        },\n\n        createTile: function(coords, done) {\n            const canvas = L.DomUtil.create('canvas', 'leaflet-tile');\n            canvas.width = this.options.tileSize;\n            canvas.height = this.options.tileSize;\n            setTimeout(() => {\n                    this.drawTile(canvas, coords).then(() => done(null, canvas));\n                }, 0\n            );\n            return canvas;\n        },\n\n        selectMarkersForDraw: function({tileN, tileS, tileE, tileW}, zoom, withoutPadding) {\n            // FIXME: padding should depend on options.iconScale and fontSize\n            if (!this._map) {\n                return {};\n            }\n            const\n                iconsHorPad = withoutPadding ? 0 : 520,\n                iconsVertPad = withoutPadding ? 0 : 50,\n                labelsHorPad = withoutPadding ? 0 : 256,\n                labelsVertPad = withoutPadding ? 0 : 20;\n            const\n                iconsBounds = L.latLngBounds(\n                    this._map.unproject(L.point(tileW - iconsHorPad, tileS + iconsHorPad), zoom),\n                    this._map.unproject(L.point(tileE + iconsHorPad, tileN - iconsVertPad), zoom)\n                ),\n                labelsBounds = L.latLngBounds(\n                    this._map.unproject(L.point(tileW - labelsHorPad, tileS + labelsHorPad), zoom),\n                    this._map.unproject(L.point(tileE + labelsHorPad, tileN - labelsVertPad), zoom)\n                );\n            const\n                iconUrls = [],\n                markerJobs = {};\n\n            // used only to preload icons\n            const pointsForMarkers = [];\n            for (let shift of [-360, 0, 360]) {\n                pointsForMarkers.push(...this.rtree.search({\n                    minX: iconsBounds.getWest() + shift,\n                    minY: iconsBounds.getSouth(),\n                    maxX: iconsBounds.getEast() + shift,\n                    maxY: iconsBounds.getNorth()\n                }));\n            }\n\n            // used to place labels\n            const pointsForLabels = [];\n            for (let shift of [-360, 0, 360]) {\n                pointsForLabels.push(...this.rtree.search({\n                    minX: labelsBounds.getWest() + shift,\n                    minY: labelsBounds.getSouth(),\n                    maxX: labelsBounds.getEast() + shift,\n                    maxY: labelsBounds.getNorth()\n                }));\n            }\n            const tileMidLongitude = this._map.unproject([(tileE + tileW) / 2, tileN], zoom);\n\n            for (let marker of pointsForMarkers) {\n                let latlng = marker.latlng;\n                if (this.options.noWrap) {\n                    latlng = wrapLatLngToTarget(latlng, tileMidLongitude);\n                }\n                const p = this._map.project(latlng, zoom);\n                let icon = marker.icon;\n                if (typeof icon === 'function') {\n                    icon = icon(marker);\n                }\n                iconUrls.push(icon.url);\n                let markerId = L.stamp(marker);\n                markerJobs[markerId] = {marker: marker, icon: icon, projectedXY: p};\n            }\n            return {iconUrls, markerJobs, pointsForLabels};\n        },\n\n        drawSelectedMarkers: function(canvas, pixelExtents, markerJobs, pointsForLabels, zoom, limitLabelsToImage) {\n            const {tileN, tileW, tileS, tileE} = pixelExtents;\n            const textHeight = this.options.labelFontSize * this.options.iconScale;\n            if (this._labelPositionsZoom !== zoom) {\n                this._labelPositionsZoom = zoom;\n                this.resetLabels();\n            }\n            const ctx = canvas.getContext('2d');\n            ctx.font = L.Util.template('bold {size}px {name}',\n                {name: this.options.labelFontName, size: this.options.labelFontSize * this.options.iconScale}\n            );\n            for (let [markerId, job] of Object.entries(markerJobs)) {\n                let img = this._images[job.icon.url];\n                job.img = img;\n                const imgW = Math.round(img.width * this.options.iconScale);\n                const imgH = Math.round(img.height * this.options.iconScale);\n                if (!(markerId in this._iconPositions)) {\n                    let x = job.projectedXY.x - job.icon.center[0] * this.options.iconScale;\n                    let y = job.projectedXY.y - job.icon.center[1] * this.options.iconScale;\n                    x = Math.round(x);\n                    y = Math.round(y);\n                    this._iconPositions[markerId] = [x, y];\n                    this._regions.insert({\n                        minX: x,\n                        minY: y,\n                        maxX: x + imgW,\n                        maxY: y + imgH,\n                        marker: job.marker,\n                        isLabel: false\n                    });\n                }\n                let [x, y] = this._iconPositions[markerId];\n                job.iconCenter = [x + imgW / 2, y + imgH / 2];\n                job.iconSize = [imgW, imgH];\n            }\n            for (let marker of pointsForLabels) {\n                const markerId = L.stamp(marker);\n                const job = markerJobs[markerId];\n                let label = job.marker.label;\n                if (typeof label === 'function') {\n                    label = label(job.marker, zoom);\n                }\n                if (label) {\n                    job.label = label;\n                    if (!(markerId in this._labelPositions)) {\n                        const textWidth = ctx.measureText(label).width;\n                        const p = this.findLabelPosition(job.iconCenter, job.iconSize, textWidth, textHeight,\n                            limitLabelsToImage ? pixelExtents : null);\n                        this._labelPositions[markerId] = p;\n                        let [x, y] = p;\n                        this._regions.insert({\n                            minX: x,\n                            minY: y,\n                            maxX: x + textWidth,\n                            maxY: y + textHeight,\n                            marker: job.marker,\n                            isLabel: true\n                        });\n                    }\n                } else {\n                    this._labelPositions[markerId] = null;\n                }\n            }\n\n            const regionsInTile = this._regions.search({minX: tileW, minY: tileN, maxX: tileE, maxY: tileS});\n            // draw labels\n            for (let region of regionsInTile) {\n                if (region.isLabel) {\n                    // TODO: set font name ant size in options\n                    const markerId = L.stamp(region.marker);\n                    const job = markerJobs[markerId];\n                    const p = this._labelPositions[markerId];\n                    const x = p[0] - tileW;\n                    const y = p[1] - tileN;\n                    ctx.textBaseline = 'bottom';\n                    ctx.shadowColor = '#fff';\n                    ctx.strokeStyle = '#fff';\n                    ctx.fillStyle = '#000';\n                    ctx.lineWidth = 1.2 * this.options.iconScale;\n                    ctx.shadowBlur = this.options.labelShadowWidth * this.options.iconScale;\n                    ctx.strokeText(job.label, x, y + textHeight);\n                    ctx.shadowBlur = 0;\n                    ctx.fillText(job.label, x, y + textHeight);\n                }\n            }\n            ctx.globalAlpha = this.options.iconsOpacity;\n            // draw icons\n            for (let region of regionsInTile) {\n                if (!region.isLabel) {\n                    const markerId = L.stamp(region.marker);\n                    const job = markerJobs[markerId];\n                    const p = this._iconPositions[markerId];\n                    const x = p[0] - tileW;\n                    const y = p[1] - tileN;\n                    ctx.drawImage(job.img, x, y, job.iconSize[0], job.iconSize[1]);\n                }\n            }\n            ctx.globalAlpha = 1;\n        },\n\n        drawTile: async function(canvas, coords) {\n            const\n                zoom = coords.z,\n                tileSize = this.options.tileSize,\n                tileN = coords.y * tileSize,\n                tileW = coords.x * tileSize,\n                tileS = tileN + tileSize,\n                tileE = tileW + tileSize;\n            const pixelExtents = {tileN, tileS, tileE, tileW};\n            const {iconUrls, markerJobs, pointsForLabels} = this.selectMarkersForDraw(pixelExtents, zoom);\n            if (!markerJobs) {\n                return;\n            }\n            await this.preloadIcons(iconUrls);\n            this.drawSelectedMarkers(canvas, pixelExtents, markerJobs, pointsForLabels, zoom);\n        },\n\n        resetLabels: function() {\n            this._iconPositions = {};\n            this._labelPositions = {};\n            this._regions.clear();\n        },\n\n        findMarkerFromMouseEvent: function(e) {\n            const\n                p = this._map.project(e.latlng.wrap()),\n                region = this._regions.search({minX: p.x, minY: p.y, maxX: p.x, maxY: p.y})[0];\n            let marker;\n            if (region) {\n                marker = region.marker;\n            } else {\n                marker = null;\n            }\n            return marker;\n        },\n\n        onMouseMove: function(e) {\n            const marker = this.findMarkerFromMouseEvent(e);\n            if (this._hoverMarker !== marker) {\n                if (this._hoverMarker) {\n                    this.fire('markerleave', {marker: this._hoverMarker});\n                }\n                if (marker) {\n                    this.fire('markerenter', {marker: marker});\n                }\n                this._hoverMarker = marker;\n            }\n        },\n\n        showTooltip: function(e) {\n            if (!e.marker.tooltip) {\n                return;\n            }\n            let text = e.marker.tooltip;\n            if (typeof text === 'function') {\n                text = text(e.marker);\n                if (!e.marker.tooltip) {\n                    return;\n                }\n            }\n            this.toolTip.innerHTML = text;\n            const p = this._map.latLngToLayerPoint(e.marker.latlng);\n            L.DomUtil.setPosition(this.toolTip, p);\n            L.DomUtil.addClass(this.toolTip, 'canvas-marker-tooltip-on');\n        },\n\n        onMarkerEnter: function(e) {\n            this._map._container.style.cursor = 'pointer';\n            this.showTooltip(e);\n        },\n\n        onMarkerLeave: function() {\n            this._map._container.style.cursor = '';\n            L.DomUtil.removeClass(this.toolTip, 'canvas-marker-tooltip-on');\n        },\n\n        onMouseOut: function() {\n            if (this._hoverMarker) {\n                const marker = this._hoverMarker;\n                this._hoverMarker = null;\n                this.fire('markerleave', {marker});\n            }\n        },\n\n        onClick: function(e) {\n            if (this._map.clickLocked) {\n                return;\n            }\n            const marker = this.findMarkerFromMouseEvent(e);\n            if (marker) {\n                L.extend(e, {marker: marker});\n                this.fire('markerclick', e);\n            }\n        },\n\n        onRightClick: function(e) {\n            const marker = this.findMarkerFromMouseEvent(e);\n            if (marker) {\n                L.extend(e, {marker: marker});\n                this.fire('markercontextmenu', e);\n            }\n        },\n\n        onAdd: function(map) {\n            if (this.options.pane === 'rasterMarker' && !map.getPane('rasterMarker')) {\n                map.createPane('rasterMarker').style.zIndex = 550;\n            }\n            L.GridLayer.prototype.onAdd.call(this, map);\n            map.on('mousemove', this.onMouseMove, this);\n            map.on('mouseout', this.onMouseOut, this);\n            map.on('click', this.onClick, this);\n            map.on('contextmenu', this.onRightClick, this);\n            this.toolTip = L.DomUtil.create('div', 'canvas-marker-tooltip', this._map.getPanes().markerPane);\n        },\n\n        onRemove: function(map) {\n            this._map.off('mousemove', this.onMouseMove, this);\n            this._map.off('mouseout', this.onMouseOut, this);\n            this._map.off('click', this.onClick, this);\n            this._map.off('contextmenu', this.onRightClick, this);\n            if (this._hoverMarker) {\n                this._hoverMarker = null;\n                this.fire('markerleave', {marker: this._hoverMarker});\n            }\n            this._map.getPanes().markerPane.removeChild(this.toolTip);\n            L.GridLayer.prototype.onRemove.call(this, map);\n        }\n    }\n);\n","import L from 'leaflet';\n\nfunction shiftLongitudeToTarget(lng, targetLng) {\n    if (targetLng instanceof L.LatLngBounds) {\n        if (!targetLng.isValid()) {\n            return 0;\n        }\n        targetLng = targetLng.getCenter().lng;\n    } else {\n        targetLng = targetLng.lng ?? targetLng;\n    }\n    let shift = 0;\n    if (Math.abs(lng + 360 - targetLng) < Math.abs(lng - targetLng)) {\n        shift = 360;\n    } else if (Math.abs(lng - 360 - targetLng) < Math.abs(lng - targetLng)) {\n        shift = -360;\n    }\n    return shift;\n}\n\nfunction wrapLatLngToTarget(latLng, targetLng) {\n    const shift = shiftLongitudeToTarget(latLng.lng, targetLng);\n    return L.latLng(latLng.lat, latLng.lng + shift);\n}\n\nfunction wrapLatLngBoundsToTarget(latLngBounds, targetLng) {\n    const shift = shiftLongitudeToTarget(latLngBounds.getCenter().lng, targetLng);\n    const p1 = latLngBounds.getSouthEast();\n    const p2 = latLngBounds.getNorthWest();\n    return L.latLngBounds([[p1.lat, p1.lng + shift], [p2.lat, p2.lng + shift]]);\n}\n\nfunction fixVectorMarkerWorldJump() {\n    L.Polyline.prototype.shiftProjectedFitMapView = function() {\n        const polylineBounds = this.getBounds();\n        let shift = null;\n        if (this._map && polylineBounds.isValid()) {\n            const worldWidth = this._map.getPixelWorldBounds().getSize().x;\n            const polylineCenter = polylineBounds.getCenter();\n            const mapCenter = this._map.getCenter();\n\n            if (polylineCenter.lng < mapCenter.lng - 180) {\n                shift = worldWidth;\n            } else if (polylineCenter.lng > mapCenter.lng + 180) {\n                shift = -worldWidth;\n            } else {\n                shift = 0;\n            }\n        }\n        return shift;\n    };\n\n    // Shift line points longitude by +360 or -360, to minimize distance between line center and map view center\n    // Longitude is changed only for display, longitude of pints is not changed\n    // Breaks dipslay of lines spanning more then one world copy\n    L.Polyline.prototype._projectLatlngs = function(latlngs, result, projectedBounds) {\n        var flat = latlngs[0] instanceof L.LatLng,\n            len = latlngs.length,\n            i, ring;\n        let shift = null;\n        if (this.options.projectedShift) {\n            shift = this.options.projectedShift();\n        }\n        if (shift === null) {\n            shift = this.shiftProjectedFitMapView();\n        }\n\n        if (flat) {\n            ring = [];\n            for (i = 0; i < len; i++) {\n                let p = this._map.latLngToLayerPoint(latlngs[i]);\n                p.x += shift;\n                ring[i] = p;\n                projectedBounds.extend(p);\n            }\n            result.push(ring);\n        } else {\n            for (i = 0; i < len; i++) {\n                this._projectLatlngs(latlngs[i], result, projectedBounds);\n            }\n        }\n    };\n\n    // Shift marker longitude by +360 or -360, which is closer to map view center\n    // Longitude is changed only for positioning html-element, Marker._latlng is not changed\n    // Breaks display of markers with huge longitudes like 750 (can be displayed only at zoom levels 0 or 1)\n    L.Marker.prototype.update = function() {\n        if (this._icon) {\n            var pos = this._map.latLngToLayerPoint(this._latlng).round();\n            let shift = null;\n            if (this.options.projectedShift) {\n                shift = this.options.projectedShift();\n            }\n            if (shift === null) {\n                const mapCenter = this._map.getCenter();\n                const worldWidth = this._map.getPixelWorldBounds().getSize().x;\n                if (this._latlng.lng < mapCenter.lng - 180) {\n                    shift = worldWidth;\n                } else if (this._latlng.lng > mapCenter.lng + 180) {\n                    shift = -worldWidth;\n                } else {\n                    shift = 0;\n                }\n            }\n            pos.x += shift;\n            this._setPos(pos);\n        }\n\n        return this;\n    };\n\n    // Emit viewreset event when longitude of map view center changes more then 90 degrees from prevoius reset\n    L.Map.addInitHook(function() {\n        this._lastResetLongitude = null;\n        this.on('viewreset', () => {\n            this._lastResetLongitude = this.getCenter().lng;\n        });\n\n        this.on('move', () => {\n            const lng = this.getCenter().lng;\n            if (this._lastResetLongitude === null) {\n                this._lastResetLongitude = lng;\n            } else if (Math.abs(lng - this._lastResetLongitude) > 90) {\n                this.fire('viewreset');\n            }\n        });\n    });\n\n    // Avoid marker longitude change from 180 to -180 while dragging.\n    L.Handler.MarkerDrag = L.Handler.extend({\n        _onDrag: function(e) {\n            var marker = this._marker,\n                shadow = marker._shadow,\n                iconPos = L.DomUtil.getPosition(marker._icon),\n                latlng = marker._map.layerPointToLatLng(iconPos);\n            // update shadow position\n            if (shadow) {\n                L.DomUtil.setPosition(shadow, iconPos);\n            }\n\n            latlng = wrapLatLngToTarget(latlng, marker._latlng);\n            marker._latlng = latlng;\n            e.latlng = latlng;\n            e.oldLatLng = this._oldLatLng;\n\n            // @event drag: Event\n            // Fired repeatedly while the user drags the marker.\n            marker\n                .fire('move', e)\n                .fire('drag', e);\n        }\n    });\n}\n\nexport {wrapLatLngToTarget, fixVectorMarkerWorldJump, wrapLatLngBoundsToTarget};\n","/* FileSaver.js\n * A saveAs() FileSaver implementation.\n * 1.3.8\n * 2018-03-22 14:03:47\n *\n * By Eli Grey, https://eligrey.com\n * License: MIT\n *   See https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md\n */\n\n/*global self */\n/*jslint bitwise: true, indent: 4, laxbreak: true, laxcomma: true, smarttabs: true, plusplus: true */\n\n/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/src/FileSaver.js */\n\nexport var saveAs = saveAs || (function(view) {\n        \"use strict\";\n        // IE <10 is explicitly unsupported\n        if (typeof view === \"undefined\" || typeof navigator !== \"undefined\" && /MSIE [1-9]\\./.test(navigator.userAgent)) {\n            return;\n        }\n        var\n            doc = view.document\n            // only get URL when necessary in case Blob.js hasn't overridden it yet\n            , get_URL = function() {\n                return view.URL || view.webkitURL || view;\n            }\n            , save_link = doc.createElementNS(\"http://www.w3.org/1999/xhtml\", \"a\")\n            , can_use_save_link = \"download\" in save_link\n            , click = function(node) {\n                var event = new MouseEvent(\"click\");\n                node.dispatchEvent(event);\n            }\n            , is_safari = /constructor/i.test(view.HTMLElement) || view.safari\n            , is_chrome_ios =/CriOS\\/[\\d]+/.test(navigator.userAgent)\n            , setImmediate = view.setImmediate || view.setTimeout\n            , throw_outside = function(ex) {\n                setImmediate(function() {\n                    throw ex;\n                }, 0);\n            }\n            , force_saveable_type = \"application/octet-stream\"\n            // the Blob API is fundamentally broken as there is no \"downloadfinished\" event to subscribe to\n            , arbitrary_revoke_timeout = 1000 * 40 // in ms\n            , revoke = function(file) {\n                var revoker = function() {\n                    if (typeof file === \"string\") { // file is an object URL\n                        get_URL().revokeObjectURL(file);\n                    } else { // file is a File\n                        file.remove();\n                    }\n                };\n                setTimeout(revoker, arbitrary_revoke_timeout);\n            }\n            , dispatch = function(filesaver, event_types, event) {\n                event_types = [].concat(event_types);\n                var i = event_types.length;\n                while (i--) {\n                    var listener = filesaver[\"on\" + event_types[i]];\n                    if (typeof listener === \"function\") {\n                        try {\n                            listener.call(filesaver, event || filesaver);\n                        } catch (ex) {\n                            throw_outside(ex);\n                        }\n                    }\n                }\n            }\n            , auto_bom = function(blob) {\n                // prepend BOM for UTF-8 XML and text/* types (including HTML)\n                // note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\n                if (/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n                    return new Blob([String.fromCharCode(0xFEFF), blob], {type: blob.type});\n                }\n                return blob;\n            }\n            , FileSaver = function(blob, name, no_auto_bom) {\n                if (!no_auto_bom) {\n                    blob = auto_bom(blob);\n                }\n                // First try a.download, then web filesystem, then object URLs\n                var\n                    filesaver = this\n                    , type = blob.type\n                    , force = type === force_saveable_type\n                    , object_url\n                    , dispatch_all = function() {\n                        dispatch(filesaver, \"writestart progress write writeend\".split(\" \"));\n                    }\n                    // on any filesys errors revert to saving with object URLs\n                    , fs_error = function() {\n                        if ((is_chrome_ios || (force && is_safari)) && view.FileReader) {\n                            // Safari doesn't allow downloading of blob urls\n                            var reader = new FileReader();\n                            reader.onloadend = function() {\n                                var url = is_chrome_ios ? reader.result : reader.result.replace(/^data:[^;]*;/, 'data:attachment/file;');\n                                var popup = view.open(url, '_blank');\n                                if(!popup) view.location.href = url;\n                                url=undefined; // release reference before dispatching\n                                filesaver.readyState = filesaver.DONE;\n                                dispatch_all();\n                            };\n                            reader.readAsDataURL(blob);\n                            filesaver.readyState = filesaver.INIT;\n                            return;\n                        }\n                        // don't create more object URLs than needed\n                        if (!object_url) {\n                            object_url = get_URL().createObjectURL(blob);\n                        }\n                        if (force) {\n                            view.location.href = object_url;\n                        } else {\n                            var opened = view.open(object_url, \"_blank\");\n                            if (!opened) {\n                                // Apple does not allow window.open, see https://developer.apple.com/library/safari/documentation/Tools/Conceptual/SafariExtensionGuide/WorkingwithWindowsandTabs/WorkingwithWindowsandTabs.html\n                                view.location.href = object_url;\n                            }\n                        }\n                        filesaver.readyState = filesaver.DONE;\n                        dispatch_all();\n                        revoke(object_url);\n                    }\n                    ;\n                filesaver.readyState = filesaver.INIT;\n\n                if (can_use_save_link) {\n                    object_url = get_URL().createObjectURL(blob);\n                    setImmediate(function() {\n                        save_link.href = object_url;\n                        save_link.download = name;\n                        save_link.target = '_self';\n                        click(save_link);\n                        dispatch_all();\n                        revoke(object_url);\n                        filesaver.readyState = filesaver.DONE;\n                    }, 0);\n                    return;\n                }\n\n                fs_error();\n            }\n            , FS_proto = FileSaver.prototype\n            , saveAs = function(blob, name, no_auto_bom) {\n                return new FileSaver(blob, name || blob.name || \"download\", no_auto_bom);\n            }\n            ;\n\n        // IE 10+ (native saveAs)\n        if (typeof navigator !== \"undefined\" && navigator.msSaveOrOpenBlob) {\n            return function(blob, name, no_auto_bom) {\n                name = name || blob.name || \"download\";\n\n                if (!no_auto_bom) {\n                    blob = auto_bom(blob);\n                }\n                return navigator.msSaveOrOpenBlob(blob, name);\n            };\n        }\n\n        // todo: detect chrome extensions & packaged apps\n        //save_link.target = \"_blank\";\n\n        FS_proto.abort = function(){};\n        FS_proto.readyState = FS_proto.INIT = 0;\n        FS_proto.WRITING = 1;\n        FS_proto.DONE = 2;\n\n        FS_proto.error =\n            FS_proto.onwritestart =\n                FS_proto.onprogress =\n                    FS_proto.onwrite =\n                        FS_proto.onabort =\n                            FS_proto.onerror =\n                                FS_proto.onwriteend =\n                                    null;\n\n        return saveAs;\n    }(\n        typeof self !== \"undefined\" && self\n        || typeof window !== \"undefined\" && window\n        || this\n    ));\n","import L from 'leaflet';\nimport ko from 'knockout';\nimport Contextmenu from '~/lib/contextmenu';\nimport '~/lib/knockout.component.progress/progress';\nimport './track-list.css';\nimport {selectFiles, readFiles} from '~/lib/file-read';\nimport parseGeoFile from './lib/parseGeoFile';\nimport loadFromUrl from './lib/loadFromUrl';\nimport * as geoExporters from './lib/geo_file_exporters';\nimport copyToClipboard from '~/lib/clipboardCopy';\nimport {saveAs} from '~/vendored/github.com/eligrey/FileSaver';\nimport '~/lib/leaflet.layer.canvasMarkers';\nimport '~/lib/leaflet.lineutil.simplifyLatLngs';\nimport iconFromBackgroundImage from '~/lib/iconFromBackgroundImage';\nimport '~/lib/controls-styles/controls-styles.css';\nimport {ElevationProfile, calcSamplingInterval} from '~/lib/leaflet.control.elevation-profile';\nimport '~/lib/leaflet.control.commons';\nimport {blobFromString} from '~/lib/binary-strings';\nimport '~/lib/leaflet.polyline-edit';\nimport '~/lib/leaflet.polyline-measure';\nimport * as logging from '~/lib/logging';\nimport {notify, query} from '~/lib/notifications';\nimport {fetch} from '~/lib/xhr-promise';\nimport config from '~/config';\nimport md5 from 'blueimp-md5';\nimport {wrapLatLngToTarget, wrapLatLngBoundsToTarget} from '~/lib/leaflet.fixes/fixWorldCopyJump';\nimport {splitLinesAt180Meridian} from \"./lib/meridian180\";\nimport {ElevationProvider} from '~/lib/elevations';\n\nconst TRACKLIST_TRACK_COLORS = ['#77f', '#f95', '#0ff', '#f77', '#f7f', '#ee5'];\n\nconst TrackSegment = L.MeasuredLine.extend({\n    includes: L.Polyline.EditMixin,\n\n    options: {\n        weight: 6,\n        lineCap: 'round',\n        opacity: 0.5,\n\n    }\n});\nTrackSegment.mergeOptions(L.Polyline.EditMixinOptions);\n\nfunction unwrapLatLngsCrossing180Meridian(latngs) {\n    if (latngs.length === 0) {\n        return [];\n    }\n    const unwrapped = [latngs[0]];\n    let lastUnwrapped;\n    let prevUnwrapped = latngs[0];\n    for (let i = 1; i < latngs.length; i++) {\n        lastUnwrapped = wrapLatLngToTarget(latngs[i], prevUnwrapped);\n        unwrapped.push(lastUnwrapped);\n        prevUnwrapped = lastUnwrapped;\n    }\n    return unwrapped;\n}\n\nfunction closestPointToLineSegment(latlngs, segmentIndex, point) {\n    const crs = L.CRS.EPSG3857;\n    point = crs.latLngToPoint(point);\n    const segStart = crs.latLngToPoint(latlngs[segmentIndex]);\n    const segEnd = crs.latLngToPoint(latlngs[segmentIndex + 1]);\n    return crs.pointToLatLng(L.LineUtil.closestPointOnSegment(point, segStart, segEnd));\n}\n\nfunction isPointCloserToStart(latlngs, latlng) {\n    const distToStart = latlng.distanceTo(latlngs[0]);\n    const distToEnd = latlng.distanceTo(latlngs[latlngs.length - 1]);\n    return distToStart < distToEnd;\n}\n\nL.Control.TrackList = L.Control.extend({\n        options: {\n            position: 'bottomright',\n            lineCursorStyle: {interactive: false, weight: 1.5, opacity: 1, dashArray: '7,7'},\n            lineCursorValidStyle: {color: 'green'},\n            lineCursorInvalidStyle: {color: 'red'},\n            splitExtensions: ['gpx', 'kml', 'kmz', 'wpt', 'rte', 'plt', 'fit', 'tmp', 'jpg', 'crdownload'],\n            splitExtensionsFirstStage: ['xml', 'txt', 'html', 'php', 'tmp', 'gz'],\n        },\n        includes: L.Evented,\n\n        colors: TRACKLIST_TRACK_COLORS,\n\n        initialize: function() {\n            L.Control.prototype.initialize.call(this);\n            this.tracks = ko.observableArray();\n            this.url = ko.observable('');\n            this.readingFiles = ko.observable(0);\n            this.readProgressRange = ko.observable();\n            this.readProgressDone = ko.observable();\n            this._lastTrackColor = 0;\n            this.trackListHeight = ko.observable(0);\n            this.isPlacingPoint = false;\n            this.trackAddingPoint = ko.observable(null);\n            this.trackAddingSegment = ko.observable(null);\n        },\n\n        onAdd: function(map) {\n            this.map = map;\n            this.tracks.removeAll();\n            var container = this._container = L.DomUtil.create('div', 'leaflet-control leaflet-control-tracklist');\n            this._stopContainerEvents();\n\n            /* eslint-disable max-len */\n            container.innerHTML = `\n                <div class=\"leaflet-control-button-toggle\" data-bind=\"click: setExpanded\"\n                 title=\"Load, edit and save tracks\"></div>\n                <div class=\"leaflet-control-content\">\n                <div class=\"header\">\n                    <div class=\"hint\"\n                     title=\"gpx kml Ozi zip YandexMaps GPSies Strava GPSLib Endomondo Etomesto Movescount GarminConnect SportsTracker OSM Tracedetrail OpenStreetMap.ru\">\n                        gpx kml Ozi zip YandexMaps GPSies Strava\n                        <span class=\"formats-hint-more\">&hellip;</span>\n                    </div>\n                    <div class=\"button-minimize\" data-bind=\"click: setMinimized\"></div>\n                </div>\n                <div class=\"inputs-row\" data-bind=\"visible: !readingFiles()\">\n                    <a class=\"button add-track\" title=\"  \" data-bind=\"click: onButtonNewTrackClicked\"></a\n                    ><a class=\"button open-file\" title=\"   \" data-bind=\"click: loadFilesFromDisk\"></a\n                    ><input type=\"text\" class=\"input-url\" placeholder=\"URL \"\n                        data-bind=\"textInput: url, event: {keypress: onEnterPressedInInput, contextmenu: defaultEventHandle, mousemove: defaultEventHandle}\"\n                    ><a class=\"button download-url\" title=\"   URL\" data-bind=\"click: loadFilesFromUrl\"></a\n                    ><a class=\"button menu-icon\" data-bind=\"click: function(_,e){this.showMenu(e)}\" title=\"\"></a>\n                </div>\n                <div style=\"text-align: center\">\n                    <div data-bind=\"\n                        component: {\n                        name: 'progress-indicator',\n                        params: {progressRange: readProgressRange, progressDone: readProgressDone}\n                        },\n                        visible: readingFiles\"></div>\n                </div>\n                <div class=\"tracks-rows-wrapper\" data-bind=\"style: {maxHeight: trackListHeight}\">\n                <table class=\"tracks-rows\"><tbody data-bind=\"foreach: {data: tracks, as: 'track'}\">\n                    <tr data-bind=\"event: {\n                                       contextmenu: $parent.showTrackMenu.bind($parent),\n                                       mouseenter: $parent.onTrackRowMouseEnter.bind($parent, track),\n                                       mouseleave: $parent.onTrackRowMouseLeave.bind($parent, track)\n                                   },\n                                   css: {hover: hover() && $parent.tracks().length > 1, edit: isEdited() && $parent.tracks().length > 1}\">\n                        <td><input type=\"checkbox\" class=\"visibility-switch\" data-bind=\"checked: track.visible\"></td>\n                        <td><div class=\"color-sample\" data-bind=\"style: {backgroundColor: $parent.colors[track.color()]}, click: $parent.onColorSelectorClicked.bind($parent)\"></div></td>\n                        <td><div class=\"track-name-wrapper\"><div class=\"track-name\" data-bind=\"text: track.name, attr: {title: track.name}, click: $parent.setViewToTrack.bind($parent)\"></div></div></td>\n                        <td>\n                            <div class=\"button-length\" title=\"Show distance marks\" data-bind=\"\n                                text: $parent.formatLength(track.length()),\n                                css: {'ticks-enabled': track.measureTicksShown},\n                                click: $parent.switchMeasureTicksVisibility.bind($parent)\"></div>\n                        </td>\n                        <td><div class=\"button-add-track\" title=\" \" data-bind=\"click: $parent.onButtonAddSegmentClicked.bind($parent, track), css: {active: $parent.trackAddingSegment() === track}\"></div></td>\n                        <td><div class=\"button-add-point\" title=\" \" data-bind=\"click: $parent.onButtonAddPointClicked.bind($parent, track), css: {active: $parent.trackAddingPoint() === track}\"></div></td>\n                        <td><a class=\"track-text-button\" title=\"\" data-bind=\"click: $parent.showTrackMenu.bind($parent)\">&hellip;</a></td>\n                    </tr>\n                </tbody></table>\n                </div>\n                </div>\n            `;\n            /* eslint-enable max-len */\n\n            ko.applyBindings(this, container);\n            // FIXME: add onRemove method and unsubscribe\n            L.DomEvent.addListener(map.getContainer(), 'drop', this.onFileDragDrop, this);\n            L.DomEvent.addListener(map.getContainer(), 'dragover', this.onFileDraging, this);\n            this.menu = new Contextmenu([\n                    {text: '    ', callback: this.copyAllTracksToClipboard.bind(this)},\n                    {text: '    ', callback: this.copyVisibleTracks.bind(this)},\n                    '-',\n                    {text: '  ', callback: this.deleteAllTracks.bind(this)},\n                    {text: '  ', callback: this.deleteHiddenTracks.bind(this)}\n                ]\n            );\n            this._markerLayer = new L.Layer.CanvasMarkers(null, {\n                print: true,\n                scaleDependent: true,\n                zIndex: 1000,\n                printTransparent: true\n            }).addTo(map);\n            this._markerLayer.on('markerclick markercontextmenu', this.onMarkerClick, this);\n            this._markerLayer.on('markerenter', this.onMarkerEnter, this);\n            this._markerLayer.on('markerleave', this.onMarkerLeave, this);\n            map.on('resize', this._setAdaptiveHeight, this);\n            setTimeout(() => this._setAdaptiveHeight(), 0);\n            return container;\n        },\n\n        defaultEventHandle: function(_, e) {\n            L.DomEvent.stopPropagation(e);\n            return true;\n        },\n\n        _setAdaptiveHeight: function() {\n            const mapHeight = this._map.getSize().y;\n            let maxHeight;\n            maxHeight =\n                mapHeight -\n                this._container.offsetTop - // controls above\n                // controls below\n                (this._container.parentNode.offsetHeight - this._container.offsetTop - this._container.offsetHeight) -\n                105; // margin\n            this.trackListHeight(maxHeight + 'px');\n        },\n\n        setExpanded: function() {\n            L.DomUtil.removeClass(this._container, 'minimized');\n        },\n\n        setMinimized: function() {\n            L.DomUtil.addClass(this._container, 'minimized');\n        },\n\n        onFileDraging: function(e) {\n            L.DomEvent.stopPropagation(e);\n            L.DomEvent.preventDefault(e);\n            e.dataTransfer.dropEffect = 'copy';\n        },\n\n        onFileDragDrop: function(e) {\n            L.DomEvent.stopPropagation(e);\n            L.DomEvent.preventDefault(e);\n            const files = e.dataTransfer.files;\n            if (files && files.length) {\n                this.loadFilesFromFilesObject(files);\n            }\n        },\n\n        onEnterPressedInInput: function(this_, e) {\n            if (e.keyCode === 13) {\n                this_.loadFilesFromUrl();\n                L.DomEvent.stop(e);\n                return false;\n            }\n            return true;\n        },\n\n        getTrackPolylines: function(track) {\n            return track.feature.getLayers().filter(function(layer) {\n                    return layer instanceof L.Polyline;\n                }\n            );\n        },\n\n        getTrackPoints: function(track) {\n            return track.markers;\n        },\n\n        onButtonNewTrackClicked: function() {\n            let name = this.url().trim();\n            if (name.length > 0) {\n                this.url('');\n            } else {\n                name = ' ';\n            }\n            this.addTrackAndEdit(name);\n        },\n\n        addSegmentAndEdit: function(track) {\n            this.stopPlacingPoint();\n            const segment = this.addTrackSegment(track);\n            this.startEditTrackSegement(segment);\n            segment.startDrawingLine();\n            this.trackAddingSegment(track);\n        },\n\n        addTrackAndEdit: function(name) {\n            const track = this.addTrack({name: name});\n            this.addSegmentAndEdit(track);\n            return track;\n        },\n\n        loadFilesFromFilesObject: function(files) {\n            this.readingFiles(this.readingFiles() + 1);\n\n            readFiles(files).then(function(fileDataArray) {\n                const geodataArray = [];\n                for (let fileData of fileDataArray) {\n                        geodataArray.push(...parseGeoFile(fileData.filename, fileData.data));\n                }\n                this.readingFiles(this.readingFiles() - 1);\n\n                this.addTracksFromGeodataArray(geodataArray);\n            }.bind(this));\n        },\n\n        loadFilesFromDisk: function() {\n            logging.captureBreadcrumb('load track from disk');\n            selectFiles(true).then(this.loadFilesFromFilesObject.bind(this));\n        },\n\n        loadFilesFromUrl: function() {\n            var url = this.url().trim();\n            if (!url) {\n                return;\n            }\n\n            this.readingFiles(this.readingFiles() + 1);\n\n            logging.captureBreadcrumb('load track from url', {trackUrl: url});\n            loadFromUrl(url)\n                .then((geodata) => {\n                    this.addTracksFromGeodataArray(geodata);\n                    this.readingFiles(this.readingFiles() - 1);\n                });\n            this.url('');\n        },\n\n        whenLoadDone: function(cb) {\n            if (this.readingFiles() === 0) {\n                cb();\n                return;\n            }\n            const subscription = this.readingFiles.subscribe((value) => {\n                if (value === 0) {\n                    subscription.dispose();\n                    cb();\n                }\n            });\n        },\n\n        addTracksFromGeodataArray: function(geodata_array) {\n            let hasData = false;\n            var messages = [];\n            if (geodata_array.length === 0) {\n                messages.push('No tracks loaded');\n            }\n            geodata_array.forEach(function(geodata) {\n                    var data_empty = !((geodata.tracks && geodata.tracks.length) ||\n                        (geodata.points && geodata.points.length));\n\n                    if (!data_empty) {\n                        if (geodata.tracks) {\n                            geodata.tracks = geodata.tracks.map(function(line) {\n                                    line = unwrapLatLngsCrossing180Meridian(line);\n                                    line = L.LineUtil.simplifyLatlngs(line, 360 / (1 << 24));\n                                    if (line.length === 1) {\n                                        line.push(line[0]);\n                                    }\n                                    return line;\n                                }\n                            );\n                        }\n                        hasData = true;\n                        this.addTrack(geodata);\n                    }\n                    var error_messages = {\n                        CORRUPT: 'File \"{name}\" is corrupt',\n                        UNSUPPORTED: 'File \"{name}\" has unsupported format or is badly corrupt',\n                        NETWORK: 'Could not download file from url \"{name}\"',\n                        INVALID_URL: '\"{name}\"  is not of supported URL type',\n                    };\n                    var message;\n                    if (geodata.error) {\n                        message = error_messages[geodata.error] || geodata.error;\n                        if (data_empty) {\n                            message += ', no data could be loaded';\n                        } else {\n                            message += ', loaded data can be invalid or incomplete';\n                        }\n                    }\n                    if (message) {\n                        message = L.Util.template(message, {name: geodata.name});\n                        messages.push(message);\n                    }\n                }.bind(this)\n            );\n            if (messages.length) {\n                notify(messages.join('\\n'));\n            }\n            return hasData;\n        },\n\n        onTrackColorChanged: function(track) {\n            var color = this.colors[track.color()];\n            this.getTrackPolylines(track).forEach(\n                function(polyline) {\n                    polyline.setStyle({color: color});\n                }\n            );\n            var markers = this.getTrackPoints(track);\n            markers.forEach(this.setMarkerIcon.bind(this));\n            this._markerLayer.updateMarkers(markers);\n        },\n\n        onTrackVisibilityChanged: function(track) {\n            if (track.visible()) {\n                this.map.addLayer(track.feature);\n                this._markerLayer.addMarkers(track.markers);\n            } else {\n                if (this.trackAddingPoint() === track) {\n                    this.stopPlacingPoint();\n                }\n                this.map.removeLayer(track.feature);\n                this._markerLayer.removeMarkers(track.markers);\n            }\n            this.updateTrackHighlight();\n        },\n\n        onTrackSegmentNodesChanged: function(track, segment) {\n            if (segment.getFixedLatLngs().length > 0) {\n                this.trackAddingSegment(null);\n            }\n            this.recalculateTrackLength(track);\n        },\n\n        recalculateTrackLength: function(track) {\n            const lines = this.getTrackPolylines(track);\n            let length = 0;\n            for (let line of lines) {\n                length += line.getLength();\n            }\n            track.length(length);\n        },\n\n        formatLength: function(x) {\n            var digits = 0;\n            if (x < 10000) {\n                digits = 2;\n            } else if (x < 100000) {\n                digits = 1;\n            }\n            return (x / 1000).toFixed(digits) + ' km';\n        },\n\n        setTrackMeasureTicksVisibility: function(track) {\n            var visible = track.measureTicksShown(),\n                lines = this.getTrackPolylines(track);\n            lines.forEach((line) => line.setMeasureTicksVisible(visible));\n        },\n\n        switchMeasureTicksVisibility: function(track) {\n            track.measureTicksShown(!(track.measureTicksShown()));\n        },\n\n        onColorSelectorClicked: function(track, e) {\n            track._contextmenu.show(e);\n        },\n\n        setViewToTrack: function(track) {\n            this.setViewToBounds(this.getTrackBounds(track));\n        },\n\n        setViewToAllTracks: function(immediate) {\n            const bounds = L.latLngBounds([]);\n            for (let track of this.tracks()) {\n                bounds.extend(this.getTrackBounds(track));\n            }\n            this.setViewToBounds(bounds, immediate);\n        },\n\n        setViewToBounds: function(bounds, immediate) {\n            if (bounds && bounds.isValid()) {\n                bounds = wrapLatLngBoundsToTarget(bounds, this.map.getCenter());\n                if (L.Browser.mobile || immediate) {\n                    this.map.fitBounds(bounds, {maxZoom: 16});\n                } else {\n                    this.map.flyToBounds(bounds, {maxZoom: 16});\n                }\n            }\n        },\n\n        getTrackBounds: function(track) {\n            const lines = this.getTrackPolylines(track);\n            const points = this.getTrackPoints(track);\n            const bounds = L.latLngBounds([]);\n            if (lines.length || points.length) {\n                lines.forEach((l) => {\n                        if (l.getLatLngs().length > 1) {\n                            bounds.extend(wrapLatLngBoundsToTarget(l.getBounds(), bounds));\n                        }\n                    }\n                );\n                points.forEach((p) => {\n                        bounds.extend(wrapLatLngToTarget(p.latlng, bounds));\n                    }\n                );\n            }\n            return bounds;\n        },\n\n        attachColorSelector: function(track) {\n            var items = this.colors.map(function(color, index) {\n                    return {\n                        text: '<div style=\"display: inline-block; vertical-align: middle; width: 50px; height: 0; ' +\n                            'border-top: 4px solid ' + color + '\"></div>',\n                        callback: track.color.bind(null, index)\n                    };\n                }\n            );\n            track._contextmenu = new Contextmenu(items);\n        },\n\n        attachActionsMenu: function(track) {\n            var items = [\n                function() {\n                    return {text: `${track.name()}`, header: true};\n                },\n                '-',\n                {text: '', callback: this.renameTrack.bind(this, track)},\n                {text: '', callback: this.duplicateTrack.bind(this, track)},\n                {text: '', callback: this.reverseTrack.bind(this, track)},\n                {text: '  ', callback: this.showElevationProfileForTrack.bind(this, track)},\n                '-',\n                {text: '', callback: this.removeTrack.bind(this, track)},\n                '-',\n                {text: ' GPX', callback: this.saveTrackAsFile.bind(this, track, geoExporters.saveGpx, '.gpx')},\n                {text: ' KML', callback: this.saveTrackAsFile.bind(this, track, geoExporters.saveKml, '.kml')},\n                {text: '   ', callback: this.copyTrackLinkToClipboard.bind(this, track)},\n                {text: '', separator: true},\n                {\n                    text: ' GPX   ',\n                    callback: this.saveTrackAsFile.bind(this, track, geoExporters.saveGpxWithElevations, '.gpx', true),\n                },\n            ];\n            track._actionsMenu = new Contextmenu(items);\n        },\n\n        onButtonAddSegmentClicked: function(track) {\n            if (!track.visible()) {\n                return;\n            }\n            if (this.trackAddingSegment() === track) {\n                this.trackAddingSegment(null);\n                this.stopEditLine();\n            } else {\n                this.addSegmentAndEdit(track);\n            }\n        },\n\n        duplicateTrack: function(track) {\n            const segments = this.getTrackPolylines(track).map((line) =>\n                line.getLatLngs().map((latlng) => [latlng.lat, latlng.lng])\n            );\n            const points = this.getTrackPoints(track)\n                .map((point) => ({lat: point.latlng.lat, lng: point.latlng.lng, name: point.label}));\n            this.addTrack({name: track.name(), tracks: segments, points});\n        },\n\n        reverseTrackSegment: function(trackSegment) {\n            trackSegment.stopDrawingLine();\n            var latlngs = trackSegment.getLatLngs();\n            latlngs = latlngs.map(function(ll) {\n                    return [ll.lat, ll.lng];\n                }\n            );\n            latlngs.reverse();\n            var isEdited = (this._editedLine === trackSegment);\n            this.deleteTrackSegment(trackSegment);\n            var newTrackSegment = this.addTrackSegment(trackSegment._parentTrack, latlngs);\n            if (isEdited) {\n                this.startEditTrackSegement(newTrackSegment);\n            }\n        },\n\n        reverseTrack: function(track) {\n            var that = this;\n            this.getTrackPolylines(track).forEach(function(trackSegment) {\n                    that.reverseTrackSegment(trackSegment);\n                }\n            );\n        },\n\n        copyTracksLinkToClipboard: function(tracks, mouseEvent) {\n            if (!tracks.length) {\n                notify('No tracks to copy');\n                return;\n            }\n            let serialized = tracks.map((track) => this.trackToString(track)).join('/');\n            const hashDigest = md5(serialized, null, true);\n            const key = btoa(hashDigest).replace(/\\//ug, '_').replace(/\\+/ug, '-').replace(/=/ug, '');\n            const url = window.location + '&nktl=' + key;\n            copyToClipboard(url, mouseEvent);\n            fetch(`${config.tracksStorageServer}/track/${key}`, {\n                method: 'POST',\n                data: serialized,\n                withCredentials: true\n            }).then(\n                null, (e) => {\n                    let message = e.message || e;\n                    if (e.xhr.status === 413) {\n                        message = 'track is too big';\n                    }\n                    logging.captureMessage('Failed to save track to server',\n                        {status: e.xhr.status, response: e.xhr.responseText});\n                    notify('Error making link: ' + message);\n                }\n            );\n        },\n\n        copyTrackLinkToClipboard: function(track, mouseEvent) {\n            this.copyTracksLinkToClipboard([track], mouseEvent);\n        },\n\n        saveTrackAsFile: async function(track, exporter, extension, addElevations = false) {\n            var lines = this.getTrackPolylines(track)\n                .map(function(line) {\n                        return line.getFixedLatLngs();\n                    }\n                );\n            lines = splitLinesAt180Meridian(lines);\n            var points = this.getTrackPoints(track);\n            let name = track.name();\n            // Browser (Chrome) removes leading dots.\n            name = name.replace(/^\\./u, '_');\n            for (let extensions of [this.options.splitExtensionsFirstStage, this.options.splitExtensions]) {\n                let i = name.lastIndexOf('.');\n                if (i > -1 && extensions.includes(name.slice(i + 1).toLowerCase())) {\n                    name = name.slice(0, i);\n                }\n            }\n            if (lines.length === 0 && points.length === 0) {\n                notify('Track is empty, nothing to save');\n                return;\n            }\n\n            if (addElevations) {\n                const request = [\n                    ...points.map((p) => p.latlng),\n                    ...lines.reduce((acc, cur) => {\n                        acc.push(...cur);\n                        return acc;\n                    }, [])\n                ];\n                let elevations;\n                try {\n                    elevations = await new ElevationProvider().get(request);\n                } catch (e) {\n                    logging.captureException(e, 'error getting elevation for gpx');\n                    notify(`Failed to get elevation data: ${e.message}`);\n                }\n                let n = 0;\n                for (let p of points) {\n                    // we make copy of latlng as we are changing it\n                    p.latlng = L.latLng(p.latlng.lat, p.latlng.lng, elevations[n]);\n                    n += 1;\n                }\n                for (let line of lines) {\n                    for (let p of line) {\n                        // we do not need to create new LatLng since splitLinesAt180Meridian() have already done it\n                        p.alt = elevations[n];\n                        n += 1;\n                    }\n                }\n            }\n\n            var fileText = exporter(lines, name, points);\n            var filename = name + extension;\n            saveAs(blobFromString(fileText), filename, true);\n        },\n\n        renameTrack: function(track) {\n            var newName = query('Enter new name', track.name());\n            if (newName && newName.length) {\n                track.name(newName);\n            }\n        },\n\n        showTrackMenu: function(track, e) {\n            track._actionsMenu.show(e);\n        },\n\n        showMenu: function(e) {\n            this.menu.show(e);\n        },\n\n        stopEditLine: function() {\n            if (this._editedLine) {\n                this._editedLine.stopEdit();\n            }\n        },\n\n        onTrackSegmentClick: function(e) {\n            if (this.isPlacingPoint) {\n                return;\n            }\n            const trackSegment = e.target;\n            if (this._lineJoinActive) {\n                L.DomEvent.stopPropagation(e);\n                this.joinTrackSegments(trackSegment, isPointCloserToStart(e.target.getLatLngs(), e.latlng));\n            } else {\n                this.startEditTrackSegement(trackSegment);\n                L.DomEvent.stopPropagation(e);\n            }\n        },\n\n        startEditTrackSegement: function(polyline) {\n            if (this._editedLine && this._editedLine !== polyline) {\n                this.stopEditLine();\n            }\n            polyline.startEdit();\n            this._editedLine = polyline;\n            polyline.once('editend', this.onLineEditEnd, this);\n            polyline.fire('startedit');\n        },\n\n        onButtonAddPointClicked: function(track) {\n            if (!track.visible()) {\n                return;\n            }\n            if (this.trackAddingPoint() === track) {\n                this.stopPlacingPoint();\n            } else {\n                this.beginPointCreate(track);\n            }\n        },\n\n        _beginPointEdit: function() {\n            this.stopPlacingPoint();\n            this.stopEditLine();\n            L.DomUtil.addClass(this._map._container, 'leaflet-point-placing');\n            this.isPlacingPoint = true;\n            L.DomEvent.on(document, 'keydown', this.stopPlacingPointOnEscPressed, this);\n            this._map.fire('startedit');\n        },\n\n        beginPointMove: function(marker) {\n            this._beginPointEdit();\n            this._movingMarker = marker;\n            this.map.on('click', this.movePoint, this);\n        },\n\n        beginPointCreate: function(track) {\n            this._beginPointEdit();\n            this.map.on('click', this.createNewPoint, this);\n            this.trackAddingPoint(track);\n        },\n\n        movePoint: function(e) {\n            const marker = this._movingMarker;\n            const newLatLng = e.latlng.wrap();\n            this._markerLayer.setMarkerPosition(marker, newLatLng);\n            this.stopPlacingPoint();\n        },\n\n        getNewPointName: function(track) {\n            let maxNumber = 0;\n            for (let marker of track.markers) {\n                const label = marker.label;\n                if (label.match(/^\\d{3}([^\\d.]|$)/u)) {\n                    maxNumber = parseInt(label, 10);\n                }\n            }\n            return maxNumber === 999 ? '' : String(maxNumber + 1).padStart(3, '0');\n        },\n\n        createNewPoint: function(e) {\n            if (!this.isPlacingPoint) {\n                return;\n            }\n            const parentTrack = this.trackAddingPoint();\n            const name = e.suggested && this._map.suggestedPoint?.title || this.getNewPointName(parentTrack);\n            const newLatLng = e.latlng.wrap();\n            const marker = this.addPoint(parentTrack, {name: name, lat: newLatLng.lat, lng: newLatLng.lng});\n            this._markerLayer.addMarker(marker);\n            // we need to show prompt after marker is dispalyed;\n            // grid layer is updated in setTimout(..., 0)after adding marker\n            // it is better to do it on 'load' event but when it is fired marker is not yet displayed\n            setTimeout(() => {\n                this.renamePoint(marker);\n                this.beginPointCreate(parentTrack);\n            }, 10);\n        },\n\n        stopPlacingPointOnEscPressed: function(e) {\n            if (e.keyCode === 27) {\n                this.stopPlacingPoint();\n            }\n        },\n\n        stopPlacingPoint: function() {\n            this.isPlacingPoint = false;\n            this.trackAddingPoint(null);\n            L.DomUtil.removeClass(this._map._container, 'leaflet-point-placing');\n            L.DomEvent.off(document, 'keydown', this.stopPlacingPointOnEscPressed, this);\n            this.map.off('click', this.createNewPoint, this);\n            this.map.off('click', this.movePoint, this);\n        },\n\n        joinTrackSegments: function(newSegment, joinToStart) {\n            this.hideLineCursor();\n            var originalSegment = this._editedLine;\n            var latlngs = originalSegment.getLatLngs(),\n                latngs2 = newSegment.getLatLngs();\n            if (joinToStart === this._lineJoinFromStart) {\n                latngs2.reverse();\n            }\n            if (this._lineJoinFromStart) {\n                latlngs.unshift(...latngs2);\n            } else {\n                latlngs.push(...latngs2);\n            }\n            latlngs = latlngs.map(function(ll) {\n                    return [ll.lat, ll.lng];\n                }\n            );\n            this.deleteTrackSegment(originalSegment);\n            if (originalSegment._parentTrack === newSegment._parentTrack) {\n                this.deleteTrackSegment(newSegment);\n            }\n            this.addTrackSegment(originalSegment._parentTrack, latlngs);\n        },\n\n        onLineEditEnd: function(e) {\n            const polyline = e.target;\n            const track = polyline._parentTrack;\n            if (polyline.getLatLngs().length < 2) {\n                this.deleteTrackSegment(polyline);\n            }\n            if (this._editedLine === polyline) {\n                this._editedLine = null;\n            }\n            if (!this.getTrackPolylines(track).length && !this.getTrackPoints(track).length && e.userCancelled) {\n                this.removeTrack(track);\n            }\n        },\n\n        addTrackSegment: function(track, sourcePoints) {\n            var polyline = new TrackSegment(sourcePoints || [], {\n                    color: this.colors[track.color()],\n                    print: true\n                }\n            );\n            polyline._parentTrack = track;\n            polyline.setMeasureTicksVisible(track.measureTicksShown());\n            polyline.on('click', this.onTrackSegmentClick, this);\n            polyline.on('nodeschanged', this.onTrackSegmentNodesChanged.bind(this, track, polyline));\n            polyline.on('noderightclick', this.onNodeRightClickShowMenu, this);\n            polyline.on('segmentrightclick', this.onSegmentRightClickShowMenu, this);\n            polyline.on('mouseover', () => this.onTrackMouseEnter(track));\n            polyline.on('mouseout', () => this.onTrackMouseLeave(track));\n            polyline.on('editstart', () => this.onTrackEditStart(track));\n            polyline.on('editend', () => this.onTrackEditEnd(track));\n            polyline.on('drawend', this.onTrackSegmentDrawEnd, this);\n\n            // polyline.on('editingstart', polyline.setMeasureTicksVisible.bind(polyline, false));\n            // polyline.on('editingend', this.setTrackMeasureTicksVisibility.bind(this, track));\n            track.feature.addLayer(polyline);\n            this.recalculateTrackLength(track);\n            return polyline;\n        },\n\n        onNodeRightClickShowMenu: function(e) {\n            var items = [];\n            if (e.nodeIndex > 0 && e.nodeIndex < e.line.getLatLngs().length - 1) {\n                items.push({\n                        text: '',\n                        callback: this.splitTrackSegment.bind(this, e.line, e.nodeIndex, null)\n                    }\n                );\n            }\n            if (e.nodeIndex === 0 || e.nodeIndex === e.line.getLatLngs().length - 1) {\n                items.push({text: '', callback: this.startLineJoinSelection.bind(this, e)});\n            }\n            items.push({text: '', callback: this.reverseTrackSegment.bind(this, e.line)});\n            items.push({text: '', callback: this.startShortCutSelection.bind(this, e, true)});\n            items.push({text: ' ', callback: this.deleteTrackSegment.bind(this, e.line)});\n            items.push({text: '   ', callback: this.newTrackFromSegment.bind(this, e.line)});\n            items.push('-');\n            items.push({\n                    text: '  ',\n                    callback: this.showElevationProfileForSegment.bind(this, e.line)\n                }\n            );\n\n            var menu = new Contextmenu(items);\n            menu.show(e.mouseEvent);\n        },\n\n        onSegmentRightClickShowMenu: function(e) {\n            var menu = new Contextmenu([\n                    {\n                        text: '',\n                        callback: this.splitTrackSegment.bind(this, e.line, e.nodeIndex, e.mouseEvent.latlng)\n                    },\n                    {text: '', callback: this.reverseTrackSegment.bind(this, e.line)},\n                    {text: '', callback: this.startShortCutSelection.bind(this, e, false)},\n                    {text: ' ', callback: this.deleteTrackSegment.bind(this, e.line)},\n                    {text: '   ', callback: this.newTrackFromSegment.bind(this, e.line)},\n                    '-',\n                    {\n                        text: '  ',\n                        callback: this.showElevationProfileForSegment.bind(this, e.line)\n                    }\n                ]\n            );\n            menu.show(e.mouseEvent);\n        },\n\n        showLineCursor: function(start, mousepos) {\n            this.hideLineCursor();\n            this._editedLine.stopDrawingLine();\n            this._lineCursor = L.polyline([start.clone(), mousepos], {\n                ...this.options.lineCursorStyle,\n                ...this.options.lineCursorInvalidStyle,\n            }).addTo(this._map);\n            this.map.on('mousemove', this.onMouseMoveOnMapForLineCursor, this);\n            this.map.on('click', this.hideLineCursor, this);\n            L.DomEvent.on(document, 'keyup', this.onKeyUpForLineCursor, this);\n            L.DomUtil.addClass(this.map.getContainer(), 'tracklist-line-cursor-shown');\n            this._editedLine.preventStopEdit = true;\n        },\n\n        hideLineCursor: function() {\n            if (this._lineCursor) {\n                this.map.off('mousemove', this.onMouseMoveOnMapForLineCursor, this);\n                this.map.off('click', this.hideLineCursor, this);\n                L.DomUtil.removeClass(this.map.getContainer(), 'tracklist-line-cursor-shown');\n                L.DomEvent.off(document, 'keyup', this.onKeyUpForLineCursor, this);\n                this.map.removeLayer(this._lineCursor);\n                this._lineCursor = null;\n                this._map.fire('linecursorhide');\n                this._editedLine.preventStopEdit = false;\n            }\n        },\n\n        onMouseMoveOnMapForLineCursor: function(e) {\n            this.updateLineCursor(e.latlng, false);\n        },\n\n        updateLineCursor: function(latlng, isValid) {\n            if (!this._lineCursor) {\n                return;\n            }\n            this._lineCursor.getLatLngs().splice(1, 1, latlng);\n            this._lineCursor.redraw();\n            this._lineCursor.setStyle(\n                isValid ? this.options.lineCursorValidStyle : this.options.lineCursorInvalidStyle\n            );\n        },\n\n        onKeyUpForLineCursor: function(e) {\n            if (e.target.tagName.toLowerCase() === 'input') {\n                return;\n            }\n            switch (e.keyCode) {\n                case 27:\n                case 13:\n                    this.hideLineCursor();\n                    L.DomEvent.stop(e);\n                    break;\n                default:\n            }\n        },\n\n        startLineJoinSelection: function(e) {\n            this._lineJoinFromStart = (e.nodeIndex === 0);\n            const cursorStart = this._editedLine.getLatLngs()[e.nodeIndex];\n            this.showLineCursor(cursorStart, e.mouseEvent.latlng);\n            this._map.on('linecursorhide', this.onLineCursorHideForJoin, this);\n            for (let track of this.tracks()) {\n                track.feature.on('mousemove', this.onMouseMoveOnLineForJoin, this);\n            }\n            this._lineJoinActive = true;\n            this._editedLine.disableEditOnLeftClick(true);\n        },\n\n        onMouseMoveOnLineForJoin: function(e) {\n            const latlngs = e.layer.getLatLngs();\n            const lineJoinToStart = isPointCloserToStart(latlngs, e.latlng);\n            const cursorEnd = lineJoinToStart ? latlngs[0] : latlngs[latlngs.length - 1];\n            L.DomEvent.stopPropagation(e);\n            this.updateLineCursor(cursorEnd, true);\n        },\n\n        onLineCursorHideForJoin: function() {\n            for (let track of this.tracks()) {\n                track.feature.off('mousemove', this.onMouseMoveOnLineForJoin, this);\n            }\n            this._map.off('linecursorhide', this.onLineCursorHideForJoin, this);\n            this._editedLine.disableEditOnLeftClick(false);\n            this._lineJoinActive = false;\n        },\n\n        startShortCutSelection: function(e, startFromNode) {\n            const line = this._editedLine;\n            this._shortCut = {startNodeIndex: e.nodeIndex, startFromNode};\n            let cursorStart;\n            if (startFromNode) {\n                cursorStart = line.getLatLngs()[e.nodeIndex];\n            } else {\n                cursorStart = closestPointToLineSegment(line.getLatLngs(), e.nodeIndex, e.mouseEvent.latlng);\n                this._shortCut.startLatLng = cursorStart;\n            }\n            this.showLineCursor(cursorStart, e.mouseEvent.latlng);\n            line.nodeMarkers.on('mousemove', this.onMouseMoveOnNodeMarkerForShortCut, this);\n            line.segmentOverlays.on('mousemove', this.onMouseMoveOnLineSegmentForShortCut, this);\n            this.map.on('mousemove', this.onMouseMoveOnMapForShortCut, this);\n            line.nodeMarkers.on('click', this.onClickNodeMarkerForShortCut, this);\n            line.segmentOverlays.on('click', this.onClickLineSegmentForShortCut, this);\n            this._map.on('linecursorhide', this.onLineCursorHideForShortCut, this);\n            line.disableEditOnLeftClick(true);\n        },\n\n        onMouseMoveOnLineSegmentForShortCut: function(e) {\n            this.updateShortCutSelection(e, false);\n        },\n\n        onMouseMoveOnNodeMarkerForShortCut: function(e) {\n            this.updateShortCutSelection(e, true);\n        },\n\n        onMouseMoveOnMapForShortCut: function() {\n            this._editedLine.highlighNodesForDeletion();\n        },\n\n        updateShortCutSelection: function(e, endAtNode) {\n            L.DomEvent.stopPropagation(e);\n            const line = this._editedLine;\n            const {firstNodeToDelete, lastNodeToDelete, rangeValid} = this.getShortCutNodes(e, endAtNode);\n            this.updateLineCursor(e.latlng, rangeValid);\n            if (rangeValid) {\n                line.highlighNodesForDeletion(firstNodeToDelete, lastNodeToDelete);\n            } else {\n                line.highlighNodesForDeletion();\n            }\n        },\n\n        onLineCursorHideForShortCut: function() {\n            const line = this._editedLine;\n            line.highlighNodesForDeletion();\n            line.nodeMarkers.off('mousemove', this.onMouseMoveOnNodeMarkerForShortCut, this);\n            line.segmentOverlays.off('mousemove', this.onMouseMoveOnLineSegmentForShortCut, this);\n            this.map.off('mousemove', this.onMouseMoveOnMapForShortCut, this);\n            line.nodeMarkers.off('click', this.onClickNodeMarkerForShortCut, this);\n            line.segmentOverlays.off('click', this.onClickLineSegmentForShortCut, this);\n            this._map.off('linecursorhide', this.onLineCursorHideForShortCut, this);\n            line.disableEditOnLeftClick(false);\n            this._shortCut = null;\n        },\n\n        onClickLineSegmentForShortCut: function(e) {\n            this.shortCutSegment(e, false);\n        },\n\n        onClickNodeMarkerForShortCut: function(e) {\n            this.shortCutSegment(e, true);\n        },\n\n        getShortCutNodes: function(e, endAtNode) {\n            const line = this._editedLine;\n            let startFromNode = this._shortCut.startFromNode;\n            let startNodeIndex = this._shortCut.startNodeIndex;\n            let endNodeIndex = line[endAtNode ? 'getMarkerIndex' : 'getSegmentOverlayIndex'](e.layer);\n            const newNodes = [];\n            if (!startFromNode) {\n                newNodes.push(this._shortCut.startLatLng);\n            }\n            if (!endAtNode) {\n                newNodes.push(closestPointToLineSegment(line.getLatLngs(), endNodeIndex, e.latlng));\n            }\n            let firstNodeToDelete, lastNodeToDelete;\n            if (endNodeIndex > startNodeIndex) {\n                firstNodeToDelete = startNodeIndex + 1;\n                lastNodeToDelete = endNodeIndex - 1;\n                if (!endAtNode) {\n                    lastNodeToDelete += 1;\n                }\n            } else {\n                newNodes.reverse();\n                firstNodeToDelete = endNodeIndex + 1;\n                lastNodeToDelete = startNodeIndex - 1;\n                if (!startFromNode) {\n                    lastNodeToDelete += 1;\n                }\n            }\n            return {firstNodeToDelete, lastNodeToDelete, newNodes, rangeValid: lastNodeToDelete >= firstNodeToDelete};\n        },\n\n        shortCutSegment: function(e, endAtNode) {\n            L.DomEvent.stopPropagation(e);\n            const line = this._editedLine;\n            const {firstNodeToDelete, lastNodeToDelete, newNodes, rangeValid} = this.getShortCutNodes(e, endAtNode);\n            if (!rangeValid) {\n                return;\n            }\n            this.stopEditLine();\n            line.spliceLatLngs(firstNodeToDelete, lastNodeToDelete - firstNodeToDelete + 1, ...newNodes);\n            this.startEditTrackSegement(line);\n        },\n\n        onTrackMouseEnter: function(track) {\n            track.hover(true);\n        },\n\n        onTrackMouseLeave: function(track) {\n            track.hover(false);\n        },\n\n        onTrackEditStart: function(track) {\n            track.isEdited(true);\n        },\n\n        onTrackEditEnd: function(track) {\n            track.isEdited(false);\n            this.hideLineCursor();\n            this._editedLine = null;\n        },\n\n        onTrackRowMouseEnter: function(track) {\n            this._highlightedTrack = track;\n            this.updateTrackHighlight();\n        },\n\n        onTrackRowMouseLeave: function(track) {\n            if (this._highlightedTrack === track) {\n                this._highlightedTrack = null;\n                this.updateTrackHighlight();\n            }\n        },\n\n        onTrackSegmentDrawEnd: function() {\n            this.trackAddingSegment(null);\n        },\n\n        splitTrackSegment: function(trackSegment, nodeIndex, latlng) {\n            var latlngs = trackSegment.getLatLngs();\n            latlngs = latlngs.map((latlng) => latlng.clone());\n            var latlngs1 = latlngs.slice(0, nodeIndex + 1),\n                latlngs2 = latlngs.slice(nodeIndex + 1);\n            if (latlng) {\n                latlng = closestPointToLineSegment(latlngs, nodeIndex, latlng);\n                latlngs1.push(latlng.clone());\n            } else {\n                latlng = latlngs[nodeIndex];\n            }\n            latlngs2.unshift(latlng.clone());\n            this.deleteTrackSegment(trackSegment);\n            var segment1 = this.addTrackSegment(trackSegment._parentTrack, latlngs1);\n            this.addTrackSegment(trackSegment._parentTrack, latlngs2);\n            this.startEditTrackSegement(segment1);\n        },\n\n        deleteTrackSegment: function(trackSegment) {\n            const track = trackSegment._parentTrack;\n            track.feature.removeLayer(trackSegment);\n            this.recalculateTrackLength(track);\n        },\n\n        newTrackFromSegment: function(trackSegment) {\n            var srcNodes = trackSegment.getLatLngs(),\n                newNodes = [],\n                i;\n            for (i = 0; i < srcNodes.length; i++) {\n                newNodes.push([srcNodes[i].lat, srcNodes[i].lng]);\n            }\n            this.addTrack({name: \"New track\", tracks: [newNodes]});\n        },\n\n        addTrack: function(geodata) {\n            var color;\n            color = geodata.color;\n            if (!(color >= 0 && color < this.colors.length)) {\n                color = this._lastTrackColor;\n                this._lastTrackColor = (this._lastTrackColor + 1) % this.colors.length;\n            }\n            var track = {\n                name: ko.observable(geodata.name),\n                color: ko.observable(color),\n                visible: ko.observable(!geodata.trackHidden),\n                length: ko.observable(0),\n                measureTicksShown: ko.observable(geodata.measureTicksShown || false),\n                feature: L.featureGroup([]),\n                markers: [],\n                hover: ko.observable(false),\n                isEdited: ko.observable(false)\n            };\n            (geodata.tracks || []).forEach(this.addTrackSegment.bind(this, track));\n            (geodata.points || []).forEach(this.addPoint.bind(this, track));\n\n            this.tracks.push(track);\n\n            track.visible.subscribe(this.onTrackVisibilityChanged.bind(this, track));\n            track.measureTicksShown.subscribe(this.setTrackMeasureTicksVisibility.bind(this, track));\n            track.color.subscribe(this.onTrackColorChanged.bind(this, track));\n            if (!L.Browser.touch) {\n                track.feature.bindTooltip(() => track.name(), {sticky: true, delay: 500});\n            }\n\n            // this.onTrackColorChanged(track);\n            this.onTrackVisibilityChanged(track);\n            this.attachColorSelector(track);\n            this.attachActionsMenu(track);\n            return track;\n        },\n\n        updateTrackHighlight: function() {\n            if (L.Browser.touch) {\n                return;\n            }\n            if (this._trackHighlight) {\n                this._trackHighlight.removeFrom(this._map);\n                this._trackHighlight = null;\n            }\n            if (this._highlightedTrack && this._highlightedTrack.visible()) {\n                const trackHighlight = L.featureGroup([]);\n\n                this._highlightedTrack.feature.eachLayer((line) => {\n                    let latlngs = line.getFixedLatLngs();\n                    L.polyline(latlngs).addTo(trackHighlight);\n                });\n\n                trackHighlight.setStyle({\n                    color: 'yellow',\n                    weight: '15',\n                    opacity: 0.5\n                });\n                trackHighlight.addTo(this._map).bringToBack();\n                this._trackHighlight = trackHighlight;\n            }\n        },\n\n        setMarkerIcon: function(marker) {\n            var symbol = 'marker',\n                colorInd = marker._parentTrack.color() + 1,\n                className = 'symbol-' + symbol + '-' + colorInd;\n            marker.icon = iconFromBackgroundImage('track-waypoint ' + className);\n        },\n\n        setMarkerLabel: function(marker, label) {\n            marker.label = label;\n        },\n\n        addPoint: function(track, srcPoint) {\n            var marker = {\n                latlng: L.latLng([srcPoint.lat, srcPoint.lng]),\n                _parentTrack: track,\n            };\n            this.setMarkerIcon(marker);\n            this.setMarkerLabel(marker, srcPoint.name);\n            track.markers.push(marker);\n            marker._parentTrack = track;\n            return marker;\n        },\n\n        onMarkerClick: function(e) {\n            new Contextmenu([\n                    {text: e.marker.label, header: true},\n                    '-',\n                    {text: 'Rename', callback: this.renamePoint.bind(this, e.marker)},\n                    {text: 'Move', callback: this.beginPointMove.bind(this, e.marker)},\n                    {text: 'Delete', callback: this.removePoint.bind(this, e.marker)},\n                ]\n            ).show(e);\n        },\n\n        onMarkerEnter: function(e) {\n            e.marker._parentTrack.hover(true);\n        },\n\n        onMarkerLeave: function(e) {\n            e.marker._parentTrack.hover(false);\n        },\n\n        removePoint: function(marker) {\n            this.stopPlacingPoint();\n            this._markerLayer.removeMarker(marker);\n            const markers = marker._parentTrack.markers;\n            const i = markers.indexOf(marker);\n            markers.splice(i, 1);\n        },\n\n        renamePoint: function(marker) {\n            this.stopPlacingPoint();\n            var newLabel = query('New point name', marker.label);\n            if (newLabel !== null) {\n                this.setMarkerLabel(marker, newLabel);\n                this._markerLayer.updateMarker(marker);\n            }\n        },\n\n        removeTrack: function(track) {\n            track.visible(false);\n            this.tracks.remove(track);\n        },\n\n        deleteAllTracks: function() {\n            var tracks = this.tracks().slice(0),\n                i;\n            for (i = 0; i < tracks.length; i++) {\n                this.removeTrack(tracks[i]);\n            }\n        },\n\n        deleteHiddenTracks: function() {\n            var tracks = this.tracks().slice(0),\n                i, track;\n            for (i = 0; i < tracks.length; i++) {\n                track = tracks[i];\n                if (!track.visible()) {\n                    this.removeTrack(tracks[i]);\n                }\n            }\n        },\n\n        trackToString: function(track, forceVisible) {\n            var lines = this.getTrackPolylines(track).map(function(line) {\n                    var points = line.getFixedLatLngs();\n                    points = L.LineUtil.simplifyLatlngs(points, 360 / (1 << 24));\n                    return points;\n                }\n            );\n            return geoExporters.saveToString(lines, track.name(), track.color(), track.measureTicksShown(),\n                this.getTrackPoints(track), forceVisible ? false : !track.visible()\n            );\n        },\n\n        copyAllTracksToClipboard: function(mouseEvent) {\n            this.copyTracksLinkToClipboard(this.tracks(), mouseEvent);\n        },\n\n        copyVisibleTracks: function(mouseEvent) {\n            const tracks = this.tracks().filter((track) => track.visible());\n            this.copyTracksLinkToClipboard(tracks, mouseEvent);\n        },\n\n        exportTracks: function(minTicksIntervalMeters) {\n            var that = this;\n            /* eslint-disable max-nested-callbacks */\n            return this.tracks()\n                .filter(function(track) {\n                        return that.getTrackPolylines(track).length;\n                    }\n                )\n                .map(function(track) {\n                        var capturedTrack = track.feature.getLayers().map(function(pl) {\n                                return pl.getLatLngs().map(function(ll) {\n                                        return [ll.lat, ll.lng];\n                                    }\n                                );\n                            }\n                        );\n                        var bounds = track.feature.getBounds();\n                        var capturedBounds = [\n                            [bounds.getSouth(), bounds.getWest()],\n                            [bounds.getNorth(), bounds.getEast()]\n                        ];\n                        return {\n                            color: track.color(),\n                            visible: track.visible(),\n                            segments: capturedTrack,\n                            bounds: capturedBounds,\n                            measureTicksShown: track.measureTicksShown(),\n                            measureTicks: [].concat(...track.feature.getLayers().map(function(pl) {\n                                    return pl.getTicksPositions(minTicksIntervalMeters);\n                                }\n                                )\n                            )\n                        };\n                    }\n                );\n            /* eslint-enable max-nested-callbacks */\n        },\n\n        showElevationProfileForSegment: function(line) {\n            this.hideElevationProfile();\n            this.stopEditLine();\n            this._elevationControl = new ElevationProfile(this._map, line.getLatLngs(), {\n                    samplingInterval: calcSamplingInterval(line.getLength())\n                }\n            );\n            this._map.fire('elevation-shown');\n        },\n\n        showElevationProfileForTrack: function(track) {\n            var lines = this.getTrackPolylines(track),\n                path = [],\n                i;\n            for (i = 0; i < lines.length; i++) {\n                if (lines[i] === this._editedLine) {\n                    this.stopEditLine();\n                }\n                path = path.concat(lines[i].getLatLngs());\n            }\n            this.hideElevationProfile();\n            this._elevationControl = new ElevationProfile(this._map, path, {\n                    samplingInterval: calcSamplingInterval(new L.MeasuredLine(path).getLength())\n                }\n            );\n            this._map.fire('elevation-shown');\n        },\n\n        hideElevationProfile: function() {\n            if (this._elevationControl) {\n                this._elevationControl.removeFrom(this._map);\n            }\n            this._elevationControl = null;\n        },\n\n        hasTracks: function() {\n            return this.tracks().length > 0;\n        }\n    }\n);\n\nexport {TRACKLIST_TRACK_COLORS};\n","function arrayItemsEqual(l1, l2) {\n    if (l1.length !== l2.length) {\n        return false;\n    }\n    for (var i = 0; i < l1.length; i++) {\n        if (l1[i] !== l2[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n\nfunction parseHashParams(s) {\n    const args = {},\n        i = s.indexOf('#');\n    if (i >= 0) {\n        s = s.substr(i + 1).trim();\n        let m, key, value;\n        for (let pair of s.split('&')) {\n            m = /^([^=]+?)(?:=(.*))?$/u.exec(pair);\n            if (m) {\n                [, key, value] = m;\n                if (value) {\n                    value = value.split('/');\n                } else {\n                    value = [];\n                }\n                args[key] = value;\n            }\n        }\n    }\n    return args;\n}\n\nconst hashState = {\n    _listeners: [],\n    _state: {},\n\n    addEventListener: function(key, callback) {\n        for (let [k, c] of this._listeners) {\n            if (k === key && c === callback) {\n                return;\n            }\n        }\n        this._listeners.push([key, callback]);\n    },\n\n    updateState: function(key, values) {\n        if (values) {\n            this._state[key] = values;\n        } else {\n            delete this._state[key];\n        }\n        this._saveStateToHash();\n    },\n\n    getState: function(key) {\n        return this._state[key];\n    },\n\n    hasKey: function(key) {\n        return this._state.hasOwnProperty(key);\n    },\n\n    _saveStateToHash: function() {\n        var stateItems = [];\n        for (let key of Object.keys(this._state)) {\n            if (this._state[key]) {\n                if (this._state[key].length) {\n                    var values = this._state[key].join('/');\n                    stateItems.push(key + '=' + values);\n                } else {\n                    stateItems.push(key);\n                }\n            }\n        }\n        const hash = stateItems.join('&');\n        const href = `${location.origin}${location.pathname}${location.search}#${hash}`;\n        this._ignoreChanges = true;\n        location.replace(href);\n        this._ignoreChanges = false;\n    },\n\n    onHashChanged: function() {\n        if (this._ignoreChanges) {\n            return;\n        }\n        const newState = parseHashParams(location.hash);\n        const changedKeys = {};\n        for (let key of Object.keys(newState)) {\n            if (!(key in this._state) || !arrayItemsEqual(newState[key], this._state[key])) {\n                changedKeys[key] = 1;\n            }\n        }\n\n        for (let key of Object.keys(this._state)) {\n            if (!(key in newState)) {\n                changedKeys[key] = 1;\n            }\n        }\n\n        for (let [key, callback] of this._listeners) {\n            if (key in changedKeys) {\n                callback(newState[key]);\n            }\n        }\n        this._state = newState;\n    }\n};\n\nfunction bindHashStateReadOnly(key, target) {\n    function onChange() {\n        target(hashState.getState(key));\n        hashState.updateState(key, null);\n    }\n    hashState.addEventListener(key, onChange);\n    onChange();\n}\n\nwindow.addEventListener('hashchange', hashState.onHashChanged.bind(hashState));\nhashState.onHashChanged();\n\nexport {hashState, bindHashStateReadOnly, parseHashParams};\n\n","class PrintStaticLayer {\n    _layerDummy = true;\n    _printProgressWeight = 0.01;\n\n    cloneForPrint() {\n        return this;\n    }\n\n    // printOptions = {\n    //     xhrOptions,\n    //     pixelBounds,\n    //     latLngBounds,\n    //     destPixelSize,\n    //     resolution,\n    //     scale,\n    //     zoom\n    // }\n    async getTilesInfo(printOptions) {\n        return {\n            iterateTilePromises: (function*() {\n                yield {\n                    tilePromise: Promise.resolve({\n                            draw: (canvas) => this._drawRaster(canvas, printOptions),\n                            isOverlay: true,\n                            overlaySolid: this.overlaySolid\n                        }\n                    ),\n                    abortLoading: () => {\n                        // no actions needed\n                    }\n                };\n            }).bind(this),\n            count: 1\n        };\n    }\n\n    _drawRaster(_unused_canvas, _unused_printOptions) {\n        throw new Error(\"Method not implemented\");\n    }\n}\n\nexport {PrintStaticLayer};\n","import './style.css';\nimport * as logging from '~/lib/logging';\nimport {query} from '~/lib/notifications';\n\nfunction showNotification(message, mouseEvent) {\n    var el = document.createElement('div');\n    el.innerHTML = message;\n    el.className = 'copy-clipboard-notification';\n    document.body.appendChild(el);\n    var w = el.offsetWidth,\n        h = el.offsetHeight,\n        x = mouseEvent.clientX - w - 8,\n        y = mouseEvent.clientY - h / 2;\n    if (x < 0) {\n        x = 0;\n    }\n    if (y < 0) {\n        y = 0;\n    }\n    el.style.top = y + 'px';\n    el.style.left = x + 'px';\n    setTimeout(function() {\n        document.body.removeChild(el);\n    }, 1000);\n}\n\nfunction copyToClipboard(s, mouseEvent) {\n    let success = false;\n    let ta;\n    try {\n        ta = document.createElement('textarea');\n        ta.value = s;\n        document.body.appendChild(ta);\n        ta.select();\n        success = document.execCommand('copy');\n        if (success) {\n            showNotification('', mouseEvent);\n        }\n    } catch (e) {\n        logging.captureException(e, 'clipborad to copy failed');\n    } finally {\n        document.body.removeChild(ta);\n    }\n    if (!success) {\n        query(\"Copy to clipboard: Ctrl+C, Enter\", s);\n    }\n}\n\nexport default copyToClipboard;\n","import {Cache} from '~/lib/cache';\nimport {XHRQueue} from '~/lib/xhr-promise';\n\nclass TiledDataLoader {\n    constructor(cacheSize = 50) {\n        this._cache = new Cache(cacheSize);\n        this._pendingRequests = {};\n        this._xhrQueue = new XHRQueue();\n    }\n\n    makeTileKey(coords) {\n        return `${coords.x}:${coords.y}:${coords.z}`;\n    }\n\n    getFromCache(dataTileCoords) {\n        const key = this.makeTileKey(dataTileCoords);\n        const res = this._cache.get(key);\n        res['coords'] = dataTileCoords;\n        return res;\n    }\n\n    layerTileToDataTileCoords(layerTileCoords) {\n        return {...layerTileCoords};\n    }\n\n    makeRequestData(_unused_dataTileCoords) {\n        throw new Error('Not implemented');\n        // return {\n        //     url,\n        //     options\n        // }\n    }\n\n    processResponse(_unused_xhr, _unused_originalDataTileCoords) {\n        throw new Error('Not implemented');\n        // return {\n        //     tileData,\n        //     coords\n        // }\n    }\n\n    calcAdjustment(layerTileCoords, dataTileCoords) {\n        if (layerTileCoords.x === dataTileCoords.x &&\n            layerTileCoords.y === dataTileCoords.y &&\n            layerTileCoords.z === dataTileCoords.z) {\n            return null;\n        }\n        if (dataTileCoords.z > layerTileCoords.z) {\n            const multiplier = 1 << (dataTileCoords.z - layerTileCoords.z);\n            return {multiplier: 1 / multiplier, offsetX: 0, offsetY: 0};\n        }\n        const multiplier = 1 << (layerTileCoords.z - dataTileCoords.z);\n        return {\n            multiplier,\n            offsetX: (layerTileCoords.x - dataTileCoords.x * multiplier),\n            offsetY: (layerTileCoords.y - dataTileCoords.y * multiplier)\n        };\n    }\n\n    requestTileData(layerTileCoords) {\n        const dataTileCoords = this.layerTileToDataTileCoords(layerTileCoords);\n        let res = this.getFromCache(dataTileCoords);\n        if (res.found) {\n            return {\n                dataPromise: Promise.resolve({\n                        coords: res.coords,\n                        tileData: res.value,\n                        adjustment: this.calcAdjustment(layerTileCoords, res.coords)\n                    }\n                ),\n                abortLoading: () => {\n                    // no need to abort Promise which is resolved immediately\n                }\n            };\n        }\n\n        const dataTileKey = this.makeTileKey(dataTileCoords);\n        if (!(dataTileKey in this._pendingRequests)) {\n            const {url, options} = this.makeRequestData(dataTileCoords);\n            const fetchPromise = this._xhrQueue.put(url, options);\n            const dataPromise = (async() => {\n                let xhr;\n                try {\n                    xhr = await fetchPromise;\n                } catch (e) {\n                    return {error: e};\n                } finally {\n                    delete this._pendingRequests[dataTileKey];\n                }\n                const {tileData, coords} = await this.processResponse(xhr, dataTileCoords);\n                this._cache.put(this.makeTileKey(coords), tileData);\n                return {tileData, coords};\n            })();\n            const pendingRequest = this._pendingRequests[dataTileKey] = {\n                dataPromise,\n                refCount: 0\n            };\n            pendingRequest.abortLoading = () => {\n                pendingRequest.refCount -= 1;\n                if (pendingRequest.refCount < 1) {\n                    fetchPromise.abort();\n                    delete this._pendingRequests[dataTileKey];\n                }\n            };\n        }\n\n        let pendingRequest = this._pendingRequests[dataTileKey];\n        pendingRequest.refCount += 1;\n\n        return {\n            dataPromise: pendingRequest.dataPromise.then((data) => {\n                    if (data.error) {\n                        return data;\n                    }\n                    return {\n                        coords: data.coords,\n                        tileData: data.tileData,\n                        adjustment: this.calcAdjustment(layerTileCoords, data.coords)\n                    };\n            }),\n            abortLoading: () => pendingRequest.abortLoading()\n        };\n    }\n}\n\nexport {TiledDataLoader};\n","import parsers from './parsers';\n\nfunction parseGeoFile(name, data) {\n    for (var i = 0; i < parsers.length; i++) {\n        var parsed = parsers[i](data, name);\n        if (parsed !== null) {\n            return parsed;\n        }\n    }\n    return [{name: name, error: 'UNSUPPORTED'}];\n}\n\nexport default parseGeoFile;\n","export default function stripBom(s) {\n    if (s.substr(0, 3) === '\\xef\\xbb\\xbf') {\n        s = s.substr(3);\n    }\n    return s;\n}\n","import services from './services';\n\nasync function loadFromUrl(url) {\n    for (let ServiceClass of services) {\n        let service = new ServiceClass(url);\n        if (service.isOurUrl()) {\n            return service.geoData();\n        }\n    }\n    return [{name: url, error: 'INVALID_URL'}];\n}\n\nexport default loadFromUrl;\n","import Pbf from 'pbf';\nimport {TrackView} from './nktk_pb';\nimport {arrayBufferToString, stringToArrayBuffer} from '~/lib/binary-strings';\nimport utf8 from 'utf8';\nimport * as urlSafeBase64 from './urlSafeBase64';\n\nconst arcUnit = ((1 << 24) - 1) / 360;\n\nfunction PackedStreamReader(s) {\n    this._string = s;\n    this.position = 0;\n}\n\nfunction unpackNumber(s, position) {\n    var x,\n        n = 0;\n    x = s.charCodeAt(position);\n    if (isNaN(x)) {\n        throw new Error('Unexpected end of line while unpacking number');\n    }\n    if (x < 128) {\n        n = x - 64;\n        return [n, 1];\n    }\n    n = x & 0x7f;\n    x = s.charCodeAt(position + 1);\n    if (isNaN(x)) {\n        throw new Error('Unexpected end of line while unpacking number');\n    }\n    if (x < 128) {\n        n |= x << 7;\n        n -= 8192;\n        return [n, 2];\n    }\n    n |= (x & 0x7f) << 7;\n    x = s.charCodeAt(position + 2);\n    if (isNaN(x)) {\n        throw new Error('Unexpected end of line while unpacking number');\n    }\n    if (x < 128) {\n        n |= x << 14;\n        n -= 1048576;\n        return [n, 3];\n    }\n    n |= (x & 0x7f) << 14;\n    x = s.charCodeAt(position + 3);\n    if (isNaN(x)) {\n        throw new Error('Unexpected end of line while unpacking number');\n    }\n    n |= x << 21;\n    n -= 268435456;\n    return [n, 4];\n}\n\nPackedStreamReader.prototype.readNumber = function() {\n    var n = unpackNumber(this._string, this.position);\n    this.position += n[1];\n    return n[0];\n};\n\nPackedStreamReader.prototype.readString = function(size) {\n    var s = this._string.slice(this.position, this.position + size);\n    this.position += size;\n    return s;\n};\n\nfunction deltaEncodeSegment(points) {\n    let deltaLats = [],\n        deltaLons = [];\n    let lastLon = 0,\n        lastLat = 0,\n        lon, lat;\n    for (let i = 0, len = points.length; i < len; i++) {\n        let p = points[i];\n        lon = Math.round(p.lng * arcUnit);\n        lat = Math.round(p.lat * arcUnit);\n        let deltaLon = lon - lastLon;\n        let deltaLat = lat - lastLat;\n        deltaLats.push(deltaLat);\n        deltaLons.push(deltaLon);\n        lastLon = lon;\n        lastLat = lat;\n    }\n    return {deltaLats, deltaLons};\n}\n\nfunction deltaDecodeSegment(deltaLats, deltaLons) {\n    let encodedLat = 0,\n        encodedLon = 0;\n    const points = [];\n    for (let i = 0; i < deltaLats.length; i++) {\n        encodedLat += deltaLats[i];\n        encodedLon += deltaLons[i];\n        points.push({lat: encodedLat / arcUnit, lng: encodedLon / arcUnit});\n    }\n    return points;\n}\n\nfunction saveNktk(segments, name, color, measureTicksShown, waypoints, trackHidden) {\n    const trackView = {\n        view: {\n            color,\n            shown: !trackHidden,\n            ticksShown: measureTicksShown,\n        }\n    };\n    const track = trackView.track = {name};\n    if (segments && segments.length) {\n        let deltaEncodedSegments = [];\n        for (let segment of segments) {\n            let {deltaLats, deltaLons} = deltaEncodeSegment(segment);\n            deltaEncodedSegments.push({lats: deltaLats, lons: deltaLons});\n        }\n        track.segments = deltaEncodedSegments;\n    }\n    if (waypoints && waypoints.length) {\n        let midLon = 0,\n            midLat = 0;\n        waypoints.forEach((wp) => {\n                midLon += wp.latlng.lng;\n                midLat += wp.latlng.lat;\n            }\n        );\n        midLon = Math.round(midLon * arcUnit / waypoints.length);\n        midLat = Math.round(midLat * arcUnit / waypoints.length);\n        track.waypoints = {\n            midLat, midLon\n        };\n\n        let packedWaypoints = [];\n        for (let waypoint of waypoints) {\n            packedWaypoints.push({\n                name: waypoint.label,\n                lat: Math.round(waypoint.latlng.lat * arcUnit) - midLat,\n                lon: Math.round(waypoint.latlng.lng * arcUnit) - midLon\n            });\n        }\n        track.waypoints.waypoints = packedWaypoints;\n    }\n    const pbf = new Pbf();\n    const versionStr = String.fromCharCode(4 + 64);\n    TrackView.write(trackView, pbf);\n    const s = versionStr + arrayBufferToString(pbf.finish());\n    return urlSafeBase64.encode(s);\n}\n\nfunction parseNktkOld(s, version) {\n    var name,\n        n,\n        segments = [],\n        segment,\n        segmentsCount,\n        pointsCount,\n        arcUnit = ((1 << 24) - 1) / 360,\n        x, y,\n        error, midX, midY, /* symbol,*/ waypointName,\n        wayPoints = [],\n        color, measureTicksShown,\n        trackHidden = false;\n    s = new PackedStreamReader(s);\n    try {\n        n = s.readNumber();\n        name = s.readString(n);\n        name = utf8.decode(name);\n        segmentsCount = s.readNumber();\n        for (let i = 0; i < segmentsCount; i++) {\n            segment = [];\n            pointsCount = s.readNumber();\n            x = 0;\n            y = 0;\n            for (let j = 0; j < pointsCount; j++) {\n                x += s.readNumber();\n                y += s.readNumber();\n                segment.push({lng: x / arcUnit, lat: y / arcUnit});\n            }\n            segments.push(segment);\n            segment = null;\n        }\n    } catch (e) {\n        if (e.message.match('Unexpected end of line while unpacking number')) {\n            error = ['CORRUPT'];\n            if (segment) {\n                segments.push(segment);\n            }\n        } else {\n            throw e;\n        }\n    }\n    try {\n        color = s.readNumber();\n        measureTicksShown = s.readNumber();\n    } catch (e) {\n        if (e.message.match('Unexpected end of line while unpacking number')) {\n            color = 0;\n            measureTicksShown = 0;\n            if (version > 0) {\n                error = ['CORRUPT'];\n            }\n        } else {\n            throw e;\n        }\n    }\n    if (version >= 3) {\n        try {\n            trackHidden = Boolean(s.readNumber());\n        } catch (e) {\n            if (e.message.match('Unexpected end of line while unpacking number')) {\n                error = ['CORRUPT'];\n            } else {\n                throw e;\n            }\n        }\n    }\n    if (version >= 2) {\n        try {\n            pointsCount = s.readNumber();\n            if (pointsCount) {\n                midX = s.readNumber();\n                midY = s.readNumber();\n            }\n            for (let i = 0; i < pointsCount; i++) {\n                n = s.readNumber();\n                waypointName = s.readString(n);\n                waypointName = utf8.decode(waypointName);\n\n                // let symbol = s.readNumber();\n                s.readNumber();\n\n                x = s.readNumber() + midX;\n                y = s.readNumber() + midY;\n                wayPoints.push({\n                        name: waypointName,\n                        lat: y / arcUnit,\n                        lng: x / arcUnit,\n\n                    }\n                );\n            }\n        } catch (e) {\n            if (e.message.match('Unexpected end of line while unpacking number')) {\n                error = ['CORRUPT'];\n            } else {\n                throw e;\n            }\n        }\n    }\n    var geoData = {\n        name: name || \"Text encoded track\",\n        tracks: segments,\n        error: error,\n        points: wayPoints,\n        color: color,\n        measureTicksShown: measureTicksShown,\n        trackHidden: trackHidden\n    };\n    return [geoData];\n}\n\nfunction parseTrackUrlData(s) {\n    s = urlSafeBase64.decode(s);\n    if (!s) {\n        return [{name: 'Text encoded track', error: ['CORRUPT']}];\n    }\n    return parseNktkOld(s, 0);\n}\n\nfunction parseNktkProtobuf(s) {\n    const pbf = new Pbf(stringToArrayBuffer(s));\n    let trackView;\n    try {\n        trackView = TrackView.read(pbf);\n    } catch (e) {\n        return [{name: 'Text encoded track', error: ['CORRUPT']}];\n    }\n    const geoData = {\n        name: trackView.track.name || \"Text encoded track\",\n        color: trackView.view.color,\n        trackHidden: !trackView.view.shown,\n        measureTicksShown: trackView.view.ticksShown,\n    };\n    const segments = trackView.track.segments;\n    if (segments && segments.length) {\n        geoData.tracks = segments.map((segment) => deltaDecodeSegment(segment.lats, segment.lons));\n    }\n    if (trackView.track.waypoints && trackView.track.waypoints.waypoints.length) {\n        const waypoints = geoData.points = [];\n        for (let waypoint of trackView.track.waypoints.waypoints) {\n            waypoints.push({\n                name: waypoint.name,\n                lat: (waypoint.lat + trackView.track.waypoints.midLat) / arcUnit,\n                lng: (waypoint.lon + trackView.track.waypoints.midLon) / arcUnit\n            });\n        }\n    }\n    return [geoData];\n}\n\nfunction parseNktkFragment(s) {\n    s = urlSafeBase64.decode(s);\n    if (!s) {\n        return [{name: 'Text encoded track', error: ['CORRUPT']}];\n    }\n    const reader = new PackedStreamReader(s);\n    let version = reader.readNumber();\n    if (version === 1 || version === 2 || version === 3) {\n        return parseNktkOld(s.substring(reader.position), version);\n    } else if (version === 4) {\n        return parseNktkProtobuf(s.substring(reader.position));\n    }\n    return [{name: 'Text encoded track', error: ['CORRUPT']}];\n}\n\nfunction parseNktkSequence(s) {\n    return s.split('/')\n        .map(parseNktkFragment)\n        .reduce((acc, cur) => {\n            acc.push(...cur);\n            return acc;\n        });\n}\n\nexport {saveNktk, parseTrackUrlData, parseNktkSequence, parseNktkFragment};\n","function onElementResize(element, cb) {\n    if (window.ResizeObserver) {\n        const observer = new ResizeObserver(() => cb());\n        observer.observe(element);\n    } else {\n        let width = element.offsetWidth;\n        let height = element.offsetHeight;\n        setInterval(function () {\n            const newWidth = element.offsetWidth;\n            const newHeight = element.offsetHeight;\n            if (newWidth !== width || newHeight !== height) {\n                width = newWidth;\n                height = newHeight;\n                cb();\n            }\n        }, 200);\n    }\n}\n\nexport {onElementResize};\n","import ko from 'knockout';\nimport './style.css';\nimport '~/lib/controls-styles/controls-styles.css';\n\nko.components.register('progress-indicator', {\n    template: `\n        <div class=\"ko-progress-unknown icon-spinner-nuclear\" data-bind=\"visible: progress() === undefined\"></div>\n        <div class=\"ko-progress\" data-bind=\"visible: progress() !== undefined\">\n            <div class=\"ko-progress-bkg\">\n                <div class=\"ko-progress-bar\"  data-bind=\"style: {width: progress() + '%'}\"></div>\n            </div>\n        </div>`,\n    viewModel: function(params) {\n        this.progress = ko.pureComputed(function() {\n            var range = params.progressRange(),\n                done = params.progressDone();\n            return done === undefined ? undefined : done * 100 / range;\n        });\n    }\n});\n","import L from 'leaflet';\nimport './TileLayer';\nimport './Bing';\nimport './Yandex';\nimport './Google';\nimport './WestraPasses';\nimport './CanvasMarkers';\nimport './MeasuredLine';\nimport './RetinaTileLayer';\n\nfunction getTempMap(zoom, fullSize, pixelBounds) {\n    const container = L.DomUtil.create('div', '', document.body);\n    let width, height, center;\n    if (fullSize) {\n        const size = pixelBounds.getSize();\n        width = size.x;\n        height = size.y;\n        center = pixelBounds.min.add(size.divideBy(2));\n        center = L.CRS.EPSG3857.pointToLatLng(center, zoom);\n    } else {\n        width = 100;\n        height = 100;\n        center = L.latLng(0, 0);\n    }\n\n    Object.assign(container.style, {\n            width: `${width}px`,\n            height: `${height}px`,\n            position: 'absolute',\n            left: '0',\n            top: '0',\n            visibility: 'hidden',\n        }\n    );\n\n    const map = L.map(container, {fadeAnimation: false, zoomAnimation: false, inertia: false, maxZoom: 18});\n    map.setView(center, zoom);\n    return map;\n}\n\nfunction disposeMap(map) {\n    const container = map._container;\n    map.remove();\n    L.DomUtil.remove(container);\n}\n\nexport {getTempMap, disposeMap};\n","import L from 'leaflet';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\nimport {imgFromDataString} from './imgFromDataString';\n\nfunction noop() {\n    // dummy function\n}\n\nconst GridLayerGrabMixin = {\n    tileImagePromiseFromCoords: function(_unused_coords) {\n        throw new Error('Method not implemented');\n    },\n\n    waitTilesReadyToGrab: function() {\n        return Promise.resolve(null);\n    },\n\n    getTilesInfo: async function(printOptions) {\n        await this.waitTilesReadyToGrab();\n        const {pixelBounds} = printOptions;\n        const tileRange = this._pxBoundsToTileRange(pixelBounds);\n        const topLeft = pixelBounds.min;\n        const tilePromiseIterator = (function*() {\n            for (let j = tileRange.min.y; j <= tileRange.max.y; j++) {\n                for (let i = tileRange.min.x; i <= tileRange.max.x; i++) {\n                    let coords = new L.Point(i, j);\n                    coords.z = this._tileZoom;\n                    if (!this._isValidTile(coords)) {\n                        continue;\n                    }\n                    let tilePos = this._getTilePos(coords);\n                    const coordsPlusOne = coords.add(L.point(1, 1));\n                    coordsPlusOne.z = coords.z;\n                    const tilePlusOne = this._getTilePos(coordsPlusOne);\n                    const tileSize = tilePlusOne.subtract(tilePos);\n                    const latLngBounds = L.latLngBounds(\n                        this._map.unproject(tilePos.add(this._level.origin)),\n                        this._map.unproject(tilePlusOne.add(this._level.origin)));\n                    tilePos = tilePos.add(this._level.origin).subtract(topLeft);\n                    let {tilePromise, abortLoading} = this.tileImagePromiseFromCoords(\n                        this._wrapCoords(coords), printOptions);\n                    yield {\n                        tilePromise: tilePromise.then((image) => ({image, tilePos, tileSize, latLngBounds})),\n                        abortLoading\n                    };\n                }\n            }\n        }).bind(this);\n        return {\n            iterateTilePromises: tilePromiseIterator,\n            count: (tileRange.max.x - tileRange.min.x + 1) * (tileRange.max.y - tileRange.min.y + 1)\n        };\n    }\n};\n\nconst TileLayerGrabMixin = L.Util.extend({}, GridLayerGrabMixin, {\n        cloneForPrint: function(options) {\n            return L.tileLayer(this._url, L.Util.extend({}, this.options, options));\n        },\n\n        tileImagePromiseFromCoords: function(coords, printOptions) {\n            let {xhrOptions} = printOptions;\n            let url = this.getTileUrl(coords);\n            if (!url) {\n                return {tilePromise: Promise.resolve(null), abortLoading: noop};\n            }\n            if (this.options.noCors) {\n                url = urlViaCorsProxy(url);\n            }\n            let promise = this.options.xhrQueue.put(url, xhrOptions);\n\n            return {\n                tilePromise: printOptions.rawData ? promise : promise.then(imgFromDataString),\n                abortLoading: () => promise.abort()\n            };\n        }\n    }\n);\n\n// CanvasLayerGrabMixin has been deleted\n\nL.TileLayer.include(TileLayerGrabMixin);\n","import L from 'leaflet';\nimport './style.css';\n\nconst yandexCrs = L.CRS.EPSG3395;\n\nL.Layer.Yandex = L.TileLayer.extend({\n        options: {\n            subdomains: '1234',\n            className: L.Browser.retina ? '' : 'yandex-tile-layer',\n            yandexScale: L.Browser.retina ? 2 : 1\n        },\n\n        _getTilePos: function(coords) {\n            const tilePosLatLng = yandexCrs.pointToLatLng(coords.scaleBy(this.getTileSize()), coords.z);\n            return this._map.project(tilePosLatLng, coords.z).subtract(this._level.origin).round();\n        },\n\n        _pxBoundsToTileRange: function(bounds) {\n            const zoom = this._tileZoom;\n            const bounds2 = new L.Bounds(\n                yandexCrs.latLngToPoint(this._map.unproject(bounds.min, zoom), zoom),\n                yandexCrs.latLngToPoint(this._map.unproject(bounds.max, zoom), zoom));\n            return L.TileLayer.prototype._pxBoundsToTileRange.call(this, bounds2);\n        },\n\n        createTile: function(coords, done) {\n            const tile = L.TileLayer.prototype.createTile.call(this, coords, done);\n            const coordsBelow = L.point(coords).add([0, 1]);\n            coordsBelow.z = coords.z;\n            tile._adjustHeight = this._getTilePos(coordsBelow).y - this._getTilePos(coords).y;\n            return tile;\n        },\n\n        _initTile: function(tile) {\n            L.TileLayer.prototype._initTile.call(this, tile);\n            tile.style.height = `${tile._adjustHeight}px`;\n        }\n    }\n);\n\nL.Layer.Yandex.Map = L.Layer.Yandex.extend({\n    initialize: function(options) {\n        L.Layer.Yandex.prototype.initialize.call(\n            this,\n            'https://vec0{s}.maps.yandex.net/tiles?l=map&x={x}&y={y}&z={z}&scale={yandexScale}',\n            options\n        );\n    },\n});\n\nL.Layer.Yandex.Sat = L.Layer.Yandex.extend({\n    initialize: function(options) {\n        L.Layer.Yandex.prototype.initialize.call(\n            this,\n            'https://sat0{s}.maps.yandex.net/tiles?l=sat&x={x}&y={y}&z={z}',\n            options\n        );\n    },\n});\n\nL.Layer.Yandex.Tracks = L.Layer.Yandex.extend({\n    initialize: function(options) {\n        options = {minZoom: 10, maxNativeZoom: 16, ...options};\n        L.Layer.Yandex.prototype.initialize.call(\n            this,\n            'https://core-gpstiles.maps.yandex.net/tiles?style=point&x={x}&y={y}&z={z}',\n            options\n        );\n    },\n});\n","import L from \"leaflet\";\n\nL.Layer.GoogleBase = L.TileLayer.extend({\n    options: {\n        subdomains: '0123'\n    },\n\n    getTileUrl: function(coords) {\n        const data = {\n            x: coords.x,\n            y: coords.y,\n            z: 17 - this._getZoomForUrl(),\n            s: this._getSubdomain(coords),\n            lang: navigator.language || ''\n        };\n        return L.Util.template(this._url, data);\n    }\n});\n\nL.Layer.GoogleMap = L.Layer.GoogleBase.extend({\n    initialize: function(options) {\n        L.Layer.GoogleBase.prototype.initialize.call(\n            this, 'https://mt{s}.google.com/vt/lyrs=m@169000000&hl={lang}&x={x}&y={y}&zoom={z}', options);\n    }\n});\n\nL.Layer.GoogleTerrain = L.Layer.GoogleBase.extend({\n    initialize: function(options) {\n        L.Layer.GoogleBase.prototype.initialize.call(\n            this, 'https://mt{s}.google.com/vt/lyrs=t@130,r@206000000&hl={lang}&x={x}&y={y}&zoom={z}', options);\n    }\n});\n\nL.Layer.GoogleHybrid = L.Layer.GoogleBase.extend({\n    initialize: function(options) {\n        L.Layer.GoogleBase.prototype.initialize.call(\n            this, 'https://mt{s}.google.com/vt/lyrs=h@169000000&hl={lang}&x={x}&y={y}&zoom={z}', options);\n    }\n});\n\nL.Layer.GoogleSat = L.TileLayer.extend({\n    options: {\n        subdomains: '0123'\n    },\n\n    initialize: function(options) {\n        L.TileLayer.prototype.initialize.call(\n            this, 'https://mt{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', options);\n    }\n});\n","import L from 'leaflet';\nimport '~/lib/leaflet.layer.canvasMarkers';\nimport {openPopupWindow} from '~/lib/popup-window';\nimport escapeHtml from 'escape-html';\nimport {saveAs} from '~/vendored/github.com/eligrey/FileSaver';\nimport iconFromBackgroundImage from '~/lib/iconFromBackgroundImage';\nimport {fetch} from '~/lib/xhr-promise';\nimport {notify} from '~/lib/notifications';\nimport * as logging from '~/lib/logging';\n\nconst WestraPassesMarkers = L.Layer.CanvasMarkers.extend({\n        options: {\n            filePasses: 'westra_passes.json',\n            scaleDependent: true\n        },\n\n        initialize: function(baseUrl, options) {\n            L.Layer.CanvasMarkers.prototype.initialize.call(this, null, options);\n            this.on('markerclick', this.showPassDescription, this);\n            this._baseUrl = baseUrl;\n            this.url = baseUrl + this.options.filePasses;\n        },\n\n        loadData: function() {\n            if (this._downloadStarted) {\n                return;\n            }\n            this._downloadStarted = true;\n            fetch(this.url)\n                .then(\n                    (xhr) => this._loadMarkers(xhr),\n                    (e) => {\n                        this._downloadStarted = false;\n                        logging.captureException(e, 'failed to get westra passes');\n                        notify('Failed to get Westra passes data');\n                    }\n                );\n        },\n\n        onAdd: function(map) {\n            L.Layer.CanvasMarkers.prototype.onAdd.call(this, map);\n            this.loadData();\n        },\n\n        _makeTooltip: function(marker) {\n            var properties = marker.properties,\n                toolTip = properties.grade || '';\n            if (toolTip && properties.elevation) {\n                toolTip += ', ';\n            }\n            toolTip += properties.elevation || '';\n            if (toolTip) {\n                toolTip = ' (' + toolTip + ')';\n            }\n            toolTip = (properties.name || ' ') + toolTip;\n            toolTip = (properties.is_summit ? ' ' : ' ') + toolTip;\n            return toolTip;\n        },\n\n        _passToGpx: function(marker) {\n            let label = marker.tooltip;\n            if (typeof label === 'function') {\n                label = label(marker);\n            }\n            label = escapeHtml(label);\n            const gpx = `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\" ?>\n                <gpx xmlns=\"http://www.topografix.com/GPX/1/1\"\n                     creator=\"http://nakarte.me\"\n                     xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n                     xsi:schemaLocation=\"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd\"\n                     version=\"1.1\">\n                    <wpt lat=\"${marker.latlng.lat.toFixed(6)}\" lon=\"${marker.latlng.lng.toFixed(6)}\">\n                        <name>${label}</name>\n                    </wpt>\n                </gpx>\n            `;\n            var filename = marker.properties.name || ' ';\n            saveAs(new Blob([gpx], {type: 'application/gpx+xml'}), filename + '.gpx', true);\n        },\n\n        _passToKml: function(marker) {\n            let label = marker.tooltip;\n            if (typeof label === 'function') {\n                label = label(marker);\n            }\n            label = escapeHtml(label);\n            const kml = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n                <kml xmlns=\"http://www.opengis.net/kml/2.2\">\n                    <Placemark>\n                        <name>${label}</name>\n                        <Point>\n                            <coordinates>\n                                ${marker.latlng.lng.toFixed(6)},${marker.latlng.lat.toFixed(6)},0\n                            </coordinates>\n                        </Point>\n                    </Placemark>\n                </kml>\n            `;\n            var filename = marker.properties.name || ' ';\n            saveAs(new Blob([kml], {type: 'application/vnd.google-earth.kml+xml'}), filename + '.kml', true);\n        },\n\n        _makeIcon: function(marker) {\n            var className;\n            className = 'westra-pass-marker ';\n            if (marker.properties.is_summit) {\n                className += 'westra-pass-marker-summit';\n            } else {\n                className += 'westra-pass-marker-' + marker.properties.grade_eng;\n            }\n            return iconFromBackgroundImage(className);\n        },\n\n        _loadMarkers: function(xhr) {\n            var markers = [],\n                features = JSON.parse(xhr.response),\n                feature, i, marker;\n            for (i = 0; i < features.length; i++) {\n                feature = features[i];\n                marker = {\n                    latlng: {\n                        lat: feature.latlon[0],\n                        lng: feature.latlon[1]\n                    },\n                    label: feature.name || \"\",\n                    icon: this._makeIcon,\n                    tooltip: this._makeTooltip.bind(this),\n                    properties: feature\n                };\n                markers.push(marker);\n            }\n            this.addMarkers(markers);\n            this._dataLoaded = true;\n            this.fire('data-loaded');\n        },\n\n        showPassDescription: function(e) {\n            if (!this._map) {\n                return;\n            }\n            const properties = e.marker.properties,\n                latLng = e.marker.latlng,\n                url = 'https://westra.ru/passes/Passes/' + properties.id;\n            let altnames = '',\n                connects = '',\n                comments = '';\n            if (properties.altnames) {\n                altnames = `\n                    <tr>\n                        <td> </td>\n                        <td>${properties.altnames}</td>\n                    </tr>`;\n            }\n\n            if (!properties.is_summit) {\n                connects = `\n                    <tr>\n                        <td></td>\n                        <td>${properties.connects || \"o\"}</td>\n                    </tr>`;\n            }\n\n            if (properties.comments) {\n                for (let comment of properties.comments) {\n                    let user = '';\n                    if (comment.user) {\n                        user = `<span class=\"westra-passes-description-comment-author\">${comment.user}:</span>`;\n                    }\n                    comments += `<p class=\"westra-passes-description-comment\">${user}${comment.content}</p>`;\n                }\n                comments = `\n                    <tr>\n                        <td></td>\n                        <td>${comments}</td>\n                    </tr>`;\n            }\n            let reports;\n            if (properties.reports_total) {\n                reports =\n                    `<br>: ${properties.reports_total}, ` +\n                    ` : ${properties.reports_photo || 0}, ` +\n                    ` : ${properties.reports_tech || 0}`;\n            } else {\n                reports = '<br> ';\n            }\n            let description = `\n                <table class=\"pass-details\">\n                    <tr>\n                        <td>${properties.is_summit ? ' ' : ' '}</td>\n                        <td>${properties.name || ' '}</td>\n                    </tr>\n                    ${altnames}\n                    <tr>\n                        <td></td>\n                        <td>${properties.grade || \"\"}</td>\n                    </tr>\n                    <tr>\n                        <td></td>\n                        <td>${properties.elevation ? (properties.elevation + ' ') : ''}</td>\n                    </tr>\n                    ${connects}\n                    <tr>\n                        <td> </td>\n                        <td>${properties.slopes || \"\"}</td>\n                    </tr>\n                    <tr>\n                        <td></td>\n                        <td>\n                            <table class=\"coords\">\n                                <tr class=\"header\">\n                                    <td></td>\n                                    <td></td>\n                                </tr>\n                                <tr>\n                                    <td>${latLng.lat.toFixed(5)}</td>\n                                    <td>${latLng.lng.toFixed(5)}</td>\n                                    <td><a id=\"westra-pass-gpx\" title=\"\">gpx</a></td>\n                                    <td><a id=\"westra-pass-kml\" title=\"\">kml</a></td>\n                                </tr>\n                            </table>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>  </td>\n                        <td><a id=\"westra-pass-link\" href=\"${url}\">${url}</a>${reports}</td></tr>\n                    <tr>\n                        <td></td>\n                        <td>${properties.author || \"\"}</td>\n                    </tr>\n                    ${comments}\n                </table>`;\n            this._map.openPopup(description, latLng, {maxWidth: 500});\n            document.getElementById('westra-pass-link').onclick = function() {\n                openPopupWindow(url, 780, 'westra-details');\n                return false;\n            };\n            document.getElementById('westra-pass-gpx').onclick = function() {\n                this._passToGpx(e.marker);\n                return false;\n            }.bind(this);\n            document.getElementById('westra-pass-kml').onclick = function() {\n                this._passToKml(e.marker);\n                return false;\n            }.bind(this);\n        }\n    }\n);\n\nexport {WestraPassesMarkers};\n","import {notify} from '~/lib/notifications';\n\nfunction openPopupWindow(url, width, uniqName = null) {\n    var left, top, height,\n        screenLeft = screen.availLeft || 0,\n        bordersWidth = 8;\n    // if browser window is in the right half of screen, place new window on left half\n    if (window.screenX - screenLeft - bordersWidth * 1.5 > width) {\n        left = window.screenX - width - bordersWidth * 1.5;\n        // if browser window is in the left half of screen, place new window on right half\n    } else if (window.screenX + window.outerWidth + width + bordersWidth * 1.5 < screenLeft + screen.availWidth) {\n        left = window.screenX + window.outerWidth + bordersWidth;\n        // if screen is small or browser window occupies whole screen, place new window on top of current window\n    } else {\n        left = window.screenX + window.outerWidth / 2 - width / 2;\n        if (left < 0) {\n            left = 0;\n        }\n    }\n    top = window.screenY;\n    height = window.innerHeight;\n    var features = 'width=' + width + ',height=' + height + ',left=' + left + ',top=' + top;\n    features += ',resizable,scrollbars';\n    var newWindow = window.open(url, uniqName, features);\n    if (!newWindow || newWindow.closed) {\n        notify('   .\\n' +\n            '            .\\n\\n' +\n            'Pop-up window was blocked by the browser.\\n' +\n            'If you want to use the full functionality of this site, ' +\n            'turn off blocking pop-ups in the browser settings for this site.');\n    } else {\n        newWindow.focus();\n    }\n}\n\nexport {openPopupWindow};\n","function cached(f) {\n    var cache = {};\n    return function(arg) {\n        if (!(arg in cache)) {\n            cache[arg] = f(arg);\n        }\n        return cache[arg];\n    };\n}\n\nfunction iconFromBackgroundImage(className) {\n    const container = document.createElement('div');\n    container.style.position = 'absolute';\n    document.body.appendChild(container);\n    const el = document.createElement('div');\n    el.className = className;\n    container.appendChild(el);\n    const st = window.getComputedStyle(el),\n        url = st.backgroundImage.replace(/^url\\(\"?/u, '').replace(/\"?\\)$/u, '');\n    let icon = {url: url, center: [-el.offsetLeft, -el.offsetTop]};\n    document.body.removeChild(container);\n    container.removeChild(el);\n    return icon;\n}\n\nexport default cached(iconFromBackgroundImage);\n","import L from \"leaflet\";\nimport '~/lib/leaflet.layer.canvasMarkers';\n\nL.Layer.CanvasMarkers.include({\n        _printProgressWeight: 0.1,\n\n        cloneMarker: function(marker) {\n            return {\n                latlng: {lat: marker.latlng.lat, lng: marker.latlng.lng},\n                label: marker.label,\n                icon: marker.icon\n            };\n        },\n\n        cloneMarkers: function() {\n            const markers = this.rtree.all();\n\n            const markersCopy = markers.map(this.cloneMarker);\n            return markersCopy;\n        },\n\n        cloneForPrint: function(options) {\n            options = L.Util.extend({}, this.options, {noWrap: true});\n            if (options.printIconsOpacity !== undefined) {\n                options.iconsOpacity = options.printIconsOpacity;\n            }\n            return new L.Layer.CanvasMarkers(this.cloneMarkers(), options);\n        },\n\n        getTilesInfo: async function(printOptions) {\n            this.options.iconScale = printOptions.resolution / 90 * 0.75;\n            const scale = printOptions.pixelBounds.getSize().x / printOptions.destPixelSize.x;\n            const pixelExtents = {\n                tileN: printOptions.pixelBounds.getTopRight().y / scale,\n                tileS: printOptions.pixelBounds.getBottomLeft().y / scale,\n                tileE: printOptions.pixelBounds.getTopRight().x / scale,\n                tileW: printOptions.pixelBounds.getBottomLeft().x / scale\n            };\n            const crs = L.CRS.EPSG3857;\n            if (!this._map) {\n                const dummyMap = {\n                    project: crs.latLngToPoint.bind(crs),\n                    unproject: crs.pointToLatLng.bind(crs),\n                };\n                this._map = dummyMap;\n            }\n            const zoom = crs.zoom((1 / scale) * crs.scale(printOptions.zoom));\n            const {iconUrls, markerJobs, pointsForLabels} = this.selectMarkersForDraw(pixelExtents, zoom, true);\n            await this.preloadIcons(iconUrls);\n            return {\n                iterateTilePromises: (function*() {\n                    yield {\n                        tilePromise: Promise.resolve({\n                                draw: (canvas) => {\n                                    this.resetLabels();\n                                    this.drawSelectedMarkers(canvas, pixelExtents, markerJobs, pointsForLabels, zoom,\n                                        true);\n                                },\n                                isOverlay: true,\n                                overlaySolid: !this.options.printTransparent\n                            }\n                        ),\n                        abortLoading: () => {\n                            // no actions needed\n                        }\n                    };\n                }).bind(this),\n                count: 1\n            };\n        }\n    }\n);\n","import L from 'leaflet';\nimport './measured_line.css';\n\nfunction pointOnSegmentAtDistance(p1, p2, dist) {\n    // FIXME: we should place markers along projected line to avoid transformation distortions\n    var q = dist / p1.distanceTo(p2),\n        x = p1.lng + (p2.lng - p1.lng) * q,\n        y = p1.lat + (p2.lat - p1.lat) * q;\n    return L.latLng(y, x);\n}\n\nfunction sinCosFromLatLonSegment(segment) {\n    const\n        p1 = L.CRS.EPSG3857.project(segment[0]),\n        p2 = L.CRS.EPSG3857.project(segment[1]),\n        dx = p2.x - p1.x,\n        dy = p1.y - p2.y,\n        len = Math.sqrt(dx * dx + dy * dy),\n        sin = dy / len,\n        cos = dx / len;\n    return [sin, cos];\n}\n\nL.MeasuredLine = L.Polyline.extend({\n        options: {\n            minTicksIntervalMm: 15,\n        },\n\n        onAdd: function(map) {\n            L.Polyline.prototype.onAdd.call(this, map);\n            this._ticks = {};\n            this.updateTicks();\n            this._map.on('zoomend', this.updateTicks, this);\n            // markers are created only for visible part of map, need to update when it changes\n            this._map.on('moveend', this.updateTicks, this);\n            this.on('nodeschanged', this.updateTicksLater, this);\n        },\n\n        updateTicksLater: function() {\n            setTimeout(this.updateTicks.bind(this), 0);\n        },\n\n        onRemove: function(map) {\n            this._map.off('zoomend', this.updateTicks, this);\n            this._map.off('moveend', this.updateTicks, this);\n            this.off('nodeschanged', this.updateTicks, this);\n            this._clearTicks();\n            L.Polyline.prototype.onRemove.call(this, map);\n        },\n\n        _clearTicks: function() {\n            if (this._map) {\n                Object.values(this._ticks).forEach((tick) => this._map.removeLayer(tick));\n                this._ticks = {};\n            }\n        },\n\n        _addTick: function(tick, marker) {\n            var transformMatrixString = 'matrix(' + tick.transformMatrix.join(',') + ')';\n            if (marker) {\n                marker._icon.childNodes[0].style.transform = transformMatrixString;\n                marker.setLatLng(tick.position);\n            } else {\n                var labelText = Math.round((tick.distanceValue / 10)) / 100 + ' km',\n                    icon = L.divIcon(\n                        {\n                            html: '<div class=\"measure-tick-icon-text\" style=\"transform:' +\n                                transformMatrixString + '\">' +\n                            labelText + '</div>',\n                            className: 'measure-tick-icon'\n                        }\n                    );\n                marker = L.marker(tick.position, {\n                    icon: icon,\n                    interactive: false,\n                    keyboard: false,\n                    projectedShift: () => this.shiftProjectedFitMapView(),\n                });\n                marker.addTo(this._map);\n            }\n            this._ticks[tick.distanceValue.toString()] = marker;\n        },\n\n        setMeasureTicksVisible: function(visible) {\n            this.options.measureTicksShown = visible;\n            this.updateTicks();\n        },\n\n        getTicksPositions: function(minTicksIntervalMeters, bounds) {\n            var steps = [500, 1000, 2000, 5000, 10000, 20000, 50000, 100000, 200000, 500000, 1000000];\n            var ticks = [];\n\n            const that = this;\n            function addTick(position, segment, distanceValue) {\n                if (bounds) {\n                    // create markers only in visible part of map\n                    const normalizedBounds = that._map.wrapLatLngBounds(bounds);\n                    const normalizedPosition = position.wrap();\n                    // account for worldCopyJump\n                    const positionMinus360 = L.latLng(normalizedPosition.lat, normalizedPosition.lng - 360);\n                    const positionPlus360 = L.latLng(normalizedPosition.lat, normalizedPosition.lng + 360);\n                    if (\n                        !normalizedBounds.contains(normalizedPosition) &&\n                        !normalizedBounds.contains(positionMinus360) &&\n                        !normalizedBounds.contains(positionPlus360)\n                    ) {\n                        return;\n                    }\n                }\n\n                var sinCos = sinCosFromLatLonSegment(segment),\n                    sin = sinCos[0],\n                    cos = sinCos[1],\n                    transformMatrix;\n\n                if (sin > 0) {\n                    transformMatrix = [sin, -cos, cos, sin, 0, 0];\n                } else {\n                    transformMatrix = [-sin, cos, -cos, -sin, 0, 0];\n                }\n                ticks.push({position: position, distanceValue: distanceValue, transformMatrix: transformMatrix});\n            }\n\n            let step;\n            for (step of steps) {\n                if (step >= minTicksIntervalMeters) {\n                    break;\n                }\n            }\n\n            var lastTickMeasure = 0,\n                lastPointMeasure = 0,\n                points = this._latlngs,\n                points_n = points.length,\n                nextPointMeasure,\n                segmentLength;\n            if (points_n < 2) {\n                return ticks;\n            }\n\n            for (var i = 1; i < points_n; i++) {\n                segmentLength = points[i].distanceTo(points[i - 1]);\n                nextPointMeasure = lastPointMeasure + segmentLength;\n                if (nextPointMeasure >= lastTickMeasure + step) {\n                    while (lastTickMeasure + step <= nextPointMeasure) {\n                        lastTickMeasure += step;\n                        addTick(\n                            pointOnSegmentAtDistance(points[i - 1], points[i], lastTickMeasure - lastPointMeasure),\n                            [points[i - 1], points[i]],\n                            lastTickMeasure\n                        );\n                    }\n                }\n                lastPointMeasure = nextPointMeasure;\n            }\n            // remove last mark if it is close to track end\n            if (lastPointMeasure - lastTickMeasure < minTicksIntervalMeters / 2) {\n                ticks.pop();\n            }\n            // special case: if track is versy short, do not add starting mark\n            if (lastPointMeasure > minTicksIntervalMeters / 2) {\n                addTick(points[0], [points[0], points[1]], 0);\n            }\n            addTick(points[points_n - 1], [points[points_n - 2], points[points_n - 1]], lastPointMeasure);\n            return ticks;\n        },\n\n        updateTicks: function() {\n            if (!this._map) {\n                return;\n            }\n            if (!this.options.measureTicksShown) {\n                this._clearTicks();\n                return;\n            }\n            var bounds = this._map.getBounds().pad(1),\n                rad = Math.PI / 180,\n                dpi = 96,\n                mercatorMetersPerPixel = 20003931 / (this._map.project([180, 0]).x),\n                referencePoint = this.getLatLngs().length ? this.getBounds().getCenter() : this._map.getCenter(),\n                realMetersPerPixel = mercatorMetersPerPixel * Math.cos(referencePoint.lat * rad),\n                mapScale = 1 / dpi * 2.54 / 100 / realMetersPerPixel,\n                minTicksIntervalMeters = this.options.minTicksIntervalMm / mapScale / 1000,\n                ticks = this.getTicksPositions(minTicksIntervalMeters, bounds),\n                oldTicks = this._ticks;\n            this._ticks = {};\n            ticks.forEach(function(tick) {\n                    var oldMarker = oldTicks[tick.distanceValue.toString()];\n                    this._addTick(tick, oldMarker);\n                    if (oldMarker) {\n                        delete oldTicks[tick.distanceValue.toString()];\n                    }\n                }.bind(this)\n            );\n            Object.values(oldTicks).forEach((tick) => this._map.removeLayer(tick));\n        },\n\n        getLength: function() {\n            var points = this._latlngs,\n                points_n = points.length,\n                length = 0;\n\n            for (var i = 1; i < points_n; i++) {\n                length += points[i].distanceTo(points[i - 1]);\n            }\n            return length;\n        }\n    }\n);\n\nL.measuredLine = function(latlngs, options) {\n    return new L.MeasuredLine(latlngs, options);\n};\n","import L from 'leaflet';\n\nclass RetinaTileLayer extends L.TileLayer {\n    constructor(urls, options, hiRes = 'auto') {\n        let url, tileSizeMultiplicator;\n        const useHiResTiles = hiRes === 'auto' ? L.Browser.retina : hiRes;\n        const newOptions = L.extend({}, options);\n        if (useHiResTiles) {\n            url = urls[1];\n            tileSizeMultiplicator = 2;\n        } else {\n            tileSizeMultiplicator = 1;\n            url = urls[0];\n        }\n        if (options.retinaOptionsOverrides) {\n            L.extend(newOptions, options.retinaOptionsOverrides[useHiResTiles ? 1 : 0]);\n        }\n        super(url, newOptions);\n        this.urls = urls;\n        this.tileSizeMultiplicator = tileSizeMultiplicator;\n    }\n}\n\nexport {RetinaTileLayer};\n","import declination from './declination.json';\nimport {stringToArrayBuffer} from '~/lib/binary-strings';\n\nlet data;\n\nfunction mod(x, n) {\n    return ((x % n) + n) % n;\n}\n\nfunction loadData() {\n    const ar1 = new Uint8Array(stringToArrayBuffer(atob(declination.array)));\n    const ar2 = new Float32Array(ar1.length);\n    const scale = declination.valueScale;\n    const offset = declination.valueOffset;\n    for (let i = 0; i < ar1.length; i++) {\n        ar2[i] = ar1[i] / scale - offset;\n    }\n    return ar2;\n}\n\nfunction getArrayValue(row, col) {\n    if (row < 0 || col < 0 || col >= declination.colsCount || row >= declination.rowsCount) {\n        throw new Error(`Invalid col/row value col=${col} row=${row}`);\n    }\n    const ind = row * declination.colsCount + col;\n    if (ind >= data.length) {\n        throw new Error('Index value out of range');\n    }\n    return data[ind];\n}\n\nfunction getDeclination(lat, lon) {\n    if (lat < declination.minLat || lat > declination.maxLat) {\n        return null;\n    }\n    lon = mod(lon + 180, 360) - 180;\n    const row1 = Math.floor((lat - declination.minLat) / declination.step);\n    const row2 = row1 + 1;\n    const dlat = (lat - (row1 * declination.step + declination.minLat)) / declination.step;\n    let col1 = Math.floor((lon + 180) / declination.step);\n    let col2 = col1 + 1;\n    const dlon = (lon - (col1 * declination.step - 180)) / declination.step;\n    col1 %= declination.colsCount;\n    col2 %= declination.colsCount;\n    let a1 = getArrayValue(row1, col1);\n    let a2 = getArrayValue(row1, col2);\n    const v1 = a1 * (1 - dlon) + a2 * dlon;\n    if (row2 >= declination.rowsCount) {\n        return v1;\n    }\n    a1 = getArrayValue(row2, col1);\n    a2 = getArrayValue(row2, col2);\n    const v2 = a1 * (1 - dlon) + a2 * dlon;\n    const v = v1 * (1 - dlat) + v2 * dlat;\n    return v;\n}\n\ndata = loadData();\n\nexport {getDeclination};\n","import L from 'leaflet';\nimport './style.css';\n\nconst CloseButtonMixin = {\n    createCloseButton: function(container) {\n        this.closeButton = L.DomUtil.create('div', 'photo-viewer-button-close', container);\n        L.DomEvent.on(this.closeButton, 'click', this.onCloseClick, this);\n    },\n\n    onCloseClick: function() {\n        this.fire('closeclick');\n    },\n};\n\nfunction formatDateTime(ts) {\n    const d = new Date(ts);\n    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n    return `${d.getDate()} ${months[d.getMonth()]} ${d.getFullYear()}`;\n}\n\nconst DateLabelMixin = {\n    createDateLabel: function(container) {\n        this.dateLabel = L.DomUtil.create('div', 'mapillary-viewer-date-overlay', container);\n    },\n\n    updateDateLabel: function(timestamp) {\n        this.dateLabel.innerHTML = formatDateTime(timestamp);\n    }\n};\n\nexport {CloseButtonMixin, DateLabelMixin};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from \"leaflet\";\n\nconst DragEvents = L.Evented.extend({\n        options: {\n            dragTolerance: 2,\n            dragButtons: [0],\n            stopOnLeave: false,\n        },\n\n        initialize: function(element, options) {\n            L.setOptions(this, options);\n            this.element = element;\n\n            this.dragButton = null;\n            this.startEvent = null;\n            this.prevEvent = null;\n            this.isDragging = false;\n\n            L.DomEvent.on(element, 'mousedown', this.onMouseDown, this);\n        },\n\n        onMouseDown: function(e) {\n            if (this.dragButton === null && this.options.dragButtons.includes(e.button)) {\n                this.dragButton = e.button;\n                this.startEvent = e;\n                this.prevEvent = e;\n                L.DomUtil.disableImageDrag();\n                L.DomUtil.disableTextSelection();\n                this._moveHandler = this.onMouseMove.bind(this);\n                document.addEventListener('mousemove', this._moveHandler, true);\n                L.DomEvent.on(document, 'mouseup', this.onMouseUp, this);\n                if (this.options.stopOnLeave) {\n                    L.DomEvent.on(this.element, 'mouseleave', this.onMouseLeave, this);\n                }\n            }\n        },\n\n        onMouseUp: function(e) {\n            if (this.dragButton === e.button) {\n                if (this.isDragging) {\n                    this.fireDragEvent('dragend', e);\n                } else {\n                    this.fire('click', {originalEvent: e, target: this.element});\n                }\n                this.finishDrag();\n            }\n        },\n\n        onMouseMove: function(e) {\n            var that = this;\n            function exceedsTolerance() {\n                var tolerance = that.options.dragTolerance;\n                return Math.abs(e.clientX - that.startEvent.clientX) > tolerance ||\n                    Math.abs(e.clientY - that.startEvent.clientY) > tolerance;\n            }\n\n            if (this.isDragging) {\n                this.fireDragEvent('drag', e);\n                this.prevEvent = e;\n            } else if (this.dragButton !== null && exceedsTolerance()) {\n                this.isDragging = true;\n                this.fireDragEvent('dragstart', this.startEvent);\n                this.fireDragEvent('drag', e);\n                this.prevEvent = e;\n            }\n        },\n\n        onMouseLeave: function(e) {\n            if (this.isDragging) {\n                this.fireDragEvent('dragend', e);\n                this.finishDrag();\n            }\n        },\n\n        fireDragEvent: function(type, originalEvent) {\n            const prevPos = L.point(this.prevEvent.clientX, this.prevEvent.clientY);\n            const pos = L.point(originalEvent.clientX, originalEvent.clientY);\n            const data = {\n                dragButton: this.dragButton,\n                originalEvent,\n                dragMovement: pos.subtract(prevPos) // e.movementX is not available in Safari\n            };\n            this.fire(type, data);\n        },\n\n        finishDrag: function() {\n            this.isDragging = false;\n            this.dragButton = null;\n            L.DomUtil.enableImageDrag();\n            L.DomUtil.enableTextSelection();\n            document.removeEventListener('mousemove', this._moveHandler, true);\n            L.DomEvent.off(document, 'mouseup', this.onMouseUp, this);\n            L.DomEvent.off(this.element, 'mouseleave', this.onMouseLeave, this);\n        }\n    }\n);\n\nexport {DragEvents};\n","function xmlGetNodeText(node) {\n    if (node) {\n        return Array.prototype.slice.call(node.childNodes)\n            .map(function(node) {\n                    return node.nodeValue;\n                }\n            )\n            .join('');\n    }\n    return null;\n}\n\nexport {xmlGetNodeText};\n","(function (GLOBAL) {\n    function decodeUTF8(s){\n        return decodeURIComponent(escape(s));\n    }\n\n    var JSUnzip = function (fileContents) {\n        this.fileContents = new JSUnzip.BigEndianBinaryStream(fileContents);\n    }\n    GLOBAL.JSUnzip = JSUnzip;\n    JSUnzip.MAGIC_NUMBER = 0x04034b50;\n\n    JSUnzip.prototype = {\n        readEntries: function () {\n            if (!this.isZipFile()) {\n                throw new Error(\"File is not a Zip file.\");\n            }\n\n            this.entries = [];\n            var e = new JSUnzip.ZipEntry(this.fileContents);\n            while (typeof(e.data) === \"string\") {\n                this.entries.push(e);\n                e = new JSUnzip.ZipEntry(this.fileContents);\n            }\n        },\n\n        isZipFile: function () {\n            return this.fileContents.getByteRangeAsNumber(0, 4) === JSUnzip.MAGIC_NUMBER;\n        }\n    }\n\n    JSUnzip.ZipEntry = function (binaryStream) {\n        this.signature          = binaryStream.getNextBytesAsNumber(4);\n        if (this.signature !== JSUnzip.MAGIC_NUMBER) {\n            return;\n        }\n\n        this.versionNeeded      = binaryStream.getNextBytesAsNumber(2);\n        this.bitFlag            = binaryStream.getNextBytesAsNumber(2);\n        this.compressionMethod  = binaryStream.getNextBytesAsNumber(2);\n        this.timeBlob           = binaryStream.getNextBytesAsNumber(4);\n\n        if (this.isEncrypted()) {\n            throw \"File contains encrypted entry. Not supported.\";\n        }\n\n\n        this.crc32              = binaryStream.getNextBytesAsNumber(4);\n        this.compressedSize     = binaryStream.getNextBytesAsNumber(4);\n        this.uncompressedSize   = binaryStream.getNextBytesAsNumber(4);\n\n        if (this.isUsingZip64()) {\n            throw \"File is using Zip64 (4gb+ file size). Not supported\";\n        }\n\n        this.fileNameLength     = binaryStream.getNextBytesAsNumber(2);\n        this.extraFieldLength   = binaryStream.getNextBytesAsNumber(2);\n\n        this.fileName  = binaryStream.getNextBytesAsString(this.fileNameLength);\n        this.extra     = binaryStream.getNextBytesAsString(this.extraFieldLength);\n        this.data      = binaryStream.getNextBytesAsString(this.compressedSize);\n\n        if (this.isUsingBit3TrailingDataDescriptor()) {\n            if (typeof(console) !== \"undefined\") {\n                console.log( \"File is using bit 3 trailing data descriptor. Not supported.\");\n            }\n            binaryStream.getNextBytesAsNumber(16);  //Skip the descriptor and move to beginning of next ZipEntry\n        }\n\n        if (this.isUsingUtf8()) {\n            this.fileName = decodeUTF8(this.fileName);\n        }\n\n    }\n\n    JSUnzip.ZipEntry.prototype = {\n        isEncrypted: function () {\n            return (this.bitFlag & 0x01) === 0x01;\n        },\n\n        isUsingUtf8: function () {\n            return (this.bitFlag & 0x0800) === 0x0800;\n        },\n\n        isUsingBit3TrailingDataDescriptor: function () {\n            return (this.bitFlag & 0x0008) === 0x0008;\n        },\n\n        isUsingZip64: function () {\n            return this.compressedSize === 0xFFFFFFFF ||\n                this.uncompressedSize === 0xFFFFFFFF;\n        }\n    }\n\n    JSUnzip.BigEndianBinaryStream = function (stream) {\n        this.stream = stream;\n        this.resetByteIndex();\n    }\n\n    JSUnzip.BigEndianBinaryStream.prototype = {\n        // The index of the current byte, used when we step through the byte\n        // with getNextBytesAs*.\n        resetByteIndex: function () {\n            this.currentByteIndex = 0;\n        },\n\n        getByteAt: function (index) {\n            return this.stream.charCodeAt(index);\n        },\n\n        getNextBytesAsNumber: function (steps) {\n            var res = this.getByteRangeAsNumber(this.currentByteIndex, steps);\n            this.currentByteIndex += steps;\n            return res;\n        },\n\n        getNextBytesAsString: function (steps) {\n            var res = this.getByteRangeAsString(this.currentByteIndex, steps);\n            this.currentByteIndex += steps;\n            return res;\n        },\n\n        // Big endian, so we're going backwards.\n        getByteRangeAsNumber: function (index, steps) {\n            var result = 0;\n            var i = index + steps - 1;\n            while (i >= index) {\n                result = (result << 8) + this.getByteAt(i);\n                i--;\n            }\n            return result;\n        },\n\n        getByteRangeAsString: function (index, steps) {\n            var result = \"\";\n            var max = index + steps;\n            var i = index;\n            while (i < max) {\n                var charCode = this.getByteAt(i);\n                result += String.fromCharCode(charCode);\n                // Accounting for multi-byte strings.\n                max -= Math.floor(charCode / 0x100);\n                i++;\n            }\n            return result;\n        }\n    }\n}(this));\n","import tynyInflate from 'tiny-inflate';\nimport {stringToArrayBuffer, arrayBufferToString} from '~/lib/binary-strings';\n\nfunction jsInflate(compressed, originalSize) {\n    if (originalSize === 0) {\n        return '';\n    }\n    const out = new Uint8Array(originalSize);\n    tynyInflate(new Uint8Array(stringToArrayBuffer(compressed)), out);\n    return arrayBufferToString(out);\n}\n\nexport default jsInflate;\n","function decode866(s) {\n    var c, i,\n        s2 = [];\n    for (i = 0; i < s.length; i++) {\n        c = s.charCodeAt(i);\n        if (c >= 128 && c <= 175) {\n            c += (0x410 - 128);\n        } else if (c >= 224 && c <= 239) {\n            c += (0x440 - 224);\n        } else if (c === 240) {\n            c = 0x0401;\n        } else if (c === 241) {\n            c = 0x0451;\n        }\n        s2.push(String.fromCharCode(c));\n    }\n    return s2.join('');\n}\n\nfunction decodeCP1251(s) {\n    var c, i,\n        s2 = [];\n    for (i = 0; i < s.length; i++) {\n        c = s.charCodeAt(i);\n        if (c >= 192 && c <= 255) {\n            c += (0x410 - 192);\n        } else if (c === 168) {\n            c = 0x0401;\n        } else if (c === 184) {\n            c = 0x0451;\n        }\n        s2.push(String.fromCharCode(c));\n    }\n    return s2.join('');\n}\n\nexport {decode866, decodeCP1251};\n\n","import BaseService from '../baseService';\nimport {parseNktkSequence, parseTrackUrlData, parseNktkFragment} from '../../parsers/nktk';\nimport config from '~/config';\nimport {parseHashParams} from '~/lib/leaflet.hashState/hashState';\nimport loadFromUrl from '../../loadFromUrl';\nimport loadTracksFromJson from './loadTracksFromJson';\nimport {fetch} from '~/lib/xhr-promise';\n\nfunction flattenArray(ar) {\n    const res = [];\n    for (const it of ar) {\n        res.push(...it);\n    }\n    return res;\n}\n\nfunction parsePointFromHashValues(values) {\n    if (values.length < 2) {\n        return [{name: 'Point in url', error: 'CORRUPT'}];\n    }\n    const lat = parseFloat(values[0]);\n    const lng = parseFloat(values[1]);\n    if (isNaN(lat) || isNaN(lng) || lat < -90 || lat > 90 || lng < -180 || lng > 180) {\n        return [{name: 'Point in url', error: 'CORRUPT'}];\n    }\n    const name = ((values[2] || '').trim()) || 'Point';\n    return [{name, points: [{name, lat, lng}]}];\n}\n\nclass NakarteTrack extends BaseService {\n    isOurUrl() {\n        return this.origUrl.indexOf('track://') > -1;\n    }\n\n    requestOptions() {\n        return [];\n    }\n\n    parseResponse() {\n        const i = this.origUrl.indexOf('track://');\n        return parseTrackUrlData(this.origUrl.substring(i + 8));\n    }\n}\n\nclass NakarteUrlLoader {\n    constructor() {\n        this.loaders = {\n            nktk: this.loadFromTextEncodedTrack,\n            nktl: this.loadFromTextEncodedTrackId,\n            nktu: this.loadFromUrlencodedUrls,\n            nktp: this.loadPoint,\n            nktj: this.loadFromJSON\n        };\n    }\n\n    paramNames() {\n        return Object.keys(this.loaders);\n    }\n\n    async geoData(paramName, values) {\n        const loader = this.loaders[paramName];\n        return loader.call(this, values);\n    }\n\n    async loadFromTextEncodedTrack(values) {\n        return flattenArray(values.map(parseNktkFragment));\n    }\n\n    async loadFromTextEncodedTrackId(values) {\n        const requests = values.map((trackId) =>\n            fetch(\n                `${config.tracksStorageServer}/track/${trackId}`,\n                {responseType: 'binarystring', withCredentials: true}\n            )\n        );\n        let responses;\n        try {\n            responses = await Promise.all(requests);\n        } catch (e) {\n            return [{name: 'Track from nakarte server', error: 'NETWORK'}];\n        }\n        return flattenArray(responses.map((r) => parseNktkSequence(r.responseBinaryText)));\n    }\n\n    async loadFromJSON(values) {\n        return flattenArray(await Promise.all(values.map(loadTracksFromJson)));\n    }\n\n    async loadFromUrlencodedUrls(values) {\n        return flattenArray(await Promise.all(values.map(decodeURIComponent).map(loadFromUrl)));\n    }\n\n    async loadPoint(values) {\n        return parsePointFromHashValues(values.map(decodeURIComponent));\n    }\n}\n\nclass NakarteUrl {\n    constructor(url) {\n        const paramNames = new NakarteUrlLoader().paramNames();\n        this._params = Object.entries(parseHashParams(url))\n            .filter(([name]) => paramNames.includes(name));\n    }\n\n    isOurUrl() {\n        return this._params.length > 0;\n    }\n\n    async geoData() {\n        const promises = this._params.map(([paramName, value]) => new NakarteUrlLoader().geoData(paramName, value));\n        return flattenArray(await Promise.all(promises));\n    }\n}\n\nexport {NakarteTrack, NakarteUrl, NakarteUrlLoader};\n","function encode(s) {\n    return (btoa(s)\n            .replace(/\\+/ug, '-')\n            .replace(/\\//ug, '_')\n        // .replace(/=+$/, '')\n    );\n}\n\nfunction decode(s) {\n    var decoded;\n    s = s\n        .replace(/[\\n\\r \\t]/ug, '')\n        .replace(/-/ug, '+')\n        .replace(/_/ug, '/');\n    try {\n        decoded = atob(s);\n    } catch (e) {\n        // will return null for malformed data\n    }\n    if (decoded && decoded.length) {\n        return decoded;\n    }\n    return null;\n}\n\nexport {encode, decode};\n","import L from 'leaflet';\nimport './elevation-profile.css';\nimport {ElevationProvider} from '~/lib/elevations';\nimport '~/lib/leaflet.control.commons';\nimport {notify} from '~/lib/notifications';\nimport * as logging from '~/lib/logging';\nimport {DragEvents} from '~/lib/leaflet.events.drag';\n\nfunction calcSamplingInterval(length) {\n    var targetPointsN = 2000;\n    var maxPointsN = 9999;\n    var samplingIntgerval = length / targetPointsN;\n    if (samplingIntgerval < 10) {\n        samplingIntgerval = 10;\n    }\n    if (samplingIntgerval > 50) {\n        samplingIntgerval = 50;\n    }\n    if (length / samplingIntgerval > maxPointsN) {\n        samplingIntgerval = length / maxPointsN;\n    }\n    return samplingIntgerval;\n}\n\nfunction createSvg(tagName, attributes, parent) {\n    var element = document.createElementNS('http://www.w3.org/2000/svg', tagName);\n    if (attributes) {\n        var keys = Object.keys(attributes),\n            key, value;\n        for (var i = 0; i < keys.length; i++) {\n            key = keys[i];\n            value = attributes[key];\n            element.setAttribute(key, value);\n        }\n    }\n    if (parent) {\n        parent.appendChild(element);\n    }\n    return element;\n}\n\nfunction pointOnSegmentAtDistance(p1, p2, dist) {\n    // FIXME: we should place markers along projected line to avoid transformation distortions\n    var q = dist / p1.distanceTo(p2),\n        x = p1.lng + (p2.lng - p1.lng) * q,\n        y = p1.lat + (p2.lat - p1.lat) * q;\n    return L.latLng(y, x);\n}\n\nfunction gradientToAngle(g) {\n    return Math.round(Math.atan(g) * 180 / Math.PI);\n}\n\nfunction pathRegularSamples(latlngs, step) {\n    if (!latlngs.length) {\n        return [];\n    }\n    var samples = [],\n        lastSampleDist = 0,\n        lastPointDistance = 0,\n        nextPointDistance = 0,\n        segmentLength, i;\n\n    samples.push(latlngs[0]);\n    for (i = 1; i < latlngs.length; i++) {\n        segmentLength = latlngs[i].distanceTo(latlngs[i - 1]);\n        nextPointDistance = lastPointDistance + segmentLength;\n        if (nextPointDistance >= lastSampleDist + step) {\n            while (lastSampleDist + step <= nextPointDistance) {\n                lastSampleDist += step;\n                samples.push(\n                    pointOnSegmentAtDistance(latlngs[i - 1], latlngs[i], lastSampleDist - lastPointDistance)\n                );\n            }\n        }\n        lastPointDistance = nextPointDistance;\n    }\n    if (samples.length < 2) {\n        samples.push(latlngs[latlngs.length - 1]);\n    }\n    return samples;\n}\n\nconst ElevationProfile = L.Class.extend({\n        options: {\n            samplingInterval: 50,\n            sightLine: false\n        },\n\n        includes: L.Evented,\n\n        initialize: function(map, latlngs, options) {\n            L.setOptions(this, options);\n            this.path = latlngs;\n            var samples = this.samples = pathRegularSamples(this.path, this.options.samplingInterval);\n            samples = samples.map((latlng) => latlng.wrap());\n            if (!samples.length) {\n                notify('Track is empty');\n                return;\n            }\n            var that = this;\n            this.horizZoom = 1;\n            this.dragStart = null;\n            new ElevationProvider().get(samples)\n                .then(function(values) {\n                        that.values = values;\n                        that._addTo(map);\n                    }\n                )\n                .catch((e) => {\n                    logging.captureException(e, 'error getting elevation');\n                    notify(`Failed to get elevation data: ${e.message}`);\n                });\n            this.values = null;\n        },\n\n        _onWindowResize: function() {\n            this._resizeGraph();\n        },\n\n        _resizeGraph: function() {\n            const newSvgWidth = this.drawingContainer.clientWidth * this.horizZoom;\n            if (this.svgWidth < this.drawingContainer.clientWidth) {\n                this.svgWidth = newSvgWidth;\n                this.svg.setAttribute('width', this.svgWidth + 'px');\n                this.updateGraph();\n                this.updateGraphSelection();\n            }\n        },\n\n        _addTo: function(map) {\n            this._map = map;\n            var container = this._container = L.DomUtil.create('div', 'elevation-profile-container');\n            L.Control.prototype._stopContainerEvents.call(this);\n            this._map._controlContainer.appendChild(container);\n            this.setupContainerLayout();\n            this.updateGraph();\n            const icon = L.divIcon({\n                    className: 'elevation-profile-marker',\n                    html:\n                        '<div class=\"elevation-profile-marker-icon\"></div>' +\n                        '<div class=\"elevation-profile-marker-label\"></div>'\n                }\n            );\n            this.trackMarker = L.marker([1000, 0], {interactive: false, icon: icon});\n            this.polyline = L.polyline(this.path, {weight: 30, opacity: 0}).addTo(map);\n            this.polyline.on('mousemove', this.onLineMouseMove, this);\n            this.polyline.on('mouseover', this.onLineMouseEnter, this);\n            this.polyline.on('mouseout', this.onLineMouseLeave, this);\n            this.polyLineSelection = L.polyline([], {weight: 20, opacity: 0.5, color: 'yellow', lineCap: 'butt'});\n            return this;\n        },\n\n        setupContainerLayout: function() {\n            var horizZoom = this.horizZoom = 1;\n            var container = this._container;\n            this.propsContainer = L.DomUtil.create('div', 'elevation-profile-properties', container);\n            this.leftAxisLables = L.DomUtil.create('div', 'elevation-profile-left-axis', container);\n            this.closeButton = L.DomUtil.create('div', 'elevation-profile-close', container);\n            L.DomEvent.on(this.closeButton, 'click', this.onCloseButtonClick, this);\n            this.drawingContainer = L.DomUtil.create('div', 'elevation-profile-drawingContainer', container);\n            this.graphCursor = L.DomUtil.create('div', 'elevation-profile-cursor elevation-profile-cursor-hidden',\n                this.drawingContainer\n            );\n            this.graphCursorLabel =\n                L.DomUtil.create('div', 'elevation-profile-cursor-label elevation-profile-cursor-hidden',\n                    this.drawingContainer\n                );\n            this.graphSelection = L.DomUtil.create('div', 'elevation-profile-selection elevation-profile-cursor-hidden',\n                this.drawingContainer\n            );\n            var svgWidth = this.svgWidth = this.drawingContainer.clientWidth * horizZoom,\n                svgHeight = this.svgHeight = this.drawingContainer.clientHeight;\n            var svg = this.svg = createSvg('svg', {width: svgWidth, height: svgHeight}, this.drawingContainer);\n            L.DomEvent.on(svg, 'mousemove', this.onSvgMouseMove, this);\n            // We should handle mouseenter event, but due to a\n            // bug in Chrome (https://bugs.chromium.org/p/chromium/issues/detail?id=846738)\n            // this event is emitted while resizing window by dragging right window frame\n            // which causes cursor to appeat while resizing\n            L.DomEvent.on(svg, 'mousemove', this.onSvgEnter, this);\n            L.DomEvent.on(svg, 'mouseleave', this.onSvgLeave, this);\n            L.DomEvent.on(svg, 'mousewheel', this.onSvgMouseWheel, this);\n            this.svgDragEvents = new DragEvents(this.svg, {dragButtons: [0, 2], stopOnLeave: true});\n            this.svgDragEvents.on('dragstart', this.onSvgDragStart, this);\n            this.svgDragEvents.on('dragend', this.onSvgDragEnd, this);\n            this.svgDragEvents.on('drag', this.onSvgDrag, this);\n            this.svgDragEvents.on('click', this.onSvgClick, this);\n            L.DomEvent.on(svg, 'dblclick', this.onSvgDblClick, this);\n            L.DomEvent.on(window, 'resize', this._onWindowResize, this);\n        },\n\n        removeFrom: function(map) {\n            if (this.abortLoading) {\n                this.abortLoading();\n            }\n            if (!this._map) {\n                return this;\n            }\n            this._map._controlContainer.removeChild(this._container);\n            map.removeLayer(this.polyline);\n            map.removeLayer(this.trackMarker);\n            map.removeLayer(this.polyLineSelection);\n            L.DomEvent.off(window, 'resize', this._onWindowResize, this);\n            this._map = null;\n            return this;\n        },\n\n        onSvgDragStart: function(e) {\n            if (e.dragButton === 0) {\n                // FIXME: restore hiding when we make display of selection on map\n                // this.cursorHide();\n                this.polyLineSelection.addTo(this._map).bringToBack();\n                this.selStartIndex = this.roundedSampleIndexFromMouseEvent(e);\n            }\n        },\n\n        graphContainerOffsetFromMouseEvent: function(e) {\n            if (e.originalEvent) {\n                e = e.originalEvent;\n            }\n            let x = e.clientX - this.svg.getBoundingClientRect().left;\n            if (x < 0) {\n                x = 0;\n            }\n            if (x > this.svgWidth - 1) {\n                x = this.svgWidth - 1;\n            }\n            return x;\n        },\n\n        sampleIndexFromMouseEvent: function(e) {\n            const x = this.graphContainerOffsetFromMouseEvent(e);\n            return x / (this.svgWidth - 1) * (this.values.length - 1);\n        },\n\n        roundedSampleIndexFromMouseEvent: function(e) {\n            return Math.round(this.sampleIndexFromMouseEvent(e));\n        },\n\n        setTrackMarkerLabel: function(label) {\n            const icon = this.trackMarker._icon;\n            if (!icon) {\n                return;\n            }\n            icon.getElementsByClassName('elevation-profile-marker-label')[0].innerHTML = label;\n        },\n\n        setGraphSelection: function(cursorIndex) {\n            this.selMinInd = Math.min(cursorIndex, this.selStartIndex);\n            this.selMaxInd = Math.max(cursorIndex, this.selStartIndex);\n\n            if (this.selMinInd < 0) {\n                this.selMinInd = 0;\n            }\n            if (this.selMaxInd > this.values.length - 1) {\n                this.selMaxInd = this.values.length - 1;\n            }\n            this.updateGraphSelection();\n            L.DomUtil.removeClass(this.graphSelection, 'elevation-profile-cursor-hidden');\n        },\n\n        updateGraphSelection: function() {\n            const selStart = this.selMinInd * (this.svgWidth - 1) / (this.values.length - 1);\n            const selEnd = this.selMaxInd * (this.svgWidth - 1) / (this.values.length - 1);\n            this.graphSelection.style.left = selStart + 'px';\n            this.graphSelection.style.width = (selEnd - selStart) + 'px';\n        },\n\n        onSvgDragEnd: function(e) {\n            if (e.dragButton === 0) {\n                this.cursorShow();\n                this.setGraphSelection(this.roundedSampleIndexFromMouseEvent(e));\n                var stats = this.calcProfileStats(this.values.slice(this.selMinInd, this.selMaxInd + 1));\n                this.updatePropsDisplay(stats);\n                L.DomUtil.addClass(this.propsContainer, 'elevation-profile-properties-selected');\n            }\n            if (e.dragButton === 2) {\n                this.drawingContainer.scrollLeft -= e.dragMovement.x;\n            }\n        },\n\n        onSvgDrag: function(e) {\n            if (e.dragButton === 0) {\n                this.setGraphSelection(this.roundedSampleIndexFromMouseEvent(e));\n                this.polyLineSelection.setLatLngs(this.samples.slice(this.selMinInd, this.selMaxInd + 1));\n            }\n            if (e.dragButton === 2) {\n                this.drawingContainer.scrollLeft -= e.dragMovement.x;\n            }\n        },\n\n        onSvgClick: function(e) {\n            const button = e.originalEvent.button;\n            if (button === 0) {\n                this.dragStart = null;\n                L.DomUtil.addClass(this.graphSelection, 'elevation-profile-cursor-hidden');\n                L.DomUtil.removeClass(this.propsContainer, 'elevation-profile-properties-selected');\n                this._map.removeLayer(this.polyLineSelection);\n                if (this.stats) {\n                    this.updatePropsDisplay(this.stats);\n                }\n            }\n            if (button === 2) {\n                this.setMapPositionAtIndex(this.roundedSampleIndexFromMouseEvent(e));\n            }\n        },\n\n        onSvgDblClick: function(e) {\n            this.setMapPositionAtIndex(this.roundedSampleIndexFromMouseEvent(e));\n        },\n\n        setMapPositionAtIndex: function(ind) {\n            var latlng = this.samples[ind];\n            if (latlng) {\n                this._map.panTo(latlng);\n            }\n        },\n\n        onSvgMouseWheel: function(e) {\n            var oldHorizZoom = this.horizZoom;\n            this.horizZoom += L.DomEvent.getWheelDelta(e) > 0 ? 1 : -1;\n            if (this.horizZoom < 1) {\n                this.horizZoom = 1;\n            }\n            if (this.horizZoom > 10) {\n                this.horizZoom = 10;\n            }\n\n            var ind = this.sampleIndexFromMouseEvent(e);\n\n            var newScrollLeft = this.drawingContainer.scrollLeft +\n                this.graphContainerOffsetFromMouseEvent(e) * (this.horizZoom / oldHorizZoom - 1);\n            if (newScrollLeft < 0) {\n                newScrollLeft = 0;\n            }\n\n            this.svgWidth = this.drawingContainer.clientWidth * this.horizZoom;\n            this.svg.setAttribute('width', this.svgWidth + 'px');\n            this.setupGraph();\n            if (newScrollLeft > this.svgWidth - this.drawingContainer.clientWidth) {\n                newScrollLeft = this.svgWidth - this.drawingContainer.clientWidth;\n            }\n            this.drawingContainer.scrollLeft = newScrollLeft;\n\n            this.cursorHide();\n            this.setCursorPosition(ind);\n            this.cursorShow();\n            this.updateGraphSelection();\n        },\n\n        updateGraph: function() {\n            if (!this._map || !this.values) {\n                return;\n            }\n\n            this.stats = this.calcProfileStats(this.values);\n            this.updatePropsDisplay(this.stats);\n            this.setupGraph();\n        },\n\n        updatePropsDisplay: function(stats) {\n            if (!this._map) {\n                return;\n            }\n            let d;\n            if (stats.noData) {\n                d = {\n                    maxElev: '-',\n                    minElev: '-',\n                    startElev: '-',\n                    endElev: '-',\n                    change: '-',\n                    ascentAngleStr: '-',\n                    descentAngleStr: '-',\n                    ascent: '-',\n                    descent: '-',\n                    startApprox: '',\n                    endApprox: '',\n                    approx: '',\n                    incomplete: 'No elevation data',\n                };\n            } else {\n                d = {\n                    maxElev: Math.round(stats.max),\n                    minElev: Math.round(stats.min),\n                    startElev: Math.round(stats.start),\n                    endElev: Math.round(stats.end),\n                    change: Math.round(stats.finalAscent),\n                    ascentAngleStr: isNaN(stats.angleAvgAscent) ? '-' : L.Util.template('{avg} / {max}&deg;',\n                            {avg: stats.angleAvgAscent, max: stats.angleMaxAscent}\n                        ),\n                    descentAngleStr: isNaN(stats.angleAvgDescent) ? '-' : L.Util.template('{avg} / {max}&deg;',\n                            {avg: stats.angleAvgDescent, max: stats.angleMaxDescent}\n                        ),\n                    ascent: Math.round(stats.ascent),\n                    descent: Math.round(stats.descent),\n                    dist: (stats.distance / 1000).toFixed(1),\n                    startApprox: stats.dataLostAtStart > 0.02 ? '~ ' : '',\n                    endApprox: stats.dataLostAtEnd > 0.02 ? '~ ' : '',\n                    approx: stats.dataLost > 0.02 ? '~ ' : '',\n                    incomplete: stats.dataLost > 0.02 ? 'Some elevation data missing' : '',\n                };\n            }\n            d.dist = (stats.distance / 1000).toFixed(1);\n\n            this.propsContainer.innerHTML = `\n                <table>\n                <tr><td>Max elevation:</td><td>${d.maxElev}</td></tr>\n                <tr><td>Min elevation:</td><td>${d.minElev}</td></tr>\n                <tr class=\"start-group\"><td>Start elevation:</td><td>${d.startApprox}${d.startElev}</td></tr>\n                <tr><td>Finish elevation:</td><td>${d.endApprox}${d.endElev}</td></tr>\n                <tr><td>Start to finish elevation change:</td><td>${d.startApprox || d.endApprox}${d.change}</td></tr>\n                <tr class=\"start-group\"><td>Avg / Max ascent inclination:</td><td>${d.ascentAngleStr}</td></tr>\n                <tr><td>Avg / Max descent inclination:</td><td>${d.descentAngleStr}</td></tr>\n                <tr class=\"start-group\"><td>Total ascent:</td><td>${d.approx}${d.ascent}</td></tr>\n                <tr><td>Total descent:</td><td>${d.approx}${d.descent}</td></tr>\n                <tr class=\"start-group\"><td>Distance:</td><td>${d.dist} km</td></tr>\n                <tr><td colspan=\"2\" style=\"text-align: center\">${d.incomplete}</td></tr>\n                </table>\n                `;\n        },\n\n        calcGridValues: function(minValue, maxValue) {\n            var ticksNs = [3, 4, 5],\n                tickSteps = [1, 2, 5, 10, 20, 50, 100, 200, 500, 1000, 2000, 5000, 10000],\n                ticks = [],\n                i, j, k, ticksN, tickStep, tick1, tick2,\n                matchFound = false;\n\n            for (i = 0; i < tickSteps.length; i++) {\n                tickStep = tickSteps[i];\n                for (j = 0; j < ticksNs.length; j++) {\n                    ticksN = ticksNs[j];\n                    tick1 = Math.floor(minValue / tickStep);\n                    tick2 = Math.ceil(maxValue / tickStep);\n                    if ((tick2 - tick1) < ticksN) {\n                        matchFound = true;\n                        break;\n                    }\n                }\n                if (matchFound) {\n                    break;\n                }\n            }\n            for (k = tick1; k < tick1 + ticksN; k++) {\n                ticks.push(k * tickStep);\n            }\n            return ticks;\n        },\n\n        filterElevations: function(values, tolerance) {\n            var filtered = values.slice(0);\n            if (filtered.length < 3) {\n                return filtered;\n            }\n            var scanStart, scanEnd, job, linearValue, linearDelta, maxError, maxErrorInd, i, error;\n            var queue = [[0, filtered.length - 1]];\n            while (queue.length) {\n                job = queue.pop();\n                scanStart = job[0];\n                scanEnd = job[1];\n                linearValue = filtered[scanStart];\n                linearDelta = (filtered[scanEnd] - filtered[scanStart]) / (scanEnd - scanStart);\n                maxError = null;\n                maxErrorInd = null;\n                for (i = scanStart + 1; i < scanEnd; i++) {\n                    linearValue += linearDelta;\n                    if (filtered[i] === null) {\n                        continue;\n                    }\n                    error = Math.abs(filtered[i] - linearValue);\n                    if (error === null || error > maxError) {\n                        maxError = error;\n                        maxErrorInd = i;\n                    }\n                }\n                if (maxError > tolerance) {\n                    if (scanEnd > scanStart + 2) {\n                        queue.push([scanStart, maxErrorInd]);\n                        queue.push([maxErrorInd, scanEnd]);\n                    }\n                } else {\n                    filtered.splice(scanStart + 1, scanEnd - scanStart - 1);\n                }\n            }\n            return filtered;\n        },\n\n        calcProfileStats: function(values) {\n            const stats = {\n                distance: (values.length - 1) * this.options.samplingInterval\n            };\n            const notNullValues = values.filter((value) => value !== null);\n            if (notNullValues.length === 0) {\n                stats.noData = true;\n                return stats;\n            }\n            stats.min = Math.min(...notNullValues);\n            stats.max = Math.max(...notNullValues);\n            let firstNotNullIndex = true,\n                lastNotNullIndex = true,\n                firstNotNullValue,\n                lastNotNullValue;\n            for (let i = 0; i < values.length; i++) {\n                let value = values[i];\n                if (value !== null) {\n                    firstNotNullValue = value;\n                    firstNotNullIndex = i;\n                    break;\n                }\n            }\n            for (let i = values.length - 1; i >= 0; i--) {\n                let value = values[i];\n                if (value !== null) {\n                    lastNotNullValue = value;\n                    lastNotNullIndex = i;\n                    break;\n                }\n            }\n            stats.finalAscent = lastNotNullValue - firstNotNullValue;\n\n            const ascents = [],\n                descents = [];\n            let prevNotNullValue = values[firstNotNullIndex],\n                prevNotNullIndex = firstNotNullIndex;\n            for (let i = firstNotNullIndex + 1; i <= lastNotNullIndex; i++) {\n                let value = values[i];\n                if (value === null) {\n                    continue;\n                }\n                let length = i - prevNotNullIndex;\n                let gradient = (value - prevNotNullValue) / length;\n                if (gradient > 0) {\n                    for (let j = 0; j < length; j++) {\n                        ascents.push(gradient);\n                    }\n                } else if (gradient < 0) {\n                    for (let j = 0; j < length; j++) {\n                        descents.push(-gradient);\n                    }\n                }\n                prevNotNullIndex = i;\n                prevNotNullValue = value;\n            }\n            function sum(a, b) {\n                return a + b;\n            }\n            if (ascents.length !== 0) {\n                stats.gradientAvgAscent = ascents.reduce(sum, 0) / ascents.length / this.options.samplingInterval;\n                stats.gradientMinAscent = Math.min(...ascents) / this.options.samplingInterval;\n                stats.gradientMaxAscent = Math.max(...ascents) / this.options.samplingInterval;\n                stats.angleAvgAscent = gradientToAngle(stats.gradientAvgAscent);\n                stats.angleMinAscent = gradientToAngle(stats.gradientMinAscent);\n                stats.angleMaxAscent = gradientToAngle(stats.gradientMaxAscent);\n            }\n            if (descents.length !== 0) {\n                stats.gradientAvgDescent = descents.reduce(sum, 0) / descents.length / this.options.samplingInterval;\n                stats.gradientMinDescent = Math.min(...descents) / this.options.samplingInterval;\n                stats.gradientMaxDescent = Math.max(...descents) / this.options.samplingInterval;\n                stats.angleAvgDescent = gradientToAngle(stats.gradientAvgDescent);\n                stats.angleMinDescent = gradientToAngle(stats.gradientMinDescent);\n                stats.angleMaxDescent = gradientToAngle(stats.gradientMaxDescent);\n            }\n\n            stats.start = firstNotNullValue;\n            stats.end = lastNotNullValue;\n            stats.distance = (values.length - 1) * this.options.samplingInterval;\n            stats.dataLostAtStart = firstNotNullIndex / values.length;\n            stats.dataLostAtEnd = 1 - lastNotNullIndex / (values.length - 1);\n            stats.dataLost = 1 - notNullValues.length / values.length;\n\n            const filterTolerance = 5;\n            const filtered = this.filterElevations(values.slice(firstNotNullIndex, lastNotNullIndex), filterTolerance);\n            let ascent = 0,\n                descent = 0,\n                delta;\n            for (let i = 1; i < filtered.length; i++) {\n                delta = filtered[i] - filtered[i - 1];\n                if (delta < 0) {\n                    descent += -delta;\n                } else {\n                    ascent += delta;\n                }\n            }\n            stats.ascent = ascent;\n            stats.descent = descent;\n\n            return stats;\n        },\n\n        setCursorPosition: function(ind) {\n            if (!this._map || !this.values) {\n                return;\n            }\n            const samplingInterval = this.options.samplingInterval;\n            const distanceKm = samplingInterval * ind / 1000;\n            const distanceStr = `${distanceKm.toFixed(2)} km`;\n            const sample1 = this.values[Math.ceil(ind)];\n            const sample2 = this.values[Math.floor(ind)];\n            let angleStr;\n            if (sample1 !== null && sample2 !== null) {\n                const gradient = (sample2 - sample1) / samplingInterval;\n                angleStr = `${Math.round(Math.atan(gradient) * 180 / Math.PI)}&deg`;\n            } else {\n                angleStr = '-';\n            }\n\n            const x = Math.round(ind / (this.values.length - 1) * (this.svgWidth - 1));\n            const indInt = Math.round(ind);\n            let elevation = this.values[indInt];\n            if (elevation === null) {\n                elevation = sample1;\n            }\n            if (elevation === null) {\n                elevation = sample2;\n            }\n            const elevationStr = (elevation === null) ? '-' : `${elevation} m`;\n\n            const cursorLabel = `${elevationStr}<br>${distanceStr}<br>${angleStr}`;\n\n            this.graphCursorLabel.innerHTML = cursorLabel;\n\n            this.graphCursor.style.left = x + 'px';\n            this.graphCursorLabel.style.left = x + 'px';\n            if (this.drawingContainer.getBoundingClientRect().left - this.drawingContainer.scrollLeft + x +\n                this.graphCursorLabel.offsetWidth >= this.drawingContainer.getBoundingClientRect().right) {\n                L.DomUtil.addClass(this.graphCursorLabel, 'elevation-profile-cursor-label-left');\n            } else {\n                L.DomUtil.removeClass(this.graphCursorLabel, 'elevation-profile-cursor-label-left');\n            }\n\n            let markerPos;\n            if (ind <= 0) {\n                markerPos = this.samples[0];\n            } else if (ind >= this.samples.length - 1) {\n                markerPos = this.samples[this.samples.length - 1];\n            } else {\n                const p1 = this.samples[Math.floor(ind)],\n                    p2 = this.samples[Math.ceil(ind)],\n                    indFrac = ind - Math.floor(ind);\n                markerPos = [p1.lat + (p2.lat - p1.lat) * indFrac, p1.lng + (p2.lng - p1.lng) * indFrac];\n            }\n            this.trackMarker.setLatLng(markerPos);\n\n            this.setTrackMarkerLabel(cursorLabel);\n        },\n\n        onSvgMouseMove: function(e) {\n            if (!this.values) {\n                return;\n            }\n            this.setCursorPosition(this.sampleIndexFromMouseEvent(e));\n        },\n\n        cursorShow: function() {\n            L.DomUtil.removeClass(this.graphCursor, 'elevation-profile-cursor-hidden');\n            L.DomUtil.removeClass(this.graphCursorLabel, 'elevation-profile-cursor-hidden');\n            this._map.addLayer(this.trackMarker);\n        },\n\n        cursorHide: function() {\n            L.DomUtil.addClass(this.graphCursor, 'elevation-profile-cursor-hidden');\n            L.DomUtil.addClass(this.graphCursorLabel, 'elevation-profile-cursor-hidden');\n            this._map.removeLayer(this.trackMarker);\n        },\n\n        onSvgEnter: function() {\n            this.cursorShow();\n        },\n\n        onSvgLeave: function() {\n            this.cursorHide();\n        },\n\n        onLineMouseEnter: function() {\n            this.cursorShow();\n        },\n\n        onLineMouseLeave: function() {\n            this.cursorHide();\n        },\n\n        onLineMouseMove: function(e) {\n            function sqrDist(latlng1, latlng2) {\n                var dx = (latlng1.lng - latlng2.lng);\n                var dy = (latlng1.lat - latlng2.lat);\n                return dx * dx + dy * dy;\n            }\n\n            var nearestInd = null,\n                ind,\n                minDist = null,\n                mouseLatlng = e.latlng,\n                i, sampleLatlng, dist, di;\n            let nextDist,\n                nextSampleDist,\n                prevDist,\n                prevSampleDist;\n            for (i = 0; i < this.samples.length; i++) {\n                sampleLatlng = this.samples[i];\n                dist = sqrDist(sampleLatlng, mouseLatlng);\n                if (nearestInd === null || dist < minDist) {\n                    nearestInd = i;\n                    minDist = dist;\n                }\n            }\n\n            if (nearestInd !== null) {\n                ind = nearestInd;\n                if (nearestInd > 0) {\n                    prevDist = sqrDist(mouseLatlng, this.samples[nearestInd - 1]);\n                    prevSampleDist = sqrDist(this.samples[nearestInd], this.samples[nearestInd - 1]);\n                }\n                if (nearestInd < this.samples.length - 1) {\n                    nextDist = sqrDist(mouseLatlng, this.samples[nearestInd + 1]);\n                    nextSampleDist = sqrDist(this.samples[nearestInd], this.samples[nearestInd + 1]);\n                }\n\n                if (nearestInd === 0) {\n                    if (nextDist < minDist + nextSampleDist) {\n                        di = (minDist - nextDist) / 2 / nextSampleDist + 1 / 2;\n                    } else {\n                        di = 0.001;\n                    }\n                } else if (nearestInd === this.samples.length - 1) {\n                    if (prevDist < minDist + prevSampleDist) {\n                        di = -((minDist - prevDist) / 2 / prevSampleDist + 1 / 2);\n                    } else {\n                        di = -0.001;\n                    }\n                } else {\n                    if (prevDist < nextDist) {\n                        di = -((minDist - prevDist) / 2 / prevSampleDist + 1 / 2);\n                    } else {\n                        di = (minDist - nextDist) / 2 / nextSampleDist + 1 / 2;\n                    }\n                }\n                if (di < -1) {\n                    di = -1;\n                }\n                if (di > 1) {\n                    di = 1;\n                }\n                this.setCursorPosition(ind + di);\n            }\n        },\n\n        setupGraph: function() {\n            if (!this._map || !this.values) {\n                return;\n            }\n\n            while (this.svg.hasChildNodes()) {\n                this.svg.removeChild(this.svg.lastChild);\n            }\n            while (this.leftAxisLables.hasChildNodes()) {\n                this.leftAxisLables.removeChild(this.leftAxisLables.lastChild);\n            }\n\n            var maxValue = Math.max.apply(null, this.values),\n                minValue = Math.min.apply(null, this.values),\n                svg = this.svg,\n                path, i, horizStep, verticalMultiplier, x, y, gridValues, label;\n\n            var paddingBottom = 8 + 16,\n                paddingTop = 8;\n\n            gridValues = this.calcGridValues(minValue, maxValue);\n            var gridStep = (this.svgHeight - paddingBottom - paddingTop) / (gridValues.length - 1);\n            for (i = 0; i < gridValues.length; i++) {\n                y = Math.round(i * gridStep - 0.5) + 0.5 + paddingTop;\n                path = L.Util.template('M{x1} {y} L{x2} {y}', {x1: 0, x2: this.svgWidth * this.horizZoom, y: y});\n                createSvg(\n                    'path',\n                    {'d': path, 'stroke-width': '1px', 'stroke': 'green', 'fill': 'none', 'stroke-opacity': '0.5'},\n                    svg\n                );\n\n                label = L.DomUtil.create('div', 'elevation-profile-grid-label', this.leftAxisLables);\n                label.innerHTML = gridValues[gridValues.length - i - 1];\n                label.style.top = (gridStep * i + paddingTop) + 'px';\n            }\n\n            horizStep = this.svgWidth / (this.values.length - 1);\n            verticalMultiplier =\n                (this.svgHeight - paddingTop - paddingBottom) / (gridValues[gridValues.length - 1] - gridValues[0]);\n\n            path = [];\n            const valueToSvgCoord = (el) => {\n                const y = (el - gridValues[0]) * verticalMultiplier;\n                return this.svgHeight - y - paddingBottom;\n            };\n\n            let startNewSegment = true;\n            for (i = 0; i < this.values.length; i++) {\n                let value = this.values[i];\n                if (value === null) {\n                    startNewSegment = true;\n                    continue;\n                }\n                path.push(startNewSegment ? 'M' : 'L');\n                x = i * horizStep;\n                y = valueToSvgCoord(value);\n                path.push(x + ' ' + y + ' ');\n                startNewSegment = false;\n            }\n            path = path.join('');\n            createSvg('path', {'d': path, 'stroke-width': '1px', 'stroke': 'brown', 'fill': 'none'}, svg);\n            // sightline\n            if (this.options.sightLine) {\n                path = L.Util.template('M{x1} {y1} L{x2} {y2}', {\n                        x1: 0,\n                        x2: this.svgWidth * this.horizZoom,\n                        y1: valueToSvgCoord(this.values[0]),\n                        y2: valueToSvgCoord(this.values[this.values.length - 1])\n                    }\n                );\n                createSvg(\n                    'path',\n                    {'d': path, 'stroke-width': '3px', 'stroke': '#94b1ff', 'fill': 'none', 'stroke-opacity': '0.5'},\n                    svg\n                );\n            }\n        },\n\n        onCloseButtonClick: function() {\n            this.removeFrom(this._map);\n        }\n    }\n);\n\nexport {ElevationProfile, calcSamplingInterval};\n","import config from '~/config';\nimport {fetch} from '~/lib/xhr-promise';\n\nclass ElevationProvider {\n    chunkSize = 10000;\n\n    constructor(serverUrl = config.elevationsServer) {\n        this.url = serverUrl;\n    }\n\n    async get(latlngs) {\n        const result = [];\n        for (let i = 0; i < latlngs.length; i += this.chunkSize) {\n            const chunk = latlngs.slice(i, i + this.chunkSize);\n            const request = chunk.map((ll) => `${ll.lat.toFixed(6)} ${ll.lng.toFixed(6)}`).join('\\n');\n            const xhr = await fetch(this.url, {method: 'POST', data: request, withCredentials: true});\n            const respValues = xhr.responseText.split('\\n').map((line) => (line === 'NULL' ? null : parseFloat(line)));\n            result.push(...respValues);\n        }\n        return result;\n    }\n}\n\nexport {ElevationProvider};\n","import L from 'leaflet';\nimport './style.css';\n\nfunction enableTopRow(control) {\n    const originalOnAdd = control.onAdd;\n    if (control._topRowEnabled) {\n        return;\n    }\n\n    L.Util.extend(control, {\n        _topRowEnabled: true,\n\n        onAdd: function(map) {\n            const container = originalOnAdd.call(this, map);\n            setTimeout(() => this.__injectTopRow(), 0);\n            return container;\n        },\n\n        __injectTopRow: function() {\n            this._topRow = L.DomUtil.create('div', 'leaflet-control-layers-top-row');\n            this._section.parentNode.insertBefore(this._topRow, this._section);\n        }\n\n    });\n    if (control._map) {\n        control.__injectTopRow();\n    }\n}\n\nexport default enableTopRow;\n","import * as Sentry from '@sentry/browser';\nimport './index.css';\nimport * as App from './App';\nimport config from './config';\n\nfunction getUid() {\n    const cookie = document.cookie;\n    const cookieUid = cookie.match(/\\buid=([^;]+)/u)[1];\n    const uidRaw = atob(cookieUid);\n    const l = [];\n    for (let i = 0; i < uidRaw.length; i++) {\n        l.push(uidRaw.charCodeAt(i));\n    }\n    const l2 = [];\n    l2.push(...l.slice(0, 4).reverse());\n    l2.push(...l.slice(4, 8).reverse());\n    l2.push(...l.slice(8, 12).reverse());\n    l2.push(...l.slice(12).reverse());\n    const uid = l2.map((c) => (\"0\" + c.toString(16)).slice(-2)).join('').toUpperCase();\n    return uid;\n}\n\nfunction preconnect(url) {\n    const preconnectLink = document.createElement('link');\n    preconnectLink.rel = 'preconnect';\n    preconnectLink.href = url;\n    document.head.appendChild(preconnectLink);\n\n    const dnsPrefetchLink = document.createElement('link');\n    dnsPrefetchLink.rel = 'dns-prefetch';\n    dnsPrefetchLink.href = url;\n    document.head.appendChild(dnsPrefetchLink);\n}\n\npreconnect(config.elevationsServer);\npreconnect(config.CORSProxyUrl);\npreconnect(config.tracksStorageServer);\n\nif (NODE_ENV === 'production') {\n    Sentry.init({\n        dsn: config.sentryDSN,\n        release: RELEASE_VER\n    });\n}\n\nconsole.log('Version:', RELEASE_VER); // eslint-disable-line no-console\n\nlet uid;\ntry {\n    uid = getUid();\n} catch (e) {\n    // ignore error\n}\nconsole.log('UID:', uid); // eslint-disable-line no-console\n\nSentry.configureScope(function(scope) {\n    scope.setUser({id: uid});\n});\n\nApp.setUp();\n\n","// extracted by mini-css-extract-plugin\nexport {};","import './App.css';\nimport './leaflet-fixes.css';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport {MapWithSidebars} from '~/lib/leaflet.map.sidebars';\nimport '~/lib/leaflet.control.printPages/control';\nimport '~/lib/leaflet.control.caption';\nimport config from './config';\nimport '~/lib/leaflet.control.coordinates';\nimport enableLayersControlHotKeys from '~/lib/leaflet.control.layers.hotkeys';\nimport '~/lib/leaflet.hashState/Leaflet.Map';\nimport '~/lib/leaflet.hashState/Leaflet.Control.Layers';\nimport {fixAll} from '~/lib/leaflet.fixes';\nimport './adaptive.css';\nimport '~/lib/leaflet.control.panoramas';\nimport '~/lib/leaflet.control.track-list/track-list';\nimport '~/lib/leaflet.control.track-list/control-ruler';\nimport '~/lib/leaflet.control.track-list/track-list.hash-state';\nimport '~/lib/leaflet.control.track-list/track-list.localstorage';\nimport enableLayersMinimize from '~/lib/leaflet.control.layers.minimize';\nimport enableLayersConfig from '~/lib/leaflet.control.layers.configure';\nimport raiseControlsOnFocus from '~/lib/leaflet.controls.raise-on-focus';\nimport {getLayers} from './layers';\nimport '~/lib/leaflet.control.layers.events';\nimport '~/lib/leaflet.control.jnx';\nimport '~/lib/leaflet.control.jnx/hash-state';\nimport '~/lib/leaflet.control.azimuth';\nimport {hashState, bindHashStateReadOnly} from '~/lib/leaflet.hashState/hashState';\nimport {LocateControl} from '~/lib/leaflet.control.locate';\nimport {notify} from '~/lib/notifications';\nimport ZoomDisplay from '~/lib/leaflet.control.zoom-display';\nimport * as logging from '~/lib/logging';\nimport safeLocalStorage from '~/lib/safe-localstorage';\nimport '~/lib/leaflet.placemark';\n\nconst locationErrorMessage = {\n    0: '    .',\n    1: '    . ,    .',\n    2: '      .',\n};\n\nfunction setUp() {\n    const startInfo = {\n        href: window.location.href,\n        localStorageKeys: Object.keys(safeLocalStorage),\n        mobile: L.Browser.mobile,\n    };\n    fixAll();\n\n    const map = new MapWithSidebars('map', {\n            zoomControl: false,\n            fadeAnimation: false,\n            attributionControl: false,\n            inertiaMaxSpeed: 1500,\n            worldCopyJump: true,\n            maxZoom: 18\n        }\n    );\n\n    const tracklist = new L.Control.TrackList();\n\n    /* controls top-left corner */\n    //   \n    new L.Control.Caption(config.caption, {\n            position: 'bottomleft'\n        }\n    ).addTo(map);\n\n    new ZoomDisplay().addTo(map);\n\n    map.getPlacemarkHashStateInterface().enableHashState('r');\n\n    new L.Control.Coordinates({position: 'topleft'}).addTo(map);\n\n    const locateControl = new LocateControl({\n        position: 'topleft',\n        showError: function({code, message}) {\n            let customMessage = locationErrorMessage[code];\n            if (!customMessage) {\n                customMessage = `Geolocation error: ${message}`;\n            }\n            notify(customMessage);\n        }\n    }).addTo(map);\n\n    let {lat, lng, zoom, valid: validPositionInHash} = map.validateState(hashState.getState('m'));\n    locateControl.moveMapToCurrentLocation(config.defaultZoom, L.latLng(config.defaultLocation),\n        validPositionInHash ? L.latLng(lat, lng) : null, validPositionInHash ? zoom : null);\n    map.enableHashState('m');\n\n    /* controls top-right corner */\n\n    const layersControl = L.control.layers(null, null, {collapsed: false})\n        .addTo(map);\n    enableLayersControlHotKeys(layersControl);\n    enableLayersMinimize(layersControl);\n    enableLayersConfig(layersControl, getLayers());\n    layersControl.enableHashState('l');\n\n    /* controls bottom-left corner */\n\n    // ewfefwef\n\n    /* controls bottom-right corner */\n\n    function trackNames() {\n        return tracklist.tracks().map((track) => track.name());\n    }\n    tracklist.addTo(map);\n    const tracksHashParams = tracklist.hashParams();\n\n    let hasTrackParamsInHash = false;\n    for (let param of tracksHashParams) {\n        if (hashState.hasKey(param)) {\n            hasTrackParamsInHash = true;\n            break;\n        }\n    }\n    if (!hasTrackParamsInHash) {\n        tracklist.loadTracksFromStorage();\n    }\n    startInfo.tracksAfterLoadFromStorage = trackNames();\n\n    for (let param of tracksHashParams) {\n        bindHashStateReadOnly(param, tracklist.loadTrackFromParam.bind(tracklist, param));\n    }\n    startInfo.tracksAfterLoadFromHash = trackNames();\n\n    if (!validPositionInHash) {\n        tracklist.whenLoadDone(() => tracklist.setViewToAllTracks(true));\n    }\n\n    /* adaptive layout */\n\n    if (L.Browser.mobile) {\n        layersControl.setMinimized();\n        if (!tracklist.hasTracks()) {\n            tracklist.setMinimized();\n        }\n    }\n\n    if (L.Browser.mobile) {\n        map.on('mousedown dragstart', () => layersControl.setMinimized());\n    }\n\n    raiseControlsOnFocus(map);\n\n    /* save state at unload */\n\n    L.DomEvent.on(window, 'beforeunload', () => {\n        logging.logEvent('saveTracksToStorage begin', {\n            localStorageKeys: Object.keys(safeLocalStorage),\n            trackNames: trackNames(),\n        });\n        let localStorageKeys;\n        try {\n            tracklist.saveTracksToStorage();\n            localStorageKeys = Object.keys(safeLocalStorage); // eslint-disable-line\n        } catch (e) {\n            logging.logEvent('saveTracksToStorage failed', {error: e});\n            return; // eslint-disable-line\n        }\n    });\n}\n\nexport {setUp};\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\n\nimport './style.css';\nimport {onElementResize} from '~/lib/anyElementResizeEvent';\n\nconst MapWithSidebars = L.Map.extend({\n    initialize: function (id, options) {\n        this._sidebarsContainer = L.DomUtil.get(id);\n        this.setupSidebarsLayout(this._sidebarsContainer);\n        L.Map.prototype.initialize.call(this, this._mapContainer, options);\n        onElementResize(this._mapContainer, L.Util.requestAnimFrame.bind(null, this.invalidateSize.bind(this)));\n    },\n\n    setupSidebarsLayout: function (container) {\n        this._sidebarContainers = {};\n        const sidebars = this._sidebarContainers;\n        L.DomUtil.addClass(container, 'leaflet-map-sidebars-container');\n        sidebars['left'] = L.DomUtil.create('div', 'leaflet-map-sidebar-left', this._sidebarsContainer);\n        const midColumn = L.DomUtil.create('div', 'leaflet-map-sidebar-mid-column', this._sidebarsContainer);\n        sidebars['right'] = L.DomUtil.create('div', 'leaflet-map-sidebar-right', this._sidebarsContainer);\n        sidebars['top'] = L.DomUtil.create('div', 'leaflet-map-sidebar-top', midColumn);\n        this._mapContainer = L.DomUtil.create('div', 'leaflet-map-container-with-sidebars', midColumn);\n        sidebars['bottom'] = L.DomUtil.create('div', 'leaflet-map-sidebar-bottom', midColumn);\n    },\n\n    addElementToSidebar: function (barName, element) {\n        this._sidebarContainers[barName].appendChild(element);\n    },\n\n    removeElementFromSidebar: function (barName, element) {\n        this._sidebarContainers[barName].removeChild(element);\n    },\n});\n\nexport {MapWithSidebars};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport ko from 'knockout';\nimport '~/lib/knockout.component.progress/progress';\nimport '~/lib/controls-styles/controls-styles.css';\nimport './control.css';\nimport PageFeature from './pageFeature';\nimport Contextmenu from '~/lib/contextmenu';\nimport {renderPages} from './map-render';\nimport formHtml from './form.html';\nimport {notify} from '~/lib/notifications';\nimport {makePdf} from './pdf';\nimport {saveAs} from '~/vendored/github.com/eligrey/FileSaver';\nimport {blobFromString} from '~/lib/binary-strings';\nimport '~/lib/leaflet.hashState/leaflet.hashState';\nimport '~/lib/leaflet.control.commons';\nimport * as logging from '~/lib/logging';\nimport {MagneticMeridians} from './decoration.magnetic-meridians';\nimport {OverlayScale} from './decoration.scale';\nimport {Grid} from './decoration.grid';\n\nko.extenders.checkNumberRange = function(target, range) {\n    return ko.pureComputed({\n            read: target,  // always return the original observables value\n            write: function(newValue) {\n                newValue = parseFloat(newValue);\n                if (newValue >= range[0] && newValue <= range[1]) {\n                    target(newValue);\n                } else {\n                    target.notifySubscribers(target());\n                }\n            }\n        }\n    ).extend({notify: 'always'});\n};\n\nfunction savePagesPdf(imagesInfo, resolution, fileName) {\n    let pdf = makePdf(imagesInfo, resolution);\n    pdf = blobFromString(pdf);\n    saveAs(pdf, fileName, true);\n}\n\nfunction savePageJpg(page, fileName) {\n    saveAs(blobFromString(page.data), fileName, true);\n}\n\nL.Control.PrintPages = L.Control.extend({\n        options: {\n            position: 'bottomleft',\n            defaultMargin: 7,\n        },\n\n        includes: [L.Evented, L.Mixin.HashState],\n\n        stateChangeEvents: ['change'],\n\n        pageSizes: [\n            {name: 'A1', width: 594, height: 841},\n            {name: 'A2', width: 420, height: 594},\n            {name: 'A3', width: 297, height: 420},\n            {name: 'A4', width: 210, height: 297},\n            {name: 'A5', width: 148, height: 210}\n        ],\n\n        zoomLevels: ['auto', 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18],\n\n        initialize: function(options) {\n            L.Control.prototype.initialize.call(this, options);\n            this.pages = [];\n            this.scale = ko.observable(500).extend({checkNumberRange: [1, 1000000]});\n            this.resolution = ko.observable(300).extend({checkNumberRange: [10, 9999]});\n            this.zoomLevel = ko.observable('auto');\n            this.pageWidth = ko.observable(210).extend({checkNumberRange: [10, 9999]});\n            this.pageHeight = ko.observable(297).extend({checkNumberRange: [10, 9999]});\n            this.settingsExpanded = ko.observable(false);\n            this.makingPdf = ko.observable(false);\n            this.downloadProgressRange = ko.observable();\n            this.downloadProgressDone = ko.observable();\n            this.marginLeft = ko.observable(this.options.defaultMargin).extend({checkNumberRange: [0, 99]});\n            this.marginRight = ko.observable(this.options.defaultMargin).extend({checkNumberRange: [0, 99]});\n            this.marginTop = ko.observable(this.options.defaultMargin).extend({checkNumberRange: [0, 99]});\n            this.marginBottom = ko.observable(this.options.defaultMargin).extend({checkNumberRange: [0, 99]});\n            this.autoZoomLevels = ko.observable({});\n            this.printSize = ko.pureComputed(this._printSize, this);\n            this.printSize.subscribe(this.onPageSizeChanged, this);\n            this.scale.subscribe(this.onPageSizeChanged, this);\n            this.resolution.subscribe(this.onPageSizeChanged, this);\n            this.pageSizeDescription = ko.pureComputed(this._displayPageSize, this);\n            this.pagesNum = ko.observable(0);\n            this.pagesNumLabel = ko.pureComputed(this._pagesNumLabel, this);\n            this.gridOn = ko.observable(false);\n            this.magneticMeridiansOn = ko.observable(false);\n\n            // hash state notifications\n            this.scale.subscribe(this.notifyChange, this);\n            this.printSize.subscribe(this.notifyChange, this);\n            this.resolution.subscribe(this.notifyChange, this);\n            this.zoomLevel.subscribe(this.notifyChange, this);\n            this.gridOn.subscribe(this.notifyChange, this);\n            this.magneticMeridiansOn.subscribe(this.notifyChange, this);\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            const container = this._container =\n                L.DomUtil.create('div', 'leaflet-control control-form control-print-pages');\n            this._stopContainerEvents();\n\n            map.on('move', this.updateFormZooms, this);\n            container.innerHTML = formHtml;\n            ko.applyBindings(this, container);\n            this.updateFormZooms();\n            return container;\n        },\n\n        setExpanded: function() {\n            L.DomUtil.removeClass(this._container, 'minimized');\n        },\n\n        setMinimized: function() {\n            L.DomUtil.addClass(this._container, 'minimized');\n        },\n\n        addPage: function(isLandscape, center) {\n            let [pageWidth, pageHeight] = this.printSize();\n            if (isLandscape) {\n                [pageWidth, pageHeight] = [pageHeight, pageWidth];\n            }\n            if (!center) {\n                center = this._map.getCenter();\n            }\n            const page = new PageFeature(center, [pageWidth, pageHeight],\n                this.scale(), (this.pages.length + 1).toString()\n            );\n            page._rotated = isLandscape;\n            page.addTo(this._map);\n            this.pages.push(page);\n            this.pagesNum(this.pages.length);\n            let cm = new Contextmenu(this.makePageContexmenuItems.bind(this, page));\n            page.on('contextmenu', cm.show, cm);\n            page.on('click', this.rotatePage.bind(this, page));\n            page.on('move', this.updateFormZooms, this);\n            page.on('moveend', this.notifyChange, this);\n            this.updateFormZooms();\n            this.notifyChange();\n            return page;\n        },\n\n        addLandscapePage: function() {\n            this.addPage(true);\n        },\n\n        addPortraitPage: function() {\n            this.addPage(false);\n        },\n\n        removePage: function(page) {\n            let i = this.pages.indexOf(page);\n            this.pages.splice(i, 1);\n            this.pagesNum(this.pages.length);\n            this._map.removeLayer(page);\n            for (; i < this.pages.length; i++) {\n                this.pages[i].setLabel((i + 1).toString());\n            }\n            this.notifyChange();\n            this.updateFormZooms();\n        },\n\n        removePages: function() {\n            this.pages.forEach((page) => page.removeFrom(this._map));\n            this.pages = [];\n            this.pagesNum(this.pages.length);\n            this.notifyChange();\n            this.updateFormZooms();\n        },\n\n        onSavePdfClicked: function() {\n            if (!this.pages.length) {\n                notify('Add some pages to print');\n                return;\n            }\n            this.savePdf();\n        },\n\n        zoomForPrint: function() {\n            let zoom = this.zoomLevel();\n            if (zoom === 'auto') {\n                zoom = this.suggestZooms();\n            } else {\n                zoom = {mapZoom: zoom, satZoom: zoom};\n            }\n            return zoom;\n        },\n\n        incrementProgress: function(inc, range) {\n            this.downloadProgressRange(range);\n            this.downloadProgressDone((this.downloadProgressDone() || 0) + inc);\n        },\n\n        savePdf: function() {\n            logging.captureBreadcrumb('start save pdf');\n            if (!this._map) {\n                return;\n            }\n            this.downloadProgressRange(1000);\n            this.downloadProgressDone(undefined);\n            this.makingPdf(true);\n            const pages = this.pages.map((page) => ({\n                        latLngBounds: page.getLatLngBounds(),\n                        printSize: page.getPrintSize(),\n                        label: page.getLabel()\n            }));\n            const resolution = this.resolution();\n            const decorationLayers = [];\n            if (this.gridOn()) {\n                decorationLayers.push(new Grid());\n            }\n            if (this.magneticMeridiansOn()) {\n                decorationLayers.push(new MagneticMeridians());\n            }\n            decorationLayers.push(new OverlayScale());\n            const scale = this.scale();\n            const width = this.pageWidth();\n            const height = this.pageHeight();\n            const eventId = logging.randId();\n            const zooms = this.zoomForPrint();\n            this.fire('mapRenderStart', {\n                action: 'pdf',\n                eventId,\n                scale,\n                resolution,\n                pages,\n                zooms\n            });\n            renderPages({\n                    map: this._map,\n                    pages,\n                    zooms,\n                    resolution,\n                    scale,\n                    decorationLayers,\n                    progressCallback: this.incrementProgress.bind(this)\n                }\n            ).then(({images, renderedLayers}) => {\n                    if (images) {\n                        const fileName = this.getFileName({\n                            renderedLayers,\n                            scale,\n                            width,\n                            height,\n                            extension: 'pdf'\n                        });\n                        savePagesPdf(images, resolution, fileName);\n                        this.fire('mapRenderEnd', {eventId, success: true});\n                    }\n                }\n            ).catch((e) => {\n                    logging.captureException(e, 'raster creation failed');\n                    this.fire('mapRenderEnd', {eventId, success: false, error: e});\n                    notify(`Failed to create PDF: ${e.message}`);\n                }\n            ).then(() => this.makingPdf(false));\n        },\n\n        savePageJpg: function(page) {\n            logging.captureBreadcrumb('start save page jpg', {pageNumber: page.getLabel()});\n            const pages = [{\n                latLngBounds: page.getLatLngBounds(),\n                printSize: page.getPrintSize(),\n                label: page.getLabel()\n            }];\n            const decorationLayers = [];\n            if (this.gridOn()) {\n                decorationLayers.push(new Grid());\n            }\n            if (this.magneticMeridiansOn()) {\n                decorationLayers.push(new MagneticMeridians());\n            }\n            decorationLayers.push(new OverlayScale());\n            this.downloadProgressRange(1000);\n            this.downloadProgressDone(undefined);\n            this.makingPdf(true);\n            const resolution = this.resolution();\n            const scale = this.scale();\n            const width = this.pageWidth();\n            const height = this.pageHeight();\n            const eventId = logging.randId();\n            const zooms = this.zoomForPrint();\n            this.fire('mapRenderStart', {\n                action: 'jpg',\n                eventId,\n                scale,\n                resolution,\n                pages,\n                zooms\n            });\n            renderPages({\n                    map: this._map,\n                    pages,\n                    zooms,\n                    resolution,\n                    scale,\n                    decorationLayers,\n                    progressCallback: this.incrementProgress.bind(this)\n                }\n            )\n                .then(({images, renderedLayers}) => {\n                    const fileName = this.getFileName({\n                        renderedLayers,\n                        scale,\n                        width,\n                        height,\n                        extension: 'jpg'\n                    });\n                    savePageJpg(images[0], fileName);\n                    this.fire('mapRenderEnd', {eventId, success: true});\n                })\n                .catch((e) => {\n                        logging.captureException(e, 'raster creation failed');\n                        this.fire('mapRenderEnd', {eventId, success: false, error: e});\n                        notify(`Failed to create JPEG from page: ${e.message}`);\n                    }\n                ).then(() => this.makingPdf(false));\n        },\n\n        onPageSizeChanged: function() {\n            let [pageWidth, pageHeight] = this.printSize();\n            this.pages.forEach((page) => {\n                    let [w, h] = [pageWidth, pageHeight];\n                    if (page._rotated) {\n                        [w, h] = [h, w];\n                    }\n                    page.setSize([w, h], this.scale());\n                }\n            );\n            this.updateFormZooms();\n        },\n\n        onPagesNumLabelClick: function() {\n            if (this.pages.length > 0) {\n                const bounds = L.latLngBounds([]);\n                for (let page of this.pages) {\n                    bounds.extend(page.latLngBounds);\n                }\n                this._map.fitBounds(bounds.pad(0.2));\n            }\n        },\n\n        makePageContexmenuItems: function(page) {\n            const items = [\n                {text: 'Rotate', callback: this.rotatePage.bind(this, page)},\n                '-',\n                {text: 'Delete', callback: this.removePage.bind(this, page)},\n                '-',\n                {text: 'Save image', callback: this.savePageJpg.bind(this, page), disabled: this.makingPdf()}\n            ];\n            if (this.pages.length > 1) {\n                items.push({text: 'Change order', separator: true});\n                this.pages.forEach((p, i) => {\n                        if (p !== page) {\n                            items.push({\n                                    text: (i + 1).toString(),\n                                    callback: this.renumberPage.bind(this, page, i)\n                                }\n                            );\n                        }\n                    }\n                );\n            }\n            return items;\n        },\n\n        rotatePage: function(page) {\n            page._rotated = !page._rotated;\n            page.rotate();\n            this.notifyChange();\n        },\n\n        renumberPage: function(page, newIndex) {\n            const oldIndex = this.pages.indexOf(page);\n            this.pages.splice(oldIndex, 1);\n            this.pages.splice(newIndex, 0, page);\n            for (let i = Math.min(oldIndex, newIndex); i < this.pages.length; i++) {\n                this.pages[i].setLabel((i + 1).toString());\n            }\n            this.notifyChange();\n        },\n\n        _printSize: function() {\n            return [this.pageWidth() - this.marginLeft() - this.marginRight(),\n                this.pageHeight() - this.marginTop() - this.marginBottom()];\n        },\n\n        suggestZooms: function() {\n            const scale = this.scale(),\n                resolution = this.resolution();\n            let referenceLat;\n            if (this.pages.length > 0) {\n                let absLats = this.pages.map((page) => Math.abs(page.getLatLngBounds().getCenter().lat));\n                referenceLat = Math.min(...absLats);\n            } else {\n                if (!this._map) {\n                    return [null, null];\n                }\n                referenceLat = this._map.getCenter().lat;\n            }\n            let targetMetersPerPixel = scale / (resolution / 2.54);\n            let mapUnitsPerPixel = targetMetersPerPixel / Math.cos(referenceLat * Math.PI / 180);\n            let satZoom = Math.ceil(Math.log(40075016.4 / 256 / mapUnitsPerPixel) / Math.LN2);\n\n            targetMetersPerPixel = scale / (90 / 2.54) / 1.5;\n            mapUnitsPerPixel = targetMetersPerPixel / Math.cos(referenceLat * Math.PI / 180);\n            let mapZoom = Math.round(Math.log(40075016.4 / 256 / mapUnitsPerPixel) / Math.LN2);\n            mapZoom = Math.min(mapZoom, 18);\n            satZoom = Math.min(satZoom, 18);\n            mapZoom = Math.max(mapZoom, 0);\n            satZoom = Math.max(satZoom, 0);\n            return {mapZoom, satZoom};\n        },\n\n        updateFormZooms: function() {\n            this.autoZoomLevels(this.suggestZooms());\n        },\n\n        _displayPageSize: function() {\n            const width = this.pageWidth(),\n                height = this.pageHeight();\n            for (let size of this.pageSizes) {\n                if (size.width === width && size.height === height) {\n                    return size.name;\n                }\n            }\n            return `${width} x ${height} mm`;\n        },\n\n        notifyChange: function() {\n            this.fire('change');\n        },\n\n        hasPages: function() {\n            return this.pages.length > 0;\n        },\n\n        _pagesNumLabel: function() {\n            const n = this.pagesNum();\n            let label = '';\n            if (n) {\n                label += n;\n            } else {\n                label = 'No';\n            }\n            label += ' page';\n            if (n === 0 || n > 1) {\n                label += 's';\n            }\n            return label;\n        },\n\n        serializeState: function() {\n            const pages = this.pages;\n            let state = null;\n            if (pages.length) {\n                state = [];\n                state.push(this.scale().toString());\n                state.push(this.resolution().toString());\n                state.push(this.zoomLevel().toString());\n                state.push(this.pageWidth().toString());\n                state.push(this.pageHeight().toString());\n                state.push(this.marginLeft().toString());\n                state.push(this.marginRight().toString());\n                state.push(this.marginTop().toString());\n                state.push(this.marginBottom().toString());\n                for (let page of pages) {\n                    let latLng = page.getLatLng().wrap();\n                    state.push(latLng.lat.toFixed(5));\n                    state.push(latLng.lng.toFixed(5));\n                    state.push(page._rotated ? '1' : '0');\n                }\n                let flags =\n                    (this.magneticMeridiansOn() ? 1 : 0) |\n                    (this.gridOn() ? 2 : 0);\n                state.push(flags.toString());\n            }\n            return state;\n        },\n\n        unserializeState: function(state) {\n            if (!state || !state.length) {\n                return false;\n            }\n            this.removePages();\n            state = [...state];\n            this.scale(state.shift());\n            this.resolution(state.shift());\n            this.zoomLevel(state.shift());\n            this.pageWidth(state.shift());\n            this.pageHeight(state.shift());\n            this.marginLeft(state.shift());\n            this.marginRight(state.shift());\n            this.marginTop(state.shift());\n            this.marginBottom(state.shift());\n            let lat, lng, rotated;\n            while (state.length >= 3) {\n                lat = parseFloat(state.shift());\n                lng = parseFloat(state.shift());\n                rotated = parseInt(state.shift(), 10);\n                if (isNaN(lat) || isNaN(lng) || lat < -85 || lat > 85 || lng < -180 || lng > 180) {\n                    break;\n                }\n                this.addPage(Boolean(rotated), L.latLng(lat, lng));\n            }\n            if (state.length) {\n                const flags = parseInt(state.shift(), 10);\n                if (flags >= 0 && flags <= 3) {\n                    this.magneticMeridiansOn(Boolean(flags & 1));\n                    this.gridOn(Boolean(flags & 2));\n                }\n            }\n            return true;\n        },\n\n        getFileName: function({renderedLayers, scale, width, height, extension}) {\n            let fileName = '';\n\n            let opaqueLayer;\n            const transparentOverlayLayers = [];\n\n            renderedLayers.forEach((layer) => {\n                const {\n                    options: {\n                        isOverlay,\n                        isOverlayTransparent,\n                        shortName\n                    }\n                } = layer;\n\n                if (!shortName) {\n                    return;\n                }\n\n                if (isOverlay) {\n                    if (isOverlayTransparent) {\n                        transparentOverlayLayers.push(layer);\n                    } else {\n                        opaqueLayer = layer;\n                    }\n                } else if (!opaqueLayer) {\n                    opaqueLayer = layer;\n                }\n            });\n\n            function appendLayerShortName(layer) {\n                fileName += `${layer.options.shortName}_`;\n            }\n            if (opaqueLayer) {\n                appendLayerShortName(opaqueLayer);\n            }\n            transparentOverlayLayers.forEach(appendLayerShortName);\n\n            fileName += `${scale}m`;\n\n            const currentPageSize = this.pageSizes.find(\n                (pageSize) => width === pageSize.width && height === pageSize.height\n            );\n\n            if (currentPageSize) {\n                fileName += `_${currentPageSize.name}`;\n            }\n\n            return `${fileName}.${extension}`;\n        }\n    }\n);\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport './page-feature.css';\n\nconst PageFeature = L.Marker.extend({\n        initialize: function(centerLatLng, paperSize, scale, label) {\n            this.paperSize = paperSize;\n            this.scale = scale;\n            var icon = L.divIcon({className: \"print-page-marker\", html: label});\n            L.Marker.prototype.initialize.call(this, centerLatLng, {\n                    icon: icon,\n                    draggable: true,\n                    title: 'Left click to rotate, right click for menu'\n                }\n            );\n            this.on('drag', this.updateView.bind(this, undefined));\n        },\n\n        onAdd: function(map) {\n            L.Marker.prototype.onAdd.call(this, map);\n            map.on('viewreset', () => this.updateView());\n            this.rectangle = L.rectangle([[0, 0], [0, 0]],\n                {color: '#ff7800', weight: 2, opacity: 0.7, fillOpacity: 0.2}\n            ).addTo(map);\n            this.updateView();\n        },\n\n        onRemove: function(map) {\n            map.off('viewreset', this.updateView, this);\n            L.Marker.prototype.onRemove.call(this, map);\n            this.rectangle.removeFrom(map);\n        },\n\n        getLatLngBounds: function() {\n            return this.latLngBounds;\n        },\n\n        _getLatLngBounds: function() {\n            const centerLatLng = this.getLatLng();\n            const centerMerc = L.Projection.SphericalMercator.project(centerLatLng);\n            const mercatorScale =\n                (Math.cos((centerLatLng.lat * Math.PI) / 180) * L.CRS.Earth.R) / L.Projection.SphericalMercator.R;\n            const mercatorPageSize = L.point(...this.paperSize).multiplyBy(this.scale / 10 / mercatorScale);\n            let sw = centerMerc.subtract(mercatorPageSize.divideBy(2));\n            let ne = centerMerc.add(mercatorPageSize.divideBy(2));\n            sw = L.Projection.SphericalMercator.unproject(sw);\n            ne = L.Projection.SphericalMercator.unproject(ne);\n            return L.latLngBounds([sw, ne]);\n        },\n\n        _animateZoom: function(e) {\n            L.Marker.prototype._animateZoom.call(this, e);\n            this.updateView(e.zoom);\n        },\n\n        updateView: function(newZoom) {\n            if (!this._map) {\n                return;\n            }\n            if (newZoom === undefined) {\n                newZoom = this._map.getZoom();\n            }\n            var bounds = this.latLngBounds = this._getLatLngBounds();\n            var pixel_sw = this._map.project(bounds.getSouthWest(), newZoom);\n            var pixel_ne = this._map.project(bounds.getNorthEast(), newZoom);\n            var pixel_center = this._map.project(this.getLatLng(), newZoom);\n            var st = this._icon.style;\n            var pixel_width = pixel_ne.x - pixel_sw.x;\n            var pixel_height = pixel_sw.y - pixel_ne.y;\n            st.width = `${pixel_width}px`;\n            st.height = `${pixel_height}px`;\n            st.marginLeft = `${pixel_sw.x - pixel_center.x}px`;\n            st.marginTop = `${pixel_ne.y - pixel_center.y}px`;\n            st.fontSize = `${Math.min(pixel_width, pixel_height, 500) / 2}px`;\n            st.lineHeight = `${pixel_height}px`;\n            this.rectangle.setBounds(bounds);\n        },\n\n        setLabel: function(s) {\n            this._icon.innerHTML = s;\n        },\n\n        getLabel: function() {\n            return this._icon.innerHTML;\n        },\n\n        setSize: function(paperSize, scale) {\n            this.paperSize = paperSize;\n            this.scale = scale;\n            this.updateView();\n        },\n\n        getPrintSize: function() {\n            return L.point(...this.paperSize);\n        },\n\n        rotate: function() {\n            this.paperSize = [this.paperSize[1], this.paperSize[0]];\n            this.updateView();\n        }\n\n    }\n);\n\nexport default PageFeature;\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {getTempMap, disposeMap} from '~/lib/leaflet.layer.rasterize';\nimport {XHRQueue} from '~/lib/xhr-promise';\n\nfunction getLayersForPrint(map, xhrQueue) {\n    function getZIndex(el) {\n        return parseInt(window.getComputedStyle(el).zIndex, 10) || 0;\n    }\n\n    function compare(i1, i2) {\n        if (i1 < i2) {\n            return -1;\n        } else if (i1 > i2) {\n            return 1;\n        }\n        return 0;\n    }\n\n    function getLayerZOrder(layer) {\n        let el = layer._container || layer._path;\n        if (!el) {\n            throw new TypeError('Unsupported layer type');\n        }\n        const order = [];\n        while (el !== layer._map._container) {\n            order.push(getZIndex(el));\n            el = el.parentNode;\n        }\n        return order.reverse();\n    }\n\n    function compareArrays(ar1, ar2) {\n        const len = Math.min(ar1.length, ar2.length);\n        for (let i = 0; i < len; i++) {\n            let c = compare(ar1[i], ar2[i]);\n            if (c) {\n                return c;\n            }\n        }\n        return compare(ar1.length, ar2.length);\n    }\n\n    function compareLayersOrder(layer1, layer2) {\n        return compareArrays(getLayerZOrder(layer1), getLayerZOrder(layer2));\n    }\n\n    let layers = [];\n    map.eachLayer((layer) => {\n            if (layer.options.print) {\n                layers.push(layer);\n            } else {\n                if (layer.meta && layer.options.isOverlay === false) {\n                    throw new Error(`Print disabled for layer ${layer.meta.title}`);\n                }\n            }\n        }\n    );\n    layers.sort(compareLayersOrder);\n    layers = layers.map((l) => l.cloneForPrint({xhrQueue}));\n    return layers;\n}\n\nfunction blendMultiplyCanvas(src, dest) {\n    if (src.width !== dest.width || src.height !== dest.height) {\n        throw new Error('Canvas size mismatch');\n    }\n    var s_data = src.getContext('2d').getImageData(0, 0, src.width, src.height).data;\n    src.width = 0;\n    src.height = 0;\n    var d_image_data = dest.getContext('2d').getImageData(0, 0, dest.width, dest.height);\n    var d_data = d_image_data.data;\n    var data_length = s_data.length,\n        sr, sg, sb, sa, sa1,\n        dr, dg, db,\n        l;\n    for (var i = 0; i < data_length; i += 4) {\n        sa = s_data[i + 3] / 255;\n        if (sa) {\n            sr = s_data[i];\n            sg = s_data[i + 1];\n            sb = s_data[i + 2];\n            dr = d_data[i];\n            dg = d_data[i + 1];\n            db = d_data[i + 2];\n\n            l = (dr + dg + db) / 3;\n            l = l / 255 * 0.5 + 0.5;\n            sa1 = 1 - sa;\n            dr = sr * l * sa + sa1 * dr;\n            dg = sg * l * sa + sa1 * dg;\n            db = sb * l * sa + sa1 * db;\n\n            d_data[i] = dr;\n            d_data[i + 1] = dg;\n            d_data[i + 2] = db;\n        }\n    }\n    s_data = null;\n    dest.getContext('2d').putImageData(d_image_data, 0, 0);\n}\n\nclass PageComposer {\n    constructor(destSize, pixelBoundsAtZoom24) {\n        this.destSize = destSize;\n        this.projectedBounds = pixelBoundsAtZoom24;\n        this.currentCanvas = null;\n        this.currentZoom = null;\n        this.currentTileScale = null;\n        this.targetCanvas = this.createCanvas(destSize);\n    }\n\n    createCanvas(size) {\n        const canvas = L.DomUtil.create('canvas');\n        canvas.width = size.x;\n        canvas.height = size.y;\n        return canvas;\n    }\n\n    putTile(tileInfo) {\n        if (!tileInfo.isOverlay && !tileInfo.image) {\n            return;\n        }\n        let zoom;\n        if (tileInfo.isOverlay) {\n            zoom = tileInfo.overlaySolid ? 'solidOverlay' : 'overlay';\n        } else {\n            zoom = tileInfo.zoom;\n        }\n        if (zoom !== this.currentZoom || tileInfo.tileScale !== this.currentTileScale) {\n            this.mergeCurrentCanvas();\n            this.setupCurrentCanvas(zoom, tileInfo.tileScale);\n        }\n        if (tileInfo.isOverlay) {\n            tileInfo.draw(this.currentCanvas);\n        } else {\n            const ctx = this.currentCanvas.getContext('2d');\n            const {tilePos, tileSize} = tileInfo;\n            ctx.drawImage(\n                tileInfo.image,\n                tilePos.x * tileInfo.tileScale,\n                tilePos.y * tileInfo.tileScale,\n                tileSize.x * tileInfo.tileScale,\n                tileSize.y * tileInfo.tileScale\n            );\n        }\n    }\n\n    setupCurrentCanvas(zoom, tileScale) {\n        let size;\n        if (zoom === 'overlay' || zoom === 'solidOverlay') {\n            size = this.destSize;\n        } else {\n            const q = 1 << (24 - zoom);\n            const\n                topLeft = this.projectedBounds.min.divideBy(q).round(),\n                bottomRight = this.projectedBounds.max.divideBy(q).round();\n            size = bottomRight.subtract(topLeft).multiplyBy(tileScale);\n        }\n        this.currentCanvas = this.createCanvas(size);\n        this.currentZoom = zoom;\n        this.currentTileScale = tileScale;\n    }\n\n    mergeCurrentCanvas() {\n        if (!this.currentCanvas) {\n            return;\n        }\n        if (this.currentZoom === 'overlay') {\n            blendMultiplyCanvas(this.currentCanvas, this.targetCanvas);\n        } else {\n            this.targetCanvas.getContext('2d').drawImage(this.currentCanvas, 0, 0,\n                this.destSize.x, this.destSize.y\n            );\n        }\n        this.currentCanvas.width = 0;\n        this.currentCanvas.height = 0;\n        this.currentCanvas = null;\n    }\n\n    getDataUrl() {\n        this.mergeCurrentCanvas();\n        const dataUrl = this.targetCanvas.toDataURL(\"image/jpeg\");\n        this.targetCanvas.width = 0;\n        this.targetCanvas.height = 0;\n        this.targetCanvas = null;\n        return dataUrl;\n    }\n}\n\nasync function* iterateLayersTiles(\n    layers,\n    latLngBounds,\n    destPixelSize,\n    resolution,\n    scale,\n    zooms,\n    pageLabel,\n    pagesCount\n) {\n    const defaultXHROptions = {\n        responseType: 'blob',\n        timeout: 20000,\n        isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 404\n    };\n    let doStop;\n    for (let layer of layers) {\n        let zoom;\n        if (layer.options && layer.options.scaleDependent) {\n            zoom = zooms.mapZoom;\n        } else {\n            zoom = zooms.satZoom;\n        }\n        let pixelBounds = L.bounds(\n            L.CRS.EPSG3857.latLngToPoint(latLngBounds.getNorthWest(), zoom).round(),\n            L.CRS.EPSG3857.latLngToPoint(latLngBounds.getSouthEast(), zoom).round()\n        );\n        let map;\n        if (!layer._layerDummy) {\n            map = getTempMap(zoom, layer._rasterizeNeedsFullSizeMap, pixelBounds);\n            map.addLayer(layer);\n        }\n        let {iterateTilePromises, count, tileScale = 1} = await layer.getTilesInfo({\n                xhrOptions: defaultXHROptions,\n                pixelBounds,\n                latLngBounds,\n                destPixelSize,\n                resolution,\n                scale,\n                zoom,\n                pageLabel,\n                pagesCount\n            }\n        );\n        let layerPromises = [];\n        for (let tilePromise of iterateTilePromises()) {\n            layerPromises.push(tilePromise.tilePromise);\n            let progressInc = (layer._printProgressWeight || 1) / count;\n            tilePromise.tilePromise = tilePromise.tilePromise.then((tileInfo) => ({\n                zoom,\n                progressInc,\n                layer,\n                tileScale,\n                ...tileInfo,\n            }));\n            doStop = yield tilePromise;\n            if (doStop) {\n                tilePromise.abortLoading();\n                break;\n            }\n        }\n        if (!layer._layerDummy) {\n            if (doStop) {\n                disposeMap(map);\n                break;\n            } else {\n                Promise.all(layerPromises).then(() => disposeMap(map));\n            }\n        }\n    }\n}\n\nasync function* promiseQueueBuffer(source, maxActive) {\n    const queue = [];\n    while (queue.length < maxActive) {\n        let {value, done} = await source.next();\n        if (done) {\n            break;\n        }\n        queue.push(value);\n    }\n\n    while (queue.length) {\n        let doStop = yield queue.shift();\n        if (doStop) {\n            let {value, done} = await source.next(true);\n            if (!done) {\n                queue.push(value);\n            }\n            for (let {abortLoading} of queue) {\n                abortLoading();\n            }\n\n            return;\n        }\n        let {value, done} = await source.next();\n        if (!done) {\n            queue.push(value);\n        }\n    }\n}\n\nasync function renderPages({map, pages, zooms, resolution, scale, progressCallback, decorationLayers}) {\n    const xhrQueue = new XHRQueue();\n    const layers = getLayersForPrint(map, xhrQueue);\n    layers.push(...decorationLayers);\n    let progressRange = 0;\n    for (let layer of layers) {\n        progressRange += layer._printProgressWeight || 1;\n    }\n    progressRange *= pages.length;\n    const pageImagesInfo = [];\n    const renderedLayers = new Set();\n    for (let page of pages) {\n        let destPixelSize = page.printSize.multiplyBy(resolution / 25.4).round();\n        let pixelBounds = L.bounds(\n            map.project(page.latLngBounds.getNorthWest(), 24).round(),\n            map.project(page.latLngBounds.getSouthEast(), 24).round()\n        );\n\n        const composer = new PageComposer(destPixelSize, pixelBounds);\n        let tilesIterator = await iterateLayersTiles(layers, page.latLngBounds, destPixelSize, resolution, scale, zooms,\n            page.label, pages.length);\n        let queuedTilesIterator = promiseQueueBuffer(tilesIterator, 20);\n        while (true) {\n            let {value: tilePromise, done} = await queuedTilesIterator.next();\n            if (done) {\n                break;\n            }\n            let tileInfo;\n            try {\n                tileInfo = await tilePromise.tilePromise;\n            } catch (e) {\n                queuedTilesIterator.next(true);\n                throw e;\n            }\n            progressCallback(tileInfo.progressInc, progressRange);\n            composer.putTile(tileInfo);\n            const {image, draw, layer} = tileInfo;\n            if ((image || draw) && !layer._layerDummy) {\n                renderedLayers.add(layer);\n            }\n        }\n        const dataUrl = composer.getDataUrl();\n        let data = dataUrl.substring(dataUrl.indexOf(',') + 1);\n        data = atob(data);\n        pageImagesInfo.push({\n                data,\n                width: destPixelSize.x,\n                height: destPixelSize.y\n            }\n        );\n    }\n    return {images: pageImagesInfo, renderedLayers};\n}\n\nexport {renderPages};\n","const secrets = {\n    bingKey: '0000000000000000000000000000000000000000000000000000000000000000',\n    thunderforestKey: '00000000000000000000000000000000',\n    sentryDSN: 'https://00000000000000000000000000000000@sentry.io/111111',\n    mapillary: '0000000000000000000000000000000000000000000000000000',\n    flickr: '00000000000000000000000000000000',\n    google: 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXX'\n};\n\nexport default secrets;\n","function imgFromDataString(xhr) {\n    if (xhr.status === 200 && xhr.response.size) {\n        const image = new Image();\n        let blobUrl = window.URL.createObjectURL(xhr.response);\n        const promise = new Promise((resolve, reject) => {\n                image.onload = () => {\n                    resolve(image);\n                    window.URL.revokeObjectURL(blobUrl);\n                };\n                image.onerror = () => {\n                    reject(new Error('Image corrupt'));\n                    window.URL.revokeObjectURL(blobUrl);\n                };\n            }\n        );\n        image.src = blobUrl;\n        return promise;\n    }\n    return null;\n}\n\nexport {imgFromDataString};\n","import L from 'leaflet';\nimport {BingLayer} from '~/lib/leaflet.layer.bing';\n\nBingLayer.include({\n        waitTilesReadyToGrab: function() {\n            if (this._url) {\n                return Promise.resolve();\n            }\n            return new Promise((resolve) => {\n                    let i = setInterval(() => {\n                            if (this._url) {\n                                clearInterval(i);\n                                resolve();\n                            }\n                        }, 50\n                    );\n                }\n            );\n        },\n\n        cloneForPrint: function(options) {\n            return new BingLayer(this._key, L.Util.extend({}, this.options, options));\n        },\n    }\n);\n","import L from 'leaflet';\n\nfunction tile2quad(x, y, z) {\n    var quad = '';\n    for (var i = z; i > 0; i--) {\n        var digit = 0;\n        var mask = 1 << (i - 1);\n        if ((x & mask) !== 0) {\n            digit += 1;\n        }\n        if ((y & mask) !== 0) {\n            digit += 2;\n        }\n        quad += digit;\n    }\n    return quad;\n}\n\nconst BingLayer = L.TileLayer.extend({\n    options: {\n        subdomains: [0, 1, 2, 3],\n        type: 'Aerial',\n        attribution: 'Bing',\n        culture: ''\n    },\n\n    initialize: function(key, options) {\n        L.Util.setOptions(this, options);\n\n        this._key = key;\n        this._url = null;\n        this._providers = [];\n        this.metaRequested = false;\n    },\n\n    getTileUrl: function(tilePoint) {\n        var zoom = this._getZoomForUrl();\n        var subdomains = this.options.subdomains,\n            s = this.options.subdomains[Math.abs((tilePoint.x + tilePoint.y) % subdomains.length)];\n        return this._url.replace('{subdomain}', s)\n            .replace('{quadkey}', tile2quad(tilePoint.x, tilePoint.y, zoom))\n            .replace('{culture}', this.options.culture);\n    },\n\n    loadMetadata: function() {\n        if (this.metaRequested) {\n            return;\n        }\n        this.metaRequested = true;\n        var that = this;\n        var cbid = '_bing_metadata_' + L.Util.stamp(this);\n        window[cbid] = function(meta) {\n            window[cbid] = undefined;\n            var e = document.getElementById(cbid);\n            e.parentNode.removeChild(e);\n            if (meta.errorDetails) {\n                throw new Error(meta.errorDetails);\n            }\n            that.initMetadata(meta);\n        };\n        var urlScheme = 'https';\n        var url = urlScheme + '://dev.virtualearth.net/REST/v1/Imagery/Metadata/' +\n            this.options.type + '?include=ImageryProviders&jsonp=' + cbid +\n            '&key=' + this._key + '&UriScheme=' + urlScheme;\n        var script = document.createElement('script');\n        script.type = 'text/javascript';\n        script.src = url;\n        script.id = cbid;\n        document.getElementsByTagName('head')[0].appendChild(script);\n    },\n\n    initMetadata: function(meta) {\n        var r = meta.resourceSets[0].resources[0];\n        this.options.subdomains = r.imageUrlSubdomains;\n        this._url = r.imageUrl;\n        if (r.imageryProviders) {\n            for (var i = 0; i < r.imageryProviders.length; i++) {\n                var p = r.imageryProviders[i];\n                for (var j = 0; j < p.coverageAreas.length; j++) {\n                    var c = p.coverageAreas[j];\n                    var coverage = {zoomMin: c.zoomMin, zoomMax: c.zoomMax, active: false};\n                    var bounds = new L.LatLngBounds(\n                        new L.LatLng(c.bbox[0] + 0.01, c.bbox[1] + 0.01),\n                        new L.LatLng(c.bbox[2] - 0.01, c.bbox[3] - 0.01)\n                    );\n                    coverage.bounds = bounds;\n                    coverage.attrib = p.attribution;\n                    this._providers.push(coverage);\n                }\n            }\n        }\n        this._update();\n    },\n\n    _update: function() {\n        if (this._url === null || !this._map) {\n            return;\n        }\n        this._update_attribution();\n        L.TileLayer.prototype._update.apply(this, []);\n    },\n\n    _update_attribution: function() {\n        var bounds = L.latLngBounds(\n            this._map.getBounds().getSouthWest().wrap(),\n            this._map.getBounds().getNorthEast().wrap()\n        );\n        var zoom = this._map.getZoom();\n        for (var i = 0; i < this._providers.length; i++) {\n            var p = this._providers[i];\n            if ((zoom <= p.zoomMax && zoom >= p.zoomMin) &&\n                bounds.intersects(p.bounds)) {\n                if (!p.active && this._map.attributionControl) {\n                    this._map.attributionControl.addAttribution(p.attrib);\n                }\n                p.active = true;\n            } else {\n                if (p.active && this._map.attributionControl) {\n                    this._map.attributionControl.removeAttribution(p.attrib);\n                }\n                p.active = false;\n            }\n        }\n    },\n\n    onAdd: function(map) {\n        this.loadMetadata();\n        L.TileLayer.prototype.onAdd.apply(this, [map]);\n    },\n\n    onRemove: function(map) {\n        for (var i = 0; i < this._providers.length; i++) {\n            var p = this._providers[i];\n            if (p.active && this._map.attributionControl) {\n                this._map.attributionControl.removeAttribution(p.attrib);\n                p.active = false;\n            }\n        }\n        L.TileLayer.prototype.onRemove.apply(this, [map]);\n    }\n});\n\nexport {BingLayer, tile2quad};\n","import L from 'leaflet';\nimport '~/lib/leaflet.layer.yandex';\n\nL.Layer.Yandex.Map.include({\n    cloneForPrint: function(options) {\n        return new L.Layer.Yandex.Map({...this.options, ...options, yandexScale: 2});\n    },\n\n    getTilesInfo: async function(printOptions) {\n        const tilesInfo = await L.TileLayer.prototype.getTilesInfo.call(this, printOptions);\n        tilesInfo.tileScale = 2;\n        return tilesInfo;\n    },\n});\n\nL.Layer.Yandex.Sat.include({\n    cloneForPrint: function(options) {\n        return new L.Layer.Yandex.Sat({...this.options, ...options});\n    },\n});\n\nL.Layer.Yandex.Tracks.include({\n    cloneForPrint: function(options) {\n        return new L.Layer.Yandex.Tracks({...this.options, ...options});\n    },\n});\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport '~/lib/leaflet.layer.google';\n\nL.Layer.GoogleBase.include({\n    cloneForPrint: function(options) {\n        return new L.Layer.GoogleBase(this._url, L.Util.extend({}, this.options, options));\n    },\n});\n\n","import L from \"leaflet\";\nimport '~/lib/leaflet.layer.westraPasses';\nimport {WestraPassesMarkers} from '~/lib/leaflet.layer.westraPasses/westraPassesMarkers';\nimport '~/lib/leaflet.layer.canvasMarkers';\nimport './CanvasMarkers';\n\nL.Layer.WestraPasses.addInitHook(function() {\n    this.markers.options.print = this.options.print;\n    this.options.print = false;\n});\n\nWestraPassesMarkers.include({\n    waitDataReady: function() {\n        if (this._dataLoaded) {\n            return Promise.resolve();\n        }\n        return new Promise((resolve) => {\n           this.on('data-loaded', resolve);\n        });\n    },\n\n    cloneForPrint: function(options) {\n        options = L.Util.extend({}, this.options, options);\n        return new WestraPassesMarkers(this._baseUrl, options);\n    },\n\n    getTilesInfo: async function(printOptions) {\n        await this.waitDataReady();\n        return L.Layer.CanvasMarkers.prototype.getTilesInfo.call(this, printOptions);\n    }\n});\n","import L from 'leaflet';\nimport './westraPasses.css';\nimport '~/lib/leaflet.layer.geojson-ajax';\nimport {WestraPassesMarkers} from './westraPassesMarkers';\n\nL.Layer.WestraPasses = L.Layer.extend({\n        options: {\n            fileCoverage: 'westra_coverage.json',\n            fileLabels1: 'westra_regions_labels1.json',\n            fileLabels2: 'westra_regions_labels2.json',\n            scaleDependent: true,\n            labels2Zoom: 6,\n            markersZoom: 10,\n            labels1Zoom: 2\n\n        },\n\n        initialize: function(baseUrl, options) {\n            L.setOptions(this, options);\n            this.markers = new WestraPassesMarkers(baseUrl, options.markersOptions);\n            this.coverage = new L.Layer.GeoJSONAjax(baseUrl + this.options.fileCoverage, {\n                className: 'westra-coverage-polygon',\n                onEachFeature: this._setEventsForRegion.bind(this)\n            });\n            this.labels1 = new L.Layer.GeoJSONAjax(baseUrl + this.options.fileLabels1, {\n                pointToLayer: this._makeMarker,\n                onEachFeature: this._setEventsForRegion.bind(this)\n            });\n            this.labels2 = new L.Layer.GeoJSONAjax(baseUrl + this.options.fileLabels2, {\n                pointToLayer: this._makeMarker,\n                onEachFeature: this._setEventsForRegion.bind(this)\n            });\n        },\n\n        _setEventsForRegion: function(feature, layer) {\n            layer.on('click', this._onRegionClick, this);\n        },\n\n        _makeMarker: function(geojsonPoint, latlng) {\n            const icon = L.divIcon({\n                    className: 'westra-region-label',\n                    html: '<span>' + geojsonPoint.properties.name + '</span>'\n                }\n            );\n            const marker = L.marker(latlng, {icon: icon});\n            return marker;\n        },\n\n        _onRegionClick: function(e) {\n            const layer = e.target;\n            const latlng = layer.getLatLng ? layer.getLatLng() : e.latlng;\n            const zoom = this._map.getZoom();\n            let newZoom;\n            if (zoom < this.options.labels2Zoom) {\n                newZoom = this.options.labels2Zoom;\n            } else {\n                newZoom = this.options.markersZoom;\n            }\n            this._map.setView(latlng, newZoom);\n        },\n\n        setLayersVisibility: function(e) {\n            if (!this._map) {\n                return;\n            }\n            var newZoom;\n            var zoomFinished = e ? (e.type !== 'zoomanim') : true;\n            if (e && e.zoom !== undefined) {\n                newZoom = e.zoom;\n            } else {\n                newZoom = this._map.getZoom();\n            }\n            if (newZoom < this.options.labels1Zoom) {\n                this._map.removeLayer(this.markers);\n                this._map.addLayer(this.coverage);\n                this._map.removeLayer(this.labels1);\n                this._map.removeLayer(this.labels2);\n            } else if (newZoom < this.options.labels2Zoom) {\n                this._map.removeLayer(this.markers);\n                this._map.addLayer(this.coverage);\n                this._map.addLayer(this.labels1);\n                this._map.removeLayer(this.labels2);\n            } else if (newZoom < this.options.markersZoom) {\n                this._map.removeLayer(this.markers);\n                this._map.addLayer(this.coverage);\n                this._map.removeLayer(this.labels1);\n                this._map.addLayer(this.labels2);\n            } else {\n                if (zoomFinished) {\n                    this._map.addLayer(this.markers);\n                }\n                this._map.removeLayer(this.coverage);\n                this._map.removeLayer(this.labels1);\n                this._map.removeLayer(this.labels2);\n            }\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            this.markers.loadData();\n            this.coverage.loadData();\n            this.labels1.loadData();\n            this.labels2.loadData();\n            this.setLayersVisibility();\n            map.on('zoomend', this.setLayersVisibility, this);\n            map.on('zoomanim', this.setLayersVisibility, this);\n        },\n\n        onRemove: function() {\n            this._map.removeLayer(this.markers);\n            this._map.removeLayer(this.coverage);\n            this._map.removeLayer(this.labels1);\n            this._map.removeLayer(this.labels2);\n            this._map.off('zoomend', this.setLayersVisibility, this);\n            this._map.off('zoomanim', this.setLayersVisibility, this);\n            this._map = null;\n        }\n    }\n);\n\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {fetch} from '~/lib/xhr-promise';\nimport {notify} from '~/lib/notifications';\nimport * as logging from '~/lib/logging';\n\nL.Layer.GeoJSONAjax = L.GeoJSON.extend({\n        options: {\n            requestTimeout: 30000\n        },\n\n        initialize: function(url, options) {\n            L.GeoJSON.prototype.initialize.call(this, null, options);\n            this.url = url;\n        },\n\n        // Promise can be rejected if json invalid or addData fails\n        loadData: function() {\n            if (this._loadStarted) {\n                return;\n            }\n            this._loadStarted = true;\n            fetch(this.url, {timeout: this.options.requestTimeout})\n                .then(\n                    (xhr) => {\n                        this.addData(JSON.parse(xhr.response));\n                    },\n                    (e) => {\n                        logging.captureException(e, 'failed to get geojson');\n                        notify(`Failed to get GeoJSON data from ${this.url}: ${e.message}`);\n                    }\n                );\n        },\n\n        onAdd: function(map) {\n            L.GeoJSON.prototype.onAdd.call(this, map);\n            this.loadData();\n        }\n    }\n);\n\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport '~/lib/leaflet.polyline-measure';\n\nL.Polyline.include({\n        _printProgressWeight: 0.1,\n        printWidthMm: 1,\n\n        cloneForPrint: function(options) {\n            options = L.Util.extend({}, this.options, options);\n            const latlngs = this.getLatLngs().map((latlng) => latlng.clone());\n            return new L.Polyline(latlngs, options);\n        },\n\n        _makelatLngToCanvasPixelTransformer: function(printOptions, shift) {\n            const projectedBounds = printOptions.pixelBounds;\n            const scale = projectedBounds.getSize().unscaleBy(printOptions.destPixelSize);\n            const origin = projectedBounds.min;\n            return function(latlng) {\n                return L.CRS.EPSG3857.latLngToPoint(latlng, printOptions.zoom)\n                    .subtract(origin)\n                    .add(L.point([shift, 0]))\n                    .unscaleBy(scale);\n            };\n        },\n\n        _shift: function(targetBounds, zoom) {\n            const polylineBounds = this.getBounds();\n            let shift = 0;\n            const worldWidth = L.CRS.EPSG3857.getProjectedBounds(zoom).getSize().x;\n            if (polylineBounds.isValid()) {\n                const polylineCenter = polylineBounds.getCenter();\n                const targetCenter = targetBounds.getCenter();\n\n                if (polylineCenter.lng < targetCenter.lng - 180) {\n                    shift = 1;\n                } else if (polylineCenter.lng > targetCenter.lng + 180) {\n                    shift = -1;\n                } else {\n                    shift = 0;\n                }\n            }\n            return {lng: shift * 360, projected: worldWidth * shift};\n        },\n\n        _drawRaster: function(canvas, printOptions) {\n            const latlngs = this.getLatLngs();\n            const shift = this._shift(printOptions.latLngBounds, printOptions.zoom);\n            const lineBounds = this.getBounds();\n            if (latlngs.length < 2) {\n                return false;\n            }\n            const shiftedLineBounds = L.latLngBounds([\n                [lineBounds.getNorth(), lineBounds.getWest() + shift.lng],\n                [lineBounds.getSouth(), lineBounds.getEast() + shift.lng]\n            ]);\n            if (!shiftedLineBounds.intersects(printOptions.latLngBounds)) {\n                return false;\n            }\n\n            const ctx = canvas.getContext('2d');\n            ctx.lineWidth = this.printWidthMm / 25.4 * printOptions.resolution;\n            ctx.lineJoin = 'round';\n            ctx.lineCap = 'round';\n            ctx.strokeStyle = this.options.color;\n            const transform = this._makelatLngToCanvasPixelTransformer(printOptions, shift.projected);\n            let point;\n            ctx.beginPath();\n\n            point = transform(latlngs[0]);\n            ctx.moveTo(point.x, point.y);\n            for (let i = 1; i < latlngs.length; i++) {\n                point = transform(latlngs[i]);\n                ctx.lineTo(point.x, point.y);\n            }\n            ctx.stroke();\n            return true;\n        },\n\n        getTilesInfo: async function(printOptions) {\n            return {\n                iterateTilePromises: (function*() {\n                    yield {\n                        tilePromise: Promise.resolve({\n                                draw: (canvas) => this._drawRaster(canvas, printOptions),\n                                isOverlay: true\n                            }\n                        ),\n                        abortLoading: () => {\n                            // no actions needed\n                        }\n                    };\n                }).bind(this),\n                count: 1\n            };\n        }\n    }\n);\n\nL.MeasuredLine.include({\n        tickFontSizeMm: 2.5,\n\n        cloneForPrint: function(options) {\n            options = L.Util.extend({}, this.options, options);\n            const latlngs = this.getLatLngs().map((latlng) => latlng.clone());\n            return new L.MeasuredLine(latlngs, options);\n        },\n\n        _drawRaster: function(canvas, printOptions) {\n            if (!L.Polyline.prototype._drawRaster.call(this, canvas, printOptions)) {\n                return;\n            }\n            if (!this.options.measureTicksShown) {\n                return;\n            }\n            const minTicksIntervalMeters = printOptions.scale * 1.5;\n            const ctx = canvas.getContext('2d');\n            const ticks = this.getTicksPositions(minTicksIntervalMeters);\n            const ticksPixelSize = this.tickFontSizeMm / 25.4 * printOptions.resolution;\n            const shift = this._shift(printOptions.latLngBounds, printOptions.zoom);\n            const transform = this._makelatLngToCanvasPixelTransformer(printOptions, shift.projected);\n            ctx.font = `bold ${ticksPixelSize}px verdana`;\n            ctx.fillStyle = this.options.color;\n            for (let tick of ticks) {\n                let m = tick.transformMatrix;\n                let label = '\\u2501\\u2501 ' + Math.round((tick.distanceValue / 10)) / 100 + ' km';\n                let position = transform(tick.position);\n                ctx.setTransform(m[0], m[1], m[2], m[3], position.x, position.y);\n                ctx.fillText(label, 0, ticksPixelSize * 0.3);\n                ctx.setTransform(1, 0, 0, 1, 0, 0);\n            }\n        }\n    }\n);\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\n\nimport {RetinaTileLayer} from '~/lib/leaflet.layer.RetinaTileLayer';\nimport './TileLayer';\n\nRetinaTileLayer.include({\n    cloneForPrint: function(options) {\n        const newOptions = L.Util.extend({}, this.options, options);\n        return new RetinaTileLayer(this.urls, newOptions, newOptions.scaleDependent);\n    },\n\n    getTilesInfo: async function(printOptions) {\n        const tilesInfo = await L.TileLayer.prototype.getTilesInfo.call(this, printOptions);\n        tilesInfo.tileScale = this.tileSizeMultiplicator;\n        return tilesInfo;\n    },\n});\n","export default \"<div class=\\\"leaflet-control-button-toggle\\\" title=\\\"Print map\\\"\\n     data-bind=\\\"click: setExpanded, css: {'icon-spinner-nuclear': makingPdf, 'icon-printer': !makingPdf()}\\\">\\n    </div>\\n<div class=\\\"leaflet-control-content\\\">\\n<table class=\\\"layout\\\">\\n    <tbody>\\n    <tr><td colspan=\\\"2\\\">\\n        <a title=\\\"Add page in portrait orientation\\\" class=\\\"button-add-page-vert image-button\\\"\\n           data-bind=\\\"click: addPortraitPage\\\"></a>\\n        <a title=\\\"Add page in landscape orientation\\\" class=\\\"button-add-page-horiz image-button\\\"\\n           data-bind=\\\"click: addLandscapePage\\\"></a>\\n        <span class=\\\"pages-num\\\" data-bind=\\\"text: pagesNumLabel, click: onPagesNumLabelClick, css: {'pages-not-null': pagesNum() > 0}\\\"></span>\\n        <a title=\\\"Remove all pages\\\" class=\\\"button-remove-pages image-button\\\"\\n           data-bind=\\\"click: removePages\\\"></a>\\n    </td></tr>\\n    <tr>\\n        <td class=\\\"label\\\">Print scale</td>\\n        <td>\\n            <div class=\\\"preset-values\\\" >\\n                <a data-bind=\\\"click: function() {scale(100)}, css: {selected: scale() === 100}\\\">100 m</a>\\n                <a data-bind=\\\"click: function() {scale(500)}, css: {selected: scale() === 500}\\\">500 m</a>\\n                <a data-bind=\\\"click: function() {scale(1000)}, css: {selected: scale() === 1000}\\\">1 km</a>\\n            </div>\\n            <input type=\\\"text\\\" class=\\\"scale\\\" maxlength=\\\"6\\\" data-bind=\\\"value: scale\\\">&nbsp;m in 1 cm\\n        </td>\\n    </tr>\\n    <tr data-bind=\\\"visible: settingsExpanded\\\">\\n        <td class=\\\"label\\\">Page size</td>\\n        <td>\\n            <div class=\\\"preset-values\\\" data-bind=\\\"foreach: {data: pageSizes, as: 'size'}\\\">\\n                <a data-bind=\\\"click: function() {$root.pageWidth(size.width); $root.pageHeight(size.height)},\\n                              text: size.name,\\n                              css: {selected: size.name === $root.pageSizeDescription() }\\\"></a>\\n            </div>\\n            <input type=\\\"text\\\" maxlength=\\\"4\\\" title=\\\"width\\\" placeholder=\\\"width\\\" class=\\\"page-size\\\" data-bind=\\\"value: pageWidth\\\">\\n            x <input type=\\\"text\\\" maxlength=\\\"4\\\" title=\\\"height\\\" placeholder=\\\"height\\\" class=\\\"page-size\\\" data-bind=\\\"value: pageHeight\\\"> mm\\n        </td>\\n    </tr>\\n    <tr data-bind=\\\"visible: settingsExpanded\\\">\\n        <td class=\\\"label-high\\\">Margins</td>\\n        <td>\\n            <table class=\\\"margins\\\">\\n                <tr>\\n                    <td></td>\\n                    <td><input type=\\\"text\\\" maxlength=\\\"2\\\" value=\\\"3\\\" data-bind=\\\"value: marginTop\\\"></td>\\n                    <td></td>\\n                </tr>\\n                <tr>\\n                    <td><input type=\\\"text\\\" maxlength=\\\"2\\\" value=\\\"3\\\" data-bind=\\\"value: marginLeft\\\"></td>\\n                    <td></td><td><input type=\\\"text\\\" maxlength=\\\"2\\\" value=\\\"3\\\" data-bind=\\\"value: marginRight\\\"> mm</td>\\n                </tr>\\n                <tr><td></td><td><input type=\\\"text\\\" maxlength=\\\"2\\\" value=\\\"3\\\" data-bind=\\\"value: marginBottom\\\"></td><td></td></tr>\\n            </table>\\n        </td>\\n    </tr>\\n    <tr data-bind=\\\"visible: settingsExpanded\\\">\\n        <td class=\\\"label\\\">Resolution</td>\\n        <td><input type=\\\"text\\\" maxlength=\\\"4\\\" class=\\\"resolution\\\" data-bind=\\\"value: resolution\\\"> dpi</td>\\n    </tr>\\n    <tr data-bind=\\\"visible: settingsExpanded\\\">\\n        <td class=\\\"label\\\">Source zoom<br />level</td>\\n        <td>\\n            <select name=\\\"srczoom\\\"\\n                    data-bind=\\\"options: zoomLevels, value: zoomLevel\\\">\\n            </select>\\n        </td>\\n    </tr>\\n    <tr>\\n        <td colspan=\\\"2\\\">\\n            <label><input type=\\\"checkbox\\\" data-bind=\\\"checked: magneticMeridiansOn\\\"> Magnetic meridians</label>\\n            <label><input type=\\\"checkbox\\\" data-bind=\\\"checked: gridOn\\\"> Kilometers grid</label>\\n        </td>\\n    </tr>\\n    <tr><td colspan=\\\"2\\\">\\n        <a class=\\\"button-settings image-button\\\" data-bind=\\\"click: function() {settingsExpanded(!settingsExpanded())}\\\"\\n            title=\\\"More settings\\\"></a>\\n        <div class=\\\"settings-summary\\\">\\n            <span data-bind=\\\"text: pageSizeDescription\\\"></span><br/>\\n            <span data-bind=\\\"text: resolution\\\"></span>&nbsp;dpi,\\n            zoom&nbsp;<span data-bind=\\\"text: zoomLevel\\\"></span>\\n            <!-- ko if: zoomLevel()=== \\\"auto\\\" -->\\n            (<span title=\\\"Zoom for satellite and scanned imagery\\\" data-bind=\\\"text: autoZoomLevels().satZoom\\\"></span>&nbsp;\\n            /&nbsp;<span title=\\\"Zoom for maps like OSM and Google\\\" data-bind=\\\"text: autoZoomLevels().mapZoom\\\"></span>)\\n            <!-- /ko -->\\n        </div>\\n    </td></tr>\\n    <tr><td colspan=\\\"2\\\">\\n        <div class=\\\"download-button-row\\\">\\n            <div class=\\\"button-minimize\\\" data-bind=\\\"click: setMinimized\\\"></div>\\n            <a class=\\\"text-button button-save\\\" data-bind=\\\"\\n                                click: onSavePdfClicked,\\n                                visible: !makingPdf()\\\">Save PDF</a>\\n            <div data-bind=\\\"\\n                                component: { \\n                                    name: 'progress-indicator',\\n                                    params: {progressRange: downloadProgressRange, progressDone: downloadProgressDone}\\n                                },\\n                                visible: makingPdf()\\\"></div>\\n        </div>\\n    </td></tr>\\n    </tbody>\\n</table>\\n</div>\\n\";","function header() {\n    return '%PDF-1.3';\n}\n\nfunction eof() {\n    return '%%EOF\\n';\n}\n\nfunction recCatalog() {\n    return (\n`1 0 obj\n<< /Type /Catalog\n/Pages 2 0 R\n>>\nendobj`);\n}\n\nfunction recPages(count) {\n    let kidsIds = [];\n    for (let i = 0; i < count; i++) {\n        kidsIds.push(`${i * 3 + 3} 0 R`);\n    }\n    kidsIds = kidsIds.join(' ');\n    return (\n`2 0 obj\n<< /Type /Pages        \n/Kids [ ${kidsIds} ]\n/Count ${count}\n>>\nendobj`);\n}\n\nfunction recPage(serialNum, width, height) {\n    const pageRecId = serialNum * 3 + 3;\n    const contentRecId = pageRecId + 1;\n    const imageRecId = pageRecId + 2;\n    return (\n`${pageRecId} 0 obj\n<< /Type /Page\n/Parent 2 0 R\n/MediaBox [0 0 ${width} ${height}]\n/Contents ${contentRecId} 0 R\n/Rotate ${width > height ? 90 : 0}\n/Resources <<\n    /XObject << /Im${serialNum} ${imageRecId} 0 R >>\n    /ProcSet [ /PDF /Text /ImageC ] \n    >>\n>>\nendobj`);\n}\n\nfunction recContent(serialNum, width, height) {\n    const pageRecId = serialNum * 3 + 3;\n    const contentRecId = pageRecId + 1;\n    const contents = (\n`q\n${width} 0 0 ${height} 0 0 cm\n/Im${serialNum} Do\nQ   `);\n    return (\n`${contentRecId} 0 obj\n<<\n/Length ${contents.length + 1}\n>>\nstream\n${contents}   \nendstream\nendobj`);\n}\n\nfunction recImage(serialNum, widthPixels, heightPixels, data) {\n    const pageRecId = serialNum * 3 + 3;\n    const imageRecId = pageRecId + 2;\n\n    return (\n`${imageRecId} 0 obj\n<< /Type /XObject\n/Subtype /Image\n/Name /Im${serialNum}\n/Filter [ /DCTDecode ]\n/Width ${widthPixels}\n/Height ${heightPixels}\n/ColorSpace /DeviceRGB\n/BitsPerComponent 8\n/Length ${data.length}\n>>\nstream\n${data}\nendstream\nendobj`);\n}\n\nfunction recTrailer(recOffsets, currentOffset) {\n    const trailer = [];\n    trailer.push(\n`xref\n0 ${recOffsets.length + 1}\n0000000000 65535 f `);\n    const zeroes = '0000000000';\n    for (let offset of recOffsets) {\n        offset = offset.toString();\n        let padding = zeroes.substr(offset.length);\n        trailer.push(`${padding}${offset} 00000 n `);\n    }\n\n    trailer.push(\n`trailer\n<< /Root 1 0 R\n/Size ${recOffsets.length + 1}\n>>\nstartxref\n${currentOffset}`);\n    return trailer.join('\\n');\n}\n\nfunction makePdf(imagesInfo, resolution) {\n    let offset = 0;\n    const offsets = [];\n    let pdf = [];\n\n    function addRec(s, skipOffset) {\n        pdf.push(s);\n        if (!skipOffset) {\n            offsets.push(offset);\n        }\n        offset += s.length;\n    }\n\n    addRec(header(), true);\n    addRec(recCatalog());\n    addRec(recPages(imagesInfo.length));\n    for (let [i, {data, width, height}] of imagesInfo.entries()) {\n        let widthPoints = width / resolution * 72,\n            heightPoints = height / resolution * 72;\n        addRec(recPage(i, widthPoints, heightPoints));\n        addRec(recContent(i, widthPoints, heightPoints));\n        addRec(recImage(i, width, height, data));\n    }\n    addRec(recTrailer(offsets, offset), true);\n    addRec(eof(), true);\n\n    pdf = pdf.join('\\n');\n    return pdf;\n}\n\nexport {makePdf};\n\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {getDeclination} from '~/lib/magnetic-declination';\nimport {PrintStaticLayer} from './decorations';\n\nfunction radians(degrees) {\n    return degrees * Math.PI / 180;\n}\n\nfunction movePoint(p, angle, dist) {\n    angle = radians(angle);\n    return L.point(p.x + Math.sin(angle) * dist, p.y - Math.cos(angle) * dist);\n}\n\nclass MagneticMeridians extends PrintStaticLayer {\n    lineThicknessMm = 0.2;\n    lineIntervalMm = 50;\n    samplingIntervalMm = 15;\n    color = '#66c2ff';\n    overlaySolid = false;\n\n    _makeCanvasToLatLngTransformer(printOptions) {\n        const projectedBounds = printOptions.pixelBounds;\n        const scale = projectedBounds.getSize().unscaleBy(printOptions.destPixelSize);\n        const origin = projectedBounds.min;\n        return function(pixel) {\n            return L.CRS.EPSG3857.pointToLatLng(pixel.scaleBy(scale).add(origin), printOptions.zoom);\n        };\n    }\n\n    _drawRaster(canvas, printOptions) {\n        const toLatLng = this._makeCanvasToLatLngTransformer(printOptions);\n        const ctx = canvas.getContext('2d');\n        ctx.beginPath();\n        ctx.strokeStyle = this.color;\n        ctx.lineWidth = this.lineThicknessMm / 25.4 * printOptions.resolution;\n        const intervalPx = this.lineIntervalMm / 25.4 * printOptions.resolution;\n        const samplingPx = this.samplingIntervalMm / 25.4 * printOptions.resolution;\n        const pageDiagonal = Math.sqrt(\n            printOptions.destPixelSize.x * printOptions.destPixelSize.x +\n            printOptions.destPixelSize.y * printOptions.destPixelSize.y\n        );\n        const maxSegments = pageDiagonal / 2 / samplingPx;\n\n        function drawLine(p, directionDown) {\n            ctx.moveTo(p.x, p.y);\n\n            for (let i = 0; i <= maxSegments; i++) {\n                let latLng = toLatLng(p);\n                let declination = getDeclination(latLng.lat, latLng.lng);\n                if (declination === null) {\n                    break;\n                }\n                if (directionDown) {\n                    declination += 180;\n                }\n                p = movePoint(p, declination, samplingPx);\n                ctx.lineTo(p.x, p.y);\n            }\n        }\n\n        const center = printOptions.destPixelSize.divideBy(2);\n        const maxLines = pageDiagonal / 2 / intervalPx;\n\n        drawLine(center);\n        drawLine(center, true);\n\n        let p = center;\n        for (let i = 0; i <= maxLines; i++) {\n            let latLng = toLatLng(p);\n            let declination = getDeclination(latLng.lat, latLng.lng);\n            if (declination === null) {\n                declination = 0;\n            }\n            p = movePoint(p, declination + 90, intervalPx);\n            drawLine(p);\n            drawLine(p, true);\n        }\n        p = center;\n        for (let i = 0; i <= maxLines; i++) {\n            let latLng = toLatLng(p);\n            let declination = getDeclination(latLng.lat, latLng.lng);\n            if (declination === null) {\n                declination = 0;\n            }\n            p = movePoint(p, declination - 90, intervalPx);\n            drawLine(p);\n            drawLine(p, true);\n        }\n\n        ctx.stroke();\n    }\n}\n\nexport {MagneticMeridians};\n","import {PrintStaticLayer} from './decorations';\n\nfunction pageScaleRange(printOptions) {\n    const pageSize = printOptions.destPixelSize.divideBy(printOptions.resolution / 25.4);\n    const bounds = printOptions.latLngBounds;\n    const southLen = bounds.getSouthEast().distanceTo(bounds.getSouthWest());\n    const northLen = bounds.getNorthEast().distanceTo(bounds.getNorthWest());\n    const nScale = Math.round(northLen / pageSize.x * 10);\n    const sScale = Math.round(southLen / pageSize.x * 10);\n    return {\n        min: Math.min(nScale, sScale, printOptions.scale),\n        max: Math.max(nScale, sScale, printOptions.scale)\n    };\n}\n\nfunction formatScale(nominalScale, scaleRange) {\n    const threshold = 0.05;\n    if (\n        Math.abs(nominalScale - scaleRange.min) / nominalScale > threshold ||\n        Math.abs(nominalScale - scaleRange.max) / nominalScale > threshold\n    ) {\n        let unit;\n        scaleRange = {...scaleRange};\n        if (scaleRange.min >= 1000) {\n            scaleRange.min /= 1000;\n            scaleRange.max /= 1000;\n            unit = 'km';\n        } else {\n            unit = 'm';\n        }\n        return `${scaleRange.min}  ${scaleRange.max} ${unit} in 1 cm`;\n    }\n    let unit;\n    if (nominalScale >= 1000) {\n        nominalScale /= 1000;\n        unit = 'km';\n    } else {\n        unit = 'm';\n    }\n    return `${nominalScale} ${unit} in 1 cm`;\n}\n\nclass OverlayScale extends PrintStaticLayer {\n    fontSizeMm = 3;\n    font = 'verdana';\n    paddingMm = 1;\n    overlaySolid = true;\n\n    _drawRaster(canvas, printOptions) {\n        const ctx = canvas.getContext('2d');\n        let caption = formatScale(printOptions.scale, pageScaleRange(printOptions));\n        if (printOptions.pagesCount > 1) {\n            caption += ` | Page ${printOptions.pageLabel} / ${printOptions.pagesCount}`;\n        }\n        const fontSize = this.fontSizeMm / 25.4 * printOptions.resolution;\n        const padding = this.paddingMm / 25.4 * printOptions.resolution;\n        ctx.font = `${fontSize}px ${this.font}`;\n        const textWidth = ctx.measureText(caption).width;\n        ctx.textBaseline = 'bottom';\n        ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';\n        ctx.fillRect(0, 0, textWidth + 2 * padding, fontSize + 2 * padding);\n        ctx.fillStyle = '#000000';\n        ctx.fillText(caption, padding, fontSize + padding);\n    }\n}\n\nexport {OverlayScale};\n","import {PrintStaticLayer} from './decorations';\nimport L from 'leaflet';\n\nfunction radians(degrees) {\n    return degrees * Math.PI / 180;\n}\n\nclass Grid extends PrintStaticLayer {\n    minGridIntervalMm = 15;\n\n    fontSizeMm = 3;\n    font = 'verdana';\n    paddingMm = 1;\n\n    /* eslint-disable array-element-newline*/\n    intervals = [\n        1, 1.5, 2, 3.3, 5, 7.5,\n        10, 15, 20, 33, 50, 75,\n        100, 150, 200, 333, 500, 750,\n        1000, 1500, 2000, 4000, 5000, 7500,\n        10000, 15000, 20000, 40000, 50000, 75000,\n        100000, 150000, 200000, 400000, 500000, 750000,\n        1000000, 1500000, 2000000, 4000000, 5000000, 7500000\n    ];\n    /* eslint-enable array-element-newline*/\n\n    getGridInterval(printOptions) {\n        const minGridIntervalM = this.minGridIntervalMm / 10 * printOptions.scale;\n        let intervalM;\n        for (intervalM of this.intervals) {\n            if (intervalM > minGridIntervalM) {\n                break;\n            }\n        }\n        return intervalM;\n    }\n\n    formatDistance(x) {\n        let unit;\n        if (x < 1000) {\n            unit = 'm';\n        } else {\n            x /= 1000;\n            unit = 'km';\n        }\n        if (x % 1) {\n            x = x.toFixed(1);\n        }\n        return `${x} ${unit}`;\n    }\n\n    _drawGrid(canvas, printOptions) {\n        const metersPerDegree = L.Projection.SphericalMercator.R * Math.PI / 180;\n        const ctx = canvas.getContext('2d');\n        ctx.beginPath();\n        const pixelsPerMm = 1 / 25.4 * printOptions.resolution;\n        const intervalM = this.getGridInterval(printOptions);\n        const width = printOptions.destPixelSize.x;\n        const height = printOptions.destPixelSize.y;\n        const mercatorBounds = L.bounds(\n            L.Projection.SphericalMercator.project(printOptions.latLngBounds.getNorthWest()),\n            L.Projection.SphericalMercator.project(printOptions.latLngBounds.getSouthEast())\n        );\n        const canvasToMercatorScale = mercatorBounds.getSize().unscaleBy(printOptions.destPixelSize);\n        const rows = [];\n        let y = height;\n        while (true) {\n            let yMerc = mercatorBounds.max.y - y * canvasToMercatorScale.y;\n            let lat = L.Projection.SphericalMercator.unproject(L.point(0, yMerc)).lat;\n            rows.push({lat, y});\n            if (y < 0) {\n                break;\n            }\n            let lat2 = lat + intervalM / metersPerDegree;\n            let yMerc2 = L.Projection.SphericalMercator.project(L.latLng(lat2, 0)).y;\n            y = (mercatorBounds.max.y - yMerc2) / canvasToMercatorScale.y;\n        }\n        const lineWidthMm = 0.15;\n        let lineWidthPx = lineWidthMm * pixelsPerMm;\n        for (let {color, offset} of [\n            {color: '#D9D9D9', offset: lineWidthPx / 2},\n            {color: '#8C8C8C', offset: -lineWidthPx / 2},\n        ]) {\n            ctx.beginPath();\n\n            ctx.lineWidth = lineWidthPx;\n            ctx.strokeStyle = color;\n\n            for ({y} of rows) {\n                ctx.moveTo(0, y + offset);\n                ctx.lineTo(width, y + offset);\n            }\n            const pageCanvasCenterX = printOptions.destPixelSize.x / 2;\n            for (let direction of [-1, 1]) {\n                let colN = 0;\n                while (true) {\n                    let firstRow = true;\n                    let hasPointInPage = false;\n                    for (let {lat, y} of rows) {\n                        let dx = colN * intervalM / Math.cos(radians(lat)) / canvasToMercatorScale.x;\n                        // eslint-disable-next-line max-depth\n                        if (dx < pageCanvasCenterX) {\n                            hasPointInPage = true;\n                        }\n                        // eslint-disable-next-line max-depth\n                        if (firstRow) {\n                            ctx.moveTo(pageCanvasCenterX + dx * direction + offset, y);\n                        } else {\n                            ctx.lineTo(pageCanvasCenterX + dx * direction + offset, y);\n                        }\n                        firstRow = false;\n                    }\n                    if (!hasPointInPage) {\n                        break;\n                    }\n                    colN += 1;\n                }\n            }\n            ctx.stroke();\n        }\n    }\n\n    _drawLabel(canvas, printOptions) {\n        const intervalM = this.getGridInterval(printOptions);\n        const height = printOptions.destPixelSize.y;\n        const ctx = canvas.getContext('2d');\n        const caption = 'Grid ' + this.formatDistance(intervalM);\n        const fontSize = this.fontSizeMm / 25.4 * printOptions.resolution;\n        const padding = this.paddingMm / 25.4 * printOptions.resolution;\n        ctx.font = `${fontSize}px ${this.font}`;\n        const textWidth = ctx.measureText(caption).width;\n        ctx.textBaseline = 'bottom';\n        ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';\n        ctx.fillRect(0, height - fontSize - 2 * padding, textWidth + 2 * padding, fontSize + 2 * padding);\n        ctx.fillStyle = '#000000';\n        ctx.fillText(caption, padding, height - padding);\n    }\n\n    async getTilesInfo(printOptions) {\n        return {\n            iterateTilePromises: (function*() {\n                yield {\n                    tilePromise: Promise.resolve({\n                            draw: (canvas) => this._drawGrid(canvas, printOptions),\n                            isOverlay: true,\n                            overlaySolid: false\n                        }\n                    ),\n                    abortLoading: () => {\n                        // no actions needed\n                    }\n                };\n                yield {\n                    tilePromise: Promise.resolve({\n                            draw: (canvas) => this._drawLabel(canvas, printOptions),\n                            isOverlay: true,\n                            overlaySolid: true\n                        }\n                    ),\n                    abortLoading: () => {\n                        // no actions needed\n                    }\n                };\n            }).bind(this),\n            count: 2\n        };\n    }\n}\n\nexport {Grid};\n","import L from 'leaflet';\nimport './style.css';\nimport '~/lib/leaflet.control.commons';\n\nL.Control.Caption = L.Control.extend({\n    options: {\n        position: 'bottomright',\n        className: 'leaflet-control-caption'\n    },\n\n    initialize: function(contents, options) {\n        L.setOptions(this, options);\n        this._contents = contents;\n    },\n\n    onAdd: function(map) {\n        this._map = map;\n        this._container = L.DomUtil.create('div', this.options.className);\n        this._container.innerHTML = this._contents;\n        L.DomEvent.on(this._container, 'contextmenu', (e) => {\n            L.DomEvent.stopPropagation(e);\n            e.returnValue = true;\n            return true;\n        });\n        return this._container;\n    },\n\n    setContents: function(contents) {\n        this._contents = contents;\n        if (this._map) {\n            this._container.innerHTML = this._contents;\n        }\n    }\n\n});\n\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport ko from 'knockout';\nimport './coordinates.css';\nimport copyToClipboard from '~/lib/clipboardCopy';\nimport Contextmenu from '~/lib/contextmenu';\nimport {makeButtonWithBar} from '~/lib/leaflet.control.commons';\nimport safeLocalStorage from '~/lib/safe-localstorage';\nimport '~/lib/controls-styles/controls-styles.css';\nimport * as formats from './formats';\n\nconst DEFAULT_FORMAT = formats.DEGREES;\nconst UNKNOWN_COORDINATES = {\n    lat: '-------',\n    lng: '-------'\n};\n\nL.Control.Coordinates = L.Control.extend({\n        options: {\n            position: 'bottomleft'\n        },\n\n        formats: [\n            formats.SIGNED_DEGREES,\n            formats.DEGREES,\n            formats.DEGREES_AND_MINUTES,\n            formats.DEGREES_AND_MINUTES_AND_SECONDS\n        ],\n\n        initialize: function(options) {\n            L.Control.prototype.initialize.call(this, options);\n\n            this.latlng = ko.observable();\n            this.format = ko.observable(DEFAULT_FORMAT);\n            this.formatCode = ko.pureComputed({\n                read: () => this.format().code,\n                write: (value) => {\n                    for (let format of this.formats) {\n                        if (value === format.code) {\n                            this.format(format);\n                            break;\n                        }\n                    }\n                }\n            });\n\n            this.formattedCoordinates = ko.pureComputed(() => {\n                if (this.latlng()) {\n                    return formats.formatLatLng(this.latlng().wrap(), this.format());\n                }\n                return UNKNOWN_COORDINATES;\n            }, this);\n\n            this.wrapperClass = ko.pureComputed(() => this.format().wrapperClass, this);\n\n            this.formatCode.subscribe(this.saveStateToStorage, this);\n        },\n\n        onAdd: function(map) {\n            const {container, link, barContainer} = makeButtonWithBar(\n                'leaflet-contol-coordinates',\n                '   ',\n                'icon-coordinates'\n            );\n\n            this._map = map;\n            this._container = container;\n            this._link = link;\n\n            barContainer.innerHTML = `\n                <div data-bind=\"css: wrapperClass\">\n                    <div class=\"leaflet-coordinates-container\" data-bind=\"with: formattedCoordinates()\">\n                        <span class=\"leaflet-coordinates-latitude\" data-bind=\"html: lat\"></span>\n                        <span class=\"leaflet-coordinates-longitude\" data-bind=\"html: lng\"></span>\n                    </div>\n                    <hr class=\"leaflet-coordinates-divider\" />\n                    <div data-bind=\"foreach: formats\">\n                        <div>\n                            <label title=\"\">\n                                <input type=\"radio\" data-bind=\"checked: $parent.formatCode, value: code\" \n                                       class=\"leaflet-coordinates-format-radio\"/>\n                                <span data-bind=\"html: label\"></span>\n                            </label>\n                        </div>\n                    </div>\n                </div>\n            `;\n\n            barContainer.title = \"    \";\n\n            this.loadStateFromStorage();\n            ko.applyBindings(this, container);\n            L.DomEvent.on(link, 'click', this.onClick, this);\n\n            return container;\n        },\n\n        onRemove: function() {\n            L.DomEvent.off(this._link, 'click', this.onClick, this);\n        },\n\n        loadStateFromStorage: function() {\n            const active = safeLocalStorage.leafletCoordinatesActive === '1';\n            const code = safeLocalStorage.leafletCoordinatesFmt || DEFAULT_FORMAT.code;\n\n            this.formatCode(code);\n            this.setEnabled(active);\n        },\n\n        saveStateToStorage: function() {\n            safeLocalStorage.leafletCoordinatesActive = this.isEnabled() ? '1' : '0';\n            safeLocalStorage.leafletCoordinatesFmt = this.formatCode();\n        },\n\n        onMouseMove: function(e) {\n            this.latlng(e.latlng);\n        },\n\n        setEnabled: function(enabled) {\n            if (Boolean(enabled) === this.isEnabled()) {\n                return;\n            }\n            const classFunc = enabled ? 'addClass' : 'removeClass';\n            const eventFunc = enabled ? 'on' : 'off';\n            L.DomUtil[classFunc](this._container, 'active');\n            L.DomUtil[classFunc](this._container, 'highlight');\n            L.DomUtil[classFunc](this._map._container, 'coordinates-control-active');\n            this._map[eventFunc]('mousemove', this.onMouseMove, this);\n            this._map[eventFunc]('contextmenu', this.onMapRightClick, this);\n            this._isEnabled = Boolean(enabled);\n            this.latlng(null);\n        },\n\n        onMapRightClick: function(e) {\n            L.DomEvent.stop(e);\n\n            function createItem(format, options = {}) {\n                const {lat, lng} = formats.formatLatLng(e.latlng.wrap(), format);\n                const coordinates = `${lat} ${lng}`;\n\n                return {text: `${coordinates} <span class=\"leaflet-coordinates-menu-fmt\">${format.label}</span>`,\n                    callback: () => copyToClipboard(coordinates, e.originalEvent),\n                    ...options};\n            }\n\n            const header = createItem(this.format(), {\n                text: '<b>   </b>',\n                header: true,\n            });\n            const items = this.formats.map((format) => createItem(format));\n            items.unshift(header, '-');\n\n            new Contextmenu(items).show(e);\n        },\n\n        isEnabled: function() {\n            return Boolean(this._isEnabled);\n        },\n\n        onClick: function() {\n            this.setEnabled(!this.isEnabled());\n            this.saveStateToStorage();\n        }\n    }\n);\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","function truncToFixed(x, precision) {\n    let s = x.toString();\n    let point = s.indexOf('.');\n    if (point === -1) {\n        point = s.length;\n        s += '.';\n    }\n    let sliceEnd = point + precision;\n    if (precision > 0) {\n        s = s.padEnd(point + precision + 1, '0');\n        sliceEnd += 1;\n    }\n    s = s.slice(0, sliceEnd);\n    return s;\n}\n\nfunction formatNumber(value, size, precision = 0) {\n    if (value < 0) {\n      throw new Error('Negative values not supported');\n    }\n\n    if (precision > 0) {\n        size += 1;\n    }\n    return truncToFixed(value, precision).padStart(size + precision, '0');\n}\n\nfunction coordinatePresentations(coordinate, isLat) {\n    const degrees = Math.abs(coordinate);\n    const intDegrees = Math.floor(degrees);\n    const minutes = (degrees - intDegrees) * 60;\n    const intMinutes = Math.floor(minutes);\n    const seconds = (minutes - intMinutes) * 60;\n\n    let direction;\n    if (isLat) {\n        direction = (coordinate < 0) ? 'S' : 'N';\n    } else {\n        direction = (coordinate < 0) ? 'W' : 'E';\n    }\n\n    return {\n        signedDegrees: coordinate.toFixed(5),\n        degrees: formatNumber(degrees, 0, 5),\n        intDegrees: formatNumber(intDegrees, 0),\n        minutes: formatNumber(minutes, 2, 3),\n        intMinutes: formatNumber(intMinutes, 2),\n        seconds: formatNumber(seconds, 2, 2),\n        direction\n    };\n}\n\nfunction formatLatLng(latlng, format) {\n    return {\n        lat: format.formatter(coordinatePresentations(latlng.lat, true)),\n        lng: format.formatter(coordinatePresentations(latlng.lng, false))\n    };\n}\n\nconst SIGNED_DEGREES = {\n    code: 'd',\n    label: 'ddd.ddddd',\n    wrapperClass: 'leaflet-coordinates-wrapper-signed-degrees',\n    formatter: ({signedDegrees}) => signedDegrees\n};\n\nconst DEGREES = {\n    code: 'D',\n    label: 'ddd.ddddd',\n    wrapperClass: 'leaflet-coordinates-wrapper-degrees',\n    formatter: ({degrees, direction}) => `${direction} ${degrees}`\n};\n\nconst DEGREES_AND_MINUTES = {\n    code: 'DM',\n    label: 'dddmm.mmm',\n    wrapperClass: 'leaflet-coordinates-wrapper-degrees-and-minutes',\n    formatter: ({intDegrees, minutes, direction}) => `${direction} ${intDegrees}${minutes}`\n};\n\nconst DEGREES_AND_MINUTES_AND_SECONDS = {\n    code: 'DMS',\n    label: 'dddmmss.s',\n    wrapperClass: 'leaflet-coordinates-wrapper-degrees-and-minutes-and-seconds',\n    formatter: ({intDegrees, intMinutes, seconds, direction}) => `${direction} ${intDegrees}${intMinutes}${seconds}`\n};\n\nexport {\n    SIGNED_DEGREES,\n    DEGREES,\n    DEGREES_AND_MINUTES,\n    DEGREES_AND_MINUTES_AND_SECONDS,\n    formatLatLng\n};\n","import L from 'leaflet';\nimport './style.css';\n\nfunction getLayerHotkey(layer) {\n    if (!layer || !layer.options) {\n        return null;\n    }\n    let hotkey = layer.options.hotkey;\n    if (hotkey) {\n        return hotkey;\n    }\n    hotkey = layer.options.code;\n    if (hotkey && hotkey.length === 1) {\n        return hotkey;\n    }\n    return null;\n}\n\nfunction extendLayerName(name, layer) {\n    if (layer.options) {\n        const hotkey = getLayerHotkey(layer);\n        if (hotkey) {\n            name += `<span class=\"layers-control-hotkey\">${hotkey}</span>`;\n        }\n    }\n    return name;\n}\n\nfunction enableHotKeys(control) {\n    const originalOnAdd = control.onAdd;\n    const originalOnRemove = control.onRemove;\n    const originalAddItem = control._addItem;\n\n    if (control._hotKeysEnabled) {\n        return control;\n    }\n\n    L.Util.extend(control, {\n            _hotKeysEnabled: true,\n\n            _addItem: function(obj) {\n                if (!L.Browser.touch || !L.Browser.mobile) {\n                    obj = L.Util.extend({}, obj);\n                    obj.name = extendLayerName(obj.name, obj.layer);\n                }\n                return originalAddItem.call(this, obj);\n            },\n\n            onAdd: function(map) {\n                var result = originalOnAdd.call(this, map);\n                this._addHotketEvents();\n                return result;\n            },\n\n            onRemove: function(map) {\n                L.DomEvent.off(document, 'keyup', this._onHotkeyUp, this);\n                L.DomEvent.off(document, 'keydown', this.onKeyDown, this);\n                originalOnRemove.call(this, map);\n            },\n\n            _addHotKetEvents: function() {\n                L.DomEvent.on(document, 'keyup', this._onHotkeyUp, this);\n                L.DomEvent.on(document, 'keydown', this.onKeyDown, this);\n            },\n\n            onKeyDown: function(e) {\n                if (e.altKey || e.ctrlKey || e.shiftKey) {\n                    return;\n                }\n                this._keyDown = e.keyCode;\n            },\n\n            _onHotkeyUp: function(e) {\n                const pressedKey = this._keyDown;\n                this._keyDown = null;\n                const targetTag = e.target.tagName.toLowerCase();\n                if (\n                    (targetTag === 'input' && ['text', 'search'].includes(e.target.type)) ||\n                    targetTag === 'textarea' ||\n                    pressedKey !== e.keyCode\n                ) {\n                    return;\n                }\n                const key = String.fromCharCode(e.keyCode);\n                for (let layer of this._layers) {\n                    let layerId = L.stamp(layer.layer);\n                    const layerHotkey = getLayerHotkey(layer.layer);\n                    if (layerHotkey === key) {\n                        const inputs = this._form.getElementsByTagName('input');\n                        for (let input of [...inputs]) {\n                            if (input.layerId === layerId) {\n                                input.click();\n                                break;\n                            }\n                        }\n                        break;\n                    }\n                }\n            }\n        }\n    );\n    for (let layer of control._layers) {\n        layer.name = extendLayerName(layer.name, layer.layer);\n    }\n    control._addHotKetEvents();\n    control._update();\n    return control;\n}\n\nexport default enableHotKeys;\n\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport './leaflet.hashState';\n\nL.Map.include(L.Mixin.HashState);\n\nL.Map.include({\n        stateChangeEvents: ['moveend'],\n\n        serializeState: function() {\n            var center = this.getCenter();\n            var zoom = this.getZoom();\n            var precision = 5;\n            var state = [\n                zoom.toString(),\n                center.lat.toFixed(precision),\n                center.lng.toFixed(precision)\n            ];\n            return state;\n        },\n\n        validateState: function(values) {\n            if (!values || values.length !== 3) {\n                return {valid: false};\n            }\n            let zoom = parseInt(values[0], 10),\n                lat = parseFloat(values[1]),\n                lng = parseFloat(values[2]);\n            if (isNaN(zoom) || isNaN(lat) || isNaN(lng) || zoom < 0 || zoom > 32 || lat < -90 || lat > 90) {\n                return {valid: false};\n            }\n            return {lat, lng, zoom, valid: true};\n        },\n\n        unserializeState: function(values) {\n            let {lat, lng, zoom, valid} = this.validateState(values);\n            if (valid) {\n                this.setView([lat, lng], zoom);\n                return true;\n            }\n            return false;\n        }\n    }\n);\n\n","import L from 'leaflet';\nimport './leaflet.hashState';\n\nL.Control.Layers.include(L.Mixin.HashState);\n\nL.Control.Layers.include({\n        stateChangeEvents: ['baselayerchange', 'overlayadd', 'overlayremove'],\n        stateChangeEventsSource: '_map',\n\n        serializeState: function() {\n            const keys = [];\n            this._map.eachLayer((layer) => {\n                    let key = layer.options.code;\n                    if (key) {\n                        keys.push([key, layer.options.zIndex]);\n                    }\n                }\n            );\n            keys.sort((k1, k2) => k1[1] - k2[1]);\n            const state = keys.map((k) => k[0]);\n            return state;\n        },\n\n        unserializeState: function(values) {\n            if (!values || values.length === 0) {\n                return false;\n            }\n\n            let hasBaselayer;\n            for (let layer of this._layers) {\n                if (layer.layer.options && values.includes(layer.layer.options.code) && !layer.overlay) {\n                    hasBaselayer = true;\n                    break;\n                }\n            }\n\n            if (!hasBaselayer) {\n                return false;\n            }\n\n            for (let layer of this._layers) {\n                if (layer.layer.options && values.includes(layer.layer.options.code)) {\n                    this._map.addLayer(layer.layer);\n                } else {\n                    this._map.removeLayer(layer.layer);\n                }\n            }\n            return true;\n        }\n    }\n);\n\n","import L from 'leaflet';\nimport './style.css';\nimport {fixVectorMarkerWorldJump} from './fixWorldCopyJump';\n\n// https://github.com/Leaflet/Leaflet/issues/3575\nfunction fixPanAnimationBug() {\n    if (!L.Browser.chrome) {\n        return;\n    }\n    if (L.PosAnimation.prototype.__panAnimationFixed) {\n        return;\n    }\n\n    const originalStep = L.PosAnimation.prototype._step;\n    L.PosAnimation.prototype._step = function() {\n        return originalStep.call(this, true);\n    };\n    L.PosAnimation.prototype.__panAnimationFixed = true;\n}\n\nfunction fixTouchDetection() {\n    L.Browser.touch &= ((navigator.pointerEnabled && !L.Browser.ie) || navigator.maxTouchPoints);\n}\n\nfunction fixMapKeypressEvent() {\n    const originalHandleDOMEvent = L.Map.prototype._handleDOMEvent;\n    L.Map.prototype._handleDOMEvent = function(e) {\n        if (e.type === 'keypress' && e.keyCode === 13) {\n            this._fireDOMEvent(e, e.type);\n        } else {\n            originalHandleDOMEvent.call(this, e);\n        }\n    };\n}\n\nfunction fixVectorDrawWhileAnimation() {\n    if (L.Renderer.__animationFixed) {\n        return;\n    }\n\n    const resetInterval = 300;\n\n    const originalGetEvents = L.Renderer.prototype.getEvents;\n\n    function onZoom() {\n        const now = Date.now();\n        if (!this._lastReset || (now - this._lastReset > resetInterval)) {\n            this._reset();\n            this._lastReset = now;\n        } else {\n            L.Renderer.prototype._onZoom.call(this);\n        }\n    }\n\n    function onMove() {\n        const now = Date.now();\n        if (!this._lastReset || (now - this._lastReset > resetInterval)) {\n            this._reset();\n            this._lastReset = now;\n        }\n    }\n\n    function getEvents() {\n        const result = originalGetEvents.call(this);\n        result.move = onMove;\n        result.zoom = onZoom;\n        return result;\n    }\n\n    L.Renderer.prototype.getEvents = getEvents;\n    L.Renderer.__animationFixed = true;\n}\n\nfunction allowControlHorizontalStacking() {\n    const original_addTo = L.Control.prototype.addTo;\n    L.Control.prototype.addTo = function(map) {\n        const result = original_addTo.call(this, map);\n        if (this.options.stackHorizontally) {\n            L.DomUtil.addClass(this._container, 'leaflet-control-horizontal-stack');\n        }\n        return result;\n    };\n}\n\nfunction addTooltipDelay() {\n    const origOpenTooltip = L.Layer.prototype._openTooltip;\n    L.Layer.prototype._openTooltip = function(e) {\n        if (this._tooltip.options.delay) {\n            const that = this;\n            this._pendingTooltip = setTimeout(() => origOpenTooltip.call(that, e), this._tooltip.options.delay);\n        } else {\n            origOpenTooltip.call(this, e);\n        }\n    };\n\n    const origCloseTooltip = L.Layer.prototype.closeTooltip;\n    L.Layer.prototype.closeTooltip = function() {\n        clearInterval(this._pendingTooltip);\n        origCloseTooltip.call(this);\n    };\n}\n\nfunction fixAll() {\n    fixPanAnimationBug();\n    fixTouchDetection();\n    fixMapKeypressEvent();\n    fixVectorDrawWhileAnimation();\n    fixVectorMarkerWorldJump();\n    allowControlHorizontalStacking();\n    addTooltipDelay();\n}\n\nexport {fixAll};\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport ko from 'knockout';\nimport googleProvider from './lib/google';\nimport '~/lib/leaflet.hashState/leaflet.hashState';\n\nimport './style.css';\nimport '~/lib/controls-styles/controls-styles.css';\nimport {makeButtonWithBar} from '~/lib/leaflet.control.commons';\nimport mapillaryProvider from './lib/mapillary';\nimport wikimediaProvider from './lib/wikimedia';\nimport {DragEvents} from '~/lib/leaflet.events.drag';\nimport {onElementResize} from '~/lib/anyElementResizeEvent';\nimport safeLocalStorage from '~/lib/safe-localstorage';\nimport mapyczProvider from './lib/mapycz';\n\nconst PanoMarker = L.Marker.extend({\n    options: {\n        zIndexOffset: 10000\n    },\n\n    initialize: function() {\n        const icon = L.divIcon({\n                className: 'leaflet-panorama-marker-wraper',\n                html: '<div class=\"leaflet-panorama-marker\"></div>'\n            }\n        );\n        L.Marker.prototype.initialize.call(this, [0, 0], {icon, interactive: false});\n    },\n\n    getIcon: function() {\n        let markerIcon = this.getElement();\n        markerIcon = markerIcon.children[0];\n        return markerIcon;\n    },\n\n    setHeading: function(angle) {\n        const markerIcon = this.getIcon();\n        markerIcon.style.transform = `rotate(${angle || 0}deg)`;\n    },\n\n    setType: function(markerType) {\n        const className = {\n            slim: 'leaflet-panorama-marker-circle',\n            normal: 'leaflet-panorama-marker-binocular'\n        }[markerType];\n        this.getIcon().className = className;\n    }\n});\n\nL.Control.Panoramas = L.Control.extend({\n        includes: L.Evented,\n\n        options: {\n            position: 'topleft',\n            splitVerically: true,\n            splitSizeFraction: 0.5,\n            minViewerSize: 30,\n        },\n\n        getProviders: function() {\n            return [\n                {\n                    name: 'google',\n                    title: 'Google street view',\n                    provider: googleProvider,\n                    layerOptions: {zIndex: 10},\n                    code: 'g',\n                    selected: ko.observable(true),\n                    mapMarkerType: 'normal'\n                },\n                {\n                    name: 'wikimedia',\n                    title: 'Wikimedia commons',\n                    provider: wikimediaProvider,\n                    layerOptions: {opacity: 0.7, zIndex: 9},\n                    code: 'w',\n                    selected: ko.observable(false),\n                    mapMarkerType: 'slim'\n                },\n                {\n                    name: 'mapillary',\n                    title: 'Mapillary',\n                    provider: mapillaryProvider,\n                    layerOptions: {opacity: 0.7, zIndex: 8},\n                    code: 'm',\n                    selected: ko.observable(false),\n                    mapMarkerType: 'normal'\n                },\n                {\n                    name: 'mapycz',\n                    title: 'mapy.cz',\n                    provider: mapyczProvider,\n                    layerOptions: {opacity: 0.7, zIndex: 8},\n                    code: 'c',\n                    selected: ko.observable(false),\n                    mapMarkerType: 'normal'\n                }\n            ];\n        },\n\n        initialize: function(options) {\n            L.Control.prototype.initialize.call(this, options);\n            this.loadSettings();\n            this._panoramasContainer = L.DomUtil.create('div', 'panoramas-container');\n            onElementResize(\n                this._panoramasContainer,\n                L.Util.requestAnimFrame.bind(null, this.onContainerResize.bind(this))\n            );\n            this.providers = this.getProviders();\n            for (let provider of this.providers) {\n                provider.selected.subscribe(this.updateCoverageVisibility, this);\n                provider.container = L.DomUtil.create('div', 'panorama-container', this._panoramasContainer);\n            }\n            this.nearbyPoints = [];\n        },\n\n        loadSettings: function() {\n            let storedSettings;\n            try {\n                storedSettings = JSON.parse(safeLocalStorage.panoramaSettings);\n            } catch {\n                // ignore\n            }\n            this._splitVerically = storedSettings?.spitVertically ?? this.options.splitVerically;\n            const fraction = storedSettings?.splitSizeFraction;\n            this._splitSizeFraction = isNaN(fraction) ? this.options.splitSizeFraction : fraction;\n        },\n\n        saveSetting: function() {\n            safeLocalStorage.panoramaSettings = JSON.stringify({\n                spitVertically: this._splitVerically,\n                splitSizeFraction: this._splitSizeFraction\n            });\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n\n            this._splitterDragging = false;\n            const splitter = L.DomUtil.create('div', 'panorama-splitter', this._panoramasContainer);\n            L.DomUtil.create('div', 'splitter-border', splitter);\n            const splitterButton = L.DomUtil.create('div', 'button', splitter);\n            new DragEvents(splitter, null, {trackOutsideElement: true}).on({\n                dragstart: this.onSplitterDragStart,\n                dragend: this.onSplitterDragEnd,\n                drag: this.onSplitterDrag,\n            }, this);\n            new DragEvents(splitterButton, null, {trackOutsideElement: true}).on({\n                click: this.onSplitterClick\n            }, this);\n            this.setupViewerLayout();\n            const {container, link, barContainer} = makeButtonWithBar(\n                'leaflet-contol-panoramas', 'Show panoramas (Alt-P)', 'icon-panoramas');\n            map.on('resize', this.onMapResize, this);\n            this._container = container;\n            L.DomEvent.on(link, 'click', this.onButtonClick, this);\n            L.DomEvent.on(document, 'keyup', this.onKeyUp, this);\n            barContainer.innerHTML = `\n                 <div class=\"panoramas-list\" data-bind=\"foreach: providers\">\n                     <div>\n                         <label>\n                             <input type=\"checkbox\" data-bind=\"checked: selected\"><span data-bind=\"text: title\"></span>\n                         </label>\n                     </div>\n                 </div>\n             `;\n\n            ko.applyBindings(this, container);\n            map.createPane('rasterOverlay').style.zIndex = 300;\n            return container;\n        },\n\n        onSplitterDrag: function(e) {\n            const minSize = this.options.minViewerSize;\n            const container = this._panoramasContainer;\n            const oldSize = container[this._splitVerically ? 'offsetWidth' : 'offsetHeight'];\n            let newSize = oldSize + e.dragMovement[this._splitVerically ? 'x' : 'y'];\n            const mapSize = this._map._container[this._splitVerically ? 'offsetWidth' : 'offsetHeight'];\n            if (newSize < minSize) {\n                newSize = this.options.minViewerSize;\n            }\n            const maxSize = oldSize + mapSize - minSize;\n            if (newSize > maxSize) {\n                newSize = maxSize;\n            }\n            this.setContainerSizePixels(newSize);\n        },\n\n        onSplitterClick: function() {\n            this._splitVerically = !this._splitVerically;\n            this.saveSetting();\n            this.setupViewerLayout();\n        },\n\n        onButtonClick: function() {\n            this.switchControl();\n        },\n\n        switchControl: function() {\n            if (this.controlEnabled) {\n                this.disableControl();\n            } else {\n                this.enableControl();\n            }\n        },\n\n        onKeyUp: function(e) {\n            if (e.keyCode === 'P'.codePointAt(0) && e.altKey) {\n                this.switchControl();\n            }\n        },\n\n        enableControl: function() {\n            if (this.controlEnabled) {\n                return;\n            }\n            this.controlEnabled = true;\n            L.DomUtil.addClass(this._container, 'active');\n            this.updateCoverageVisibility();\n            this._map.on('click', this.onMapClick, this);\n            L.DomUtil.addClass(this._map._container, 'panoramas-control-active');\n            this.notifyChanged();\n        },\n\n        disableControl: function() {\n            if (!this.controlEnabled) {\n                return;\n            }\n            this.controlEnabled = false;\n            L.DomUtil.removeClass(this._container, 'active');\n            this.updateCoverageVisibility();\n            this._map.off('click', this.onMapClick, this);\n            this.hidePanoViewer();\n            L.DomUtil.removeClass(this._map._container, 'panoramas-control-active');\n            this.notifyChanged();\n        },\n\n        updateCoverageVisibility: function() {\n            if (!this._map) {\n                return;\n            }\n            for (let provider of this.providers) {\n                if (this.controlEnabled && provider.selected()) {\n                    if (!provider.coverageLayer) {\n                        const options = L.extend({pane: 'rasterOverlay'}, provider.layerOptions);\n                        provider.coverageLayer = provider.provider.getCoverageLayer(options);\n                    }\n                    provider.coverageLayer.addTo(this._map);\n                } else {\n                    if (provider.coverageLayer) {\n                        this._map.removeLayer(provider.coverageLayer);\n                    }\n                }\n            }\n            this.notifyChanged();\n        },\n\n        showPanoramaContainer: function() {\n            L.DomUtil.addClass(this._panoramasContainer, 'enabled');\n        },\n\n        panoramaVisible: function() {\n            if (L.DomUtil.hasClass(this._panoramasContainer, 'enabled')) {\n                for (let provider of this.providers) {\n                    if (L.DomUtil.hasClass(provider.container, 'enabled')) {\n                        return provider;\n                    }\n                }\n            }\n            return false;\n        },\n\n        setupNearbyPoints: function(points) {\n            for (let point of this.nearbyPoints) {\n                this._map.removeLayer(point);\n            }\n            this.nearbyPoints = [];\n            if (points) {\n                const icon = L.divIcon({className: 'leaflet-panorama-marker-point'});\n                for (let latlng of points) {\n                    this.nearbyPoints.push(L.marker(latlng, {icon}).addTo(this._map));\n                }\n            }\n        },\n\n        hidePano: function(provider) {\n            L.DomUtil.removeClass(provider.container, 'enabled');\n            if (provider.viewer) {\n                provider.viewer.deactivate();\n            }\n            this.setupNearbyPoints();\n        },\n\n        showPano: async function(provider, data) {\n            this.showPanoramaContainer();\n            for (let otherProvider of this.providers) {\n                if (otherProvider !== provider) {\n                    this.hidePano(otherProvider);\n                }\n            }\n            L.DomUtil.addClass(provider.container, 'enabled');\n            if (!provider.viewer) {\n                // eslint-disable-next-line require-atomic-updates\n                provider.viewer = await provider.provider.getViewer(provider.container);\n                this.setupViewerEvents(provider);\n            }\n            if (data) {\n                // wait for panorama container become of right size, needed for viewer setup\n                setTimeout(() => provider.viewer.showPano(data), 0);\n            }\n            provider.viewer.activate();\n            this.notifyChanged();\n        },\n\n        setupViewerEvents: function(provider) {\n            provider.viewer.on({\n                change: this.onPanoramaChangeView.bind(this, provider),\n                closeclick: this.onPanoramaCloseClick\n            }, this);\n        },\n\n        hidePanoViewer: function() {\n            for (let provider of this.providers) {\n                this.hidePano(provider);\n            }\n            L.DomUtil.removeClass(this._panoramasContainer, 'enabled');\n            this.hideMarker();\n            this.notifyChanged();\n        },\n\n        placeMarker: function(latlng, heading) {\n            if (!this.panoramaVisible()) {\n                return;\n            }\n            if (!this.marker) {\n                this.marker = new PanoMarker();\n            }\n            this._map.addLayer(this.marker);\n            this.marker.setLatLng(latlng);\n            this.marker.setHeading(heading);\n        },\n\n        hideMarker: function() {\n            if (this.marker) {\n                this._map.removeLayer(this.marker);\n            }\n        },\n        notifyChanged: function() {\n            this.fire('panoramachanged');\n        },\n\n        onPanoramaChangeView: function(provider, e) {\n            if (!this._map.getBounds().pad(-0.05).contains(e.latlng)) {\n                this._map.panTo(e.latlng);\n            }\n            this.placeMarker(e.latlng, e.heading);\n            this.marker.setType(provider.mapMarkerType);\n            this.setupNearbyPoints(e.latlngs);\n            this.notifyChanged();\n        },\n\n        onPanoramaCloseClick: function() {\n            this.hidePanoViewer();\n        },\n\n        onMapClick: async function(e) {\n            const\n                searchRadiusPx = 24,\n                p = this._map.project(e.latlng).add([searchRadiusPx, 0]),\n                searchRadiusMeters = e.latlng.distanceTo(this._map.unproject(p)),\n                promises = [];\n            for (let provider of this.providers) {\n                if (provider.selected()) {\n                    promises.push({\n                        promise: provider.provider.getPanoramaAtPos(e.latlng, searchRadiusMeters),\n                        provider: provider\n                    });\n                }\n            }\n\n            for (let {promise, provider} of promises) {\n                let searchResult = await promise;\n                if (searchResult.found) {\n                    this.showPano(provider, searchResult.data);\n                    return;\n                }\n            }\n        },\n\n        setupViewerLayout: function() {\n            let sidebar;\n            if (this._splitVerically) {\n                L.DomUtil.addClass(this._panoramasContainer, 'split-vertical');\n                L.DomUtil.removeClass(this._panoramasContainer, 'split-horizontal');\n                sidebar = 'left';\n                this._panoramasContainer.style.height = '100%';\n            } else {\n                L.DomUtil.addClass(this._panoramasContainer, 'split-horizontal');\n                L.DomUtil.removeClass(this._panoramasContainer, 'split-vertical');\n                sidebar = 'top';\n                this._panoramasContainer.style.width = '100%';\n            }\n            this._map.addElementToSidebar(sidebar, this._panoramasContainer);\n            this.updateContainerSize();\n        },\n\n        setContainerSizePixels: function(size) {\n            size = Math.round(size);\n            this._panoramasContainer.style[this._splitVerically ? 'width' : 'height'] = `${size}px`;\n            setTimeout(() => { // map size has not updated yet\n                const mapSize = this._map._container[this._splitVerically ? 'offsetWidth' : 'offsetHeight'];\n                this._splitSizeFraction = size / (mapSize + size);\n                this.saveSetting();\n            }, 0);\n        },\n\n        updateContainerSize: function() {\n            const fraction = this._splitSizeFraction;\n            const container = this._panoramasContainer;\n            const containerSize = container[this._splitVerically ? 'offsetWidth' : 'offsetHeight'];\n            const mapSize = this._map._container[this._splitVerically ? 'offsetWidth' : 'offsetHeight'];\n            const newSize = Math.round(fraction * (mapSize + containerSize));\n            container.style[this._splitVerically ? 'width' : 'height'] = `${newSize}px`;\n        },\n\n        onContainerResize: function() {\n            const provider = this.panoramaVisible();\n            if (provider && provider.viewer) {\n                provider.viewer.invalidateSize();\n            }\n        },\n\n        onMapResize: function() {\n            if (!this._splitterDragging) {\n                this.updateContainerSize();\n            }\n        },\n\n        onSplitterDragStart: function() {\n            this._splitterDragging = true;\n        },\n\n        onSplitterDragEnd: function() {\n            this._splitterDragging = false;\n        },\n    },\n);\n\nL.Control.Panoramas.include(L.Mixin.HashState);\nL.Control.Panoramas.include({\n        stateChangeEvents: ['panoramachanged'],\n\n        serializeState: function() {\n            let state = null;\n            if (this.controlEnabled) {\n                state = [];\n                let coverageCode = '_';\n                for (let provider of this.providers) {\n                    if (provider.selected()) {\n                        coverageCode += provider.code;\n                    }\n                }\n                state.push(coverageCode);\n                const provider = this.panoramaVisible();\n                if (provider && provider.viewer) {\n                    let viewerState = provider.viewer.getState();\n                    if (viewerState) {\n                        state.push(provider.code);\n                        state.push(...viewerState);\n                    }\n                }\n            }\n            return state;\n        },\n\n        unserializeState: function(state) {\n            if (!state) {\n                this.disableControl();\n                return true;\n            }\n\n            const coverageCode = state[0];\n            if (!coverageCode || coverageCode[0] !== '_') {\n                return false;\n            }\n            this.enableControl();\n            for (let provider of this.providers) {\n                provider.selected(coverageCode.includes(provider.code));\n            }\n            if (state.length > 2) {\n                const panoramaVisible = state[1];\n                for (let provider of this.providers) {\n                    if (panoramaVisible === provider.code) {\n                        this.showPano(provider).then(() => {\n                            const success = provider.viewer.setState(state.slice(2));\n                            if (!success) {\n                                this.hidePanoViewer();\n                            }\n                        });\n                        break;\n                    }\n                }\n            }\n            return true;\n        }\n    }\n);\n\nL.Control.Panoramas.hashStateUpgrader = function(panoramasControl) {\n    return L.Util.extend({}, L.Mixin.HashState, {\n        unserializeState: function(oldState) {\n            if (oldState) {\n                const upgradedState = ['_g'];\n                if (oldState.length) {\n                    upgradedState.push('g', ...oldState);\n                }\n                setTimeout(() => panoramasControl.unserializeState(upgradedState), 0);\n            }\n            return false;\n        },\n\n        serializeState: function() {\n            return null;\n        },\n    });\n};\n","import L from 'leaflet';\nimport getGoogle from '~/lib/googleMapsApi';\n\nfunction getCoverageLayer(options) {\n    return L.tileLayer(\n        'https://maps.googleapis.com/maps/vt?pb=!1m5!1m4!1i{z}!2i{x}!3i{y}!4i256!2m8!1e2!2ssvv!4m2!1scb_client!2sapiv3!4m2!1scc!2s*211m3*211e3*212b1*213e2*211m3*211e2*212b1*213e2!3m5!3sUS!12m1!1e40!12m1!1e18!4e0', // eslint-disable-line max-len\n        options\n    );\n}\n\nasync function getStreetViewService() {\n    const google = await getGoogle();\n    return new google.maps.StreetViewService();\n}\n\nasync function getPanoramaAtPos(latlng, searchRadiusMeters) {\n    const google = await getGoogle();\n    const service = await getStreetViewService();\n    const {data, status} = await new Promise((resolve) => {\n            service.getPanorama({\n                    location: latlng,\n                    radius: searchRadiusMeters,\n                    preference: google.maps.StreetViewPreference.NEAREST\n                }, (data, status) => resolve({data, status})\n            );\n        }\n    );\n    if (status === google.maps.StreetViewStatus.OK) {\n        return {found: true, data};\n    }\n    return {found: false};\n}\n\nconst Viewer = L.Evented.extend({\n    initialize: function(google, container) {\n        this.google = google;\n        const panorama = this.panorama = new google.maps.StreetViewPanorama(container, {\n                enableCloseButton: true,\n                imageDateControl: true,\n                motionTracking: false,\n                motionTrackingControl: false,\n            }\n        );\n        panorama.addListener('position_changed', () => this.onPanoramaChangeView());\n        panorama.addListener('pov_changed', () => this.onPanoramaChangeView());\n        panorama.addListener('closeclick', () => this.onCloseClick());\n\n        this.invalidateSize = L.Util.throttle(this._invalidateSize, 50, this);\n    },\n\n    showPano: function(data) {\n        this.panorama.setPosition(data.location.latLng);\n        this.panorama.setZoom(1);\n    },\n\n    onPanoramaChangeView: function() {\n        if (!this._active) {\n            return;\n        }\n        let pos = this.panorama.getPosition();\n        pos = L.latLng(pos.lat(), pos.lng());\n        const pov = this.panorama.getPov();\n        this.fire('change', {latlng: pos, heading: pov.heading, zoom: pov.zoom, pitch: pov.pitch});\n    },\n\n    onCloseClick: function() {\n        this.fire('closeclick');\n    },\n\n    activate: function() {\n        this._active = true;\n        this.panorama.setVisible(true);\n    },\n\n    deactivate: function() {\n        this._active = false;\n        this.panorama.setVisible(false);\n    },\n\n    getState: function() {\n        const pos = this.panorama.getPosition();\n        const pov = this.panorama.getPov();\n        if (pos && pov) {\n            return [\n                pos.lat().toFixed(6),\n                pos.lng().toFixed(6),\n                (pov.heading || 0).toFixed(1),\n                (pov.pitch || 0).toFixed(1),\n                (pov.zoom || 1).toFixed(1)\n            ];\n        }\n        return null;\n    },\n\n    setState: function(state) {\n        const lat = parseFloat(state[0]);\n        const lng = parseFloat(state[1]);\n        const heading = parseFloat(state[2]);\n        const pitch = parseFloat(state[3]);\n        const zoom = parseFloat(state[4]);\n        if (!isNaN(lat) && !isNaN(lng) && !isNaN(heading) && !isNaN(pitch) && !isNaN(zoom)) {\n            this.panorama.setPosition({lat, lng});\n            this.panorama.setPov({heading, pitch, zoom});\n            return true;\n        }\n        return false;\n    },\n\n    _invalidateSize: function() {\n        this.google.maps.event.trigger(this.panorama, 'resize');\n    }\n});\n\nasync function getViewer(container) {\n    const google = await getGoogle();\n    return new Viewer(google, container);\n}\n\nconst googleProvider = {getCoverageLayer, getPanoramaAtPos, getViewer};\nexport default googleProvider;\n","import loadScript from 'load-script';\nimport config from '~/config';\n\nlet _google = null;\nlet _pending = null;\n\nfunction getGoogle() {\n    if (_google) {\n        return Promise.resolve(_google);\n    }\n    if (!_pending) {\n        _pending = new Promise((resolve, reject) => {\n                loadScript(config.googleApiUrl, (error) => {\n                        if (error) {\n                            reject(error);\n                        } else {\n                            _google = window.google;\n                            resolve(_google);\n                        }\n                    }\n                );\n            }\n        );\n    }\n    return _pending;\n}\n\nexport default getGoogle;\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {MapillaryCoverage} from './mapillary-coverage-layer';\nimport {fetch} from '~/lib/xhr-promise';\nimport config from '~/config';\nimport './style.css';\nimport {CloseButtonMixin, DateLabelMixin} from '../common';\n\nfunction getCoverageLayer(options) {\n    return new MapillaryCoverage(options);\n}\n\nfunction getMapillary() {\n    return new Promise((resolve) => {\n        require.ensure(['mapillary-js/dist/mapillary.min.js', 'mapillary-js/dist/mapillary.min.css'], () => {\n            require('mapillary-js/dist/mapillary.min.css');\n            resolve(require('mapillary-js/dist/mapillary.min.js'));\n        }, 'mapillary');\n    });\n}\n\nasync function getPanoramaAtPos(latlng, searchRadiusMeters) {\n    const url = `https://a.mapillary.com/v3/images?` +\n        `client_id=${config.mapillary}&closeto=${latlng.lng},${latlng.lat}&radius=${searchRadiusMeters}`;\n    const resp = await fetch(url, {responseType: 'json', timeout: 10000});\n    if (resp.status === 200 && resp.responseJSON.features.length) {\n        return {found: true, data: resp.responseJSON.features[0].properties.key};\n    }\n    return {found: false};\n}\n\nconst Viewer = L.Evented.extend({\n        includes: [CloseButtonMixin, DateLabelMixin],\n\n        initialize: function(mapillary, container) {\n            const id = `container-${L.stamp(container)}`;\n            container.id = id;\n            const viewer = this.viewer = new mapillary.Viewer(\n                id, config.mapillary, null, {component: {cover: false, bearing: false}});\n            window.addEventListener('resize', function() {\n                    viewer.resize();\n                }\n            );\n            viewer.on('nodechanged', this.onNodeChanged.bind(this));\n            viewer.on('bearingchanged', this.onBearingChanged.bind(this));\n            this.createDateLabel(container);\n            this.createCloseButton(container);\n            this._bearing = 0;\n            this._zoom = 0;\n            this._center = [0, 0];\n            this.invalidateSize = L.Util.throttle(this._invalidateSize, 100, this);\n        },\n\n        showPano: function(data) {\n            this.deactivate();\n            this.activate();\n            this.viewer.moveToKey(data).then(() => {\n                this.viewer.setZoom(0);\n                this.updateZoomAndCenter();\n            });\n        },\n\n        onNodeChanged: function(node) {\n            if (this._node && (node.key === this._node.key)) {\n                return;\n            }\n            this._node = node;\n            this.fireChangeEvent();\n            this.updateDateLabel(node.capturedAt);\n        },\n\n        getBearingCorrection: function() {\n            if (this._node && 'computedCA' in this._node) {\n                return (this._node.computedCA - this._node.originalCA);\n            }\n            return 0;\n        },\n\n        onBearingChanged: function(bearing) {\n            bearing -= this.getBearingCorrection();\n            if (this._bearing === bearing) {\n                return;\n            }\n            this._bearing = bearing;\n            this.fireChangeEvent();\n        },\n\n        fireChangeEvent: function() {\n            if (this._node) {\n                const latlon = this._node.originalLatLon;\n                this.fire('change', {\n                        latlng: L.latLng(latlon.lat, latlon.lon),\n                        heading: this._bearing,\n                        pitch: this._pitch,\n                        zoom: this._zoom\n                    }\n                );\n            }\n        },\n\n        deactivate: function() {\n            this.viewer.activateCover();\n            if (this._updateHandler) {\n                clearInterval(this._updateHandler);\n                this._updateHandler = null;\n            }\n        },\n\n        updateZoomAndCenter: function() {\n            this.viewer.getZoom().then((zoom) => {\n                this._zoom = zoom;\n            });\n            this.viewer.getCenter().then((center) => {\n                this._center = center;\n            });\n            this.viewer.getBearing().then((bearing) => {\n                this.onBearingChanged(bearing);\n            });\n        },\n\n        activate: function() {\n            this.viewer.resize();\n            this.viewer.deactivateCover();\n            if (!this._updateHandler) {\n                this._updateHandler = setInterval(() => this.updateZoomAndCenter(), 200);\n            }\n        },\n\n        getState: function() {\n            if (!this._node) {\n                return [];\n            }\n            const {lat, lon} = this._node.originalLatLon;\n            return [\n                lat.toFixed(6),\n                lon.toFixed(6),\n                this._center[0].toFixed(4),\n                this._center[1].toFixed(4),\n                this._zoom.toFixed(2)\n            ];\n        },\n\n        setState: function(state) {\n            const lat = parseFloat(state[0]);\n            const lng = parseFloat(state[1]);\n            const center0 = parseFloat(state[2]);\n            const center1 = parseFloat(state[3]);\n            const zoom = parseFloat(state[4]);\n            if (!isNaN(lat) && !isNaN(lng) && !isNaN(center0) && !isNaN(center1) && !isNaN(zoom)) {\n                this.viewer.moveCloseTo(lat, lng).then(() => {\n                    this.viewer.setCenter([center0, center1]);\n                    this.viewer.setZoom(zoom);\n                });\n                return true;\n            }\n            return false;\n        },\n\n        _invalidateSize: function() {\n            this.viewer.resize();\n        }\n    }\n);\n\nasync function getViewer(container) {\n    const mapillary = await getMapillary();\n    return new Viewer(mapillary, container);\n}\n\nconst mapillaryProvider = {getCoverageLayer, getPanoramaAtPos, getViewer};\nexport default mapillaryProvider;\n","import L from 'leaflet';\nimport {MapillaryLoader} from './mapillary-loader';\n\nconst MapillaryCoverage = L.GridLayer.extend({\n        options: {\n            tileSize: 1024,\n            updateWhenIdle: true,\n            color: '#00cfb1'\n        },\n\n        initialize: function(options) {\n            L.GridLayer.prototype.initialize.call(this, options);\n            this.loader = new MapillaryLoader(this.options.url, 12);\n        },\n\n        onAdd: function(map) {\n            L.GridLayer.prototype.onAdd.call(this, map);\n            this.on('tileunload', this.onTileUnload, this);\n        },\n\n        onRemove: function(map) {\n            L.GridLayer.prototype.onRemove.call(this, map);\n            this.off('tileunload', this.onTileUnload, this);\n        },\n\n        onTileUnload: function(e) {\n            const tile = e.tile;\n            tile._abortLoading();\n            delete tile._tileData;\n            delete tile._adjustment;\n        },\n\n        drawOverview: function(canvas) {\n            const\n                tileData = canvas._tileData;\n            if (!tileData['mapillary-sequence-overview']) {\n                return;\n            }\n            let {multiplier, offsetX, offsetY} = canvas._adjustment;\n            const canvasCtx = canvas.getContext('2d');\n            canvasCtx.fillStyle = this.options.color;\n            for (let feature of tileData['mapillary-sequence-overview']) {\n                if (feature.geometry.type !== 'Point') {\n                    throw new Error(`Invalid sequence overview geometry type \"${feature.geometry.type}\"`);\n                }\n                canvasCtx.beginPath();\n                let x = feature.geometry.coordinates[0] * multiplier - offsetX;\n                let y = feature.geometry.coordinates[1] * multiplier - offsetY;\n                canvasCtx.arc(x, y, 5, 0, 2 * Math.PI);\n                canvasCtx.fill();\n            }\n        },\n\n        drawSequences: function(canvas, lineWidth) {\n            let\n                tileData = canvas._tileData,\n                adjustment = canvas._adjustment;\n\n            if (!tileData['mapillary-sequences']) {\n                return;\n            }\n            const canvasCtx = canvas.getContext('2d');\n            canvasCtx.beginPath();\n            canvasCtx.strokeStyle = this.options.color;\n            canvasCtx.lineWidth = lineWidth;\n            // canvasCtx.lineWidth = thinLines ? 1 : 1;\n            canvasCtx.lineCap = \"round\";\n            canvasCtx.lineJoin = \"bevel\";\n            for (let feature of tileData['mapillary-sequences']) {\n                if (feature.geometry.type !== 'MultiLineString') {\n                    throw new Error(`Invalid sequence geometry type \"${feature.geometry.type}\"`);\n                }\n                let {multiplier, offsetX, offsetY} = adjustment;\n\n                let lines = feature.geometry.coordinates;\n                for (let lineI = 0; lineI < lines.length; lineI++) {\n                    let line = lines[lineI];\n                    if (!line.length) {\n                        continue;\n                    }\n                    let x = line[0][0] * multiplier - offsetX;\n                    let y = line[0][1] * multiplier - offsetY;\n                    canvasCtx.moveTo(x, y);\n                    if (line.length === 1) {\n                        canvasCtx.lineTo(x, y);\n                    }\n                    for (let pointI = 0; pointI < line.length; pointI++) {\n                        let x = line[pointI][0] * multiplier - offsetX;\n                        let y = line[pointI][1] * multiplier - offsetY;\n                        canvasCtx.lineTo(x, y);\n                    }\n                }\n            }\n            canvasCtx.stroke();\n        },\n\n        drawImages: function(canvas) {\n            let\n                tileData = canvas._tileData,\n                adjustment = canvas._adjustment;\n            if (!tileData['mapillary-images']) {\n                return;\n            }\n            let {multiplier, offsetX, offsetY} = adjustment;\n            const canvasCtx = canvas.getContext('2d');\n            canvasCtx.beginPath();\n            canvasCtx.fillStyle = this.options.color;\n            for (let feature of tileData['mapillary-images']) {\n                if (feature.geometry.type !== 'Point') {\n                    throw new Error(`Invalid image geometry type \"${feature.geometry.type}\"`);\n                }\n                canvasCtx.beginPath();\n                let x = feature.geometry.coordinates[0] * multiplier - offsetX;\n                let y = feature.geometry.coordinates[1] * multiplier - offsetY;\n                canvasCtx.arc(x, y, 4, 0, 2 * Math.PI);\n                canvasCtx.fill();\n            }\n        },\n\n        drawTile: function(canvas, coords) {\n            if (!this._map) {\n                return;\n            }\n            if (!canvas._tileData) {\n                return;\n            }\n            if (coords.z < 6 + 2) {\n                this.drawOverview(canvas);\n            } else if (coords.z < 14 + 2) {\n                let width = coords.z < 14 ? 10 : 5;\n                this.drawSequences(canvas, width);\n            } else {\n                this.drawSequences(canvas, 2);\n                this.drawImages(canvas);\n            }\n        },\n\n        createTile: function(coords, done) {\n            const canvas = L.DomUtil.create('canvas', 'leaflet-tile');\n            canvas.width = this.options.tileSize;\n            canvas.height = this.options.tileSize;\n            let {dataPromise, abortLoading} = this.loader.requestTileData(coords);\n            dataPromise.then((data) => {\n                if (!data.error) {\n                    canvas._tileData = data.tileData;\n                    canvas._adjustment = data.adjustment || {multiplier: 1, offsetX: 0, offsetY: 0};\n                    setTimeout(() => {\n                        this.drawTile(canvas, coords);\n                        done(null, canvas);\n                    }, 1);\n                }\n            });\n            canvas._abortLoading = abortLoading;\n            return canvas;\n        },\n\n    }\n);\n\nexport {MapillaryCoverage};\n","import L from 'leaflet';\nimport {TiledDataLoader} from '~/lib/tiled-data-loader';\nimport {decodeMvt} from './mvt';\n\nclass MapillaryLoader extends TiledDataLoader {\n    url = 'https://d25uarhxywzl1j.cloudfront.net/v0.1/{z}/{x}/{y}.mvt';\n    maxZoom = 14;\n\n    getTileUrl(coords) {\n        const data = {\n            x: coords.x,\n            z: coords.z,\n            y: coords.y\n        };\n        return L.Util.template(this.url, data);\n    }\n\n    layerTileToDataTileCoords(layerTileCoords) {\n        let z = layerTileCoords.z - 2;\n        let z2 = null;\n        if (z > 6 && z <= 10) {\n            z2 = 6;\n        } else if (z >= 11 && z < 14) {\n            z2 = z - 4;\n        } else if (z < 0) {\n            z2 = 0;\n        } else if (z > this.maxZoom) {\n            z2 = this.maxZoom;\n        } else {\n            return {z, x: layerTileCoords.x, y: layerTileCoords.y};\n        }\n\n        let multiplier = 1 << (z - z2);\n        return {\n            x: Math.floor(layerTileCoords.x / multiplier),\n            y: Math.floor(layerTileCoords.y / multiplier),\n            z: z2\n        };\n    }\n\n    makeRequestData(dataTileCoords) {\n        return {\n            url: this.getTileUrl(dataTileCoords),\n            options: {\n                responseType: 'arraybuffer',\n                timeout: 10000,\n                isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403\n            }\n        };\n    }\n\n    calcAdjustment(layerTileCoords, dataTileCoords) {\n        let adjustment = super.calcAdjustment(\n            {x: layerTileCoords.x, y: layerTileCoords.y, z: layerTileCoords.z - 2},\n            dataTileCoords\n        );\n        if (adjustment) {\n            adjustment.offsetX *= 1024;\n            adjustment.offsetY *= 1024;\n        }\n        return adjustment;\n    }\n\n    async processResponse(xhr, originalDataTileCoords) {\n        return this._processResponse(xhr, originalDataTileCoords);\n    }\n\n    async _processResponse(xhr, originalDataTileCoords) {\n        let tileData;\n        if (xhr.status === 200 && xhr.response) {\n            const layers = decodeMvt(xhr.response, 1024);\n            tileData = {};\n            for (let layer of layers) {\n                tileData[layer.name] = layer.features;\n            }\n        } else {\n            tileData = null;\n        }\n\n        return {\n            tileData,\n            coords: originalDataTileCoords\n        };\n    }\n}\n\nexport {MapillaryLoader};\n","class Cache {\n    constructor(maxSize) {\n        this._maxSize = maxSize;\n        this._store = {};\n        this._size = 0;\n    }\n\n    get(key) {\n        if (key in this._store) {\n            const value = this._store[key];\n            delete this._store[key];\n            this._store[key] = value;\n            return {value, found: true};\n        }\n        return {found: false};\n    }\n\n    put(key, value) {\n        if (key in this._store) {\n            delete this._store[key];\n        } else {\n            this._size += 1;\n        }\n        this._store[key] = value;\n        if (this._size > this._maxSize) {\n            delete this._store[Object.keys(this._store)[0]];\n            this._size -= 1;\n        }\n    }\n}\n\nexport {Cache};\n","import Pbf from 'pbf';\nimport {Tile as TileProto} from './vector_tile_pb';\n\nfunction decodeCoordinate(x) {\n    return ((x >> 1) ^ (-(x & 1)));\n}\n\nfunction parseGeometry(geometryType, ints, coordinatesScale) { // eslint-disable-line complexity\n    if (geometryType !== TileProto.GeomType.POINT && geometryType !== TileProto.GeomType.LINESTRING &&\n        geometryType !== TileProto.GeomType.POLYGON) {\n        throw new Error(`Unknown feature geometry type ${geometryType}`);\n    }\n    const len = ints.length;\n    let pos = 0;\n    const lineStrings = [];\n    let line;\n    let x = 0,\n        y = 0;\n    while (pos < len) {\n        let i = ints[pos];\n        let cmd = i & 0x7;\n        let cmdRepeat = i >> 3;\n        switch (cmd) {\n            case 1: // MoveTo\n                if (cmdRepeat !== 1) {\n                    throw new Error(`repeat=${cmdRepeat} for command MoveTo`);\n                }\n                if (pos + 2 > len) {\n                    throw new Error('Not enough elements for MoveTo arguments');\n                }\n                if (line) {\n                    lineStrings.push(line);\n                }\n                x += decodeCoordinate(ints[pos + 1]);\n                y += decodeCoordinate(ints[pos + 2]);\n                line = [[x * coordinatesScale, y * coordinatesScale]];\n                pos += 3;\n                break;\n            case 2: // LineTo\n                if (cmdRepeat < 1) {\n                    throw new Error(`repeat=${cmdRepeat} for command LineTo`);\n                }\n                if (!line) {\n                    throw new Error('LineTo with empty linestring');\n                }\n                pos += 1;\n                for (let cmdN = 0; cmdN < cmdRepeat; cmdN++) {\n                    if (pos + 2 > len) {\n                        throw new Error('Not enough elements for LineTo arguments');\n                    }\n                    x += decodeCoordinate(ints[pos]);\n                    y += decodeCoordinate(ints[pos + 1]);\n                    line.push([x * coordinatesScale, y * coordinatesScale]);\n                    pos += 2;\n                }\n                break;\n            case 7: // ClosePath\n                if (geometryType !== TileProto.GeomType.POLYGON) {\n                    throw new Error(`ClosePath command for non-polygon type ${geometryType}`);\n                }\n                if (!line) {\n                    throw new Error('ClosePath with empty linestring');\n                }\n                if (cmdRepeat !== 1) {\n                    throw new Error(`ClosePath repeats ${cmdRepeat} times`);\n                }\n                line.push(line[0]);\n                pos += 1;\n                break;\n            default:\n                throw new Error(`Unknown command ${i} & 0x7 = ${cmd}`);\n        }\n    }\n    if (line) {\n        lineStrings.push(line);\n    }\n    const geometry = {};\n    switch (geometryType) {\n        case TileProto.GeomType.POINT:\n            if (lineStrings.length !== 1 || lineStrings[0].length !== 1) {\n                throw new Error('Invalid coordinates number for point');\n            }\n            geometry.type = 'Point';\n            geometry.coordinates = lineStrings[0][0];\n            break;\n        case TileProto.GeomType.LINESTRING:\n            geometry.type = 'MultiLineString';\n            geometry.coordinates = lineStrings;\n            break;\n        case TileProto.GeomType.POLYGON:\n            geometry.type = 'Polygon';\n            geometry.coordinates = lineStrings;\n            break;\n        default:\n    }\n    return geometry;\n}\n\nfunction parseFeatures(layer, coordinatesScale) {\n    const features = [];\n    for (let feature of layer.features) {\n        const geometry = parseGeometry(feature.type, feature.geometry, coordinatesScale);\n        features.push({geometry});\n    }\n    return features;\n}\n\nfunction decodeMvt(ar, tileExtent = 256) {\n    const\n        pbf = new Pbf(new Uint8Array(ar)),\n        tileData = TileProto.read(pbf);\n    const parsedLayers = [];\n    for (let layer of tileData.layers) {\n        let scale = tileExtent / layer.extent;\n        parsedLayers.push({\n            name: layer.name,\n            features: parseFeatures(layer, scale)\n        });\n    }\n    return parsedLayers;\n}\n\nexport {decodeMvt};\n","// code generated by pbf v3.0.5\n\n// Tile ========================================\n\nvar Tile = exports.Tile = {};\n\nTile.read = function (pbf, end) {\n    return pbf.readFields(Tile._readField, {layers: []}, end);\n};\nTile._readField = function (tag, obj, pbf) {\n    if (tag === 3) obj.layers.push(Tile.Layer.read(pbf, pbf.readVarint() + pbf.pos));\n};\n\nTile.GeomType = {\n    \"UNKNOWN\": 0,\n    \"POINT\": 1,\n    \"LINESTRING\": 2,\n    \"POLYGON\": 3\n};\n\n\n// Tile.Feature ========================================\n\nTile.Feature = {};\n\nTile.Feature.read = function (pbf, end) {\n    return pbf.readFields(Tile.Feature._readField, {id: 0, tags: [], type: 0, geometry: []}, end);\n};\nTile.Feature._readField = function (tag, obj, pbf) {\n    if (tag === 3) obj.type = pbf.readVarint();\n    else if (tag === 4) pbf.readPackedVarint(obj.geometry);\n};\n\n// Tile.Layer ========================================\n\nTile.Layer = {};\n\nTile.Layer.read = function (pbf, end) {\n    return pbf.readFields(Tile.Layer._readField, {version: 0, name: \"\", features: [], keys: [], values: [], extent: 0}, end);\n};\nTile.Layer._readField = function (tag, obj, pbf) {\n    if (tag === 15) obj.version = pbf.readVarint();\n    else if (tag === 1) obj.name = pbf.readString();\n    else if (tag === 2) obj.features.push(Tile.Feature.read(pbf, pbf.readVarint() + pbf.pos));\n    else if (tag === 5) obj.extent = pbf.readVarint();\n};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {MultiLayer, WikimediaVectorCoverage} from './coverage-layer';\nimport {fetch} from '~/lib/xhr-promise';\nimport './style.css';\nimport '../common/style.css';\nimport config from '~/config';\n\nfunction getCoverageLayer(options) {\n    const url = config.wikimediaCommonsCoverageUrl;\n    return new MultiLayer([\n        {layer: L.tileLayer(url, L.extend({}, options, {tms: true})), minZoom: 0, maxZoom: 10},\n        {layer: new WikimediaVectorCoverage(url, options), minZoom: 11, maxZoom: 18}\n    ]);\n}\n\nfunction parseSearchResponse(resp) { // eslint-disable-line complexity\n    const images = [];\n    if (resp && resp.query && resp.query.pages && resp.query.pages) {\n        for (let page of Object.values(resp.query.pages)) {\n            if (!page.coordinates || page.title.slice(-4).toLowerCase() !== '.jpg') {\n                continue;\n            }\n\n            const iinfo = page.imageinfo[0];\n            let imageDescription = iinfo.extmetadata.ImageDescription ? iinfo.extmetadata.ImageDescription.value : null;\n            let objectDescription = iinfo.extmetadata.ObjectName ? iinfo.extmetadata.ObjectName.value : null;\n            if (imageDescription && /^<table (.|\\n)+<\\/table>$/u.test(imageDescription)) {\n                imageDescription = null;\n            }\n            if (imageDescription) {\n                imageDescription = imageDescription.replace(/<[^>]+>/ug, '');\n                imageDescription = imageDescription.replace(/[\\n\\r]/ug, '');\n            }\n            if (\n                imageDescription &&\n                objectDescription &&\n                objectDescription.toLowerCase().includes(imageDescription.toLowerCase())\n            ) {\n                imageDescription = null;\n            }\n            if (\n                objectDescription &&\n                imageDescription &&\n                imageDescription.toLowerCase().includes(objectDescription.toLowerCase())\n            ) {\n                objectDescription = null;\n            }\n            let description = 'Wikimedia commons';\n            if (objectDescription || imageDescription) {\n                description = '';\n                if (objectDescription) {\n                    description = objectDescription;\n                }\n                if (imageDescription) {\n                    // eslint-disable-next-line max-depth\n                    if (objectDescription) {\n                        description += '</br>';\n                    }\n                    description += imageDescription;\n                }\n            }\n\n            let author = iinfo.extmetadata.Artist ? iinfo.extmetadata.Artist.value : null;\n            if (author && /^<table (.|\\n)+<\\/table>$/u.test(author)) {\n                author = `See author info at <a href=\"${iinfo.descriptionurl}\">Wikimedia commons</a>`;\n            }\n\n            // original images can be rotated, 90 degrees\n            // thumbnails are always oriented right\n            // so we request thumbnail of original image size\n            let url = iinfo.thumburl.replace('134px', `${iinfo.width}px`);\n            images.push({\n                url,\n                width: iinfo.width,\n                height: iinfo.height,\n                lat: page.coordinates[0].lat,\n                lng: page.coordinates[0].lon,\n                author: author,\n                timeOriginal: iinfo.extmetadata.DateTimeOriginal ? iinfo.extmetadata.DateTimeOriginal.value : null,\n                time: iinfo.extmetadata.DateTime ? iinfo.extmetadata.DateTime.value : null,\n                description: description,\n                pageUrl: iinfo.descriptionurl,\n                pageId: page.pageid.toString()\n            });\n        }\n        if (images.length) {\n            return images;\n        }\n    }\n    return null;\n}\n\nfunction isCloser(target, a, b) {\n    const d1 = target.distanceTo(a);\n    const d2 = target.distanceTo(b);\n    if (d1 < d2) {\n        return -1;\n    } else if (d1 === d2) {\n        return 0;\n    }\n    return 1;\n}\n\nasync function getPanoramaAtPos(latlng, searchRadiusMeters) {\n    latlng = L.latLng(latlng.lat, latlng.lng); // make independent copy\n\n    const clusterSize = 10;\n    const urlTemplate = 'https://commons.wikimedia.org/w/api.php?' +\n                        'origin=*&format=json&action=query&generator=geosearch&' +\n                        'ggsprimary=all&ggsnamespace=6&ggslimit=10&iilimit=1&coprimary=all&' +\n                        'ggsradius={radius}&ggscoord={lat}|{lng}&' +\n                        'iiurlwidth=134&' +\n                        'prop=imageinfo|coordinates&' +\n                        'iiprop=url|mime|size|extmetadata|commonmetadata|metadata';\n    searchRadiusMeters += clusterSize;\n    if (searchRadiusMeters < 10) {\n        searchRadiusMeters = 10;\n    }\n    if (searchRadiusMeters > 10000) {\n        searchRadiusMeters = 10000;\n    }\n    const url = L.Util.template(urlTemplate, {lat: latlng.lat, lng: latlng.lng, radius: Math.ceil(searchRadiusMeters)});\n    const resp = await fetch(url, {responseType: 'json', timeout: 10000});\n    if (resp.status === 200) {\n        let photos = parseSearchResponse(resp.responseJSON);\n        if (photos) {\n            photos.sort(isCloser.bind(null, latlng));\n            const nearestLatlng = L.latLng(photos[0].lat, photos[0].lng);\n            photos = photos.filter((photo) => nearestLatlng.distanceTo(L.latLng(photo.lat, photo.lng)) <= clusterSize);\n            return {\n                found: true,\n                data: photos\n            };\n        }\n        return {found: false};\n    }\n    return {found: false};\n}\n\nfunction formatDateTime(dateStr) {\n    const m = /^(\\d+)-(\\d+)-(\\d+)/u.exec(dateStr);\n    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n    if (m) {\n        let [year, month, day] = m.slice(1);\n        return `${day} ${months[month - 1]} ${year}`;\n    }\n    return dateStr;\n}\n\nconst Viewer = L.Evented.extend({\n    initialize: function(container) {\n        container = L.DomUtil.create('div', 'wikimedia-viewer-container', container);\n        const mapContainer = this.mapContainer = L.DomUtil.create('div', 'wikimedia-viewer-map-container', container);\n        this.pageButtonContainer = L.DomUtil.create('div', 'wikimedia-viewer-page-buttons-container', container);\n\n        this.map = L.map(mapContainer, {\n            maxBoundsViscosity: 1,\n            crs: L.CRS.Simple,\n            zoomControl: false,\n            attributionControl: false,\n            zoomSnap: 0,\n        });\n\n        this.map.on('zoomend', this.notifyChange, this);\n        this.map.on('moveend', this.notifyChange, this);\n\n        this.infoLabel = L.DomUtil.create('div', 'wikimedia-viewer-info-overlay', mapContainer);\n        this.closeButton = L.DomUtil.create('div', 'photo-viewer-button-close', container);\n        this.prevPhotoButton = L.DomUtil.create('div', 'wikimedia-viewer-button-prev', mapContainer);\n        this.nextPhotoButton = L.DomUtil.create('div', 'wikimedia-viewer-button-next', mapContainer);\n        L.DomEvent.on(this.prevPhotoButton, 'click', () => {\n            this.switchPhoto(this._imageIdx - 1);\n        });\n        L.DomEvent.on(this.nextPhotoButton, 'click', () => {\n            this.switchPhoto(this._imageIdx + 1);\n        });\n        L.DomEvent.on(this.closeButton, 'click', this.onCloseClick, this);\n    },\n\n    setupPageButtons: function(count) {\n        if (this._buttons) {\n            for (let button of this._buttons) {\n                this.pageButtonContainer.removeChild(button);\n            }\n        }\n        this._buttons = [];\n        if (count > 1) {\n            L.DomUtil.addClass(this.pageButtonContainer, 'enabled');\n\n            for (let i = 0; i < count; i++) {\n                let button = L.DomUtil.create('div', 'wikimedia-viewer-page-button', this.pageButtonContainer);\n                button.innerHTML = String(i + 1);\n                this._buttons.push(button);\n                L.DomEvent.on(button, 'click', () => this.switchPhoto(i));\n            }\n        } else {\n            L.DomUtil.removeClass(this.pageButtonContainer, 'enabled');\n        }\n    },\n\n    switchPhoto: function(imageIdx, imagePos = null) {\n        this._imageIdx = imageIdx;\n        if (this.imageLayer) {\n            this.map.removeLayer(this.imageLayer);\n        }\n        let image = this.images[imageIdx];\n        let mapSize = this.map.getSize();\n        if (!mapSize.x || !mapSize.y) {\n            mapSize = {x: 500, y: 500};\n        }\n        let maxZoom = Math.log2(Math.max(image.width / mapSize.x, image.height / mapSize.y)) + 2;\n        if (maxZoom < 1) {\n            maxZoom = 1;\n        }\n        let\n            southWest = this.map.unproject([0, image.height], maxZoom - 2),\n            northEast = this.map.unproject([image.width, 0], maxZoom - 2);\n        const bounds = new L.LatLngBounds(southWest, northEast);\n        this.map.setMaxZoom(maxZoom);\n        this.map.setMaxBounds(bounds);\n        if (imagePos) {\n            this.map.setView(imagePos.center, imagePos.zoom, {animate: false});\n        } else {\n            this.map.fitBounds(bounds, {animate: false});\n        }\n\n        this.imageLayer = L.imageOverlay(null, bounds);\n        L.DomUtil.addClass(this.mapContainer, 'loading');\n        this.imageLayer.on('load', () => {\n            L.DomUtil.removeClass(this.mapContainer, 'loading');\n        });\n        this.imageLayer.setUrl(image.url);\n        this.imageLayer.addTo(this.map);\n        let caption = [];\n\n        if (image.timeOriginal) {\n            caption.push(formatDateTime(image.timeOriginal));\n        }\n        if (image.author) {\n            caption.push(image.author);\n        }\n        caption.push(`<a href=\"${image.pageUrl}\">${image.description}</a>`);\n        caption = caption.join('</br>');\n        this.infoLabel.innerHTML = caption;\n\n        if (imageIdx > 0) {\n            L.DomUtil.addClass(this.prevPhotoButton, 'enabled');\n        } else {\n            L.DomUtil.removeClass(this.prevPhotoButton, 'enabled');\n        }\n        if (imageIdx < this.images.length - 1) {\n            L.DomUtil.addClass(this.nextPhotoButton, 'enabled');\n        } else {\n            L.DomUtil.removeClass(this.nextPhotoButton, 'enabled');\n        }\n        for (let [i, button] of this._buttons.entries()) {\n            ((i === imageIdx) ? L.DomUtil.addClass : L.DomUtil.removeClass)(button, 'active');\n        }\n        this.notifyChange();\n    },\n\n    notifyChange: function() {\n        if (this.images && this._active) {\n            const image = this.images[this._imageIdx];\n            this.fire('change', {\n                    latlng: L.latLng(image.lat, image.lng),\n                    latlngs: this.images.map((image) => L.latLng(image.lat, image.lng))\n                }\n            );\n        }\n    },\n\n    _showPano: function(images, imageIdx = 0, imagePos = null) {\n        this.images = images;\n        this.setupPageButtons(images.length);\n        this.switchPhoto(imageIdx, imagePos);\n    },\n\n    showPano: function(images) {\n        this._showPano(images);\n    },\n\n    onCloseClick: function() {\n        this.fire('closeclick');\n    },\n\n    activate: function() {\n        this._active = true;\n    },\n\n    deactivate: function() {\n        this._active = false;\n    },\n\n    setState: function(state) {\n        const lat = parseFloat(state[0]);\n        const lng = parseFloat(state[1]);\n        const pageId = state[2];\n        const y = parseFloat(state[3]);\n        const x = parseFloat(state[4]);\n        const zoom = parseFloat(state[5]);\n        if (!isNaN(lat) && !isNaN(lng) && !isNaN(x) && !isNaN(y) && !isNaN(zoom)) {\n            let imageIdx = -1;\n            getPanoramaAtPos({lat, lng}, 0).then((resp) => {\n                if (!resp.found) {\n                    return;\n                }\n                for (let [i, image] of resp.data.entries()) {\n                    if (image.pageId === pageId) {\n                        imageIdx = i;\n                        break;\n                    }\n                }\n                if (imageIdx > -1) {\n                    this._showPano(resp.data, imageIdx, {center: L.latLng(y, x), zoom});\n                }\n            });\n            return true;\n        }\n        return false;\n    },\n\n    getState: function() {\n        if (!this.images) {\n            return [];\n        }\n        const center = this.map.getCenter();\n        return [\n            this.images[0].lat.toFixed(6),\n            this.images[0].lng.toFixed(6),\n            this.images[this._imageIdx].pageId,\n            center.lat.toFixed(2),\n            center.lng.toFixed(2),\n            this.map.getZoom().toFixed(1)\n        ];\n    },\n\n    invalidateSize: function() {\n        this.map.invalidateSize();\n    }\n});\n\nfunction getViewer(container) {\n    return new Viewer(container);\n}\n\nconst wikimediaProvider = {getCoverageLayer, getPanoramaAtPos, getViewer};\nexport default wikimediaProvider;\n","import L from 'leaflet';\nimport {TiledDataLoader} from '~/lib/tiled-data-loader';\n\nconst MultiLayer = L.Layer.extend({\n    initialize: function(layers) {\n        this.layers = layers;\n    },\n\n    setLayersVisibility: function(e) {\n        if (!this._map) {\n            return;\n        }\n\n        let newZoom;\n        if (e && e.zoom !== undefined) {\n            newZoom = e.zoom;\n        } else {\n            newZoom = this._map.getZoom();\n        }\n\n        for (let layer of this.layers) {\n            if (layer.minZoom <= newZoom && newZoom <= layer.maxZoom) {\n                this._map.addLayer(layer.layer);\n            } else {\n                this._map.removeLayer(layer.layer);\n            }\n        }\n    },\n\n    onAdd: function(map) {\n        this._map = map;\n        this.setLayersVisibility();\n        map.on('zoomend', this.setLayersVisibility, this);\n    },\n\n    onRemove: function() {\n        for (let layer of this.layers) {\n            this._map.removeLayer(layer.layer);\n        }\n        this._map.off('zoomend', this.setLayersVisibility, this);\n        this._map.off('zoomanim', this.setLayersVisibility, this);\n        this._map = null;\n    }\n\n});\n\nclass WikimediaLoader extends TiledDataLoader {\n    constructor(urlTemplate, zoom) {\n        super();\n        this.url = urlTemplate;\n        this.maxZoom = zoom;\n    }\n\n    getTileUrl(coords) {\n        const data = {\n            x: coords.x,\n            z: coords.z,\n            y: 2 ** coords.z - 1 - coords.y\n        };\n        return L.Util.template(this.url, data);\n    }\n\n    layerTileToDataTileCoords(layerTileCoords) {\n        let z = layerTileCoords.z;\n        let z2 = null;\n        if (z > this.maxZoom) {\n            z2 = this.maxZoom;\n        } else {\n            return {z, x: layerTileCoords.x, y: layerTileCoords.y};\n        }\n\n        let multiplier = 1 << (z - z2);\n        return {\n            x: Math.floor(layerTileCoords.x / multiplier),\n            y: Math.floor(layerTileCoords.y / multiplier),\n            z: z2\n        };\n    }\n\n    makeRequestData(dataTileCoords) {\n        return {\n            url: this.getTileUrl(dataTileCoords),\n            options: {\n                responseType: 'arraybuffer',\n                timeout: 10000,\n                isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 404\n            }\n        };\n    }\n\n    async processResponse(xhr, originalDataTileCoords) {\n        let tileData;\n        if (originalDataTileCoords.z >= this.maxZoom && xhr.status === 200 && xhr.response) {\n            tileData = new Uint16Array(xhr.response);\n        } else {\n            tileData = null;\n        }\n\n        return {\n            tileData,\n            coords: originalDataTileCoords\n        };\n    }\n}\n\nconst WikimediaVectorCoverage = L.GridLayer.extend({\n        options: {\n            tileSize: 256,\n            // updateWhenIdle: true,\n            color: '#ff00ff',\n        },\n\n        initialize: function(url, options) {\n            L.GridLayer.prototype.initialize.call(this, options);\n            this.loader = new WikimediaLoader(url, 11);\n        },\n\n        onAdd: function(map) {\n            L.GridLayer.prototype.onAdd.call(this, map);\n            this.on('tileunload', this.onTileUnload, this);\n        },\n\n        onRemove: function(map) {\n            L.GridLayer.prototype.onRemove.call(this, map);\n            this.off('tileunload', this.onTileUnload, this);\n        },\n\n        onTileUnload: function(e) {\n            const tile = e.tile;\n            tile._abortLoading();\n            delete tile._tileData;\n            delete tile._adjustment;\n        },\n\n        drawTile: function(canvas, _unused_coords) {\n            if (!this._map) {\n                return;\n            }\n            if (!canvas._tileData) {\n                return;\n            }\n            const dataOffset = 5000;\n            const dataExtent = 65535 - 2 * dataOffset;\n            const tileData = canvas._tileData;\n            let {multiplier, offsetX, offsetY} = canvas._adjustment;\n            const canvasCtx = canvas.getContext('2d');\n            const pixelScale = multiplier * 256 / dataExtent;\n            canvasCtx.fillStyle = this.options.color;\n            for (let i = 0, l = tileData.length; i < l; i += 2) {\n                let x = (tileData[i] - dataOffset) * pixelScale - offsetX * 256;\n                let y = (tileData[i + 1] - dataOffset) * pixelScale - offsetY * 256;\n                canvasCtx.beginPath();\n                canvasCtx.arc(x, y, 5, 0, 2 * Math.PI);\n                canvasCtx.fill();\n            }\n        },\n\n        createTile: function(coords, done) {\n            const canvas = L.DomUtil.create('canvas', 'leaflet-tile');\n            canvas.width = this.options.tileSize;\n            canvas.height = this.options.tileSize;\n            let {dataPromise, abortLoading} = this.loader.requestTileData(coords);\n            dataPromise.then((data) => {\n                if (!data.error) {\n                    canvas._tileData = data.tileData;\n                    canvas._adjustment = data.adjustment || {multiplier: 1, offsetX: 0, offsetY: 0};\n                    setTimeout(() => {\n                        this.drawTile(canvas, coords);\n                        done(null, canvas);\n                    }, 1);\n                }\n            });\n\n            canvas._abortLoading = abortLoading;\n            return canvas;\n        },\n    }\n);\n\nexport {MultiLayer, WikimediaVectorCoverage};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {getSMap} from './apiLoader';\nimport {CloseButtonMixin, DateLabelMixin} from '../common';\n\nfunction getCoverageLayer(options) {\n    return L.tileLayer('https://mapserver.mapy.cz/panorama_hybrid-m/{z}-{x}-{y}', options);\n}\n\nasync function getPanoramaAtPos(latlng, searchRadiusMeters) {\n    const smap = await getSMap();\n    const request = smap.Pano.getBest(smap.Coords.fromWGS84(latlng.lng, latlng.lat), searchRadiusMeters);\n    try {\n        return {\n            found: true,\n            data: await request,\n        };\n    } catch (e) {\n        return {found: false};\n    }\n}\n\nconst Viewer = L.Evented.extend({\n    includes: [CloseButtonMixin, DateLabelMixin],\n\n    initialize: function(smap, container) {\n        // Disable keyboard events for panorama as they  conflict with other hotkeys.\n        const orig_windowAddEventListener = window.addEventListener;\n        window.addEventListener = (function(type, ...args) {\n            if (!/^key/u.test(type)) {\n                orig_windowAddEventListener(type, ...args);\n            }\n        });\n        this.panorama = new smap.Pano.Scene(container);\n        window.addEventListener = orig_windowAddEventListener;\n        this.createDateLabel(container);\n        this.createCloseButton(container);\n        window.addEventListener('resize', this.resize.bind(this));\n        this.invalidateSize = L.Util.throttle(this._invalidateSize, 100, this);\n    },\n\n    showPano: function(data) {\n        const yaw = this.panorama.getCamera().yaw;\n        this.panorama.show(data, {yaw});\n        this.panorama.setCamera({fov: 1.256637061});\n        this.updatePositionAndView();\n        this.updateDateLabel();\n    },\n\n    activate: function() {\n        this._active = true;\n        this.resize();\n        if (!this._updateHandler) {\n            this._updateHandler = setInterval(() => this.updatePositionAndView(), 200);\n        }\n    },\n\n    deactivate: function() {\n        this._active = false;\n        if (this._updateHandler) {\n            clearInterval(this._updateHandler);\n            this._updateHandler = null;\n        }\n    },\n\n    getState: function() {\n        const camera = this.panorama.getCamera();\n        const place = this.panorama.getPlace();\n        if (!place) {\n            return null;\n        }\n        const coords = place.getCoords().toWGS84();\n        return [\n            coords[1].toFixed(6),\n            coords[0].toFixed(6),\n            camera.yaw.toFixed(4),\n            camera.pitch.toFixed(4),\n            camera.fov.toFixed(4),\n        ];\n    },\n\n    setState: function(state) {\n        const lat = parseFloat(state[0]);\n        const lng = parseFloat(state[1]);\n        const yaw = parseFloat(state[2]);\n        const pitch = parseFloat(state[3]);\n        const fov = parseFloat(state[4]);\n        if (!isNaN(lat) && !isNaN(lng) && !isNaN(yaw) && !isNaN(pitch) && !isNaN(fov)) {\n            getPanoramaAtPos({lat, lng}, 0).then(({data, found}) => {\n                if (found) {\n                    this.panorama.show(data, {yaw, pitch, fov});\n                    this.panorama.setCamera({yaw, pitch, fov});\n                    this.updateDateLabel();\n                }\n            });\n            return true;\n        }\n        return false;\n    },\n\n    resize: function() {\n        this.panorama.syncPort();\n    },\n\n    updatePositionAndView: function() {\n        const place = this.panorama.getPlace();\n        if (!place) {\n            return;\n        }\n        const oldPlaceId = this._placeId;\n        const oldHeading = this._heading;\n        this._placeId = place.getId();\n        this._heading = this.panorama.getCamera().yaw;\n        const placeIdChanged = this._placeId !== oldPlaceId;\n        const headingChanged = this._heading !== oldHeading;\n        if (placeIdChanged) {\n            this.updateDateLabel();\n        }\n        if (placeIdChanged || headingChanged) {\n            const coords = place.getCoords().toWGS84();\n            this.fire('change', {\n                latlng: L.latLng(coords[1], coords[0]),\n                heading: (this._heading * 180) / Math.PI,\n            });\n        }\n    },\n\n    updateDateLabel: function() {\n        const place = this.panorama.getPlace();\n        const timestamp = Date.parse(place.getDate());\n        DateLabelMixin.updateDateLabel.call(this, timestamp);\n    },\n\n    _invalidateSize: function() {\n        this.panorama.syncPort();\n    }\n});\n\nasync function getViewer(container) {\n    const smap = await getSMap();\n    return new Viewer(smap, container);\n}\n\nconst mapyczProvider = {getCoverageLayer, getPanoramaAtPos, getViewer};\nexport default mapyczProvider;\n","import loadScript from 'load-script';\n\nlet _smap = null;\nlet _pending = null;\n\nfunction getLoader() {\n    const loaderUrl = 'https://api.mapy.cz/loader.js';\n    return new Promise((resolve, reject) => {\n        loadScript(loaderUrl, (error) => {\n            if (error) {\n                reject(error);\n            } else {\n                resolve(window.Loader);\n            }\n        });\n    });\n}\n\nfunction loadApi(loader) {\n    return new Promise((resolve) => {\n        loader.async = true;\n        loader.load(null, {pano: true}, () => {\n            resolve(window.SMap);\n        });\n    });\n}\n\nfunction getSMap() {\n    if (_smap) {\n        return _smap;\n    }\n    if (!_pending) {\n        _pending = getLoader().then((loader) => loadApi(loader));\n    }\n    return _pending;\n}\n\nexport {getSMap};\n","// extracted by mini-css-extract-plugin\nexport {};","import {arrayBufferToString} from '~/lib/binary-strings';\n\nconst selectFiles = (() => {\n    let fileInput;\n    return function selectFiles(multiple = false) {\n        if (fileInput) {\n            document.body.removeChild(fileInput);\n        }\n        fileInput = document.createElement('input');\n        document.body.appendChild(fileInput);\n        fileInput.type = 'file';\n        fileInput.multiple = Boolean(multiple);\n        fileInput.style.display = 'none';\n\n        const result = new Promise(function(resolve) {\n                fileInput.addEventListener('change', function() {\n                        resolve(fileInput.files);\n                    }\n                );\n            }\n        );\n        fileInput.click();\n        return result;\n    };\n})();\n\nfunction readFile(file) {\n    return new Promise(function(resolve) {\n            var reader = new FileReader();\n            reader.onload = function(e) {\n                resolve({\n                        data: arrayBufferToString(e.target.result),\n                        filename: file.name\n                    }\n                );\n            };\n            reader.readAsArrayBuffer(file);\n        }\n    );\n}\n\nfunction readFiles(files) {\n    files = Array.prototype.slice.apply(files);\n    return Promise.all(files.map(readFile));\n}\n\nexport {selectFiles, readFiles};\n","import parseGpx from './gpx';\nimport parseZip from './zip';\nimport {parseKmz, parseKml} from './kml';\nimport {parseOziPlt, parseOziRte, parseOziWpt} from './ozi';\n\nconst parsers = [\n    parseKmz,\n    parseZip,\n    parseGpx,\n    parseOziRte,\n    parseOziPlt,\n    parseOziWpt,\n    parseKml,\n];\n\nexport default parsers;\n","import {JSUnzip} from '~/vendored/github.com/augustl/js-unzip/js-unzip';\nimport jsInflate from './jsInflate';\nimport {decode866} from './codePages';\nimport parseGeoFile from '../parseGeoFile';\n\nfunction parseZip(txt, _unused_name) {\n    let unzipper;\n    try {\n        unzipper = new JSUnzip(txt);\n    } catch (e) {\n        return null;\n    }\n    if (!unzipper.isZipFile()) {\n        return null;\n    }\n    try {\n        unzipper.readEntries();\n    } catch (e) {\n        return null;\n    }\n    var geodata_array = [];\n    for (var i = 0; i < unzipper.entries.length; i++) {\n        var entry = unzipper.entries[i];\n        var uncompressed;\n        if (entry.compressionMethod === 0) {\n            uncompressed = entry.data;\n        } else if (entry.compressionMethod === 8) {\n            uncompressed = jsInflate(entry.data, entry.uncompressedSize);\n        } else {\n            return null;\n        }\n        var file_name = decode866(entry.fileName);\n        var geodata = parseGeoFile(file_name, uncompressed);\n        for (let item of geodata) {\n            if (item.error === 'UNSUPPORTED' && item.name.match(/(\\.(pdf|doc|txt|jpg))|\\/$/ui)) {\n                continue;\n            }\n            geodata_array.push(item);\n        }\n    }\n    return geodata_array;\n}\n\nexport default parseZip;\n","import {decode as utf8_decode} from 'utf8';\nimport {xmlGetNodeText} from './xmlUtils';\nimport stripBom from '~/lib/stripBom';\nimport JSUnzip from '~/vendored/github.com/augustl/js-unzip/js-unzip';\nimport jsInflate from './jsInflate';\n\nfunction parseKml(txt, name) {\n    var error;\n    function getSegmentPoints(coordinates_element) {\n        // convert multiline text value of tag to single line\n        var coordinates_string = xmlGetNodeText(coordinates_element);\n        var points_strings = coordinates_string.split(/\\s+/u);\n        var points = [];\n        for (var i = 0; i < points_strings.length; i++) {\n            if (points_strings[i].length) {\n                var point = points_strings[i].split(',');\n                var lat = parseFloat(point[1]);\n                var lng = parseFloat(point[0]);\n                if (isNaN(lat) || isNaN(lng)) {\n                    error = 'CORRUPT';\n                    break;\n                }\n                points.push({lat: lat, lng: lng});\n            }\n        }\n        return points;\n    }\n\n    function getTrackSegments(xml) {\n        var segments_elements = xml.getElementsByTagName('LineString');\n        var segments = [];\n        for (var i = 0; i < segments_elements.length; i++) {\n            var coordinates_element = segments_elements[i].getElementsByTagName('coordinates');\n            if (coordinates_element.length) {\n                var segment_points = getSegmentPoints(coordinates_element[0]);\n                if (segment_points.length) {\n                    segments.push(segment_points);\n                }\n            }\n        }\n        return segments;\n    }\n\n    function getPoints(dom) {\n        var points = [],\n            placemarks, i, coord, name, lat, lng, pointObjs;\n        placemarks = dom.getElementsByTagName('Placemark');\n        for (i = 0; i < placemarks.length; i++) {\n            pointObjs = placemarks[i].getElementsByTagName('Point');\n            if (pointObjs.length === 0) {\n                continue;\n            } else if (pointObjs.length > 1) {\n                error = 'CORRUPT';\n                break;\n            }\n            coord = pointObjs[0].getElementsByTagName('coordinates');\n            if (coord.length !== 1) {\n                error = 'CORRUPT';\n                break;\n            }\n            coord = xmlGetNodeText(coord[0]);\n            coord = coord.split(',');\n            lat = parseFloat(coord[1]);\n            lng = parseFloat(coord[0]);\n            if (isNaN(lat) || isNaN(lng)) {\n                error = 'CORRUPT';\n                break;\n            }\n            name = '';\n            const nameTags = placemarks[i].getElementsByTagName('name');\n            if (nameTags[0]) {\n                try {\n                    name = xmlGetNodeText(nameTags[0]);\n                    name = utf8_decode(name);\n                } catch (e) {\n                    error = 'CORRUPT';\n                }\n            }\n            points.push({\n                    name: name,\n                    lat: lat,\n                    lng: lng\n                }\n            );\n        }\n        return points;\n    }\n\n    txt = stripBom(txt);\n    txt = txt.replace(/<([^ >]+):([^ >]+)/ug, '<$1_$2');\n    let dom;\n    try {\n        dom = (new DOMParser()).parseFromString(txt, \"text/xml\");\n    } catch (e) {\n        return null;\n    }\n    if (dom.documentElement.nodeName === 'parsererror') {\n        return null;\n    }\n    if (dom.getElementsByTagName('kml').length === 0) {\n        return null;\n    }\n\n    return [{name: name, tracks: getTrackSegments(dom), points: getPoints(dom), error: error}];\n}\n\nfunction parseKmz(txt, name) {\n    var uncompressed;\n    let unzipper;\n    try {\n        unzipper = new JSUnzip(txt);\n    } catch (e) {\n        return null;\n    }\n    var tracks = [],\n        points = [],\n        geodata,\n        error;\n    var hasDocKml = false;\n    if (!unzipper.isZipFile()) {\n        return null;\n    }\n    try {\n        unzipper.readEntries();\n    } catch (e) {\n        return null;\n    }\n    var i, entry;\n    for (i = 0; i < unzipper.entries.length; i++) {\n        entry = unzipper.entries[i];\n        if (entry.fileName === 'doc.kml') {\n            hasDocKml = true;\n            break;\n        }\n    }\n    if (!hasDocKml) {\n        return null;\n    }\n\n    for (i = 0; i < unzipper.entries.length; i++) {\n        entry = unzipper.entries[i];\n        if (entry.fileName.match(/\\.kml$/iu)) {\n            if (entry.compressionMethod === 0) {\n                uncompressed = entry.data;\n            } else if (entry.compressionMethod === 8) {\n                uncompressed = jsInflate(entry.data, entry.uncompressedSize);\n            } else {\n                return null;\n            }\n            geodata = parseKml(uncompressed, 'dummmy');\n            if (geodata) {\n                error = error || geodata[0].error;\n                tracks.push(...geodata[0].tracks);\n                points.push(...geodata[0].points);\n            }\n        }\n    }\n\n    geodata = [{name: name, error: error, tracks: tracks, points: points}];\n    return geodata;\n}\n\nexport {parseKml, parseKmz};\n","import {decodeCP1251} from './codePages';\nimport stripBom from '~/lib/stripBom';\n\nfunction parseOziRte(txt, name) {\n    let error,\n        segments = [];\n    txt = stripBom(txt);\n    const lines = txt.split('\\n');\n    if (lines[0].indexOf('OziExplorer Route File') !== 0) {\n        return null;\n    }\n    let currentSegment = [];\n    for (let i = 4; i < lines.length; i++) {\n        let line = lines[i].trim();\n        if (!line) {\n            continue;\n        }\n        let fields = line.split(',');\n        if (fields[0] === 'R') {\n            if (currentSegment.length) {\n                segments.push(currentSegment);\n            }\n            currentSegment = [];\n        } else if (fields[0] === 'W') {\n            let lat = parseFloat(fields[5]);\n            let lng = parseFloat(fields[6]);\n            if (isNaN(lat) || isNaN(lng)) {\n                error = 'CORRUPT';\n                break;\n            }\n            currentSegment.push({lat, lng});\n        } else {\n            error = 'CORRUPT';\n            break;\n        }\n    }\n    if (currentSegment.length) {\n        segments.push(currentSegment);\n    }\n    return [{name, tracks: segments, error}];\n}\n\nfunction parseOziPlt(txt, name) {\n    var error;\n    var segments = [];\n    txt = stripBom(txt);\n    var lines = txt.split('\\n');\n    if (lines[0].indexOf('OziExplorer Track Point File') !== 0) {\n        return null;\n    }\n    var expected_points_num = parseInt(lines[5], 10);\n    var current_segment = [];\n    var total_points_num = 0;\n    for (var i = 6; i < lines.length; i++) {\n        var line = lines[i].trim();\n        if (!line) {\n            continue;\n        }\n        var fields = line.split(',');\n        var lat = parseFloat(fields[0]);\n        var lon = parseFloat(fields[1]);\n        var is_start_of_segment = parseInt(fields[2], 10);\n        if (isNaN(lat) || isNaN(lon) || isNaN(is_start_of_segment)) {\n            error = 'CORRUPT';\n            break;\n        }\n        if (is_start_of_segment) {\n            current_segment = [];\n        }\n        if (!current_segment.length) {\n            segments.push(current_segment);\n        }\n        current_segment.push({lat: lat, lng: lon});\n        total_points_num += 1;\n    }\n    if (isNaN(expected_points_num) || (expected_points_num !== 0 && expected_points_num !== total_points_num)) {\n        error = 'CORRUPT';\n    }\n    return [{name: name, tracks: segments, error: error}];\n}\n\nfunction parseOziWpt(txt, name) {\n    var points = [],\n        error,\n        lines, line,\n        i,\n        lat, lng, pointName, fields;\n    txt = stripBom(txt);\n    lines = txt.split('\\n');\n    if (lines[0].indexOf('OziExplorer Waypoint File') !== 0) {\n        return null;\n    }\n    for (i = 4; i < lines.length; i++) {\n        line = lines[i].trim();\n        if (!line) {\n            continue;\n        }\n        fields = line.split(',');\n        lat = parseFloat(fields[2]);\n        lng = parseFloat(fields[3]);\n        pointName = decodeCP1251(fields[1]).trim();\n        if (isNaN(lat) || isNaN(lng)) {\n            error = 'CORRUPT';\n            break;\n        }\n        points.push({\n                lat: lat,\n                lng: lng,\n                name: pointName\n            }\n        );\n    }\n    return [{name: name, points: points, error: error}];\n}\n\nexport {parseOziPlt, parseOziRte, parseOziWpt};\n","import SimpleService from './simpleService';\nimport Endomondo from './endomondo';\nimport Etomesto from './etomesto';\nimport Gpsies from './gpsies';\nimport Gpslib from './gpslib';\nimport Osm from './osm';\nimport Strava from './strava';\nimport Tracedetrail from './tracedetrail';\nimport {YandexRuler} from './yandex';\nimport {NakarteTrack, NakarteUrl} from './nakarte';\nimport {MovescountMove, MovescountRoute} from './movescount';\nimport {GarminActivity, GarminRoute} from './garmin';\nimport {SportsTrackerActivity} from './sportstracker';\nimport OpenStreetMapRu from './openstreetmapRu';\n\nconst services = [\n    YandexRuler,\n    NakarteTrack,\n    NakarteUrl,\n    Endomondo,\n    Etomesto,\n    Gpsies,\n    Gpslib,\n    Osm,\n    Strava,\n    Tracedetrail,\n    MovescountMove,\n    MovescountRoute,\n    GarminActivity,\n    GarminRoute,\n    SportsTrackerActivity,\n    OpenStreetMapRu,\n    SimpleService\n];\n\nexport default services;\n","import BaseService from './baseService';\nimport parseGeoFile from '../parseGeoFile';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nclass SimpleService extends BaseService {\n    isOurUrl() {\n        return Boolean(this.origUrl.match(/^https?:\\/\\/.+/u));\n    }\n\n    requestOptions() {\n        return [{\n            url: urlViaCorsProxy(this.origUrl),\n            options: {responseType: 'binarystring'}\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        return parseGeoFile(this.nameFromUrl(response.responseURL), response.responseBinaryText);\n    }\n}\n\nexport default SimpleService;\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nclass Endomondo extends BaseService {\n    urlRegexps = [\n        /^https?:\\/\\/(?:www\\.)?endomondo\\.com\\/users\\/(\\d+)\\/workouts\\/(\\d+)/u,\n        /^https?:\\/\\/(?:www\\.)?endomondo\\.com\\/workouts\\/(\\d+)\\/(\\d+)/u\n    ];\n\n    isOurUrl() {\n        return this.urlRegexps.some((re) => re.test(this.origUrl));\n    }\n\n    requestOptions() {\n        let userId, trackId;\n        let m = this.urlRegexps[0].exec(this.origUrl);\n        if (m) {\n            [userId, trackId] = [m[1], m[2]];\n        } else {\n            m = this.urlRegexps[1].exec(this.origUrl);\n            [trackId, userId] = [m[1], m[2]];\n        }\n        return [{\n            url: urlViaCorsProxy(`https://www.endomondo.com/rest/v1/users/${userId}/workouts/${trackId}`),\n            options: {\n                responseType: 'json',\n                isResponseSuccess: (xhr) => (xhr.status === 200 || xhr.status === 404)\n            },\n\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        if (response.status === 404) {\n            return [{error: 'Invalid link or user disabled viewing this workout track'}];\n        }\n\n        const data = response.responseJSON;\n        if (!data) {\n            return [{name: 'Endomondo activity', error: 'UNSUPPORTED'}];\n        }\n        if (!data.points || !data.points.points) {\n            return [{error: 'Endomondo user disabled viewing this workout track'}];\n        }\n\n        const track = data.points.points\n            .filter((p) => p.latitude)\n            .map((p) => ({\n                        lat: p.latitude,\n                        lng: p.longitude\n            }));\n        if (track.length === 0) {\n            return [{error: 'Endomondo user disabled viewing this workout track'}];\n        }\n\n        const date = data.local_start_time.split('T')[0];\n        const dist = `${data.distance.toFixed(1)} km`;\n        let trackName = `${date}, ${dist}`;\n        if (data.author && data.author.name) {\n            trackName += ` ${data.author.name}`;\n        }\n        if (data.title) {\n            trackName += `: ${data.title}`;\n        }\n        return [{\n            name: trackName,\n            tracks: [track]\n        }];\n    }\n}\n\nexport default Endomondo;\n","import urlViaCorsProxy from '~/lib/CORSProxy';\nimport BaseService from './baseService';\nimport parseGpx from '../parsers/gpx';\n\nclass Etomesto extends BaseService {\n    urlRe = /^https?:\\/\\/(?:www\\.)?etomesto\\.ru\\/track([a-z0-9]+)/u;\n\n    getTrackId() {\n        const m = this.urlRe.exec(this.origUrl);\n        return m[1];\n    }\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const trackId = this.getTrackId();\n        return [{\n            url: urlViaCorsProxy(`http://www.etomesto.ru/save/${trackId}.gpx`),\n            options: {\n                responseType: 'binarystring',\n                isResponseSuccess: (xhr) => (\n                    xhr.status === 200 &&\n                    !xhr.responseBinaryText.startsWith('ERROR'))\n            }\n        }];\n    }\n\n    parseResponse(responses) {\n        const trackId = this.getTrackId();\n        const response = responses[0];\n        const name = `Etomesto track ${trackId}`;\n        return parseGpx(response.responseBinaryText, name, true) || [{name: name, error: 'UNSUPPORTED'}];\n    }\n}\n\nexport default Etomesto;\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\nimport parseGpx from '../parsers/gpx';\nimport urlEncode from './urlEncode';\n\nclass Gpsies extends BaseService {\n    urlRe = /^https?:\\/\\/www\\.gpsies\\.com\\/map\\.do[^?]*\\?fileId=([a-z]+)/u;\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = m[1];\n        const newUrl = urlViaCorsProxy('https://www.gpsies.com/download.do');\n        return [{\n            url: newUrl,\n            options: {\n                method: 'POST',\n                data: urlEncode({\n                        fileId: trackId,\n                        speed: '10',\n                        dataType: '3',\n                        filetype: 'gpxTrk',\n                        submitButton: '',\n                        inappropriate: ''\n                    }\n                ),\n                headers: [[\"Content-type\", \"application/x-www-form-urlencoded\"]],\n                responseType: 'binarystring'\n            }\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        return parseGpx(response.responseBinaryText, this.nameFromUrl(response.responseURL), true) ||\n            [{name: name, error: 'UNSUPPORTED'}];\n    }\n}\n\nexport default Gpsies;\n","function urlEncode(d) {\n    return Object.entries(d).map(([k, v]) => `${k}=${encodeURIComponent(v)}`).join('&');\n}\n\nexport default urlEncode;\n","import urlViaCorsProxy from '~/lib/CORSProxy';\nimport BaseService from './baseService';\nimport parseGpx from '../parsers/gpx';\n\nclass Gpslib extends BaseService {\n    urlRe = /^https?:\\/\\/(?:.+\\.)?gpslib\\.[^.]+\\/tracks\\/info\\/(\\d+)/u;\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[1];\n        return [{\n            url: urlViaCorsProxy(`https://www.gpslib.ru/tracks/download/${trackId}.gpx`),\n            options: {responseType: 'binarystring'}\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        return parseGpx(response.responseBinaryText, `GPSLib ${this.trackId}`, true) ||\n            [{name: name, error: 'UNSUPPORTED'}];\n    }\n}\n\nexport default Gpslib;\n","import urlViaCorsProxy from '~/lib/CORSProxy';\nimport BaseService from './baseService';\nimport parseGpx from '../parsers/gpx';\n\nclass Osm extends BaseService {\n    urlRe = /^https?:\\/\\/(?:www\\.)?openstreetmap\\.org\\/user\\/(?:.*)\\/traces\\/(\\d+)/u;\n\n    getTrackId() {\n        const m = this.urlRe.exec(this.origUrl);\n        return m[1];\n    }\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const trackId = this.getTrackId();\n        return [{\n            url: urlViaCorsProxy(`https://www.openstreetmap.org/trace/${trackId}/data`),\n            options: {responseType: 'binarystring'}\n        }];\n    }\n\n    parseResponse(responses) {\n        const trackId = this.getTrackId();\n        const response = responses[0];\n        return parseGpx(response.responseBinaryText, `OSM track ${trackId}`, true) ||\n            [{name: name, error: 'UNSUPPORTED'}];\n    }\n}\n\nexport default Osm;\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nclass Strava extends BaseService {\n    urlRe = /^https?:\\/\\/(?:.+\\.)?strava\\.com\\/activities\\/(\\d+)/u;\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[1];\n        function isResponseSuccess(response) {\n            return [200, 401, 404].includes(response.status);\n        }\n        return [\n            {\n                url: urlViaCorsProxy(`https://www.strava.com/activities/${trackId}?hl=en-GB`),\n                options: {\n                    isResponseSuccess\n                }\n            },\n            {\n                url: urlViaCorsProxy(`https://www.strava.com/stream/${trackId}?streams%5B%5D=latlng`),\n                options: {\n                    responseType: 'json',\n                    isResponseSuccess\n                }\n            }\n        ];\n    }\n\n    parseResponse(responses) {\n        const statusMessages = {\n            401: 'Requested Strava activity marked as private',\n            404: 'Requested Strava activity could not be found'\n        };\n        const [pageResponse, trackResponse] = responses;\n        if (trackResponse.status !== 200) {\n            return [{error: statusMessages[trackResponse.status]}];\n        }\n        let name = `Strava ${this.trackId}`;\n        const latlngs = trackResponse.responseJSON?.latlng;\n        if (!latlngs || !Array.isArray(latlngs)) {\n            return [{name, error: 'UNSUPPORTED'}];\n        }\n        const tracks = [latlngs.map((p) => ({lat: p[0], lng: p[1]}))];\n        let dom;\n        try {\n            dom = (new DOMParser()).parseFromString(pageResponse.response, 'text/html');\n        } catch (e) {\n            // will use default name\n        }\n        if (dom) {\n            const userName = (dom.querySelector('a.minimal[href*=\"/athletes/\"]')?.textContent ?? '').trim();\n            const activityTitle = (dom.querySelector('h1.activity-name')?.textContent ?? '').trim();\n            let date = dom.querySelector('time')?.textContent ?? '';\n            date = date.split(',')[1] ?? '';\n            date = date.trim();\n            if (userName && activityTitle && date) {\n                name = `${userName} - ${activityTitle} ${date}`;\n            }\n        }\n        return [{\n            name,\n            tracks\n        }];\n    }\n}\n\nexport default Strava;\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\nimport L from 'leaflet';\n\nclass Tracedetrail extends BaseService {\n    urlRe = /^https?:\\/\\/(?:www\\.)?tracedetrail\\.[a-z]{2,}.*\\/trace\\/trace\\/([0-9]+)/u;\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[1];\n\n        return [{\n            url: urlViaCorsProxy(`https://tracedetrail.com/en/trace/geomSections/${trackId}`),\n            options: {responseType: 'json'}\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        let name = `Tracedetrail track ${this.trackId}`;\n        try {\n            name = response.responseJSON.nom_fr || name;\n            const geometry = JSON.parse(response.responseJSON.geometry);\n            const proj = L.CRS.EPSG3857;\n            const points = geometry.map((item) => proj.unproject(L.point(item.lon, item.lat)));\n\n            return [{\n                name,\n                tracks: [points]\n            }];\n        } catch (e) {\n            let error = 'UNSUPPORTED';\n\n            if (response.status === 200) {\n                error = `Track with id ${this.trackId} was deleted or did not exist`;\n            }\n\n            return [{name, error}];\n        }\n    }\n}\n\nexport default Tracedetrail;\n","import BaseService from './baseService';\n\nclass YandexRuler extends BaseService {\n    urlRe = /yandex\\..+[?&]rl=([^&]+)/u;\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        return [];\n    }\n\n    parseResponse() {\n        let last_lat = 0;\n        let last_lng = 0;\n        let error;\n        const points = [];\n        let s = this.urlRe.exec(this.origUrl)[1];\n        s = s.replace(/%2C/iug, ',');\n        const points_str = s.split('~');\n        for (let i = 0; i < points_str.length; i++) {\n            let point = points_str[i].split(',');\n            let lng = parseFloat(point[0]);\n            let lat = parseFloat(point[1]);\n            if (isNaN(lat) || isNaN(lng)) {\n                error = 'CORRUPT';\n                break;\n            }\n            last_lng += lng;\n            last_lat += lat;\n            points.push({lat: last_lat, lng: last_lng});\n        }\n        return [{\n            error: error,\n            tracks: [points],\n            name: 'Yandex ruler'\n        }];\n    }\n}\n\n// function parseYandexMap(txt) {\n//     var start_tag = '<script id=\"vpage\" type=\"application/json\">';\n//     var json_start = txt.indexOf(start_tag);\n//     if (json_start === -1) {\n//         return null;\n//     }\n//     json_start += start_tag.length;\n//     var json_end = txt.indexOf('</script>', json_start);\n//     if (json_end === -1) {\n//         return null;\n//     }\n//     var map_data = txt.substring(json_start, json_end);\n//     map_data = JSON.parse(map_data);\n//     console.log(map_data);\n//     if (!('request' in map_data)) {\n//         return null;\n//     }\n//     var name = 'YandexMap';\n//     var segments = [];\n//     var error;\n//     if (map_data.vpage && map_data.vpage.data && map_data.vpage.data.objects && map_data.vpage.data.objects.length) {\n//         var mapName = ('' + (map_data.vpage.data.name || '')).trim();\n//         if (mapName.length > 3) {\n//             name = '';\n//         } else if (mapName.length) {\n//             name += ': ';\n//         }\n//         name += fileutils.decodeUTF8(mapName);\n//         map_data.vpage.data.objects.forEach(function(obj){\n//             if (obj.pts && obj.pts.length) {\n//                 var segment = [];\n//                 for (var i=0; i< obj.pts.length; i++) {\n//                     var pt = obj.pts[i];\n//                     var lng = parseFloat(pt[0]);\n//                     var lat = parseFloat(pt[1]);\n//                     if (isNaN(lat) || isNaN(lng)) {\n//                         error = 'CORRUPT';\n//                         break;\n//                     }\n//                     segment.push({lat: lat, lng:lng});\n//                 }\n//                 if (segment.length) {\n//                     segments.push(segment);\n//                 }\n//             }\n//         });\n//     }\n//     if (map_data.request.args && map_data.request.args.rl) {\n//         var res = parseYandexRulerString(map_data.request.args.rl);\n//         error = error || res.error;\n//         if (res.points && res.points.length) {\n//             segments.push(res.points);\n//         }\n//     }\n//     return [{name: name, error: error, tracks: segments}];\n// }\n\nexport {YandexRuler};\n","'use strict'; // code generated by pbf v3.0.5\n\n// Segment ========================================\n\nvar self = exports;\n\nvar Segment = self.Segment = {};\n\nSegment.read = function (pbf, end) {\n    return pbf.readFields(Segment._readField, {lats: [], lons: []}, end);\n};\nSegment._readField = function (tag, obj, pbf) {\n    if (tag === 1) pbf.readPackedSVarint(obj.lats);\n    else if (tag === 2) pbf.readPackedSVarint(obj.lons);\n};\nSegment.write = function (obj, pbf) {\n    if (obj.lats) pbf.writePackedSVarint(1, obj.lats);\n    if (obj.lons) pbf.writePackedSVarint(2, obj.lons);\n};\n\n// Waypoint ========================================\n\nvar Waypoint = self.Waypoint = {};\n\nWaypoint.read = function (pbf, end) {\n    return pbf.readFields(Waypoint._readField, {lat: 0, lon: 0, name: \"\"}, end);\n};\nWaypoint._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.lat = pbf.readSVarint();\n    else if (tag === 2) obj.lon = pbf.readSVarint();\n    else if (tag === 3) obj.name = pbf.readString();\n};\nWaypoint.write = function (obj, pbf) {\n    if (obj.lat) pbf.writeSVarintField(1, obj.lat);\n    if (obj.lon) pbf.writeSVarintField(2, obj.lon);\n    if (obj.name) pbf.writeStringField(3, obj.name);\n};\n\n// Waypoints ========================================\n\nvar Waypoints = self.Waypoints = {};\n\nWaypoints.read = function (pbf, end) {\n    return pbf.readFields(Waypoints._readField, {midLat: 0, midLon: 0, waypoints: []}, end);\n};\nWaypoints._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.midLat = pbf.readSVarint();\n    else if (tag === 2) obj.midLon = pbf.readSVarint();\n    else if (tag === 3) obj.waypoints.push(Waypoint.read(pbf, pbf.readVarint() + pbf.pos));\n};\nWaypoints.write = function (obj, pbf) {\n    if (obj.midLat) pbf.writeSVarintField(1, obj.midLat);\n    if (obj.midLon) pbf.writeSVarintField(2, obj.midLon);\n    if (obj.waypoints) for (var i = 0; i < obj.waypoints.length; i++) pbf.writeMessage(3, Waypoint.write, obj.waypoints[i]);\n};\n\n// Track ========================================\n\nvar Track = self.Track = {};\n\nTrack.read = function (pbf, end) {\n    return pbf.readFields(Track._readField, {name: \"\", segments: [], waypoints: null}, end);\n};\nTrack._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.name = pbf.readString();\n    else if (tag === 2) obj.segments.push(Segment.read(pbf, pbf.readVarint() + pbf.pos));\n    else if (tag === 3) obj.waypoints = Waypoints.read(pbf, pbf.readVarint() + pbf.pos);\n};\nTrack.write = function (obj, pbf) {\n    if (obj.name) pbf.writeStringField(1, obj.name);\n    if (obj.segments) for (var i = 0; i < obj.segments.length; i++) pbf.writeMessage(2, Segment.write, obj.segments[i]);\n    if (obj.waypoints) pbf.writeMessage(3, Waypoints.write, obj.waypoints);\n};\n\n// View ========================================\n\nvar View = self.View = {};\n\nView.read = function (pbf, end) {\n    return pbf.readFields(View._readField, {color: 0, shown: false, ticksShown: false}, end);\n};\nView._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.color = pbf.readVarint(true);\n    else if (tag === 2) obj.shown = pbf.readBoolean();\n    else if (tag === 3) obj.ticksShown = pbf.readBoolean();\n};\nView.write = function (obj, pbf) {\n    if (obj.color) pbf.writeVarintField(1, obj.color);\n    if (obj.shown) pbf.writeBooleanField(2, obj.shown);\n    if (obj.ticksShown) pbf.writeBooleanField(3, obj.ticksShown);\n};\n\n// TrackView ========================================\n\nvar TrackView = self.TrackView = {};\n\nTrackView.read = function (pbf, end) {\n    return pbf.readFields(TrackView._readField, {view: null, track: null}, end);\n};\nTrackView._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.view = View.read(pbf, pbf.readVarint() + pbf.pos);\n    else if (tag === 2) obj.track = Track.read(pbf, pbf.readVarint() + pbf.pos);\n};\nTrackView.write = function (obj, pbf) {\n    if (obj.view) pbf.writeMessage(1, View.write, obj.view);\n    if (obj.track) pbf.writeMessage(2, Track.write, obj.track);\n};\n","import * as urlSafeBase64 from '../../parsers/urlSafeBase64';\nimport {TRACKLIST_TRACK_COLORS} from '../../../track-list';\nimport loadFromUrl from '../../loadFromUrl';\n\nfunction parseWaypoint(rawPoint) {\n    let name = rawPoint.n;\n    let lat = Number(rawPoint.lt);\n    let lng = Number(rawPoint.ln);\n    if (typeof name !== 'string' || !name || isNaN(lat) || isNaN(lng) ||\n        lat < -90 || lat > 90 || lng < -180 || lng > 180) {\n        return {valid: false};\n    }\n    return {\n        valid: true,\n        point: {lat, lng, name}\n    };\n}\n\nfunction parseTrack(rawTrack) {\n    if (!rawTrack.length) {\n        return {valid: false};\n    }\n    const track = [];\n    for (let rawSegment of rawTrack) {\n        let segment = [];\n        if (!rawSegment || !rawSegment.length) {\n            return {valid: false};\n        }\n        for (let rawPoint of rawSegment) {\n            if (!rawPoint || rawPoint.length !== 2) {\n                return {valid: false};\n            }\n            let [lat, lng] = rawPoint.map(Number);\n            if (isNaN(lat) || isNaN(lng) || lat < -90 || lat > 90) {\n                return {valid: false};\n            }\n            segment.push({lat, lng});\n        }\n        track.push(segment);\n    }\n    return {valid: true, track};\n}\n\nasync function loadTracksFromJson(value) { // eslint-disable-line complexity\n    const errCorrupt = [{name: 'Track in url', error: 'CORRUPT'}];\n\n    const jsonString = urlSafeBase64.decode(value);\n    let data;\n    try {\n        data = JSON.parse(jsonString);\n    } catch (e) {\n        return errCorrupt;\n    }\n    if (!data || !data.length) {\n        return errCorrupt;\n    }\n    const geoDataArray = [];\n\n    for (let el of data) {\n        // Each track should contain either url or at least one of tracks and points\n        if (!el.u && !(el.p || el.t)) {\n            return errCorrupt;\n        }\n        let geodata;\n        if (el.u) {\n            geodata = await\n                loadFromUrl(el.u);\n            if (el.n && geodata.length === 1 && !geodata[0].error) {\n                geodata[0].name = el.n;\n            }\n        } else {\n            geodata = {};\n            geodata.name = el.n || 'Track';\n            if (el.t) {\n                const res = parseTrack(el.t);\n                if (!res.valid) {\n                    return errCorrupt;\n                }\n                geodata.tracks = res.track;\n            }\n            if (el.p) {\n                geodata.points = [];\n                for (let rawPoint of el.p) {\n                    let res = parseWaypoint(rawPoint);\n                    // eslint-disable-next-line max-depth\n                    if (!res.valid) {\n                        return errCorrupt;\n                    }\n                    geodata.points.push(res.point);\n                }\n            }\n            geodata = [geodata];\n        }\n        let viewProps = {};\n        if ('c' in el) {\n            let color = Number(el.c);\n            if (color < 0 || color >= TRACKLIST_TRACK_COLORS.length) {\n                return errCorrupt;\n            }\n            viewProps.color = color;\n        }\n        if ('v' in el) {\n            viewProps.trackHidden = !el.v;\n        }\n        if ('m' in el) {\n            viewProps.measureTicksShown = Boolean(el.m);\n        }\n        geodata.forEach((el) => Object.assign(el, viewProps));\n        geoDataArray.push(...geodata);\n    }\n    return geoDataArray;\n}\n\nexport default loadTracksFromJson;\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nclass MovescountBase extends BaseService {\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n}\n\nclass MovescountRoute extends MovescountBase {\n    urlRe = /^https?:\\/\\/(?:www\\.)?movescount\\.com\\/([a-z]{2}\\/)?map.*[?&]route=(\\d+)/u;\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[2];\n        return [{\n            url: urlViaCorsProxy(`http://www.movescount.com/Move/Route/${trackId}`),\n            options: {\n                responseType: 'json',\n                isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403\n            },\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        if (response.status === 403) {\n            return [{error: 'Movescount user disabled viewing this route'}];\n        }\n        let name = `Movescount route ${this.trackId}`;\n        const data = response.responseJSON;\n        if (!data) {\n            return [{name, error: 'UNSUPPORTED'}];\n        }\n\n        let points = [];\n        let track = [];\n\n        for (let i = 0; i < data.points.latitudes.length; i++) {\n            const latlng = {\n                lat: data.points.latitudes[i],\n                lng: data.points.longitudes[i]\n            };\n            track.push(latlng);\n            const point = data.points.data[i];\n            if (point) {\n                points.push({...latlng, name: point.name});\n            }\n        }\n\n        name = data.routeName ? data.routeName : name;\n\n        return [{\n            name,\n            points,\n            tracks: [track]\n        }];\n    }\n}\n\nclass MovescountMove extends MovescountBase {\n    urlRe = /^https?:\\/\\/(?:www\\.)?movescount\\.com\\/([a-z]{2}\\/)?moves\\/move(\\d+)/u;\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[2];\n        return [\n            {\n                url: urlViaCorsProxy(`http://www.movescount.com/Move/Track2/${trackId}`),\n                options: {\n                    responseType: 'json',\n                    isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403\n                }\n            },\n            {\n                url: urlViaCorsProxy(`https://www.movescount.com/moves/move${trackId}`),\n                options: {\n                    isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403 || xhr.status === 404\n                }\n            }\n        ];\n    }\n\n    parseResponse(responses) {\n        const [trackResponse, pageResponse] = responses;\n        if (trackResponse.status === 403) {\n            return [{error: 'Movescount user disabled viewing this activity'}];\n        }\n        let name = `Movescount move ${this.trackId}`;\n        const data = trackResponse.responseJSON;\n        if (!data) {\n            return [{name, error: 'UNSUPPORTED'}];\n        }\n\n        const track = data.TrackPoints.map((trackPoint) => ({\n                lat: trackPoint.Latitude,\n                lng: trackPoint.Longitude\n            })\n        );\n\n        const dom = (new DOMParser()).parseFromString(pageResponse.response, \"text/html\");\n        try {\n            const title = dom.querySelector('title').text.trim();\n            name = title ? title : name;\n        } catch (_) {\n            // use previously constructed name\n        }\n\n        return [{\n            name,\n            tracks: [track]\n        }];\n    }\n}\n\nexport {MovescountRoute, MovescountMove};\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nclass GarminBase extends BaseService {\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n}\n\nclass GarminRoute extends GarminBase {\n    urlRe = /^https?:\\/\\/connect\\.garmin\\.com\\/modern\\/course\\/(\\d+)/u;\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[1];\n        return [{\n            url: urlViaCorsProxy(`https://connect.garmin.com/modern/proxy/course-service/course/${trackId}`),\n            options: {\n                responseType: 'json',\n                isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403 || xhr.status === 404\n            },\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        if (response.status === 403) {\n            return [{error: 'Garmin Connect user disabled viewing this route'}];\n        }\n        if (response.status === 404) {\n            return [{error: 'Garmin Connect route does not exist'}];\n        }\n        let name = `Garmin Connect route ${this.trackId}`;\n        const data = response.responseJSON;\n        if (!data) {\n            return [{name, error: 'UNSUPPORTED'}];\n        }\n        let points = data.coursePoints.map((pt) => ({name: pt.name, lat: pt.lat, lng: pt.lon}));\n        let track = data.geoPoints.map((obj) => ({lat: obj.latitude, lng: obj.longitude}));\n        name = data.courseName ? data.courseName : name;\n        return [{\n            name,\n            points,\n            tracks: [track]\n        }];\n    }\n}\n\nclass GarminActivity extends GarminBase {\n    urlRe = /^https?:\\/\\/connect\\.garmin\\.com\\/modern\\/activity\\/(\\d+)/u;\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[1];\n        return [\n            {\n                url: urlViaCorsProxy(\n                    `https://connect.garmin.com/modern/proxy/activity-service/activity/${trackId}/details`),\n                options: {\n                    responseType: 'json',\n                    isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403 || xhr.status === 404\n                }\n            }\n        ];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        if (response.status === 403) {\n            return [{error: 'Garmin Connect user disabled viewing this activity'}];\n        }\n        if (response.status === 404) {\n            return [{error: 'Garmin Connect activity does not exist'}];\n        }\n        let name = `Garmin Connect activity ${this.trackId}`;\n        const data = response.responseJSON;\n        if (!data) {\n            return [{name, error: 'UNSUPPORTED'}];\n        }\n        let track = data.geoPolylineDTO.polyline.map((obj) => ({lat: obj.lat, lng: obj.lon}));\n        return [{\n            name,\n            tracks: [track]\n        }];\n    }\n}\n\nexport {GarminRoute, GarminActivity};\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\nimport utf8 from 'utf8';\n\nclass SportsTrackerBase extends BaseService {\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n}\n\nclass SportsTrackerActivity extends SportsTrackerBase {\n    urlRe = /^https?:\\/\\/(www\\.)?sports-tracker\\.com\\/workout\\/([^/]+)\\/([a-z0-9]+)/u;\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const activityId = m[3];\n        return [\n            {\n                url: urlViaCorsProxy(\n                    `https://api.sports-tracker.com/apiserver/v1/workouts/${activityId}/data?samples=100000`\n                ),\n                options: {\n                    responseType: 'binarystring',\n                    isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403\n                }\n            },\n            {\n                url: urlViaCorsProxy(`https://api.sports-tracker.com/apiserver/v1/workouts/${activityId}/combined`),\n                options: {\n                    responseType: 'binarystring',\n                    isResponseSuccess: (xhr) => [200, 403, 404].includes(xhr.status)\n                }\n            }\n        ];\n    }\n\n    parseResponse(responses) {\n        const [dataResponse, metadataResponse] = responses;\n        if (metadataResponse.status === 404) {\n            return [{error: 'Sports Tracker activity not found'}];\n        }\n        if (dataResponse.status === 403) {\n            return [{error: 'Sports Tracker user disabled viewing this activity'}];\n        }\n        let data, metadata;\n        let name = `Sports Tracker activity`;\n        try {\n            data = JSON.parse(utf8.decode(dataResponse.responseBinaryText));\n            metadata = JSON.parse(utf8.decode(metadataResponse.responseBinaryText));\n        } catch (e) {\n            return [{name, error: 'UNSUPPORTED'}];\n        }\n        const track = data.payload.locations.map((location) => ({\n                lat: location.la,\n                lng: location.ln\n            })\n        );\n        if (data.payload.description) {\n            name = data.payload.description;\n        } else {\n            const startTime = new Date(metadata.payload.startTime).toDateString();\n            name = `${metadata.payload.fullname} on ${startTime}`;\n        }\n\n        return [{\n            name,\n            tracks: [track]\n        }];\n    }\n}\n\nexport {SportsTrackerActivity};\n","import urlViaCorsProxy from '~/lib/CORSProxy';\nimport BaseService from './baseService';\nimport parseGpx from '../parsers/gpx';\n\nclass OpenStreetMapRu extends BaseService {\n    urlRe = /^https?:\\/\\/(?:www\\.)?openstreetmap\\.ru\\/\\?mapid=(\\d+)/u;\n\n    getTrackId() {\n        const m = this.urlRe.exec(this.origUrl);\n        return m[1];\n    }\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const trackId = this.getTrackId();\n        return [{\n            url: urlViaCorsProxy(`https://openstreetmap.ru/mymap.php?id=${trackId}&format=gpx`),\n            options: {responseType: 'binarystring'}\n        }];\n    }\n\n    parseResponse(responses) {\n        const trackId = this.getTrackId();\n        const response = responses[0];\n        const geodata = parseGpx(response.responseBinaryText, `PersonalMap ${trackId}`, true);\n        if (!geodata) {\n            return [{name: name, error: 'UNSUPPORTED'}];\n        }\n        if (geodata[0].tracks.length === 0 && geodata[0].points.length === 0) {\n            return [{error: 'Personal map is empty or does not exist'}];\n        }\n        return geodata;\n    }\n}\n\nexport default OpenStreetMapRu;\n","import utf8 from 'utf8';\nimport escapeHtml from 'escape-html';\nimport {saveNktk} from './parsers/nktk';\n\nfunction saveGpx(segments, name, points, withElevations = false) {\n    const gpx = [];\n    const fakeTime = '1970-01-01T00:00:01.000Z';\n\n    gpx.push('<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\" ?>');\n    gpx.push(\n        '<gpx xmlns=\"http://www.topografix.com/GPX/1/1\" creator=\"http://nakarte.me\" ' +\n        'xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://www.topografix.com/GPX/1/1 ' +\n        'http://www.topografix.com/GPX/1/1/gpx.xsd\" version=\"1.1\">'\n    );\n    points.forEach(function(marker) {\n            var label = marker.label;\n            label = escapeHtml(label);\n            label = utf8.encode(label);\n            gpx.push(`\\t<wpt lat=\"${marker.latlng.lat.toFixed(6)}\" lon=\"${marker.latlng.lng.toFixed(6)}\">`);\n            if (withElevations && marker.latlng.alt !== null) {\n                gpx.push(`\\t\\t<ele>${marker.latlng.alt.toFixed(1)}</ele>`);\n            }\n            gpx.push(`\\t\\t<name>${label}</name>`);\n            gpx.push('\\t</wpt>');\n        }\n    );\n    if (segments.length > 0) {\n        name = name || 'Track';\n        name = escapeHtml(name);\n        name = utf8.encode(name);\n        gpx.push('\\t<trk>');\n        gpx.push('\\t\\t<name>' + name + '</name>');\n\n        for (let segment of segments) {\n            gpx.push('\\t\\t<trkseg>');\n            for (let point of segment) {\n                let x = point.lng.toFixed(6);\n                let y = point.lat.toFixed(6);\n                const elevation = (withElevations && point.alt !== null)\n                    ? `<ele>${point.alt.toFixed(1)}</ele>` : '';\n                // time element is not necessary, added for compatibility to Garmin Connect only\n                gpx.push(`\\t\\t\\t<trkpt lat=\"${y}\" lon=\"${x}\">${elevation}<time>${fakeTime}</time></trkpt>`);\n            }\n            gpx.push('\\t\\t</trkseg>');\n        }\n        gpx.push('\\t</trk>');\n    }\n    gpx.push('</gpx>');\n    return gpx.join('\\n');\n}\n\nfunction saveGpxWithElevations(segments, name, points) {\n    return saveGpx(segments, name, points, true);\n}\n\nfunction saveKml(segments, name, points) {\n    const kml = [];\n\n    name = name || 'Track';\n    name = escapeHtml(name);\n    name = utf8.encode(name);\n\n    kml.push('<?xml version=\"1.0\" encoding=\"UTF-8\"?>');\n    kml.push('<kml xmlns=\"http://www.opengis.net/kml/2.2\">');\n    kml.push('\\t<Document>');\n    kml.push(`\\t\\t<name>${name}</name>`);\n\n    for (let [i, segment] of segments.entries()) {\n        kml.push('\\t\\t<Placemark>');\n        kml.push(`\\t\\t\\t<name>Line ${(i + 1)}</name>`);\n        kml.push('\\t\\t\\t<LineString>');\n        kml.push('\\t\\t\\t\\t<tessellate>1</tessellate>');\n        kml.push('\\t\\t\\t\\t<coordinates>');\n\n        for (let point of segment) {\n            let x = point.lng.toFixed(6);\n            let y = point.lat.toFixed(6);\n            kml.push(`\\t\\t\\t\\t\\t${x},${y}`);\n        }\n\n        kml.push('\\t\\t\\t\\t</coordinates>');\n        kml.push('\\t\\t\\t</LineString>');\n        kml.push('\\t\\t</Placemark>');\n    }\n\n    points.forEach(function(marker) {\n            var label = marker.label;\n            label = escapeHtml(label);\n            label = utf8.encode(label);\n            var coordinates = marker.latlng.lng.toFixed(6) + ',' + marker.latlng.lat.toFixed(6) + ',0';\n\n            kml.push('\\t\\t<Placemark>');\n            kml.push('\\t\\t\\t<name>' + label + '</name>');\n            kml.push('\\t\\t\\t<Point>');\n            kml.push('\\t\\t\\t\\t<coordinates>' + coordinates + '</coordinates>');\n            kml.push('\\t\\t\\t</Point>');\n            kml.push('\\t\\t</Placemark>');\n        }\n    );\n\n    kml.push('\\t</Document>');\n    kml.push('\\t</kml>');\n\n    return kml.join('\\n');\n}\n\nexport {saveGpx, saveGpxWithElevations, saveKml, saveNktk as saveToString};\n\n","import L from 'leaflet';\n\nL.LineUtil.simplifyLatlngs = function simplifyLatlngs(points, tolerance) {\n    function latlngToXy(p) {\n        return {\n            x: p.lng,\n            y: p.lat\n        };\n    }\n\n    function xyToLatlng(p) {\n        return {\n            lat: p.y,\n            lng: p.x\n        };\n    }\n\n    points = points.map(latlngToXy);\n    points = L.LineUtil.simplify(points, tolerance);\n    points = points.map(xyToLatlng);\n    return points;\n};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport './edit_line.css';\nimport {wrapLatLngToTarget} from '~/lib/leaflet.fixes/fixWorldCopyJump';\n\nL.Polyline.EditMixinOptions = {\n    className: 'leaflet-editable-line'\n};\n\nL.Polyline.EditMixin = {\n    _nodeMarkersZOffset: 10000,\n\n    startEdit: function() {\n        if (this._map && !this._editing) {\n            this._editing = true;\n            this._drawingDirection = 0;\n            this.setupMarkers();\n            this.on('remove', this.stopEdit.bind(this));\n            this._map\n                .on('click', this.onMapClick, this)\n                .on('dragend', this.onMapEndDrag, this);\n            L.DomEvent.on(document, 'keyup', this.onKeyPress, this);\n            this._storedStyle = {weight: this.options.weight, opacity: this.options.opacity};\n            if (this._latlngs.length) {\n                this.setStyle({weight: 1.5, opacity: 1});\n            }\n            L.DomUtil.addClass(this._map._container, 'leaflet-line-editing');\n            this.fire('editstart', {target: this});\n        }\n    },\n\n    stopEdit: function(userCancelled) {\n        if (this._editing) {\n            this.stopDrawingLine();\n            this._editing = false;\n            this.removeMarkers();\n            L.DomEvent.off(document, 'keyup', this.onKeyPress, this);\n            this.off('remove', this.stopEdit.bind(this));\n            this._map\n                .off('click', this.onMapClick, this)\n                .off('dragend', this.onMapEndDrag, this);\n            if (this._latlngs.length) {\n                this.setStyle(this._storedStyle);\n            }\n            L.DomUtil.removeClass(this._map._container, 'leaflet-line-editing');\n            this.fire('editend', {target: this, userCancelled});\n        }\n    },\n\n    removeMarkers: function() {\n        this.getLatLngs().forEach(function(node) {\n                if (node._nodeMarker) {\n                    this.nodeMarkers.removeLayer(node._nodeMarker);\n                    delete node._nodeMarker._lineNode;\n                    delete node._nodeMarker;\n                }\n                if (node._segmentOverlay) {\n                    this.segmentOverlays.removeLayer(node._segmentOverlay);\n                    delete node._segmentOverlay._lineNode;\n                    delete node._segmentOverlay;\n                }\n            }.bind(this)\n        );\n    },\n\n    getMarkerIndex: function(marker) {\n        return this.getLatLngs().indexOf(marker._lineNode);\n    },\n\n    getSegmentOverlayIndex: function(segmentOverlay) {\n        return this.getLatLngs().indexOf(segmentOverlay._lineNode);\n    },\n\n    onNodeMarkerDragEnd: function(e) {\n        var marker = e.target,\n            nodeIndex = this.getMarkerIndex(marker);\n        this.replaceNode(nodeIndex, marker.getLatLng());\n        this._setupEndMarkers();\n    },\n\n    onNodeMarkerMovedChangeNode: function(e) {\n        var marker = e.target,\n            latlng = marker.getLatLng(),\n            node = marker._lineNode;\n        node.lat = latlng.lat;\n        node.lng = latlng.lng;\n        this.redraw();\n        this.fire('nodeschanged');\n    },\n\n    onNodeMarkerDblClickedRemoveNode: function(e) {\n        if (this._disableEditOnLeftClick) {\n            return;\n        }\n        if (this.getLatLngs().length < 2 || (this._drawingDirection && this.getLatLngs().length === 2)) {\n            return;\n        }\n        var marker = e.target,\n            nodeIndex = this.getMarkerIndex(marker);\n        this.removeNode(nodeIndex);\n        this._setupEndMarkers();\n    },\n\n    onMapClick: function(e) {\n        if (this._drawingDirection) {\n            let newNodeIndex,\n                refNodeIndex;\n            if (this._drawingDirection === -1) {\n                newNodeIndex = 1;\n                refNodeIndex = 0;\n            } else {\n                newNodeIndex = this._latlngs.length - 1;\n                refNodeIndex = this._latlngs.length - 1;\n            }\n            this.addNode(newNodeIndex, wrapLatLngToTarget(e.latlng, this._latlngs[refNodeIndex]));\n        } else {\n            if (!this.preventStopEdit) {\n                this.stopEdit(true);\n            }\n        }\n    },\n\n    onMapEndDrag: function(e) {\n        if (e.distance < 15) {\n            // get mouse position from map drag handler\n            var handler = e.target.dragging._draggable;\n            var mousePos = handler._startPoint.add(handler._newPos).subtract(handler._startPos);\n            var latlng = e.target.mouseEventToLatLng({clientX: mousePos.x, clientY: mousePos.y});\n            this.onMapClick({latlng: latlng});\n        }\n    },\n\n    startDrawingLine: function(direction, e) {\n        if (!this._editing) {\n            return;\n        }\n        if (direction === undefined) {\n            direction = 1;\n        }\n        if (this._drawingDirection === direction) {\n            return;\n        }\n        this.stopDrawingLine();\n        this._drawingDirection = direction;\n        if (e) {\n            var newNodeIndex = this._drawingDirection === -1 ? 0 : this.getLatLngs().length;\n            this.spliceLatLngs(newNodeIndex, 0, e.latlng);\n            this._setupEndMarkers();\n        }\n\n        this._map.on('mousemove', this.onMouseMoveFollowEndNode, this);\n        L.DomUtil.addClass(this._map._container, 'leaflet-line-drawing');\n        this._map.clickLocked = true;\n    },\n\n    stopDrawingLine: function() {\n        if (!this._drawingDirection) {\n            return;\n        }\n        this._map.off('mousemove', this.onMouseMoveFollowEndNode, this);\n        var nodeIndex = this._drawingDirection === -1 ? 0 : this.getLatLngs().length - 1;\n        this.spliceLatLngs(nodeIndex, 1);\n        this._drawingDirection = 0;\n        L.DomUtil.removeClass(this._map._container, 'leaflet-line-drawing');\n        this._map.clickLocked = false;\n        this._setupEndMarkers();\n        this.fire('drawend');\n    },\n\n    onKeyPress: function(e) {\n        if (e.target.tagName.toLowerCase() === 'input') {\n            return;\n        }\n        var code = e.keyCode;\n        switch (code) {\n            case 27:\n            case 13:\n                if (this._drawingDirection) {\n                    this.stopDrawingLine();\n                } else {\n                    if (!this.preventStopEdit) {\n                        this.stopEdit(true);\n                    }\n                }\n                L.DomEvent.stop(e);\n                break;\n            case 8:\n            case 46:\n                if (this._drawingDirection && this.getLatLngs().length > 2) {\n                    const nodeIndex = this._drawingDirection === 1 ? this.getLatLngs().length - 2 : 1;\n                    this.removeNode(nodeIndex);\n                    L.DomEvent.preventDefault(e);\n                }\n                break;\n\n            default:\n        }\n    },\n\n    onMouseMoveFollowEndNode: function(e) {\n        var nodeIndex = this._drawingDirection === -1 ? 0 : this.getLatLngs().length - 1;\n        let latlng = e.latlng;\n        if (this._latlngs.length > 0) {\n            latlng = wrapLatLngToTarget(latlng, this._latlngs[nodeIndex]);\n        }\n        this.spliceLatLngs(nodeIndex, 1, latlng);\n    },\n\n    makeNodeMarker: function(nodeIndex) {\n        //      ,        2 \n        if (this._latlngs.length === 2) {\n            this.setStyle({weight: 1.5, opacity: 1});\n        }\n        var node = this.getLatLngs()[nodeIndex],\n            marker = L.marker(node.clone(), {\n                    icon: L.divIcon({\n                        className: 'line-editor-node-marker-halo',\n                        html: '<div class=\"line-editor-node-marker\"></div>'\n                    }),\n                    draggable: true,\n                    zIndexOffset: this._nodeMarkersZOffset,\n                    projectedShift: () => this.shiftProjectedFitMapView()\n                }\n            );\n        marker\n            .on('drag', this.onNodeMarkerMovedChangeNode, this)\n            // .on('dragstart', this.fire.bind(this, 'editingstart'))\n            .on('dragend', this.onNodeMarkerDragEnd, this)\n            .on('dblclick', this.onNodeMarkerDblClickedRemoveNode, this)\n            .on('click', this.onNodeMarkerClickStartStopDrawing, this)\n            .on('contextmenu', function(e) {\n                    this.stopDrawingLine();\n                    this.fire('noderightclick', {\n                            nodeIndex: this.getMarkerIndex(marker),\n                            line: this,\n                            mouseEvent: e\n                        }\n                    );\n                }, this\n            );\n        marker._lineNode = node;\n        node._nodeMarker = marker;\n        marker.addTo(this.nodeMarkers);\n    },\n\n    onNodeMarkerClickStartStopDrawing: function(e) {\n        if (this._disableEditOnLeftClick) {\n            return;\n        }\n        var marker = e.target,\n            latlngs = this.getLatLngs(),\n            latlngs_n = latlngs.length,\n            nodeIndex = this.getMarkerIndex(marker);\n        if ((this._drawingDirection === -1 && nodeIndex === 1) ||\n            ((this._drawingDirection === 1 && nodeIndex === latlngs_n - 2))) {\n            this.stopDrawingLine();\n        } else if (nodeIndex === this.getLatLngs().length - 1) {\n            this.startDrawingLine(1, e);\n        } else if (nodeIndex === 0) {\n            this.startDrawingLine(-1, e);\n        }\n    },\n\n    makeSegmentOverlay: function(nodeIndex) {\n        const latlngs = this.getLatLngs(),\n            p1 = latlngs[nodeIndex],\n            p2 = latlngs[nodeIndex + 1];\n        if (!p2) {\n            return;\n        }\n        const segmentOverlay = L.polyline([p1, p2], {\n            weight: 10,\n            opacity: 0.0,\n            projectedShift: () => this.shiftProjectedFitMapView()\n        });\n        segmentOverlay.on('mousedown', this.onSegmentMouseDownAddNode, this);\n        segmentOverlay.on('contextmenu', function(e) {\n                this.stopDrawingLine();\n                this.fire('segmentrightclick', {\n                        nodeIndex: this.getSegmentOverlayIndex(segmentOverlay),\n                        mouseEvent: e,\n                        line: this\n                    }\n                );\n            }, this\n        );\n        segmentOverlay._lineNode = p1;\n        p1._segmentOverlay = segmentOverlay;\n        segmentOverlay.addTo(this.segmentOverlays);\n    },\n\n    onSegmentMouseDownAddNode: function(e) {\n        if (e.originalEvent.button !== 0 || this._disableEditOnLeftClick) {\n            return;\n        }\n        var segmentOverlay = e.target,\n            latlngs = this.getLatLngs(),\n            nodeIndex = this.getSegmentOverlayIndex(segmentOverlay) + 1;\n        const midPoint = L.latLngBounds(latlngs[nodeIndex], latlngs[nodeIndex - 1]).getCenter();\n        this.addNode(nodeIndex, wrapLatLngToTarget(e.latlng, midPoint));\n        if (L.Draggable._dragging) {\n            L.Draggable._dragging.finishDrag();\n        }\n        latlngs[nodeIndex]._nodeMarker.dragging._draggable._onDown(e.originalEvent);\n    },\n\n    addNode: function(index, latlng) {\n        var nodes = this.getLatLngs(),\n            isAddingLeft = (index === 1 && this._drawingDirection === -1),\n            isAddingRight = (index === nodes.length - 1 && this._drawingDirection === 1);\n        latlng = latlng.clone();\n        this.spliceLatLngs(index, 0, latlng);\n        this.makeNodeMarker(index);\n        if (!isAddingLeft && (index >= 1)) {\n            if (!isAddingRight) {\n                var prevNode = nodes[index - 1];\n                this.segmentOverlays.removeLayer(prevNode._segmentOverlay);\n                delete prevNode._segmentOverlay._lineNode;\n                delete prevNode._segmentOverlay;\n            }\n            this.makeSegmentOverlay(index - 1);\n        }\n        if (!isAddingRight) {\n            this.makeSegmentOverlay(index);\n        }\n        if (nodes.length < 3) {\n            this._setupEndMarkers();\n        }\n    },\n\n    removeNode: function(index) {\n        var nodes = this.getLatLngs(),\n            node = nodes[index],\n            marker = node._nodeMarker;\n        delete node._nodeMarker;\n        delete marker._lineNode;\n        this.spliceLatLngs(index, 1);\n        this.nodeMarkers.removeLayer(marker);\n        if (node._segmentOverlay) {\n            this.segmentOverlays.removeLayer(node._segmentOverlay);\n            delete node._segmentOverlay._lineNode;\n            delete node._segmentOverlay;\n        }\n        var prevNode = nodes[index - 1];\n        if (prevNode && prevNode._segmentOverlay) {\n            this.segmentOverlays.removeLayer(prevNode._segmentOverlay);\n            delete prevNode._segmentOverlay._lineNode;\n            delete prevNode._segmentOverlay;\n            if ((index < nodes.length - 1) || (index < nodes.length && this._drawingDirection !== 1)) {\n                this.makeSegmentOverlay(index - 1);\n            }\n        }\n    },\n\n    replaceNode: function(index, latlng) {\n        var nodes = this.getLatLngs(),\n            oldNode = nodes[index],\n            oldMarker = oldNode._nodeMarker;\n        this.nodeMarkers.removeLayer(oldNode._nodeMarker);\n        delete oldNode._nodeMarker;\n        delete oldMarker._lineNode;\n        latlng = latlng.clone();\n        this.spliceLatLngs(index, 1, latlng);\n        this.makeNodeMarker(index);\n        if (oldNode._segmentOverlay) {\n            this.segmentOverlays.removeLayer(oldNode._segmentOverlay);\n            delete oldNode._segmentOverlay._lineNode;\n            delete oldNode._segmentOverlay;\n            this.makeSegmentOverlay(index);\n        }\n        var prevNode = nodes[index - 1];\n        if (prevNode && prevNode._segmentOverlay) {\n            this.segmentOverlays.removeLayer(prevNode._segmentOverlay);\n            delete prevNode._segmentOverlay._lineNode;\n            delete prevNode._segmentOverlay;\n            this.makeSegmentOverlay(index - 1);\n        }\n    },\n\n    _setupEndMarkers: function() {\n        const nodesCount = this._latlngs.length;\n        if (nodesCount === 0) {\n            return;\n        }\n        const startIndex = this._drawingDirection === -1 ? 1 : 0;\n        const endIndex = this._drawingDirection === 1 ? nodesCount - 2 : nodesCount - 1;\n        const startIcon = this._latlngs[startIndex]._nodeMarker._icon;\n        L.DomUtil[this._drawingDirection === -1 ? 'removeClass' : 'addClass'](\n            startIcon, 'line-editor-node-marker-start'\n        );\n        if (endIndex >= 0) {\n            const endIcon = this._latlngs[endIndex]._nodeMarker._icon;\n            let func;\n            if (this._drawingDirection !== 1 && endIndex > 0) {\n                func = L.DomUtil.addClass;\n            } else {\n                func = L.DomUtil.removeClass;\n            }\n            func(endIcon, 'line-editor-node-marker-end');\n        }\n    },\n\n    setupMarkers: function() {\n        if (!this.segmentOverlays) {\n            this.segmentOverlays = L.featureGroup().addTo(this._map);\n        }\n        if (!this.nodeMarkers) {\n            this.nodeMarkers = L.featureGroup().addTo(this._map);\n        }\n        this.removeMarkers();\n        var latlngs = this.getLatLngs(),\n            startNode = 0,\n            endNode = latlngs.length - 1;\n        if (this._drawingDirection === -1) {\n            startNode += 1;\n        }\n        if (this._drawingDirection === 1) {\n            endNode -= 1;\n        }\n        for (var i = startNode; i <= endNode; i++) {\n            this.makeNodeMarker(i);\n            if (i < endNode) {\n                this.makeSegmentOverlay(i);\n            }\n        }\n        this._setupEndMarkers();\n    },\n\n    spliceLatLngs: function(...args) {\n        const latlngs = this.getLatLngs();\n        const res = latlngs.splice(...args);\n        this.setLatLngs(latlngs);\n        this.fire('nodeschanged');\n        return res;\n        // this._latlngs.splice(...args);\n        // this.redraw();\n    },\n\n    getFixedLatLngs: function() {\n        const start = this._drawingDirection === -1 ? 1 : 0;\n        let end = this._latlngs.length;\n        if (this._drawingDirection === 1) {\n            end -= 1;\n        }\n        return this._latlngs.slice(start, end);\n    },\n\n    disableEditOnLeftClick: function(disable) {\n        this._disableEditOnLeftClick = disable;\n    },\n\n    highlighNodesForDeletion: function(startNodeIndex, endNodeIndex) {\n        if (!this._editing) {\n            return;\n        }\n        const nodes = this.getLatLngs();\n        for (let i = 0; i < nodes.length; i++) {\n            const node = nodes[i];\n            const icon = node._nodeMarker._icon;\n            L.DomUtil[i >= startNodeIndex && i <= endNodeIndex ? 'addClass' : 'removeClass'](icon, 'highlight-delete');\n        }\n    }\n};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from \"leaflet\";\n\nfunction getSegmentSplitPointLat(latLng1, latLng2, lng) {\n    const deltaLat = latLng2.lat - latLng1.lat;\n    const deltaLng = latLng2.lng - latLng1.lng;\n    return latLng1.lat + deltaLat / deltaLng * (lng - latLng1.lng);\n}\n\nfunction splitLineAt180Meridian(latLngs) {\n    // this function also creates new LatLng object for all elements\n    const wrappedLatLngs = latLngs.map((ll) => ll.wrap());\n    const newLines = [];\n    if (latLngs.length < 2) {\n        return newLines;\n    }\n\n    let newLine = [wrappedLatLngs[0]];\n    newLines.push(newLine);\n    for (let i = 1; i < wrappedLatLngs.length; i++) {\n        let latLng = wrappedLatLngs[i];\n        let prevLatLng = wrappedLatLngs[i - 1];\n        if (Math.abs(latLng.lng - prevLatLng.lng) <= 180) {\n            newLine.push(latLng);\n        } else {\n            let positiveLng = L.Util.wrapNum(latLng.lng, [0, 360]);\n            let positivePrevLng = L.Util.wrapNum(prevLatLng.lng, [0, 360]);\n            let splitLng = 180 - 0.000001 * Math.sign(latLng.lng);\n            let splitPrevLng = 180 - 0.000001 * Math.sign(prevLatLng.lng);\n            let splitLat = getSegmentSplitPointLat(\n                L.latLng(prevLatLng.lat, positivePrevLng),\n                L.latLng(latLng.lat, positiveLng),\n                splitLng\n            );\n            let splitPrevLat = getSegmentSplitPointLat(\n                L.latLng(prevLatLng.lat, positivePrevLng),\n                L.latLng(latLng.lat, positiveLng),\n                splitPrevLng\n            );\n            newLine.push(L.latLng(splitPrevLat, splitPrevLng).wrap());\n            newLine = [L.latLng(splitLat, splitLng).wrap(), latLng];\n            newLines.push(newLine);\n        }\n    }\n    return newLines;\n}\n\nfunction splitLinesAt180Meridian(lines) {\n    return (lines || [])\n        .map((segment) => splitLineAt180Meridian(segment))\n        .reduce((acc, cur) => {\n            acc.push(...cur);\n            return acc;\n        }, []);\n}\n\nexport {splitLinesAt180Meridian};\n","import L from 'leaflet';\nimport './track-list';\nimport './ruler.css';\nimport {makeButton} from '~/lib/leaflet.control.commons';\n\nL.Control.TrackList.Ruler = L.Control.extend({\n    options: {\n        position: 'topleft'\n    },\n\n    initialize: function(trackList, options) {\n        L.Control.prototype.initialize.call(this, options);\n        this._trackList = trackList;\n    },\n\n    onAdd: function(map) {\n        this._map = map;\n        let {container} = makeButton('', 'Measure distance', 'icon-ruler');\n        this._container = container;\n        L.DomEvent.on(container, 'click', this.onClick, this);\n        return container;\n    },\n\n    onClick: function() {\n        this._trackList.setExpanded();\n        this._trackList.addTrackAndEdit('Ruler').measureTicksShown(true);\n    }\n\n});\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {NakarteUrlLoader} from './lib/services/nakarte';\n\nL.Control.TrackList.include({\n        hashParams: function() {\n            return new NakarteUrlLoader().paramNames();\n        },\n\n        loadTrackFromParam: async function(paramName, values) {\n            if (!values || !values.length) {\n                return;\n            }\n            this.readingFiles(this.readingFiles() + 1);\n            const geodata = await new NakarteUrlLoader().geoData(paramName, values);\n            const notEmpty = this.addTracksFromGeodataArray(geodata);\n            this.readingFiles(this.readingFiles() - 1);\n            if (notEmpty) {\n                this.setExpanded();\n            }\n        },\n    }\n);\n\n","import './track-list';\nimport L from 'leaflet';\nimport {parseNktkSequence} from './lib/parsers/nktk';\nimport safeLocalStorage from '~/lib/safe-localstorage';\nimport * as logging from '~/lib/logging';\n\nL.Control.TrackList.include({\n        maxLocalStorageSessions: 5,\n\n        saveTracksToStorage: function() {\n            var tracks = this.tracks(),\n                serialized = [],\n                maxKey = -1,\n                i, track, s, key, m,\n                keys = [];\n\n            for (i = 0; i < safeLocalStorage.length; i++) {\n                key = safeLocalStorage.key(i);\n                m = key.match(/^trackList_(\\d+)$/u);\n                if (m && m[1] !== undefined) {\n                    if (Number(m[1]) > maxKey) {\n                        maxKey = Number(m[1]);\n                    }\n                }\n            }\n            key = 'trackList_' + (maxKey + 1);\n\n            if (tracks.length === 0) {\n                safeLocalStorage.setItem(key, '');\n                return;\n            }\n            for (i = 0; i < tracks.length; i++) {\n                track = tracks[i];\n                s = this.trackToString(track);\n                serialized.push(s);\n            }\n            if (serialized.length === 0) {\n                return;\n            }\n            s = '#nktk=' + serialized.join('/');\n\n            safeLocalStorage.setItem(key, s);\n\n            // cleanup stale records\n            for (i = 0; i < safeLocalStorage.length; i++) {\n                key = safeLocalStorage.key(i);\n                m = key.match(/^trackList_(\\d+)$/u);\n                if (m && m[1] !== undefined) {\n                    keys.push(Number(m[1]));\n                }\n            }\n            if (keys.length > this.maxLocalStorageSessions) {\n                keys.sort(function(a, b) {\n                        return a - b;\n                    }\n                );\n                for (i = 0; i < keys.length - this.maxLocalStorageSessions; i++) {\n                    key = 'trackList_' + keys[i];\n                    safeLocalStorage.removeItem(key);\n                }\n            }\n        },\n\n        loadTracksFromStorage: function() {\n            var i, key, m, s,\n                geodata,\n                maxKey = -1;\n\n            for (i = 0; i < safeLocalStorage.length; i++) {\n                key = safeLocalStorage.key(i);\n                m = key.match(/^trackList_(\\d+)$/u);\n                if (m && m[1] !== undefined) {\n                    if (Number(m[1]) > maxKey) {\n                        maxKey = Number(m[1]);\n                    }\n                }\n            }\n            if (maxKey > -1) {\n                key = 'trackList_' + maxKey;\n                s = safeLocalStorage.getItem(key);\n                safeLocalStorage.removeItem(key);\n                if (s) {\n                    logging.captureBreadcrumb('load track from localStorage');\n                    s = s.slice(6); // remove \"#nktk=\" prefix\n                    geodata = parseNktkSequence(s);\n                    this.addTracksFromGeodataArray(geodata);\n                }\n            }\n        }\n    }\n);\n","import L from 'leaflet';\nimport './style.css';\nimport '~/lib/controls-styles/controls-styles.css';\nimport enableTopRow from '~/lib/leaflet.control.layers.top-row';\n\nfunction enableMinimize(control) {\n    const originalOnAdd = control.onAdd;\n    if (control._minimizeEnabled) {\n        return;\n    }\n    enableTopRow(control);\n\n    L.Util.extend(control, {\n            _minimizeEnabled: true,\n\n            onAdd: function(map) {\n                const container = originalOnAdd.call(this, map);\n                setTimeout(() => this.__injectMinimizeButtons(), 0);\n                return container;\n            },\n\n            __injectMinimizeButtons: function() {\n                const container = this._container;\n                const contentsWrapper = L.DomUtil.create('div', 'leaflet-control-content');\n                while (container.childNodes.length) {\n                    contentsWrapper.appendChild(container.childNodes[0]);\n                }\n                container.appendChild(contentsWrapper);\n                const minimizeButton = L.DomUtil.create('div', 'button-minimize');\n                this._topRow.appendChild(minimizeButton);\n                const expandButton = L.DomUtil.create('div', 'leaflet-control-button-toggle', container);\n                expandButton.title = 'Select layers';\n                L.DomEvent.on(expandButton, 'click', this.setExpanded, this);\n                L.DomEvent.on(minimizeButton, 'click', this.setMinimized, this);\n            },\n\n            setExpanded: function() {\n                L.DomUtil.removeClass(this._container, 'minimized');\n            },\n\n            setMinimized: function() {\n                L.DomUtil.addClass(this._container, 'minimized');\n            }\n        }\n    );\n    if (control._map) {\n        control.__injectMinimizeButtons();\n    }\n}\n\nexport default enableMinimize;\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport './style.css';\nimport enableTopRow from '~/lib/leaflet.control.layers.top-row';\nimport './customLayer';\n\nfunction enableConfig(control, {layers}) {\n    const originalOnAdd = control.onAdd;\n    const originalUnserializeState = control.unserializeState;\n    if (control._configEnabled) {\n        return;\n    }\n    enableTopRow(control);\n\n    L.Util.extend(control, {\n            _configEnabled: true,\n            _allLayersGroups: layers,\n            _allLayers: [].concat(...layers.map((group) => group.layers)),\n\n            onAdd: function(map) {\n                const container = originalOnAdd.call(this, map);\n                return container;\n            },\n\n            _initializeLayersState: function() {\n                this.updateEnabledLayers(); // eslint-disable-line\n            },\n\n            updateEnabledLayers: function(addedLayers) {\n                let hasBaselayerOnMap = false;\n                const enabledLayers = [...this._allLayers];\n                enabledLayers.sort((l1, l2) => l1.order - l2.order);\n                enabledLayers.forEach((l) => {\n                        l.layer._justAdded = addedLayers && addedLayers.includes(l);\n                        const {layer: {options: {isOverlay}}} = l;\n                        if (isOverlay) {\n                            this.addOverlay(l.layer, l.title);\n                        } else {\n                            this.addBaseLayer(l.layer, l.title);\n                        }\n                        if (!isOverlay && this._map.hasLayer(l.layer)) {\n                              hasBaselayerOnMap = true;\n                        }\n                    }\n                );\n                //     ,  ,   \n                if (!hasBaselayerOnMap) {\n                    for (let layer of enabledLayers) {\n                        if (!layer.layer.options.isOverlay) {\n                            this._map.addLayer(layer.layer);\n                            break;\n                        }\n                    }\n                }\n                /* this.storeEnabledLayers(); */\n            },\n\n            unserializeState: function(values) {\n                this.updateEnabledLayers();\n                return originalUnserializeState.call(this, values);\n            },\n        }\n    );\n}\n\nexport default enableConfig;\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\n\nL.Layer.CustomLayer = L.TileLayer.extend({\n    getTileUrl: function(coords) {\n        const z = this._getZoomForUrl();\n        var data = {\n            r: L.Browser.retina ? '@2x' : '',\n            s: this._getSubdomain(coords),\n            x: coords.x,\n            y: coords.y,\n            z: z,\n            z_1: z + 1,\n            x_1024: Math.floor(coords.x / 1024),\n            y_1024: Math.floor(coords.y / 1024),\n        };\n        if (this._map && !this._map.options.crs.infinite) {\n            var invertedY = this._globalTileRange.max.y - coords.y;\n            if (this.options.tms) {\n                data['y'] = invertedY;\n                data['y_1024'] = Math.floor(invertedY / 1024);\n            }\n            data['-y'] = invertedY;\n        }\n\n        return L.Util.template(this._url, L.extend(data, this.options));\n    },\n\n    cloneForPrint: function(options) {\n        return new L.Layer.CustomLayer(this._url, L.Util.extend({}, this.options, options));\n    },\n\n});\n","import './style.css';\nimport L from 'leaflet';\n\nfunction raiseControlsOnFocus(map) {\n    const selectors = [\n        '.leaflet-top.leaflet-right',\n        '.leaflet-bottom.leaflet-right',\n        '.leaflet-top.leaflet-left',\n        '.leaflet-bottom.leaflet-left'\n    ];\n    let elements = map._container.querySelectorAll(selectors.join(','));\n\n    function raise(target) {\n        for (let cornerDiv of elements) {\n            if (cornerDiv === target) {\n                L.DomUtil.addClass(cornerDiv, 'leaflet-controls-corner-raised');\n            } else {\n                L.DomUtil.removeClass(cornerDiv, 'leaflet-controls-corner-raised');\n            }\n        }\n    }\n\n    [...elements].forEach((el) => L.DomEvent.on(el, 'mouseenter', raise.bind(null, el)));\n}\n\nexport default raiseControlsOnFocus;\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport '~/lib/leaflet.layer.yandex';\nimport '~/lib/leaflet.layer.google';\nimport '~/lib/leaflet.layer.soviet-topomaps-grid';\nimport '~/lib/leaflet.layer.wikimapia';\nimport {RetinaTileLayer} from '~/lib/leaflet.layer.RetinaTileLayer';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nconst layersDefs = [\n    {\n        title: 'OpenStreetMap',\n        description: 'OSM default style',\n        isDefault: true,\n        layer: L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n            {\n                code: 'O',\n                isOverlay: false,\n                scaleDependent: true,\n                print: true,\n                jnx: true,\n                shortName: 'osm'\n            }\n        )\n    },\n    {\n        title: 'OpenCycleMap',\n        description: '<a href=\"https://www.opencyclemap.org/docs/\">(Info and key)</a>',\n        isDefault: false,\n        layer: L.tileLayer('https://{s}.tile.thunderforest.com/cycle/{z}/{x}/{y}.png',\n            {\n                code: 'Ocm',\n                isOverlay: false,\n                scaleDependent: true,\n                print: true,\n                jnx: true,\n                shortName: 'opencyclemap',\n            }\n        )\n    },\n    {\n        title: 'OpenTopoMap',\n        isDefault: true,\n        layer: L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png',\n            {\n                code: 'Otm',\n                isOverlay: false,\n                maxNativeZoom: 17,\n                scaleDependent: true,\n                print: true,\n                jnx: true,\n                noCors: false,\n                shortName: 'opentopo'\n            }\n        )\n    },\n    {\n        title: 'Yandex ',\n        isDefault: true,\n        layer: new L.Layer.Yandex.Sat(\n            {\n                scaleDependent: false,\n                code: 'S',\n                isOverlay: false,\n                print: true,\n                jnx: true,\n                shortName: 'yandex_sat'\n            }\n        )\n    },\n    {\n        title: 'Google ',\n        isDefault: true,\n        layer: new L.Layer.GoogleSat(\n            {\n                code: 'L',\n                isOverlay: false,\n                scaleDependent: false,\n                print: true,\n                jnx: true,\n                shortName: 'google_sat'\n            }\n        )\n    },\n    {\n        title: 'ESRI ',\n        isDefault: true,\n        layer: L.tileLayer(\n            'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',\n            {\n                code: 'E',\n                isOverlay: false,\n                scaleDependent: false,\n                maxNativeZoom: 18,\n                print: true,\n                jnx: true,\n                shortName: 'esri'\n            }\n        )\n    },\n    {\n        title: '  (zoom  12)',\n        isDefault: true,\n        layer: L.tileLayer('https://{s}.tiles.nakarte.me/topo500/{z}/{x}/{y}',\n            {\n                code: 'B',\n                isOverlay: true,\n                isOverlayTransparent: false,\n                tms: true,\n                scaleDependent: false,\n                maxNativeZoom: 14,\n                minZoom: 12,\n                print: true,\n                jnx: true,\n                shortName: 'topo_500'\n            }\n        )\n    },\n    {\n        title: '  ',\n        isDefault: true,\n        layer: new L.Layer.SovietTopoGrid({\n            code: 'Ng',\n            isOverlay: true,\n            print: false,\n            jnx: false\n        })\n    },\n    {\n        title: 'Wikimapia',\n        isDefault: true,\n        layer: new L.Wikimapia({\n            code: 'W',\n            isOverlay: true,\n            print: false,\n            jnx: false\n        })\n    },\n    {\n        title: 'OpenStreetMap GPS ',\n        isDefault: false,\n        layer: L.tileLayer('https://{s}.gps-tile.openstreetmap.org/lines/{z}/{x}/{y}.png',\n            {\n                code: 'Ot',\n                isOverlay: true,\n                isOverlayTransparent: true,\n                scaleDependent: true,\n                print: true,\n                jnx: false,\n                shortName: 'osm_gps_traces'\n            }\n        )\n    },\n    {\n        title: 'Strava ',\n        isDefault: false,\n        layer: new RetinaTileLayer(\n            [\n                urlViaCorsProxy(\n                    'https://heatmap-external-a.strava.com/tiles-auth/all/hot/{z}/{x}/{y}.png?px=256'\n                ),\n                urlViaCorsProxy(\n                    'https://heatmap-external-a.strava.com/tiles-auth/all/hot/{z}/{x}/{y}.png?px=512'\n                ),\n            ],\n            {\n                code: 'Sa',\n                isOverlay: true,\n                isOverlayTransparent: true,\n                scaleDependent: false,\n                print: true,\n                jnx: false,\n                subdomains: 'abc',\n                noCors: true,\n                shortName: 'strava_all',\n                retinaOptionsOverrides: [{maxNativeZoom: 16}, {maxNativeZoom: 15}],\n            }\n        )\n    },\n    {\n        title: ' ',\n        description: '<a href=\"https://hiking.waymarkedtrails.org/\">https://hiking.waymarkedtrails.org</a>',\n        isDefault: false,\n        layer: L.tileLayer('https://tile.waymarkedtrails.org/hiking/{z}/{x}/{y}.png',\n            {\n                code: 'Wh',\n                isOverlay: true,\n                tms: false,\n                print: true,\n                jnx: false,\n                scaleDependent: true,\n                shortName: 'hiking_trails',\n                isOverlayTransparent: true\n            })\n    },\n    {\n        title: 'Yandex  (zoom  10)',\n        isDefault: false,\n        layer: new L.Layer.Yandex.Tracks(\n            {\n                scaleDependent: true,\n                code: 'Ytr',\n                isOverlay: true,\n                isOverlayTransparent: true,\n                print: true,\n                jnx: false,\n                shortName: 'yandex_tracks',\n                noCors: true,\n            }\n        )\n    },\n];\n\nfunction getLayers() {\n    // set metadata\n    for (let layer of layersDefs) {\n        layer.layer.meta = {title: layer.title};\n    }\n\n    // divide layers by groups\n    const grouppedLayers = [];\n    let group = {group: 'title', layers: layersDefs};\n    grouppedLayers.push(group);\n\n    return {\n        layers: grouppedLayers,\n    };\n}\n\nexport {getLayers};\n","import L from 'leaflet';\nimport './style.css';\nimport Contextmenu from '~/lib/contextmenu';\nimport copyToClipboard from '~/lib/clipboardCopy';\n\nfunction zeroPad(num, size) {\n    var s = String(num);\n    while (s.length < size) {\n        s = \"0\" + s;\n    }\n    return s;\n}\n\nconst bigLetterReplacers = [\n    /* eslint-disable quote-props */\n    {\n        '1': '',\n        '2': '',\n        '3': '',\n        '4': ''\n    },\n    {\n        '1': 'A',\n        '2': 'B',\n        '3': 'C',\n        '4': 'D'\n    }\n    /* eslint-enable quote-props */\n];\n\nvar Nomenclature = {\n    getQuadName1m: function(column, row, join) {\n        var name = '';\n        if (row < 0) {\n            row = -row - 1;\n            name += 'x';\n        }\n        column += 31;\n        name += 'ABCDEFGHIJKLMNOPQRSTUV'[row] + '-' + zeroPad(column, 2);\n        for (var n = 1; n <= join - 1; n++) {\n            name += ',' + zeroPad(column + n, 2);\n        }\n        return [name];\n    },\n\n    getQuadName500k: function(column, row, join) {\n        var name1 = this.getQuadName1m(Math.floor(column / 2), Math.floor(row / 2), 1)[0];\n        var subquad = 2 - (row & 1) * 2 + (column & 1) + 1;\n        let name2 = '-' + subquad;\n        if (join > 1) {\n            name2 += ',' + (subquad + 1);\n        }\n        if (join === 4) {\n            name2 +=\n                ',' + this.getQuadName1m(Math.floor((column + 2) / 2), Math.floor(row / 2), 1) + '-' + subquad +\n                ',' + (subquad + 1);\n        }\n        const names = [name1 + name2];\n        for (let replacer of bigLetterReplacers) {\n            let name3 = name2.replace(/\\b[1-4]\\b/gu, (s) => replacer[s]);\n            names.push(name1 + name3);\n        }\n        return names;\n    },\n\n    getQuadName100k: function(column, row, join) {\n        var name = this.getQuadName1m(Math.floor(column / 12), Math.floor(row / 12), 1);\n        const subRow = row - Math.floor(row / 12) * 12;\n        const subColumn = column - Math.floor(column / 12) * 12;\n        var subquad = 132 - subRow * 12 + subColumn + 1;\n        name = name + '-' + zeroPad(subquad, 3);\n        if (join > 1) {\n            name += ',' + zeroPad(subquad + 1, 3);\n        }\n        if (join === 4) {\n            name += ',' + zeroPad(subquad + 2, 3) + ',' + zeroPad(subquad + 3, 3);\n        }\n\n        return [name];\n    },\n\n    getQuadName050k: function(column, row, join) {\n        var name1 = this.getQuadName100k(Math.floor(column / 2), Math.floor(row / 2), 1);\n        var subquad = 2 - (row & 1) * 2 + (column & 1) + 1;\n        let name2 = '-' + subquad;\n        if (join > 1) {\n            name2 += ',' + (subquad + 1);\n        }\n        if (join === 4) {\n            name2 += ',' + this.getQuadName100k(Math.floor((column + 2) / 2), Math.floor(row / 2), 1) + '-' +\n                subquad + ',' + (subquad + 1);\n        }\n        const names = [name1 + name2];\n        for (let replacer of bigLetterReplacers) {\n            let name3 = name2.replace(/\\b[1-4]\\b/gu, (s) => replacer[s]);\n            names.push(name1 + name3);\n        }\n        return names;\n    },\n\n    _getQuads: function(bounds, row_height, column_width, name_factory) {\n        bounds = L.latLngBounds(bounds);\n        var quads = [];\n        var min_lat = Math.max(bounds.getSouth(), -84);\n        var max_lat = Math.min(bounds.getNorth(), 84);\n        var min_row = Math.floor(min_lat / row_height);\n        const maxCols = 360 / column_width;\n        for (var row = min_row; row * row_height < max_lat; row++) {\n            var row_south = row * row_height;\n            var row_north = row_south + row_height;\n            var joined_quads;\n            if (row_south >= 76 || row_north <= -76) {\n                joined_quads = 4;\n            } else if (row_south >= 60 || row_north <= -60) {\n                joined_quads = 2;\n            } else {\n                joined_quads = 1;\n            }\n            var min_lon = bounds.getWest();\n            var max_lon = bounds.getEast();\n            var min_column = Math.floor((min_lon + 180) / column_width / joined_quads) * joined_quads -\n                Math.round(180 / column_width);\n            for (var column = min_column; column * column_width < max_lon; column += joined_quads) {\n                var column_west = column * column_width;\n                var column_east = column_west + column_width * joined_quads;\n                var quad_bounds = L.latLngBounds([[row_south, column_west], [row_north, column_east]]);\n                // shift column to positive numbers, calc modulo, shift back\n                const wrappedColumn = ((column + maxCols / 2) % maxCols + maxCols) % maxCols - maxCols / 2;\n                var names = name_factory(wrappedColumn, row, joined_quads);\n                quads.push({names: names, bounds: quad_bounds});\n            }\n        }\n        return quads;\n    },\n\n    getQuads1m: function(bounds) {\n        return this._getQuads(bounds, 4, 6, this.getQuadName1m);\n    },\n\n    getQuads500k: function(bounds) {\n        return this._getQuads(bounds, 2, 3, this.getQuadName500k.bind(this));\n    },\n\n    getQuads100k: function(bounds) {\n        return this._getQuads(bounds, 4 / 12, 6 / 12, this.getQuadName100k.bind(this));\n    },\n\n    getQuads050k: function(bounds) {\n        return this._getQuads(bounds, 4 / 12 / 2, 6 / 12 / 2, this.getQuadName050k.bind(this));\n    }\n\n};\n\nL.Layer.SovietTopoGrid = L.LayerGroup.extend({\n        options: {},\n\n        initialize: function(options) {\n            L.LayerGroup.prototype.initialize.call(this);\n            L.Util.setOptions(this, options);\n            this.renderer = L.svg({padding: 0.5});\n            this._quads = {};\n            this._updateRenderer = L.Util.throttle(this._updateRenderer, 100, this);\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            map.on('zoomend', this._reset, this);\n            map.on('move', this._update, this);\n            map.on('move', this._updateRenderer, this);\n            this._update();\n        },\n\n        onRemove: function(map) {\n            map.off('zoomend', this._reset, this);\n            map.off('move', this._update, this);\n            this._cleanupQuads(true);\n        },\n\n        _addQuad: function(bounds, id, titles, color, layer, scale) {\n            if (id in this._quads) {\n                return;\n            }\n            var rect_options = {\n                smoothFactor: 0,\n                noClip: true,\n                interactive: false,\n                fill: false,\n                opacity: {1: 0.7, 2: 0.4}[layer],\n                color: color,\n                weight: {1: 1, 2: 3}[layer],\n                renderer: this.renderer\n            };\n\n            var rect = L.rectangle(bounds, rect_options);\n            this.addLayer(rect);\n            if (layer === 1) {\n                rect.bringToBack();\n            }\n            var objects = [rect];\n            const title = titles[0].replace(/-/gu, ' &ndash; ');\n            var html = L.Util.template(`<span style=\"color:{color}\">{title}</span>`, {color: color, title: title});\n            var icon = L.divIcon({html: html, className: 'leaflet-sovietgrid-quadtitle-' + layer, iconSize: null});\n            var marker = L.marker(L.latLngBounds(bounds).getCenter(), {icon: icon});\n            this.addLayer(marker);\n            objects.push(marker);\n            this._quads[id] = objects;\n            marker.on('click contextmenu', this._showContextMenu.bind(this, scale, titles));\n        },\n\n        _showContextMenu: function(scale, titles, e) {\n            const scaleString = {\n                '1m': '1:1 000 000',\n                '500k': '1:500 000',\n                '100k': '1:100 000',\n                '050k': '1:50 000'\n            }[scale];\n            const items = [\n                {text: scaleString, header: true},\n                {text: '   ', header: true},\n                {\n                    text: titles[0],\n                    callback: () => {\n                        copyToClipboard(titles[0], e.originalEvent);\n                    }\n                }\n            ];\n            if (titles.length > 1) {\n                items.push({\n                        text: titles[1] + ' <span class=\"leaflet-sovietgrid-lang\">RUS</span>',\n                        callback: () => {\n                            copyToClipboard(titles[1], e.originalEvent);\n                        }\n                    }\n                );\n                items.push({\n                        text: titles[2] + ' <span class=\"leaflet-sovietgrid-lang\">LAT</span>',\n                        callback: () => {\n                            copyToClipboard(titles[2], e.originalEvent);\n                        }\n                    }\n                );\n            }\n            const menu = new Contextmenu(items);\n            menu.show(e);\n        },\n\n        _removeQuad: function(id) {\n            this._quads[id].forEach(this.removeLayer.bind(this));\n            delete this._quads[id];\n        },\n\n        _addQuads: function(quads, scale, color, layer) {\n            quads.forEach(function(quad) {\n                    var id = scale + quad.names[0];\n                    this._addQuad(quad.bounds, id, quad.names, color, layer, scale);\n                }.bind(this)\n            );\n        },\n\n        _addGrid: function() {\n            var quads;\n            var layer;\n            var map_bbox = this._map.getBounds();\n            var zoom = this._map.getZoom();\n\n            if (zoom >= 10) {\n                quads = Nomenclature.getQuads050k(map_bbox);\n                layer = (zoom >= 12) ? 2 : 1;\n                this._addQuads(quads, '050k', '#50d', layer);\n            }\n\n            if (zoom >= 8 && zoom < 12) {\n                quads = Nomenclature.getQuads100k(map_bbox);\n                layer = (zoom >= 10) ? 2 : 1;\n                this._addQuads(quads, '100k', '#d50', layer);\n            }\n\n            if (zoom >= 6 && zoom < 10) {\n                quads = Nomenclature.getQuads500k(map_bbox);\n                layer = (zoom >= 8) ? 2 : 1;\n                this._addQuads(quads, '500k', '#099', layer);\n            }\n\n            if (zoom >= 4 && zoom < 8) {\n                layer = (zoom >= 6) ? 2 : 1;\n                quads = Nomenclature.getQuads1m(map_bbox);\n                this._addQuads(quads, '1m', 'blue', layer);\n            }\n        },\n\n        _reset: function() {\n            this._update(true);\n        },\n\n        _cleanupQuads: function(reset) {\n            if (reset === true) {\n                this.clearLayers();\n                this._quads = {};\n            } else {\n                var map_bbox = this._map.getBounds();\n                for (var quad_id of Object.keys(this._quads)) {\n                    var rect = this._quads[quad_id][0];\n                    if (!map_bbox.intersects(rect.getBounds())) {\n                        this._removeQuad(quad_id);\n                    }\n                }\n            }\n        },\n\n        _updateRenderer: function() {\n            if (this.renderer._map) {\n                this.renderer._update();\n            }\n        },\n\n        _update: function(reset) {\n            this._cleanupQuads(reset);\n            this._addGrid();\n        }\n    }\n);\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {WikimapiaLoader} from './wikimapia-loader';\nimport './style.css';\nimport {openPopupWindow} from '~/lib/popup-window';\n\nfunction isPointInPolygon(polygon, p) {\n    var inside = false;\n    var prevNode = polygon[polygon.length - 1],\n        node, i;\n    for (i = 0; i < polygon.length; i++) {\n        node = polygon[i];\n        if (\n            ((node[0] <= p[0] && p[0] < prevNode[0]) || (prevNode[0] <= p[0] && p[0] < node[0])) &&\n            p[1] < (prevNode[1] - node[1]) * (p[0] - node[0]) / (prevNode[0] - node[0]) + node[1]\n        ) {\n            inside = !inside;\n        }\n        prevNode = node;\n    }\n    return inside;\n}\n\nL.Wikimapia = L.GridLayer.extend({\n        options: {\n            tileSize: 1024,\n            updateWhenIdle: true\n        },\n\n        initialize: function(options) {\n            L.GridLayer.prototype.initialize.call(this, options);\n            this.loader = null;\n        },\n\n        onAdd: function(map) {\n            if (!this.loader) {\n                this.loader = new WikimapiaLoader(map);\n            }\n            L.GridLayer.prototype.onAdd.call(this, map);\n            this.on('tileunload', this.onTileUnload, this);\n            map.on('mousemove', this.onMouseMove, this);\n            map.on('click', this.onClick, this);\n        },\n\n        onRemove: function(map) {\n            map.off('mousemove', this.onMouseMove, this);\n            map.off('click', this.onClick, this);\n            if (this.highlightedPlace) {\n                this._map.removeLayer(this.highlightedPlace.polygon);\n                this._map.removeLayer(this.highlightedPlace.label);\n                this.highlightedPlace = null;\n            }\n            L.TileLayer.prototype.onRemove.call(this, map);\n            this.off('tileunload', this.onTileUnload, this);\n        },\n\n        drawTile: function(canvas) {\n            if (!this._map) {\n                return;\n            }\n            const\n                tileData = canvas._tileData,\n                adjustment = canvas._adjustment;\n            if (!tileData) {\n                return;\n            }\n\n            const canvasCtx = canvas.getContext('2d');\n            canvasCtx.beginPath();\n            canvasCtx.strokeStyle = '#CFA600';\n            canvasCtx.lineWidth = 1;\n            for (let place of tileData.places) {\n                let polygon = place.localPolygon;\n                if (!polygon) {\n                    continue;\n                }\n                if (adjustment) {\n                    let {multiplier, offsetX, offsetY} = adjustment,\n                        polygon2 = [];\n                    for (let i = 0; i < polygon.length; i++) {\n                        let p = polygon[i];\n                        polygon2.push({\n                                x: p.x * multiplier - offsetX,\n                                y: p.y * multiplier - offsetY\n                            }\n                        );\n                    }\n                    polygon = polygon2;\n                }\n                canvasCtx.moveTo(polygon[0].x, polygon[0].y);\n                let p;\n                for (let i = 1; i < polygon.length; i++) {\n                    p = polygon[i];\n                    canvasCtx.lineTo(p.x, p.y);\n                }\n                canvasCtx.lineTo(polygon[0].x, polygon[0].y);\n            }\n            canvasCtx.stroke();\n        },\n\n        createTile: function(coords, done) {\n            const canvas = L.DomUtil.create('canvas', 'leaflet-tile');\n            canvas.width = this.options.tileSize;\n            canvas.height = this.options.tileSize;\n            let {dataPromise, abortLoading} = this.loader.requestTileData(coords);\n            dataPromise.then((data) => {\n                if (!data.error) {\n                    canvas._tileData = data.tileData;\n                    canvas._adjustment = data.adjustment;\n                    this.drawTile(canvas);\n                    this._tileOnLoad(done, canvas);\n                }\n            });\n\n            canvas._abortLoading = abortLoading;\n            return canvas;\n        },\n\n        _tileOnLoad: function(done, tile) {\n            // For https://github.com/Leaflet/Leaflet/issues/3332\n            if (L.Browser.ielt9) {\n                setTimeout(L.bind(done, this, null, tile), 0);\n            } else {\n                done(null, tile);\n            }\n        },\n\n        onTileUnload: function(e) {\n            const tile = e.tile;\n            tile._abortLoading();\n            delete tile._tileData;\n            delete tile._adjustment;\n        },\n\n        _tileCoordsFromEvent: function(e) {\n            const layerPoint = this._map.getPixelOrigin().add(e.layerPoint);\n            const tileSize = this.options.tileSize;\n            let coords = {\n                x: Math.floor(layerPoint.x / tileSize),\n                y: Math.floor(layerPoint.y / tileSize),\n                z: this._map.getZoom()\n            };\n\n            return coords;\n        },\n\n        getPlaceAtMousePos: function(e) {\n            const tileCoords = this._tileCoordsFromEvent(e);\n            let tile = this._tiles[this._tileCoordsToKey(tileCoords)];\n            if (!tile) {\n                return null;\n            }\n            const tileData = tile.el._tileData;\n            if (!tileData) {\n                return null;\n            }\n            return this.getPlaceAtLatlng(e.latlng.wrap(), tileData.places);\n        },\n\n        onMouseMove: function(e) {\n            const place = this.getPlaceAtMousePos(e);\n            if (this.highlightedPlace && (!place || this.highlightedPlace.id !== place.id)) {\n                this._map.removeLayer(this.highlightedPlace.polygon);\n                this._map.removeLayer(this.highlightedPlace.label);\n                this.highlightedPlace = null;\n            }\n\n            if (place && !this.highlightedPlace) {\n                this.highlightedPlace = {\n                    id: place.id,\n                    polygon: L.polygon(place.polygon, {\n                            weight: 0,\n                            color: '#E6B800'\n                        }\n                    ),\n                    label: L.tooltip({className: 'wikimapia-tooltip-wrapper'}, null)\n                };\n                this.highlightedPlace.label.setLatLng(e.latlng);\n                this.highlightedPlace.polygon.addTo(this._map).bringToBack();\n                this.highlightedPlace.label.setContent(`<div class=\"wikimapia-tooltip\">${place.title}</div>`);\n                this._map.addLayer(this.highlightedPlace.label);\n            }\n            if (this.highlightedPlace) {\n                this.highlightedPlace.label.setLatLng(e.latlng);\n            }\n        },\n\n        onClick: function(e) {\n            if (this._map.clickLocked) {\n                return;\n            }\n            const place = this.getPlaceAtMousePos(e);\n            if (place) {\n                const url = `http://wikimapia.org/${place.id}/ru/`;\n                openPopupWindow(url, 564, 'wikimapia-details');\n            }\n        },\n\n        getPlaceAtLatlng: function(latlng, places) {\n            let {lat, lng} = latlng,\n                bounds, place;\n            for (let i = places.length - 1; i >= 0; i--) {\n                place = places[i];\n                bounds = place.boundsWESN;\n                if (lng >= bounds[0] && lng <= bounds[1] && lat >= bounds[2] && lat <= bounds[3] &&\n                    isPointInPolygon(place.polygon, [lat, lng])) {\n                    return place;\n                }\n            }\n            return null;\n        }\n\n    }\n);\n","import {TiledDataLoader} from '~/lib/tiled-data-loader';\nimport * as wmUtils from './wm-utils';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nclass WikimapiaLoader extends TiledDataLoader {\n    maxZoom = 15;\n    minZoom = 1;\n    tileSize = 1024;\n\n    constructor(projectObj) {\n        super();\n        this._projectObj = projectObj;\n    }\n\n    getFromCache(dataTileCoords) {\n        dataTileCoords = {...dataTileCoords};\n        let exactMatch = true;\n        while (dataTileCoords.z >= 0) {\n            let key = this.makeTileKey(dataTileCoords);\n            let res = this._cache.get(key);\n            if (res.found) {\n                if (exactMatch || !res.value.hasChildren) {\n                    res['coords'] = dataTileCoords;\n                    return res;\n                }\n                break;\n            }\n            dataTileCoords.z -= 1;\n            dataTileCoords.x = Math.floor(dataTileCoords.x / 2);\n            dataTileCoords.y = Math.floor(dataTileCoords.y / 2);\n            exactMatch = false;\n        }\n        return {found: false};\n    }\n\n    layerTileToDataTileCoords(layerTileCoords) {\n        let z = layerTileCoords.z - 2;\n        if (z > this.maxZoom) {\n            let z2 = this.maxZoom,\n                multiplier = 1 << (z - z2);\n            return {\n                x: Math.floor(layerTileCoords.x / multiplier),\n                y: Math.floor(layerTileCoords.y / multiplier),\n                z: z2\n            };\n        } else if (z < this.minZoom) {\n            let z2 = this.minZoom,\n                multiplier = 1 / (1 << (z2 - z));\n            return {\n                x: Math.floor(layerTileCoords.x / multiplier),\n                y: Math.floor(layerTileCoords.y / multiplier),\n                z: z2\n            };\n        }\n        return {z, x: layerTileCoords.x, y: layerTileCoords.y};\n    }\n\n    makeRequestData(dataTileCoords) {\n        let url = wmUtils.makeTileUrl(dataTileCoords);\n        url = urlViaCorsProxy(url);\n        return {\n            url,\n            options: {timeout: 20000}\n        };\n    }\n\n    processResponse(xhr) {\n        return wmUtils.parseTile(xhr.response, this._projectObj)\n            .then((tileData) => ({\n                        tileData,\n                        coords: tileData.coords\n            }));\n    }\n\n    calcAdjustment(layerTileCoords, dataTileCoords) {\n        const adjustment = super.calcAdjustment(\n            {x: layerTileCoords.x, y: layerTileCoords.y, z: layerTileCoords.z - 2},\n            dataTileCoords\n        );\n        if (adjustment) {\n            adjustment.offsetX *= 1024;\n            adjustment.offsetY *= 1024;\n        }\n        return adjustment;\n    }\n}\n\nexport {WikimapiaLoader};\n","import L from 'leaflet';\n\n// (1233,130,5) -> \"032203\"\nfunction getTileId({x, y, z}) {\n    let id = [];\n    y = (1 << z) - y - 1;\n    z += 1;\n    while (z) {\n        id.push((x & 1) + (y & 1) * 2);\n        x >>= 1;\n        y >>= 1;\n        z -= 1;\n    }\n    return id.reverse().join('');\n}\n\nfunction makeTileUrl(coords) {\n    const\n        tileId = getTileId(coords),\n        urlPath = tileId.replace(/(\\d{3})(?!$)/gu, '$1/'); // \"033331022\" -> \"033/331/022\"\n    return `http://wikimapia.org/z1/itiles/${urlPath}.xy?342342`;\n}\n\nfunction tileIdToCoords(tileId) {\n    const z = tileId.length - 1;\n    let x = 0,\n        y = 0;\n    for (let i = 0; i < tileId.length; i++) {\n        let c = parseInt(tileId[i], 10);\n        x <<= 1;\n        y <<= 1;\n        x += c & 1;\n        y += c >> 1;\n    }\n    y = (1 << z) - y - 1;\n    return {x, y, z};\n}\n\nfunction getWikimapiaTileCoords(coords, viewTileSize) {\n    let z = coords.z - 2;\n    if (z < 0) {\n        z = 0;\n    }\n    if (z > 15) {\n        z = 15;\n    }\n    const q = 2 ** (z - coords.z + Math.log2(viewTileSize / 256));\n    let x = Math.floor(coords.x * q),\n        y = Math.floor(coords.y * q);\n    return {x, y, z};\n}\n\nfunction decodeTitles(s) {\n    const titles = {};\n    for (let title of s.split('\\x1f')) {\n        if (title.length > 2) {\n            let langCode = title.charCodeAt(0) - 32;\n            titles[langCode.toString()] = title.substring(1);\n        }\n    }\n    return titles;\n}\n\nfunction chooseTitle(titles) {\n    var popularLanguages = ['1', '0', '3', '2', '5', '4', '9', '28', '17', '27'];\n    for (let langCode of popularLanguages) {\n        if (langCode in titles) {\n            return titles[langCode];\n        }\n    }\n    for (let langCode of Object.keys(titles)) {\n        return titles[langCode];\n    }\n    return \"\";\n}\n\nfunction decodePolygon(s) {\n    var i = 0,\n        coords = [],\n        lat = 0,\n        lng = 0;\n    while (i < s.length) {\n        var p,\n            l = 0,\n            c = 0;\n        do {\n            p = s.charCodeAt(i++) - 63; // eslint-disable-line no-plusplus\n            c |= (p & 31) << l;\n            l += 5;\n        } while (p >= 32);\n        lng += c & 1 ? ~(c >> 1) : c >> 1;\n        l = 0;\n        c = 0;\n        do {\n            p = s.charCodeAt(i++) - 63; // eslint-disable-line no-plusplus\n            c |= (p & 31) << l;\n            l += 5;\n        } while (p >= 32);\n        lat += c & 1 ? ~(c >> 1) : c >> 1;\n        coords.push([lat / 1e6, lng / 1e6]);\n    }\n    return coords;\n}\n\nfunction makeCoordsLocal(line, tileCoords, projectObj) {\n    const {x: tileX, y: tileY, z: tileZ} = tileCoords,\n        x0 = tileX * 1024,\n        y0 = tileY * 1024,\n        localCoords = [];\n    let latlon, p;\n    for (let i = 0; i < line.length; i++) {\n        latlon = line[i];\n        p = projectObj.project(latlon, tileZ + 2);\n        p.x -= x0;\n        p.y -= y0;\n        localCoords.push(p);\n    }\n    return localCoords;\n}\n\nfunction asap() {\n    return new Promise((resolve) => setTimeout(resolve, 0));\n}\n\nfunction simplifyPolygon(latlngs, tileCoords, tileHasChildren, projectObj) {\n    const\n        x = tileCoords.x * 1024,\n        y = tileCoords.y * 1024,\n        p0 = projectObj.unproject([x, y], tileCoords.z + 2),\n        p1 = projectObj.unproject([x + 1, y + 1], tileCoords.z + 2);\n    let pixelDegSize = p0.lat - p1.lat;\n    if (!tileHasChildren && tileCoords.z < 15) {\n        pixelDegSize /= (1 << (15 - tileCoords.z));\n    }\n    let points = [];\n    for (let i = 0; i < latlngs.length; i++) {\n        let ll = latlngs[i];\n        points.push({x: ll[0], y: ll[1]});\n    }\n    points = L.LineUtil.simplify(points, pixelDegSize * 2);\n    latlngs = [];\n    for (let i = 0; i < points.length; i++) {\n        let p = points[i];\n        latlngs.push([p.x, p.y]);\n    }\n    return latlngs;\n}\n\nasync function parseTile(s, projectObj) {\n    const tile = {};\n    const places = tile.places = [];\n    const lines = s.split('\\n');\n    if (lines.length < 1) {\n        throw new Error('No data in tile');\n    }\n    const fields = lines[0].split('|');\n    const tileId = fields[0];\n    if (!tileId || !tileId.match(/^[0-3]+$/u)) {\n        throw new Error('Invalid tile header');\n    }\n    tile.tileId = tileId;\n    tile.coords = tileIdToCoords(tileId);\n    tile.hasChildren = fields[1] === '1';\n\n    // FIXME: ignore some errors\n    let prevTime = Date.now();\n    for (let line of lines.slice(2)) {\n        let curTime = Date.now();\n        if (curTime - prevTime > 20) {\n            await asap();\n            prevTime = Date.now();\n        }\n        const place = {};\n        const fields = line.split('|');\n        if (fields.length < 6) {\n            continue;\n        }\n        let placeId = fields[0];\n        if (!placeId.match(/^\\d+$/u)) {\n            // throw new Error('Invalid place id');\n            continue;\n        }\n        place.id = parseInt(placeId, 10);\n        place.title = chooseTitle(decodeTitles(fields[5]));\n        if (fields[6] !== '1') {\n            throw new Error(`Unknown wikimapia polygon encoding type: \"${fields[6]}\"`);\n        }\n\n        let bounds = fields[2].match(/^([-\\d]+),([-\\d]+),([-\\d]+),([-\\d]+)$/u);\n        if (!bounds) {\n            throw new Error('Invalid place bounds');\n        }\n        place.boundsWESN = bounds.slice(1).map((x) => parseInt(x, 10) / 1e7);\n\n        let coords = fields.slice(7).join('|');\n\n        coords = decodePolygon(coords);\n        if (coords.length < 3) {\n            throw new Error(`Polygon has ${coords.length} points`);\n        }\n        let polygon = simplifyPolygon(coords, tile.coords, tile.hasChildren, projectObj);\n        place.polygon = polygon;\n        place.localPolygon = makeCoordsLocal(polygon, tile.coords, projectObj);\n        places.push(place);\n    }\n    return tile;\n}\n\n//   \n// TODO:  50-100   \n// projectPlacesForZoom: function(tile, viewZoom) {\n//     if (viewZoom < tile.coords.z) {\n//         throw new Error('viewZoom < tile.zoom');\n//     }\n//     if (tile.places && tile.places[0] && tile.places[0].projectedPolygons &&\n//         tile.places[0].projectedPolygons[viewZoom]) {\n//         return;\n//     }\n//     const virtualTileSize = 256 * (2 ** (viewZoom - tile.coords.z));\n//     const p1 = L.point([tile.coords.x * virtualTileSize, tile.coords.y * virtualTileSize]),\n//         p2 = L.point([(tile.coords.x + 1) * virtualTileSize, (tile.coords.y + 1) * virtualTileSize]),\n//         latlng1 = this._map.unproject(p1, viewZoom),\n//         latlng2 = this._map.unproject(p2, viewZoom),\n//         lat0 = latlng1.lat,\n//         lng0 = latlng1.lng;\n//     const qx = (p2.x - p1.x) / (latlng2.lng - latlng1.lng),\n//         qy = (p2.y - p1.y) / (latlng2.lat - latlng1.lat);\n//\n//     const offsets = [],\n//         offsetsStep = virtualTileSize / 64;\n//     const y0 = p1.y;\n//     for (let y = -virtualTileSize; y <= 2 * virtualTileSize; y += offsetsStep) {\n//         let lat = y / qy + lat0;\n//         let offset = this._map.project([lat, lng0], viewZoom).y - y0 - y;\n//         offsets.push(offset);\n//     }\n//\n//     let ll, offset, offsetPos, offsetIndex, offsetIndexDelta, x, y;\n//     const x0 = p1.x;\n//     for (let place of tile.places) {\n//         let polygon = place.polygon;\n//         if (polygon.length < 3) {\n//             continue;\n//         }\n//         let projectedPolygon = [];\n//         for (let i = 0; i < polygon.length; i++) {\n//             ll = polygon[i];\n//             x = (ll[1] - lng0) * qx;\n//             y = (ll[0] - lat0) * qy;\n//             offsetPos = (y + virtualTileSize) / offsetsStep;\n//             offsetIndex = Math.floor(offsetPos);\n//             offsetIndexDelta = offsetPos - offsetIndex;\n//             offset = offsets[offsetIndex] * (1 - offsetIndexDelta) + offsets[offsetIndex + 1] * offsetIndexDelta;\n//             projectedPolygon.push([x + x0, y + offset + y0]);\n//         }\n//         projectedPolygon = projectedPolygon.map(L.point);\n//         projectedPolygon = L.LineUtil.simplify(projectedPolygon, 1.5);\n//         if (!place.projectedPolygons) {\n//             place.projectedPolygons = [];\n//         }\n//         place.projectedPolygons[viewZoom] = projectedPolygon;\n//     }\n// },\n\nexport {getTileId, getWikimapiaTileCoords, parseTile, makeTileUrl};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport '~/lib/leaflet.control.commons';\n\nconst originalLayerOnAdd = L.Control.Layers.prototype.onAdd;\n\nL.Control.Layers.include({\n    onAdd: function(map) {\n        const container = originalLayerOnAdd.call(this, map);\n        this._stopContainerEvents();\n        return container;\n    }\n});\n\nconst originalZoomOnAdd = L.Control.Zoom.prototype.onAdd;\n\nL.Control.Zoom.include({\n    onAdd: function(map) {\n        const container = originalZoomOnAdd.call(this, map);\n        this._container = container;\n        this._stopContainerEvents();\n        return container;\n    }\n});\n","import L from 'leaflet';\nimport ko from 'knockout';\nimport './style.css';\nimport '~/lib/leaflet.control.commons';\nimport {RectangleSelect} from './selector';\nimport Contextmenu from '~/lib/contextmenu';\nimport {makeJnxFromLayer, minZoom} from './jnx-maker';\nimport {saveAs} from '~/vendored/github.com/eligrey/FileSaver';\nimport {notify} from '~/lib/notifications';\nimport * as logging from '~/lib/logging';\n\nL.Control.JNX = L.Control.extend({\n        includes: L.Evented,\n\n        initialize: function(layersControl, options) {\n            L.Control.prototype.initialize.call(this, options);\n            this._layersControl = layersControl;\n            this.makingJnx = ko.observable(false);\n            this.downloadProgressRange = ko.observable(1);\n            this.downloadProgressDone = ko.observable(0);\n            this.contextMenu = new Contextmenu(() => this.makeMenuItems());\n        },\n\n        getLayerForJnx: function() {\n            let selectedLayer = {};\n            for (let layerRec of this._layersControl._layers) {\n                let layer = layerRec.layer;\n                if (this._map.hasLayer(layer) && layer.options && layer.options.jnx) {\n                    selectedLayer = {\n                        layer,\n                        layerName: layerRec.name\n                    };\n                }\n            }\n            return selectedLayer;\n        },\n\n        estimateTilesCount: function(maxZoom) {\n            let tilesCount = 0;\n            const bounds = this._selector.getBounds();\n            for (let zoom = minZoom(maxZoom); zoom <= maxZoom; zoom++) {\n                const topLeftTile = this._map.project(bounds.getNorthWest(), zoom).divideBy(256).floor();\n                const bottomRightTile = this._map.project(bounds.getSouthEast(), zoom).divideBy(256).ceil();\n                tilesCount += Math.ceil((bottomRightTile.x - topLeftTile.x) * (bottomRightTile.y - topLeftTile.y));\n            }\n            return tilesCount;\n        },\n\n        makeMenuItems: function() {\n            const {layer, layerName} = this.getLayerForJnx();\n            if (!layer) {\n                return [{text: 'No supported layers'}];\n            }\n            const maxLevel = layer.options.maxNativeZoom || layer.options.maxZoom || 18;\n            const minLevel = Math.max(0, maxLevel - 6);\n\n            const equatorLength = 40075016;\n            const lat = this._selector.getBounds().getCenter().lat;\n            let metersPerPixel = equatorLength / 2 ** maxLevel / 256 * Math.cos(lat / 180 * Math.PI);\n\n            const items = [{text: layerName, header: true}];\n            for (let zoom = maxLevel; zoom >= minLevel; zoom -= 1) {\n                let tilesCount = this.estimateTilesCount(zoom);\n                let fileSizeMb = tilesCount * 0.02;\n                let itemClass = tilesCount > 50000 ? 'jnx-menu-warning' : '';\n                let resolutionString = metersPerPixel.toFixed(2);\n                let sizeString = fileSizeMb.toFixed(fileSizeMb > 1 ? 0 : 1);\n                let item = {\n                    text: `<span class=\"${itemClass}\">Zoom ${zoom} (${resolutionString} m/pixel) &mdash; ${tilesCount} tiles (~${sizeString} Mb)</span>`, // eslint-disable-line max-len\n                    callback: () => this.makeJnx(layer, layerName, zoom),\n                    disabled: this.makingJnx()\n                };\n                items.push(item);\n                metersPerPixel *= 2;\n            }\n            return items;\n        },\n\n        notifyProgress: function(value, maxValue) {\n            this.downloadProgressDone(this.downloadProgressDone() + value);\n            this.downloadProgressRange(maxValue);\n        },\n\n        makeJnx: function(layer, layerName, zoom) {\n            logging.captureBreadcrumb('start making jnx');\n            this.makingJnx(true);\n            this.downloadProgressDone(0);\n\n            const bounds = this._selector.getBounds();\n            const sanitizedLayerName = layerName.toLowerCase().replace(/[ ()]+/u, '_');\n            const fileName = `nakarte.me_${sanitizedLayerName}_z${zoom}.jnx`;\n            const eventId = logging.randId();\n            this.fire('tileExportStart', {\n                eventId,\n                layer,\n                zoom,\n                bounds,\n            });\n            makeJnxFromLayer(layer, layerName, zoom, bounds, this.notifyProgress.bind(this))\n                .then((fileData) => {\n                    saveAs(fileData, fileName, true);\n                    this.fire('tileExportEnd', {eventId, success: true});\n                })\n                .catch((e) => {\n                    logging.captureException(e, 'Failed to create JNX');\n                    this.fire('tileExportEnd', {\n                        eventId,\n                        success: false,\n                        error: e\n                    });\n                    notify(`Failed to create JNX: ${e.message}`);\n                })\n                .then(() => this.makingJnx(false));\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            const container = this._container = L.DomUtil.create('div', 'leaflet-control leaflet-control-jnx');\n            container.innerHTML = `\n                <a class=\"button\" data-bind=\"visible: !makingJnx(), click: onButtonClicked\"\n                 title=\"Make JNX for Garmin receivers\">JNX</a>\n                <div data-bind=\"\n                    component:{\n                        name: 'progress-indicator',\n                        params: {progressRange: downloadProgressRange, progressDone: downloadProgressDone}\n                    },\n                    visible: makingJnx()\"></div>`;\n            ko.applyBindings(this, container);\n            this._stopContainerEvents();\n            return container;\n        },\n\n        removeSelector: function() {\n            if (this._selector) {\n                this._map.removeLayer(this._selector);\n                this._selector = null;\n                this.fire('selectionchange');\n            }\n        },\n\n        addSelector: function(bounds) {\n            if (!bounds) {\n                bounds = this._map.getBounds().pad(-0.25);\n            }\n            this._selector = new RectangleSelect(bounds)\n                .addTo(this._map)\n                .on('change', () => this.fire('selectionchange'))\n                .on('click contextmenu', (e) => {\n                    L.DomEvent.stop(e);\n                    this.contextMenu.show(e);\n                });\n            this.fire('selectionchange');\n        },\n\n        onButtonClicked: function() {\n            if (this._selector) {\n                if (this._selector.getBounds().intersects(this._map.getBounds().pad(-0.05))) {\n                    this.removeSelector();\n                } else {\n                    this.removeSelector();\n                    this.addSelector();\n                }\n            } else {\n                this.addSelector();\n            }\n        },\n    }\n);\n\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\n\nconst RectangleSelect = L.Rectangle.extend({\n        includes: L.Evented,\n\n        options: {\n            opacity: 1,\n            weight: 0.5,\n            fillOpacity: 0.2,\n            color: '#3388ff',\n            fillColor: '#3388ff',\n\n        },\n\n        onAdd: function(map) {\n            L.Rectangle.prototype.onAdd.call(this, map);\n            this.markers = [];\n            for (let position of ['top', 'right', 'bottom', 'left']) {\n                let marker = L.marker([0, 0], {\n                        icon: L.divIcon({className: `leaflet-rectangle-select-edge edge-${position}`}),\n                        draggable: true\n                    }\n                )\n                    .addTo(map);\n                marker.on({\n                        drag: this.onMarkerDrag,\n                        dragend: this.onMarkerDragEnd\n                    }, this\n                );\n                this.markers[position] = marker;\n            }\n            this.placeMarkers();\n            map.on('zoomend', this.placeMarkers, this);\n        },\n\n        placeMarkers: function() {\n            const bounds = this.getBounds();\n            const topLeftPixel = this._map.project(bounds.getNorthWest());\n            const bottomRightPixel = this._map.project(bounds.getSouthEast());\n            const size = bottomRightPixel.subtract(topLeftPixel);\n            let center = topLeftPixel.add(size.divideBy(2));\n            center = this._map.unproject(center);\n            this.markers['top'].setLatLng([bounds.getNorth(), center.lng]);\n            this.markers['top']._icon.style.width = `${size.x}px`;\n            this.markers['top']._icon.style.marginLeft = `-${size.x / 2}px`;\n            this.markers['right'].setLatLng([center.lat, bounds.getEast()]);\n            this.markers['right']._icon.style.height = `${size.y}px`;\n            this.markers['right']._icon.style.marginTop = `-${size.y / 2}px`;\n            this.markers['bottom'].setLatLng([bounds.getSouth(), center.lng]);\n            this.markers['bottom']._icon.style.width = `${size.x}px`;\n            this.markers['bottom']._icon.style.marginLeft = `-${size.x / 2}px`;\n            this.markers['left'].setLatLng([center.lat, bounds.getWest()]);\n            this.markers['left']._icon.style.height = `${size.y}px`;\n            this.markers['left']._icon.style.marginTop = `-${size.y / 2}px`;\n        },\n\n        onRemove: function(map) {\n            for (let marker of Object.values(this.markers)) {\n                this._map.removeLayer(marker);\n            }\n            this.markers = null;\n            map.off('zoomend', this.placeMarkers, this);\n            L.Rectangle.prototype.onRemove.call(this, map);\n        },\n\n        setBoundsFromMarkers: function() {\n            this.setBounds(\n                [\n                    [this.markers['top'].getLatLng().lat, this.markers['left'].getLatLng().lng],\n                    [this.markers['bottom'].getLatLng().lat, this.markers['right'].getLatLng().lng]\n                ]\n            );\n        },\n        onMarkerDrag: function() {\n            this.setBoundsFromMarkers();\n        },\n\n        onMarkerDragEnd: function() {\n            this.setBoundsFromMarkers();\n            this.placeMarkers();\n            this.fire('change');\n        }\n    }\n);\n\nexport {RectangleSelect};\n","import L from 'leaflet';\nimport {JnxWriter} from './jnx-encoder';\nimport {getTempMap, disposeMap} from '~/lib/leaflet.layer.rasterize';\nimport {XHRQueue} from '~/lib/xhr-promise';\nimport {arrayBufferToString, stringToArrayBuffer} from '~/lib/binary-strings';\n\nconst defaultXHROptions = {\n    responseType: 'arraybuffer',\n    timeout: 20000,\n    isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 404\n};\n\nfunction minZoom(maxZoom) {\n    return Math.max(maxZoom - 4, 0);\n}\n\nfunction imageFromarrayBuffer(arr) {\n    const dataUrl = 'data:image/png;base64,' + btoa(arrayBufferToString(arr));\n    const image = new Image();\n    return new Promise(function(resolve, reject) {\n            image.onload = () => resolve(image);\n            image.onerror = () => reject(new Error('Tile image corrupt'));\n            image.src = dataUrl;\n        }\n    );\n}\n\nasync function convertToJpeg(image) {\n    try {\n        image = await imageFromarrayBuffer(image);\n    } catch (e) {\n        return null;\n    }\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = image.width;\n    canvas.height = image.height;\n    const ctx = canvas.getContext(\"2d\");\n    ctx.drawImage(image, 0, 0);\n    const dataURL = canvas.toDataURL(\"image/jpeg\");\n    const s = atob(dataURL.replace(/^data:image\\/jpeg;base64,/u, \"\"));\n    return stringToArrayBuffer(s);\n}\n\nfunction ensureImageJpg(image) {\n    if (!image) {\n        return null;\n    }\n    if (arrayBufferToString(image.slice(0, 4)) === '\\x89PNG' &&\n        arrayBufferToString(image.slice(-8)) === 'IEND\\xae\\x42\\x60\\x82') {\n        return convertToJpeg(image);\n    } else if (arrayBufferToString(image.slice(0, 2)) === '\\xff\\xd8' &&\n        arrayBufferToString(image.slice(-2)) === '\\xff\\xd9') {\n        return Promise.resolve(image);\n    }\n    return null;\n}\n\nasync function makeJnxFromLayer(srcLayer, layerName, maxZoomLevel, latLngBounds, progress) {\n    const jnxProductId = L.stamp(srcLayer);\n    const jnxZOrder = Math.min(jnxProductId, 100);\n    const writer = new JnxWriter(layerName, jnxProductId, jnxZOrder);\n    const xhrQueue = new XHRQueue();\n    let doStop = false;\n    let error;\n    const minZoomLevel = minZoom(maxZoomLevel);\n    let progressWeight = 1;\n    for (let zoom = maxZoomLevel; zoom >= minZoomLevel; zoom--) {\n        let pixelBounds = L.bounds(\n            L.CRS.EPSG3857.latLngToPoint(latLngBounds.getNorthWest(), zoom).round(),\n            L.CRS.EPSG3857.latLngToPoint(latLngBounds.getSouthEast(), zoom).round()\n        );\n\n        let promises = [];\n        let layer = srcLayer.cloneForPrint({xhrQueue});\n        let tempMap = getTempMap(zoom, layer._rasterizeNeedsFullSizeMap, pixelBounds);\n        tempMap.addLayer(layer);\n        let {iterateTilePromises, count: tilesCount} = await layer.getTilesInfo({\n                xhrOptions: defaultXHROptions,\n                pixelBounds,\n                rawData: true\n            }\n        );\n        for (let tilePromiseRec of iterateTilePromises()) {\n            promises.push(tilePromiseRec);\n        }\n        for (let {tilePromise} of promises) {\n            let imageRec;\n            try {\n                imageRec = await tilePromise;\n            } catch (e) {\n                error = e;\n                doStop = true;\n                break;\n            }\n            let xhr = imageRec.image;\n\n            if (xhr === null || xhr.status !== 200 || !xhr.response || !xhr.response.byteLength) {\n                continue;\n            }\n            let image = await ensureImageJpg(xhr.response);\n            if (!image) {\n                error = new Error('Tile image invalid');\n                doStop = true;\n                break;\n            }\n            writer.addTile(image, zoom, imageRec.latLngBounds);\n            progress(progressWeight / tilesCount, 4 / 3);\n        }\n        disposeMap(tempMap);\n        if (doStop) {\n            promises.forEach((promiseRec) => promiseRec.abortLoading());\n            throw error;\n        }\n        progressWeight /= 4;\n    }\n\n    return writer.getJnx();\n}\n\nexport {makeJnxFromLayer, minZoom};\n","import L from 'leaflet';\nimport {BinStream} from './binary-stream';\n\nfunction jnxCoordinates(extents) {\n    function toJnx(x) {\n        return Math.round(x / 180.0 * 0x7fffffff);\n    }\n\n    return [toJnx(extents.north), toJnx(extents.east), toJnx(extents.south), toJnx(extents.west)];\n}\n\nconst JnxWriter = L.Class.extend({\n        initialize: function(productName, productId, zOrder) {\n            this.tiles = {};\n            this.productName = productName || 'Raster map';\n            this.productId = productId || 0;\n            this.zOrder = zOrder;\n        },\n\n        addTile: function(tileData, level, latLngBounds) {\n            this.tiles[level] = this.tiles[level] || [];\n            tileData = new Blob([tileData]).slice(2);\n            const extents = {\n                west: latLngBounds.getWest(),\n                north: latLngBounds.getNorth(),\n                south: latLngBounds.getSouth(),\n                east: latLngBounds.getEast(),\n\n            };\n            this.tiles[level].push({data: tileData, extents: extents});\n        },\n\n        getJnx: function() {\n            const HEADER_SIZE = 52,\n                LEVEL_INFO_SIZE = 17,\n                TILE_INFO_SIZE = 28;\n\n            let totalTilesCount = 0;\n            for (let levelTiles of Object.values(this.tiles)) {\n                totalTilesCount += levelTiles.length;\n            }\n            if (totalTilesCount === 0) {\n                throw new Error('No tiles collected, JNX is empty');\n            }\n            if (totalTilesCount > 50000) {\n                throw new Error('Too many tiles found (more then 50000)');\n            }\n\n            let west = 1e10,\n                east = -1e10,\n                north = -1e10,\n                south = 1e10,\n                levels_n = Object.keys(this.tiles).length,\n                level, tiles, extents,\n                i, tile;\n            for (let levelTiles of Object.values(this.tiles)) {\n                for (let tile of levelTiles) {\n                    west = (west < tile.extents.west) ? west : tile.extents.west;\n                    east = (east > tile.extents.east) ? east : tile.extents.east;\n                    north = (north > tile.extents.north) ? north : tile.extents.north;\n                    south = (south < tile.extents.south) ? south : tile.extents.south;\n                }\n            }\n            const stream = new BinStream(1024, true);\n            // header\n            stream.writeInt32(4); // version\n            stream.writeInt32(0); // device id\n            extents = jnxCoordinates({south: south, north: north, west: west, east: east});\n            stream.writeInt32(extents[0]); // north\n            stream.writeInt32(extents[1]); // west\n            stream.writeInt32(extents[2]); // south\n            stream.writeInt32(extents[3]); // east\n            stream.writeInt32(levels_n); // number of zoom levels\n            stream.writeInt32(0); // expiration date\n            stream.writeInt32(this.productId);\n            stream.writeInt32(0); // tiles CRC32\n            stream.writeInt32(0); // signature version\n            stream.writeUint32(0); // signature offset\n            stream.writeInt32(this.zOrder);\n            stream.seek(HEADER_SIZE + LEVEL_INFO_SIZE * levels_n);\n            // map description\n            stream.writeInt32(9); // section version\n            stream.writeString('12345678-1234-1234-1234-123456789ABC', true); // GUID\n            stream.writeString(this.productName, true);\n            stream.writeString('', true);\n            stream.writeInt16(this.productId);\n            stream.writeString(this.productName, true);\n            stream.writeInt32(levels_n);\n            // levels descriptions\n            for (level of Object.keys(this.tiles)) {\n                stream.writeString('', true);\n                stream.writeString('', true);\n                stream.writeString('', true);\n                stream.writeInt32(level);\n            }\n            let tileDescriptorOffset = stream.tell();\n            // level info\n            let jnxScale;\n            stream.seek(HEADER_SIZE);\n            for (level of Object.keys(this.tiles)) {\n                level = parseInt(level, 10);\n                stream.writeInt32(this.tiles[level].length);\n                stream.writeUint32(tileDescriptorOffset);\n                // jnxScale = JnxScales[level + 3];\n                jnxScale = 34115555 / (2 ** level) * Math.cos((north + south) / 2 / 180 * Math.PI) / 1.1;\n                stream.writeInt32(jnxScale);\n                stream.writeInt32(2);\n                stream.writeUint8(0);\n                tileDescriptorOffset += TILE_INFO_SIZE * this.tiles[level].length;\n            }\n            // tiles descriptors\n            stream.seek(stream.size);\n            let tileDataOffset = tileDescriptorOffset;\n            for (level of Object.keys(this.tiles)) {\n                tiles = this.tiles[level];\n                for (i = 0; i < tiles.length; i++) {\n                    tile = tiles[i];\n                    extents = jnxCoordinates(tile.extents);\n                    stream.writeInt32(extents[0]); // north\n                    stream.writeInt32(extents[1]); // west\n                    stream.writeInt32(extents[2]); // south\n                    stream.writeInt32(extents[3]); // east\n                    stream.writeInt16(256); // width\n                    stream.writeInt16(256); // height\n                    stream.writeInt32(tile.data.size);\n                    stream.writeUint32(tileDataOffset);\n                    tileDataOffset += tile.data.size;\n                }\n            }\n\n            const blob = [];\n            blob.push(stream.getBuffer());\n            for (level of Object.keys(this.tiles)) {\n                tiles = this.tiles[level];\n                for (i = 0; i < tiles.length; i++) {\n                    tile = tiles[i];\n                    blob.push(tile.data);\n                }\n            }\n\n            blob.push('BirdsEye');\n            return new Blob(blob);\n        }\n    }\n);\n\nexport {JnxWriter};\n","import utf8 from 'utf8';\n\nclass BinStream {\n    constructor(size, littlEndian) {\n        this.maxSize = 1024;\n        this.dv = new DataView(new ArrayBuffer(this.maxSize));\n        this._pos = 0;\n        this.size = 0;\n        this.littlEndian = littlEndian;\n    }\n\n    grow() {\n        this.maxSize *= 2;\n        const old_buffer = this.dv.buffer;\n        this.dv = new DataView(new ArrayBuffer(this.maxSize));\n        const newAr = new Uint8Array(this.dv.buffer);\n        const oldAr = new Uint8Array(old_buffer);\n        for (let i = 0; i < oldAr.length; i++) {\n            newAr[i] = oldAr[i];\n        }\n    }\n\n    checkSize(size) {\n        if (this._pos + size >= this.maxSize) {\n            this.grow();\n        }\n        const newPos = this._pos + size;\n        this.size = (newPos > this.size) ? newPos : this.size;\n    }\n\n    writeUint8(value) {\n        this.checkSize(1);\n        this.dv.setUint8(this._pos, value);\n        this._pos += 1;\n    }\n\n    writeInt8(value) {\n        this.checkSize(1);\n        this.dv.setInt8(this._pos, value);\n        this._pos += 1;\n    }\n\n    writeInt16(value) {\n        this.checkSize(2);\n        this.dv.setInt16(this._pos, value, this.littlEndian);\n        this._pos += 2;\n    }\n\n    writeUint16(value) {\n        this.checkSize(2);\n        this.dv.setUint16(this._pos, value, this.littlEndian);\n        this._pos += 2;\n    }\n\n    writeInt32(value) {\n        this.checkSize(4);\n        this.dv.setInt32(this._pos, value, this.littlEndian);\n        this._pos += 4;\n    }\n\n    writeUint32(value) {\n        this.checkSize(4);\n        this.dv.setUint32(this._pos, value, this.littlEndian);\n        this._pos += 4;\n    }\n\n    writeString(s, zeroTerminated) {\n        s = utf8.encode(s);\n        for (let i = 0; i < s.length; i++) {\n            this.writeUint8(s.charCodeAt(i));\n        }\n        if (zeroTerminated) {\n            this.writeUint8(0);\n        }\n    }\n\n    tell() {\n        return this._pos;\n    }\n\n    seek(pos) {\n        this._pos = pos;\n    }\n\n    getBuffer() {\n        return this.dv.buffer.slice(0, this.size);\n    }\n}\n\nexport {BinStream};\n","import L from 'leaflet';\nimport '~/lib/leaflet.hashState/leaflet.hashState';\n\nL.Control.JNX.include(L.Mixin.HashState);\nL.Control.JNX.include({\n        stateChangeEvents: ['selectionchange'],\n\n        serializeState: function() {\n            let state;\n            if (this._selector) {\n                const bounds = this._selector.getBounds();\n                state = [\n                    bounds.getSouth().toFixed(5),\n                    bounds.getWest().toFixed(5),\n                    bounds.getNorth().toFixed(5),\n                    bounds.getEast().toFixed(5)\n                ];\n            }\n            return state;\n        },\n\n        unserializeState: function(values) {\n            function validateFloat(value) {\n                value = parseFloat(value);\n                if (isNaN(value)) {\n                    throw new Error('INVALID VALUE');\n                }\n                return value;\n            }\n\n            function validateFloatRange(value, min, max) {\n                value = validateFloat(value);\n                if (value < min || value > max) {\n                    throw new Error('INVALID VALUE');\n                }\n                return value;\n            }\n\n            if (values && values.length === 4) {\n                let south, west, north, east;\n                try {\n                        south = validateFloatRange(values[0], -86, 86);\n                        west = validateFloat(values[1]);\n                        north = validateFloatRange(values[2], -86, 86);\n                        east = validateFloat(values[3]);\n                } catch (e) {\n                    if (e.message === 'INVALID VALUE') {\n                        return false;\n                    }\n                    throw e;\n                }\n                this.removeSelector();\n                this.addSelector([[south, west], [north, east]]);\n                return true;\n            }\n            return false;\n        }\n    }\n);\n","import L from 'leaflet';\nimport ko from 'knockout';\nimport {makeButtonWithBar} from '~/lib/leaflet.control.commons';\nimport layout from './control.html';\nimport '~/lib/controls-styles/controls-styles.css';\nimport './style.css';\nimport {getDeclination} from '~/lib/magnetic-declination';\nimport 'leaflet-rotatedmarker'; // eslint-disable-line import/no-unassigned-import\nimport iconPointer from './pointer.svg';\nimport iconPointerStart from './pointer-start.svg';\nimport iconPointerEnd from './pointer-end.svg';\nimport {ElevationProfile, calcSamplingInterval} from '~/lib/leaflet.control.elevation-profile';\n\nfunction radians(x) {\n    return x / 180 * Math.PI;\n}\n\nfunction degrees(x) {\n    return x / Math.PI * 180;\n}\n\nfunction calcAzimuth(latlng1, latlng2) {\n    const lat1 = radians(latlng1.lat);\n    const lat2 = radians(latlng2.lat);\n    const lng1 = radians(latlng1.lng);\n    const lng2 = radians(latlng2.lng);\n\n    const y = Math.sin(lng2 - lng1) * Math.cos(lat2);\n    const x = Math.cos(lat1) * Math.sin(lat2) -\n        Math.sin(lat1) * Math.cos(lat2) * Math.cos(lng2 - lng1);\n    let brng = Math.atan2(y, x);\n    brng = degrees(brng);\n    return brng;\n}\n\nfunction calcAngle(latlng1, latlng2) {\n    const p1 = L.Projection.SphericalMercator.project(latlng1);\n    const p2 = L.Projection.SphericalMercator.project(latlng2);\n    const delta = p2.subtract(p1);\n    const angle = Math.atan2(delta.x, delta.y);\n    return degrees(angle);\n}\n\nfunction roundAzimuth(a) {\n    return (Math.round(a) + 360) % 360;\n}\n\nL.Control.Azimuth = L.Control.extend({\n        options: {\n            position: 'bottomleft'\n        },\n\n        includes: L.Evented,\n\n        initialize: function(options) {\n            L.Control.prototype.initialize.call(this, options);\n            this.trueAzimuth = ko.observable(null);\n            this.magneticAzimuth = ko.observable(null);\n            this.distance = ko.observable(null);\n            this.points = {\n                start: null,\n                end: null\n            };\n            const iconSingle = L.icon({iconUrl: iconPointer, iconSize: [30, 30]});\n            const iconStart = L.icon({iconUrl: iconPointerStart, iconSize: [30, 30]});\n            const iconEnd = L.icon({iconUrl: iconPointerEnd, iconSize: [30, 45]});\n            this.azimuthLine = L.polyline([], {interactive: false, weight: 1.5});\n            this.markers = {\n                single: L.marker([0, 0], {icon: iconSingle, draggable: true, which: 'start'})\n                    .on('drag', this.onMarkerDrag, this)\n                    .on('click', L.DomEvent.stopPropagation),\n                start: L.marker([0, 0], {\n                    icon: iconStart,\n                    draggable: true,\n                    which: 'start',\n                    rotationOrigin: 'center center',\n                    projectedShift: () => this.azimuthLine.shiftProjectedFitMapView()\n                })\n                    .on('drag', this.onMarkerDrag, this)\n                    .on('click', L.DomEvent.stopPropagation)\n                    .on('dragend', this.onMarkerDragEnd, this),\n                end: L.marker([0, 0], {\n                    icon: iconEnd,\n                    draggable: true,\n                    which: 'end',\n                    rotationOrigin: 'center center',\n                    projectedShift: () => this.azimuthLine.shiftProjectedFitMapView()\n                })\n                    .on('drag', this.onMarkerDrag, this)\n                    .on('click', L.DomEvent.stopPropagation)\n                    .on('dragend', this.onMarkerDragEnd, this)\n            };\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            const {container, link, barContainer} = makeButtonWithBar(\n                'leaflet-control-azimuth', 'Measure bearing, display line of sight', 'icon-azimuth');\n            this._container = container;\n            L.DomEvent.on(link, 'click', this.onClick, this);\n\n            barContainer.innerHTML = layout;\n            ko.applyBindings(this, barContainer);\n            return container;\n        },\n\n        onClick: function() {\n            if (this.isEnabled()) {\n                this.disableControl();\n            } else {\n                this.enableControl();\n            }\n        },\n\n        onMarkerDrag: function(e) {\n            const marker = e.target;\n            this.setPoints({[marker.options.which]: marker.getLatLng()});\n        },\n\n        onMarkerDragEnd: function() {\n            if (this.elevationControl) {\n                this.showProfile();\n            }\n        },\n\n        enableControl: function() {\n            L.DomUtil.addClass(this._container, 'active');\n            L.DomUtil.addClass(this._container, 'highlight');\n            L.DomUtil.addClass(this._map._container, 'azimuth-control-active');\n            this._map.on('click', this.onMapClick, this);\n            this.fire('enabled');\n            this._map.clickLocked = true;\n            this._enabled = true;\n        },\n\n        disableControl: function() {\n            L.DomUtil.removeClass(this._container, 'active');\n            L.DomUtil.removeClass(this._container, 'highlight');\n            this.hideProfile();\n            this.setPoints({start: null, end: null});\n            L.DomUtil.removeClass(this._map._container, 'azimuth-control-active');\n            this._map.off('click', this.onMapClick, this);\n            this._map.clickLocked = false;\n            this._enabled = false;\n        },\n\n        isEnabled: function() {\n            return Boolean(this._enabled);\n        },\n\n        setPoints: function(points) {\n            Object.assign(this.points, points);\n            points = this.points;\n            if (points.start && !points.end) {\n                this.markers.single\n                    .setLatLng(points.start)\n                    .addTo(this._map);\n            } else {\n                this.markers.single.removeFrom(this._map);\n            }\n            if (points.start && points.end) {\n                const angle = calcAngle(points.start, points.end);\n                this.markers.start\n                    .setLatLng(points.start)\n                    .addTo(this._map)\n                    .setRotationAngle(angle);\n                this.markers.end\n                    .setLatLng(points.end)\n                    .addTo(this._map)\n                    .setRotationAngle(angle);\n                this.azimuthLine\n                    .setLatLngs([[points.start, points.end]])\n                    .addTo(this._map);\n            } else {\n                this.markers.start.removeFrom(this._map);\n                this.markers.end.removeFrom(this._map);\n                this.azimuthLine.removeFrom(this._map);\n            }\n            this.updateValuesDisplay();\n        },\n\n        updateValuesDisplay: function() {\n            if (this.points.start && this.points.end) {\n                const points = this.points;\n                const azimuth = calcAzimuth(points.start, points.end);\n                this.trueAzimuth(roundAzimuth(azimuth));\n                const declination = getDeclination(points.start.lat, points.start.lng);\n                if (declination === null) {\n                    this.magneticAzimuth(null);\n                } else {\n                    this.magneticAzimuth(roundAzimuth(azimuth - declination));\n                }\n                this.distance(points.start.distanceTo(points.end));\n            } else {\n                this.distance(null);\n                this.trueAzimuth(null);\n                this.magneticAzimuth(null);\n            }\n        },\n\n        onMapClick: function(e) {\n            if (!this.points.start && !this.points.end) {\n                this.setPoints({start: e.latlng});\n            } else if (this.points.start && !this.points.end) {\n                this.setPoints({end: e.latlng});\n            } else if (this.points.start && this.points.end) {\n                this.hideProfile();\n                this.setPoints({start: e.latlng, end: null});\n            }\n        },\n\n        showProfile: function() {\n            if (!this.points.end) {\n                return;\n            }\n            if (this.elevationControl) {\n                this.elevationControl.removeFrom(this._map);\n            }\n\n            const dist = this.points.start.distanceTo(this.points.end);\n            this.elevationControl = new ElevationProfile(this._map, [this.points.start, this.points.end], {\n                samplingInterval: calcSamplingInterval(dist),\n                sightLine: true\n            });\n            this.elevationControl.on('remove', () => {\n                this.elevationControl = null;\n            });\n            this.fire('elevation-shown');\n        },\n\n        hideProfile: function() {\n            if (this.elevationControl) {\n                this.elevationControl.removeFrom(this._map);\n            }\n            this.elevationControl = null;\n        },\n\n        onProfileButtonClick: function() {\n            this.showProfile();\n        },\n\n        onReverseButtonClick: function() {\n            if (this.points.end && this.points.start) {\n                this.setPoints({start: this.points.end, end: this.points.start});\n                if (this.elevationControl) {\n                    this.showProfile();\n                }\n            }\n        }\n\n    }\n);\n\n","export default \"<div class=\\\"contents\\\">\\n    <table>\\n        <tr>\\n            <td>True azimuth</td>\\n            <td data-bind=\\\"text: trueAzimuth() !== null ? Math.round(trueAzimuth()) + '&deg;' : '--'\\\"></td>\\n        </tr>\\n        <tr>\\n            <td>Magnetic azimuth</td>\\n            <td data-bind=\\\"text: magneticAzimuth() !== null ? magneticAzimuth() + '&deg;' : '--'\\\"></td>\\n        </tr>\\n        <tr>\\n            <td>Distance</td>\\n            <td data-bind=\\\"text: distance() === null ? '--' :\\n                distance() > 2000 ? (distance() / 1000).toFixed(2) + ' km' : Math.round(distance()) + ' m'\\\"></td>\\n        </tr>\\n    </table>\\n\\n    <div class=\\\"buttons\\\">\\n        <div class=\\\"button\\\" data-bind=\\\"click: onReverseButtonClick\\\">Reverse</div>\\n        <div class=\\\"button\\\" data-bind=\\\"click: onProfileButtonClick\\\">Elevation / Sightline</div>\\n    </div>\\n</div>\";","// extracted by mini-css-extract-plugin\nexport {};","export default \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMzAgMzAiPgogICAgPGc+CiAgICAgICAgPGVsbGlwc2Ugcnk9IjE1IiByeD0iMTUiIGN5PSIxNSIgY3g9IjE1IiBmaWxsPSIjNzc3IiBmaWxsLW9wYWNpdHk9IjAuNSIvPgogICAgICAgIDxlbGxpcHNlIHJ5PSIzIiByeD0iMyIgY3k9IjE1IiBjeD0iMTUiIGZpbGw9IiMzMzg4ZmYiIC8+CiAgICA8L2c+Cjwvc3ZnPg==\"","export default \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMzAgMzAiPgogICAgPGc+CiAgICAgICAgPGVsbGlwc2Ugcnk9IjE1IiByeD0iMTUiIGN5PSIxNSIgY3g9IjE1IiBmaWxsPSIjNzc3IiBmaWxsLW9wYWNpdHk9IjAuNSIvPgogICAgICAgIDxlbGxpcHNlIHJ5PSIzIiByeD0iMyIgY3k9IjE1IiBjeD0iMTUiIGZpbGw9IiMzMzg4ZmYiIC8+CiAgICA8L2c+Cjwvc3ZnPg==\"","export default \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMzAgNDUiPgogICAgPGc+CiAgICAgICAgPGVsbGlwc2Ugcnk9IjE1IiByeD0iMTUiIGN5PSIyNiIgY3g9IjE1IiBmaWxsPSIjNzc3IiBmaWxsLW9wYWNpdHk9IjAuNSIvPgogICAgICAgIDxwYXRoIGQ9Ik0xNSwyMCBsLTUsMTIgbDEwLDAgeiIgZmlsbD0iIzMzODhmZiIvPgogICAgPC9nPgo8L3N2Zz4=\"","import L from 'leaflet';\nimport {makeButton} from '~/lib/leaflet.control.commons';\nimport './style.css';\nimport localStorage from '~/lib/safe-localstorage';\n\nconst STATE_DISABLED = 'disabled';\nconst STATE_LOCATING = 'locating';\nconst STATE_ENABLED = 'enabled';\nconst STATE_ENABLED_FOLLOWING = 'enabled_following';\nconst STATE_MOVING_TO_FOLLOWING = 'moving_to_following';\nconst STATE_MOVING_TO_FOLLOWING_FIRST = 'moving_to_following_first';\nconst STATE_UPDATING_FOLLOWING = 'updating_following';\n\nconst EVENT_INIT = 'init';\nconst EVENT_BUTTON_CLICK = 'button_click';\nconst EVENT_LOCATION_RECEIVED = 'location_received';\nconst EVENT_LOCATION_ERROR = 'location_error';\nconst EVENT_MAP_MOVE = 'user_move';\nconst EVENT_MAP_MOVE_END = 'map_move_end';\n\nconst LOCALSTORAGE_POSITION = 'leaflet_locate_position';\n\nconst PositionMarker = L.LayerGroup.extend({\n    initialize: function(options) {\n        L.LayerGroup.prototype.initialize.call(this, options);\n        this._locationSet = false;\n        this._elements = {\n            accuracyCircle: L.circle([0, 0], {\n                radius: 1,\n                interactive: false,\n                fillColor: '#4271a8',\n                color: '#2ba3f7',\n                weight: 2\n            }),\n            markerCircle: L.circleMarker([0, 0], {\n                interactive: false,\n                radius: 10,\n                color: '#2ba3f7',\n                weight: 2.5,\n                fill: null,\n                opacity: 0.8\n            }),\n            markerPoint: L.circleMarker([0, 0], {\n                interactive: false,\n                radius: 2,\n                weight: 0,\n                color: '#2ba3f7',\n                fillOpacity: 0.8\n            }),\n        };\n        this.addLayer(this._elements.accuracyCircle);\n    },\n\n    onAdd: function(map) {\n        L.LayerGroup.prototype.onAdd.call(this, map);\n        map.on('zoom', this._onZoom, this);\n        this._updatePrecisionState();\n    },\n\n    onRemove: function(map) {\n        map.off('zoom', this._onZoom, this);\n        L.LayerGroup.prototype.onRemove.call(this, map);\n    },\n\n    _updatePrecisionState: function() {\n        if (!this._map || !this._locationSet) {\n            return;\n        }\n        const precise = this._elements.accuracyCircle._radius <= this._elements.markerCircle.options.radius * 0.8;\n        if (precise !== this._precise) {\n            if (precise) {\n                this._elements.accuracyCircle.setStyle({opacity: 0, fillOpacity: 0});\n                this.addLayer(this._elements.markerPoint);\n                this.addLayer(this._elements.markerCircle);\n            } else {\n                this._elements.accuracyCircle.setStyle({opacity: 0.8, fillOpacity: 0.4});\n                this.removeLayer(this._elements.markerPoint);\n                this.removeLayer(this._elements.markerCircle);\n            }\n            this._precise = precise;\n        }\n    },\n\n    setLocation: function(latlng, accuracy) {\n        this._elements.accuracyCircle.setLatLng(latlng);\n        this._elements.accuracyCircle.setRadius(accuracy);\n        this._elements.markerCircle.setLatLng(latlng);\n        this._elements.markerPoint.setLatLng(latlng);\n        this._locationSet = true;\n        this._updatePrecisionState();\n    },\n\n    _onZoom: function() {\n        this._updatePrecisionState();\n    }\n\n});\n\nconst LocateControl = L.Control.extend({\n        // button click behavior:\n        // if button turned off -- turn on, maps follows marker\n        // if button turned on\n        //     if map is following marker -- turn off\n        //     if map not following marker -- center map at marker, start following\n\n        options: {\n            locationAcquireTimeoutMS: Infinity,\n            showError: ({message}) => {\n                alert(message);\n            },\n            maxAutoZoom: 17,\n            minAutoZoomDeltaForAuto: 4,\n            minDistForAutoZoom: 2 // in average screen sizes\n        },\n\n        initialize: function(options) {\n            L.Control.prototype.initialize.call(this, options);\n            this._events = [];\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            const {container, link} = makeButton('leaflet-control-locate', '  ?', 'icon-position');\n            this._container = container;\n            L.DomEvent.on(link, 'click', () => this._handleEvent(EVENT_BUTTON_CLICK));\n            this._marker = new PositionMarker();\n            this._handleEvent(EVENT_INIT);\n            return container;\n        },\n\n        moveMapToCurrentLocation: function(zoom, fallbackLatLng, forceLatLng, forceZoom) {\n            let storedPosition;\n            try {\n                storedPosition = JSON.parse(localStorage.getItem(LOCALSTORAGE_POSITION));\n                let {lat, lon} = storedPosition;\n                if (lat && lon) {\n                    storedPosition = L.latLng(lat, lon);\n                } else {\n                    storedPosition = null;\n                }\n            } catch (e) {\n                // ignore invalid data from localstorage\n            }\n\n            if (storedPosition) {\n                this._map.setView(forceLatLng ? forceLatLng : storedPosition, forceZoom ? forceZoom : zoom, {\n                    animate: false,\n                });\n                if (!('geolocation' in navigator)) {\n                    return;\n                }\n                navigator.geolocation.getCurrentPosition(\n                    (pos) => {\n                        this._storePositionToLocalStorage(pos);\n                        if (!forceLatLng) {\n                            // TODO: check if map has not moved\n                            this._map.setView(L.latLng(pos.coords.latitude, pos.coords.longitude), zoom, {\n                                animate: false,\n                            });\n                        }\n                    },\n                    (e) => {\n                        if (e.code === 1) {\n                            localStorage.removeItem(LOCALSTORAGE_POSITION);\n                        }\n                    }, {\n                    enableHighAccuracy: false,\n                    timeout: 500,\n                    maximumAge: 0\n                });\n            } else {\n                this._map.setView(forceLatLng ? forceLatLng : fallbackLatLng, forceZoom ? forceZoom : zoom,\n                    {animate: false});\n            }\n        },\n\n        _startLocating: function() {\n            if (!('geolocation' in navigator) || !('watchPosition' in navigator.geolocation)) {\n                const error = {code: 0, message: 'Geolocation not supported'};\n                setTimeout(() => {\n                        this._onLocationError(error);\n                    }, 0\n                );\n            }\n            this._watchID = navigator.geolocation.watchPosition(\n                this._onLocationSuccess.bind(this), this._onLocationError.bind(this),\n                {\n                    enableHighAccuracy: true,\n                    timeout: this.options.locationAcquireTimeoutMS,\n                }\n            );\n        },\n\n        _storePositionToLocalStorage: function(pos) {\n            const coords = {lat: pos.coords.latitude, lon: pos.coords.longitude};\n            localStorage.setItem(LOCALSTORAGE_POSITION, JSON.stringify(coords));\n        },\n\n        _onLocationSuccess: function(pos) {\n            this._handleEvent(EVENT_LOCATION_RECEIVED, pos);\n            this._storePositionToLocalStorage(pos);\n        },\n\n        _onLocationError: function(e) {\n            this._handleEvent(EVENT_LOCATION_ERROR, e);\n            if (e.code === 1) {\n                localStorage.removeItem(LOCALSTORAGE_POSITION);\n            }\n        },\n\n        _stopLocating: function() {\n            if (this._watchID && navigator.geolocation) {\n                navigator.geolocation.clearWatch(this._watchID);\n            }\n        },\n\n        _storeLocation: function(position) {\n            this._latlng = L.latLng(position.coords.latitude, position.coords.longitude);\n            this._accuracy = position.coords.accuracy;\n        },\n\n        _updateMarkerLocation: function() {\n            this._marker.setLocation(this._latlng, this._accuracy);\n        },\n\n        _updateMapPositionWhileFollowing: function() {\n            this._updateFollowingStartPosition = this._map.getCenter();\n            this._updateFollowingDestPosition = this._latlng;\n            this._map.panTo(this._latlng);\n        },\n\n        _setViewToLocation: function(preferAutoZoom) {\n            if (!this._map || !this._latlng) {\n                return;\n            }\n\n            // autoZoom -- to fit accuracy cirlce on screen, but not more then options.maxAutoZoom (17)\n            // if current zoom more then options.minAutoZoomDeltaForAuto less then autoZoom, set autoZoom\n            // if map center far from geolocation, set autoZoom\n            // if map center not far from geolocation\n            //      if accuracy circle does not fit at current zoom, zoom out to fit\n            //      if  current zoom is less then minAutoZoomDeltaForAuto less then autoZoom\n            //          or >= autoZoom and circle fits screen, keep current zoom\n\n            const currentZoom = this._map.getZoom();\n            let zoomFitAccuracy = this._map.getBoundsZoom(this._latlng.toBounds(this._accuracy * 2));\n            let autoZoom = zoomFitAccuracy;\n            let newZoom;\n            autoZoom = Math.min(autoZoom, this.options.maxAutoZoom);\n\n            if (preferAutoZoom || autoZoom - currentZoom >= this.options.minAutoZoomDeltaForAuto) {\n                newZoom = autoZoom;\n            } else {\n                const p1 = this._map.project(this._map.getCenter());\n                const p2 = this._map.project(this._latlng);\n                const screenSize = this._map.getSize();\n                const averageScreenSize = (screenSize.x + screenSize.y) / 2;\n                if (p1.distanceTo(p2) > averageScreenSize * this.options.minDistForAutoZoom) {\n                    newZoom = autoZoom;\n                } else {\n                    newZoom = currentZoom > zoomFitAccuracy ? zoomFitAccuracy : currentZoom;\n                }\n            }\n            this._map.setView(this._latlng, newZoom);\n        },\n\n        _onMapMove: function() {\n            this._handleEvent(EVENT_MAP_MOVE);\n        },\n\n        _onMapMoveEnd: function() {\n            const ll = this._map.getCenter();\n            setTimeout(() => {\n                    if (this._map.getCenter().equals(ll)) {\n                        this._handleEvent(EVENT_MAP_MOVE_END);\n                    }\n                }, 100\n            );\n        },\n\n        _isMapOffsetFromFollowingSegment: function() {\n            if (this._updateFollowingStartPosition) {\n                const p = this._map.project(this._map.getCenter());\n                const p1 = this._map.project(this._updateFollowingStartPosition);\n                const p2 = this._map.project(this._updateFollowingDestPosition);\n                return L.LineUtil.pointToSegmentDistance(p, p1, p2) > 5;\n            }\n            return true;\n        },\n\n        _isMapCenteredAtLocation: function() {\n            if (!this._latlng || !this._map) {\n                return false;\n            }\n            let p1 = this._map.project(this._latlng);\n            let p2 = this._map.project(this._map.getCenter());\n            return p1.distanceTo(p2) < 5;\n        },\n\n        _updateButtonClasses: function(add, remove) {\n            for (let cls of add) {\n                L.DomUtil.addClass(this._container, cls);\n            }\n            for (let cls of remove) {\n                L.DomUtil.removeClass(this._container, cls);\n            }\n        },\n\n        _setEvents: function(on) {\n            const f = on ? 'on' : 'off';\n            this._map[f]('move', this._onMapMove, this);\n            this._map[f]('moveend', this._onMapMoveEnd, this);\n        },\n\n        _handleEvent: function(event, data) {\n            this._events.push({event, data});\n            if (!this._processingEvent) {\n                this._processingEvent = true;\n                while (this._events.length) {\n                    this._processEvent(this._events.shift());\n                }\n                this._processingEvent = false;\n            }\n        },\n\n        _processEvent: function({event, data}) { // eslint-disable-line complexity\n            // console.log('PROCESS EVENT', event);\n            const state = this._state;\n            switch (event) {\n                case EVENT_INIT:\n                    this._setState(STATE_DISABLED);\n                    break;\n                case EVENT_BUTTON_CLICK:\n                    if (state === STATE_DISABLED) {\n                        this._setState(STATE_LOCATING);\n                    } else if (state === STATE_ENABLED) {\n                        this._setState(STATE_MOVING_TO_FOLLOWING);\n                        this._setViewToLocation();\n                    } else {\n                        this._setState(STATE_DISABLED);\n                    }\n                    break;\n                case EVENT_LOCATION_RECEIVED:\n                    if (state === STATE_DISABLED) {\n                        return;\n                    }\n                    this._storeLocation(data);\n                    this._updateMarkerLocation();\n                    if (state === STATE_LOCATING || state === STATE_MOVING_TO_FOLLOWING_FIRST) {\n                        this._setViewToLocation(true);\n                        this._setState(STATE_MOVING_TO_FOLLOWING_FIRST);\n                    } else if (state === STATE_MOVING_TO_FOLLOWING) {\n                        this._setViewToLocation();\n                    } else if (this._state === STATE_ENABLED_FOLLOWING || state === STATE_UPDATING_FOLLOWING) {\n                        this._updateMapPositionWhileFollowing();\n                        this._setState(STATE_UPDATING_FOLLOWING);\n                    }\n                    break;\n                case EVENT_LOCATION_ERROR:\n                    if (state === STATE_DISABLED) {\n                        return;\n                    }\n                    this.options.showError(data);\n                    this._setState(STATE_DISABLED);\n                    break;\n                case EVENT_MAP_MOVE:\n                    if (state === STATE_ENABLED_FOLLOWING) {\n                        if (!this._isMapCenteredAtLocation() && this._isMapOffsetFromFollowingSegment()) {\n                            this._setState(STATE_ENABLED);\n                        }\n                    }\n                    break;\n                case EVENT_MAP_MOVE_END:\n                    if (state === STATE_MOVING_TO_FOLLOWING) {\n                        if (this._isMapCenteredAtLocation()) {\n                            this._setState(STATE_ENABLED_FOLLOWING);\n                        } else {\n                            this._setState(STATE_ENABLED);\n                        }\n                    } else if (state === STATE_UPDATING_FOLLOWING || state === STATE_MOVING_TO_FOLLOWING_FIRST) {\n                        if (this._isMapCenteredAtLocation() || !this._isMapOffsetFromFollowingSegment()) {\n                            this._setState(STATE_ENABLED_FOLLOWING);\n                        } else {\n                            this._setState(STATE_ENABLED);\n                        }\n                    }\n                    break;\n                default:\n            }\n        },\n\n        _setState: function(newState) {\n            const oldState = this._state;\n            if (oldState === newState) {\n                return;\n            }\n            // console.log(`STATE: ${oldState} -> ${newState}`);\n            switch (newState) {\n                case STATE_LOCATING:\n                    this._startLocating();\n                    this._updateButtonClasses(['requesting'], ['active', 'following']);\n                    this._setEvents(true);\n                    break;\n                case STATE_DISABLED:\n                    this._stopLocating();\n                    this._marker.removeFrom(this._map);\n                    this._setEvents(false);\n                    this._updateButtonClasses([], ['active', 'highlight', 'following', 'requesting']);\n                    break;\n                case STATE_ENABLED:\n                    this._updateButtonClasses(['active', 'highlight'], ['following', 'requesting']);\n                    break;\n                case STATE_MOVING_TO_FOLLOWING_FIRST:\n                    this._marker.addTo(this._map);\n                    break;\n                case STATE_ENABLED_FOLLOWING:\n                    this._updateButtonClasses(['active', 'highlight', 'following'], ['requesting']);\n                    break;\n                default:\n            }\n            this._state = newState;\n        },\n    }\n);\n\nexport {LocateControl};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport './style.css';\n\nconst ZoomWithDisplay = L.Control.Zoom.extend({\n    onAdd: function(map) {\n        const container = L.Control.Zoom.prototype.onAdd.call(this, map);\n        this._display = L.DomUtil.create('div', 'leaflet-control-zoom-display');\n        container.insertBefore(this._display, this._zoomOutButton);\n        map.on('zoomend', this._updateDisplay, this);\n        this._updateDisplay();\n        return container;\n    },\n\n    onRemove: function(map) {\n        L.Control.Zoom.prototype.onRemove.call(this, map);\n        map.off('zoomend', this._updateDisplay, this);\n    },\n\n    _updateDisplay: function() {\n        this._display.innerHTML = this._map.getZoom();\n    }\n\n});\n\nexport default ZoomWithDisplay;\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\n\nimport '~/lib/leaflet.hashState/leaflet.hashState';\n\nimport './style.css';\n\nconst Placemark = L.Marker.extend({\n    initialize: function(latlng, title) {\n        this.title = title;\n        const icon = L.divIcon({\n            html: '<div class=\"lealfet-placemark-title\"></div>',\n            className: 'leaflet-placemark',\n        });\n        L.Marker.prototype.initialize.call(this, latlng, {icon});\n    },\n\n    getTitle: function() {\n        return this.title;\n    },\n\n    onAdd: function(map) {\n        L.Marker.prototype.onAdd.call(this, map);\n        this.getElement().children[0].innerHTML = this.title;\n        this.on('click', this.onClick, this);\n        map.on('click', this.onMapClick, this);\n        map.suggestedPoint = {latlng: this.getLatLng(), title: this.title};\n    },\n\n    onRemove: function(map) {\n        this._map.off('move', this.onMapMove, this);\n        this._map.off('click', this.onMapClick, this);\n        this._map.suggestedPoint = null;\n        L.Marker.prototype.onRemove.call(this, map);\n    },\n\n    onClick: function() {\n        this._map.fire('click', {latlng: this.getLatLng(), suggested: true});\n        this._map.removeLayer(this);\n    },\n\n    onMapClick: function(e) {\n        if (!e.suggested) {\n            this._map.removeLayer(this);\n        }\n    },\n});\n\nL.Map.include({\n    showPlacemark: function(latlng, title) {\n        if (this._placemark) {\n            this.removeLayer(this._placemark);\n        }\n        this._placemark = new Placemark(latlng, title);\n        this.addLayer(this._placemark);\n        this.fire('placemarkshow');\n        this._placemark.on('remove', this.onPlacemarkRemove, this);\n    },\n\n    onPlacemarkRemove: function() {\n        this._placemark = null;\n        this.fire('placemarkhide');\n    },\n});\n\nconst PlacemarkHashStateInterface = L.Class.extend({\n    includes: L.Mixin.HashState,\n\n    stateChangeEvents: ['placemarkshow', 'placemarkhide'],\n\n    initialize: function(map) {\n        this.map = map;\n        this.stateChangeEventsSource = 'map';\n    },\n\n    serializeState: function() {\n        const placemark = this.map._placemark;\n        if (!placemark) {\n            return null;\n        }\n        const latlng = placemark.getLatLng();\n        return [latlng.lat.toFixed(6), latlng.lng.toFixed(6), encodeURIComponent(placemark.getTitle())];\n    },\n\n    unserializeState: function(values) {\n        if (!values) {\n            return false;\n        }\n        const lat = parseFloat(values[0]);\n        const lng = parseFloat(values[1]);\n        const title = decodeURIComponent(values[2] ?? '');\n        if (isNaN(lat) || isNaN(lng) || lat < -90 || lat > 90 || lng < -180 || lng > 180) {\n            return false;\n        }\n        this.map.showPlacemark(L.latLng(lat, lng), title);\n        return true;\n    },\n});\n\nL.Map.include({\n    getPlacemarkHashStateInterface: function() {\n        return new PlacemarkHashStateInterface(this);\n    },\n});\n","// extracted by mini-css-extract-plugin\nexport {};"],"sourceRoot":""}