{"version":3,"sources":["webpack:///./src/lib/CORSProxy/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/baseService.js","webpack:///./src/lib/xhr-promise/index.js","webpack:///./src/lib/leaflet.control.commons/index.js","webpack:///./src/lib/notifications/index.js","webpack:///./src/lib/logging/index.js","webpack:///./src/config.js","webpack:///./src/lib/binary-strings/index.js","webpack:///./src/lib/controls-styles/controls-styles.css","webpack:///./src/lib/leaflet.hashState/leaflet.hashState.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/gpx.js","webpack:///./src/lib/contextmenu/index.js","webpack:///./src/lib/safe-localstorage/index.js","webpack:///./src/lib/leaflet.layer.canvasMarkers/index.js","webpack:///./src/lib/leaflet.fixes/fixWorldCopyJump.js","webpack:///./src/vendored/github.com/eligrey/FileSaver.js","webpack:///./src/lib/leaflet.control.track-list/track-list.js","webpack:///./src/lib/leaflet.hashState/hashState.js","webpack:///./src/lib/leaflet.control.printPages/decorations.js","webpack:///./src/lib/clipboardCopy/index.js","webpack:///./src/lib/tiled-data-loader/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/parseGeoFile.js","webpack:///./src/lib/stripBom/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/loadFromUrl.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/nktk.js","webpack:///./src/lib/anyElementResizeEvent/index.js","webpack:///./src/lib/knockout.component.progress/progress.js","webpack:///./src/lib/leaflet.layer.rasterize/index.js","webpack:///./src/lib/leaflet.layer.rasterize/TileLayer.js","webpack:///./src/lib/leaflet.layer.yandex/index.js","webpack:///./src/lib/leaflet.layer.google/index.js","webpack:///./src/lib/leaflet.layer.westraPasses/westraPassesMarkers.js","webpack:///./src/lib/popup-window/index.js","webpack:///./src/lib/iconFromBackgroundImage/index.js","webpack:///./src/lib/leaflet.layer.rasterize/CanvasMarkers.js","webpack:///./src/lib/leaflet.polyline-measure/index.js","webpack:///./src/lib/leaflet.layer.RetinaTileLayer/index.js","webpack:///./src/lib/magnetic-declination/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/common/style.css","webpack:///./src/lib/leaflet.events.drag/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/xmlUtils.js","webpack:///./src/vendored/github.com/augustl/js-unzip/js-unzip.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/jsInflate.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/codePages.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/nakarte/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/urlSafeBase64.js","webpack:///./src/lib/leaflet.control.elevation-profile/index.js","webpack:///./src/lib/elevations/index.js","webpack:///./src/lib/leaflet.control.layers.top-row/index.js","webpack:///./src/lib/leaflet.control.azimuth/pointer.svg","webpack:///./src/index.js","webpack:///./src/index.css","webpack:///./src/App.js","webpack:///./src/App.css","webpack:///./src/leaflet-fixes.css","webpack:///./src/lib/leaflet.map.sidebars/index.js","webpack:///./src/lib/leaflet.map.sidebars/style.css","webpack:///./src/lib/leaflet.control.printPages/control.js","webpack:///./src/lib/knockout.component.progress/style.css","webpack:///./src/lib/leaflet.control.printPages/control.css","webpack:///./src/lib/leaflet.control.printPages/pageFeature.js","webpack:///./src/lib/leaflet.control.printPages/page-feature.css","webpack:///./src/lib/contextmenu/contextmenu.css","webpack:///./src/lib/leaflet.control.printPages/map-render.js","webpack:///./src/secrets.js","webpack:///./src/lib/leaflet.layer.rasterize/imgFromDataString.js","webpack:///./src/lib/leaflet.layer.rasterize/Bing.js","webpack:///./src/lib/leaflet.layer.bing/index.js","webpack:///./src/lib/leaflet.layer.rasterize/Yandex.js","webpack:///./src/lib/leaflet.layer.yandex/style.css","webpack:///./src/lib/leaflet.layer.rasterize/Google.js","webpack:///./src/lib/leaflet.layer.rasterize/WestraPasses.js","webpack:///./src/lib/leaflet.layer.westraPasses/index.js","webpack:///./src/lib/leaflet.layer.westraPasses/westraPasses.css","webpack:///./src/lib/leaflet.layer.geojson-ajax/index.js","webpack:///./src/lib/notifications/style.css","webpack:///./src/lib/leaflet.layer.canvasMarkers/canvasMarkers.css","webpack:///./src/lib/leaflet.layer.rasterize/MeasuredLine.js","webpack:///./src/lib/leaflet.polyline-measure/measured_line.css","webpack:///./src/lib/leaflet.layer.rasterize/RetinaTileLayer.js","webpack:///./src/lib/leaflet.control.printPages/form.html","webpack:///./src/lib/leaflet.control.printPages/pdf.js","webpack:///./src/lib/leaflet.control.commons/style.css","webpack:///./src/lib/leaflet.control.printPages/decoration.magnetic-meridians.js","webpack:///./src/lib/leaflet.control.printPages/decoration.scale.js","webpack:///./src/lib/leaflet.control.printPages/decoration.grid.js","webpack:///./src/lib/leaflet.control.caption/index.js","webpack:///./src/lib/leaflet.control.caption/style.css","webpack:///./src/lib/leaflet.control.coordinates/index.js","webpack:///./src/lib/leaflet.control.coordinates/coordinates.css","webpack:///./src/lib/clipboardCopy/style.css","webpack:///./src/lib/leaflet.control.coordinates/formats.js","webpack:///./src/lib/leaflet.control.layers.hotkeys/index.js","webpack:///./src/lib/leaflet.control.layers.hotkeys/style.css","webpack:///./src/lib/leaflet.hashState/Leaflet.Map.js","webpack:///./src/lib/leaflet.hashState/Leaflet.Control.Layers.js","webpack:///./src/lib/leaflet.fixes/index.js","webpack:///./src/lib/leaflet.fixes/style.css","webpack:///./src/adaptive.css","webpack:///./src/lib/leaflet.control.panoramas/index.js","webpack:///./src/lib/leaflet.control.panoramas/style.css","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/mapillary-coverage-layer.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/mapillary-loader.js","webpack:///./src/lib/cache/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/mvt.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/vector_tile_pb.js","webpack:///./src/lib/leaflet.control.panoramas/lib/mapillary/style.css","webpack:///./src/lib/leaflet.control.panoramas/lib/common/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/wikimedia/index.js","webpack:///./src/lib/leaflet.control.panoramas/lib/wikimedia/coverage-layer.js","webpack:///./src/lib/leaflet.control.panoramas/lib/wikimedia/style.css","webpack:///./src/lib/leaflet.control.track-list/track-list.css","webpack:///./src/lib/file-read/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/zip.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/kml.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/ozi.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/index.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/simpleService.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/endomondo.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/etomesto.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/gpsies.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/urlEncode.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/gpslib.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/osm.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/strava.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/tracedetrail.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/yandex.js","webpack:///./src/lib/leaflet.control.track-list/lib/parsers/nktk_pb.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/nakarte/loadTracksFromJson.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/movescount.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/garmin.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/sportstracker.js","webpack:///./src/lib/leaflet.control.track-list/lib/services/openstreetmapRu.js","webpack:///./src/lib/leaflet.control.track-list/lib/geo_file_exporters.js","webpack:///./src/lib/leaflet.lineutil.simplifyLatLngs/index.js","webpack:///./src/lib/leaflet.control.elevation-profile/elevation-profile.css","webpack:///./src/lib/leaflet.polyline-edit/index.js","webpack:///./src/lib/leaflet.polyline-edit/edit_line.css","webpack:///./src/lib/leaflet.control.track-list/lib/meridian180.js","webpack:///./src/lib/leaflet.control.track-list/control-ruler.js","webpack:///./src/lib/leaflet.control.track-list/ruler.css","webpack:///./src/lib/leaflet.control.track-list/track-list.hash-state.js","webpack:///./src/lib/leaflet.control.track-list/track-list.localstorage.js","webpack:///./src/lib/leaflet.control.layers.minimize/index.js","webpack:///./src/lib/leaflet.control.layers.minimize/style.css","webpack:///./src/lib/leaflet.control.layers.top-row/style.css","webpack:///./src/lib/leaflet.control.layers.configure/index.js","webpack:///./src/lib/leaflet.control.layers.configure/style.css","webpack:///./src/lib/leaflet.control.layers.configure/customLayer.js","webpack:///./src/lib/leaflet.controls.raise-on-focus/index.js","webpack:///./src/lib/leaflet.controls.raise-on-focus/style.css","webpack:///./src/layers.js","webpack:///./src/lib/leaflet.layer.soviet-topomaps-grid/index.js","webpack:///./src/lib/leaflet.layer.soviet-topomaps-grid/style.css","webpack:///./src/lib/leaflet.layer.wikimapia/index.js","webpack:///./src/lib/leaflet.layer.wikimapia/wikimapia-loader.js","webpack:///./src/lib/leaflet.layer.wikimapia/wm-utils.js","webpack:///./src/lib/leaflet.layer.wikimapia/style.css","webpack:///./src/lib/leaflet.control.layers.events/index.js","webpack:///./src/lib/leaflet.control.jnx/index.js","webpack:///./src/lib/leaflet.control.jnx/style.css","webpack:///./src/lib/leaflet.control.jnx/selector.js","webpack:///./src/lib/leaflet.control.jnx/jnx-maker.js","webpack:///./src/lib/leaflet.control.jnx/jnx-encoder.js","webpack:///./src/lib/leaflet.control.jnx/binary-stream.js","webpack:///./src/lib/leaflet.control.jnx/hash-state.js","webpack:///./src/lib/leaflet.control.azimuth/index.js","webpack:///./src/lib/leaflet.control.azimuth/control.html","webpack:///./src/lib/leaflet.control.azimuth/style.css","webpack:///./src/lib/leaflet.control.azimuth/pointer-start.svg","webpack:///./src/lib/leaflet.control.azimuth/pointer-end.svg","webpack:///./src/lib/leaflet.control.locate/index.js","webpack:///./src/lib/leaflet.control.locate/style.css","webpack:///./src/lib/leaflet.control.zoom-display/index.js","webpack:///./src/lib/leaflet.control.zoom-display/style.css","webpack:///./src/lib/leaflet.placemark/index.js","webpack:///./src/lib/leaflet.placemark/style.css","webpack:///./src/lib/leaflet.control.weather/index.js","webpack:///./src/lib/leaflet.control.weather/style.css"],"names":["url","config","CORSProxyUrl","replace","this","origUrl","Error","isOurUrl","requests","requestOptions","map","it","fetch","options","Promise","all","responses","name","error","parseResponse","decodeURIComponent","e","split","pop","promise","XMLHttpRequestPromise","send","successIfStatus200","xhr","status","retryIfNetworkErrorOrServerError","XMLHttpRequestPromiseError","message","method","data","responseType","timeout","maxTries","retryTimeWait","isResponseSuccess","responseNeedsRetry","headers","withCredentials","resolve","reject","_resolve","_reject","then","bind","postData","_isResponseSuccess","_responseNeedsRetry","_retryTimeWait","triesLeft","XMLHttpRequest","onreadystatechange","_onreadystatechange","_open","k","v","setRequestHeader","open","readyState","_aborted","responseBinaryText","response","byteLength","arrayBufferToString","responseJSON","JSON","parse","_timerId","setTimeout","clearTimeout","abort","XHRQueue","maxSimultaneousRequests","_maxConnections","_queue","_activeCount","_originalAbort","_abortPromise","push","_processQueue","i","indexOf","splice","length","shift","_onRequestReady","containerClass","title","iconClass","cls","container","L","DomUtil","create","makeButton","buttonContainer","link","icon","appendChild","barContainer","stopContainerEvents","DomEvent","disableClickPropagation","disableScrollPropagation","on","stop","noControlClass","href","preventDefault","Control","include","_stopContainerEvents","_container","onOk","alertify","alert","value","result","window","prompt","activeElement","document","tagName","blur","msg","extra","location","toString","console","log","Sentry","withScope","scope","setExtras","captureMessage","description","setTag","setExtra","captureException","addBreadcrumb","eventName","randId","Math","random","substring","caption","defaultLocation","defaultZoom","googleApiUrl","secrets","google","westraDataBaseUrl","elevationsServer","wikimediaCommonsCoverageUrl","geocachingSuUrl","tracksStorageServer","apiServer","weatherServer","stringToArrayBuffer","s","buf","ArrayBuffer","arr","Uint8Array","charCodeAt","arBuf","chunk","subarray","String","fromCharCode","apply","join","Blob","type","Mixin","HashState","enableHashState","key","defaultInitialState","_hashStateKey","eventSource","stateChangeEventsSource","stateChangeEvents","forEach","event","_onControlStateChanged","hashState","addEventListener","state","_onExternalStateChanged","getState","unserializeState","updateState","serializeState","logging","txt","preferNameFromFile","dom","getSegmentPoints","segment_element","points_elements","getElementsByTagName","points","point_element","lat","parseFloat","getAttribute","lng","isNaN","getRoutePoints","rte_element","DOMParser","parseFromString","documentElement","nodeName","trkName","xmlGetNodeText","tracks","xml","segments","segments_elements","segment_points","getTrackSegments","concat","routes","rte_elements","rte_points","getRoutes","waypoint_elements","waypoints","waypoint_element","waypoint","wptName","symbol_name","getWaypoints","items","keyCode","hide","parent","child","parentNode","isDescendant","target","originalEvent","returnValue","x","clientX","y","clientY","createElement","body","className","style","zIndex","onKeyDown","onMouseDown","createItems","item","setPosition","removeChild","removeEventListener","window_width","innerWidth","window_height","innerHeight","menu_width","offsetWidth","menu_height","offsetHeight","left","top","itemOptions","separator","createSeparator","createItem","el","disabled","header","innerHTML","text","callback","onItemClick","stopPropagation","storage","localStorage","setItem","getItem","localStorageWorks","_storage","n","Object","keys","removeItem","clear","calcIntersectionSum","rect","rects","right","bottom","rect2","sum","max","minX","min","maxX","minY","maxY","MarkerRBush","marker","latlng","a","b","RBush","Layer","CanvasMarkers","GridLayer","extend","async","labelFontName","labelFontSize","iconScale","pane","updateWhenZooming","Browser","mobile","iconsOpacity","labelShadowWidth","initialize","markers","prototype","call","rtree","_regions","_iconPositions","_labelPositions","_labelPositionsZoom","addMarkers","_images","_tileQueue","_hoverMarker","onMarkerEnter","onMarkerLeave","load","resetLabels","redraw","addMarker","insert","removeMarker","removeMarkers","remove","updateMarkers","updateMarker","setMarkerPosition","getMarkers","findLabelPosition","iconCenter","iconSize","textWidth","textHeight","pixelExtents","xPositions","yPositions","minIntersectionSum","Infinity","bestX","bestY","tileW","tileE","tileN","tileS","intersectionSum","search","preloadIcons","urls","newUrls","filter","images","image","src","createTile","coords","done","canvas","width","tileSize","height","drawTile","selectMarkersForDraw","zoom","withoutPadding","_map","iconsHorPad","iconsVertPad","labelsHorPad","labelsVertPad","iconsBounds","latLngBounds","unproject","point","labelsBounds","iconUrls","markerJobs","pointsForMarkers","getWest","getSouth","getEast","getNorth","pointsForLabels","tileMidLongitude","noWrap","wrapLatLngToTarget","p","project","stamp","projectedXY","drawSelectedMarkers","limitLabelsToImage","ctx","getContext","font","Util","template","size","entries","markerId","job","img","imgW","round","imgH","center","isLabel","label","measureText","regionsInTile","region","textBaseline","shadowColor","strokeStyle","fillStyle","lineWidth","shadowBlur","strokeText","fillText","globalAlpha","drawImage","z","findMarkerFromMouseEvent","wrap","onMouseMove","fire","showTooltip","tooltip","toolTip","latLngToLayerPoint","addClass","cursor","removeClass","onMouseOut","onClick","clickLocked","onRightClick","onAdd","getPane","createPane","getPanes","markerPane","onRemove","off","Polyline","shiftProjectedFitMapView","polylineBounds","getBounds","isValid","worldWidth","getPixelWorldBounds","getSize","polylineCenter","getCenter","mapCenter","_projectLatlngs","latlngs","projectedBounds","ring","flat","LatLng","len","projectedShift","Marker","update","_icon","pos","_latlng","_setPos","Map","addInitHook","_lastResetLongitude","abs","Handler","MarkerDrag","_onDrag","_marker","shadow","_shadow","iconPos","getPosition","layerPointToLatLng","oldLatLng","_oldLatLng","targetLng","shiftLongitudeToTarget","p1","getSouthEast","p2","getNorthWest","LatLngBounds","latLng","saveAs","view","navigator","test","userAgent","doc","get_URL","URL","webkitURL","save_link","createElementNS","can_use_save_link","is_safari","HTMLElement","safari","is_chrome_ios","setImmediate","throw_outside","ex","revoke","file","revokeObjectURL","auto_bom","blob","FileSaver","no_auto_bom","object_url","filesaver","force","dispatch_all","event_types","listener","dispatch","INIT","createObjectURL","node","download","MouseEvent","dispatchEvent","DONE","FileReader","reader","onloadend","undefined","readAsDataURL","fs_error","FS_proto","msSaveOrOpenBlob","WRITING","onwritestart","onprogress","onwrite","onabort","onerror","onwriteend","self","TRACKLIST_TRACK_COLORS","TrackSegment","MeasuredLine","includes","EditMixin","weight","lineCap","opacity","unwrapLatLngsCrossing180Meridian","latngs","lastUnwrapped","unwrapped","prevUnwrapped","closestPointToLineSegment","segmentIndex","crs","CRS","EPSG3857","latLngToPoint","segStart","segEnd","pointToLatLng","LineUtil","closestPointOnSegment","isPointCloserToStart","distanceTo","mergeOptions","EditMixinOptions","TrackList","position","lineCursorStyle","interactive","dashArray","lineCursorValidStyle","color","lineCursorInvalidStyle","splitExtensions","splitExtensionsFirstStage","Evented","colors","currentGroup","ko","observable","observableArray","readingFiles","readProgressRange","readProgressDone","_lastTrackColor","trackListHeight","isPlacingPoint","trackAddingPoint","trackAddingSegment","filteredTracks","computed","current_group","utils","arrayFilter","element","group","subscribe","changes","shared","setTab","obj","tab","setCurrentGroup","base_loaded","querySelector","base_tab","classList","add","removeAll","applyBindings","addListener","getContainer","onFileDragDrop","onFileDraging","menu","Contextmenu","copyAllTracksToClipboard","copyVisibleTracks","deleteAllTracks","deleteHiddenTracks","_markerLayer","print","scaleDependent","printTransparent","addTo","onMarkerClick","_setAdaptiveHeight","showDefaultTracklist","valueHasMutated","showSharedTracklist","defaultEventHandle","_","maxHeight","offsetTop","setExpanded","setMinimized","dataTransfer","dropEffect","files","loadFilesFromFilesObject","onEnterPressedInInput","this_","loadFilesFromUrl","getTrackPolylines","track","feature","getLayers","layer","getTrackPoints","onButtonNewTrackClicked","trim","addTrackAndEdit","addSegmentAndEdit","stopPlacingPoint","segment","addTrackSegment","startEditTrackSegement","startDrawingLine","addTrack","readFiles","fileDataArray","geodataArray","fileData","filename","addTracksFromGeodataArray","loadFilesFromDisk","captureBreadcrumb","selectFiles","trackUrl","geodata","whenLoadDone","cb","subscription","dispose","geodata_array","origin","hasData","messages","data_empty","line","simplifyLatlngs","fitBounds","CORRUPT","UNSUPPORTED","NETWORK","INVALID_URL","notify","onTrackColorChanged","polyline","setStyle","setMarkerIcon","onTrackVisibilityChanged","visible","addLayer","removeLayer","updateTrackHighlight","onTrackSegmentNodesChanged","getFixedLatLngs","recalculateTrackLength","getLength","formatLength","digits","toFixed","setTrackMeasureTicksVisibility","measureTicksShown","setMeasureTicksVisible","switchMeasureTicksVisibility","onColorSelectorClicked","_contextmenu","show","setViewToTrack","setViewToBounds","getTrackBounds","setViewToAllTracks","immediate","bounds","wrapLatLngBoundsToTarget","maxZoom","flyToBounds","lines","l","getLatLngs","attachColorSelector","index","attachActionsMenu","renameTrack","duplicateTrack","reverseTrack","showElevationProfileForTrack","removeTrack","saveTrackAsFile","geoExporters","saveGpx","saveKml","copyTrackLinkToClipboard","saveGpxWithElevations","_actionsMenu","onButtonAddSegmentClicked","stopEditLine","reverseTrackSegment","trackSegment","stopDrawingLine","ll","reverse","isEdited","_editedLine","deleteTrackSegment","newTrackSegment","_parentTrack","that","copyTracksLinkToClipboard","mouseEvent","serialized","trackToString","hashDigest","btoa","responseText","exporter","extension","addElevations","splitLinesAt180Meridian","extensions","lastIndexOf","slice","toLowerCase","request","reduce","acc","cur","ElevationProvider","get","elevations","alt","fileText","blobFromString","newName","query","showTrackMenu","showMenu","stopEdit","onTrackSegmentClick","_lineJoinActive","joinTrackSegments","startEdit","once","onLineEditEnd","onButtonAddPointClicked","beginPointCreate","_beginPointEdit","stopPlacingPointOnEscPressed","beginPointMove","_movingMarker","movePoint","createNewPoint","newLatLng","getNewPointName","maxNumber","match","parseInt","padStart","parentTrack","suggested","suggestedPoint","addPoint","renamePoint","newSegment","joinToStart","hideLineCursor","originalSegment","latngs2","_lineJoinFromStart","unshift","userCancelled","sourcePoints","onNodeRightClickShowMenu","onSegmentRightClickShowMenu","onTrackMouseEnter","onTrackMouseLeave","onTrackEditStart","onTrackEditEnd","onTrackSegmentDrawEnd","nodeIndex","splitTrackSegment","startLineJoinSelection","startShortCutSelection","newTrackFromSegment","showElevationProfileForSegment","showLineCursor","start","mousepos","_lineCursor","clone","onMouseMoveOnMapForLineCursor","onKeyUpForLineCursor","preventStopEdit","updateLineCursor","cursorStart","onLineCursorHideForJoin","onMouseMoveOnLineForJoin","disableEditOnLeftClick","cursorEnd","startFromNode","_shortCut","startNodeIndex","startLatLng","nodeMarkers","onMouseMoveOnNodeMarkerForShortCut","segmentOverlays","onMouseMoveOnLineSegmentForShortCut","onMouseMoveOnMapForShortCut","onClickNodeMarkerForShortCut","onClickLineSegmentForShortCut","onLineCursorHideForShortCut","updateShortCutSelection","highlighNodesForDeletion","endAtNode","getShortCutNodes","firstNodeToDelete","lastNodeToDelete","rangeValid","shortCutSegment","endNodeIndex","newNodes","spliceLatLngs","hover","onTrackRowMouseEnter","_highlightedTrack","onTrackRowMouseLeave","latlngs1","latlngs2","segment1","srcNodes","trackHidden","featureGroup","touch","bindTooltip","sticky","delay","_trackHighlight","removeFrom","trackHighlight","eachLayer","bringToBack","setMarkerLabel","srcPoint","removePoint","newLabel","forceVisible","saveToString","exportTracks","minTicksIntervalMeters","capturedTrack","pl","capturedBounds","measureTicks","getTicksPositions","hideElevationProfile","_elevationControl","ElevationProfile","samplingInterval","calcSamplingInterval","path","hasTracks","arrayItemsEqual","l1","l2","parseHashParams","args","m","substr","pair","exec","onChange","_listeners","_state","c","values","_saveStateToHash","hasKey","hasOwnProperty","stateItems","hash","pathname","_ignoreChanges","onHashChanged","newState","changedKeys","PrintStaticLayer","printOptions","iterateTilePromises","tilePromise","draw","_drawRaster","isOverlay","overlaySolid","abortLoading","count","_unused_canvas","_unused_printOptions","ta","success","select","execCommand","w","h","showNotification","TiledDataLoader","cacheSize","_cache","Cache","_pendingRequests","_xhrQueue","dataTileCoords","makeTileKey","res","layerTileCoords","_unused_dataTileCoords","_unused_xhr","_unused_originalDataTileCoords","multiplier","offsetX","offsetY","layerTileToDataTileCoords","getFromCache","found","dataPromise","tileData","adjustment","calcAdjustment","dataTileKey","makeRequestData","fetchPromise","put","processResponse","pendingRequest","refCount","parsers","parsed","services","ServiceClass","service","geoData","trackView","shown","ticksShown","deltaEncodedSegments","deltaEncodeSegment","deltaLats","deltaLons","lats","lons","midLon","midLat","wp","arcUnit","packedWaypoints","lon","pbf","Pbf","versionStr","TrackView","write","finish","urlSafeBase64","encode","decode","parseNktkOld","track_data","parseNktkFragment","element2","PackedStreamReader","_string","lastLon","lastLat","deltaLon","deltaLat","deltaDecodeSegment","encodedLat","encodedLon","version","segmentsCount","pointsCount","midX","midY","waypointName","wayPoints","readNumber","readString","utf8","j","Boolean","parseNktkProtobuf","read","unpackNumber","ResizeObserver","observe","setInterval","newWidth","newHeight","components","register","viewModel","params","progress","pureComputed","range","progressRange","progressDone","fullSize","pixelBounds","divideBy","assign","visibility","fadeAnimation","zoomAnimation","inertia","setView","noop","GridLayerGrabMixin","tileImagePromiseFromCoords","_unused_coords","waitTilesReadyToGrab","getTilesInfo","tileRange","_pxBoundsToTileRange","topLeft","tilePromiseIterator","Point","_tileZoom","_isValidTile","tilePos","_getTilePos","coordsPlusOne","tilePlusOne","subtract","_level","_wrapCoords","TileLayerGrabMixin","cloneForPrint","tileLayer","_url","xhrOptions","getTileUrl","noCors","xhrQueue","rawData","imgFromDataString","TileLayer","yandexCrs","EPSG3395","Yandex","subdomains","retina","yandexScale","tilePosLatLng","scaleBy","getTileSize","bounds2","Bounds","tile","coordsBelow","_adjustHeight","_initTile","Sat","Tracks","minZoom","maxNativeZoom","GoogleBase","_getZoomForUrl","_getSubdomain","lang","language","GoogleMap","GoogleTerrain","GoogleHybrid","GoogleSat","WestraPassesMarkers","filePasses","baseUrl","showPassDescription","_baseUrl","loadData","_downloadStarted","_loadMarkers","_makeTooltip","properties","grade","elevation","is_summit","_passToGpx","gpx","_passToKml","kml","_makeIcon","grade_eng","features","latlon","_dataLoaded","reports","id","altnames","connects","comments","comment","user","content","reports_total","reports_photo","reports_tech","slopes","author","openPopup","maxWidth","getElementById","onclick","openPopupWindow","uniqName","screenLeft","screen","availLeft","bordersWidth","screenX","outerWidth","availWidth","screenY","newWindow","closed","focus","f","cache","getComputedStyle","backgroundImage","offsetLeft","arg","_printProgressWeight","cloneMarker","cloneMarkers","printIconsOpacity","resolution","scale","destPixelSize","getTopRight","getBottomLeft","dummyMap","minTicksIntervalMm","_ticks","updateTicks","updateTicksLater","_clearTicks","tick","_addTick","transformMatrixString","transformMatrix","childNodes","transform","setLatLng","labelText","distanceValue","divIcon","html","keyboard","step","ticks","addTick","normalizedBounds","wrapLatLngBounds","normalizedPosition","positionMinus360","positionPlus360","contains","sinCos","dx","dy","sqrt","sinCosFromLatLonSegment","sin","cos","nextPointMeasure","q","lastTickMeasure","lastPointMeasure","_latlngs","points_n","pad","rad","PI","mercatorMetersPerPixel","referencePoint","mapScale","oldTicks","oldMarker","measuredLine","RetinaTileLayer","tileSizeMultiplicator","hiRes","useHiResTiles","newOptions","retinaOptionsOverrides","declination","minLat","maxLat","row1","floor","row2","dlat","col1","col2","dlon","colsCount","a1","getArrayValue","a2","v1","rowsCount","row","col","ind","ar1","atob","array","ar2","Float32Array","valueScale","offset","valueOffset","DragEvents","dragTolerance","dragButtons","stopOnLeave","setOptions","dragButton","startEvent","prevEvent","isDragging","button","disableImageDrag","disableTextSelection","_moveHandler","onMouseUp","onMouseLeave","fireDragEvent","finishDrag","tolerance","prevPos","dragMovement","enableImageDrag","enableTextSelection","Array","nodeValue","JSUnzip","fileContents","BigEndianBinaryStream","MAGIC_NUMBER","readEntries","isZipFile","ZipEntry","getByteRangeAsNumber","binaryStream","signature","getNextBytesAsNumber","versionNeeded","bitFlag","compressionMethod","timeBlob","isEncrypted","crc32","compressedSize","uncompressedSize","isUsingZip64","fileNameLength","extraFieldLength","fileName","getNextBytesAsString","isUsingBit3TrailingDataDescriptor","isUsingUtf8","escape","stream","resetByteIndex","currentByteIndex","getByteAt","steps","getByteRangeAsString","charCode","compressed","originalSize","out","s2","flattenArray","ar","parsePointFromHashValues","NakarteTrack","parseTrackUrlData","BaseService","NakarteUrlLoader","loaders","nktk","loadFromTextEncodedTrack","nktl","loadFromTextEncodedTrackId","nktu","loadFromUrlencodedUrls","nktp","loadPoint","nktj","loadFromJSON","paramName","loader","trackId","r","parseNktkSequence","loadTracksFromJson","loadFromUrl","NakarteUrl","paramNames","_params","promises","decoded","samplingIntgerval","createSvg","attributes","setAttribute","gradientToAngle","g","atan","Class","sightLine","samples","lastSampleDist","lastPointDistance","nextPointDistance","pathRegularSamples","crimea_bounds","horizZoom","dragStart","_addTo","_onWindowResize","_resizeGraph","newSvgWidth","drawingContainer","clientWidth","svgWidth","svg","updateGraph","updateGraphSelection","_controlContainer","setupContainerLayout","trackMarker","onLineMouseMove","onLineMouseEnter","onLineMouseLeave","polyLineSelection","propsContainer","leftAxisLables","closeButton","onCloseButtonClick","graphCursor","graphCursorLabel","graphSelection","svgHeight","clientHeight","onSvgMouseMove","onSvgEnter","onSvgLeave","onSvgMouseWheel","svgDragEvents","onSvgDragStart","onSvgDragEnd","onSvgDrag","onSvgClick","onSvgDblClick","selStartIndex","roundedSampleIndexFromMouseEvent","graphContainerOffsetFromMouseEvent","getBoundingClientRect","sampleIndexFromMouseEvent","setTrackMarkerLabel","getElementsByClassName","setGraphSelection","cursorIndex","selMinInd","selMaxInd","selStart","selEnd","cursorShow","stats","calcProfileStats","updatePropsDisplay","scrollLeft","setLatLngs","setMapPositionAtIndex","panTo","oldHorizZoom","getWheelDelta","newScrollLeft","setupGraph","cursorHide","setCursorPosition","d","noData","maxElev","minElev","startElev","endElev","change","ascentAngleStr","descentAngleStr","ascent","descent","startApprox","endApprox","approx","incomplete","end","finalAscent","angleAvgAscent","avg","angleMaxAscent","angleAvgDescent","angleMaxDescent","dist","distance","dataLostAtStart","dataLostAtEnd","dataLost","calcGridValues","minValue","maxValue","ticksN","tickStep","tick1","ticksNs","tickSteps","matchFound","ceil","filterElevations","scanStart","scanEnd","linearValue","linearDelta","maxError","maxErrorInd","filtered","queue","notNullValues","firstNotNullValue","lastNotNullValue","firstNotNullIndex","lastNotNullIndex","ascents","descents","prevNotNullValue","prevNotNullIndex","gradient","gradientAvgAscent","gradientMinAscent","gradientMaxAscent","angleMinAscent","gradientAvgDescent","gradientMinDescent","gradientMaxDescent","angleMinDescent","delta","angleStr","distanceStr","sample1","sample2","indInt","markerPos","elevationStr","cursorLabel","indFrac","sqrDist","latlng1","latlng2","di","nextDist","nextSampleDist","prevDist","prevSampleDist","nearestInd","minDist","mouseLatlng","hasChildNodes","lastChild","horizStep","verticalMultiplier","gridValues","gridStep","x1","x2","valueToSvgCoord","startNewSegment","y1","y2","serverUrl","chunkSize","respValues","control","originalOnAdd","_topRowEnabled","__injectTopRow","_topRow","_section","insertBefore","uid","preconnect","preconnectLink","rel","head","dnsPrefetchLink","RELEASE_VER","cookieUid","cookie","uidRaw","toUpperCase","getUid","App","setUp","startInfo","localStorageKeys","safeLocalStorage","fixAll","MapWithSidebars","zoomControl","attributionControl","inertiaMaxSpeed","worldCopyJump","tap","tracklist","Caption","ZoomDisplay","getPlacemarkHashStateInterface","Coordinates","Weather","locateControl","LocateControl","showError","code","customMessage","locationErrorMessage","state_map","validateState","validPositionInHash","valid","moveMapToCurrentLocation","Panoramas","layersControl","layers","collapsed","state_layers","attribution","prefix","addControl","parentElement","removeControl","trackNames","tracksHashParams","hashParams","param","loadTracksFromStorage","tracksAfterLoadFromStorage","bindHashStateReadOnly","loadTrackFromParam","tracksAfterLoadFromHash","logEvent","saveTracksToStorage","0","1","2","_sidebarsContainer","setupSidebarsLayout","_mapContainer","onElementResize","requestAnimFrame","invalidateSize","_sidebarContainers","sidebars","midColumn","addElementToSidebar","barName","removeElementFromSidebar","extenders","checkNumberRange","newValue","notifySubscribers","PrintPages","defaultMargin","pageSizes","zoomLevels","pages","zoomLevel","pageWidth","pageHeight","settingsExpanded","makingPdf","downloadProgressRange","downloadProgressDone","marginLeft","marginRight","marginTop","marginBottom","autoZoomLevels","printSize","_printSize","onPageSizeChanged","pageSizeDescription","_displayPageSize","pagesNum","pagesNumLabel","_pagesNumLabel","gridOn","magneticMeridiansOn","notifyChange","updateFormZooms","formHtml","addPage","isLandscape","page","PageFeature","_rotated","cm","makePageContexmenuItems","rotatePage","addLandscapePage","addPortraitPage","removePage","setLabel","removePages","onSavePdfClicked","savePdf","zoomForPrint","suggestZooms","mapZoom","satZoom","incrementProgress","inc","getLatLngBounds","getPrintSize","getLabel","decorationLayers","Grid","MagneticMeridians","OverlayScale","eventId","zooms","action","renderPages","progressCallback","renderedLayers","getFileName","imagesInfo","pdf","makePdf","savePagesPdf","savePageJpg","pageNumber","setSize","onPagesNumLabelClick","renumberPage","rotate","newIndex","oldIndex","referenceLat","absLats","targetMetersPerPixel","mapUnitsPerPixel","LN2","hasPages","getLatLng","flags","rotated","opaqueLayer","transparentOverlayLayers","appendLayerShortName","shortName","isOverlayTransparent","currentPageSize","find","pageSize","centerLatLng","paperSize","draggable","updateView","rectangle","fillOpacity","_getLatLngBounds","centerMerc","Projection","SphericalMercator","mercatorScale","Earth","R","mercatorPageSize","multiplyBy","sw","ne","_animateZoom","newZoom","getZoom","pixel_sw","getSouthWest","pixel_ne","getNorthEast","pixel_center","st","pixel_width","pixel_height","fontSize","lineHeight","setBounds","getLayersForPrint","getZIndex","compare","i1","i2","getLayerZOrder","_path","TypeError","order","meta","sort","layer1","layer2","compareArrays","PageComposer","destSize","pixelBoundsAtZoom24","currentCanvas","currentZoom","currentTileScale","targetCanvas","createCanvas","tileInfo","tileScale","mergeCurrentCanvas","setupCurrentCanvas","dest","s_data","getImageData","sr","sg","sb","sa","sa1","dr","dg","db","d_image_data","d_data","data_length","putImageData","blendMultiplyCanvas","dataUrl","toDataURL","iterateLayersTiles","pageLabel","pagesCount","defaultXHROptions","_layerDummy","getTempMap","_rasterizeNeedsFullSizeMap","layerPromises","progressInc","doStop","disposeMap","promiseQueueBuffer","source","maxActive","next","pageImagesInfo","Set","composer","tilesIterator","queuedTilesIterator","putTile","getDataUrl","bingKey","thunderforestKey","sentryDSN","mapillary","flickr","Image","blobUrl","onload","BingLayer","clearInterval","_key","tile2quad","quad","digit","mask","culture","_providers","metaRequested","tilePoint","loadMetadata","cbid","errorDetails","initMetadata","urlScheme","script","resourceSets","resources","imageUrlSubdomains","imageUrl","imageryProviders","coverageAreas","coverage","zoomMin","zoomMax","active","bbox","attrib","_update","_update_attribution","intersects","addAttribution","removeAttribution","tilesInfo","WestraPasses","waitDataReady","fileCoverage","fileLabels1","fileLabels2","labels2Zoom","markersZoom","labels1Zoom","markersOptions","GeoJSONAjax","onEachFeature","_setEventsForRegion","labels1","pointToLayer","_makeMarker","labels2","_onRegionClick","geojsonPoint","setLayersVisibility","zoomFinished","GeoJSON","requestTimeout","_loadStarted","addData","printWidthMm","_makelatLngToCanvasPixelTransformer","unscaleBy","_shift","targetBounds","getProjectedBounds","targetCenter","projected","lineBounds","lineJoin","beginPath","moveTo","lineTo","stroke","tickFontSizeMm","ticksPixelSize","setTransform","recPage","serialNum","pageRecId","contentRecId","imageRecId","recContent","contents","recImage","widthPixels","heightPixels","offsets","addRec","skipOffset","kidsIds","recPages","widthPoints","heightPoints","recOffsets","currentOffset","trailer","padding","recTrailer","angle","pixel","toLatLng","_makeCanvasToLatLngTransformer","lineThicknessMm","intervalPx","lineIntervalMm","samplingPx","samplingIntervalMm","pageDiagonal","maxSegments","drawLine","directionDown","getDeclination","maxLines","formatScale","nominalScale","scaleRange","unit","southLen","northLen","nScale","sScale","pageScaleRange","fontSizeMm","paddingMm","fillRect","intervalM","minGridIntervalM","minGridIntervalMm","intervals","metersPerDegree","pixelsPerMm","getGridInterval","mercatorBounds","canvasToMercatorScale","rows","yMerc","lat2","yMerc2","lineWidthPx","pageCanvasCenterX","direction","colN","firstRow","hasPointInPage","formatDistance","_drawGrid","_drawLabel","_contents","setContents","DEFAULT_FORMAT","formats","DEGREES","UNKNOWN_COORDINATES","SIGNED_DEGREES","DEGREES_AND_MINUTES","DEGREES_AND_MINUTES_AND_SECONDS","format","formatCode","formattedCoordinates","formatLatLng","wrapperClass","saveStateToStorage","makeButtonWithBar","_link","loadStateFromStorage","leafletCoordinatesActive","leafletCoordinatesFmt","setEnabled","isEnabled","enabled","classFunc","eventFunc","onMapRightClick","_isEnabled","coordinates","truncToFixed","precision","sliceEnd","padEnd","formatNumber","coordinatePresentations","coordinate","isLat","degrees","intDegrees","minutes","intMinutes","seconds","signedDegrees","formatter","getLayerHotkey","hotkey","extendLayerName","originalOnRemove","originalAddItem","_addItem","_hotKeysEnabled","_addHotketEvents","_onHotkeyUp","_addHotKetEvents","altKey","ctrlKey","shiftKey","_keyDown","pressedKey","targetTag","_layers","layerId","inputs","input","click","Layers","k1","k2","hasBaselayer","overlay","chrome","PosAnimation","__panAnimationFixed","originalStep","_step","fixPanAnimationBug","pointerEnabled","ie","maxTouchPoints","originalHandleDOMEvent","_handleDOMEvent","_fireDOMEvent","Renderer","__animationFixed","resetInterval","originalGetEvents","getEvents","onZoom","now","Date","_lastReset","_reset","_onZoom","onMove","move","fixVectorDrawWhileAnimation","fixVectorMarkerWorldJump","original_addTo","stackHorizontally","origOpenTooltip","_openTooltip","_tooltip","_pendingTooltip","origCloseTooltip","closeTooltip","addTooltipDelay","PanoMarker","zIndexOffset","getIcon","markerIcon","getElement","children","setHeading","setType","markerType","slim","normal","splitVerically","splitSizeFraction","minViewerSize","getProviders","provider","wikimediaProvider","layerOptions","selected","mapMarkerType","mapillaryProvider","loadSettings","_panoramasContainer","onContainerResize","providers","updateCoverageVisibility","nearbyPoints","storedSettings","panoramaSettings","_splitVerically","spitVertically","fraction","_splitSizeFraction","saveSetting","stringify","_splitterDragging","splitter","splitterButton","trackOutsideElement","dragstart","onSplitterDragStart","dragend","onSplitterDragEnd","drag","onSplitterDrag","onSplitterClick","setupViewerLayout","onMapResize","onButtonClick","onKeyUp","minSize","oldSize","newSize","mapSize","maxSize","setContainerSizePixels","switchControl","controlEnabled","disableControl","enableControl","codePointAt","onMapClick","notifyChanged","hidePanoViewer","coverageLayer","getCoverageLayer","showPanoramaContainer","panoramaVisible","hasClass","setupNearbyPoints","hidePano","viewer","deactivate","showPano","otherProvider","getViewer","setupViewerEvents","activate","onPanoramaChangeView","closeclick","onPanoramaCloseClick","hideMarker","placeMarker","heading","searchRadiusMeters","getPanoramaAtPos","searchResult","sidebar","updateContainerSize","containerSize","coverageCode","viewerState","setState","hashStateUpgrader","panoramasControl","oldState","upgradedState","getMapillary","require","resp","Viewer","CloseButtonMixin","DateLabelMixin","component","cover","bearing","resize","onNodeChanged","onBearingChanged","createDateLabel","createCloseButton","_bearing","_zoom","_center","throttle","_invalidateSize","moveToKey","setZoom","updateZoomAndCenter","_node","fireChangeEvent","updateDateLabel","capturedAt","getBearingCorrection","computedCA","originalCA","originalLatLon","pitch","_pitch","activateCover","_updateHandler","getBearing","deactivateCover","center0","center1","moveCloseTo","setCenter","MapillaryCoverage","updateWhenIdle","MapillaryLoader","onTileUnload","_abortLoading","_tileData","_adjustment","drawOverview","canvasCtx","geometry","arc","fill","drawSequences","lineI","pointI","drawImages","requestTileData","z2","originalDataTileCoords","_processResponse","decodeMvt","_maxSize","_store","_size","tileExtent","TileProto","parsedLayers","extent","parseFeatures","decodeCoordinate","parseGeometry","geometryType","ints","coordinatesScale","GeomType","POINT","LINESTRING","POLYGON","lineStrings","cmd","cmdRepeat","cmdN","Tile","exports","readFields","_readField","tag","readVarint","Feature","tags","readPackedVarint","onCloseClick","dateLabel","timestamp","getDate","getMonth","getFullYear","parseSearchResponse","iinfo","imageinfo","imageDescription","extmetadata","ImageDescription","objectDescription","ObjectName","Artist","descriptionurl","thumburl","timeOriginal","DateTimeOriginal","time","DateTime","pageUrl","pageId","pageid","isCloser","d1","d2","clusterSize","radius","photos","nearestLatlng","photo","formatDateTime","dateStr","year","month","day","mapContainer","pageButtonContainer","maxBoundsViscosity","Simple","zoomSnap","infoLabel","prevPhotoButton","nextPhotoButton","switchPhoto","_imageIdx","setupPageButtons","_buttons","imageIdx","imagePos","imageLayer","log2","southWest","northEast","setMaxZoom","setMaxBounds","animate","imageOverlay","setUrl","_active","_showPano","MultiLayer","tms","WikimediaVectorCoverage","WikimediaLoader","urlTemplate","Uint16Array","dataOffset","pixelScale","readFile","fileInput","multiple","display","readAsArrayBuffer","parseKmz","parseZip","parseGpx","parseOziRte","parseOziPlt","parseOziWpt","parseKml","_unused_name","unzipper","uncompressed","entry","file_name","decode866","hasDocKml","coordinates_element","points_strings","placemarks","coord","pointObjs","nameTags","getPoints","expected_points_num","current_segment","total_points_num","fields","is_start_of_segment","currentSegment","pointName","decodeCP1251","YandexRuler","Endomondo","Etomesto","Gpsies","Gpslib","Osm","Strava","Tracedetrail","MovescountMove","MovescountRoute","GarminActivity","GarminRoute","SportsTrackerActivity","OpenStreetMapRu","SimpleService","nameFromUrl","responseURL","urlRegexps","some","re","userId","latitude","longitude","date","local_start_time","trackName","urlRe","getTrackId","startsWith","fileId","speed","dataType","filetype","submitButton","inappropriate","encodeURIComponent","pageResponse","trackResponse","401","404","isArray","userName","textContent","activityTitle","nom_fr","proj","last_lat","last_lng","points_str","Segment","readPackedSVarint","writePackedSVarint","Waypoint","readSVarint","writeSVarintField","writeStringField","Waypoints","writeMessage","Track","View","readBoolean","writeVarintField","writeBooleanField","parseWaypoint","rawPoint","Number","lt","ln","parseTrack","rawTrack","rawSegment","errCorrupt","jsonString","geoDataArray","u","t","viewProps","MovescountBase","latitudes","longitudes","routeName","TrackPoints","trackPoint","Latitude","Longitude","GarminBase","coursePoints","pt","geoPoints","courseName","geoPolylineDTO","activityId","metadata","dataResponse","metadataResponse","payload","locations","la","startTime","toDateString","fullname","withElevations","fakeTime","simplify","_nodeMarkersZOffset","_editing","_drawingDirection","setupMarkers","onMapEndDrag","onKeyPress","_storedStyle","_nodeMarker","_lineNode","_segmentOverlay","getMarkerIndex","getSegmentOverlayIndex","segmentOverlay","onNodeMarkerDragEnd","replaceNode","_setupEndMarkers","onNodeMarkerMovedChangeNode","onNodeMarkerDblClickedRemoveNode","_disableEditOnLeftClick","removeNode","newNodeIndex","refNodeIndex","addNode","handler","dragging","_draggable","mousePos","_startPoint","_newPos","_startPos","mouseEventToLatLng","onMouseMoveFollowEndNode","makeNodeMarker","onNodeMarkerClickStartStopDrawing","latlngs_n","makeSegmentOverlay","onSegmentMouseDownAddNode","midPoint","Draggable","_dragging","_onDown","nodes","isAddingLeft","isAddingRight","prevNode","oldNode","nodesCount","startIndex","endIndex","startIcon","endIcon","startNode","endNode","disable","latLngs","wrappedLatLngs","newLines","newLine","prevLatLng","positiveLng","wrapNum","positivePrevLng","splitLng","sign","splitPrevLng","splitLat","getSegmentSplitPointLat","splitPrevLat","splitLineAt180Meridian","latLng1","latLng2","deltaLng","Ruler","trackList","_trackList","notEmpty","maxLocalStorageSessions","_minimizeEnabled","__injectMinimizeButtons","contentsWrapper","minimizeButton","expandButton","originalUnserializeState","_configEnabled","_allLayersGroups","_allLayers","_initializeLayersState","updateEnabledLayers","addedLayers","hasBaselayerOnMap","enabledLayers","_justAdded","addOverlay","addBaseLayer","hasLayer","CustomLayer","z_1","x_1024","y_1024","infinite","invertedY","_globalTileRange","elements","querySelectorAll","raise","cornerDiv","layersDefs","grouppedLayers","isDefault","jnx","SovietTopoGrid","Wikimapia","zeroPad","num","bigLetterReplacers","Nomenclature","getQuadName1m","column","getQuadName500k","name1","subquad","name2","names","replacer","name3","getQuadName100k","getQuadName050k","_getQuads","row_height","column_width","name_factory","quads","min_lat","max_lat","maxCols","joined_quads","row_south","row_north","min_lon","max_lon","column_west","column_east","quad_bounds","getQuads1m","getQuads500k","getQuads100k","getQuads050k","LayerGroup","renderer","_quads","_updateRenderer","_cleanupQuads","_addQuad","titles","rect_options","smoothFactor","noClip","objects","_showContextMenu","_removeQuad","_addQuads","_addGrid","map_bbox","reset","clearLayers","quad_id","isPointInPolygon","polygon","inside","WikimapiaLoader","highlightedPlace","places","localPolygon","polygon2","_tileOnLoad","ielt9","_tileCoordsFromEvent","layerPoint","getPixelOrigin","getPlaceAtMousePos","tileCoords","_tiles","_tileCoordsToKey","getPlaceAtLatlng","place","setContent","boundsWESN","projectObj","_projectObj","exactMatch","hasChildren","wmUtils","makeTileUrl","parseTile","viewTileSize","urlPath","getTileId","tileIdToCoords","tileId","decodeTitles","chooseTitle","langCode","decodePolygon","makeCoordsLocal","tileX","tileY","tileZ","x0","y0","localCoords","asap","simplifyPolygon","tileHasChildren","p0","pixelDegSize","prevTime","placeId","originalLayerOnAdd","originalZoomOnAdd","Zoom","JNX","_layersControl","makingJnx","contextMenu","makeMenuItems","getLayerForJnx","selectedLayer","layerRec","layerName","estimateTilesCount","tilesCount","_selector","topLeftTile","bottomRightTile","maxLevel","minLevel","metersPerPixel","fileSizeMb","itemClass","resolutionString","sizeString","makeJnx","notifyProgress","sanitizedLayerName","makeJnxFromLayer","removeSelector","addSelector","RectangleSelect","onButtonClicked","Rectangle","fillColor","onMarkerDrag","onMarkerDragEnd","placeMarkers","topLeftPixel","setBoundsFromMarkers","imageFromarrayBuffer","dataURL","ensureImageJpg","convertToJpeg","srcLayer","maxZoomLevel","jnxProductId","jnxZOrder","writer","JnxWriter","minZoomLevel","progressWeight","tempMap","tilePromiseRec","imageRec","addTile","promiseRec","getJnx","jnxCoordinates","extents","toJnx","north","east","south","west","productName","productId","zOrder","tiles","level","totalTilesCount","levels_n","BinStream","writeInt32","writeUint32","seek","writeString","writeInt16","jnxScale","tileDescriptorOffset","tell","writeUint8","tileDataOffset","getBuffer","littlEndian","dv","DataView","_pos","old_buffer","buffer","newAr","oldAr","grow","newPos","checkSize","setUint8","setInt8","setInt16","setUint16","setInt32","setUint32","zeroTerminated","validateFloat","validateFloatRange","radians","roundAzimuth","Azimuth","trueAzimuth","magneticAzimuth","iconSingle","iconUrl","iconPointer","iconStart","iconPointerStart","iconEnd","iconPointerEnd","azimuthLine","single","which","rotationOrigin","layout","setPoints","elevationControl","showProfile","_enabled","hideProfile","atan2","setRotationAngle","updateValuesDisplay","azimuth","lat1","lng1","lng2","onProfileButtonClick","onReverseButtonClick","STATE_DISABLED","STATE_LOCATING","STATE_ENABLED","STATE_ENABLED_FOLLOWING","STATE_MOVING_TO_FOLLOWING","STATE_MOVING_TO_FOLLOWING_FIRST","STATE_UPDATING_FOLLOWING","EVENT_INIT","EVENT_BUTTON_CLICK","EVENT_LOCATION_RECEIVED","EVENT_LOCATION_ERROR","EVENT_MAP_MOVE","EVENT_MAP_MOVE_END","LOCALSTORAGE_POSITION","PositionMarker","_locationSet","_elements","accuracyCircle","circle","markerCircle","circleMarker","markerPoint","_updatePrecisionState","precise","_radius","_precise","setLocation","accuracy","setRadius","locationAcquireTimeoutMS","maxAutoZoom","minAutoZoomDeltaForAuto","minDistForAutoZoom","_events","_handleEvent","fallbackLatLng","forceLatLng","forceZoom","storedPosition","geolocation","getCurrentPosition","_storePositionToLocalStorage","enableHighAccuracy","maximumAge","_startLocating","_onLocationError","_watchID","watchPosition","_onLocationSuccess","_stopLocating","clearWatch","_storeLocation","_accuracy","_updateMarkerLocation","_updateMapPositionWhileFollowing","_updateFollowingStartPosition","_updateFollowingDestPosition","_setViewToLocation","preferAutoZoom","zoomFitAccuracy","getBoundsZoom","toBounds","autoZoom","screenSize","averageScreenSize","_onMapMove","_onMapMoveEnd","equals","_isMapOffsetFromFollowingSegment","pointToSegmentDistance","_isMapCenteredAtLocation","_updateButtonClasses","_setEvents","_processingEvent","_processEvent","_setState","_display","_zoomOutButton","_updateDisplay","Placemark","getTitle","onMapMove","showPlacemark","_placemark","onPlacemarkRemove","PlacemarkHashStateInterface","placemark","periods","icon_map","layerGroup","link_container","_simulated","unload","showControl","renderMarkerIcon","current_weather","temp","renderPlaces","period_index","current_period","baloon","closest","dataset","zindex","controlContainer","positionSliderLabel","positionSlider","setCurrentPeriod"],"mappings":"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","file":"static/js/app.e93a856f.js","sourcesContent":["import config from '~/config';\n\nexport default function urlViaCorsProxy(url) {\n    return config.CORSProxyUrl + url.replace(/^(https?):\\/\\//u, '$1/');\n}\n","import {fetch} from '~/lib/xhr-promise';\n\nclass BaseService {\n    constructor(url) {\n        this.origUrl = url;\n    }\n\n    isOurUrl() {\n        throw new Error('Method not implemented');\n    }\n\n    requestOptions() {\n        throw new Error('Method not implemented');\n    }\n\n    parseResponse() {\n        throw new Error('Method not implemented');\n    }\n\n    async geoData() {\n        if (!this.isOurUrl()) {\n            throw new Error('Unsupported url');\n        }\n        const requests = this.requestOptions().map((it) => fetch(it.url, it.options));\n        let responses;\n        try {\n            responses = await Promise.all(requests);\n        } catch (e) {\n            return [{name: this.origUrl, error: 'NETWORK'}];\n        }\n\n        return this.parseResponse(responses);\n    }\n\n    nameFromUrl(url) {\n        try {\n            url = decodeURIComponent(url);\n        } catch (e) {\n            // leave url as is\n        }\n\n        return url\n            .split('#')[0]\n            .split('?')[0]\n            .replace(/\\/*$/u, '')\n            .split('/')\n            .pop();\n    }\n}\n export default BaseService;\n","import {arrayBufferToString} from '~/lib/binary-strings';\n\nfunction successIfStatus200(xhr) {\n    return xhr.status >= 200 && xhr.status <= 299;\n}\n\nfunction retryIfNetworkErrorOrServerError(xhr) {\n    return (xhr.status === 0 || xhr.status >= 500);\n}\n\nclass XMLHttpRequestPromiseError extends Error {\n    constructor(xhr) {\n        super();\n        this.xhr = xhr;\n        this.name = 'XMLHttpRequestPromiseError';\n\n        this.message = xhr.status === 0 ? 'network error' : `server response is ${xhr.status}`;\n    }\n}\n\nclass XMLHttpRequestPromise {\n    constructor(\n        url, {method = 'GET', data = null, responseType = '', timeout = 30000, maxTries = 3, retryTimeWait = 500,\n            isResponseSuccess = successIfStatus200, responseNeedsRetry = retryIfNetworkErrorOrServerError,\n            headers = null, withCredentials = false} = {}) {\n        // console.log('promise constructor', url);\n        const promise = new Promise((resolve, reject) => {\n                this._resolve = resolve;\n                this._reject = reject;\n            }\n        );\n        this.then = promise.then.bind(promise);\n        this.catch = promise.catch.bind(promise);\n        this.method = method;\n        this.url = url;\n        this.responseType = responseType;\n        this.postData = data;\n        this._isResponseSuccess = isResponseSuccess;\n        this._responseNeedsRetry = responseNeedsRetry;\n        this._retryTimeWait = retryTimeWait;\n        this.triesLeft = maxTries;\n\n        const xhr = this.xhr = new XMLHttpRequest();\n        xhr.onreadystatechange = () => this._onreadystatechange();\n        this._open();\n        xhr.timeout = timeout;\n        if (responseType === 'binarystring') {\n            xhr.responseType = 'arraybuffer';\n        } else {\n            xhr.responseType = responseType;\n        }\n        if (headers) {\n            for (let [k, v] of headers) {\n                xhr.setRequestHeader(k, v);\n            }\n        }\n        xhr.withCredentials = withCredentials;\n    }\n\n    _open() {\n        // console.log('open', this.url);\n        this.xhr.open(this.method, this.url);\n    }\n\n    _onreadystatechange() {\n        const xhr = this.xhr;\n        if (xhr.readyState === 4 && !this._aborted) {\n            // console.log('ready state 4', this.url);\n            xhr.responseBinaryText = '';\n            if (this.responseType === 'binarystring' && xhr.response && xhr.response.byteLength) {\n                xhr.responseBinaryText = arrayBufferToString(xhr.response);\n            }\n            // IE doesnot support responseType=json\n            if (this.responseType === 'json' && (typeof xhr.response) === 'string') {\n                try {\n                    // xhr.response is readonly\n                    xhr.responseJSON = JSON.parse(xhr.response);\n                } catch (e) {\n                    xhr.responseJSON = null;\n                }\n            } else {\n                xhr.responseJSON = xhr.response;\n            }\n            if (this._isResponseSuccess(xhr)) {\n                // console.log('success', this.url);\n                this._resolve(xhr);\n            } else {\n                if (this.triesLeft > 0 && this._responseNeedsRetry(xhr)) {\n                    // console.log('retry', this.url);\n                    this._open();\n                    this._timerId = setTimeout(() => this.send(), this._retryTimeWait);\n                } else {\n                    // console.log('failed', this.url);\n                    this._reject(new XMLHttpRequestPromiseError(xhr));\n                }\n            }\n        }\n    }\n\n    abort() {\n        // console.log('abort', this.url);\n        this._aborted = true;\n        clearTimeout(this._timerId);\n        this.xhr.abort();\n    }\n\n    send() {\n        // console.log('send', this.url);\n        this.triesLeft -= 1;\n        this.xhr.send(this.postData);\n    }\n}\n\nclass XHRQueue {\n    constructor(maxSimultaneousRequests = 6) {\n        this._maxConnections = maxSimultaneousRequests;\n        this._queue = [];\n        this._activeCount = 0;\n    }\n\n    put(url, options) {\n        const promise = new XMLHttpRequestPromise(url, options);\n        promise._originalAbort = promise.abort;\n        promise.abort = () => this._abortPromise(promise);\n        this._queue.push(promise);\n        this._processQueue();\n        return promise;\n    }\n\n    _abortPromise(promise) {\n        const i = this._queue.indexOf(promise);\n        if (i > -1) {\n            // console.log('ABORT IN QUEUE');\n            this._queue.splice(i, 1);\n        } else {\n            if (promise.xhr.readyState === 4) {\n                // console.log('ABORT COMPLETED');\n            } else {\n                // console.log('ABORT ACTIVE');\n                promise._originalAbort();\n                this._activeCount -= 1;\n                setTimeout(() => this._processQueue(), 0);\n            }\n        }\n    }\n\n    _processQueue() {\n        if (this._activeCount >= this._maxConnections || this._queue.length === 0) {\n            return;\n        }\n        const promise = this._queue.shift();\n        promise\n            .catch(() => {\n                // do not throw if XHR request fails\n            })\n            .then(() => this._onRequestReady(promise));\n        this._activeCount += 1;\n        promise.send();\n    }\n\n    _onRequestReady(promise) {\n        if (!promise._aborted) {\n            this._activeCount -= 1;\n        }\n        setTimeout(() => this._processQueue(), 0);\n    }\n}\n\nfunction fetch(url, options) {\n    // console.log('fetch', url);\n    const promise = new XMLHttpRequestPromise(url, options);\n    promise.send();\n    return promise;\n}\n\nexport {fetch, XHRQueue};\n\n","import L from 'leaflet';\nimport './style.css';\n\nfunction stopContainerEvents(container) {\n    L.DomEvent.disableClickPropagation(container);\n    L.DomEvent.disableScrollPropagation(container);\n    L.DomEvent.on(container, 'mousemove contextmenu', L.DomEvent.stop);\n}\n\nL.Control.include({\n    _stopContainerEvents: function() {\n        stopContainerEvents(this._container);\n    }\n});\n\nfunction makeButton(containerClass, title, iconClass, noControlClass) {\n    let cls = 'leaflet-bar leaflet-control-single-button';\n    if (!noControlClass) {\n        cls += ' leafletControl';\n    }\n    if (containerClass) {\n        cls += ' ' + containerClass;\n    }\n    const container = L.DomUtil.create('div', cls);\n    stopContainerEvents(container);\n    const link = L.DomUtil.create('a', null, container);\n    link.href = '#';\n    L.DomEvent.on(link, 'click', L.DomEvent.preventDefault);\n    if (title) {\n        link.title = title;\n    }\n    const icon = L.DomUtil.create('div', iconClass, link);\n    return {container, link, icon};\n}\n\nfunction makeButtonWithBar(containerClass, title, iconClass) {\n    let cls = 'leaflet-control button-with-bar';\n    if (containerClass) {\n        cls += ' ' + containerClass;\n    }\n    const container = L.DomUtil.create('div', cls);\n    const {container: buttonContainer, link, icon} = makeButton(null, title, iconClass, true);\n    container.appendChild(buttonContainer);\n\n    const barContainer = L.DomUtil.create('div', 'leaflet-bar bar', container);\n    stopContainerEvents(barContainer);\n    return {container, buttonContainer, link, icon, barContainer};\n}\n\nexport {stopContainerEvents, makeButton, makeButtonWithBar};\n","import alertify from 'alertify.js';\nimport './style.css';\n\nfunction notify(message, onOk) {\n    alertify.alert(message, onOk);\n}\n\nfunction query(message, value) {\n    function removeFocusFromInput() {\n        const activeElement = document.activeElement;\n        if (activeElement?.tagName === 'INPUT') {\n            activeElement.blur();\n        }\n    }\n\n    const result = window.prompt(message, value);\n    // There is a bug in Chrome on Android: after closing the prompt, it sets focus to last active input element\n    setTimeout(removeFocusFromInput, 0);\n    return result;\n}\n\nexport {notify, query};\n","import * as Sentry from '@sentry/browser';\n\nfunction randId() {\n    return Math.random().toString(36).substring(2, 13);\n}\n\nconst sessionId = randId(); // eslint-disable-line\n\nfunction captureMessage(msg, extra = {}) {\n    extra.url = window.location.toString();\n    console.log('captureMessage', msg, extra); // eslint-disable-line no-console\n    Sentry.withScope(function(scope) {\n        scope.setExtras(extra);\n        Sentry.captureMessage(msg);\n    });\n}\n\nfunction captureException(e, description) {\n    console.log('captureException', e, description); // eslint-disable-line no-console\n    Sentry.withScope(function(scope) {\n        if (description) {\n            scope.setTag('description', description);\n        }\n        scope.setExtra('url', window.location.toString());\n        Sentry.captureException(e);\n    });\n}\nfunction captureBreadcrumb(message, data = {}) {\n    data.url = window.location.toString();\n    Sentry.addBreadcrumb({\n        message, data\n    });\n}\n\nfunction logEvent(eventName, extra) { // eslint-disable-line\n    console.log(eventName, extra); // eslint-disable-line\n}\n\nexport {captureMessage, captureException, captureBreadcrumb, logEvent, randId};\n","import secrets from './secrets';\n\nconst config = {\n    caption: ``,\n    defaultLocation: [44.47716, 33.91960],\n    defaultZoom: 12,\n    googleApiUrl: `https://maps.googleapis.com/maps/api/js?v=3&key=${secrets.google}`,\n    westraDataBaseUrl: 'https://nakarte.me/westraPasses/',\n    CORSProxyUrl: 'https://proxy.nakarte.me/',\n    elevationsServer: 'https://api.crimea-map.com/elevation',\n    wikimediaCommonsCoverageUrl: 'https://tiles.nakarte.me/wikimedia_commons_images/{z}/{x}/{y}',\n    geocachingSuUrl: 'https://nakarte.me/geocachingSu/geocaching_su2.json',\n    tracksStorageServer: 'https://api.crimea-map.com/tracks',\n    apiServer: 'https://api.crimea-map.com/',\n    weatherServer: 'https://crimeamountain.ru/wp-admin/admin-ajax.php?action=jwp_weather_api',\n    ...secrets\n};\n\nexport default config;\n","function arrayBufferToString(arBuf) {\n    const\n        arr = new Uint8Array(arBuf),\n        s = [];\n    for (let i = 0; i < arr.length; i += 4096) {\n        let chunk = arr.subarray(i, i + 4096);\n        chunk = String.fromCharCode.apply(null, chunk);\n        s.push(chunk);\n    }\n    return s.join('');\n}\n\nfunction stringToArrayBuffer(s) {\n    const\n        length = s.length,\n        buf = new ArrayBuffer(length),\n        arr = new Uint8Array(buf);\n    for (let i = 0; i < length; i++) {\n        arr[i] = s.charCodeAt(i);\n    }\n    return buf;\n}\n\nfunction blobFromString(s) {\n    const arr = stringToArrayBuffer(s);\n    return new Blob([arr], {type: \"text/plain;charset=utf-8\"});\n}\n\nexport {arrayBufferToString, blobFromString, stringToArrayBuffer};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {hashState} from './hashState';\nimport * as logging from '~/lib/logging';\n\nL.Mixin.HashState = {\n    enableHashState: function(key, defaultInitialState = null) {\n        this._hashStateKey = key;\n        const eventSource = this.stateChangeEventsSource ? this[this.stateChangeEventsSource] : this;\n\n        // setup event listeners\n        if (this.stateChangeEvents) {\n            this.stateChangeEvents.forEach((event) => {\n                    eventSource.on(event, this._onControlStateChanged, this);\n                }\n            );\n        }\n\n        hashState.addEventListener(key, (state) => this._onExternalStateChanged(state));\n\n        // initialize control state from hash\n\n        const state = hashState.getState(key) || defaultInitialState;\n        if (!state || !this.unserializeState(state)) {\n            this.unserializeState(defaultInitialState);\n        }\n        hashState.updateState(this._hashStateKey, this.serializeState());\n        return this;\n    },\n\n    _onControlStateChanged: function() {\n        const state = this.serializeState();\n        hashState.updateState(this._hashStateKey, state);\n    },\n\n    _onExternalStateChanged: function(state) {\n        if (!this.unserializeState(state)) { // state from hash is invalid, update hash from component state\n            logging.captureMessage(`Invalid state in hash string (key \"${this._hashStateKey}\")`);\n            hashState.updateState(this._hashStateKey, this.serializeState());\n        }\n    }\n\n    // TODO: disableHashState\n};\n","import {decode as utf8_decode} from 'utf8';\nimport {xmlGetNodeText} from './xmlUtils';\nimport stripBom from '~/lib/stripBom';\n\nfunction parseGpx(txt, name, preferNameFromFile) {\n    var error;\n\n    function getSegmentPoints(segment_element) {\n        var points_elements = segment_element.getElementsByTagName('trkpt');\n        var points = [];\n        for (var i = 0; i < points_elements.length; i++) {\n            var point_element = points_elements[i];\n            var lat = parseFloat(point_element.getAttribute('lat'));\n            var lng = parseFloat(point_element.getAttribute('lon'));\n            if (isNaN(lat) || isNaN(lng)) {\n                error = 'CORRUPT';\n                break;\n            }\n            points.push({lat: lat, lng: lng});\n        }\n        return points;\n    }\n\n    function getTrackSegments(xml) {\n        var segments = [];\n        var segments_elements = xml.getElementsByTagName('trkseg');\n        for (var i = 0; i < segments_elements.length; i++) {\n            var segment_points = getSegmentPoints(segments_elements[i]);\n            if (segment_points.length) {\n                segments.push(segment_points);\n            }\n        }\n        return segments;\n    }\n\n    function getRoutePoints(rte_element) {\n        var points_elements = rte_element.getElementsByTagName('rtept');\n        var points = [];\n        for (var i = 0; i < points_elements.length; i++) {\n            var point_element = points_elements[i];\n            var lat = parseFloat(point_element.getAttribute('lat'));\n            var lng = parseFloat(point_element.getAttribute('lon'));\n            if (isNaN(lat) || isNaN(lng)) {\n                error = 'CORRUPT';\n                break;\n            }\n            points.push({lat: lat, lng: lng});\n        }\n        return points;\n    }\n\n    function getRoutes(xml) {\n        var routes = [];\n        var rte_elements = xml.getElementsByTagName('rte');\n        for (var i = 0; i < rte_elements.length; i++) {\n            var rte_points = getRoutePoints(rte_elements[i]);\n            if (rte_points.length) {\n                routes.push(rte_points);\n            }\n        }\n        return routes;\n    }\n\n    function getWaypoints(xml) {\n        var waypoint_elements = xml.getElementsByTagName('wpt');\n        var waypoints = [];\n        for (var i = 0; i < waypoint_elements.length; i++) {\n            var waypoint_element = waypoint_elements[i];\n            var waypoint = {};\n            waypoint.lat = parseFloat(waypoint_element.getAttribute('lat'));\n            waypoint.lng = parseFloat(waypoint_element.getAttribute('lon'));\n            if (isNaN(waypoint.lat) || isNaN(waypoint.lng)) {\n                error = 'CORRUPT';\n                continue;\n            }\n            let wptName = xmlGetNodeText(waypoint_element.getElementsByTagName('name')[0]) || '';\n            try {\n                wptName = utf8_decode((wptName));\n            } catch (e) {\n                error = 'CORRUPT';\n                wptName = '__invalid point name__';\n            }\n            waypoint.name = wptName;\n            waypoint.symbol_name = xmlGetNodeText(waypoint_element.getElementsByTagName('sym')[0]);\n            waypoints.push(waypoint);\n        }\n        return waypoints;\n    }\n\n    txt = stripBom(txt);\n    // remove namespaces\n    txt = txt.replace(/<([^ >]+):([^ >]+)/ug, '<$1_$2');\n    let dom;\n    try {\n        dom = (new DOMParser()).parseFromString(txt, \"text/xml\");\n    } catch (e) {\n        return null;\n    }\n    if (dom.documentElement.nodeName === 'parsererror') {\n        return null;\n    }\n    if (dom.getElementsByTagName('gpx').length === 0) {\n        return null;\n    }\n    if (preferNameFromFile) {\n        for (let trk of [...dom.getElementsByTagName('trk')]) {\n            let trkName = trk.getElementsByTagName('name')[0];\n            if (trkName) {\n                try {\n                    trkName = utf8_decode(xmlGetNodeText(trkName));\n                } catch (e) {\n                    error = 'CORRUPT';\n                }\n                if (trkName.length) {\n                    name = trkName;\n                    break;\n                }\n            }\n        }\n    }\n    return [{\n        name: name,\n        tracks: getTrackSegments(dom).concat(getRoutes(dom)),\n        points: getWaypoints(dom),\n        error: error\n    }];\n}\n\nexport default parseGpx;\n","import './contextmenu.css';\n\n/*\n    items = [\n        {text: 'Hello', disabled: true},\n        '-',\n        {text: 'World', callback: fn},\n        {text: 'section', separator: true},\n    ]\n */\n\nfunction isDescendant(parent, child) {\n    if (!parent) {\n        return false;\n    }\n    while (child) {\n        if (child === parent) {\n            return true;\n        }\n        child = child.parentNode;\n    }\n    return false;\n}\n\nclass Contextmenu {\n    constructor(items) {\n        this.items = items;\n    }\n\n    show(e) {\n        if (this._container) {\n            return;\n        }\n        if (e.originalEvent) {\n            e = e.originalEvent;\n        }\n        if (e.preventDefault) {\n            e.preventDefault();\n        } else {\n            e.returnValue = false;\n        }\n\n        const {clientX: x, clientY: y} = e;\n\n        const container = this._container = document.createElement('div');\n        document.body.appendChild(container);\n        container.className = 'contextmenu';\n        container.style.zIndex = 10000;\n\n        window.addEventListener('keydown', this.onKeyDown, true);\n        window.addEventListener('mousedown', this.onMouseDown, true);\n        window.addEventListener('touchstart', this.onMouseDown, true);\n\n        for (let item of this.createItems()) {\n            container.appendChild(item);\n        }\n        this.setPosition(x, y);\n    }\n\n    hide() {\n        if (!this._container) {\n            return;\n        }\n        document.body.removeChild(this._container);\n        this._container = null;\n\n        window.removeEventListener('keydown', this.onKeyDown, true);\n        window.removeEventListener('mousedown', this.onMouseDown, true);\n        window.removeEventListener('touchstart', this.onMouseDown, true);\n    }\n\n    onKeyDown = (e) => {\n        if (e.keyCode === 27) {\n            this.hide();\n        }\n    };\n\n    onMouseDown = (e) => {\n        if (!isDescendant(this._container, e.target)) {\n            this.hide();\n        }\n    };\n\n    setPosition(x, y) {\n        const window_width = window.innerWidth,\n            window_height = window.innerHeight,\n            menu_width = this._container.offsetWidth,\n            menu_height = this._container.offsetHeight;\n        if (x + menu_width >= window_width) {\n            x -= menu_width;\n            if (x < 0) {\n               x = 0;\n            }\n        }\n        if (y + menu_height >= window_height) {\n            y -= menu_height;\n            if (y < 0) {\n                y = 0;\n            }\n        }\n        this._container.style.left = `${x}px`;\n        this._container.style.top = `${y}px`;\n    }\n\n    *createItems() {\n        let items = this.items;\n        if (typeof items === 'function') {\n            items = items();\n        }\n        for (let itemOptions of items) {\n            if (typeof itemOptions === 'function') {\n                itemOptions = itemOptions();\n            }\n            if (itemOptions === '-' || itemOptions.separator) {\n                yield this.createSeparator(itemOptions);\n            } else {\n                yield this.createItem(itemOptions);\n            }\n        }\n    }\n\n    createItem(itemOptions) {\n        const el = document.createElement('a');\n        let className = 'item';\n        if (itemOptions.disabled) {\n            className += ' disabled';\n        }\n        if (itemOptions.header) {\n            className += ' header';\n        }\n        el.innerHTML = itemOptions.text;\n\n        const callback = itemOptions.callback;\n        if (callback && !itemOptions.disabled) {\n            className += ' action';\n            el.addEventListener('click', this.onItemClick.bind(this, callback));\n        }\n        el.className = className;\n        return el;\n    }\n\n    onItemClick(callback, e) {\n        e.stopPropagation();\n        e.preventDefault();\n        this.hide();\n        callback(e);\n    }\n\n    createSeparator(itemOptions) {\n        const el = document.createElement('div');\n        el.className = 'separator';\n        if (itemOptions.text) {\n            el.innerHTML = `<span>${itemOptions.text}</span>`;\n        }\n        return el;\n    }\n}\n\nexport default Contextmenu;\n","function localStorageWorks() {\n    try {\n        window.localStorage.setItem('_testDummy', 'TEST');\n        return window.localStorage.getItem('_testDummy') === 'TEST';\n    } catch (e) {\n        return false;\n    }\n}\n\nlet storage; // eslint-disable-line import/no-mutable-exports\n\nif (localStorageWorks()) {\n    storage = window.localStorage;\n} else {\n    let _storage = {};\n    storage = {\n        length: 0,\n\n        key: function(n) {\n            return Object.keys(_storage)[n];\n        },\n\n        removeItem: function(key) {\n            delete _storage[key];\n        },\n\n        getItem: function(key) {\n            return storage[key];\n        },\n\n        setItem: function(key, value) {\n            storage[key] = value;\n        },\n\n        clear: function() {\n            _storage = {};\n        }\n    };\n}\n\nexport default storage;\n","import L from 'leaflet';\nimport './canvasMarkers.css';\nimport RBush from 'rbush';\nimport loadImage from 'image-promise';\nimport {wrapLatLngToTarget} from '~/lib/leaflet.fixes/fixWorldCopyJump';\n\n/*\n Marker definition:\n {\n latlng: L.Latlng,\n icon: {url: string, center: [x, y]} or function(marker) returning icon,\n label: string or function,\n tooltip: string or function,\n any other fields\n }\n */\n\nfunction calcIntersectionSum(rect, rects) {\n    let sum = 0,\n        left, right, top, bottom, rect2;\n\n    for (rect2 of rects) {\n        left = Math.max(rect.minX, rect2.minX);\n        right = Math.min(rect.maxX, rect2.maxX);\n        top = Math.max(rect.minY, rect2.minY);\n        bottom = Math.min(rect.maxY, rect2.maxY);\n        if (top < bottom && left < right) {\n            sum += ((right - left) * (bottom - top));\n        }\n    }\n    return sum;\n}\n\nclass MarkerRBush extends RBush {\n    toBBox(marker) {\n        const x = marker.latlng.lng;\n        const y = marker.latlng.lat;\n        return {\n            minX: x,\n            minY: y,\n            maxX: x,\n            maxY: y\n        };\n    }\n\n    compareMinX(a, b) {\n        return a.latlng.lng - b.latlng.lng;\n    }\n\n    compareMinY(a, b) {\n        return a.latlng.lat - b.latlng.lat;\n    }\n}\n\nL.Layer.CanvasMarkers = L.GridLayer.extend({\n        options: {\n            async: true,\n            labelFontName: 'Verdana, Arial, sans-serif',\n            labelFontSize: 10,\n            iconScale: 1,\n            pane: 'rasterMarker',\n            updateWhenZooming: !L.Browser.mobile,\n            iconsOpacity: 1,\n            labelShadowWidth: 1,\n        },\n\n        initialize: function(markers, options) {\n            L.GridLayer.prototype.initialize.call(this, options);\n            this.rtree = new MarkerRBush(9);\n            this._regions = new RBush();\n            this._iconPositions = {};\n            this._labelPositions = {};\n            this._labelPositionsZoom = null;\n            this.addMarkers(markers);\n            this._images = {};\n            this._tileQueue = [];\n            this._hoverMarker = null;\n            this.on('markerenter', this.onMarkerEnter, this);\n            this.on('markerleave', this.onMarkerLeave, this);\n        },\n\n        addMarkers: function(markers) {\n            if (markers) {\n                this.rtree.load(markers);\n                this.resetLabels();\n                setTimeout(() => this.redraw(), 0);\n            }\n        },\n\n        addMarker: function(marker) {\n            // FIXME: adding existing marker must be be noop\n            this.rtree.insert(marker);\n            this.resetLabels();\n            setTimeout(() => this.redraw(), 0);\n        },\n\n        removeMarker: function(marker) {\n            this.removeMarkers([marker]);\n        },\n\n        removeMarkers: function(markers) {\n            markers.forEach((marker) => this.rtree.remove(marker));\n            this.resetLabels();\n            setTimeout(() => this.redraw(), 0);\n        },\n\n        updateMarkers: function(markers) {\n            this.removeMarkers(markers);\n            this.addMarkers(markers);\n        },\n\n        updateMarker: function(marker) {\n            this.updateMarkers([marker]);\n        },\n\n        setMarkerPosition: function(marker, latlng) {\n            this.removeMarker(marker);\n            marker.latlng = latlng;\n            this.addMarker(marker);\n        },\n\n        getMarkers: function() {\n            return this.rtree.all();\n        },\n\n        findLabelPosition: function(iconCenter, iconSize, textWidth, textHeight, pixelExtents) {\n            const\n                verticalPadding = 0,\n                xPositions = [iconCenter[0] + iconSize[0] / 2 + 2, iconCenter[0] - iconSize[0] / 2 - textWidth - 2],\n                yPositions = [\n                    iconCenter[1] - textHeight / 2 + verticalPadding,\n                    iconCenter[1] - textHeight * 0.75 - iconSize[1] / 4 + verticalPadding,\n                    iconCenter[1] - textHeight / 4 + iconSize[1] / 4 + verticalPadding,\n                    iconCenter[1] - textHeight - iconSize[1] / 2 + verticalPadding,\n                    iconCenter[1] + iconSize[1] / 2 + verticalPadding\n                ];\n\n            let minIntersectionSum = Infinity;\n            let bestX = xPositions[0],\n                bestY = yPositions[0];\n            for (let x of xPositions) {\n                for (let y of yPositions) {\n                    const rect = {minX: x, minY: y, maxX: x + textWidth, maxY: y + textHeight};\n                    if (pixelExtents && (rect.minX < pixelExtents.tileW || rect.maxX > pixelExtents.tileE ||\n                        rect.minY < pixelExtents.tileN || rect.maxY > pixelExtents.tileS)) {\n                        continue;\n                    }\n                    let intersectionSum = calcIntersectionSum(rect, this._regions.search(rect));\n                    if (intersectionSum < minIntersectionSum) {\n                        minIntersectionSum = intersectionSum;\n                        bestX = x;\n                        bestY = y;\n                        if (minIntersectionSum === 0) {\n                            break;\n                        }\n                    }\n                }\n                if (minIntersectionSum === 0) {\n                    break;\n                }\n            }\n            return [bestX, bestY];\n        },\n\n        preloadIcons: function(urls) {\n            const newUrls = urls.filter((url) => !(url in this._images));\n            if (newUrls.length) {\n                return loadImage(newUrls).then((images) => {\n                        for (let image of images) {\n                            this._images[image.src] = image;\n                        }\n                    }\n                );\n            }\n            return Promise.resolve();\n        },\n\n        createTile: function(coords, done) {\n            const canvas = L.DomUtil.create('canvas', 'leaflet-tile');\n            canvas.width = this.options.tileSize;\n            canvas.height = this.options.tileSize;\n            setTimeout(() => {\n                    this.drawTile(canvas, coords).then(() => done(null, canvas));\n                }, 0\n            );\n            return canvas;\n        },\n\n        selectMarkersForDraw: function({tileN, tileS, tileE, tileW}, zoom, withoutPadding) {\n            // FIXME: padding should depend on options.iconScale and fontSize\n            if (!this._map) {\n                return {};\n            }\n            const\n                iconsHorPad = withoutPadding ? 0 : 520,\n                iconsVertPad = withoutPadding ? 0 : 50,\n                labelsHorPad = withoutPadding ? 0 : 256,\n                labelsVertPad = withoutPadding ? 0 : 20;\n            const\n                iconsBounds = L.latLngBounds(\n                    this._map.unproject(L.point(tileW - iconsHorPad, tileS + iconsHorPad), zoom),\n                    this._map.unproject(L.point(tileE + iconsHorPad, tileN - iconsVertPad), zoom)\n                ),\n                labelsBounds = L.latLngBounds(\n                    this._map.unproject(L.point(tileW - labelsHorPad, tileS + labelsHorPad), zoom),\n                    this._map.unproject(L.point(tileE + labelsHorPad, tileN - labelsVertPad), zoom)\n                );\n            const\n                iconUrls = [],\n                markerJobs = {};\n\n            // used only to preload icons\n            const pointsForMarkers = [];\n            for (let shift of [-360, 0, 360]) {\n                pointsForMarkers.push(...this.rtree.search({\n                    minX: iconsBounds.getWest() + shift,\n                    minY: iconsBounds.getSouth(),\n                    maxX: iconsBounds.getEast() + shift,\n                    maxY: iconsBounds.getNorth()\n                }));\n            }\n\n            // used to place labels\n            const pointsForLabels = [];\n            for (let shift of [-360, 0, 360]) {\n                pointsForLabels.push(...this.rtree.search({\n                    minX: labelsBounds.getWest() + shift,\n                    minY: labelsBounds.getSouth(),\n                    maxX: labelsBounds.getEast() + shift,\n                    maxY: labelsBounds.getNorth()\n                }));\n            }\n            const tileMidLongitude = this._map.unproject([(tileE + tileW) / 2, tileN], zoom);\n\n            for (let marker of pointsForMarkers) {\n                let latlng = marker.latlng;\n                if (this.options.noWrap) {\n                    latlng = wrapLatLngToTarget(latlng, tileMidLongitude);\n                }\n                const p = this._map.project(latlng, zoom);\n                let icon = marker.icon;\n                if (typeof icon === 'function') {\n                    icon = icon(marker);\n                }\n                iconUrls.push(icon.url);\n                let markerId = L.stamp(marker);\n                markerJobs[markerId] = {marker: marker, icon: icon, projectedXY: p};\n            }\n            return {iconUrls, markerJobs, pointsForLabels};\n        },\n\n        drawSelectedMarkers: function(canvas, pixelExtents, markerJobs, pointsForLabels, zoom, limitLabelsToImage) {\n            const {tileN, tileW, tileS, tileE} = pixelExtents;\n            const textHeight = this.options.labelFontSize * this.options.iconScale;\n            if (this._labelPositionsZoom !== zoom) {\n                this._labelPositionsZoom = zoom;\n                this.resetLabels();\n            }\n            const ctx = canvas.getContext('2d');\n            ctx.font = L.Util.template('bold {size}px {name}',\n                {name: this.options.labelFontName, size: this.options.labelFontSize * this.options.iconScale}\n            );\n            for (let [markerId, job] of Object.entries(markerJobs)) {\n                let img = this._images[job.icon.url];\n                job.img = img;\n                const imgW = Math.round(img.width * this.options.iconScale);\n                const imgH = Math.round(img.height * this.options.iconScale);\n                if (!(markerId in this._iconPositions)) {\n                    let x = job.projectedXY.x - job.icon.center[0] * this.options.iconScale;\n                    let y = job.projectedXY.y - job.icon.center[1] * this.options.iconScale;\n                    x = Math.round(x);\n                    y = Math.round(y);\n                    this._iconPositions[markerId] = [x, y];\n                    this._regions.insert({\n                        minX: x,\n                        minY: y,\n                        maxX: x + imgW,\n                        maxY: y + imgH,\n                        marker: job.marker,\n                        isLabel: false\n                    });\n                }\n                let [x, y] = this._iconPositions[markerId];\n                job.iconCenter = [x + imgW / 2, y + imgH / 2];\n                job.iconSize = [imgW, imgH];\n            }\n            for (let marker of pointsForLabels) {\n                const markerId = L.stamp(marker);\n                const job = markerJobs[markerId];\n                let label = job.marker.label;\n                if (typeof label === 'function') {\n                    label = label(job.marker, zoom);\n                }\n                if (label) {\n                    job.label = label;\n                    if (!(markerId in this._labelPositions)) {\n                        const textWidth = ctx.measureText(label).width;\n                        const p = this.findLabelPosition(job.iconCenter, job.iconSize, textWidth, textHeight,\n                            limitLabelsToImage ? pixelExtents : null);\n                        this._labelPositions[markerId] = p;\n                        let [x, y] = p;\n                        this._regions.insert({\n                            minX: x,\n                            minY: y,\n                            maxX: x + textWidth,\n                            maxY: y + textHeight,\n                            marker: job.marker,\n                            isLabel: true\n                        });\n                    }\n                } else {\n                    this._labelPositions[markerId] = null;\n                }\n            }\n\n            const regionsInTile = this._regions.search({minX: tileW, minY: tileN, maxX: tileE, maxY: tileS});\n            // draw labels\n            for (let region of regionsInTile) {\n                if (region.isLabel) {\n                    // TODO: set font name ant size in options\n                    const markerId = L.stamp(region.marker);\n                    const job = markerJobs[markerId];\n                    const p = this._labelPositions[markerId];\n                    const x = p[0] - tileW;\n                    const y = p[1] - tileN;\n                    ctx.textBaseline = 'bottom';\n                    ctx.shadowColor = '#fff';\n                    ctx.strokeStyle = '#fff';\n                    ctx.fillStyle = '#000';\n                    ctx.lineWidth = 1.2 * this.options.iconScale;\n                    ctx.shadowBlur = this.options.labelShadowWidth * this.options.iconScale;\n                    ctx.strokeText(job.label, x, y + textHeight);\n                    ctx.shadowBlur = 0;\n                    ctx.fillText(job.label, x, y + textHeight);\n                }\n            }\n            ctx.globalAlpha = this.options.iconsOpacity;\n            // draw icons\n            for (let region of regionsInTile) {\n                if (!region.isLabel) {\n                    const markerId = L.stamp(region.marker);\n                    const job = markerJobs[markerId];\n                    const p = this._iconPositions[markerId];\n                    const x = p[0] - tileW;\n                    const y = p[1] - tileN;\n                    ctx.drawImage(job.img, x, y, job.iconSize[0], job.iconSize[1]);\n                }\n            }\n            ctx.globalAlpha = 1;\n        },\n\n        drawTile: async function(canvas, coords) {\n            const\n                zoom = coords.z,\n                tileSize = this.options.tileSize,\n                tileN = coords.y * tileSize,\n                tileW = coords.x * tileSize,\n                tileS = tileN + tileSize,\n                tileE = tileW + tileSize;\n            const pixelExtents = {tileN, tileS, tileE, tileW};\n            const {iconUrls, markerJobs, pointsForLabels} = this.selectMarkersForDraw(pixelExtents, zoom);\n            if (!markerJobs) {\n                return;\n            }\n            await this.preloadIcons(iconUrls);\n            this.drawSelectedMarkers(canvas, pixelExtents, markerJobs, pointsForLabels, zoom);\n        },\n\n        resetLabels: function() {\n            this._iconPositions = {};\n            this._labelPositions = {};\n            this._regions.clear();\n        },\n\n        findMarkerFromMouseEvent: function(e) {\n            const\n                p = this._map.project(e.latlng.wrap()),\n                region = this._regions.search({minX: p.x, minY: p.y, maxX: p.x, maxY: p.y})[0];\n            let marker;\n            if (region) {\n                marker = region.marker;\n            } else {\n                marker = null;\n            }\n            return marker;\n        },\n\n        onMouseMove: function(e) {\n            const marker = this.findMarkerFromMouseEvent(e);\n            if (this._hoverMarker !== marker) {\n                if (this._hoverMarker) {\n                    this.fire('markerleave', {marker: this._hoverMarker});\n                }\n                if (marker) {\n                    this.fire('markerenter', {marker: marker});\n                }\n                this._hoverMarker = marker;\n            }\n        },\n\n        showTooltip: function(e) {\n            if (!e.marker.tooltip) {\n                return;\n            }\n            let text = e.marker.tooltip;\n            if (typeof text === 'function') {\n                text = text(e.marker);\n                if (!e.marker.tooltip) {\n                    return;\n                }\n            }\n            this.toolTip.innerHTML = text;\n            const p = this._map.latLngToLayerPoint(e.marker.latlng);\n            L.DomUtil.setPosition(this.toolTip, p);\n            L.DomUtil.addClass(this.toolTip, 'canvas-marker-tooltip-on');\n        },\n\n        onMarkerEnter: function(e) {\n            this._map._container.style.cursor = 'pointer';\n            this.showTooltip(e);\n        },\n\n        onMarkerLeave: function() {\n            this._map._container.style.cursor = '';\n            L.DomUtil.removeClass(this.toolTip, 'canvas-marker-tooltip-on');\n        },\n\n        onMouseOut: function() {\n            if (this._hoverMarker) {\n                const marker = this._hoverMarker;\n                this._hoverMarker = null;\n                this.fire('markerleave', {marker});\n            }\n        },\n\n        onClick: function(e) {\n            if (this._map.clickLocked) {\n                return;\n            }\n            const marker = this.findMarkerFromMouseEvent(e);\n            if (marker) {\n                L.extend(e, {marker: marker});\n                this.fire('markerclick', e);\n            }\n        },\n\n        onRightClick: function(e) {\n            const marker = this.findMarkerFromMouseEvent(e);\n            if (marker) {\n                L.extend(e, {marker: marker});\n                this.fire('markercontextmenu', e);\n            }\n        },\n\n        onAdd: function(map) {\n            if (this.options.pane === 'rasterMarker' && !map.getPane('rasterMarker')) {\n                map.createPane('rasterMarker').style.zIndex = 550;\n            }\n            L.GridLayer.prototype.onAdd.call(this, map);\n            map.on('mousemove', this.onMouseMove, this);\n            map.on('mouseout', this.onMouseOut, this);\n            map.on('click', this.onClick, this);\n            map.on('contextmenu', this.onRightClick, this);\n            this.toolTip = L.DomUtil.create('div', 'canvas-marker-tooltip', this._map.getPanes().markerPane);\n        },\n\n        onRemove: function(map) {\n            this._map.off('mousemove', this.onMouseMove, this);\n            this._map.off('mouseout', this.onMouseOut, this);\n            this._map.off('click', this.onClick, this);\n            this._map.off('contextmenu', this.onRightClick, this);\n            if (this._hoverMarker) {\n                this._hoverMarker = null;\n                this.fire('markerleave', {marker: this._hoverMarker});\n            }\n            this._map.getPanes().markerPane.removeChild(this.toolTip);\n            L.GridLayer.prototype.onRemove.call(this, map);\n        }\n    }\n);\n","import L from 'leaflet';\n\nfunction shiftLongitudeToTarget(lng, targetLng) {\n    if (targetLng instanceof L.LatLngBounds) {\n        if (!targetLng.isValid()) {\n            return 0;\n        }\n        targetLng = targetLng.getCenter().lng;\n    } else {\n        targetLng = targetLng.lng ?? targetLng;\n    }\n    let shift = 0;\n    if (Math.abs(lng + 360 - targetLng) < Math.abs(lng - targetLng)) {\n        shift = 360;\n    } else if (Math.abs(lng - 360 - targetLng) < Math.abs(lng - targetLng)) {\n        shift = -360;\n    }\n    return shift;\n}\n\nfunction wrapLatLngToTarget(latLng, targetLng) {\n    const shift = shiftLongitudeToTarget(latLng.lng, targetLng);\n    return L.latLng(latLng.lat, latLng.lng + shift);\n}\n\nfunction wrapLatLngBoundsToTarget(latLngBounds, targetLng) {\n    const shift = shiftLongitudeToTarget(latLngBounds.getCenter().lng, targetLng);\n    const p1 = latLngBounds.getSouthEast();\n    const p2 = latLngBounds.getNorthWest();\n    return L.latLngBounds([[p1.lat, p1.lng + shift], [p2.lat, p2.lng + shift]]);\n}\n\nfunction fixVectorMarkerWorldJump() {\n    L.Polyline.prototype.shiftProjectedFitMapView = function() {\n        const polylineBounds = this.getBounds();\n        let shift = null;\n        if (this._map && polylineBounds.isValid()) {\n            const worldWidth = this._map.getPixelWorldBounds().getSize().x;\n            const polylineCenter = polylineBounds.getCenter();\n            const mapCenter = this._map.getCenter();\n\n            if (polylineCenter.lng < mapCenter.lng - 180) {\n                shift = worldWidth;\n            } else if (polylineCenter.lng > mapCenter.lng + 180) {\n                shift = -worldWidth;\n            } else {\n                shift = 0;\n            }\n        }\n        return shift;\n    };\n\n    // Shift line points longitude by +360 or -360, to minimize distance between line center and map view center\n    // Longitude is changed only for display, longitude of pints is not changed\n    // Breaks dipslay of lines spanning more then one world copy\n    L.Polyline.prototype._projectLatlngs = function(latlngs, result, projectedBounds) {\n        var flat = latlngs[0] instanceof L.LatLng,\n            len = latlngs.length,\n            i, ring;\n        let shift = null;\n        if (this.options.projectedShift) {\n            shift = this.options.projectedShift();\n        }\n        if (shift === null) {\n            shift = this.shiftProjectedFitMapView();\n        }\n\n        if (flat) {\n            ring = [];\n            for (i = 0; i < len; i++) {\n                let p = this._map.latLngToLayerPoint(latlngs[i]);\n                p.x += shift;\n                ring[i] = p;\n                projectedBounds.extend(p);\n            }\n            result.push(ring);\n        } else {\n            for (i = 0; i < len; i++) {\n                this._projectLatlngs(latlngs[i], result, projectedBounds);\n            }\n        }\n    };\n\n    // Shift marker longitude by +360 or -360, which is closer to map view center\n    // Longitude is changed only for positioning html-element, Marker._latlng is not changed\n    // Breaks display of markers with huge longitudes like 750 (can be displayed only at zoom levels 0 or 1)\n    L.Marker.prototype.update = function() {\n        if (this._icon) {\n            var pos = this._map.latLngToLayerPoint(this._latlng).round();\n            let shift = null;\n            if (this.options.projectedShift) {\n                shift = this.options.projectedShift();\n            }\n            if (shift === null) {\n                const mapCenter = this._map.getCenter();\n                const worldWidth = this._map.getPixelWorldBounds().getSize().x;\n                if (this._latlng.lng < mapCenter.lng - 180) {\n                    shift = worldWidth;\n                } else if (this._latlng.lng > mapCenter.lng + 180) {\n                    shift = -worldWidth;\n                } else {\n                    shift = 0;\n                }\n            }\n            pos.x += shift;\n            this._setPos(pos);\n        }\n\n        return this;\n    };\n\n    // Emit viewreset event when longitude of map view center changes more then 90 degrees from prevoius reset\n    L.Map.addInitHook(function() {\n        this._lastResetLongitude = null;\n        this.on('viewreset', () => {\n            this._lastResetLongitude = this.getCenter().lng;\n        });\n\n        this.on('move', () => {\n            const lng = this.getCenter().lng;\n            if (this._lastResetLongitude === null) {\n                this._lastResetLongitude = lng;\n            } else if (Math.abs(lng - this._lastResetLongitude) > 90) {\n                this.fire('viewreset');\n            }\n        });\n    });\n\n    // Avoid marker longitude change from 180 to -180 while dragging.\n    L.Handler.MarkerDrag = L.Handler.extend({\n        _onDrag: function(e) {\n            var marker = this._marker,\n                shadow = marker._shadow,\n                iconPos = L.DomUtil.getPosition(marker._icon),\n                latlng = marker._map.layerPointToLatLng(iconPos);\n            // update shadow position\n            if (shadow) {\n                L.DomUtil.setPosition(shadow, iconPos);\n            }\n\n            latlng = wrapLatLngToTarget(latlng, marker._latlng);\n            marker._latlng = latlng;\n            e.latlng = latlng;\n            e.oldLatLng = this._oldLatLng;\n\n            // @event drag: Event\n            // Fired repeatedly while the user drags the marker.\n            marker\n                .fire('move', e)\n                .fire('drag', e);\n        }\n    });\n}\n\nexport {wrapLatLngToTarget, fixVectorMarkerWorldJump, wrapLatLngBoundsToTarget};\n","/* FileSaver.js\n * A saveAs() FileSaver implementation.\n * 1.3.8\n * 2018-03-22 14:03:47\n *\n * By Eli Grey, https://eligrey.com\n * License: MIT\n *   See https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md\n */\n\n/*global self */\n/*jslint bitwise: true, indent: 4, laxbreak: true, laxcomma: true, smarttabs: true, plusplus: true */\n\n/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/src/FileSaver.js */\n\nexport var saveAs = saveAs || (function(view) {\n        \"use strict\";\n        // IE <10 is explicitly unsupported\n        if (typeof view === \"undefined\" || typeof navigator !== \"undefined\" && /MSIE [1-9]\\./.test(navigator.userAgent)) {\n            return;\n        }\n        var\n            doc = view.document\n            // only get URL when necessary in case Blob.js hasn't overridden it yet\n            , get_URL = function() {\n                return view.URL || view.webkitURL || view;\n            }\n            , save_link = doc.createElementNS(\"http://www.w3.org/1999/xhtml\", \"a\")\n            , can_use_save_link = \"download\" in save_link\n            , click = function(node) {\n                var event = new MouseEvent(\"click\");\n                node.dispatchEvent(event);\n            }\n            , is_safari = /constructor/i.test(view.HTMLElement) || view.safari\n            , is_chrome_ios =/CriOS\\/[\\d]+/.test(navigator.userAgent)\n            , setImmediate = view.setImmediate || view.setTimeout\n            , throw_outside = function(ex) {\n                setImmediate(function() {\n                    throw ex;\n                }, 0);\n            }\n            , force_saveable_type = \"application/octet-stream\"\n            // the Blob API is fundamentally broken as there is no \"downloadfinished\" event to subscribe to\n            , arbitrary_revoke_timeout = 1000 * 40 // in ms\n            , revoke = function(file) {\n                var revoker = function() {\n                    if (typeof file === \"string\") { // file is an object URL\n                        get_URL().revokeObjectURL(file);\n                    } else { // file is a File\n                        file.remove();\n                    }\n                };\n                setTimeout(revoker, arbitrary_revoke_timeout);\n            }\n            , dispatch = function(filesaver, event_types, event) {\n                event_types = [].concat(event_types);\n                var i = event_types.length;\n                while (i--) {\n                    var listener = filesaver[\"on\" + event_types[i]];\n                    if (typeof listener === \"function\") {\n                        try {\n                            listener.call(filesaver, event || filesaver);\n                        } catch (ex) {\n                            throw_outside(ex);\n                        }\n                    }\n                }\n            }\n            , auto_bom = function(blob) {\n                // prepend BOM for UTF-8 XML and text/* types (including HTML)\n                // note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\n                if (/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n                    return new Blob([String.fromCharCode(0xFEFF), blob], {type: blob.type});\n                }\n                return blob;\n            }\n            , FileSaver = function(blob, name, no_auto_bom) {\n                if (!no_auto_bom) {\n                    blob = auto_bom(blob);\n                }\n                // First try a.download, then web filesystem, then object URLs\n                var\n                    filesaver = this\n                    , type = blob.type\n                    , force = type === force_saveable_type\n                    , object_url\n                    , dispatch_all = function() {\n                        dispatch(filesaver, \"writestart progress write writeend\".split(\" \"));\n                    }\n                    // on any filesys errors revert to saving with object URLs\n                    , fs_error = function() {\n                        if ((is_chrome_ios || (force && is_safari)) && view.FileReader) {\n                            // Safari doesn't allow downloading of blob urls\n                            var reader = new FileReader();\n                            reader.onloadend = function() {\n                                var url = is_chrome_ios ? reader.result : reader.result.replace(/^data:[^;]*;/, 'data:attachment/file;');\n                                var popup = view.open(url, '_blank');\n                                if(!popup) view.location.href = url;\n                                url=undefined; // release reference before dispatching\n                                filesaver.readyState = filesaver.DONE;\n                                dispatch_all();\n                            };\n                            reader.readAsDataURL(blob);\n                            filesaver.readyState = filesaver.INIT;\n                            return;\n                        }\n                        // don't create more object URLs than needed\n                        if (!object_url) {\n                            object_url = get_URL().createObjectURL(blob);\n                        }\n                        if (force) {\n                            view.location.href = object_url;\n                        } else {\n                            var opened = view.open(object_url, \"_blank\");\n                            if (!opened) {\n                                // Apple does not allow window.open, see https://developer.apple.com/library/safari/documentation/Tools/Conceptual/SafariExtensionGuide/WorkingwithWindowsandTabs/WorkingwithWindowsandTabs.html\n                                view.location.href = object_url;\n                            }\n                        }\n                        filesaver.readyState = filesaver.DONE;\n                        dispatch_all();\n                        revoke(object_url);\n                    }\n                    ;\n                filesaver.readyState = filesaver.INIT;\n\n                if (can_use_save_link) {\n                    object_url = get_URL().createObjectURL(blob);\n                    setImmediate(function() {\n                        save_link.href = object_url;\n                        save_link.download = name;\n                        save_link.target = '_self';\n                        click(save_link);\n                        dispatch_all();\n                        revoke(object_url);\n                        filesaver.readyState = filesaver.DONE;\n                    }, 0);\n                    return;\n                }\n\n                fs_error();\n            }\n            , FS_proto = FileSaver.prototype\n            , saveAs = function(blob, name, no_auto_bom) {\n                return new FileSaver(blob, name || blob.name || \"download\", no_auto_bom);\n            }\n            ;\n\n        // IE 10+ (native saveAs)\n        if (typeof navigator !== \"undefined\" && navigator.msSaveOrOpenBlob) {\n            return function(blob, name, no_auto_bom) {\n                name = name || blob.name || \"download\";\n\n                if (!no_auto_bom) {\n                    blob = auto_bom(blob);\n                }\n                return navigator.msSaveOrOpenBlob(blob, name);\n            };\n        }\n\n        // todo: detect chrome extensions & packaged apps\n        //save_link.target = \"_blank\";\n\n        FS_proto.abort = function(){};\n        FS_proto.readyState = FS_proto.INIT = 0;\n        FS_proto.WRITING = 1;\n        FS_proto.DONE = 2;\n\n        FS_proto.error =\n            FS_proto.onwritestart =\n                FS_proto.onprogress =\n                    FS_proto.onwrite =\n                        FS_proto.onabort =\n                            FS_proto.onerror =\n                                FS_proto.onwriteend =\n                                    null;\n\n        return saveAs;\n    }(\n        typeof self !== \"undefined\" && self\n        || typeof window !== \"undefined\" && window\n        || this\n    ));\n","import L from 'leaflet';\nimport ko from 'knockout';\nimport Contextmenu from '~/lib/contextmenu';\nimport '~/lib/knockout.component.progress/progress';\nimport './track-list.css';\nimport {selectFiles, readFiles} from '~/lib/file-read';\nimport parseGeoFile from './lib/parseGeoFile';\nimport loadFromUrl from './lib/loadFromUrl';\nimport * as geoExporters from './lib/geo_file_exporters';\nimport copyToClipboard from '~/lib/clipboardCopy';\nimport {saveAs} from '~/vendored/github.com/eligrey/FileSaver';\nimport '~/lib/leaflet.layer.canvasMarkers';\nimport '~/lib/leaflet.lineutil.simplifyLatLngs';\nimport iconFromBackgroundImage from '~/lib/iconFromBackgroundImage';\nimport '~/lib/controls-styles/controls-styles.css';\nimport {ElevationProfile, calcSamplingInterval} from '~/lib/leaflet.control.elevation-profile';\nimport '~/lib/leaflet.control.commons';\nimport {blobFromString} from '~/lib/binary-strings';\nimport '~/lib/leaflet.polyline-edit';\nimport '~/lib/leaflet.polyline-measure';\nimport * as logging from '~/lib/logging';\nimport {notify, query} from '~/lib/notifications';\nimport {fetch} from '~/lib/xhr-promise';\nimport config from '~/config';\nimport md5 from 'blueimp-md5';\nimport {wrapLatLngToTarget, wrapLatLngBoundsToTarget} from '~/lib/leaflet.fixes/fixWorldCopyJump';\nimport {splitLinesAt180Meridian} from \"./lib/meridian180\";\nimport {ElevationProvider} from '~/lib/elevations';\n\nconst TRACKLIST_TRACK_COLORS = ['#77f', '#f95', '#0ff', '#FF0000', '#f7f', '#000', '#008000'];\n\nconst TrackSegment = L.MeasuredLine.extend({\n    includes: L.Polyline.EditMixin,\n\n    options: {\n        weight: 6,\n        lineCap: 'round',\n        opacity: 0.6,\n\n    }\n});\nTrackSegment.mergeOptions(L.Polyline.EditMixinOptions);\n\nfunction unwrapLatLngsCrossing180Meridian(latngs) {\n    if (latngs.length === 0) {\n        return [];\n    }\n    const unwrapped = [latngs[0]];\n    let lastUnwrapped;\n    let prevUnwrapped = latngs[0];\n    for (let i = 1; i < latngs.length; i++) {\n        lastUnwrapped = wrapLatLngToTarget(latngs[i], prevUnwrapped);\n        unwrapped.push(lastUnwrapped);\n        prevUnwrapped = lastUnwrapped;\n    }\n    return unwrapped;\n}\n\nfunction closestPointToLineSegment(latlngs, segmentIndex, point) {\n    const crs = L.CRS.EPSG3857;\n    point = crs.latLngToPoint(point);\n    const segStart = crs.latLngToPoint(latlngs[segmentIndex]);\n    const segEnd = crs.latLngToPoint(latlngs[segmentIndex + 1]);\n    return crs.pointToLatLng(L.LineUtil.closestPointOnSegment(point, segStart, segEnd));\n}\n\nfunction isPointCloserToStart(latlngs, latlng) {\n    const distToStart = latlng.distanceTo(latlngs[0]);\n    const distToEnd = latlng.distanceTo(latlngs[latlngs.length - 1]);\n    return distToStart < distToEnd;\n}\n\nL.Control.TrackList = L.Control.extend({\n        options: {\n            position: 'bottomright',\n            lineCursorStyle: {interactive: false, weight: 1.5, opacity: 1, dashArray: '7,7'},\n            lineCursorValidStyle: {color: 'green'},\n            lineCursorInvalidStyle: {color: 'red'},\n            splitExtensions: ['gpx', 'kml', 'kmz', 'wpt', 'rte', 'plt', 'fit', 'tmp', 'jpg', 'crdownload'],\n            splitExtensionsFirstStage: ['xml', 'txt', 'html', 'php', 'tmp', 'gz'],\n        },\n        includes: L.Evented,\n\n        colors: TRACKLIST_TRACK_COLORS,\n\n        initialize: function() {\n            L.Control.prototype.initialize.call(this);\n            this.currentGroup = ko.observable('');\n            this.tracks = ko.observableArray();\n            this.url = ko.observable('');\n            this.readingFiles = ko.observable(0);\n            this.readProgressRange = ko.observable();\n            this.readProgressDone = ko.observable();\n            this._lastTrackColor = 0;\n            this.trackListHeight = ko.observable(0);\n            this.isPlacingPoint = false;\n            this.trackAddingPoint = ko.observable(null);\n            this.trackAddingSegment = ko.observable(null);\n            this.filteredTracks = ko.computed(() => {\n                let current_group = this.currentGroup();\n                if (!current_group || current_group === '') {\n                    return this.tracks;\n                } else {\n                    return ko.utils.arrayFilter(this.tracks(), function(element) {\n                        return (element.group() === current_group);\n                    });\n                }\n            });\n\n            this.tracks.subscribe( (changes) => {\n                let group = '';\n                let shared = false;\n                changes.forEach( (el) => {\n                    if ( 'added' === el.status ) {\n                        group = el.value.group();\n                    }\n                    if ( 'deleted' === el.status ) {\n                        group = el.value.group();\n                    }\n                } );\n                this.setTab( group );\n\n\n                // если после изменения трэклиста не остатётся расшареных трэков - скрываем табы\n                this.tracks().forEach( (obj) => {\n                    if ( 'shared' === obj.group() ) {\n                        shared = true;\n                    }\n                } );\n                if ( ! shared ) {\n                    this.setTab( '' );\n                }\n\n            }, null, 'arrayChange');\n        },\n\n        setTab: function(tab) {\n            this.setCurrentGroup(tab);\n\n            if ( 'default' === tab ) {\n                let base_loaded = document.querySelector('#tab-loaded');\n                let base_tab = document.querySelector('#tab-base');\n                base_loaded.classList.remove(\"tabs__link_active\");\n                base_tab.classList.add(\"tabs__link_active\");\n            }\n\n            if ( 'shared' === tab ) {\n                let base_loaded = document.querySelector('#tab-loaded');\n                let base_tab = document.querySelector('#tab-base');\n                base_tab.classList.remove(\"tabs__link_active\");\n                base_loaded.classList.add(\"tabs__link_active\");\n            }\n        },\n\n        setCurrentGroup: function(group) {\n            this.currentGroup( group );\n        },\n\n        onAdd: function(map) {\n            this.map = map;\n            this.tracks.removeAll();\n            var container = this._container = L.DomUtil.create('div', 'leaflet-control leaflet-control-tracklist');\n            this._stopContainerEvents();\n\n            /* eslint-disable max-len */\n            container.innerHTML = `\n                <div class=\"leaflet-control-button-toggle\" data-bind=\"click: setExpanded\"\n                 title=\"Load, edit and save tracks\"></div>\n                <div class=\"leaflet-control-content\">\n                <div class=\"header\">\n                    <div class=\"hint\"\n                     title=\"gpx kml Ozi zip YandexMaps GPSies Strava GPSLib Endomondo Etomesto Movescount GarminConnect SportsTracker OSM Tracedetrail OpenStreetMap.ru\">\n                        gpx kml Ozi zip YandexMaps GPSies Strava\n                        <span class=\"formats-hint-more\">&hellip;</span>\n                    </div>\n                    <div class=\"button-minimize\" data-bind=\"click: setMinimized\"></div>\n                </div>\n                <div class=\"inputs-row\" data-bind=\"visible: !readingFiles()\">\n                    <a class=\"button add-track\" title=\"Создать новый трэк\" data-bind=\"click: onButtonNewTrackClicked\"></a\n                    ><a class=\"button open-file\" title=\"Открыть файл с трэком\" data-bind=\"click: loadFilesFromDisk\"></a\n                    ><input type=\"text\" class=\"input-url\" placeholder=\"URL трэка\"\n                        data-bind=\"textInput: url, event: {keypress: onEnterPressedInInput, contextmenu: defaultEventHandle, mousemove: defaultEventHandle}\"\n                    ><a class=\"button download-url\" title=\"Загрузить трэк по URL\" data-bind=\"click: loadFilesFromUrl\"></a\n                    ><a class=\"button menu-icon\" data-bind=\"click: function(_,e){this.showMenu(e)}\" title=\"Меню\"></a>\n                </div>\n                <div style=\"text-align: center\">\n                    <div data-bind=\"\n                        component: {\n                        name: 'progress-indicator',\n                        params: {progressRange: readProgressRange, progressDone: readProgressDone}\n                        },\n                        visible: readingFiles\"></div>\n                </div>\n                <div class=\"tabs__nav\" data-bind=\"visible: currentGroup() !== ''\">\n                    <a id=\"tab-base\" data-bind=\"click: showDefaultTracklist\" class=\"tabs__link\" href=\"#content-1\">Мой трэклист</a>\n                    <a id=\"tab-loaded\" data-bind=\"click: showSharedTracklist\" class=\"tabs__link tabs__link_active\" href=\"#content-2\">Временный трэклист</a>\n                </div>\n                <div class=\"tracks-rows-wrapper\" data-bind=\"style: {maxHeight: trackListHeight}\">\n                <table class=\"tracks-rows\"><tbody data-bind=\"foreach: {data: filteredTracks(), as: 'track'}\">\n                    <tr data-bind=\"event: {\n                                       contextmenu: $parent.showTrackMenu.bind($parent),\n                                       mouseenter: $parent.onTrackRowMouseEnter.bind($parent, track),\n                                       mouseleave: $parent.onTrackRowMouseLeave.bind($parent, track)\n                                   },\n                                   css: {hover: hover() && $parent.tracks().length > 1, edit: isEdited() && $parent.tracks().length > 1}\">\n                        <td><input type=\"checkbox\" class=\"visibility-switch\" data-bind=\"checked: track.visible\"></td>\n                        <td><div class=\"color-sample\" data-bind=\"style: {backgroundColor: $parent.colors[track.color()]}, click: $parent.onColorSelectorClicked.bind($parent)\"></div></td>\n                        <td><div class=\"track-name-wrapper\"><div class=\"track-name\" data-bind=\"text: track.name, attr: {title: track.name}, click: $parent.setViewToTrack.bind($parent)\"></div></div></td>\n                        <td>\n                            <div class=\"button-length\" title=\"Show distance marks\" data-bind=\"\n                                text: $parent.formatLength(track.length()),\n                                css: {'ticks-enabled': track.measureTicksShown},\n                                click: $parent.switchMeasureTicksVisibility.bind($parent)\"></div>\n                        </td>\n                        <td><div class=\"button-add-track\" title=\"Добавить сегмент\" data-bind=\"click: $parent.onButtonAddSegmentClicked.bind($parent, track), css: {active: $parent.trackAddingSegment() === track}\"></div></td>\n                        <td><div class=\"button-add-point\" title=\"Добавить метку\" data-bind=\"click: $parent.onButtonAddPointClicked.bind($parent, track), css: {active: $parent.trackAddingPoint() === track}\"></div></td>\n                        <td><a class=\"track-text-button\" title=\"Действия\" data-bind=\"click: $parent.showTrackMenu.bind($parent)\">&hellip;</a></td>\n                    </tr>\n                </tbody></table>\n                </div>\n                </div>\n            `;\n            /* eslint-enable max-len */\n\n            ko.applyBindings(this, container);\n            // FIXME: add onRemove method and unsubscribe\n            L.DomEvent.addListener(map.getContainer(), 'drop', this.onFileDragDrop, this);\n            L.DomEvent.addListener(map.getContainer(), 'dragover', this.onFileDraging, this);\n            this.menu = new Contextmenu([\n                    {text: 'Копировать ссылку на все трэки', callback: this.copyAllTracksToClipboard.bind(this)},\n                    {text: 'Копировать ссылку на видимые трэки', callback: this.copyVisibleTracks.bind(this)},\n                    '-',\n                    {text: 'Удалить все трэки', callback: this.deleteAllTracks.bind(this)},\n                    {text: 'Удалить скрытые трэки', callback: this.deleteHiddenTracks.bind(this)}\n                ]\n            );\n            this._markerLayer = new L.Layer.CanvasMarkers(null, {\n                print: true,\n                scaleDependent: true,\n                zIndex: 1000,\n                printTransparent: true\n            }).addTo(map);\n            this._markerLayer.on('markerclick markercontextmenu', this.onMarkerClick, this);\n            this._markerLayer.on('markerenter', this.onMarkerEnter, this);\n            this._markerLayer.on('markerleave', this.onMarkerLeave, this);\n            map.on('resize', this._setAdaptiveHeight, this);\n            setTimeout(() => this._setAdaptiveHeight(), 0);\n            return container;\n        },\n\n        showDefaultTracklist: function(e) {\n            let base_loaded = document.querySelector('#tab-loaded');\n            let base_tab = document.querySelector('#tab-base');\n            base_loaded.classList.remove(\"tabs__link_active\");\n            base_tab.classList.add(\"tabs__link_active\");\n            this.currentGroup('default');\n            this.currentGroup.valueHasMutated();\n            this.tracks.valueHasMutated();\n        },\n\n        showSharedTracklist: function(e) {\n            let base_loaded = document.querySelector('#tab-loaded');\n            let base_tab = document.querySelector('#tab-base');\n            base_tab.classList.remove(\"tabs__link_active\");\n            base_loaded.classList.add(\"tabs__link_active\");\n            this.currentGroup('shared');\n            this.currentGroup.valueHasMutated();\n            this.tracks.valueHasMutated();\n        },\n\n        defaultEventHandle: function(_, e) {\n            L.DomEvent.stopPropagation(e);\n            return true;\n        },\n\n        _setAdaptiveHeight: function() {\n            const mapHeight = this._map.getSize().y;\n            let maxHeight;\n            maxHeight =\n                mapHeight -\n                this._container.offsetTop - // controls above\n                // controls below\n                (this._container.parentNode.offsetHeight - this._container.offsetTop - this._container.offsetHeight) -\n                525; // margin\n            this.trackListHeight(maxHeight + 'px');\n        },\n\n        setExpanded: function() {\n            L.DomUtil.removeClass(this._container, 'minimized');\n        },\n\n        setMinimized: function() {\n            L.DomUtil.addClass(this._container, 'minimized');\n        },\n\n        onFileDraging: function(e) {\n            L.DomEvent.stopPropagation(e);\n            L.DomEvent.preventDefault(e);\n            e.dataTransfer.dropEffect = 'copy';\n        },\n\n        onFileDragDrop: function(e) {\n            L.DomEvent.stopPropagation(e);\n            L.DomEvent.preventDefault(e);\n            const files = e.dataTransfer.files;\n            if (files && files.length) {\n                this.loadFilesFromFilesObject(files);\n            }\n        },\n\n        onEnterPressedInInput: function(this_, e) {\n            if (e.keyCode === 13) {\n                this_.loadFilesFromUrl();\n                L.DomEvent.stop(e);\n                return false;\n            }\n            return true;\n        },\n\n        getTrackPolylines: function(track) {\n            return track.feature.getLayers().filter(function(layer) {\n                    return layer instanceof L.Polyline;\n                }\n            );\n        },\n\n        getTrackPoints: function(track) {\n            return track.markers;\n        },\n\n        onButtonNewTrackClicked: function() {\n            let name = this.url().trim();\n            if (name.length > 0) {\n                this.url('');\n            } else {\n                name = 'Новый трэк';\n            }\n            this.addTrackAndEdit(name);\n        },\n\n        addSegmentAndEdit: function(track) {\n            this.stopPlacingPoint();\n            const segment = this.addTrackSegment(track);\n            this.startEditTrackSegement(segment);\n            segment.startDrawingLine();\n            this.trackAddingSegment(track);\n        },\n\n        addTrackAndEdit: function(name) {\n            const track = this.addTrack({name: name, color: 0});\n            this.addSegmentAndEdit(track);\n            return track;\n        },\n\n        loadFilesFromFilesObject: function(files) {\n            this.readingFiles(this.readingFiles() + 1);\n\n            readFiles(files).then(function(fileDataArray) {\n                const geodataArray = [];\n                for (let fileData of fileDataArray) {\n                    geodataArray.push(...parseGeoFile(fileData.filename, fileData.data));\n                }\n                this.readingFiles(this.readingFiles() - 1);\n\n                this.addTracksFromGeodataArray(geodataArray);\n            }.bind(this));\n        },\n\n        loadFilesFromDisk: function() {\n            logging.captureBreadcrumb('load track from disk');\n            selectFiles(true).then(this.loadFilesFromFilesObject.bind(this));\n        },\n\n        loadFilesFromUrl: function() {\n            var url = this.url().trim();\n            if (!url) {\n                return;\n            }\n\n            this.readingFiles(this.readingFiles() + 1);\n\n            logging.captureBreadcrumb('load track from url', {trackUrl: url});\n            loadFromUrl(url)\n                .then((geodata) => {\n                    this.addTracksFromGeodataArray(geodata);\n                    this.readingFiles(this.readingFiles() - 1);\n                });\n            this.url('');\n        },\n\n        whenLoadDone: function(cb) {\n            if (this.readingFiles() === 0) {\n                cb();\n                return;\n            }\n            const subscription = this.readingFiles.subscribe((value) => {\n                if (value === 0) {\n                    subscription.dispose();\n                    cb();\n                }\n            });\n        },\n\n        addTracksFromGeodataArray: function( geodata_array, origin = '' ) {\n            let hasData = false;\n            var messages = [];\n            if (geodata_array.length === 0) {\n                messages.push('No tracks loaded');\n            }\n            geodata_array.forEach(function(geodata) {\n                    var data_empty = !((geodata.tracks && geodata.tracks.length) ||\n                        (geodata.points && geodata.points.length));\n\n                    if (!data_empty) {\n                        if (geodata.tracks) {\n                            geodata.tracks = geodata.tracks.map(function(line) {\n                                    line = unwrapLatLngsCrossing180Meridian(line);\n                                    line = L.LineUtil.simplifyLatlngs(line, 360 / (1 << 24));\n                                    if (line.length === 1) {\n                                        line.push(line[0]);\n                                    }\n                                    return line;\n                                }\n                            );\n                        }\n                        hasData = true;\n                        let track = this.addTrack(geodata);\n                        if ( 'nktu' === origin ) {\n                            track.feature._map.fitBounds( track.feature.getBounds() );\n                        }\n                    }\n                    var error_messages = {\n                        CORRUPT: 'File \"{name}\" is corrupt',\n                        UNSUPPORTED: 'File \"{name}\" has unsupported format or is badly corrupt',\n                        NETWORK: 'Could not download file from url \"{name}\"',\n                        INVALID_URL: '\"{name}\"  is not of supported URL type',\n                    };\n                    var message;\n                    if (geodata.error) {\n                        message = error_messages[geodata.error] || geodata.error;\n                        if (data_empty) {\n                            message += ', no data could be loaded';\n                        } else {\n                            message += ', loaded data can be invalid or incomplete';\n                        }\n                    }\n                    if (message) {\n                        message = L.Util.template(message, {name: geodata.name});\n                        messages.push(message);\n                    }\n                }.bind(this)\n            );\n            if (messages.length) {\n                notify(messages.join('\\n'));\n            }\n            return hasData;\n        },\n\n        onTrackColorChanged: function(track) {\n            var color = this.colors[track.color()];\n            this.getTrackPolylines(track).forEach(\n                function(polyline) {\n                    polyline.setStyle({color: color});\n                }\n            );\n            var markers = this.getTrackPoints(track);\n            markers.forEach(this.setMarkerIcon.bind(this));\n            this._markerLayer.updateMarkers(markers);\n        },\n\n        onTrackVisibilityChanged: function(track) {\n            if (track.visible()) {\n                this.map.addLayer(track.feature);\n                this._markerLayer.addMarkers(track.markers);\n            } else {\n                if (this.trackAddingPoint() === track) {\n                    this.stopPlacingPoint();\n                }\n                this.map.removeLayer(track.feature);\n                this._markerLayer.removeMarkers(track.markers);\n            }\n            this.updateTrackHighlight();\n        },\n\n        onTrackSegmentNodesChanged: function(track, segment) {\n            if (segment.getFixedLatLngs().length > 0) {\n                this.trackAddingSegment(null);\n            }\n            this.recalculateTrackLength(track);\n        },\n\n        recalculateTrackLength: function(track) {\n            const lines = this.getTrackPolylines(track);\n            let length = 0;\n            for (let line of lines) {\n                length += line.getLength();\n            }\n            track.length(length);\n        },\n\n        formatLength: function(x) {\n            var digits = 0;\n            if (x < 10000) {\n                digits = 2;\n            } else if (x < 100000) {\n                digits = 1;\n            }\n            return (x / 1000).toFixed(digits) + ' km';\n        },\n\n        setTrackMeasureTicksVisibility: function(track) {\n            var visible = track.measureTicksShown(),\n                lines = this.getTrackPolylines(track);\n            lines.forEach((line) => line.setMeasureTicksVisible(visible));\n        },\n\n        switchMeasureTicksVisibility: function(track) {\n            track.measureTicksShown(!(track.measureTicksShown()));\n        },\n\n        onColorSelectorClicked: function(track, e) {\n            track._contextmenu.show(e);\n        },\n\n        setViewToTrack: function(track) {\n            this.setViewToBounds(this.getTrackBounds(track));\n        },\n\n        setViewToAllTracks: function(immediate) {\n            const bounds = L.latLngBounds([]);\n            for (let track of this.tracks()) {\n                bounds.extend(this.getTrackBounds(track));\n            }\n            this.setViewToBounds(bounds, immediate);\n        },\n\n        setViewToBounds: function(bounds, immediate) {\n            if (bounds && bounds.isValid()) {\n                bounds = wrapLatLngBoundsToTarget(bounds, this.map.getCenter());\n                if (L.Browser.mobile || immediate) {\n                    this.map.fitBounds(bounds, {maxZoom: 16});\n                } else {\n                    this.map.flyToBounds(bounds, {maxZoom: 16});\n                }\n            }\n        },\n\n        getTrackBounds: function(track) {\n            const lines = this.getTrackPolylines(track);\n            const points = this.getTrackPoints(track);\n            const bounds = L.latLngBounds([]);\n            if (lines.length || points.length) {\n                lines.forEach((l) => {\n                        if (l.getLatLngs().length > 1) {\n                            bounds.extend(wrapLatLngBoundsToTarget(l.getBounds(), bounds));\n                        }\n                    }\n                );\n                points.forEach((p) => {\n                        bounds.extend(wrapLatLngToTarget(p.latlng, bounds));\n                    }\n                );\n            }\n            return bounds;\n        },\n\n        attachColorSelector: function(track) {\n            var items = this.colors.map(function(color, index) {\n                    return {\n                        text: '<div style=\"display: inline-block; vertical-align: middle; width: 50px; height: 0; ' +\n                            'border-top: 4px solid ' + color + '\"></div>',\n                        callback: track.color.bind(null, index)\n                    };\n                }\n            );\n            track._contextmenu = new Contextmenu(items);\n        },\n\n        attachActionsMenu: function(track) {\n            var items = [\n                function() {\n                    return {text: `${track.name()}`, header: true};\n                },\n                '-',\n                {text: 'Переименовать', callback: this.renameTrack.bind(this, track)},\n                {text: 'Дублировать', callback: this.duplicateTrack.bind(this, track)},\n                {text: 'Реверсировать', callback: this.reverseTrack.bind(this, track)},\n                {text: 'Показать профиль высоты', callback: this.showElevationProfileForTrack.bind(this, track)},\n                '-',\n                {text: 'Удалить', callback: this.removeTrack.bind(this, track)},\n                '-',\n                {text: 'Скачать GPX', callback: this.saveTrackAsFile.bind(this, track, geoExporters.saveGpx, '.gpx')},\n                {text: 'Скачать KML', callback: this.saveTrackAsFile.bind(this, track, geoExporters.saveKml, '.kml')},\n                {text: 'Копировать ссылку на трэк', callback: this.copyTrackLinkToClipboard.bind(this, track)},\n                {text: 'Дополнительно', separator: true},\n                {\n                    text: 'Скачать GPX с добавлением высоты',\n                    callback: this.saveTrackAsFile.bind(this, track, geoExporters.saveGpxWithElevations, '.gpx', true),\n                },\n            ];\n            track._actionsMenu = new Contextmenu(items);\n        },\n\n        onButtonAddSegmentClicked: function(track) {\n            if (!track.visible()) {\n                return;\n            }\n            if (this.trackAddingSegment() === track) {\n                this.trackAddingSegment(null);\n                this.stopEditLine();\n            } else {\n                this.addSegmentAndEdit(track);\n            }\n        },\n\n        duplicateTrack: function(track) {\n            const segments = this.getTrackPolylines(track).map((line) =>\n                line.getLatLngs().map((latlng) => [latlng.lat, latlng.lng])\n            );\n            const points = this.getTrackPoints(track)\n                .map((point) => ({lat: point.latlng.lat, lng: point.latlng.lng, name: point.label}));\n            this.addTrack({name: track.name(), tracks: segments, points});\n        },\n\n        reverseTrackSegment: function(trackSegment) {\n            trackSegment.stopDrawingLine();\n            var latlngs = trackSegment.getLatLngs();\n            latlngs = latlngs.map(function(ll) {\n                    return [ll.lat, ll.lng];\n                }\n            );\n            latlngs.reverse();\n            var isEdited = (this._editedLine === trackSegment);\n            this.deleteTrackSegment(trackSegment);\n            var newTrackSegment = this.addTrackSegment(trackSegment._parentTrack, latlngs);\n            if (isEdited) {\n                this.startEditTrackSegement(newTrackSegment);\n            }\n        },\n\n        reverseTrack: function(track) {\n            var that = this;\n            this.getTrackPolylines(track).forEach(function(trackSegment) {\n                    that.reverseTrackSegment(trackSegment);\n                }\n            );\n        },\n\n        copyTracksLinkToClipboard: function(tracks, mouseEvent) {\n            if (!tracks.length) {\n                notify('No tracks to copy');\n                return;\n            }\n            let serialized = tracks.map((track) => this.trackToString(track)).join('/');\n            const hashDigest = md5(serialized, null, true);\n            const key = btoa(hashDigest).replace(/\\//ug, '_').replace(/\\+/ug, '-').replace(/=/ug, '');\n            const url = window.location + '&nktl=' + key;\n            copyToClipboard(url, mouseEvent);\n            fetch(`${config.tracksStorageServer}/${key}`, {\n                method: 'PUT',\n                data: serialized,\n                withCredentials: false\n            }).then(\n                null, (e) => {\n                    let message = e.message || e;\n                    if (e.xhr.status === 413) {\n                        message = 'track is too big';\n                    }\n                    logging.captureMessage('Failed to save track to server',\n                        {status: e.xhr.status, response: e.xhr.responseText});\n                    notify('Error making link: ' + message);\n                }\n            );\n        },\n\n        copyTrackLinkToClipboard: function(track, mouseEvent) {\n            this.copyTracksLinkToClipboard([track], mouseEvent);\n        },\n\n        saveTrackAsFile: async function(track, exporter, extension, addElevations = false) {\n            var lines = this.getTrackPolylines(track)\n                .map(function(line) {\n                        return line.getFixedLatLngs();\n                    }\n                );\n            lines = splitLinesAt180Meridian(lines);\n            var points = this.getTrackPoints(track);\n            let name = track.name();\n            // Browser (Chrome) removes leading dots.\n            name = name.replace(/^\\./u, '_');\n            for (let extensions of [this.options.splitExtensionsFirstStage, this.options.splitExtensions]) {\n                let i = name.lastIndexOf('.');\n                if (i > -1 && extensions.includes(name.slice(i + 1).toLowerCase())) {\n                    name = name.slice(0, i);\n                }\n            }\n            if (lines.length === 0 && points.length === 0) {\n                notify('Трэк пустой. Скачивание невозможно.');\n                return;\n            }\n\n            if (addElevations) {\n                const request = [\n                    ...points.map((p) => p.latlng),\n                    ...lines.reduce((acc, cur) => {\n                        acc.push(...cur);\n                        return acc;\n                    }, [])\n                ];\n                let elevations;\n                try {\n                    elevations = await new ElevationProvider().get(request);\n                } catch (e) {\n                    logging.captureException(e, 'error getting elevation for gpx');\n                    notify(`Failed to get elevation data: ${e.message}`);\n                }\n                let n = 0;\n                for (let p of points) {\n                    // we make copy of latlng as we are changing it\n                    p.latlng = L.latLng(p.latlng.lat, p.latlng.lng, elevations[n]);\n                    n += 1;\n                }\n                for (let line of lines) {\n                    for (let p of line) {\n                        // we do not need to create new LatLng since splitLinesAt180Meridian() have already done it\n                        p.alt = elevations[n];\n                        n += 1;\n                    }\n                }\n            }\n\n            var fileText = exporter(lines, name, points);\n            var filename = name + extension;\n            saveAs(blobFromString(fileText), filename, true);\n        },\n\n        renameTrack: function(track) {\n            var newName = query('Enter new name', track.name());\n            if (newName && newName.length) {\n                track.name(newName);\n            }\n        },\n\n        showTrackMenu: function(track, e) {\n            track._actionsMenu.show(e);\n        },\n\n        showMenu: function(e) {\n            this.menu.show(e);\n        },\n\n        stopEditLine: function() {\n            if (this._editedLine) {\n                this._editedLine.stopEdit();\n            }\n        },\n\n        onTrackSegmentClick: function(e) {\n            if (this.isPlacingPoint) {\n                return;\n            }\n            const trackSegment = e.target;\n            if (this._lineJoinActive) {\n                L.DomEvent.stopPropagation(e);\n                this.joinTrackSegments(trackSegment, isPointCloserToStart(e.target.getLatLngs(), e.latlng));\n            } else {\n                this.startEditTrackSegement(trackSegment);\n                L.DomEvent.stopPropagation(e);\n            }\n        },\n\n        startEditTrackSegement: function(polyline) {\n            if (this._editedLine && this._editedLine !== polyline) {\n                this.stopEditLine();\n            }\n            polyline.startEdit();\n            this._editedLine = polyline;\n            polyline.once('editend', this.onLineEditEnd, this);\n            polyline.fire('startedit');\n        },\n\n        onButtonAddPointClicked: function(track) {\n            if (!track.visible()) {\n                return;\n            }\n            if (this.trackAddingPoint() === track) {\n                this.stopPlacingPoint();\n            } else {\n                this.beginPointCreate(track);\n            }\n        },\n\n        _beginPointEdit: function() {\n            this.stopPlacingPoint();\n            this.stopEditLine();\n            L.DomUtil.addClass(this._map._container, 'leaflet-point-placing');\n            this.isPlacingPoint = true;\n            L.DomEvent.on(document, 'keydown', this.stopPlacingPointOnEscPressed, this);\n            this._map.fire('startedit');\n        },\n\n        beginPointMove: function(marker) {\n            this._beginPointEdit();\n            this._movingMarker = marker;\n            this.map.on('click', this.movePoint, this);\n        },\n\n        beginPointCreate: function(track) {\n            this._beginPointEdit();\n            this.map.on('click', this.createNewPoint, this);\n            this.trackAddingPoint(track);\n        },\n\n        movePoint: function(e) {\n            const marker = this._movingMarker;\n            const newLatLng = e.latlng.wrap();\n            this._markerLayer.setMarkerPosition(marker, newLatLng);\n            this.stopPlacingPoint();\n        },\n\n        getNewPointName: function(track) {\n            let maxNumber = 0;\n            for (let marker of track.markers) {\n                const label = marker.label;\n                if (label.match(/^\\d{3}([^\\d.]|$)/u)) {\n                    maxNumber = parseInt(label, 10);\n                }\n            }\n            return maxNumber === 999 ? '' : String(maxNumber + 1).padStart(3, '0');\n        },\n\n        createNewPoint: function(e) {\n            if (!this.isPlacingPoint) {\n                return;\n            }\n            const parentTrack = this.trackAddingPoint();\n            const name = e.suggested && this._map.suggestedPoint?.title || this.getNewPointName(parentTrack);\n            const newLatLng = e.latlng.wrap();\n            const marker = this.addPoint(parentTrack, {name: name, lat: newLatLng.lat, lng: newLatLng.lng});\n            this._markerLayer.addMarker(marker);\n            // we need to show prompt after marker is dispalyed;\n            // grid layer is updated in setTimout(..., 0)after adding marker\n            // it is better to do it on 'load' event but when it is fired marker is not yet displayed\n            setTimeout(() => {\n                this.renamePoint(marker);\n                this.beginPointCreate(parentTrack);\n            }, 10);\n        },\n\n        stopPlacingPointOnEscPressed: function(e) {\n            if (e.keyCode === 27) {\n                this.stopPlacingPoint();\n            }\n        },\n\n        stopPlacingPoint: function() {\n            this.isPlacingPoint = false;\n            this.trackAddingPoint(null);\n            L.DomUtil.removeClass(this._map._container, 'leaflet-point-placing');\n            L.DomEvent.off(document, 'keydown', this.stopPlacingPointOnEscPressed, this);\n            this.map.off('click', this.createNewPoint, this);\n            this.map.off('click', this.movePoint, this);\n        },\n\n        joinTrackSegments: function(newSegment, joinToStart) {\n            this.hideLineCursor();\n            var originalSegment = this._editedLine;\n            var latlngs = originalSegment.getLatLngs(),\n                latngs2 = newSegment.getLatLngs();\n            if (joinToStart === this._lineJoinFromStart) {\n                latngs2.reverse();\n            }\n            if (this._lineJoinFromStart) {\n                latlngs.unshift(...latngs2);\n            } else {\n                latlngs.push(...latngs2);\n            }\n            latlngs = latlngs.map(function(ll) {\n                    return [ll.lat, ll.lng];\n                }\n            );\n            this.deleteTrackSegment(originalSegment);\n            if (originalSegment._parentTrack === newSegment._parentTrack) {\n                this.deleteTrackSegment(newSegment);\n            }\n            this.addTrackSegment(originalSegment._parentTrack, latlngs);\n        },\n\n        onLineEditEnd: function(e) {\n            const polyline = e.target;\n            const track = polyline._parentTrack;\n            if (polyline.getLatLngs().length < 2) {\n                this.deleteTrackSegment(polyline);\n            }\n            if (this._editedLine === polyline) {\n                this._editedLine = null;\n            }\n            if (!this.getTrackPolylines(track).length && !this.getTrackPoints(track).length && e.userCancelled) {\n                this.removeTrack(track);\n            }\n        },\n\n        addTrackSegment: function(track, sourcePoints) {\n            var polyline = new TrackSegment(sourcePoints || [], {\n                    color: this.colors[track.color()],\n                    print: true\n                }\n            );\n            polyline._parentTrack = track;\n            polyline.setMeasureTicksVisible(track.measureTicksShown());\n            polyline.on('click', this.onTrackSegmentClick, this);\n            polyline.on('nodeschanged', this.onTrackSegmentNodesChanged.bind(this, track, polyline));\n            polyline.on('noderightclick', this.onNodeRightClickShowMenu, this);\n            polyline.on('segmentrightclick', this.onSegmentRightClickShowMenu, this);\n            polyline.on('mouseover', () => this.onTrackMouseEnter(track));\n            polyline.on('mouseout', () => this.onTrackMouseLeave(track));\n            polyline.on('editstart', () => this.onTrackEditStart(track));\n            polyline.on('editend', () => this.onTrackEditEnd(track));\n            polyline.on('drawend', this.onTrackSegmentDrawEnd, this);\n\n            // polyline.on('editingstart', polyline.setMeasureTicksVisible.bind(polyline, false));\n            // polyline.on('editingend', this.setTrackMeasureTicksVisibility.bind(this, track));\n            track.feature.addLayer(polyline);\n            this.recalculateTrackLength(track);\n            return polyline;\n        },\n\n        onNodeRightClickShowMenu: function(e) {\n            var items = [];\n            if (e.nodeIndex > 0 && e.nodeIndex < e.line.getLatLngs().length - 1) {\n                items.push({\n                        text: 'Разрезать',\n                        callback: this.splitTrackSegment.bind(this, e.line, e.nodeIndex, null)\n                    }\n                );\n            }\n            if (e.nodeIndex === 0 || e.nodeIndex === e.line.getLatLngs().length - 1) {\n                items.push({text: 'Соединить', callback: this.startLineJoinSelection.bind(this, e)});\n            }\n            items.push({text: 'Реверсировать', callback: this.reverseTrackSegment.bind(this, e.line)});\n            items.push({text: 'Укоротить', callback: this.startShortCutSelection.bind(this, e, true)});\n            items.push({text: 'Удалить сегмент', callback: this.deleteTrackSegment.bind(this, e.line)});\n            items.push({text: 'Новый трэк из сегмента', callback: this.newTrackFromSegment.bind(this, e.line)});\n            items.push('-');\n            items.push({\n                    text: 'Профиль высоты сегмента',\n                    callback: this.showElevationProfileForSegment.bind(this, e.line)\n                }\n            );\n\n            var menu = new Contextmenu(items);\n            menu.show(e.mouseEvent);\n        },\n\n        onSegmentRightClickShowMenu: function(e) {\n            var menu = new Contextmenu([\n                    {\n                        text: 'Разрезать',\n                        callback: this.splitTrackSegment.bind(this, e.line, e.nodeIndex, e.mouseEvent.latlng)\n                    },\n                    {text: 'Реверсировать', callback: this.reverseTrackSegment.bind(this, e.line)},\n                    {text: 'Укоротить', callback: this.startShortCutSelection.bind(this, e, false)},\n                    {text: 'Удалить сегмент', callback: this.deleteTrackSegment.bind(this, e.line)},\n                    {text: 'Новый трэк из сегмента', callback: this.newTrackFromSegment.bind(this, e.line)},\n                    '-',\n                    {\n                        text: 'Профиль высоты сегмента',\n                        callback: this.showElevationProfileForSegment.bind(this, e.line)\n                    }\n                ]\n            );\n            menu.show(e.mouseEvent);\n        },\n\n        showLineCursor: function(start, mousepos) {\n            this.hideLineCursor();\n            this._editedLine.stopDrawingLine();\n            this._lineCursor = L.polyline([start.clone(), mousepos], {\n                ...this.options.lineCursorStyle,\n                ...this.options.lineCursorInvalidStyle,\n            }).addTo(this._map);\n            this.map.on('mousemove', this.onMouseMoveOnMapForLineCursor, this);\n            this.map.on('click', this.hideLineCursor, this);\n            L.DomEvent.on(document, 'keyup', this.onKeyUpForLineCursor, this);\n            L.DomUtil.addClass(this.map.getContainer(), 'tracklist-line-cursor-shown');\n            this._editedLine.preventStopEdit = true;\n        },\n\n        hideLineCursor: function() {\n            if (this._lineCursor) {\n                this.map.off('mousemove', this.onMouseMoveOnMapForLineCursor, this);\n                this.map.off('click', this.hideLineCursor, this);\n                L.DomUtil.removeClass(this.map.getContainer(), 'tracklist-line-cursor-shown');\n                L.DomEvent.off(document, 'keyup', this.onKeyUpForLineCursor, this);\n                this.map.removeLayer(this._lineCursor);\n                this._lineCursor = null;\n                this._map.fire('linecursorhide');\n                this._editedLine.preventStopEdit = false;\n            }\n        },\n\n        onMouseMoveOnMapForLineCursor: function(e) {\n            this.updateLineCursor(e.latlng, false);\n        },\n\n        updateLineCursor: function(latlng, isValid) {\n            if (!this._lineCursor) {\n                return;\n            }\n            this._lineCursor.getLatLngs().splice(1, 1, latlng);\n            this._lineCursor.redraw();\n            this._lineCursor.setStyle(\n                isValid ? this.options.lineCursorValidStyle : this.options.lineCursorInvalidStyle\n            );\n        },\n\n        onKeyUpForLineCursor: function(e) {\n            if (e.target.tagName.toLowerCase() === 'input') {\n                return;\n            }\n            switch (e.keyCode) {\n                case 27:\n                case 13:\n                    this.hideLineCursor();\n                    L.DomEvent.stop(e);\n                    break;\n                default:\n            }\n        },\n\n        startLineJoinSelection: function(e) {\n            this._lineJoinFromStart = (e.nodeIndex === 0);\n            const cursorStart = this._editedLine.getLatLngs()[e.nodeIndex];\n            this.showLineCursor(cursorStart, e.mouseEvent.latlng);\n            this._map.on('linecursorhide', this.onLineCursorHideForJoin, this);\n            for (let track of this.tracks()) {\n                track.feature.on('mousemove', this.onMouseMoveOnLineForJoin, this);\n            }\n            this._lineJoinActive = true;\n            this._editedLine.disableEditOnLeftClick(true);\n        },\n\n        onMouseMoveOnLineForJoin: function(e) {\n            const latlngs = e.layer.getLatLngs();\n            const lineJoinToStart = isPointCloserToStart(latlngs, e.latlng);\n            const cursorEnd = lineJoinToStart ? latlngs[0] : latlngs[latlngs.length - 1];\n            L.DomEvent.stopPropagation(e);\n            this.updateLineCursor(cursorEnd, true);\n        },\n\n        onLineCursorHideForJoin: function() {\n            for (let track of this.tracks()) {\n                track.feature.off('mousemove', this.onMouseMoveOnLineForJoin, this);\n            }\n            this._map.off('linecursorhide', this.onLineCursorHideForJoin, this);\n            this._editedLine.disableEditOnLeftClick(false);\n            this._lineJoinActive = false;\n        },\n\n        startShortCutSelection: function(e, startFromNode) {\n            const line = this._editedLine;\n            this._shortCut = {startNodeIndex: e.nodeIndex, startFromNode};\n            let cursorStart;\n            if (startFromNode) {\n                cursorStart = line.getLatLngs()[e.nodeIndex];\n            } else {\n                cursorStart = closestPointToLineSegment(line.getLatLngs(), e.nodeIndex, e.mouseEvent.latlng);\n                this._shortCut.startLatLng = cursorStart;\n            }\n            this.showLineCursor(cursorStart, e.mouseEvent.latlng);\n            line.nodeMarkers.on('mousemove', this.onMouseMoveOnNodeMarkerForShortCut, this);\n            line.segmentOverlays.on('mousemove', this.onMouseMoveOnLineSegmentForShortCut, this);\n            this.map.on('mousemove', this.onMouseMoveOnMapForShortCut, this);\n            line.nodeMarkers.on('click', this.onClickNodeMarkerForShortCut, this);\n            line.segmentOverlays.on('click', this.onClickLineSegmentForShortCut, this);\n            this._map.on('linecursorhide', this.onLineCursorHideForShortCut, this);\n            line.disableEditOnLeftClick(true);\n        },\n\n        onMouseMoveOnLineSegmentForShortCut: function(e) {\n            this.updateShortCutSelection(e, false);\n        },\n\n        onMouseMoveOnNodeMarkerForShortCut: function(e) {\n            this.updateShortCutSelection(e, true);\n        },\n\n        onMouseMoveOnMapForShortCut: function() {\n            this._editedLine.highlighNodesForDeletion();\n        },\n\n        updateShortCutSelection: function(e, endAtNode) {\n            L.DomEvent.stopPropagation(e);\n            const line = this._editedLine;\n            const {firstNodeToDelete, lastNodeToDelete, rangeValid} = this.getShortCutNodes(e, endAtNode);\n            this.updateLineCursor(e.latlng, rangeValid);\n            if (rangeValid) {\n                line.highlighNodesForDeletion(firstNodeToDelete, lastNodeToDelete);\n            } else {\n                line.highlighNodesForDeletion();\n            }\n        },\n\n        onLineCursorHideForShortCut: function() {\n            const line = this._editedLine;\n            line.highlighNodesForDeletion();\n            line.nodeMarkers.off('mousemove', this.onMouseMoveOnNodeMarkerForShortCut, this);\n            line.segmentOverlays.off('mousemove', this.onMouseMoveOnLineSegmentForShortCut, this);\n            this.map.off('mousemove', this.onMouseMoveOnMapForShortCut, this);\n            line.nodeMarkers.off('click', this.onClickNodeMarkerForShortCut, this);\n            line.segmentOverlays.off('click', this.onClickLineSegmentForShortCut, this);\n            this._map.off('linecursorhide', this.onLineCursorHideForShortCut, this);\n            line.disableEditOnLeftClick(false);\n            this._shortCut = null;\n        },\n\n        onClickLineSegmentForShortCut: function(e) {\n            this.shortCutSegment(e, false);\n        },\n\n        onClickNodeMarkerForShortCut: function(e) {\n            this.shortCutSegment(e, true);\n        },\n\n        getShortCutNodes: function(e, endAtNode) {\n            const line = this._editedLine;\n            let startFromNode = this._shortCut.startFromNode;\n            let startNodeIndex = this._shortCut.startNodeIndex;\n            let endNodeIndex = line[endAtNode ? 'getMarkerIndex' : 'getSegmentOverlayIndex'](e.layer);\n            const newNodes = [];\n            if (!startFromNode) {\n                newNodes.push(this._shortCut.startLatLng);\n            }\n            if (!endAtNode) {\n                newNodes.push(closestPointToLineSegment(line.getLatLngs(), endNodeIndex, e.latlng));\n            }\n            let firstNodeToDelete, lastNodeToDelete;\n            if (endNodeIndex > startNodeIndex) {\n                firstNodeToDelete = startNodeIndex + 1;\n                lastNodeToDelete = endNodeIndex - 1;\n                if (!endAtNode) {\n                    lastNodeToDelete += 1;\n                }\n            } else {\n                newNodes.reverse();\n                firstNodeToDelete = endNodeIndex + 1;\n                lastNodeToDelete = startNodeIndex - 1;\n                if (!startFromNode) {\n                    lastNodeToDelete += 1;\n                }\n            }\n            return {firstNodeToDelete, lastNodeToDelete, newNodes, rangeValid: lastNodeToDelete >= firstNodeToDelete};\n        },\n\n        shortCutSegment: function(e, endAtNode) {\n            L.DomEvent.stopPropagation(e);\n            const line = this._editedLine;\n            const {firstNodeToDelete, lastNodeToDelete, newNodes, rangeValid} = this.getShortCutNodes(e, endAtNode);\n            if (!rangeValid) {\n                return;\n            }\n            this.stopEditLine();\n            line.spliceLatLngs(firstNodeToDelete, lastNodeToDelete - firstNodeToDelete + 1, ...newNodes);\n            this.startEditTrackSegement(line);\n        },\n\n        onTrackMouseEnter: function(track) {\n            track.hover(true);\n        },\n\n        onTrackMouseLeave: function(track) {\n            track.hover(false);\n        },\n\n        onTrackEditStart: function(track) {\n            track.isEdited(true);\n        },\n\n        onTrackEditEnd: function(track) {\n            track.isEdited(false);\n            this.hideLineCursor();\n            this._editedLine = null;\n        },\n\n        onTrackRowMouseEnter: function(track) {\n            this._highlightedTrack = track;\n            this.updateTrackHighlight();\n        },\n\n        onTrackRowMouseLeave: function(track) {\n            if (this._highlightedTrack === track) {\n                this._highlightedTrack = null;\n                this.updateTrackHighlight();\n            }\n        },\n\n        onTrackSegmentDrawEnd: function() {\n            this.trackAddingSegment(null);\n        },\n\n        splitTrackSegment: function(trackSegment, nodeIndex, latlng) {\n            var latlngs = trackSegment.getLatLngs();\n            latlngs = latlngs.map((latlng) => latlng.clone());\n            var latlngs1 = latlngs.slice(0, nodeIndex + 1),\n                latlngs2 = latlngs.slice(nodeIndex + 1);\n            if (latlng) {\n                latlng = closestPointToLineSegment(latlngs, nodeIndex, latlng);\n                latlngs1.push(latlng.clone());\n            } else {\n                latlng = latlngs[nodeIndex];\n            }\n            latlngs2.unshift(latlng.clone());\n            this.deleteTrackSegment(trackSegment);\n            var segment1 = this.addTrackSegment(trackSegment._parentTrack, latlngs1);\n            this.addTrackSegment(trackSegment._parentTrack, latlngs2);\n            this.startEditTrackSegement(segment1);\n        },\n\n        deleteTrackSegment: function(trackSegment) {\n            const track = trackSegment._parentTrack;\n            track.feature.removeLayer(trackSegment);\n            this.recalculateTrackLength(track);\n        },\n\n        newTrackFromSegment: function(trackSegment) {\n            var srcNodes = trackSegment.getLatLngs(),\n                newNodes = [],\n                i;\n            for (i = 0; i < srcNodes.length; i++) {\n                newNodes.push([srcNodes[i].lat, srcNodes[i].lng]);\n            }\n            this.addTrack({name: \"Новый трэк\", tracks: [newNodes]});\n        },\n\n        addTrack: function(geodata) {\n            var color;\n            color = geodata.color;\n            if (!(color >= 0 && color < this.colors.length)) {\n                color = this._lastTrackColor;\n                this._lastTrackColor = (this._lastTrackColor + 1) % this.colors.length;\n            }\n            var track = {\n                name: ko.observable(geodata.name),\n                color: ko.observable(color),\n                visible: ko.observable(!geodata.trackHidden),\n                length: ko.observable(0),\n                measureTicksShown: ko.observable(geodata.measureTicksShown || false),\n                feature: L.featureGroup([]),\n                markers: [],\n                group: ko.observable( geodata.group || 'default' ),\n                hover: ko.observable(false),\n                isEdited: ko.observable(false)\n            };\n            (geodata.tracks || []).forEach(this.addTrackSegment.bind(this, track));\n            (geodata.points || []).forEach(this.addPoint.bind(this, track));\n\n            this.tracks.push(track);\n\n            track.visible.subscribe(this.onTrackVisibilityChanged.bind(this, track));\n            track.measureTicksShown.subscribe(this.setTrackMeasureTicksVisibility.bind(this, track));\n            track.color.subscribe(this.onTrackColorChanged.bind(this, track));\n            if (!L.Browser.touch) {\n                track.feature.bindTooltip(() => track.name(), {sticky: true, delay: 500});\n            }\n\n            // this.onTrackColorChanged(track);\n            this.onTrackVisibilityChanged(track);\n            this.attachColorSelector(track);\n            this.attachActionsMenu(track);\n            return track;\n        },\n\n        updateTrackHighlight: function() {\n            if (L.Browser.touch) {\n                return;\n            }\n            if (this._trackHighlight) {\n                this._trackHighlight.removeFrom(this._map);\n                this._trackHighlight = null;\n            }\n            if (this._highlightedTrack && this._highlightedTrack.visible()) {\n                const trackHighlight = L.featureGroup([]);\n\n                this._highlightedTrack.feature.eachLayer((line) => {\n                    let latlngs = line.getFixedLatLngs();\n                    L.polyline(latlngs).addTo(trackHighlight);\n                });\n\n                trackHighlight.setStyle({\n                    color: 'yellow',\n                    weight: '15',\n                    opacity: 0.5\n                });\n                trackHighlight.addTo(this._map).bringToBack();\n                this._trackHighlight = trackHighlight;\n            }\n        },\n\n        setMarkerIcon: function(marker) {\n            var symbol = 'marker',\n                colorInd = marker._parentTrack.color() + 1,\n                className = 'symbol-' + symbol + '-' + colorInd;\n            marker.icon = iconFromBackgroundImage('track-waypoint ' + className);\n        },\n\n        setMarkerLabel: function(marker, label) {\n            marker.label = label;\n        },\n\n        addPoint: function(track, srcPoint) {\n            var marker = {\n                latlng: L.latLng([srcPoint.lat, srcPoint.lng]),\n                _parentTrack: track,\n            };\n            this.setMarkerIcon(marker);\n            this.setMarkerLabel(marker, srcPoint.name);\n            track.markers.push(marker);\n            marker._parentTrack = track;\n            return marker;\n        },\n\n        onMarkerClick: function(e) {\n            new Contextmenu([\n                    {text: e.marker.label, header: true},\n                    '-',\n                    {text: 'Переименовать', callback: this.renamePoint.bind(this, e.marker)},\n                    {text: 'Переместить', callback: this.beginPointMove.bind(this, e.marker)},\n                    {text: 'Удалить', callback: this.removePoint.bind(this, e.marker)},\n                ]\n            ).show(e);\n        },\n\n        onMarkerEnter: function(e) {\n            e.marker._parentTrack.hover(true);\n        },\n\n        onMarkerLeave: function(e) {\n            e.marker._parentTrack.hover(false);\n        },\n\n        removePoint: function(marker) {\n            this.stopPlacingPoint();\n            this._markerLayer.removeMarker(marker);\n            const markers = marker._parentTrack.markers;\n            const i = markers.indexOf(marker);\n            markers.splice(i, 1);\n        },\n\n        renamePoint: function(marker) {\n            this.stopPlacingPoint();\n            var newLabel = query('Название новой точки', marker.label);\n            if (newLabel !== null) {\n                this.setMarkerLabel(marker, newLabel);\n                this._markerLayer.updateMarker(marker);\n            }\n        },\n\n        removeTrack: function(track) {\n            track.visible(false);\n            this.tracks.remove(track);\n        },\n\n        deleteAllTracks: function() {\n            var tracks = this.tracks().slice(0),\n                i;\n            for (i = 0; i < tracks.length; i++) {\n                this.removeTrack(tracks[i]);\n            }\n        },\n\n        deleteHiddenTracks: function() {\n            var tracks = this.tracks().slice(0),\n                i, track;\n            for (i = 0; i < tracks.length; i++) {\n                track = tracks[i];\n                if (!track.visible()) {\n                    this.removeTrack(tracks[i]);\n                }\n            }\n        },\n\n        trackToString: function(track, forceVisible) {\n            var lines = this.getTrackPolylines(track).map(function(line) {\n                    var points = line.getFixedLatLngs();\n                    points = L.LineUtil.simplifyLatlngs(points, 360 / (1 << 24));\n                    return points;\n                }\n            );\n            return geoExporters.saveToString(lines, track.name(), track.color(), track.measureTicksShown(),\n                this.getTrackPoints(track), forceVisible ? false : !track.visible()\n            );\n        },\n\n        copyAllTracksToClipboard: function(mouseEvent) {\n            this.copyTracksLinkToClipboard(this.tracks(), mouseEvent);\n        },\n\n        copyVisibleTracks: function(mouseEvent) {\n            const tracks = this.tracks().filter((track) => track.visible());\n            this.copyTracksLinkToClipboard(tracks, mouseEvent);\n        },\n\n        exportTracks: function(minTicksIntervalMeters) {\n            var that = this;\n            /* eslint-disable max-nested-callbacks */\n            return this.tracks()\n                .filter(function(track) {\n                        return that.getTrackPolylines(track).length;\n                    }\n                )\n                .map(function(track) {\n                        var capturedTrack = track.feature.getLayers().map(function(pl) {\n                                return pl.getLatLngs().map(function(ll) {\n                                        return [ll.lat, ll.lng];\n                                    }\n                                );\n                            }\n                        );\n                        var bounds = track.feature.getBounds();\n                        var capturedBounds = [\n                            [bounds.getSouth(), bounds.getWest()],\n                            [bounds.getNorth(), bounds.getEast()]\n                        ];\n                        return {\n                            color: track.color(),\n                            visible: track.visible(),\n                            segments: capturedTrack,\n                            bounds: capturedBounds,\n                            measureTicksShown: track.measureTicksShown(),\n                            measureTicks: [].concat(...track.feature.getLayers().map(function(pl) {\n                                    return pl.getTicksPositions(minTicksIntervalMeters);\n                                }\n                                )\n                            )\n                        };\n                    }\n                );\n            /* eslint-enable max-nested-callbacks */\n        },\n\n        showElevationProfileForSegment: function(line) {\n            this.hideElevationProfile();\n            this.stopEditLine();\n            this._elevationControl = new ElevationProfile(this._map, line.getLatLngs(), {\n                    samplingInterval: calcSamplingInterval(line.getLength())\n                }\n            );\n            this._map.fire('elevation-shown');\n        },\n\n        showElevationProfileForTrack: function(track) {\n            var lines = this.getTrackPolylines(track),\n                path = [],\n                i;\n            for (i = 0; i < lines.length; i++) {\n                if (lines[i] === this._editedLine) {\n                    this.stopEditLine();\n                }\n                path = path.concat(lines[i].getLatLngs());\n            }\n            this.hideElevationProfile();\n            this._elevationControl = new ElevationProfile(this._map, path, {\n                    samplingInterval: calcSamplingInterval(new L.MeasuredLine(path).getLength())\n                }\n            );\n            this._map.fire('elevation-shown');\n        },\n\n        hideElevationProfile: function() {\n            if (this._elevationControl) {\n                this._elevationControl.removeFrom(this._map);\n            }\n            this._elevationControl = null;\n        },\n\n        hasTracks: function() {\n            return this.tracks().length > 0;\n        }\n    }\n);\n\nexport {TRACKLIST_TRACK_COLORS};\n","function arrayItemsEqual(l1, l2) {\n    if (l1.length !== l2.length) {\n        return false;\n    }\n    for (var i = 0; i < l1.length; i++) {\n        if (l1[i] !== l2[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n\nfunction parseHashParams(s) {\n    const args = {},\n        i = s.indexOf('#');\n    if (i >= 0) {\n        s = s.substr(i + 1).trim();\n        let m, key, value;\n        for (let pair of s.split('&')) {\n            m = /^([^=]+?)(?:=(.*))?$/u.exec(pair);\n            if (m) {\n                [, key, value] = m;\n                if (value) {\n                    value = value.split('/');\n                } else {\n                    value = [];\n                }\n                args[key] = value;\n            }\n        }\n    }\n    return args;\n}\n\nconst hashState = {\n    _listeners: [],\n    _state: {},\n\n    addEventListener: function(key, callback) {\n        for (let [k, c] of this._listeners) {\n            if (k === key && c === callback) {\n                return;\n            }\n        }\n        this._listeners.push([key, callback]);\n    },\n\n    updateState: function(key, values) {\n        if (values) {\n            this._state[key] = values;\n        } else {\n            delete this._state[key];\n        }\n        this._saveStateToHash();\n    },\n\n    getState: function(key) {\n        return this._state[key];\n    },\n\n    hasKey: function(key) {\n        return this._state.hasOwnProperty(key);\n    },\n\n    _saveStateToHash: function() {\n        var stateItems = [];\n        for (let key of Object.keys(this._state)) {\n            if (this._state[key]) {\n                if (this._state[key].length) {\n                    var values = this._state[key].join('/');\n                    stateItems.push(key + '=' + values);\n                } else {\n                    stateItems.push(key);\n                }\n            }\n        }\n        const hash = stateItems.join('&');\n        const href = `${location.origin}${location.pathname}${location.search}#${hash}`;\n        this._ignoreChanges = true;\n        location.replace(href);\n        this._ignoreChanges = false;\n    },\n\n    onHashChanged: function() {\n        if (this._ignoreChanges) {\n            return;\n        }\n        const newState = parseHashParams(location.hash);\n        const changedKeys = {};\n        for (let key of Object.keys(newState)) {\n            if (!(key in this._state) || !arrayItemsEqual(newState[key], this._state[key])) {\n                changedKeys[key] = 1;\n            }\n        }\n\n        for (let key of Object.keys(this._state)) {\n            if (!(key in newState)) {\n                changedKeys[key] = 1;\n            }\n        }\n\n        for (let [key, callback] of this._listeners) {\n            if (key in changedKeys) {\n                callback(newState[key]);\n            }\n        }\n        this._state = newState;\n    }\n};\n\nfunction bindHashStateReadOnly(key, target) {\n    function onChange() {\n        target(hashState.getState(key));\n        hashState.updateState(key, null);\n    }\n    hashState.addEventListener(key, onChange);\n    onChange();\n}\n\nwindow.addEventListener('hashchange', hashState.onHashChanged.bind(hashState));\nhashState.onHashChanged();\n\nexport {hashState, bindHashStateReadOnly, parseHashParams};\n\n","class PrintStaticLayer {\n    _layerDummy = true;\n    _printProgressWeight = 0.01;\n\n    cloneForPrint() {\n        return this;\n    }\n\n    // printOptions = {\n    //     xhrOptions,\n    //     pixelBounds,\n    //     latLngBounds,\n    //     destPixelSize,\n    //     resolution,\n    //     scale,\n    //     zoom\n    // }\n    async getTilesInfo(printOptions) {\n        return {\n            iterateTilePromises: (function*() {\n                yield {\n                    tilePromise: Promise.resolve({\n                            draw: (canvas) => this._drawRaster(canvas, printOptions),\n                            isOverlay: true,\n                            overlaySolid: this.overlaySolid\n                        }\n                    ),\n                    abortLoading: () => {\n                        // no actions needed\n                    }\n                };\n            }).bind(this),\n            count: 1\n        };\n    }\n\n    _drawRaster(_unused_canvas, _unused_printOptions) {\n        throw new Error(\"Method not implemented\");\n    }\n}\n\nexport {PrintStaticLayer};\n","import './style.css';\nimport * as logging from '~/lib/logging';\nimport {query} from '~/lib/notifications';\n\nfunction showNotification(message, mouseEvent) {\n    var el = document.createElement('div');\n    el.innerHTML = message;\n    el.className = 'copy-clipboard-notification';\n    document.body.appendChild(el);\n    var w = el.offsetWidth,\n        h = el.offsetHeight,\n        x = mouseEvent.clientX - w - 8,\n        y = mouseEvent.clientY - h / 2;\n    if (x < 0) {\n        x = 0;\n    }\n    if (y < 0) {\n        y = 0;\n    }\n    el.style.top = y + 'px';\n    el.style.left = x + 'px';\n    setTimeout(function() {\n        document.body.removeChild(el);\n    }, 1000);\n}\n\nfunction copyToClipboard(s, mouseEvent) {\n    let success = false;\n    let ta;\n    try {\n        ta = document.createElement('textarea');\n        ta.value = s;\n        document.body.appendChild(ta);\n        ta.select();\n        success = document.execCommand('copy');\n        if (success) {\n            showNotification('Скопировано', mouseEvent);\n        }\n    } catch (e) {\n        logging.captureException(e, 'clipborad to copy failed');\n    } finally {\n        document.body.removeChild(ta);\n    }\n    if (!success) {\n        query(\"Copy to clipboard: Ctrl+C, Enter\", s);\n    }\n}\n\nexport default copyToClipboard;\n","import {Cache} from '~/lib/cache';\nimport {XHRQueue} from '~/lib/xhr-promise';\n\nclass TiledDataLoader {\n    constructor(cacheSize = 50) {\n        this._cache = new Cache(cacheSize);\n        this._pendingRequests = {};\n        this._xhrQueue = new XHRQueue();\n    }\n\n    makeTileKey(coords) {\n        return `${coords.x}:${coords.y}:${coords.z}`;\n    }\n\n    getFromCache(dataTileCoords) {\n        const key = this.makeTileKey(dataTileCoords);\n        const res = this._cache.get(key);\n        res['coords'] = dataTileCoords;\n        return res;\n    }\n\n    layerTileToDataTileCoords(layerTileCoords) {\n        return {...layerTileCoords};\n    }\n\n    makeRequestData(_unused_dataTileCoords) {\n        throw new Error('Not implemented');\n        // return {\n        //     url,\n        //     options\n        // }\n    }\n\n    processResponse(_unused_xhr, _unused_originalDataTileCoords) {\n        throw new Error('Not implemented');\n        // return {\n        //     tileData,\n        //     coords\n        // }\n    }\n\n    calcAdjustment(layerTileCoords, dataTileCoords) {\n        if (layerTileCoords.x === dataTileCoords.x &&\n            layerTileCoords.y === dataTileCoords.y &&\n            layerTileCoords.z === dataTileCoords.z) {\n            return null;\n        }\n        if (dataTileCoords.z > layerTileCoords.z) {\n            const multiplier = 1 << (dataTileCoords.z - layerTileCoords.z);\n            return {multiplier: 1 / multiplier, offsetX: 0, offsetY: 0};\n        }\n        const multiplier = 1 << (layerTileCoords.z - dataTileCoords.z);\n        return {\n            multiplier,\n            offsetX: (layerTileCoords.x - dataTileCoords.x * multiplier),\n            offsetY: (layerTileCoords.y - dataTileCoords.y * multiplier)\n        };\n    }\n\n    requestTileData(layerTileCoords) {\n        const dataTileCoords = this.layerTileToDataTileCoords(layerTileCoords);\n        let res = this.getFromCache(dataTileCoords);\n        if (res.found) {\n            return {\n                dataPromise: Promise.resolve({\n                        coords: res.coords,\n                        tileData: res.value,\n                        adjustment: this.calcAdjustment(layerTileCoords, res.coords)\n                    }\n                ),\n                abortLoading: () => {\n                    // no need to abort Promise which is resolved immediately\n                }\n            };\n        }\n\n        const dataTileKey = this.makeTileKey(dataTileCoords);\n        if (!(dataTileKey in this._pendingRequests)) {\n            const {url, options} = this.makeRequestData(dataTileCoords);\n            const fetchPromise = this._xhrQueue.put(url, options);\n            const dataPromise = (async() => {\n                let xhr;\n                try {\n                    xhr = await fetchPromise;\n                } catch (e) {\n                    return {error: e};\n                } finally {\n                    delete this._pendingRequests[dataTileKey];\n                }\n                const {tileData, coords} = await this.processResponse(xhr, dataTileCoords);\n                this._cache.put(this.makeTileKey(coords), tileData);\n                return {tileData, coords};\n            })();\n            const pendingRequest = this._pendingRequests[dataTileKey] = {\n                dataPromise,\n                refCount: 0\n            };\n            pendingRequest.abortLoading = () => {\n                pendingRequest.refCount -= 1;\n                if (pendingRequest.refCount < 1) {\n                    fetchPromise.abort();\n                    delete this._pendingRequests[dataTileKey];\n                }\n            };\n        }\n\n        let pendingRequest = this._pendingRequests[dataTileKey];\n        pendingRequest.refCount += 1;\n\n        return {\n            dataPromise: pendingRequest.dataPromise.then((data) => {\n                    if (data.error) {\n                        return data;\n                    }\n                    return {\n                        coords: data.coords,\n                        tileData: data.tileData,\n                        adjustment: this.calcAdjustment(layerTileCoords, data.coords)\n                    };\n            }),\n            abortLoading: () => pendingRequest.abortLoading()\n        };\n    }\n}\n\nexport {TiledDataLoader};\n","import parsers from './parsers';\n\nfunction parseGeoFile(name, data) {\n    for (var i = 0; i < parsers.length; i++) {\n        var parsed = parsers[i](data, name);\n        if (parsed !== null) {\n            return parsed;\n        }\n    }\n    return [{name: name, error: 'UNSUPPORTED'}];\n}\n\nexport default parseGeoFile;\n","export default function stripBom(s) {\n    if (s.substr(0, 3) === '\\xef\\xbb\\xbf') {\n        s = s.substr(3);\n    }\n    return s;\n}\n","import services from './services';\n\nasync function loadFromUrl(url) {\n    for (let ServiceClass of services) {\n        let service = new ServiceClass(url);\n        if (service.isOurUrl()) {\n            return service.geoData();\n        }\n    }\n    return [{name: url, error: 'INVALID_URL'}];\n}\n\nexport default loadFromUrl;\n","import Pbf from 'pbf';\nimport {TrackView} from './nktk_pb';\nimport {arrayBufferToString, stringToArrayBuffer} from '~/lib/binary-strings';\nimport utf8 from 'utf8';\nimport * as urlSafeBase64 from './urlSafeBase64';\n\nconst arcUnit = ((1 << 24) - 1) / 360;\n\nfunction PackedStreamReader(s) {\n    this._string = s;\n    this.position = 0;\n}\n\nfunction unpackNumber(s, position) {\n    var x,\n        n = 0;\n    x = s.charCodeAt(position);\n    if (isNaN(x)) {\n        throw new Error('Unexpected end of line while unpacking number');\n    }\n    if (x < 128) {\n        n = x - 64;\n        return [n, 1];\n    }\n    n = x & 0x7f;\n    x = s.charCodeAt(position + 1);\n    if (isNaN(x)) {\n        throw new Error('Unexpected end of line while unpacking number');\n    }\n    if (x < 128) {\n        n |= x << 7;\n        n -= 8192;\n        return [n, 2];\n    }\n    n |= (x & 0x7f) << 7;\n    x = s.charCodeAt(position + 2);\n    if (isNaN(x)) {\n        throw new Error('Unexpected end of line while unpacking number');\n    }\n    if (x < 128) {\n        n |= x << 14;\n        n -= 1048576;\n        return [n, 3];\n    }\n    n |= (x & 0x7f) << 14;\n    x = s.charCodeAt(position + 3);\n    if (isNaN(x)) {\n        throw new Error('Unexpected end of line while unpacking number');\n    }\n    n |= x << 21;\n    n -= 268435456;\n    return [n, 4];\n}\n\nPackedStreamReader.prototype.readNumber = function() {\n    var n = unpackNumber(this._string, this.position);\n    this.position += n[1];\n    return n[0];\n};\n\nPackedStreamReader.prototype.readString = function(size) {\n    var s = this._string.slice(this.position, this.position + size);\n    this.position += size;\n    return s;\n};\n\nfunction deltaEncodeSegment(points) {\n    let deltaLats = [],\n        deltaLons = [];\n    let lastLon = 0,\n        lastLat = 0,\n        lon, lat;\n    for (let i = 0, len = points.length; i < len; i++) {\n        let p = points[i];\n        lon = Math.round(p.lng * arcUnit);\n        lat = Math.round(p.lat * arcUnit);\n        let deltaLon = lon - lastLon;\n        let deltaLat = lat - lastLat;\n        deltaLats.push(deltaLat);\n        deltaLons.push(deltaLon);\n        lastLon = lon;\n        lastLat = lat;\n    }\n    return {deltaLats, deltaLons};\n}\n\nfunction deltaDecodeSegment(deltaLats, deltaLons) {\n    let encodedLat = 0,\n        encodedLon = 0;\n    const points = [];\n    for (let i = 0; i < deltaLats.length; i++) {\n        encodedLat += deltaLats[i];\n        encodedLon += deltaLons[i];\n        points.push({lat: encodedLat / arcUnit, lng: encodedLon / arcUnit});\n    }\n    return points;\n}\n\nfunction saveNktk(segments, name, color, measureTicksShown, waypoints, trackHidden) {\n    const trackView = {\n        view: {\n            color,\n            shown: !trackHidden,\n            ticksShown: measureTicksShown,\n        }\n    };\n    const track = trackView.track = {name};\n    if (segments && segments.length) {\n        let deltaEncodedSegments = [];\n        for (let segment of segments) {\n            let {deltaLats, deltaLons} = deltaEncodeSegment(segment);\n            deltaEncodedSegments.push({lats: deltaLats, lons: deltaLons});\n        }\n        track.segments = deltaEncodedSegments;\n    }\n    if (waypoints && waypoints.length) {\n        let midLon = 0,\n            midLat = 0;\n        waypoints.forEach((wp) => {\n                midLon += wp.latlng.lng;\n                midLat += wp.latlng.lat;\n            }\n        );\n        midLon = Math.round(midLon * arcUnit / waypoints.length);\n        midLat = Math.round(midLat * arcUnit / waypoints.length);\n        track.waypoints = {\n            midLat, midLon\n        };\n\n        let packedWaypoints = [];\n        for (let waypoint of waypoints) {\n            packedWaypoints.push({\n                name: waypoint.label,\n                lat: Math.round(waypoint.latlng.lat * arcUnit) - midLat,\n                lon: Math.round(waypoint.latlng.lng * arcUnit) - midLon\n            });\n        }\n        track.waypoints.waypoints = packedWaypoints;\n    }\n    const pbf = new Pbf();\n    const versionStr = String.fromCharCode(4 + 64);\n    TrackView.write(trackView, pbf);\n    const s = versionStr + arrayBufferToString(pbf.finish());\n    return urlSafeBase64.encode(s);\n}\n\nfunction parseNktkOld(s, version) {\n    var name,\n        n,\n        segments = [],\n        segment,\n        segmentsCount,\n        pointsCount,\n        arcUnit = ((1 << 24) - 1) / 360,\n        x, y,\n        error, midX, midY, /* symbol,*/ waypointName,\n        wayPoints = [],\n        color, measureTicksShown,\n        trackHidden = false;\n    s = new PackedStreamReader(s);\n    try {\n        n = s.readNumber();\n        name = s.readString(n);\n        name = utf8.decode(name);\n        segmentsCount = s.readNumber();\n        for (let i = 0; i < segmentsCount; i++) {\n            segment = [];\n            pointsCount = s.readNumber();\n            x = 0;\n            y = 0;\n            for (let j = 0; j < pointsCount; j++) {\n                x += s.readNumber();\n                y += s.readNumber();\n                segment.push({lng: x / arcUnit, lat: y / arcUnit});\n            }\n            segments.push(segment);\n            segment = null;\n        }\n    } catch (e) {\n        if (e.message.match('Unexpected end of line while unpacking number')) {\n            error = ['CORRUPT'];\n            if (segment) {\n                segments.push(segment);\n            }\n        } else {\n            throw e;\n        }\n    }\n    try {\n        color = s.readNumber();\n        measureTicksShown = s.readNumber();\n    } catch (e) {\n        if (e.message.match('Unexpected end of line while unpacking number')) {\n            color = 0;\n            measureTicksShown = 0;\n            if (version > 0) {\n                error = ['CORRUPT'];\n            }\n        } else {\n            throw e;\n        }\n    }\n    if (version >= 3) {\n        try {\n            trackHidden = Boolean(s.readNumber());\n        } catch (e) {\n            if (e.message.match('Unexpected end of line while unpacking number')) {\n                error = ['CORRUPT'];\n            } else {\n                throw e;\n            }\n        }\n    }\n    if (version >= 2) {\n        try {\n            pointsCount = s.readNumber();\n            if (pointsCount) {\n                midX = s.readNumber();\n                midY = s.readNumber();\n            }\n            for (let i = 0; i < pointsCount; i++) {\n                n = s.readNumber();\n                waypointName = s.readString(n);\n                waypointName = utf8.decode(waypointName);\n\n                // let symbol = s.readNumber();\n                s.readNumber();\n\n                x = s.readNumber() + midX;\n                y = s.readNumber() + midY;\n                wayPoints.push({\n                        name: waypointName,\n                        lat: y / arcUnit,\n                        lng: x / arcUnit,\n\n                    }\n                );\n            }\n        } catch (e) {\n            if (e.message.match('Unexpected end of line while unpacking number')) {\n                error = ['CORRUPT'];\n            } else {\n                throw e;\n            }\n        }\n    }\n    var geoData = {\n        name: name || \"Text encoded track\",\n        tracks: segments,\n        error: error,\n        points: wayPoints,\n        color: color,\n        group: 'default',\n        measureTicksShown: measureTicksShown,\n        trackHidden: trackHidden\n    };\n    return [geoData];\n}\n\nfunction parseTrackUrlData(s) {\n    s = urlSafeBase64.decode(s);\n    if (!s) {\n        return [{name: 'Text encoded track', error: ['CORRUPT']}];\n    }\n    return parseNktkOld(s, 0);\n}\n\nfunction parseNktkProtobuf(s, group = 'default') {\n    const pbf = new Pbf(stringToArrayBuffer(s));\n    let trackView;\n    try {\n        trackView = TrackView.read(pbf);\n    } catch (e) {\n        return [{name: 'Text encoded track', error: ['CORRUPT']}];\n    }\n    const geoData = {\n        name: trackView.track.name || \"Text encoded track\",\n        color: trackView.view.color,\n        trackHidden: !trackView.view.shown,\n        group: group,\n        measureTicksShown: trackView.view.ticksShown,\n    };\n    const segments = trackView.track.segments;\n    if (segments && segments.length) {\n        geoData.tracks = segments.map((segment) => deltaDecodeSegment(segment.lats, segment.lons));\n    }\n    if (trackView.track.waypoints && trackView.track.waypoints.waypoints.length) {\n        const waypoints = geoData.points = [];\n        for (let waypoint of trackView.track.waypoints.waypoints) {\n            waypoints.push({\n                name: waypoint.name,\n                lat: (waypoint.lat + trackView.track.waypoints.midLat) / arcUnit,\n                lng: (waypoint.lon + trackView.track.waypoints.midLon) / arcUnit\n            });\n        }\n    }\n    return [geoData];\n}\n\nfunction parseNktkFragment(s, group = 'default') {\n    s = urlSafeBase64.decode(s);\n    if (!s) {\n        return [{name: 'Text encoded track', error: ['CORRUPT']}];\n    }\n    const reader = new PackedStreamReader(s);\n    let version = reader.readNumber();\n    if (version === 1 || version === 2 || version === 3) {\n        return parseNktkOld(s.substring(reader.position), version);\n    } else if (version === 4) {\n        return parseNktkProtobuf(s.substring(reader.position), group);\n    }\n    return [{name: 'Text encoded track', error: ['CORRUPT']}];\n}\n\nfunction parseNktkSequence(s, group = 'default' ) {\n    let track_data = s.split('/');\n    let data = [];\n    track_data.forEach(function(element, index){\n        let arr = parseNktkFragment(element, group);\n        arr.forEach(function(element2){\n            data.push(element2);\n        });\n    });\n\n    return data;\n}\n\nexport {saveNktk, parseTrackUrlData, parseNktkSequence, parseNktkFragment};\n","function onElementResize(element, cb) {\n    if (window.ResizeObserver) {\n        const observer = new ResizeObserver(() => cb());\n        observer.observe(element);\n    } else {\n        let width = element.offsetWidth;\n        let height = element.offsetHeight;\n        setInterval(function () {\n            const newWidth = element.offsetWidth;\n            const newHeight = element.offsetHeight;\n            if (newWidth !== width || newHeight !== height) {\n                width = newWidth;\n                height = newHeight;\n                cb();\n            }\n        }, 200);\n    }\n}\n\nexport {onElementResize};\n","import ko from 'knockout';\nimport './style.css';\nimport '~/lib/controls-styles/controls-styles.css';\n\nko.components.register('progress-indicator', {\n    template: `\n        <div class=\"ko-progress-unknown icon-spinner-nuclear\" data-bind=\"visible: progress() === undefined\"></div>\n        <div class=\"ko-progress\" data-bind=\"visible: progress() !== undefined\">\n            <div class=\"ko-progress-bkg\">\n                <div class=\"ko-progress-bar\"  data-bind=\"style: {width: progress() + '%'}\"></div>\n            </div>\n        </div>`,\n    viewModel: function(params) {\n        this.progress = ko.pureComputed(function() {\n            var range = params.progressRange(),\n                done = params.progressDone();\n            return done === undefined ? undefined : done * 100 / range;\n        });\n    }\n});\n","import L from 'leaflet';\nimport './TileLayer';\nimport './Bing';\nimport './Yandex';\nimport './Google';\nimport './WestraPasses';\nimport './CanvasMarkers';\nimport './MeasuredLine';\nimport './RetinaTileLayer';\n\nfunction getTempMap(zoom, fullSize, pixelBounds) {\n    const container = L.DomUtil.create('div', '', document.body);\n    let width, height, center;\n    if (fullSize) {\n        const size = pixelBounds.getSize();\n        width = size.x;\n        height = size.y;\n        center = pixelBounds.min.add(size.divideBy(2));\n        center = L.CRS.EPSG3857.pointToLatLng(center, zoom);\n    } else {\n        width = 100;\n        height = 100;\n        center = L.latLng(0, 0);\n    }\n\n    Object.assign(container.style, {\n            width: `${width}px`,\n            height: `${height}px`,\n            position: 'absolute',\n            left: '0',\n            top: '0',\n            visibility: 'hidden',\n        }\n    );\n\n    const map = L.map(container, {fadeAnimation: false, zoomAnimation: false, inertia: false, maxZoom: 18});\n    map.setView(center, zoom);\n    return map;\n}\n\nfunction disposeMap(map) {\n    const container = map._container;\n    map.remove();\n    L.DomUtil.remove(container);\n}\n\nexport {getTempMap, disposeMap};\n","import L from 'leaflet';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\nimport {imgFromDataString} from './imgFromDataString';\n\nfunction noop() {\n    // dummy function\n}\n\nconst GridLayerGrabMixin = {\n    tileImagePromiseFromCoords: function(_unused_coords) {\n        throw new Error('Method not implemented');\n    },\n\n    waitTilesReadyToGrab: function() {\n        return Promise.resolve(null);\n    },\n\n    getTilesInfo: async function(printOptions) {\n        await this.waitTilesReadyToGrab();\n        const {pixelBounds} = printOptions;\n        const tileRange = this._pxBoundsToTileRange(pixelBounds);\n        const topLeft = pixelBounds.min;\n        const tilePromiseIterator = (function*() {\n            for (let j = tileRange.min.y; j <= tileRange.max.y; j++) {\n                for (let i = tileRange.min.x; i <= tileRange.max.x; i++) {\n                    let coords = new L.Point(i, j);\n                    coords.z = this._tileZoom;\n                    if (!this._isValidTile(coords)) {\n                        continue;\n                    }\n                    let tilePos = this._getTilePos(coords);\n                    const coordsPlusOne = coords.add(L.point(1, 1));\n                    coordsPlusOne.z = coords.z;\n                    const tilePlusOne = this._getTilePos(coordsPlusOne);\n                    const tileSize = tilePlusOne.subtract(tilePos);\n                    const latLngBounds = L.latLngBounds(\n                        this._map.unproject(tilePos.add(this._level.origin)),\n                        this._map.unproject(tilePlusOne.add(this._level.origin)));\n                    tilePos = tilePos.add(this._level.origin).subtract(topLeft);\n                    let {tilePromise, abortLoading} = this.tileImagePromiseFromCoords(\n                        this._wrapCoords(coords), printOptions);\n                    yield {\n                        tilePromise: tilePromise.then((image) => ({image, tilePos, tileSize, latLngBounds})),\n                        abortLoading\n                    };\n                }\n            }\n        }).bind(this);\n        return {\n            iterateTilePromises: tilePromiseIterator,\n            count: (tileRange.max.x - tileRange.min.x + 1) * (tileRange.max.y - tileRange.min.y + 1)\n        };\n    }\n};\n\nconst TileLayerGrabMixin = L.Util.extend({}, GridLayerGrabMixin, {\n        cloneForPrint: function(options) {\n            return L.tileLayer(this._url, L.Util.extend({}, this.options, options));\n        },\n\n        tileImagePromiseFromCoords: function(coords, printOptions) {\n            let {xhrOptions} = printOptions;\n            let url = this.getTileUrl(coords);\n            if (!url) {\n                return {tilePromise: Promise.resolve(null), abortLoading: noop};\n            }\n            if (this.options.noCors) {\n                url = urlViaCorsProxy(url);\n            }\n            let promise = this.options.xhrQueue.put(url, xhrOptions);\n\n            return {\n                tilePromise: printOptions.rawData ? promise : promise.then(imgFromDataString),\n                abortLoading: () => promise.abort()\n            };\n        }\n    }\n);\n\n// CanvasLayerGrabMixin has been deleted\n\nL.TileLayer.include(TileLayerGrabMixin);\n","import L from 'leaflet';\nimport './style.css';\n\nconst yandexCrs = L.CRS.EPSG3395;\n\nL.Layer.Yandex = L.TileLayer.extend({\n        options: {\n            subdomains: '1234',\n            className: L.Browser.retina ? '' : 'yandex-tile-layer',\n            yandexScale: L.Browser.retina ? 2 : 1\n        },\n\n        _getTilePos: function(coords) {\n            const tilePosLatLng = yandexCrs.pointToLatLng(coords.scaleBy(this.getTileSize()), coords.z);\n            return this._map.project(tilePosLatLng, coords.z).subtract(this._level.origin).round();\n        },\n\n        _pxBoundsToTileRange: function(bounds) {\n            const zoom = this._tileZoom;\n            const bounds2 = new L.Bounds(\n                yandexCrs.latLngToPoint(this._map.unproject(bounds.min, zoom), zoom),\n                yandexCrs.latLngToPoint(this._map.unproject(bounds.max, zoom), zoom));\n            return L.TileLayer.prototype._pxBoundsToTileRange.call(this, bounds2);\n        },\n\n        createTile: function(coords, done) {\n            const tile = L.TileLayer.prototype.createTile.call(this, coords, done);\n            const coordsBelow = L.point(coords).add([0, 1]);\n            coordsBelow.z = coords.z;\n            tile._adjustHeight = this._getTilePos(coordsBelow).y - this._getTilePos(coords).y;\n            return tile;\n        },\n\n        _initTile: function(tile) {\n            L.TileLayer.prototype._initTile.call(this, tile);\n            tile.style.height = `${tile._adjustHeight}px`;\n        }\n    }\n);\n\nL.Layer.Yandex.Map = L.Layer.Yandex.extend({\n    initialize: function(options) {\n        L.Layer.Yandex.prototype.initialize.call(\n            this,\n            'https://vec0{s}.maps.yandex.net/tiles?l=map&x={x}&y={y}&z={z}&scale={yandexScale}',\n            options\n        );\n    },\n});\n\nL.Layer.Yandex.Sat = L.Layer.Yandex.extend({\n    initialize: function(options) {\n        L.Layer.Yandex.prototype.initialize.call(\n            this,\n            'https://sat0{s}.maps.yandex.net/tiles?l=sat&x={x}&y={y}&z={z}',\n            options\n        );\n    },\n});\n\nL.Layer.Yandex.Tracks = L.Layer.Yandex.extend({\n    initialize: function(options) {\n        options = {minZoom: 10, maxNativeZoom: 16, ...options};\n        L.Layer.Yandex.prototype.initialize.call(\n            this,\n            'https://core-gpstiles.maps.yandex.net/tiles?style=point&x={x}&y={y}&z={z}',\n            options\n        );\n    },\n});\n","import L from \"leaflet\";\n\nL.Layer.GoogleBase = L.TileLayer.extend({\n    options: {\n        subdomains: '0123'\n    },\n\n    getTileUrl: function(coords) {\n        const data = {\n            x: coords.x,\n            y: coords.y,\n            z: 17 - this._getZoomForUrl(),\n            s: this._getSubdomain(coords),\n            lang: navigator.language || ''\n        };\n        return L.Util.template(this._url, data);\n    }\n});\n\nL.Layer.GoogleMap = L.Layer.GoogleBase.extend({\n    initialize: function(options) {\n        L.Layer.GoogleBase.prototype.initialize.call(\n            this, 'https://mt{s}.google.com/vt/lyrs=m@169000000&hl={lang}&x={x}&y={y}&zoom={z}', options);\n    }\n});\n\nL.Layer.GoogleTerrain = L.Layer.GoogleBase.extend({\n    initialize: function(options) {\n        L.Layer.GoogleBase.prototype.initialize.call(\n            this, 'https://mt{s}.google.com/vt/lyrs=t@130,r@206000000&hl={lang}&x={x}&y={y}&zoom={z}', options);\n    }\n});\n\nL.Layer.GoogleHybrid = L.Layer.GoogleBase.extend({\n    initialize: function(options) {\n        L.Layer.GoogleBase.prototype.initialize.call(\n            this, 'https://mt{s}.google.com/vt/lyrs=h@169000000&hl={lang}&x={x}&y={y}&zoom={z}', options);\n    }\n});\n\nL.Layer.GoogleSat = L.TileLayer.extend({\n    options: {\n        subdomains: '0123'\n    },\n\n    initialize: function(options) {\n        L.TileLayer.prototype.initialize.call(\n            this, 'https://mt{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', options);\n    }\n});\n","import L from 'leaflet';\nimport '~/lib/leaflet.layer.canvasMarkers';\nimport {openPopupWindow} from '~/lib/popup-window';\nimport escapeHtml from 'escape-html';\nimport {saveAs} from '~/vendored/github.com/eligrey/FileSaver';\nimport iconFromBackgroundImage from '~/lib/iconFromBackgroundImage';\nimport {fetch} from '~/lib/xhr-promise';\nimport {notify} from '~/lib/notifications';\nimport * as logging from '~/lib/logging';\n\nconst WestraPassesMarkers = L.Layer.CanvasMarkers.extend({\n        options: {\n            filePasses: 'westra_passes.json',\n            scaleDependent: true\n        },\n\n        initialize: function(baseUrl, options) {\n            L.Layer.CanvasMarkers.prototype.initialize.call(this, null, options);\n            this.on('markerclick', this.showPassDescription, this);\n            this._baseUrl = baseUrl;\n            this.url = baseUrl + this.options.filePasses;\n        },\n\n        loadData: function() {\n            if (this._downloadStarted) {\n                return;\n            }\n            this._downloadStarted = true;\n            fetch(this.url)\n                .then(\n                    (xhr) => this._loadMarkers(xhr),\n                    (e) => {\n                        this._downloadStarted = false;\n                        logging.captureException(e, 'failed to get westra passes');\n                        notify('Failed to get Westra passes data');\n                    }\n                );\n        },\n\n        onAdd: function(map) {\n            L.Layer.CanvasMarkers.prototype.onAdd.call(this, map);\n            this.loadData();\n        },\n\n        _makeTooltip: function(marker) {\n            var properties = marker.properties,\n                toolTip = properties.grade || '';\n            if (toolTip && properties.elevation) {\n                toolTip += ', ';\n            }\n            toolTip += properties.elevation || '';\n            if (toolTip) {\n                toolTip = ' (' + toolTip + ')';\n            }\n            toolTip = (properties.name || 'без названия') + toolTip;\n            toolTip = (properties.is_summit ? 'Вершина ' : 'Перевал ') + toolTip;\n            return toolTip;\n        },\n\n        _passToGpx: function(marker) {\n            let label = marker.tooltip;\n            if (typeof label === 'function') {\n                label = label(marker);\n            }\n            label = escapeHtml(label);\n            const gpx = `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\" ?>\n                <gpx xmlns=\"http://www.topografix.com/GPX/1/1\"\n                     creator=\"http://nakarte.me\"\n                     xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n                     xsi:schemaLocation=\"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd\"\n                     version=\"1.1\">\n                    <wpt lat=\"${marker.latlng.lat.toFixed(6)}\" lon=\"${marker.latlng.lng.toFixed(6)}\">\n                        <name>${label}</name>\n                    </wpt>\n                </gpx>\n            `;\n            var filename = marker.properties.name || 'Без названия';\n            saveAs(new Blob([gpx], {type: 'application/gpx+xml'}), filename + '.gpx', true);\n        },\n\n        _passToKml: function(marker) {\n            let label = marker.tooltip;\n            if (typeof label === 'function') {\n                label = label(marker);\n            }\n            label = escapeHtml(label);\n            const kml = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n                <kml xmlns=\"http://www.opengis.net/kml/2.2\">\n                    <Placemark>\n                        <name>${label}</name>\n                        <Point>\n                            <coordinates>\n                                ${marker.latlng.lng.toFixed(6)},${marker.latlng.lat.toFixed(6)},0\n                            </coordinates>\n                        </Point>\n                    </Placemark>\n                </kml>\n            `;\n            var filename = marker.properties.name || 'Без названия';\n            saveAs(new Blob([kml], {type: 'application/vnd.google-earth.kml+xml'}), filename + '.kml', true);\n        },\n\n        _makeIcon: function(marker) {\n            var className;\n            className = 'westra-pass-marker ';\n            if (marker.properties.is_summit) {\n                className += 'westra-pass-marker-summit';\n            } else {\n                className += 'westra-pass-marker-' + marker.properties.grade_eng;\n            }\n            return iconFromBackgroundImage(className);\n        },\n\n        _loadMarkers: function(xhr) {\n            var markers = [],\n                features = JSON.parse(xhr.response),\n                feature, i, marker;\n            for (i = 0; i < features.length; i++) {\n                feature = features[i];\n                marker = {\n                    latlng: {\n                        lat: feature.latlon[0],\n                        lng: feature.latlon[1]\n                    },\n                    label: feature.name || \"\",\n                    icon: this._makeIcon,\n                    tooltip: this._makeTooltip.bind(this),\n                    properties: feature\n                };\n                markers.push(marker);\n            }\n            this.addMarkers(markers);\n            this._dataLoaded = true;\n            this.fire('data-loaded');\n        },\n\n        showPassDescription: function(e) {\n            if (!this._map) {\n                return;\n            }\n            const properties = e.marker.properties,\n                latLng = e.marker.latlng,\n                url = 'https://westra.ru/passes/Passes/' + properties.id;\n            let altnames = '',\n                connects = '',\n                comments = '';\n            if (properties.altnames) {\n                altnames = `\n                    <tr>\n                        <td>Другие названия</td>\n                        <td>${properties.altnames}</td>\n                    </tr>`;\n            }\n\n            if (!properties.is_summit) {\n                connects = `\n                    <tr>\n                        <td>Соединяет</td>\n                        <td>${properties.connects || \"неизвестнo\"}</td>\n                    </tr>`;\n            }\n\n            if (properties.comments) {\n                for (let comment of properties.comments) {\n                    let user = '';\n                    if (comment.user) {\n                        user = `<span class=\"westra-passes-description-comment-author\">${comment.user}:</span>`;\n                    }\n                    comments += `<p class=\"westra-passes-description-comment\">${user}${comment.content}</p>`;\n                }\n                comments = `\n                    <tr>\n                        <td>Комментарии</td>\n                        <td>${comments}</td>\n                    </tr>`;\n            }\n            let reports;\n            if (properties.reports_total) {\n                reports =\n                    `<br>Отчетов: ${properties.reports_total}, ` +\n                    `с фото: ${properties.reports_photo || 0}, ` +\n                    `с описанием: ${properties.reports_tech || 0}`;\n            } else {\n                reports = '<br>Отчетов нет';\n            }\n            let description = `\n                <table class=\"pass-details\">\n                    <tr>\n                        <td>${properties.is_summit ? 'Вершина ' : 'Перевал '}</td>\n                        <td>${properties.name || 'название неизвестно'}</td>\n                    </tr>\n                    ${altnames}\n                    <tr>\n                        <td>Категория</td>\n                        <td>${properties.grade || \"неизвестная\"}</td>\n                    </tr>\n                    <tr>\n                        <td>Высота</td>\n                        <td>${properties.elevation ? (properties.elevation + ' м') : 'неизвестная'}</td>\n                    </tr>\n                    ${connects}\n                    <tr>\n                        <td>Характеристика склонов</td>\n                        <td>${properties.slopes || \"неизвестная\"}</td>\n                    </tr>\n                    <tr>\n                        <td>Координаты</td>\n                        <td>\n                            <table class=\"coords\">\n                                <tr class=\"header\">\n                                    <td>Широта</td>\n                                    <td>Долгота</td>\n                                </tr>\n                                <tr>\n                                    <td>${latLng.lat.toFixed(5)}</td>\n                                    <td>${latLng.lng.toFixed(5)}</td>\n                                    <td><a id=\"westra-pass-gpx\" title=\"Сохранить\">gpx</a></td>\n                                    <td><a id=\"westra-pass-kml\" title=\"Сохранить\">kml</a></td>\n                                </tr>\n                            </table>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>На сайте Вестры</td>\n                        <td><a id=\"westra-pass-link\" href=\"${url}\">${url}</a>${reports}</td></tr>\n                    <tr>\n                        <td>Добавил</td>\n                        <td>${properties.author || \"неизвестно\"}</td>\n                    </tr>\n                    ${comments}\n                </table>`;\n            this._map.openPopup(description, latLng, {maxWidth: 500});\n            document.getElementById('westra-pass-link').onclick = function() {\n                openPopupWindow(url, 780, 'westra-details');\n                return false;\n            };\n            document.getElementById('westra-pass-gpx').onclick = function() {\n                this._passToGpx(e.marker);\n                return false;\n            }.bind(this);\n            document.getElementById('westra-pass-kml').onclick = function() {\n                this._passToKml(e.marker);\n                return false;\n            }.bind(this);\n        }\n    }\n);\n\nexport {WestraPassesMarkers};\n","import {notify} from '~/lib/notifications';\n\nfunction openPopupWindow(url, width, uniqName = null) {\n    var left, top, height,\n        screenLeft = screen.availLeft || 0,\n        bordersWidth = 8;\n    // if browser window is in the right half of screen, place new window on left half\n    if (window.screenX - screenLeft - bordersWidth * 1.5 > width) {\n        left = window.screenX - width - bordersWidth * 1.5;\n        // if browser window is in the left half of screen, place new window on right half\n    } else if (window.screenX + window.outerWidth + width + bordersWidth * 1.5 < screenLeft + screen.availWidth) {\n        left = window.screenX + window.outerWidth + bordersWidth;\n        // if screen is small or browser window occupies whole screen, place new window on top of current window\n    } else {\n        left = window.screenX + window.outerWidth / 2 - width / 2;\n        if (left < 0) {\n            left = 0;\n        }\n    }\n    top = window.screenY;\n    height = window.innerHeight;\n    var features = 'width=' + width + ',height=' + height + ',left=' + left + ',top=' + top;\n    features += ',resizable,scrollbars';\n    var newWindow = window.open(url, uniqName, features);\n    if (!newWindow || newWindow.closed) {\n        notify('Всплывающее окно заблокировано браузером.\\n' +\n            'Для полноценной работы сайта необходимо разрешить всплывающие окна в настройках браузера для сайта.\\n\\n' +\n            'Pop-up window was blocked by the browser.\\n' +\n            'If you want to use the full functionality of this site, ' +\n            'turn off blocking pop-ups in the browser settings for this site.');\n    } else {\n        newWindow.focus();\n    }\n}\n\nexport {openPopupWindow};\n","function cached(f) {\n    var cache = {};\n    return function(arg) {\n        if (!(arg in cache)) {\n            cache[arg] = f(arg);\n        }\n        return cache[arg];\n    };\n}\n\nfunction iconFromBackgroundImage(className) {\n    const container = document.createElement('div');\n    container.style.position = 'absolute';\n    document.body.appendChild(container);\n    const el = document.createElement('div');\n    el.className = className;\n    container.appendChild(el);\n    const st = window.getComputedStyle(el),\n        url = st.backgroundImage.replace(/^url\\(\"?/u, '').replace(/\"?\\)$/u, '');\n    let icon = {url: url, center: [-el.offsetLeft, -el.offsetTop]};\n    document.body.removeChild(container);\n    container.removeChild(el);\n    return icon;\n}\n\nexport default cached(iconFromBackgroundImage);\n","import L from \"leaflet\";\nimport '~/lib/leaflet.layer.canvasMarkers';\n\nL.Layer.CanvasMarkers.include({\n        _printProgressWeight: 0.1,\n\n        cloneMarker: function(marker) {\n            return {\n                latlng: {lat: marker.latlng.lat, lng: marker.latlng.lng},\n                label: marker.label,\n                icon: marker.icon\n            };\n        },\n\n        cloneMarkers: function() {\n            const markers = this.rtree.all();\n\n            const markersCopy = markers.map(this.cloneMarker);\n            return markersCopy;\n        },\n\n        cloneForPrint: function(options) {\n            options = L.Util.extend({}, this.options, {noWrap: true});\n            if (options.printIconsOpacity !== undefined) {\n                options.iconsOpacity = options.printIconsOpacity;\n            }\n            return new L.Layer.CanvasMarkers(this.cloneMarkers(), options);\n        },\n\n        getTilesInfo: async function(printOptions) {\n            this.options.iconScale = printOptions.resolution / 90 * 0.75;\n            const scale = printOptions.pixelBounds.getSize().x / printOptions.destPixelSize.x;\n            const pixelExtents = {\n                tileN: printOptions.pixelBounds.getTopRight().y / scale,\n                tileS: printOptions.pixelBounds.getBottomLeft().y / scale,\n                tileE: printOptions.pixelBounds.getTopRight().x / scale,\n                tileW: printOptions.pixelBounds.getBottomLeft().x / scale\n            };\n            const crs = L.CRS.EPSG3857;\n            if (!this._map) {\n                const dummyMap = {\n                    project: crs.latLngToPoint.bind(crs),\n                    unproject: crs.pointToLatLng.bind(crs),\n                };\n                this._map = dummyMap;\n            }\n            const zoom = crs.zoom((1 / scale) * crs.scale(printOptions.zoom));\n            const {iconUrls, markerJobs, pointsForLabels} = this.selectMarkersForDraw(pixelExtents, zoom, true);\n            await this.preloadIcons(iconUrls);\n            return {\n                iterateTilePromises: (function*() {\n                    yield {\n                        tilePromise: Promise.resolve({\n                                draw: (canvas) => {\n                                    this.resetLabels();\n                                    this.drawSelectedMarkers(canvas, pixelExtents, markerJobs, pointsForLabels, zoom,\n                                        true);\n                                },\n                                isOverlay: true,\n                                overlaySolid: !this.options.printTransparent\n                            }\n                        ),\n                        abortLoading: () => {\n                            // no actions needed\n                        }\n                    };\n                }).bind(this),\n                count: 1\n            };\n        }\n    }\n);\n","import L from 'leaflet';\nimport './measured_line.css';\n\nfunction pointOnSegmentAtDistance(p1, p2, dist) {\n    // FIXME: we should place markers along projected line to avoid transformation distortions\n    var q = dist / p1.distanceTo(p2),\n        x = p1.lng + (p2.lng - p1.lng) * q,\n        y = p1.lat + (p2.lat - p1.lat) * q;\n    return L.latLng(y, x);\n}\n\nfunction sinCosFromLatLonSegment(segment) {\n    const\n        p1 = L.CRS.EPSG3857.project(segment[0]),\n        p2 = L.CRS.EPSG3857.project(segment[1]),\n        dx = p2.x - p1.x,\n        dy = p1.y - p2.y,\n        len = Math.sqrt(dx * dx + dy * dy),\n        sin = dy / len,\n        cos = dx / len;\n    return [sin, cos];\n}\n\nL.MeasuredLine = L.Polyline.extend({\n        options: {\n            minTicksIntervalMm: 15,\n        },\n\n        onAdd: function(map) {\n            L.Polyline.prototype.onAdd.call(this, map);\n            this._ticks = {};\n            this.updateTicks();\n            this._map.on('zoomend', this.updateTicks, this);\n            // markers are created only for visible part of map, need to update when it changes\n            this._map.on('moveend', this.updateTicks, this);\n            this.on('nodeschanged', this.updateTicksLater, this);\n        },\n\n        updateTicksLater: function() {\n            setTimeout(this.updateTicks.bind(this), 0);\n        },\n\n        onRemove: function(map) {\n            this._map.off('zoomend', this.updateTicks, this);\n            this._map.off('moveend', this.updateTicks, this);\n            this.off('nodeschanged', this.updateTicks, this);\n            this._clearTicks();\n            L.Polyline.prototype.onRemove.call(this, map);\n        },\n\n        _clearTicks: function() {\n            if (this._map) {\n                Object.values(this._ticks).forEach((tick) => this._map.removeLayer(tick));\n                this._ticks = {};\n            }\n        },\n\n        _addTick: function(tick, marker) {\n            var transformMatrixString = 'matrix(' + tick.transformMatrix.join(',') + ')';\n            if (marker) {\n                marker._icon.childNodes[0].style.transform = transformMatrixString;\n                marker.setLatLng(tick.position);\n            } else {\n                var labelText = Math.round((tick.distanceValue / 10)) / 100 + ' km',\n                    icon = L.divIcon(\n                        {\n                            html: '<div class=\"measure-tick-icon-text\" style=\"transform:' +\n                                transformMatrixString + '\">' +\n                            labelText + '</div>',\n                            className: 'measure-tick-icon'\n                        }\n                    );\n                marker = L.marker(tick.position, {\n                    icon: icon,\n                    interactive: false,\n                    keyboard: false,\n                    projectedShift: () => this.shiftProjectedFitMapView(),\n                });\n                marker.addTo(this._map);\n            }\n            this._ticks[tick.distanceValue.toString()] = marker;\n        },\n\n        setMeasureTicksVisible: function(visible) {\n            this.options.measureTicksShown = visible;\n            this.updateTicks();\n        },\n\n        getTicksPositions: function(minTicksIntervalMeters, bounds) {\n            var steps = [500, 1000, 2000, 5000, 10000, 20000, 50000, 100000, 200000, 500000, 1000000];\n            var ticks = [];\n\n            const that = this;\n            function addTick(position, segment, distanceValue) {\n                if (bounds) {\n                    // create markers only in visible part of map\n                    const normalizedBounds = that._map.wrapLatLngBounds(bounds);\n                    const normalizedPosition = position.wrap();\n                    // account for worldCopyJump\n                    const positionMinus360 = L.latLng(normalizedPosition.lat, normalizedPosition.lng - 360);\n                    const positionPlus360 = L.latLng(normalizedPosition.lat, normalizedPosition.lng + 360);\n                    if (\n                        !normalizedBounds.contains(normalizedPosition) &&\n                        !normalizedBounds.contains(positionMinus360) &&\n                        !normalizedBounds.contains(positionPlus360)\n                    ) {\n                        return;\n                    }\n                }\n\n                var sinCos = sinCosFromLatLonSegment(segment),\n                    sin = sinCos[0],\n                    cos = sinCos[1],\n                    transformMatrix;\n\n                if (sin > 0) {\n                    transformMatrix = [sin, -cos, cos, sin, 0, 0];\n                } else {\n                    transformMatrix = [-sin, cos, -cos, -sin, 0, 0];\n                }\n                ticks.push({position: position, distanceValue: distanceValue, transformMatrix: transformMatrix});\n            }\n\n            let step;\n            for (step of steps) {\n                if (step >= minTicksIntervalMeters) {\n                    break;\n                }\n            }\n\n            var lastTickMeasure = 0,\n                lastPointMeasure = 0,\n                points = this._latlngs,\n                points_n = points.length,\n                nextPointMeasure,\n                segmentLength;\n            if (points_n < 2) {\n                return ticks;\n            }\n\n            for (var i = 1; i < points_n; i++) {\n                segmentLength = points[i].distanceTo(points[i - 1]);\n                nextPointMeasure = lastPointMeasure + segmentLength;\n                if (nextPointMeasure >= lastTickMeasure + step) {\n                    while (lastTickMeasure + step <= nextPointMeasure) {\n                        lastTickMeasure += step;\n                        addTick(\n                            pointOnSegmentAtDistance(points[i - 1], points[i], lastTickMeasure - lastPointMeasure),\n                            [points[i - 1], points[i]],\n                            lastTickMeasure\n                        );\n                    }\n                }\n                lastPointMeasure = nextPointMeasure;\n            }\n            // remove last mark if it is close to track end\n            if (lastPointMeasure - lastTickMeasure < minTicksIntervalMeters / 2) {\n                ticks.pop();\n            }\n            // special case: if track is versy short, do not add starting mark\n            if (lastPointMeasure > minTicksIntervalMeters / 2) {\n                addTick(points[0], [points[0], points[1]], 0);\n            }\n            addTick(points[points_n - 1], [points[points_n - 2], points[points_n - 1]], lastPointMeasure);\n            return ticks;\n        },\n\n        updateTicks: function() {\n            if (!this._map) {\n                return;\n            }\n            if (!this.options.measureTicksShown) {\n                this._clearTicks();\n                return;\n            }\n            var bounds = this._map.getBounds().pad(1),\n                rad = Math.PI / 180,\n                dpi = 96,\n                mercatorMetersPerPixel = 20003931 / (this._map.project([180, 0]).x),\n                referencePoint = this.getLatLngs().length ? this.getBounds().getCenter() : this._map.getCenter(),\n                realMetersPerPixel = mercatorMetersPerPixel * Math.cos(referencePoint.lat * rad),\n                mapScale = 1 / dpi * 2.54 / 100 / realMetersPerPixel,\n                minTicksIntervalMeters = this.options.minTicksIntervalMm / mapScale / 1000,\n                ticks = this.getTicksPositions(minTicksIntervalMeters, bounds),\n                oldTicks = this._ticks;\n            this._ticks = {};\n            ticks.forEach(function(tick) {\n                    var oldMarker = oldTicks[tick.distanceValue.toString()];\n                    this._addTick(tick, oldMarker);\n                    if (oldMarker) {\n                        delete oldTicks[tick.distanceValue.toString()];\n                    }\n                }.bind(this)\n            );\n            Object.values(oldTicks).forEach((tick) => this._map.removeLayer(tick));\n        },\n\n        getLength: function() {\n            var points = this._latlngs,\n                points_n = points.length,\n                length = 0;\n\n            for (var i = 1; i < points_n; i++) {\n                length += points[i].distanceTo(points[i - 1]);\n            }\n            return length;\n        }\n    }\n);\n\nL.measuredLine = function(latlngs, options) {\n    return new L.MeasuredLine(latlngs, options);\n};\n","import L from 'leaflet';\n\nclass RetinaTileLayer extends L.TileLayer {\n    constructor(urls, options, hiRes = 'auto') {\n        let url, tileSizeMultiplicator;\n        const useHiResTiles = hiRes === 'auto' ? L.Browser.retina : hiRes;\n        const newOptions = L.extend({}, options);\n        if (useHiResTiles) {\n            url = urls[1];\n            tileSizeMultiplicator = 2;\n        } else {\n            tileSizeMultiplicator = 1;\n            url = urls[0];\n        }\n        if (options.retinaOptionsOverrides) {\n            L.extend(newOptions, options.retinaOptionsOverrides[useHiResTiles ? 1 : 0]);\n        }\n        super(url, newOptions);\n        this.urls = urls;\n        this.tileSizeMultiplicator = tileSizeMultiplicator;\n    }\n}\n\nexport {RetinaTileLayer};\n","import declination from './declination.json';\nimport {stringToArrayBuffer} from '~/lib/binary-strings';\n\nlet data;\n\nfunction mod(x, n) {\n    return ((x % n) + n) % n;\n}\n\nfunction loadData() {\n    const ar1 = new Uint8Array(stringToArrayBuffer(atob(declination.array)));\n    const ar2 = new Float32Array(ar1.length);\n    const scale = declination.valueScale;\n    const offset = declination.valueOffset;\n    for (let i = 0; i < ar1.length; i++) {\n        ar2[i] = ar1[i] / scale - offset;\n    }\n    return ar2;\n}\n\nfunction getArrayValue(row, col) {\n    if (row < 0 || col < 0 || col >= declination.colsCount || row >= declination.rowsCount) {\n        throw new Error(`Invalid col/row value col=${col} row=${row}`);\n    }\n    const ind = row * declination.colsCount + col;\n    if (ind >= data.length) {\n        throw new Error('Index value out of range');\n    }\n    return data[ind];\n}\n\nfunction getDeclination(lat, lon) {\n    if (lat < declination.minLat || lat > declination.maxLat) {\n        return null;\n    }\n    lon = mod(lon + 180, 360) - 180;\n    const row1 = Math.floor((lat - declination.minLat) / declination.step);\n    const row2 = row1 + 1;\n    const dlat = (lat - (row1 * declination.step + declination.minLat)) / declination.step;\n    let col1 = Math.floor((lon + 180) / declination.step);\n    let col2 = col1 + 1;\n    const dlon = (lon - (col1 * declination.step - 180)) / declination.step;\n    col1 %= declination.colsCount;\n    col2 %= declination.colsCount;\n    let a1 = getArrayValue(row1, col1);\n    let a2 = getArrayValue(row1, col2);\n    const v1 = a1 * (1 - dlon) + a2 * dlon;\n    if (row2 >= declination.rowsCount) {\n        return v1;\n    }\n    a1 = getArrayValue(row2, col1);\n    a2 = getArrayValue(row2, col2);\n    const v2 = a1 * (1 - dlon) + a2 * dlon;\n    const v = v1 * (1 - dlat) + v2 * dlat;\n    return v;\n}\n\ndata = loadData();\n\nexport {getDeclination};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from \"leaflet\";\n\nconst DragEvents = L.Evented.extend({\n        options: {\n            dragTolerance: 2,\n            dragButtons: [0],\n            stopOnLeave: false,\n        },\n\n        initialize: function(element, options) {\n            L.setOptions(this, options);\n            this.element = element;\n\n            this.dragButton = null;\n            this.startEvent = null;\n            this.prevEvent = null;\n            this.isDragging = false;\n\n            L.DomEvent.on(element, 'mousedown', this.onMouseDown, this);\n        },\n\n        onMouseDown: function(e) {\n            if (this.dragButton === null && this.options.dragButtons.includes(e.button)) {\n                this.dragButton = e.button;\n                this.startEvent = e;\n                this.prevEvent = e;\n                L.DomUtil.disableImageDrag();\n                L.DomUtil.disableTextSelection();\n                this._moveHandler = this.onMouseMove.bind(this);\n                document.addEventListener('mousemove', this._moveHandler, true);\n                L.DomEvent.on(document, 'mouseup', this.onMouseUp, this);\n                if (this.options.stopOnLeave) {\n                    L.DomEvent.on(this.element, 'mouseleave', this.onMouseLeave, this);\n                }\n            }\n        },\n\n        onMouseUp: function(e) {\n            if (this.dragButton === e.button) {\n                if (this.isDragging) {\n                    this.fireDragEvent('dragend', e);\n                } else {\n                    this.fire('click', {originalEvent: e, target: this.element});\n                }\n                this.finishDrag();\n            }\n        },\n\n        onMouseMove: function(e) {\n            var that = this;\n            function exceedsTolerance() {\n                var tolerance = that.options.dragTolerance;\n                return Math.abs(e.clientX - that.startEvent.clientX) > tolerance ||\n                    Math.abs(e.clientY - that.startEvent.clientY) > tolerance;\n            }\n\n            if (this.isDragging) {\n                this.fireDragEvent('drag', e);\n                this.prevEvent = e;\n            } else if (this.dragButton !== null && exceedsTolerance()) {\n                this.isDragging = true;\n                this.fireDragEvent('dragstart', this.startEvent);\n                this.fireDragEvent('drag', e);\n                this.prevEvent = e;\n            }\n        },\n\n        onMouseLeave: function(e) {\n            if (this.isDragging) {\n                this.fireDragEvent('dragend', e);\n                this.finishDrag();\n            }\n        },\n\n        fireDragEvent: function(type, originalEvent) {\n            const prevPos = L.point(this.prevEvent.clientX, this.prevEvent.clientY);\n            const pos = L.point(originalEvent.clientX, originalEvent.clientY);\n            const data = {\n                dragButton: this.dragButton,\n                originalEvent,\n                dragMovement: pos.subtract(prevPos) // e.movementX is not available in Safari\n            };\n            this.fire(type, data);\n        },\n\n        finishDrag: function() {\n            this.isDragging = false;\n            this.dragButton = null;\n            L.DomUtil.enableImageDrag();\n            L.DomUtil.enableTextSelection();\n            document.removeEventListener('mousemove', this._moveHandler, true);\n            L.DomEvent.off(document, 'mouseup', this.onMouseUp, this);\n            L.DomEvent.off(this.element, 'mouseleave', this.onMouseLeave, this);\n        }\n    }\n);\n\nexport {DragEvents};\n","function xmlGetNodeText(node) {\n    if (node) {\n        return Array.prototype.slice.call(node.childNodes)\n            .map(function(node) {\n                    return node.nodeValue;\n                }\n            )\n            .join('');\n    }\n    return null;\n}\n\nexport {xmlGetNodeText};\n","(function (GLOBAL) {\n    function decodeUTF8(s){\n        return decodeURIComponent(escape(s));\n    }\n\n    var JSUnzip = function (fileContents) {\n        this.fileContents = new JSUnzip.BigEndianBinaryStream(fileContents);\n    }\n    GLOBAL.JSUnzip = JSUnzip;\n    JSUnzip.MAGIC_NUMBER = 0x04034b50;\n\n    JSUnzip.prototype = {\n        readEntries: function () {\n            if (!this.isZipFile()) {\n                throw new Error(\"File is not a Zip file.\");\n            }\n\n            this.entries = [];\n            var e = new JSUnzip.ZipEntry(this.fileContents);\n            while (typeof(e.data) === \"string\") {\n                this.entries.push(e);\n                e = new JSUnzip.ZipEntry(this.fileContents);\n            }\n        },\n\n        isZipFile: function () {\n            return this.fileContents.getByteRangeAsNumber(0, 4) === JSUnzip.MAGIC_NUMBER;\n        }\n    }\n\n    JSUnzip.ZipEntry = function (binaryStream) {\n        this.signature          = binaryStream.getNextBytesAsNumber(4);\n        if (this.signature !== JSUnzip.MAGIC_NUMBER) {\n            return;\n        }\n\n        this.versionNeeded      = binaryStream.getNextBytesAsNumber(2);\n        this.bitFlag            = binaryStream.getNextBytesAsNumber(2);\n        this.compressionMethod  = binaryStream.getNextBytesAsNumber(2);\n        this.timeBlob           = binaryStream.getNextBytesAsNumber(4);\n\n        if (this.isEncrypted()) {\n            throw \"File contains encrypted entry. Not supported.\";\n        }\n\n\n        this.crc32              = binaryStream.getNextBytesAsNumber(4);\n        this.compressedSize     = binaryStream.getNextBytesAsNumber(4);\n        this.uncompressedSize   = binaryStream.getNextBytesAsNumber(4);\n\n        if (this.isUsingZip64()) {\n            throw \"File is using Zip64 (4gb+ file size). Not supported\";\n        }\n\n        this.fileNameLength     = binaryStream.getNextBytesAsNumber(2);\n        this.extraFieldLength   = binaryStream.getNextBytesAsNumber(2);\n\n        this.fileName  = binaryStream.getNextBytesAsString(this.fileNameLength);\n        this.extra     = binaryStream.getNextBytesAsString(this.extraFieldLength);\n        this.data      = binaryStream.getNextBytesAsString(this.compressedSize);\n\n        if (this.isUsingBit3TrailingDataDescriptor()) {\n            if (typeof(console) !== \"undefined\") {\n                console.log( \"File is using bit 3 trailing data descriptor. Not supported.\");\n            }\n            binaryStream.getNextBytesAsNumber(16);  //Skip the descriptor and move to beginning of next ZipEntry\n        }\n\n        if (this.isUsingUtf8()) {\n            this.fileName = decodeUTF8(this.fileName);\n        }\n\n    }\n\n    JSUnzip.ZipEntry.prototype = {\n        isEncrypted: function () {\n            return (this.bitFlag & 0x01) === 0x01;\n        },\n\n        isUsingUtf8: function () {\n            return (this.bitFlag & 0x0800) === 0x0800;\n        },\n\n        isUsingBit3TrailingDataDescriptor: function () {\n            return (this.bitFlag & 0x0008) === 0x0008;\n        },\n\n        isUsingZip64: function () {\n            return this.compressedSize === 0xFFFFFFFF ||\n                this.uncompressedSize === 0xFFFFFFFF;\n        }\n    }\n\n    JSUnzip.BigEndianBinaryStream = function (stream) {\n        this.stream = stream;\n        this.resetByteIndex();\n    }\n\n    JSUnzip.BigEndianBinaryStream.prototype = {\n        // The index of the current byte, used when we step through the byte\n        // with getNextBytesAs*.\n        resetByteIndex: function () {\n            this.currentByteIndex = 0;\n        },\n\n        getByteAt: function (index) {\n            return this.stream.charCodeAt(index);\n        },\n\n        getNextBytesAsNumber: function (steps) {\n            var res = this.getByteRangeAsNumber(this.currentByteIndex, steps);\n            this.currentByteIndex += steps;\n            return res;\n        },\n\n        getNextBytesAsString: function (steps) {\n            var res = this.getByteRangeAsString(this.currentByteIndex, steps);\n            this.currentByteIndex += steps;\n            return res;\n        },\n\n        // Big endian, so we're going backwards.\n        getByteRangeAsNumber: function (index, steps) {\n            var result = 0;\n            var i = index + steps - 1;\n            while (i >= index) {\n                result = (result << 8) + this.getByteAt(i);\n                i--;\n            }\n            return result;\n        },\n\n        getByteRangeAsString: function (index, steps) {\n            var result = \"\";\n            var max = index + steps;\n            var i = index;\n            while (i < max) {\n                var charCode = this.getByteAt(i);\n                result += String.fromCharCode(charCode);\n                // Accounting for multi-byte strings.\n                max -= Math.floor(charCode / 0x100);\n                i++;\n            }\n            return result;\n        }\n    }\n}(this));\n","import tynyInflate from 'tiny-inflate';\nimport {stringToArrayBuffer, arrayBufferToString} from '~/lib/binary-strings';\n\nfunction jsInflate(compressed, originalSize) {\n    if (originalSize === 0) {\n        return '';\n    }\n    const out = new Uint8Array(originalSize);\n    tynyInflate(new Uint8Array(stringToArrayBuffer(compressed)), out);\n    return arrayBufferToString(out);\n}\n\nexport default jsInflate;\n","function decode866(s) {\n    var c, i,\n        s2 = [];\n    for (i = 0; i < s.length; i++) {\n        c = s.charCodeAt(i);\n        if (c >= 128 && c <= 175) {\n            c += (0x410 - 128);\n        } else if (c >= 224 && c <= 239) {\n            c += (0x440 - 224);\n        } else if (c === 240) {\n            c = 0x0401;\n        } else if (c === 241) {\n            c = 0x0451;\n        }\n        s2.push(String.fromCharCode(c));\n    }\n    return s2.join('');\n}\n\nfunction decodeCP1251(s) {\n    var c, i,\n        s2 = [];\n    for (i = 0; i < s.length; i++) {\n        c = s.charCodeAt(i);\n        if (c >= 192 && c <= 255) {\n            c += (0x410 - 192);\n        } else if (c === 168) {\n            c = 0x0401;\n        } else if (c === 184) {\n            c = 0x0451;\n        }\n        s2.push(String.fromCharCode(c));\n    }\n    return s2.join('');\n}\n\nexport {decode866, decodeCP1251};\n\n","import BaseService from '../baseService';\nimport {parseNktkSequence, parseTrackUrlData, parseNktkFragment} from '../../parsers/nktk';\nimport config from '~/config';\nimport {parseHashParams} from '~/lib/leaflet.hashState/hashState';\nimport loadFromUrl from '../../loadFromUrl';\nimport loadTracksFromJson from './loadTracksFromJson';\nimport {fetch} from '~/lib/xhr-promise';\n\nfunction flattenArray(ar) {\n    const res = [];\n    for (const it of ar) {\n        res.push(...it);\n    }\n    return res;\n}\n\nfunction parsePointFromHashValues(values) {\n    if (values.length < 2) {\n        return [{name: 'Point in url', error: 'CORRUPT'}];\n    }\n    const lat = parseFloat(values[0]);\n    const lng = parseFloat(values[1]);\n    if (isNaN(lat) || isNaN(lng) || lat < -90 || lat > 90 || lng < -180 || lng > 180) {\n        return [{name: 'Point in url', error: 'CORRUPT'}];\n    }\n    const name = ((values[2] || '').trim()) || 'Point';\n    return [{name, points: [{name, lat, lng}]}];\n}\n\nclass NakarteTrack extends BaseService {\n    isOurUrl() {\n        return this.origUrl.indexOf('track://') > -1;\n    }\n\n    requestOptions() {\n        return [];\n    }\n\n    parseResponse() {\n        const i = this.origUrl.indexOf('track://');\n        return parseTrackUrlData(this.origUrl.substring(i + 8));\n    }\n}\n\nclass NakarteUrlLoader {\n    constructor() {\n        this.loaders = {\n            nktk: this.loadFromTextEncodedTrack,\n            nktl: this.loadFromTextEncodedTrackId,\n            nktu: this.loadFromUrlencodedUrls,\n            nktp: this.loadPoint,\n            nktj: this.loadFromJSON\n        };\n    }\n\n    paramNames() {\n        return Object.keys(this.loaders);\n    }\n\n    async geoData(paramName, values) {\n        const loader = this.loaders[paramName];\n        return loader.call(this, values);\n    }\n\n    async loadFromTextEncodedTrack(values) {\n        return flattenArray(values.map(parseNktkFragment));\n    }\n\n    async loadFromTextEncodedTrackId(values) {\n        const requests = values.map((trackId) =>\n            fetch( `${config.tracksStorageServer}/${trackId}`, {\n                responseType: 'binarystring',\n                method: 'POST',\n                withCredentials: false\n            } )\n        );\n        let responses;\n        try {\n            responses = await Promise.all(requests);\n        } catch (e) {\n            return [{name: 'Track from nakarte server', error: 'NETWORK'}];\n        }\n        return flattenArray(responses.map((r) => parseNktkSequence(r.responseBinaryText, 'shared')));\n    }\n\n    async loadFromJSON(values) {\n        return flattenArray(await Promise.all(values.map(loadTracksFromJson)));\n    }\n\n    async loadFromUrlencodedUrls(values) {\n        return flattenArray(await Promise.all(values.map(decodeURIComponent).map(loadFromUrl)));\n    }\n\n    async loadPoint(values) {\n        return parsePointFromHashValues(values.map(decodeURIComponent));\n    }\n}\n\nclass NakarteUrl {\n    constructor(url) {\n        const paramNames = new NakarteUrlLoader().paramNames();\n        this._params = Object.entries(parseHashParams(url))\n            .filter(([name]) => paramNames.includes(name));\n    }\n\n    isOurUrl() {\n        return this._params.length > 0;\n    }\n\n    async geoData() {\n        const promises = this._params.map(([paramName, value]) => new NakarteUrlLoader().geoData(paramName, value));\n        return flattenArray(await Promise.all(promises));\n    }\n}\n\nexport {NakarteTrack, NakarteUrl, NakarteUrlLoader};\n","function encode(s) {\n    return (btoa(s)\n            .replace(/\\+/ug, '-')\n            .replace(/\\//ug, '_')\n        // .replace(/=+$/, '')\n    );\n}\n\nfunction decode(s) {\n    var decoded;\n    s = s\n        .replace(/[\\n\\r \\t]/ug, '')\n        .replace(/-/ug, '+')\n        .replace(/_/ug, '/');\n    try {\n        decoded = atob(s);\n    } catch (e) {\n        // will return null for malformed data\n    }\n    if (decoded && decoded.length) {\n        return decoded;\n    }\n    return null;\n}\n\nexport {encode, decode};\n","import L from 'leaflet';\nimport './elevation-profile.css';\nimport {ElevationProvider} from '~/lib/elevations';\nimport '~/lib/leaflet.control.commons';\nimport {notify} from '~/lib/notifications';\nimport * as logging from '~/lib/logging';\nimport {DragEvents} from '~/lib/leaflet.events.drag';\n\nfunction calcSamplingInterval(length) {\n    var targetPointsN = 2000;\n    var maxPointsN = 9999;\n    var samplingIntgerval = length / targetPointsN;\n    if (samplingIntgerval < 10) {\n        samplingIntgerval = 10;\n    }\n    if (samplingIntgerval > 50) {\n        samplingIntgerval = 50;\n    }\n    if (length / samplingIntgerval > maxPointsN) {\n        samplingIntgerval = length / maxPointsN;\n    }\n    return samplingIntgerval;\n}\n\nfunction createSvg(tagName, attributes, parent) {\n    var element = document.createElementNS('http://www.w3.org/2000/svg', tagName);\n    if (attributes) {\n        var keys = Object.keys(attributes),\n            key, value;\n        for (var i = 0; i < keys.length; i++) {\n            key = keys[i];\n            value = attributes[key];\n            element.setAttribute(key, value);\n        }\n    }\n    if (parent) {\n        parent.appendChild(element);\n    }\n    return element;\n}\n\nfunction pointOnSegmentAtDistance(p1, p2, dist) {\n    // FIXME: we should place markers along projected line to avoid transformation distortions\n    var q = dist / p1.distanceTo(p2),\n        x = p1.lng + (p2.lng - p1.lng) * q,\n        y = p1.lat + (p2.lat - p1.lat) * q;\n    return L.latLng(y, x);\n}\n\nfunction gradientToAngle(g) {\n    return Math.round(Math.atan(g) * 180 / Math.PI);\n}\n\nfunction pathRegularSamples(latlngs, step) {\n    if (!latlngs.length) {\n        return [];\n    }\n    var samples = [],\n        lastSampleDist = 0,\n        lastPointDistance = 0,\n        nextPointDistance = 0,\n        segmentLength, i;\n\n    samples.push(latlngs[0]);\n    for (i = 1; i < latlngs.length; i++) {\n        segmentLength = latlngs[i].distanceTo(latlngs[i - 1]);\n        nextPointDistance = lastPointDistance + segmentLength;\n        if (nextPointDistance >= lastSampleDist + step) {\n            while (lastSampleDist + step <= nextPointDistance) {\n                lastSampleDist += step;\n                samples.push(\n                    pointOnSegmentAtDistance(latlngs[i - 1], latlngs[i], lastSampleDist - lastPointDistance)\n                );\n            }\n        }\n        lastPointDistance = nextPointDistance;\n    }\n    if (samples.length < 2) {\n        samples.push(latlngs[latlngs.length - 1]);\n    }\n    return samples;\n}\n\nconst ElevationProfile = L.Class.extend({\n        options: {\n            samplingInterval: 50,\n            sightLine: false\n        },\n\n        includes: L.Evented,\n\n        initialize: function(map, latlngs, options) {\n            L.setOptions(this, options);\n            this.path = latlngs;\n            var samples = this.samples = pathRegularSamples(this.path, this.options.samplingInterval);\n            samples = samples.map((latlng) => latlng.wrap());\n            if (!samples.length) {\n                notify('Track is empty');\n                return;\n            }\n            let crimea_bounds = L.latLngBounds( L.latLng( [44.288469027276506, 36.66412353515624] ), L.latLng( [46.02366774426006, 32.3876953125] ) );\n            for (let i=0; i<samples.length; i+=50) {\n                if ( ! crimea_bounds.contains( L.latLng( samples[i] ) ) ) {\n                    notify( 'Трэк частично или полностью находится за пределами Крыма. Построение профиля высоты работает только в пределах полуострова.' );\n                    return false;\n                }\n            }\n\n            let that = this;\n            this.horizZoom = 1;\n            this.dragStart = null;\n            new ElevationProvider().get(samples)\n                .then(function(values) {\n                        that.values = values;\n                        that._addTo(map);\n                    }\n                )\n                .catch((e) => {\n                    logging.captureException(e, 'error getting elevation');\n                    notify(`Failed to get elevation data: ${e.message}`);\n                });\n            this.values = null;\n        },\n\n        _onWindowResize: function() {\n            this._resizeGraph();\n        },\n\n        _resizeGraph: function() {\n            const newSvgWidth = this.drawingContainer.clientWidth * this.horizZoom;\n            if (this.svgWidth < this.drawingContainer.clientWidth) {\n                this.svgWidth = newSvgWidth;\n                this.svg.setAttribute('width', this.svgWidth + 'px');\n                this.updateGraph();\n                this.updateGraphSelection();\n            }\n        },\n\n        _addTo: function(map) {\n            this._map = map;\n            var container = this._container = L.DomUtil.create('div', 'elevation-profile-container');\n            L.Control.prototype._stopContainerEvents.call(this);\n            this._map._controlContainer.appendChild(container);\n            this.setupContainerLayout();\n            this.updateGraph();\n            const icon = L.divIcon({\n                    className: 'elevation-profile-marker',\n                    html:\n                        '<div class=\"elevation-profile-marker-icon\"></div>' +\n                        '<div class=\"elevation-profile-marker-label\"></div>'\n                }\n            );\n            this.trackMarker = L.marker([1000, 0], {interactive: false, icon: icon});\n            this.polyline = L.polyline(this.path, {weight: 30, opacity: 0}).addTo(map);\n            this.polyline.on('mousemove', this.onLineMouseMove, this);\n            this.polyline.on('mouseover', this.onLineMouseEnter, this);\n            this.polyline.on('mouseout', this.onLineMouseLeave, this);\n            this.polyLineSelection = L.polyline([], {weight: 20, opacity: 0.5, color: 'yellow', lineCap: 'butt'});\n            return this;\n        },\n\n        setupContainerLayout: function() {\n            var horizZoom = this.horizZoom = 1;\n            var container = this._container;\n            this.propsContainer = L.DomUtil.create('div', 'elevation-profile-properties', container);\n            this.leftAxisLables = L.DomUtil.create('div', 'elevation-profile-left-axis', container);\n            this.closeButton = L.DomUtil.create('div', 'elevation-profile-close', container);\n            L.DomEvent.on(this.closeButton, 'click', this.onCloseButtonClick, this);\n            this.drawingContainer = L.DomUtil.create('div', 'elevation-profile-drawingContainer', container);\n            this.graphCursor = L.DomUtil.create('div', 'elevation-profile-cursor elevation-profile-cursor-hidden',\n                this.drawingContainer\n            );\n            this.graphCursorLabel =\n                L.DomUtil.create('div', 'elevation-profile-cursor-label elevation-profile-cursor-hidden',\n                    this.drawingContainer\n                );\n            this.graphSelection = L.DomUtil.create('div', 'elevation-profile-selection elevation-profile-cursor-hidden',\n                this.drawingContainer\n            );\n            var svgWidth = this.svgWidth = this.drawingContainer.clientWidth * horizZoom,\n                svgHeight = this.svgHeight = this.drawingContainer.clientHeight;\n            var svg = this.svg = createSvg('svg', {width: svgWidth, height: svgHeight}, this.drawingContainer);\n            L.DomEvent.on(svg, 'mousemove', this.onSvgMouseMove, this);\n            // We should handle mouseenter event, but due to a\n            // bug in Chrome (https://bugs.chromium.org/p/chromium/issues/detail?id=846738)\n            // this event is emitted while resizing window by dragging right window frame\n            // which causes cursor to appeat while resizing\n            L.DomEvent.on(svg, 'mousemove', this.onSvgEnter, this);\n            L.DomEvent.on(svg, 'mouseleave', this.onSvgLeave, this);\n            L.DomEvent.on(svg, 'mousewheel', this.onSvgMouseWheel, this);\n            this.svgDragEvents = new DragEvents(this.svg, {dragButtons: [0, 2], stopOnLeave: true});\n            this.svgDragEvents.on('dragstart', this.onSvgDragStart, this);\n            this.svgDragEvents.on('dragend', this.onSvgDragEnd, this);\n            this.svgDragEvents.on('drag', this.onSvgDrag, this);\n            this.svgDragEvents.on('click', this.onSvgClick, this);\n            L.DomEvent.on(svg, 'dblclick', this.onSvgDblClick, this);\n            L.DomEvent.on(window, 'resize', this._onWindowResize, this);\n        },\n\n        removeFrom: function(map) {\n            if (this.abortLoading) {\n                this.abortLoading();\n            }\n            if (!this._map) {\n                return this;\n            }\n            this._map._controlContainer.removeChild(this._container);\n            map.removeLayer(this.polyline);\n            map.removeLayer(this.trackMarker);\n            map.removeLayer(this.polyLineSelection);\n            L.DomEvent.off(window, 'resize', this._onWindowResize, this);\n            this._map = null;\n            return this;\n        },\n\n        onSvgDragStart: function(e) {\n            if (e.dragButton === 0) {\n                // FIXME: restore hiding when we make display of selection on map\n                // this.cursorHide();\n                this.polyLineSelection.addTo(this._map).bringToBack();\n                this.selStartIndex = this.roundedSampleIndexFromMouseEvent(e);\n            }\n        },\n\n        graphContainerOffsetFromMouseEvent: function(e) {\n            if (e.originalEvent) {\n                e = e.originalEvent;\n            }\n            let x = e.clientX - this.svg.getBoundingClientRect().left;\n            if (x < 0) {\n                x = 0;\n            }\n            if (x > this.svgWidth - 1) {\n                x = this.svgWidth - 1;\n            }\n            return x;\n        },\n\n        sampleIndexFromMouseEvent: function(e) {\n            const x = this.graphContainerOffsetFromMouseEvent(e);\n            return x / (this.svgWidth - 1) * (this.values.length - 1);\n        },\n\n        roundedSampleIndexFromMouseEvent: function(e) {\n            return Math.round(this.sampleIndexFromMouseEvent(e));\n        },\n\n        setTrackMarkerLabel: function(label) {\n            const icon = this.trackMarker._icon;\n            if (!icon) {\n                return;\n            }\n            icon.getElementsByClassName('elevation-profile-marker-label')[0].innerHTML = label;\n        },\n\n        setGraphSelection: function(cursorIndex) {\n            this.selMinInd = Math.min(cursorIndex, this.selStartIndex);\n            this.selMaxInd = Math.max(cursorIndex, this.selStartIndex);\n\n            if (this.selMinInd < 0) {\n                this.selMinInd = 0;\n            }\n            if (this.selMaxInd > this.values.length - 1) {\n                this.selMaxInd = this.values.length - 1;\n            }\n            this.updateGraphSelection();\n            L.DomUtil.removeClass(this.graphSelection, 'elevation-profile-cursor-hidden');\n        },\n\n        updateGraphSelection: function() {\n            const selStart = this.selMinInd * (this.svgWidth - 1) / (this.values.length - 1);\n            const selEnd = this.selMaxInd * (this.svgWidth - 1) / (this.values.length - 1);\n            this.graphSelection.style.left = selStart + 'px';\n            this.graphSelection.style.width = (selEnd - selStart) + 'px';\n        },\n\n        onSvgDragEnd: function(e) {\n            if (e.dragButton === 0) {\n                this.cursorShow();\n                this.setGraphSelection(this.roundedSampleIndexFromMouseEvent(e));\n                var stats = this.calcProfileStats(this.values.slice(this.selMinInd, this.selMaxInd + 1));\n                this.updatePropsDisplay(stats);\n                L.DomUtil.addClass(this.propsContainer, 'elevation-profile-properties-selected');\n            }\n            if (e.dragButton === 2) {\n                this.drawingContainer.scrollLeft -= e.dragMovement.x;\n            }\n        },\n\n        onSvgDrag: function(e) {\n            if (e.dragButton === 0) {\n                this.setGraphSelection(this.roundedSampleIndexFromMouseEvent(e));\n                this.polyLineSelection.setLatLngs(this.samples.slice(this.selMinInd, this.selMaxInd + 1));\n            }\n            if (e.dragButton === 2) {\n                this.drawingContainer.scrollLeft -= e.dragMovement.x;\n            }\n        },\n\n        onSvgClick: function(e) {\n            const button = e.originalEvent.button;\n            if (button === 0) {\n                this.dragStart = null;\n                L.DomUtil.addClass(this.graphSelection, 'elevation-profile-cursor-hidden');\n                L.DomUtil.removeClass(this.propsContainer, 'elevation-profile-properties-selected');\n                this._map.removeLayer(this.polyLineSelection);\n                if (this.stats) {\n                    this.updatePropsDisplay(this.stats);\n                }\n            }\n            if (button === 2) {\n                this.setMapPositionAtIndex(this.roundedSampleIndexFromMouseEvent(e));\n            }\n        },\n\n        onSvgDblClick: function(e) {\n            this.setMapPositionAtIndex(this.roundedSampleIndexFromMouseEvent(e));\n        },\n\n        setMapPositionAtIndex: function(ind) {\n            var latlng = this.samples[ind];\n            if (latlng) {\n                this._map.panTo(latlng);\n            }\n        },\n\n        onSvgMouseWheel: function(e) {\n            var oldHorizZoom = this.horizZoom;\n            this.horizZoom += L.DomEvent.getWheelDelta(e) > 0 ? 1 : -1;\n            if (this.horizZoom < 1) {\n                this.horizZoom = 1;\n            }\n            if (this.horizZoom > 10) {\n                this.horizZoom = 10;\n            }\n\n            var ind = this.sampleIndexFromMouseEvent(e);\n\n            var newScrollLeft = this.drawingContainer.scrollLeft +\n                this.graphContainerOffsetFromMouseEvent(e) * (this.horizZoom / oldHorizZoom - 1);\n            if (newScrollLeft < 0) {\n                newScrollLeft = 0;\n            }\n\n            this.svgWidth = this.drawingContainer.clientWidth * this.horizZoom;\n            this.svg.setAttribute('width', this.svgWidth + 'px');\n            this.setupGraph();\n            if (newScrollLeft > this.svgWidth - this.drawingContainer.clientWidth) {\n                newScrollLeft = this.svgWidth - this.drawingContainer.clientWidth;\n            }\n            this.drawingContainer.scrollLeft = newScrollLeft;\n\n            this.cursorHide();\n            this.setCursorPosition(ind);\n            this.cursorShow();\n            this.updateGraphSelection();\n        },\n\n        updateGraph: function() {\n            if (!this._map || !this.values) {\n                return;\n            }\n\n            this.stats = this.calcProfileStats(this.values);\n            this.updatePropsDisplay(this.stats);\n            this.setupGraph();\n        },\n\n        updatePropsDisplay: function(stats) {\n            if (!this._map) {\n                return;\n            }\n            let d;\n            if (stats.noData) {\n                d = {\n                    maxElev: '-',\n                    minElev: '-',\n                    startElev: '-',\n                    endElev: '-',\n                    change: '-',\n                    ascentAngleStr: '-',\n                    descentAngleStr: '-',\n                    ascent: '-',\n                    descent: '-',\n                    startApprox: '',\n                    endApprox: '',\n                    approx: '',\n                    incomplete: 'No elevation data',\n                };\n            } else {\n                d = {\n                    maxElev: Math.round(stats.max),\n                    minElev: Math.round(stats.min),\n                    startElev: Math.round(stats.start),\n                    endElev: Math.round(stats.end),\n                    change: Math.round(stats.finalAscent),\n                    ascentAngleStr: isNaN(stats.angleAvgAscent) ? '-' : L.Util.template('{avg} / {max}&deg;',\n                            {avg: stats.angleAvgAscent, max: stats.angleMaxAscent}\n                        ),\n                    descentAngleStr: isNaN(stats.angleAvgDescent) ? '-' : L.Util.template('{avg} / {max}&deg;',\n                            {avg: stats.angleAvgDescent, max: stats.angleMaxDescent}\n                        ),\n                    ascent: Math.round(stats.ascent),\n                    descent: Math.round(stats.descent),\n                    dist: (stats.distance / 1000).toFixed(1),\n                    startApprox: stats.dataLostAtStart > 0.02 ? '~ ' : '',\n                    endApprox: stats.dataLostAtEnd > 0.02 ? '~ ' : '',\n                    approx: stats.dataLost > 0.02 ? '~ ' : '',\n                    incomplete: stats.dataLost > 0.02 ? 'Some elevation data missing' : '',\n                };\n            }\n            d.dist = (stats.distance / 1000).toFixed(1);\n\n            this.propsContainer.innerHTML = `\n                <table>\n                <tr><td>Максимальная высота:</td><td>${d.maxElev}</td></tr>\n                <tr><td>Минимальная высота:</td><td>${d.minElev}</td></tr>\n                <tr class=\"start-group\"><td>Высота в начале:</td><td>${d.startApprox}${d.startElev}</td></tr>\n                <tr><td>Высота в конце:</td><td>${d.endApprox}${d.endElev}</td></tr>\n                <tr><td>Разница:</td><td>${d.startApprox || d.endApprox}${d.change}</td></tr>\n                <tr class=\"start-group\"><td>Сред. / Макс. наклон подъёма:</td><td>${d.ascentAngleStr}</td></tr>\n                <tr><td>Сред. / Макс. наклон спуска:</td><td>${d.descentAngleStr}</td></tr>\n                <tr class=\"start-group\"><td>Набор высоты:</td><td>${d.approx}${d.ascent}</td></tr>\n                <tr><td>Сброс высоты:</td><td>${d.approx}${d.descent}</td></tr>\n                <tr class=\"start-group\"><td>Дистанция:</td><td>${d.dist} km</td></tr>\n                <tr><td colspan=\"2\" style=\"text-align: center\">${d.incomplete}</td></tr>\n                </table>\n                `;\n        },\n\n        calcGridValues: function(minValue, maxValue) {\n            var ticksNs = [3, 4, 5],\n                tickSteps = [1, 2, 5, 10, 20, 50, 100, 200, 500, 1000, 2000, 5000, 10000],\n                ticks = [],\n                i, j, k, ticksN, tickStep, tick1, tick2,\n                matchFound = false;\n\n            for (i = 0; i < tickSteps.length; i++) {\n                tickStep = tickSteps[i];\n                for (j = 0; j < ticksNs.length; j++) {\n                    ticksN = ticksNs[j];\n                    tick1 = Math.floor(minValue / tickStep);\n                    tick2 = Math.ceil(maxValue / tickStep);\n                    if ((tick2 - tick1) < ticksN) {\n                        matchFound = true;\n                        break;\n                    }\n                }\n                if (matchFound) {\n                    break;\n                }\n            }\n            for (k = tick1; k < tick1 + ticksN; k++) {\n                ticks.push(k * tickStep);\n            }\n            return ticks;\n        },\n\n        filterElevations: function(values, tolerance) {\n            var filtered = values.slice(0);\n            if (filtered.length < 3) {\n                return filtered;\n            }\n            var scanStart, scanEnd, job, linearValue, linearDelta, maxError, maxErrorInd, i, error;\n            var queue = [[0, filtered.length - 1]];\n            while (queue.length) {\n                job = queue.pop();\n                scanStart = job[0];\n                scanEnd = job[1];\n                linearValue = filtered[scanStart];\n                linearDelta = (filtered[scanEnd] - filtered[scanStart]) / (scanEnd - scanStart);\n                maxError = null;\n                maxErrorInd = null;\n                for (i = scanStart + 1; i < scanEnd; i++) {\n                    linearValue += linearDelta;\n                    if (filtered[i] === null) {\n                        continue;\n                    }\n                    error = Math.abs(filtered[i] - linearValue);\n                    if (error === null || error > maxError) {\n                        maxError = error;\n                        maxErrorInd = i;\n                    }\n                }\n                if (maxError > tolerance) {\n                    if (scanEnd > scanStart + 2) {\n                        queue.push([scanStart, maxErrorInd]);\n                        queue.push([maxErrorInd, scanEnd]);\n                    }\n                } else {\n                    filtered.splice(scanStart + 1, scanEnd - scanStart - 1);\n                }\n            }\n            return filtered;\n        },\n\n        calcProfileStats: function(values) {\n            const stats = {\n                distance: (values.length - 1) * this.options.samplingInterval\n            };\n            const notNullValues = values.filter((value) => value !== null);\n            if (notNullValues.length === 0) {\n                stats.noData = true;\n                return stats;\n            }\n            stats.min = Math.min(...notNullValues);\n            stats.max = Math.max(...notNullValues);\n            let firstNotNullIndex = true,\n                lastNotNullIndex = true,\n                firstNotNullValue,\n                lastNotNullValue;\n            for (let i = 0; i < values.length; i++) {\n                let value = values[i];\n                if (value !== null) {\n                    firstNotNullValue = value;\n                    firstNotNullIndex = i;\n                    break;\n                }\n            }\n            for (let i = values.length - 1; i >= 0; i--) {\n                let value = values[i];\n                if (value !== null) {\n                    lastNotNullValue = value;\n                    lastNotNullIndex = i;\n                    break;\n                }\n            }\n            stats.finalAscent = lastNotNullValue - firstNotNullValue;\n\n            const ascents = [],\n                descents = [];\n            let prevNotNullValue = values[firstNotNullIndex],\n                prevNotNullIndex = firstNotNullIndex;\n            for (let i = firstNotNullIndex + 1; i <= lastNotNullIndex; i++) {\n                let value = values[i];\n                if (value === null) {\n                    continue;\n                }\n                let length = i - prevNotNullIndex;\n                let gradient = (value - prevNotNullValue) / length;\n                if (gradient > 0) {\n                    for (let j = 0; j < length; j++) {\n                        ascents.push(gradient);\n                    }\n                } else if (gradient < 0) {\n                    for (let j = 0; j < length; j++) {\n                        descents.push(-gradient);\n                    }\n                }\n                prevNotNullIndex = i;\n                prevNotNullValue = value;\n            }\n            function sum(a, b) {\n                return a + b;\n            }\n            if (ascents.length !== 0) {\n                stats.gradientAvgAscent = ascents.reduce(sum, 0) / ascents.length / this.options.samplingInterval;\n                stats.gradientMinAscent = Math.min(...ascents) / this.options.samplingInterval;\n                stats.gradientMaxAscent = Math.max(...ascents) / this.options.samplingInterval;\n                stats.angleAvgAscent = gradientToAngle(stats.gradientAvgAscent);\n                stats.angleMinAscent = gradientToAngle(stats.gradientMinAscent);\n                stats.angleMaxAscent = gradientToAngle(stats.gradientMaxAscent);\n            }\n            if (descents.length !== 0) {\n                stats.gradientAvgDescent = descents.reduce(sum, 0) / descents.length / this.options.samplingInterval;\n                stats.gradientMinDescent = Math.min(...descents) / this.options.samplingInterval;\n                stats.gradientMaxDescent = Math.max(...descents) / this.options.samplingInterval;\n                stats.angleAvgDescent = gradientToAngle(stats.gradientAvgDescent);\n                stats.angleMinDescent = gradientToAngle(stats.gradientMinDescent);\n                stats.angleMaxDescent = gradientToAngle(stats.gradientMaxDescent);\n            }\n\n            stats.start = firstNotNullValue;\n            stats.end = lastNotNullValue;\n            stats.distance = (values.length - 1) * this.options.samplingInterval;\n            stats.dataLostAtStart = firstNotNullIndex / values.length;\n            stats.dataLostAtEnd = 1 - lastNotNullIndex / (values.length - 1);\n            stats.dataLost = 1 - notNullValues.length / values.length;\n\n            const filterTolerance = 5;\n            const filtered = this.filterElevations(values.slice(firstNotNullIndex, lastNotNullIndex), filterTolerance);\n            let ascent = 0,\n                descent = 0,\n                delta;\n            for (let i = 1; i < filtered.length; i++) {\n                delta = filtered[i] - filtered[i - 1];\n                if (delta < 0) {\n                    descent += -delta;\n                } else {\n                    ascent += delta;\n                }\n            }\n            stats.ascent = ascent;\n            stats.descent = descent;\n\n            return stats;\n        },\n\n        setCursorPosition: function(ind) {\n            if (!this._map || !this.values) {\n                return;\n            }\n            const samplingInterval = this.options.samplingInterval;\n            const distanceKm = samplingInterval * ind / 1000;\n            const distanceStr = `${distanceKm.toFixed(2)} km`;\n            const sample1 = this.values[Math.ceil(ind)];\n            const sample2 = this.values[Math.floor(ind)];\n            let angleStr;\n            if (sample1 !== null && sample2 !== null) {\n                const gradient = (sample2 - sample1) / samplingInterval;\n                angleStr = `${Math.round(Math.atan(gradient) * 180 / Math.PI)}&deg`;\n            } else {\n                angleStr = '-';\n            }\n\n            const x = Math.round(ind / (this.values.length - 1) * (this.svgWidth - 1));\n            const indInt = Math.round(ind);\n            let elevation = this.values[indInt];\n            if (elevation === null) {\n                elevation = sample1;\n            }\n            if (elevation === null) {\n                elevation = sample2;\n            }\n            const elevationStr = (elevation === null) ? '-' : `${elevation} m`;\n\n            const cursorLabel = `${elevationStr}<br>${distanceStr}<br>${angleStr}`;\n\n            this.graphCursorLabel.innerHTML = cursorLabel;\n\n            this.graphCursor.style.left = x + 'px';\n            this.graphCursorLabel.style.left = x + 'px';\n            if (this.drawingContainer.getBoundingClientRect().left - this.drawingContainer.scrollLeft + x +\n                this.graphCursorLabel.offsetWidth >= this.drawingContainer.getBoundingClientRect().right) {\n                L.DomUtil.addClass(this.graphCursorLabel, 'elevation-profile-cursor-label-left');\n            } else {\n                L.DomUtil.removeClass(this.graphCursorLabel, 'elevation-profile-cursor-label-left');\n            }\n\n            let markerPos;\n            if (ind <= 0) {\n                markerPos = this.samples[0];\n            } else if (ind >= this.samples.length - 1) {\n                markerPos = this.samples[this.samples.length - 1];\n            } else {\n                const p1 = this.samples[Math.floor(ind)],\n                    p2 = this.samples[Math.ceil(ind)],\n                    indFrac = ind - Math.floor(ind);\n                markerPos = [p1.lat + (p2.lat - p1.lat) * indFrac, p1.lng + (p2.lng - p1.lng) * indFrac];\n            }\n            this.trackMarker.setLatLng(markerPos);\n\n            this.setTrackMarkerLabel(cursorLabel);\n        },\n\n        onSvgMouseMove: function(e) {\n            if (!this.values) {\n                return;\n            }\n            this.setCursorPosition(this.sampleIndexFromMouseEvent(e));\n        },\n\n        cursorShow: function() {\n            L.DomUtil.removeClass(this.graphCursor, 'elevation-profile-cursor-hidden');\n            L.DomUtil.removeClass(this.graphCursorLabel, 'elevation-profile-cursor-hidden');\n            this._map.addLayer(this.trackMarker);\n        },\n\n        cursorHide: function() {\n            L.DomUtil.addClass(this.graphCursor, 'elevation-profile-cursor-hidden');\n            L.DomUtil.addClass(this.graphCursorLabel, 'elevation-profile-cursor-hidden');\n            this._map.removeLayer(this.trackMarker);\n        },\n\n        onSvgEnter: function() {\n            this.cursorShow();\n        },\n\n        onSvgLeave: function() {\n            this.cursorHide();\n        },\n\n        onLineMouseEnter: function() {\n            this.cursorShow();\n        },\n\n        onLineMouseLeave: function() {\n            this.cursorHide();\n        },\n\n        onLineMouseMove: function(e) {\n            function sqrDist(latlng1, latlng2) {\n                var dx = (latlng1.lng - latlng2.lng);\n                var dy = (latlng1.lat - latlng2.lat);\n                return dx * dx + dy * dy;\n            }\n\n            var nearestInd = null,\n                ind,\n                minDist = null,\n                mouseLatlng = e.latlng,\n                i, sampleLatlng, dist, di;\n            let nextDist,\n                nextSampleDist,\n                prevDist,\n                prevSampleDist;\n            for (i = 0; i < this.samples.length; i++) {\n                sampleLatlng = this.samples[i];\n                dist = sqrDist(sampleLatlng, mouseLatlng);\n                if (nearestInd === null || dist < minDist) {\n                    nearestInd = i;\n                    minDist = dist;\n                }\n            }\n\n            if (nearestInd !== null) {\n                ind = nearestInd;\n                if (nearestInd > 0) {\n                    prevDist = sqrDist(mouseLatlng, this.samples[nearestInd - 1]);\n                    prevSampleDist = sqrDist(this.samples[nearestInd], this.samples[nearestInd - 1]);\n                }\n                if (nearestInd < this.samples.length - 1) {\n                    nextDist = sqrDist(mouseLatlng, this.samples[nearestInd + 1]);\n                    nextSampleDist = sqrDist(this.samples[nearestInd], this.samples[nearestInd + 1]);\n                }\n\n                if (nearestInd === 0) {\n                    if (nextDist < minDist + nextSampleDist) {\n                        di = (minDist - nextDist) / 2 / nextSampleDist + 1 / 2;\n                    } else {\n                        di = 0.001;\n                    }\n                } else if (nearestInd === this.samples.length - 1) {\n                    if (prevDist < minDist + prevSampleDist) {\n                        di = -((minDist - prevDist) / 2 / prevSampleDist + 1 / 2);\n                    } else {\n                        di = -0.001;\n                    }\n                } else {\n                    if (prevDist < nextDist) {\n                        di = -((minDist - prevDist) / 2 / prevSampleDist + 1 / 2);\n                    } else {\n                        di = (minDist - nextDist) / 2 / nextSampleDist + 1 / 2;\n                    }\n                }\n                if (di < -1) {\n                    di = -1;\n                }\n                if (di > 1) {\n                    di = 1;\n                }\n                this.setCursorPosition(ind + di);\n            }\n        },\n\n        setupGraph: function() {\n            if (!this._map || !this.values) {\n                return;\n            }\n\n            while (this.svg.hasChildNodes()) {\n                this.svg.removeChild(this.svg.lastChild);\n            }\n            while (this.leftAxisLables.hasChildNodes()) {\n                this.leftAxisLables.removeChild(this.leftAxisLables.lastChild);\n            }\n\n            var maxValue = Math.max.apply(null, this.values),\n                minValue = Math.min.apply(null, this.values),\n                svg = this.svg,\n                path, i, horizStep, verticalMultiplier, x, y, gridValues, label;\n\n            var paddingBottom = 8 + 16,\n                paddingTop = 8;\n\n            gridValues = this.calcGridValues(minValue, maxValue);\n            var gridStep = (this.svgHeight - paddingBottom - paddingTop) / (gridValues.length - 1);\n            for (i = 0; i < gridValues.length; i++) {\n                y = Math.round(i * gridStep - 0.5) + 0.5 + paddingTop;\n                path = L.Util.template('M{x1} {y} L{x2} {y}', {x1: 0, x2: this.svgWidth * this.horizZoom, y: y});\n                createSvg(\n                    'path',\n                    {'d': path, 'stroke-width': '1px', 'stroke': 'green', 'fill': 'none', 'stroke-opacity': '0.5'},\n                    svg\n                );\n\n                label = L.DomUtil.create('div', 'elevation-profile-grid-label', this.leftAxisLables);\n                label.innerHTML = gridValues[gridValues.length - i - 1];\n                label.style.top = (gridStep * i + paddingTop) + 'px';\n            }\n\n            horizStep = this.svgWidth / (this.values.length - 1);\n            verticalMultiplier =\n                (this.svgHeight - paddingTop - paddingBottom) / (gridValues[gridValues.length - 1] - gridValues[0]);\n\n            path = [];\n            const valueToSvgCoord = (el) => {\n                const y = (el - gridValues[0]) * verticalMultiplier;\n                return this.svgHeight - y - paddingBottom;\n            };\n\n            let startNewSegment = true;\n            for (i = 0; i < this.values.length; i++) {\n                let value = this.values[i];\n                if (value === null) {\n                    startNewSegment = true;\n                    continue;\n                }\n                path.push(startNewSegment ? 'M' : 'L');\n                x = i * horizStep;\n                y = valueToSvgCoord(value);\n                path.push(x + ' ' + y + ' ');\n                startNewSegment = false;\n            }\n            path = path.join('');\n            createSvg('path', {'d': path, 'stroke-width': '1px', 'stroke': 'brown', 'fill': 'none'}, svg);\n            // sightline\n            if (this.options.sightLine) {\n                path = L.Util.template('M{x1} {y1} L{x2} {y2}', {\n                        x1: 0,\n                        x2: this.svgWidth * this.horizZoom,\n                        y1: valueToSvgCoord(this.values[0]),\n                        y2: valueToSvgCoord(this.values[this.values.length - 1])\n                    }\n                );\n                createSvg(\n                    'path',\n                    {'d': path, 'stroke-width': '3px', 'stroke': '#94b1ff', 'fill': 'none', 'stroke-opacity': '0.5'},\n                    svg\n                );\n            }\n        },\n\n        onCloseButtonClick: function() {\n            this.removeFrom(this._map);\n        }\n    }\n);\n\nexport {ElevationProfile, calcSamplingInterval};\n","import config from '~/config';\nimport {fetch} from '~/lib/xhr-promise';\n\nclass ElevationProvider {\n    chunkSize = 10000;\n\n    constructor(serverUrl = config.elevationsServer) {\n        this.url = serverUrl;\n    }\n\n    async get(latlngs) {\n        const result = [];\n        for (let i = 0; i < latlngs.length; i += this.chunkSize) {\n            const chunk = latlngs.slice(i, i + this.chunkSize);\n            const request = chunk.map((ll) => `${ll.lat.toFixed(6)} ${ll.lng.toFixed(6)}`).join('\\n');\n            const xhr = await fetch(this.url, {method: 'POST', data: request, withCredentials: false});\n            const respValues = xhr.responseText.split('\\n').map((line) => (line === 'NULL' ? null : parseFloat(line)));\n            result.push(...respValues);\n        }\n        return result;\n    }\n}\n\nexport {ElevationProvider};\n","import L from 'leaflet';\nimport './style.css';\n\nfunction enableTopRow(control) {\n    const originalOnAdd = control.onAdd;\n    if (control._topRowEnabled) {\n        return;\n    }\n\n    L.Util.extend(control, {\n        _topRowEnabled: true,\n\n        onAdd: function(map) {\n            const container = originalOnAdd.call(this, map);\n            setTimeout(() => this.__injectTopRow(), 0);\n            return container;\n        },\n\n        __injectTopRow: function() {\n            this._topRow = L.DomUtil.create('div', 'leaflet-control-layers-top-row');\n            this._section.parentNode.insertBefore(this._topRow, this._section);\n        }\n\n    });\n    if (control._map) {\n        control.__injectTopRow();\n    }\n}\n\nexport default enableTopRow;\n","export default \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMzAgMzAiPgogICAgPGc+CiAgICAgICAgPGVsbGlwc2Ugcnk9IjE1IiByeD0iMTUiIGN5PSIxNSIgY3g9IjE1IiBmaWxsPSIjNzc3IiBmaWxsLW9wYWNpdHk9IjAuNSIvPgogICAgICAgIDxlbGxpcHNlIHJ5PSIzIiByeD0iMyIgY3k9IjE1IiBjeD0iMTUiIGZpbGw9IiMzMzg4ZmYiIC8+CiAgICA8L2c+Cjwvc3ZnPg==\"","import './index.css';\nimport * as App from './App';\nimport config from './config';\n\nfunction getUid() {\n    const cookie = document.cookie;\n    const cookieUid = cookie.match(/\\buid=([^;]+)/u)[1];\n    const uidRaw = atob(cookieUid);\n    const l = [];\n    for (let i = 0; i < uidRaw.length; i++) {\n        l.push(uidRaw.charCodeAt(i));\n    }\n    const l2 = [];\n    l2.push(...l.slice(0, 4).reverse());\n    l2.push(...l.slice(4, 8).reverse());\n    l2.push(...l.slice(8, 12).reverse());\n    l2.push(...l.slice(12).reverse());\n    const uid = l2.map((c) => (\"0\" + c.toString(16)).slice(-2)).join('').toUpperCase();\n    return uid;\n}\n\nfunction preconnect(url) {\n    const preconnectLink = document.createElement('link');\n    preconnectLink.rel = 'preconnect';\n    preconnectLink.href = url;\n    document.head.appendChild(preconnectLink);\n\n    const dnsPrefetchLink = document.createElement('link');\n    dnsPrefetchLink.rel = 'dns-prefetch';\n    dnsPrefetchLink.href = url;\n    document.head.appendChild(dnsPrefetchLink);\n}\n\npreconnect(config.apiServer);\npreconnect(config.CORSProxyUrl);\n\nconsole.log('Version:', RELEASE_VER); // eslint-disable-line no-console\n\nlet uid;\ntry {\n    uid = getUid();\n} catch (e) {\n    // ignore error\n}\nconsole.log('UID:', uid); // eslint-disable-line no-console\n\nApp.setUp();\n\n","// extracted by mini-css-extract-plugin\nexport {};","import './App.css';\nimport './leaflet-fixes.css';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport {MapWithSidebars} from '~/lib/leaflet.map.sidebars';\nimport '~/lib/leaflet.control.printPages/control';\nimport '~/lib/leaflet.control.caption';\nimport config from './config';\nimport '~/lib/leaflet.control.coordinates';\nimport enableLayersControlHotKeys from '~/lib/leaflet.control.layers.hotkeys';\nimport '~/lib/leaflet.hashState/Leaflet.Map';\nimport '~/lib/leaflet.hashState/Leaflet.Control.Layers';\nimport {fixAll} from '~/lib/leaflet.fixes';\nimport './adaptive.css';\nimport '~/lib/leaflet.control.panoramas';\nimport '~/lib/leaflet.control.track-list/track-list';\nimport '~/lib/leaflet.control.track-list/control-ruler';\nimport '~/lib/leaflet.control.track-list/track-list.hash-state';\nimport '~/lib/leaflet.control.track-list/track-list.localstorage';\nimport enableLayersMinimize from '~/lib/leaflet.control.layers.minimize';\nimport enableLayersConfig from '~/lib/leaflet.control.layers.configure';\nimport raiseControlsOnFocus from '~/lib/leaflet.controls.raise-on-focus';\nimport {getLayers} from './layers';\nimport '~/lib/leaflet.control.layers.events';\nimport '~/lib/leaflet.control.jnx';\nimport '~/lib/leaflet.control.jnx/hash-state';\nimport '~/lib/leaflet.control.azimuth';\nimport {hashState, bindHashStateReadOnly} from '~/lib/leaflet.hashState/hashState';\nimport {LocateControl} from '~/lib/leaflet.control.locate';\nimport {notify} from '~/lib/notifications';\nimport ZoomDisplay from '~/lib/leaflet.control.zoom-display';\nimport * as logging from '~/lib/logging';\nimport safeLocalStorage from '~/lib/safe-localstorage';\nimport '~/lib/leaflet.placemark';\nimport '~/lib/leaflet.control.weather';\n\nconst locationErrorMessage = {\n    0: 'Ваш браузер не поддерживает геолокацию.',\n    1: 'Геолокация для этого сайта заблокирована. Пожалуйста, включите в настройках браузера.',\n    2: 'Не удалось получить позицию по неизвестной причине.',\n};\n\nfunction setUp() {\n    const startInfo = {\n        href: window.location.href,\n        localStorageKeys: Object.keys(safeLocalStorage),\n        mobile: L.Browser.mobile,\n    };\n    fixAll();\n\n    const map = new MapWithSidebars('map', {\n            zoomControl: false,\n            fadeAnimation: false,\n            attributionControl: false,\n            inertiaMaxSpeed: 1500,\n            worldCopyJump: true,\n            maxZoom: 18,\n            tap: false // фикс бага с двойным кликом в сафари\n        }\n    );\n\n    const tracklist = new L.Control.TrackList();\n\n    /* controls top-left corner */\n    // Поле с информацией\n    new L.Control.Caption(config.caption, {\n            position: 'bottomleft'\n        }\n    ).addTo(map);\n\n    new ZoomDisplay().addTo(map);\n\n    map.getPlacemarkHashStateInterface().enableHashState('r');\n\n    new L.Control.Coordinates({position: 'topleft'}).addTo(map);\n\n    new L.Control.Weather().addTo(map);\n\n    const locateControl = new LocateControl({\n        position: 'topleft',\n        showError: function({code, message}) {\n            let customMessage = locationErrorMessage[code];\n            if (!customMessage) {\n                customMessage = `Geolocation error: ${message}`;\n            }\n            notify(customMessage);\n        }\n    }).addTo(map);\n    let state_map = hashState.getState('m');\n    if (typeof state_map === 'undefined') {\n        // если не заданы координаты в урле, то берём из локалстораджа\n        state_map = safeLocalStorage.getItem('state-m');\n    }\n    if (typeof state_map === 'string') {\n        state_map = state_map.split(',');\n    }\n    let {lat, lng, zoom, valid: validPositionInHash} = map.validateState(state_map);\n    locateControl.moveMapToCurrentLocation(config.defaultZoom, L.latLng(config.defaultLocation),\n        validPositionInHash ? L.latLng(lat, lng) : null, validPositionInHash ? zoom : null);\n    map.enableHashState('m');\n\n    const panoramas = new L.Control.Panoramas().addTo(map); // eslint-disable-line\n\n    /* controls top-right corner */\n\n    const layersControl = L.control.layers(null, null, {collapsed: false})\n        .addTo(map);\n    enableLayersControlHotKeys(layersControl);\n    enableLayersMinimize(layersControl);\n    enableLayersConfig(layersControl, getLayers());\n    let state_layers = hashState.getState('l');\n    if (typeof state_layers === 'undefined') {\n        // если не задан слой в урле, то берём из локалстораджа\n        state_layers = safeLocalStorage.getItem('state-l');\n        if (typeof state_layers === 'string') {\n            state_layers = state_layers.split(',');\n            hashState.updateState('l', state_layers);\n        }\n    }\n    layersControl.enableHashState('l');\n\n    /* controls bottom-left corner */\n\n    const attribution = L.control.attribution({\n        position: 'bottomleft',\n        prefix: false,\n    });\n    map.on('resize', function() {\n        if (map.getSize().y > 567) {\n            map.addControl(attribution);\n            // Hack to keep control at the bottom of the map\n            const container = attribution._container;\n            const parent = container.parentElement;\n            parent.appendChild(container);\n        } else {\n            map.removeControl(attribution);\n        }\n    });\n    if (map.getSize().y > 567) {\n        map.addControl(attribution);\n    }\n    // ewfefwef\n\n    /* controls bottom-right corner */\n\n    function trackNames() {\n        return tracklist.tracks().map((track) => track.name());\n    }\n    tracklist.addTo(map);\n    const tracksHashParams = tracklist.hashParams();\n\n    let hasTrackParamsInHash = false;\n    for (let param of tracksHashParams) {\n        if (hashState.hasKey(param)) {\n            hasTrackParamsInHash = true;\n            break;\n        }\n    }\n    if (!hasTrackParamsInHash) {\n        //tracklist.loadTracksFromStorage();\n    }\n    tracklist.loadTracksFromStorage();\n    startInfo.tracksAfterLoadFromStorage = trackNames();\n\n    for (let param of tracksHashParams) {\n        bindHashStateReadOnly(param, tracklist.loadTrackFromParam.bind(tracklist, param));\n    }\n    startInfo.tracksAfterLoadFromHash = trackNames();\n\n    if (!validPositionInHash) {\n        tracklist.whenLoadDone(() => tracklist.setViewToAllTracks(true));\n    }\n\n    /* adaptive layout */\n\n    if (L.Browser.mobile) {\n        layersControl.setMinimized();\n        if (!tracklist.hasTracks()) {\n            tracklist.setMinimized();\n        }\n    }\n\n    if (L.Browser.mobile) {\n        map.on('mousedown dragstart', () => layersControl.setMinimized());\n        // при активации погоды - скрываем большие контроллы\n        map.on('weather_rendered', () => {layersControl.setMinimized();tracklist.setMinimized();})\n    }\n\n    raiseControlsOnFocus(map);\n\n    /* save state at unload */\n    L.DomEvent.on(window, 'beforeunload', () => {\n        logging.logEvent('saveTracksToStorage begin', {\n            localStorageKeys: Object.keys(safeLocalStorage),\n            trackNames: trackNames(),\n        });\n        let localStorageKeys;\n        try {\n            tracklist.saveTracksToStorage();\n            safeLocalStorage.setItem('state-m', hashState.getState('m'));\n            safeLocalStorage.setItem('state-l', hashState.getState('l'));\n            localStorageKeys = Object.keys(safeLocalStorage); // eslint-disable-line\n        } catch (e) {\n            logging.logEvent('saveTracksToStorage failed', {error: e});\n            return; // eslint-disable-line\n        }\n    });\n}\n\nexport {setUp};\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\n\nimport './style.css';\nimport {onElementResize} from '~/lib/anyElementResizeEvent';\n\nconst MapWithSidebars = L.Map.extend({\n    initialize: function (id, options) {\n        this._sidebarsContainer = L.DomUtil.get(id);\n        this.setupSidebarsLayout(this._sidebarsContainer);\n        L.Map.prototype.initialize.call(this, this._mapContainer, options);\n        onElementResize(this._mapContainer, L.Util.requestAnimFrame.bind(null, this.invalidateSize.bind(this)));\n    },\n\n    setupSidebarsLayout: function (container) {\n        this._sidebarContainers = {};\n        const sidebars = this._sidebarContainers;\n        L.DomUtil.addClass(container, 'leaflet-map-sidebars-container');\n        sidebars['left'] = L.DomUtil.create('div', 'leaflet-map-sidebar-left', this._sidebarsContainer);\n        const midColumn = L.DomUtil.create('div', 'leaflet-map-sidebar-mid-column', this._sidebarsContainer);\n        sidebars['right'] = L.DomUtil.create('div', 'leaflet-map-sidebar-right', this._sidebarsContainer);\n        sidebars['top'] = L.DomUtil.create('div', 'leaflet-map-sidebar-top', midColumn);\n        this._mapContainer = L.DomUtil.create('div', 'leaflet-map-container-with-sidebars', midColumn);\n        sidebars['bottom'] = L.DomUtil.create('div', 'leaflet-map-sidebar-bottom', midColumn);\n    },\n\n    addElementToSidebar: function (barName, element) {\n        this._sidebarContainers[barName].appendChild(element);\n    },\n\n    removeElementFromSidebar: function (barName, element) {\n        this._sidebarContainers[barName].removeChild(element);\n    },\n});\n\nexport {MapWithSidebars};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport ko from 'knockout';\nimport '~/lib/knockout.component.progress/progress';\nimport '~/lib/controls-styles/controls-styles.css';\nimport './control.css';\nimport PageFeature from './pageFeature';\nimport Contextmenu from '~/lib/contextmenu';\nimport {renderPages} from './map-render';\nimport formHtml from './form.html';\nimport {notify} from '~/lib/notifications';\nimport {makePdf} from './pdf';\nimport {saveAs} from '~/vendored/github.com/eligrey/FileSaver';\nimport {blobFromString} from '~/lib/binary-strings';\nimport '~/lib/leaflet.hashState/leaflet.hashState';\nimport '~/lib/leaflet.control.commons';\nimport * as logging from '~/lib/logging';\nimport {MagneticMeridians} from './decoration.magnetic-meridians';\nimport {OverlayScale} from './decoration.scale';\nimport {Grid} from './decoration.grid';\n\nko.extenders.checkNumberRange = function(target, range) {\n    return ko.pureComputed({\n            read: target,  // always return the original observables value\n            write: function(newValue) {\n                newValue = parseFloat(newValue);\n                if (newValue >= range[0] && newValue <= range[1]) {\n                    target(newValue);\n                } else {\n                    target.notifySubscribers(target());\n                }\n            }\n        }\n    ).extend({notify: 'always'});\n};\n\nfunction savePagesPdf(imagesInfo, resolution, fileName) {\n    let pdf = makePdf(imagesInfo, resolution);\n    pdf = blobFromString(pdf);\n    saveAs(pdf, fileName, true);\n}\n\nfunction savePageJpg(page, fileName) {\n    saveAs(blobFromString(page.data), fileName, true);\n}\n\nL.Control.PrintPages = L.Control.extend({\n        options: {\n            position: 'bottomleft',\n            defaultMargin: 7,\n        },\n\n        includes: [L.Evented, L.Mixin.HashState],\n\n        stateChangeEvents: ['change'],\n\n        pageSizes: [\n            {name: 'A1', width: 594, height: 841},\n            {name: 'A2', width: 420, height: 594},\n            {name: 'A3', width: 297, height: 420},\n            {name: 'A4', width: 210, height: 297},\n            {name: 'A5', width: 148, height: 210}\n        ],\n\n        zoomLevels: ['auto', 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18],\n\n        initialize: function(options) {\n            L.Control.prototype.initialize.call(this, options);\n            this.pages = [];\n            this.scale = ko.observable(500).extend({checkNumberRange: [1, 1000000]});\n            this.resolution = ko.observable(300).extend({checkNumberRange: [10, 9999]});\n            this.zoomLevel = ko.observable('auto');\n            this.pageWidth = ko.observable(210).extend({checkNumberRange: [10, 9999]});\n            this.pageHeight = ko.observable(297).extend({checkNumberRange: [10, 9999]});\n            this.settingsExpanded = ko.observable(false);\n            this.makingPdf = ko.observable(false);\n            this.downloadProgressRange = ko.observable();\n            this.downloadProgressDone = ko.observable();\n            this.marginLeft = ko.observable(this.options.defaultMargin).extend({checkNumberRange: [0, 99]});\n            this.marginRight = ko.observable(this.options.defaultMargin).extend({checkNumberRange: [0, 99]});\n            this.marginTop = ko.observable(this.options.defaultMargin).extend({checkNumberRange: [0, 99]});\n            this.marginBottom = ko.observable(this.options.defaultMargin).extend({checkNumberRange: [0, 99]});\n            this.autoZoomLevels = ko.observable({});\n            this.printSize = ko.pureComputed(this._printSize, this);\n            this.printSize.subscribe(this.onPageSizeChanged, this);\n            this.scale.subscribe(this.onPageSizeChanged, this);\n            this.resolution.subscribe(this.onPageSizeChanged, this);\n            this.pageSizeDescription = ko.pureComputed(this._displayPageSize, this);\n            this.pagesNum = ko.observable(0);\n            this.pagesNumLabel = ko.pureComputed(this._pagesNumLabel, this);\n            this.gridOn = ko.observable(false);\n            this.magneticMeridiansOn = ko.observable(false);\n\n            // hash state notifications\n            this.scale.subscribe(this.notifyChange, this);\n            this.printSize.subscribe(this.notifyChange, this);\n            this.resolution.subscribe(this.notifyChange, this);\n            this.zoomLevel.subscribe(this.notifyChange, this);\n            this.gridOn.subscribe(this.notifyChange, this);\n            this.magneticMeridiansOn.subscribe(this.notifyChange, this);\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            const container = this._container =\n                L.DomUtil.create('div', 'leaflet-control control-form control-print-pages');\n            this._stopContainerEvents();\n\n            map.on('move', this.updateFormZooms, this);\n            container.innerHTML = formHtml;\n            ko.applyBindings(this, container);\n            this.updateFormZooms();\n            return container;\n        },\n\n        setExpanded: function() {\n            L.DomUtil.removeClass(this._container, 'minimized');\n        },\n\n        setMinimized: function() {\n            L.DomUtil.addClass(this._container, 'minimized');\n        },\n\n        addPage: function(isLandscape, center) {\n            let [pageWidth, pageHeight] = this.printSize();\n            if (isLandscape) {\n                [pageWidth, pageHeight] = [pageHeight, pageWidth];\n            }\n            if (!center) {\n                center = this._map.getCenter();\n            }\n            const page = new PageFeature(center, [pageWidth, pageHeight],\n                this.scale(), (this.pages.length + 1).toString()\n            );\n            page._rotated = isLandscape;\n            page.addTo(this._map);\n            this.pages.push(page);\n            this.pagesNum(this.pages.length);\n            let cm = new Contextmenu(this.makePageContexmenuItems.bind(this, page));\n            page.on('contextmenu', cm.show, cm);\n            page.on('click', this.rotatePage.bind(this, page));\n            page.on('move', this.updateFormZooms, this);\n            page.on('moveend', this.notifyChange, this);\n            this.updateFormZooms();\n            this.notifyChange();\n            return page;\n        },\n\n        addLandscapePage: function() {\n            this.addPage(true);\n        },\n\n        addPortraitPage: function() {\n            this.addPage(false);\n        },\n\n        removePage: function(page) {\n            let i = this.pages.indexOf(page);\n            this.pages.splice(i, 1);\n            this.pagesNum(this.pages.length);\n            this._map.removeLayer(page);\n            for (; i < this.pages.length; i++) {\n                this.pages[i].setLabel((i + 1).toString());\n            }\n            this.notifyChange();\n            this.updateFormZooms();\n        },\n\n        removePages: function() {\n            this.pages.forEach((page) => page.removeFrom(this._map));\n            this.pages = [];\n            this.pagesNum(this.pages.length);\n            this.notifyChange();\n            this.updateFormZooms();\n        },\n\n        onSavePdfClicked: function() {\n            if (!this.pages.length) {\n                notify('Add some pages to print');\n                return;\n            }\n            this.savePdf();\n        },\n\n        zoomForPrint: function() {\n            let zoom = this.zoomLevel();\n            if (zoom === 'auto') {\n                zoom = this.suggestZooms();\n            } else {\n                zoom = {mapZoom: zoom, satZoom: zoom};\n            }\n            return zoom;\n        },\n\n        incrementProgress: function(inc, range) {\n            this.downloadProgressRange(range);\n            this.downloadProgressDone((this.downloadProgressDone() || 0) + inc);\n        },\n\n        savePdf: function() {\n            logging.captureBreadcrumb('start save pdf');\n            if (!this._map) {\n                return;\n            }\n            this.downloadProgressRange(1000);\n            this.downloadProgressDone(undefined);\n            this.makingPdf(true);\n            const pages = this.pages.map((page) => ({\n                        latLngBounds: page.getLatLngBounds(),\n                        printSize: page.getPrintSize(),\n                        label: page.getLabel()\n            }));\n            const resolution = this.resolution();\n            const decorationLayers = [];\n            if (this.gridOn()) {\n                decorationLayers.push(new Grid());\n            }\n            if (this.magneticMeridiansOn()) {\n                decorationLayers.push(new MagneticMeridians());\n            }\n            decorationLayers.push(new OverlayScale());\n            const scale = this.scale();\n            const width = this.pageWidth();\n            const height = this.pageHeight();\n            const eventId = logging.randId();\n            const zooms = this.zoomForPrint();\n            this.fire('mapRenderStart', {\n                action: 'pdf',\n                eventId,\n                scale,\n                resolution,\n                pages,\n                zooms\n            });\n            renderPages({\n                    map: this._map,\n                    pages,\n                    zooms,\n                    resolution,\n                    scale,\n                    decorationLayers,\n                    progressCallback: this.incrementProgress.bind(this)\n                }\n            ).then(({images, renderedLayers}) => {\n                    if (images) {\n                        const fileName = this.getFileName({\n                            renderedLayers,\n                            scale,\n                            width,\n                            height,\n                            extension: 'pdf'\n                        });\n                        savePagesPdf(images, resolution, fileName);\n                        this.fire('mapRenderEnd', {eventId, success: true});\n                    }\n                }\n            ).catch((e) => {\n                    logging.captureException(e, 'raster creation failed');\n                    this.fire('mapRenderEnd', {eventId, success: false, error: e});\n                    notify(`Failed to create PDF: ${e.message}`);\n                }\n            ).then(() => this.makingPdf(false));\n        },\n\n        savePageJpg: function(page) {\n            logging.captureBreadcrumb('start save page jpg', {pageNumber: page.getLabel()});\n            const pages = [{\n                latLngBounds: page.getLatLngBounds(),\n                printSize: page.getPrintSize(),\n                label: page.getLabel()\n            }];\n            const decorationLayers = [];\n            if (this.gridOn()) {\n                decorationLayers.push(new Grid());\n            }\n            if (this.magneticMeridiansOn()) {\n                decorationLayers.push(new MagneticMeridians());\n            }\n            decorationLayers.push(new OverlayScale());\n            this.downloadProgressRange(1000);\n            this.downloadProgressDone(undefined);\n            this.makingPdf(true);\n            const resolution = this.resolution();\n            const scale = this.scale();\n            const width = this.pageWidth();\n            const height = this.pageHeight();\n            const eventId = logging.randId();\n            const zooms = this.zoomForPrint();\n            this.fire('mapRenderStart', {\n                action: 'jpg',\n                eventId,\n                scale,\n                resolution,\n                pages,\n                zooms\n            });\n            renderPages({\n                    map: this._map,\n                    pages,\n                    zooms,\n                    resolution,\n                    scale,\n                    decorationLayers,\n                    progressCallback: this.incrementProgress.bind(this)\n                }\n            )\n                .then(({images, renderedLayers}) => {\n                    const fileName = this.getFileName({\n                        renderedLayers,\n                        scale,\n                        width,\n                        height,\n                        extension: 'jpg'\n                    });\n                    savePageJpg(images[0], fileName);\n                    this.fire('mapRenderEnd', {eventId, success: true});\n                })\n                .catch((e) => {\n                        logging.captureException(e, 'raster creation failed');\n                        this.fire('mapRenderEnd', {eventId, success: false, error: e});\n                        notify(`Failed to create JPEG from page: ${e.message}`);\n                    }\n                ).then(() => this.makingPdf(false));\n        },\n\n        onPageSizeChanged: function() {\n            let [pageWidth, pageHeight] = this.printSize();\n            this.pages.forEach((page) => {\n                    let [w, h] = [pageWidth, pageHeight];\n                    if (page._rotated) {\n                        [w, h] = [h, w];\n                    }\n                    page.setSize([w, h], this.scale());\n                }\n            );\n            this.updateFormZooms();\n        },\n\n        onPagesNumLabelClick: function() {\n            if (this.pages.length > 0) {\n                const bounds = L.latLngBounds([]);\n                for (let page of this.pages) {\n                    bounds.extend(page.latLngBounds);\n                }\n                this._map.fitBounds(bounds.pad(0.2));\n            }\n        },\n\n        makePageContexmenuItems: function(page) {\n            const items = [\n                {text: 'Rotate', callback: this.rotatePage.bind(this, page)},\n                '-',\n                {text: 'Delete', callback: this.removePage.bind(this, page)},\n                '-',\n                {text: 'Save image', callback: this.savePageJpg.bind(this, page), disabled: this.makingPdf()}\n            ];\n            if (this.pages.length > 1) {\n                items.push({text: 'Change order', separator: true});\n                this.pages.forEach((p, i) => {\n                        if (p !== page) {\n                            items.push({\n                                    text: (i + 1).toString(),\n                                    callback: this.renumberPage.bind(this, page, i)\n                                }\n                            );\n                        }\n                    }\n                );\n            }\n            return items;\n        },\n\n        rotatePage: function(page) {\n            page._rotated = !page._rotated;\n            page.rotate();\n            this.notifyChange();\n        },\n\n        renumberPage: function(page, newIndex) {\n            const oldIndex = this.pages.indexOf(page);\n            this.pages.splice(oldIndex, 1);\n            this.pages.splice(newIndex, 0, page);\n            for (let i = Math.min(oldIndex, newIndex); i < this.pages.length; i++) {\n                this.pages[i].setLabel((i + 1).toString());\n            }\n            this.notifyChange();\n        },\n\n        _printSize: function() {\n            return [this.pageWidth() - this.marginLeft() - this.marginRight(),\n                this.pageHeight() - this.marginTop() - this.marginBottom()];\n        },\n\n        suggestZooms: function() {\n            const scale = this.scale(),\n                resolution = this.resolution();\n            let referenceLat;\n            if (this.pages.length > 0) {\n                let absLats = this.pages.map((page) => Math.abs(page.getLatLngBounds().getCenter().lat));\n                referenceLat = Math.min(...absLats);\n            } else {\n                if (!this._map) {\n                    return [null, null];\n                }\n                referenceLat = this._map.getCenter().lat;\n            }\n            let targetMetersPerPixel = scale / (resolution / 2.54);\n            let mapUnitsPerPixel = targetMetersPerPixel / Math.cos(referenceLat * Math.PI / 180);\n            let satZoom = Math.ceil(Math.log(40075016.4 / 256 / mapUnitsPerPixel) / Math.LN2);\n\n            targetMetersPerPixel = scale / (90 / 2.54) / 1.5;\n            mapUnitsPerPixel = targetMetersPerPixel / Math.cos(referenceLat * Math.PI / 180);\n            let mapZoom = Math.round(Math.log(40075016.4 / 256 / mapUnitsPerPixel) / Math.LN2);\n            mapZoom = Math.min(mapZoom, 18);\n            satZoom = Math.min(satZoom, 18);\n            mapZoom = Math.max(mapZoom, 0);\n            satZoom = Math.max(satZoom, 0);\n            return {mapZoom, satZoom};\n        },\n\n        updateFormZooms: function() {\n            this.autoZoomLevels(this.suggestZooms());\n        },\n\n        _displayPageSize: function() {\n            const width = this.pageWidth(),\n                height = this.pageHeight();\n            for (let size of this.pageSizes) {\n                if (size.width === width && size.height === height) {\n                    return size.name;\n                }\n            }\n            return `${width} x ${height} mm`;\n        },\n\n        notifyChange: function() {\n            this.fire('change');\n        },\n\n        hasPages: function() {\n            return this.pages.length > 0;\n        },\n\n        _pagesNumLabel: function() {\n            const n = this.pagesNum();\n            let label = '';\n            if (n) {\n                label += n;\n            } else {\n                label = 'No';\n            }\n            label += ' page';\n            if (n === 0 || n > 1) {\n                label += 's';\n            }\n            return label;\n        },\n\n        serializeState: function() {\n            const pages = this.pages;\n            let state = null;\n            if (pages.length) {\n                state = [];\n                state.push(this.scale().toString());\n                state.push(this.resolution().toString());\n                state.push(this.zoomLevel().toString());\n                state.push(this.pageWidth().toString());\n                state.push(this.pageHeight().toString());\n                state.push(this.marginLeft().toString());\n                state.push(this.marginRight().toString());\n                state.push(this.marginTop().toString());\n                state.push(this.marginBottom().toString());\n                for (let page of pages) {\n                    let latLng = page.getLatLng().wrap();\n                    state.push(latLng.lat.toFixed(5));\n                    state.push(latLng.lng.toFixed(5));\n                    state.push(page._rotated ? '1' : '0');\n                }\n                let flags =\n                    (this.magneticMeridiansOn() ? 1 : 0) |\n                    (this.gridOn() ? 2 : 0);\n                state.push(flags.toString());\n            }\n            return state;\n        },\n\n        unserializeState: function(state) {\n            if (!state || !state.length) {\n                return false;\n            }\n            this.removePages();\n            state = [...state];\n            this.scale(state.shift());\n            this.resolution(state.shift());\n            this.zoomLevel(state.shift());\n            this.pageWidth(state.shift());\n            this.pageHeight(state.shift());\n            this.marginLeft(state.shift());\n            this.marginRight(state.shift());\n            this.marginTop(state.shift());\n            this.marginBottom(state.shift());\n            let lat, lng, rotated;\n            while (state.length >= 3) {\n                lat = parseFloat(state.shift());\n                lng = parseFloat(state.shift());\n                rotated = parseInt(state.shift(), 10);\n                if (isNaN(lat) || isNaN(lng) || lat < -85 || lat > 85 || lng < -180 || lng > 180) {\n                    break;\n                }\n                this.addPage(Boolean(rotated), L.latLng(lat, lng));\n            }\n            if (state.length) {\n                const flags = parseInt(state.shift(), 10);\n                if (flags >= 0 && flags <= 3) {\n                    this.magneticMeridiansOn(Boolean(flags & 1));\n                    this.gridOn(Boolean(flags & 2));\n                }\n            }\n            return true;\n        },\n\n        getFileName: function({renderedLayers, scale, width, height, extension}) {\n            let fileName = '';\n\n            let opaqueLayer;\n            const transparentOverlayLayers = [];\n\n            renderedLayers.forEach((layer) => {\n                const {\n                    options: {\n                        isOverlay,\n                        isOverlayTransparent,\n                        shortName\n                    }\n                } = layer;\n\n                if (!shortName) {\n                    return;\n                }\n\n                if (isOverlay) {\n                    if (isOverlayTransparent) {\n                        transparentOverlayLayers.push(layer);\n                    } else {\n                        opaqueLayer = layer;\n                    }\n                } else if (!opaqueLayer) {\n                    opaqueLayer = layer;\n                }\n            });\n\n            function appendLayerShortName(layer) {\n                fileName += `${layer.options.shortName}_`;\n            }\n            if (opaqueLayer) {\n                appendLayerShortName(opaqueLayer);\n            }\n            transparentOverlayLayers.forEach(appendLayerShortName);\n\n            fileName += `${scale}m`;\n\n            const currentPageSize = this.pageSizes.find(\n                (pageSize) => width === pageSize.width && height === pageSize.height\n            );\n\n            if (currentPageSize) {\n                fileName += `_${currentPageSize.name}`;\n            }\n\n            return `${fileName}.${extension}`;\n        }\n    }\n);\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport './page-feature.css';\n\nconst PageFeature = L.Marker.extend({\n        initialize: function(centerLatLng, paperSize, scale, label) {\n            this.paperSize = paperSize;\n            this.scale = scale;\n            var icon = L.divIcon({className: \"print-page-marker\", html: label});\n            L.Marker.prototype.initialize.call(this, centerLatLng, {\n                    icon: icon,\n                    draggable: true,\n                    title: 'Left click to rotate, right click for menu'\n                }\n            );\n            this.on('drag', this.updateView.bind(this, undefined));\n        },\n\n        onAdd: function(map) {\n            L.Marker.prototype.onAdd.call(this, map);\n            map.on('viewreset', () => this.updateView());\n            this.rectangle = L.rectangle([[0, 0], [0, 0]],\n                {color: '#ff7800', weight: 2, opacity: 0.7, fillOpacity: 0.2}\n            ).addTo(map);\n            this.updateView();\n        },\n\n        onRemove: function(map) {\n            map.off('viewreset', this.updateView, this);\n            L.Marker.prototype.onRemove.call(this, map);\n            this.rectangle.removeFrom(map);\n        },\n\n        getLatLngBounds: function() {\n            return this.latLngBounds;\n        },\n\n        _getLatLngBounds: function() {\n            const centerLatLng = this.getLatLng();\n            const centerMerc = L.Projection.SphericalMercator.project(centerLatLng);\n            const mercatorScale =\n                (Math.cos((centerLatLng.lat * Math.PI) / 180) * L.CRS.Earth.R) / L.Projection.SphericalMercator.R;\n            const mercatorPageSize = L.point(...this.paperSize).multiplyBy(this.scale / 10 / mercatorScale);\n            let sw = centerMerc.subtract(mercatorPageSize.divideBy(2));\n            let ne = centerMerc.add(mercatorPageSize.divideBy(2));\n            sw = L.Projection.SphericalMercator.unproject(sw);\n            ne = L.Projection.SphericalMercator.unproject(ne);\n            return L.latLngBounds([sw, ne]);\n        },\n\n        _animateZoom: function(e) {\n            L.Marker.prototype._animateZoom.call(this, e);\n            this.updateView(e.zoom);\n        },\n\n        updateView: function(newZoom) {\n            if (!this._map) {\n                return;\n            }\n            if (newZoom === undefined) {\n                newZoom = this._map.getZoom();\n            }\n            var bounds = this.latLngBounds = this._getLatLngBounds();\n            var pixel_sw = this._map.project(bounds.getSouthWest(), newZoom);\n            var pixel_ne = this._map.project(bounds.getNorthEast(), newZoom);\n            var pixel_center = this._map.project(this.getLatLng(), newZoom);\n            var st = this._icon.style;\n            var pixel_width = pixel_ne.x - pixel_sw.x;\n            var pixel_height = pixel_sw.y - pixel_ne.y;\n            st.width = `${pixel_width}px`;\n            st.height = `${pixel_height}px`;\n            st.marginLeft = `${pixel_sw.x - pixel_center.x}px`;\n            st.marginTop = `${pixel_ne.y - pixel_center.y}px`;\n            st.fontSize = `${Math.min(pixel_width, pixel_height, 500) / 2}px`;\n            st.lineHeight = `${pixel_height}px`;\n            this.rectangle.setBounds(bounds);\n        },\n\n        setLabel: function(s) {\n            this._icon.innerHTML = s;\n        },\n\n        getLabel: function() {\n            return this._icon.innerHTML;\n        },\n\n        setSize: function(paperSize, scale) {\n            this.paperSize = paperSize;\n            this.scale = scale;\n            this.updateView();\n        },\n\n        getPrintSize: function() {\n            return L.point(...this.paperSize);\n        },\n\n        rotate: function() {\n            this.paperSize = [this.paperSize[1], this.paperSize[0]];\n            this.updateView();\n        }\n\n    }\n);\n\nexport default PageFeature;\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {getTempMap, disposeMap} from '~/lib/leaflet.layer.rasterize';\nimport {XHRQueue} from '~/lib/xhr-promise';\n\nfunction getLayersForPrint(map, xhrQueue) {\n    function getZIndex(el) {\n        return parseInt(window.getComputedStyle(el).zIndex, 10) || 0;\n    }\n\n    function compare(i1, i2) {\n        if (i1 < i2) {\n            return -1;\n        } else if (i1 > i2) {\n            return 1;\n        }\n        return 0;\n    }\n\n    function getLayerZOrder(layer) {\n        let el = layer._container || layer._path;\n        if (!el) {\n            throw new TypeError('Unsupported layer type');\n        }\n        const order = [];\n        while (el !== layer._map._container) {\n            order.push(getZIndex(el));\n            el = el.parentNode;\n        }\n        return order.reverse();\n    }\n\n    function compareArrays(ar1, ar2) {\n        const len = Math.min(ar1.length, ar2.length);\n        for (let i = 0; i < len; i++) {\n            let c = compare(ar1[i], ar2[i]);\n            if (c) {\n                return c;\n            }\n        }\n        return compare(ar1.length, ar2.length);\n    }\n\n    function compareLayersOrder(layer1, layer2) {\n        return compareArrays(getLayerZOrder(layer1), getLayerZOrder(layer2));\n    }\n\n    let layers = [];\n    map.eachLayer((layer) => {\n            if (layer.options.print) {\n                layers.push(layer);\n            } else {\n                if (layer.meta && layer.options.isOverlay === false) {\n                    throw new Error(`Print disabled for layer ${layer.meta.title}`);\n                }\n            }\n        }\n    );\n    layers.sort(compareLayersOrder);\n    layers = layers.map((l) => l.cloneForPrint({xhrQueue}));\n    return layers;\n}\n\nfunction blendMultiplyCanvas(src, dest) {\n    if (src.width !== dest.width || src.height !== dest.height) {\n        throw new Error('Canvas size mismatch');\n    }\n    var s_data = src.getContext('2d').getImageData(0, 0, src.width, src.height).data;\n    src.width = 0;\n    src.height = 0;\n    var d_image_data = dest.getContext('2d').getImageData(0, 0, dest.width, dest.height);\n    var d_data = d_image_data.data;\n    var data_length = s_data.length,\n        sr, sg, sb, sa, sa1,\n        dr, dg, db,\n        l;\n    for (var i = 0; i < data_length; i += 4) {\n        sa = s_data[i + 3] / 255;\n        if (sa) {\n            sr = s_data[i];\n            sg = s_data[i + 1];\n            sb = s_data[i + 2];\n            dr = d_data[i];\n            dg = d_data[i + 1];\n            db = d_data[i + 2];\n\n            l = (dr + dg + db) / 3;\n            l = l / 255 * 0.5 + 0.5;\n            sa1 = 1 - sa;\n            dr = sr * l * sa + sa1 * dr;\n            dg = sg * l * sa + sa1 * dg;\n            db = sb * l * sa + sa1 * db;\n\n            d_data[i] = dr;\n            d_data[i + 1] = dg;\n            d_data[i + 2] = db;\n        }\n    }\n    s_data = null;\n    dest.getContext('2d').putImageData(d_image_data, 0, 0);\n}\n\nclass PageComposer {\n    constructor(destSize, pixelBoundsAtZoom24) {\n        this.destSize = destSize;\n        this.projectedBounds = pixelBoundsAtZoom24;\n        this.currentCanvas = null;\n        this.currentZoom = null;\n        this.currentTileScale = null;\n        this.targetCanvas = this.createCanvas(destSize);\n    }\n\n    createCanvas(size) {\n        const canvas = L.DomUtil.create('canvas');\n        canvas.width = size.x;\n        canvas.height = size.y;\n        return canvas;\n    }\n\n    putTile(tileInfo) {\n        if (!tileInfo.isOverlay && !tileInfo.image) {\n            return;\n        }\n        let zoom;\n        if (tileInfo.isOverlay) {\n            zoom = tileInfo.overlaySolid ? 'solidOverlay' : 'overlay';\n        } else {\n            zoom = tileInfo.zoom;\n        }\n        if (zoom !== this.currentZoom || tileInfo.tileScale !== this.currentTileScale) {\n            this.mergeCurrentCanvas();\n            this.setupCurrentCanvas(zoom, tileInfo.tileScale);\n        }\n        if (tileInfo.isOverlay) {\n            tileInfo.draw(this.currentCanvas);\n        } else {\n            const ctx = this.currentCanvas.getContext('2d');\n            const {tilePos, tileSize} = tileInfo;\n            ctx.drawImage(\n                tileInfo.image,\n                tilePos.x * tileInfo.tileScale,\n                tilePos.y * tileInfo.tileScale,\n                tileSize.x * tileInfo.tileScale,\n                tileSize.y * tileInfo.tileScale\n            );\n        }\n    }\n\n    setupCurrentCanvas(zoom, tileScale) {\n        let size;\n        if (zoom === 'overlay' || zoom === 'solidOverlay') {\n            size = this.destSize;\n        } else {\n            const q = 1 << (24 - zoom);\n            const\n                topLeft = this.projectedBounds.min.divideBy(q).round(),\n                bottomRight = this.projectedBounds.max.divideBy(q).round();\n            size = bottomRight.subtract(topLeft).multiplyBy(tileScale);\n        }\n        this.currentCanvas = this.createCanvas(size);\n        this.currentZoom = zoom;\n        this.currentTileScale = tileScale;\n    }\n\n    mergeCurrentCanvas() {\n        if (!this.currentCanvas) {\n            return;\n        }\n        if (this.currentZoom === 'overlay') {\n            blendMultiplyCanvas(this.currentCanvas, this.targetCanvas);\n        } else {\n            this.targetCanvas.getContext('2d').drawImage(this.currentCanvas, 0, 0,\n                this.destSize.x, this.destSize.y\n            );\n        }\n        this.currentCanvas.width = 0;\n        this.currentCanvas.height = 0;\n        this.currentCanvas = null;\n    }\n\n    getDataUrl() {\n        this.mergeCurrentCanvas();\n        const dataUrl = this.targetCanvas.toDataURL(\"image/jpeg\");\n        this.targetCanvas.width = 0;\n        this.targetCanvas.height = 0;\n        this.targetCanvas = null;\n        return dataUrl;\n    }\n}\n\nasync function* iterateLayersTiles(\n    layers,\n    latLngBounds,\n    destPixelSize,\n    resolution,\n    scale,\n    zooms,\n    pageLabel,\n    pagesCount\n) {\n    const defaultXHROptions = {\n        responseType: 'blob',\n        timeout: 20000,\n        isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 404\n    };\n    let doStop;\n    for (let layer of layers) {\n        let zoom;\n        if (layer.options && layer.options.scaleDependent) {\n            zoom = zooms.mapZoom;\n        } else {\n            zoom = zooms.satZoom;\n        }\n        let pixelBounds = L.bounds(\n            L.CRS.EPSG3857.latLngToPoint(latLngBounds.getNorthWest(), zoom).round(),\n            L.CRS.EPSG3857.latLngToPoint(latLngBounds.getSouthEast(), zoom).round()\n        );\n        let map;\n        if (!layer._layerDummy) {\n            map = getTempMap(zoom, layer._rasterizeNeedsFullSizeMap, pixelBounds);\n            map.addLayer(layer);\n        }\n        let {iterateTilePromises, count, tileScale = 1} = await layer.getTilesInfo({\n                xhrOptions: defaultXHROptions,\n                pixelBounds,\n                latLngBounds,\n                destPixelSize,\n                resolution,\n                scale,\n                zoom,\n                pageLabel,\n                pagesCount\n            }\n        );\n        let layerPromises = [];\n        for (let tilePromise of iterateTilePromises()) {\n            layerPromises.push(tilePromise.tilePromise);\n            let progressInc = (layer._printProgressWeight || 1) / count;\n            tilePromise.tilePromise = tilePromise.tilePromise.then((tileInfo) => ({\n                zoom,\n                progressInc,\n                layer,\n                tileScale,\n                ...tileInfo,\n            }));\n            doStop = yield tilePromise;\n            if (doStop) {\n                tilePromise.abortLoading();\n                break;\n            }\n        }\n        if (!layer._layerDummy) {\n            if (doStop) {\n                disposeMap(map);\n                break;\n            } else {\n                Promise.all(layerPromises).then(() => disposeMap(map));\n            }\n        }\n    }\n}\n\nasync function* promiseQueueBuffer(source, maxActive) {\n    const queue = [];\n    while (queue.length < maxActive) {\n        let {value, done} = await source.next();\n        if (done) {\n            break;\n        }\n        queue.push(value);\n    }\n\n    while (queue.length) {\n        let doStop = yield queue.shift();\n        if (doStop) {\n            let {value, done} = await source.next(true);\n            if (!done) {\n                queue.push(value);\n            }\n            for (let {abortLoading} of queue) {\n                abortLoading();\n            }\n\n            return;\n        }\n        let {value, done} = await source.next();\n        if (!done) {\n            queue.push(value);\n        }\n    }\n}\n\nasync function renderPages({map, pages, zooms, resolution, scale, progressCallback, decorationLayers}) {\n    const xhrQueue = new XHRQueue();\n    const layers = getLayersForPrint(map, xhrQueue);\n    layers.push(...decorationLayers);\n    let progressRange = 0;\n    for (let layer of layers) {\n        progressRange += layer._printProgressWeight || 1;\n    }\n    progressRange *= pages.length;\n    const pageImagesInfo = [];\n    const renderedLayers = new Set();\n    for (let page of pages) {\n        let destPixelSize = page.printSize.multiplyBy(resolution / 25.4).round();\n        let pixelBounds = L.bounds(\n            map.project(page.latLngBounds.getNorthWest(), 24).round(),\n            map.project(page.latLngBounds.getSouthEast(), 24).round()\n        );\n\n        const composer = new PageComposer(destPixelSize, pixelBounds);\n        let tilesIterator = await iterateLayersTiles(layers, page.latLngBounds, destPixelSize, resolution, scale, zooms,\n            page.label, pages.length);\n        let queuedTilesIterator = promiseQueueBuffer(tilesIterator, 20);\n        while (true) {\n            let {value: tilePromise, done} = await queuedTilesIterator.next();\n            if (done) {\n                break;\n            }\n            let tileInfo;\n            try {\n                tileInfo = await tilePromise.tilePromise;\n            } catch (e) {\n                queuedTilesIterator.next(true);\n                throw e;\n            }\n            progressCallback(tileInfo.progressInc, progressRange);\n            composer.putTile(tileInfo);\n            const {image, draw, layer} = tileInfo;\n            if ((image || draw) && !layer._layerDummy) {\n                renderedLayers.add(layer);\n            }\n        }\n        const dataUrl = composer.getDataUrl();\n        let data = dataUrl.substring(dataUrl.indexOf(',') + 1);\n        data = atob(data);\n        pageImagesInfo.push({\n                data,\n                width: destPixelSize.x,\n                height: destPixelSize.y\n            }\n        );\n    }\n    return {images: pageImagesInfo, renderedLayers};\n}\n\nexport {renderPages};\n","const secrets = {\n    bingKey: '0000000000000000000000000000000000000000000000000000000000000000',\n    thunderforestKey: '00000000000000000000000000000000',\n    sentryDSN: 'https://00000000000000000000000000000000@sentry.io/111111',\n    mapillary: 'ejd0bUg5dzlTZ0VscTZKeTQySHVONDowMzJhZTkzODNiYzVjY2Qz',\n    flickr: '00000000000000000000000000000000',\n    google: 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXX'\n};\n\nexport default secrets;\n","function imgFromDataString(xhr) {\n    if (xhr.status === 200 && xhr.response.size) {\n        const image = new Image();\n        let blobUrl = window.URL.createObjectURL(xhr.response);\n        const promise = new Promise((resolve, reject) => {\n                image.onload = () => {\n                    resolve(image);\n                    window.URL.revokeObjectURL(blobUrl);\n                };\n                image.onerror = () => {\n                    reject(new Error('Image corrupt'));\n                    window.URL.revokeObjectURL(blobUrl);\n                };\n            }\n        );\n        image.src = blobUrl;\n        return promise;\n    }\n    return null;\n}\n\nexport {imgFromDataString};\n","import L from 'leaflet';\nimport {BingLayer} from '~/lib/leaflet.layer.bing';\n\nBingLayer.include({\n        waitTilesReadyToGrab: function() {\n            if (this._url) {\n                return Promise.resolve();\n            }\n            return new Promise((resolve) => {\n                    let i = setInterval(() => {\n                            if (this._url) {\n                                clearInterval(i);\n                                resolve();\n                            }\n                        }, 50\n                    );\n                }\n            );\n        },\n\n        cloneForPrint: function(options) {\n            return new BingLayer(this._key, L.Util.extend({}, this.options, options));\n        },\n    }\n);\n","import L from 'leaflet';\n\nfunction tile2quad(x, y, z) {\n    var quad = '';\n    for (var i = z; i > 0; i--) {\n        var digit = 0;\n        var mask = 1 << (i - 1);\n        if ((x & mask) !== 0) {\n            digit += 1;\n        }\n        if ((y & mask) !== 0) {\n            digit += 2;\n        }\n        quad += digit;\n    }\n    return quad;\n}\n\nconst BingLayer = L.TileLayer.extend({\n    options: {\n        subdomains: [0, 1, 2, 3],\n        type: 'Aerial',\n        attribution: 'Bing',\n        culture: ''\n    },\n\n    initialize: function(key, options) {\n        L.Util.setOptions(this, options);\n\n        this._key = key;\n        this._url = null;\n        this._providers = [];\n        this.metaRequested = false;\n    },\n\n    getTileUrl: function(tilePoint) {\n        var zoom = this._getZoomForUrl();\n        var subdomains = this.options.subdomains,\n            s = this.options.subdomains[Math.abs((tilePoint.x + tilePoint.y) % subdomains.length)];\n        return this._url.replace('{subdomain}', s)\n            .replace('{quadkey}', tile2quad(tilePoint.x, tilePoint.y, zoom))\n            .replace('{culture}', this.options.culture);\n    },\n\n    loadMetadata: function() {\n        if (this.metaRequested) {\n            return;\n        }\n        this.metaRequested = true;\n        var that = this;\n        var cbid = '_bing_metadata_' + L.Util.stamp(this);\n        window[cbid] = function(meta) {\n            window[cbid] = undefined;\n            var e = document.getElementById(cbid);\n            e.parentNode.removeChild(e);\n            if (meta.errorDetails) {\n                throw new Error(meta.errorDetails);\n            }\n            that.initMetadata(meta);\n        };\n        var urlScheme = 'https';\n        var url = urlScheme + '://dev.virtualearth.net/REST/v1/Imagery/Metadata/' +\n            this.options.type + '?include=ImageryProviders&jsonp=' + cbid +\n            '&key=' + this._key + '&UriScheme=' + urlScheme;\n        var script = document.createElement('script');\n        script.type = 'text/javascript';\n        script.src = url;\n        script.id = cbid;\n        document.getElementsByTagName('head')[0].appendChild(script);\n    },\n\n    initMetadata: function(meta) {\n        var r = meta.resourceSets[0].resources[0];\n        this.options.subdomains = r.imageUrlSubdomains;\n        this._url = r.imageUrl;\n        if (r.imageryProviders) {\n            for (var i = 0; i < r.imageryProviders.length; i++) {\n                var p = r.imageryProviders[i];\n                for (var j = 0; j < p.coverageAreas.length; j++) {\n                    var c = p.coverageAreas[j];\n                    var coverage = {zoomMin: c.zoomMin, zoomMax: c.zoomMax, active: false};\n                    var bounds = new L.LatLngBounds(\n                        new L.LatLng(c.bbox[0] + 0.01, c.bbox[1] + 0.01),\n                        new L.LatLng(c.bbox[2] - 0.01, c.bbox[3] - 0.01)\n                    );\n                    coverage.bounds = bounds;\n                    coverage.attrib = p.attribution;\n                    this._providers.push(coverage);\n                }\n            }\n        }\n        this._update();\n    },\n\n    _update: function() {\n        if (this._url === null || !this._map) {\n            return;\n        }\n        this._update_attribution();\n        L.TileLayer.prototype._update.apply(this, []);\n    },\n\n    _update_attribution: function() {\n        var bounds = L.latLngBounds(\n            this._map.getBounds().getSouthWest().wrap(),\n            this._map.getBounds().getNorthEast().wrap()\n        );\n        var zoom = this._map.getZoom();\n        for (var i = 0; i < this._providers.length; i++) {\n            var p = this._providers[i];\n            if ((zoom <= p.zoomMax && zoom >= p.zoomMin) &&\n                bounds.intersects(p.bounds)) {\n                if (!p.active && this._map.attributionControl) {\n                    this._map.attributionControl.addAttribution(p.attrib);\n                }\n                p.active = true;\n            } else {\n                if (p.active && this._map.attributionControl) {\n                    this._map.attributionControl.removeAttribution(p.attrib);\n                }\n                p.active = false;\n            }\n        }\n    },\n\n    onAdd: function(map) {\n        this.loadMetadata();\n        L.TileLayer.prototype.onAdd.apply(this, [map]);\n    },\n\n    onRemove: function(map) {\n        for (var i = 0; i < this._providers.length; i++) {\n            var p = this._providers[i];\n            if (p.active && this._map.attributionControl) {\n                this._map.attributionControl.removeAttribution(p.attrib);\n                p.active = false;\n            }\n        }\n        L.TileLayer.prototype.onRemove.apply(this, [map]);\n    }\n});\n\nexport {BingLayer, tile2quad};\n","import L from 'leaflet';\nimport '~/lib/leaflet.layer.yandex';\n\nL.Layer.Yandex.Map.include({\n    cloneForPrint: function(options) {\n        return new L.Layer.Yandex.Map({...this.options, ...options, yandexScale: 2});\n    },\n\n    getTilesInfo: async function(printOptions) {\n        const tilesInfo = await L.TileLayer.prototype.getTilesInfo.call(this, printOptions);\n        tilesInfo.tileScale = 2;\n        return tilesInfo;\n    },\n});\n\nL.Layer.Yandex.Sat.include({\n    cloneForPrint: function(options) {\n        return new L.Layer.Yandex.Sat({...this.options, ...options});\n    },\n});\n\nL.Layer.Yandex.Tracks.include({\n    cloneForPrint: function(options) {\n        return new L.Layer.Yandex.Tracks({...this.options, ...options});\n    },\n});\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport '~/lib/leaflet.layer.google';\n\nL.Layer.GoogleBase.include({\n    cloneForPrint: function(options) {\n        return new L.Layer.GoogleBase(this._url, L.Util.extend({}, this.options, options));\n    },\n});\n\n","import L from \"leaflet\";\nimport '~/lib/leaflet.layer.westraPasses';\nimport {WestraPassesMarkers} from '~/lib/leaflet.layer.westraPasses/westraPassesMarkers';\nimport '~/lib/leaflet.layer.canvasMarkers';\nimport './CanvasMarkers';\n\nL.Layer.WestraPasses.addInitHook(function() {\n    this.markers.options.print = this.options.print;\n    this.options.print = false;\n});\n\nWestraPassesMarkers.include({\n    waitDataReady: function() {\n        if (this._dataLoaded) {\n            return Promise.resolve();\n        }\n        return new Promise((resolve) => {\n           this.on('data-loaded', resolve);\n        });\n    },\n\n    cloneForPrint: function(options) {\n        options = L.Util.extend({}, this.options, options);\n        return new WestraPassesMarkers(this._baseUrl, options);\n    },\n\n    getTilesInfo: async function(printOptions) {\n        await this.waitDataReady();\n        return L.Layer.CanvasMarkers.prototype.getTilesInfo.call(this, printOptions);\n    }\n});\n","import L from 'leaflet';\nimport './westraPasses.css';\nimport '~/lib/leaflet.layer.geojson-ajax';\nimport {WestraPassesMarkers} from './westraPassesMarkers';\n\nL.Layer.WestraPasses = L.Layer.extend({\n        options: {\n            fileCoverage: 'westra_coverage.json',\n            fileLabels1: 'westra_regions_labels1.json',\n            fileLabels2: 'westra_regions_labels2.json',\n            scaleDependent: true,\n            labels2Zoom: 6,\n            markersZoom: 10,\n            labels1Zoom: 2\n\n        },\n\n        initialize: function(baseUrl, options) {\n            L.setOptions(this, options);\n            this.markers = new WestraPassesMarkers(baseUrl, options.markersOptions);\n            this.coverage = new L.Layer.GeoJSONAjax(baseUrl + this.options.fileCoverage, {\n                className: 'westra-coverage-polygon',\n                onEachFeature: this._setEventsForRegion.bind(this)\n            });\n            this.labels1 = new L.Layer.GeoJSONAjax(baseUrl + this.options.fileLabels1, {\n                pointToLayer: this._makeMarker,\n                onEachFeature: this._setEventsForRegion.bind(this)\n            });\n            this.labels2 = new L.Layer.GeoJSONAjax(baseUrl + this.options.fileLabels2, {\n                pointToLayer: this._makeMarker,\n                onEachFeature: this._setEventsForRegion.bind(this)\n            });\n        },\n\n        _setEventsForRegion: function(feature, layer) {\n            layer.on('click', this._onRegionClick, this);\n        },\n\n        _makeMarker: function(geojsonPoint, latlng) {\n            const icon = L.divIcon({\n                    className: 'westra-region-label',\n                    html: '<span>' + geojsonPoint.properties.name + '</span>'\n                }\n            );\n            const marker = L.marker(latlng, {icon: icon});\n            return marker;\n        },\n\n        _onRegionClick: function(e) {\n            const layer = e.target;\n            const latlng = layer.getLatLng ? layer.getLatLng() : e.latlng;\n            const zoom = this._map.getZoom();\n            let newZoom;\n            if (zoom < this.options.labels2Zoom) {\n                newZoom = this.options.labels2Zoom;\n            } else {\n                newZoom = this.options.markersZoom;\n            }\n            this._map.setView(latlng, newZoom);\n        },\n\n        setLayersVisibility: function(e) {\n            if (!this._map) {\n                return;\n            }\n            var newZoom;\n            var zoomFinished = e ? (e.type !== 'zoomanim') : true;\n            if (e && e.zoom !== undefined) {\n                newZoom = e.zoom;\n            } else {\n                newZoom = this._map.getZoom();\n            }\n            if (newZoom < this.options.labels1Zoom) {\n                this._map.removeLayer(this.markers);\n                this._map.addLayer(this.coverage);\n                this._map.removeLayer(this.labels1);\n                this._map.removeLayer(this.labels2);\n            } else if (newZoom < this.options.labels2Zoom) {\n                this._map.removeLayer(this.markers);\n                this._map.addLayer(this.coverage);\n                this._map.addLayer(this.labels1);\n                this._map.removeLayer(this.labels2);\n            } else if (newZoom < this.options.markersZoom) {\n                this._map.removeLayer(this.markers);\n                this._map.addLayer(this.coverage);\n                this._map.removeLayer(this.labels1);\n                this._map.addLayer(this.labels2);\n            } else {\n                if (zoomFinished) {\n                    this._map.addLayer(this.markers);\n                }\n                this._map.removeLayer(this.coverage);\n                this._map.removeLayer(this.labels1);\n                this._map.removeLayer(this.labels2);\n            }\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            this.markers.loadData();\n            this.coverage.loadData();\n            this.labels1.loadData();\n            this.labels2.loadData();\n            this.setLayersVisibility();\n            map.on('zoomend', this.setLayersVisibility, this);\n            map.on('zoomanim', this.setLayersVisibility, this);\n        },\n\n        onRemove: function() {\n            this._map.removeLayer(this.markers);\n            this._map.removeLayer(this.coverage);\n            this._map.removeLayer(this.labels1);\n            this._map.removeLayer(this.labels2);\n            this._map.off('zoomend', this.setLayersVisibility, this);\n            this._map.off('zoomanim', this.setLayersVisibility, this);\n            this._map = null;\n        }\n    }\n);\n\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {fetch} from '~/lib/xhr-promise';\nimport {notify} from '~/lib/notifications';\nimport * as logging from '~/lib/logging';\n\nL.Layer.GeoJSONAjax = L.GeoJSON.extend({\n        options: {\n            requestTimeout: 30000\n        },\n\n        initialize: function(url, options) {\n            L.GeoJSON.prototype.initialize.call(this, null, options);\n            this.url = url;\n        },\n\n        // Promise can be rejected if json invalid or addData fails\n        loadData: function() {\n            if (this._loadStarted) {\n                return;\n            }\n            this._loadStarted = true;\n            fetch(this.url, {timeout: this.options.requestTimeout})\n                .then(\n                    (xhr) => {\n                        this.addData(JSON.parse(xhr.response));\n                    },\n                    (e) => {\n                        logging.captureException(e, 'failed to get geojson');\n                        notify(`Failed to get GeoJSON data from ${this.url}: ${e.message}`);\n                    }\n                );\n        },\n\n        onAdd: function(map) {\n            L.GeoJSON.prototype.onAdd.call(this, map);\n            this.loadData();\n        }\n    }\n);\n\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport '~/lib/leaflet.polyline-measure';\n\nL.Polyline.include({\n        _printProgressWeight: 0.1,\n        printWidthMm: 1,\n\n        cloneForPrint: function(options) {\n            options = L.Util.extend({}, this.options, options);\n            const latlngs = this.getLatLngs().map((latlng) => latlng.clone());\n            return new L.Polyline(latlngs, options);\n        },\n\n        _makelatLngToCanvasPixelTransformer: function(printOptions, shift) {\n            const projectedBounds = printOptions.pixelBounds;\n            const scale = projectedBounds.getSize().unscaleBy(printOptions.destPixelSize);\n            const origin = projectedBounds.min;\n            return function(latlng) {\n                return L.CRS.EPSG3857.latLngToPoint(latlng, printOptions.zoom)\n                    .subtract(origin)\n                    .add(L.point([shift, 0]))\n                    .unscaleBy(scale);\n            };\n        },\n\n        _shift: function(targetBounds, zoom) {\n            const polylineBounds = this.getBounds();\n            let shift = 0;\n            const worldWidth = L.CRS.EPSG3857.getProjectedBounds(zoom).getSize().x;\n            if (polylineBounds.isValid()) {\n                const polylineCenter = polylineBounds.getCenter();\n                const targetCenter = targetBounds.getCenter();\n\n                if (polylineCenter.lng < targetCenter.lng - 180) {\n                    shift = 1;\n                } else if (polylineCenter.lng > targetCenter.lng + 180) {\n                    shift = -1;\n                } else {\n                    shift = 0;\n                }\n            }\n            return {lng: shift * 360, projected: worldWidth * shift};\n        },\n\n        _drawRaster: function(canvas, printOptions) {\n            const latlngs = this.getLatLngs();\n            const shift = this._shift(printOptions.latLngBounds, printOptions.zoom);\n            const lineBounds = this.getBounds();\n            if (latlngs.length < 2) {\n                return false;\n            }\n            const shiftedLineBounds = L.latLngBounds([\n                [lineBounds.getNorth(), lineBounds.getWest() + shift.lng],\n                [lineBounds.getSouth(), lineBounds.getEast() + shift.lng]\n            ]);\n            if (!shiftedLineBounds.intersects(printOptions.latLngBounds)) {\n                return false;\n            }\n\n            const ctx = canvas.getContext('2d');\n            ctx.lineWidth = this.printWidthMm / 25.4 * printOptions.resolution;\n            ctx.lineJoin = 'round';\n            ctx.lineCap = 'round';\n            ctx.strokeStyle = this.options.color;\n            const transform = this._makelatLngToCanvasPixelTransformer(printOptions, shift.projected);\n            let point;\n            ctx.beginPath();\n\n            point = transform(latlngs[0]);\n            ctx.moveTo(point.x, point.y);\n            for (let i = 1; i < latlngs.length; i++) {\n                point = transform(latlngs[i]);\n                ctx.lineTo(point.x, point.y);\n            }\n            ctx.stroke();\n            return true;\n        },\n\n        getTilesInfo: async function(printOptions) {\n            return {\n                iterateTilePromises: (function*() {\n                    yield {\n                        tilePromise: Promise.resolve({\n                                draw: (canvas) => this._drawRaster(canvas, printOptions),\n                                isOverlay: true\n                            }\n                        ),\n                        abortLoading: () => {\n                            // no actions needed\n                        }\n                    };\n                }).bind(this),\n                count: 1\n            };\n        }\n    }\n);\n\nL.MeasuredLine.include({\n        tickFontSizeMm: 2.5,\n\n        cloneForPrint: function(options) {\n            options = L.Util.extend({}, this.options, options);\n            const latlngs = this.getLatLngs().map((latlng) => latlng.clone());\n            return new L.MeasuredLine(latlngs, options);\n        },\n\n        _drawRaster: function(canvas, printOptions) {\n            if (!L.Polyline.prototype._drawRaster.call(this, canvas, printOptions)) {\n                return;\n            }\n            if (!this.options.measureTicksShown) {\n                return;\n            }\n            const minTicksIntervalMeters = printOptions.scale * 1.5;\n            const ctx = canvas.getContext('2d');\n            const ticks = this.getTicksPositions(minTicksIntervalMeters);\n            const ticksPixelSize = this.tickFontSizeMm / 25.4 * printOptions.resolution;\n            const shift = this._shift(printOptions.latLngBounds, printOptions.zoom);\n            const transform = this._makelatLngToCanvasPixelTransformer(printOptions, shift.projected);\n            ctx.font = `bold ${ticksPixelSize}px verdana`;\n            ctx.fillStyle = this.options.color;\n            for (let tick of ticks) {\n                let m = tick.transformMatrix;\n                let label = '\\u2501\\u2501 ' + Math.round((tick.distanceValue / 10)) / 100 + ' km';\n                let position = transform(tick.position);\n                ctx.setTransform(m[0], m[1], m[2], m[3], position.x, position.y);\n                ctx.fillText(label, 0, ticksPixelSize * 0.3);\n                ctx.setTransform(1, 0, 0, 1, 0, 0);\n            }\n        }\n    }\n);\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\n\nimport {RetinaTileLayer} from '~/lib/leaflet.layer.RetinaTileLayer';\nimport './TileLayer';\n\nRetinaTileLayer.include({\n    cloneForPrint: function(options) {\n        const newOptions = L.Util.extend({}, this.options, options);\n        return new RetinaTileLayer(this.urls, newOptions, newOptions.scaleDependent);\n    },\n\n    getTilesInfo: async function(printOptions) {\n        const tilesInfo = await L.TileLayer.prototype.getTilesInfo.call(this, printOptions);\n        tilesInfo.tileScale = this.tileSizeMultiplicator;\n        return tilesInfo;\n    },\n});\n","export default \"<div class=\\\"leaflet-control-button-toggle\\\" title=\\\"Print map\\\"\\n     data-bind=\\\"click: setExpanded, css: {'icon-spinner-nuclear': makingPdf, 'icon-printer': !makingPdf()}\\\">\\n    </div>\\n<div class=\\\"leaflet-control-content\\\">\\n<table class=\\\"layout\\\">\\n    <tbody>\\n    <tr><td colspan=\\\"2\\\">\\n        <a title=\\\"Add page in portrait orientation\\\" class=\\\"button-add-page-vert image-button\\\"\\n           data-bind=\\\"click: addPortraitPage\\\"></a>\\n        <a title=\\\"Add page in landscape orientation\\\" class=\\\"button-add-page-horiz image-button\\\"\\n           data-bind=\\\"click: addLandscapePage\\\"></a>\\n        <span class=\\\"pages-num\\\" data-bind=\\\"text: pagesNumLabel, click: onPagesNumLabelClick, css: {'pages-not-null': pagesNum() > 0}\\\"></span>\\n        <a title=\\\"Remove all pages\\\" class=\\\"button-remove-pages image-button\\\"\\n           data-bind=\\\"click: removePages\\\"></a>\\n    </td></tr>\\n    <tr>\\n        <td class=\\\"label\\\">Print scale</td>\\n        <td>\\n            <div class=\\\"preset-values\\\" >\\n                <a data-bind=\\\"click: function() {scale(100)}, css: {selected: scale() === 100}\\\">100 m</a>\\n                <a data-bind=\\\"click: function() {scale(500)}, css: {selected: scale() === 500}\\\">500 m</a>\\n                <a data-bind=\\\"click: function() {scale(1000)}, css: {selected: scale() === 1000}\\\">1 km</a>\\n            </div>\\n            <input type=\\\"text\\\" class=\\\"scale\\\" maxlength=\\\"6\\\" data-bind=\\\"value: scale\\\">&nbsp;m in 1 cm\\n        </td>\\n    </tr>\\n    <tr data-bind=\\\"visible: settingsExpanded\\\">\\n        <td class=\\\"label\\\">Page size</td>\\n        <td>\\n            <div class=\\\"preset-values\\\" data-bind=\\\"foreach: {data: pageSizes, as: 'size'}\\\">\\n                <a data-bind=\\\"click: function() {$root.pageWidth(size.width); $root.pageHeight(size.height)},\\n                              text: size.name,\\n                              css: {selected: size.name === $root.pageSizeDescription() }\\\"></a>\\n            </div>\\n            <input type=\\\"text\\\" maxlength=\\\"4\\\" title=\\\"width\\\" placeholder=\\\"width\\\" class=\\\"page-size\\\" data-bind=\\\"value: pageWidth\\\">\\n            x <input type=\\\"text\\\" maxlength=\\\"4\\\" title=\\\"height\\\" placeholder=\\\"height\\\" class=\\\"page-size\\\" data-bind=\\\"value: pageHeight\\\"> mm\\n        </td>\\n    </tr>\\n    <tr data-bind=\\\"visible: settingsExpanded\\\">\\n        <td class=\\\"label-high\\\">Margins</td>\\n        <td>\\n            <table class=\\\"margins\\\">\\n                <tr>\\n                    <td></td>\\n                    <td><input type=\\\"text\\\" maxlength=\\\"2\\\" value=\\\"3\\\" data-bind=\\\"value: marginTop\\\"></td>\\n                    <td></td>\\n                </tr>\\n                <tr>\\n                    <td><input type=\\\"text\\\" maxlength=\\\"2\\\" value=\\\"3\\\" data-bind=\\\"value: marginLeft\\\"></td>\\n                    <td></td><td><input type=\\\"text\\\" maxlength=\\\"2\\\" value=\\\"3\\\" data-bind=\\\"value: marginRight\\\"> mm</td>\\n                </tr>\\n                <tr><td></td><td><input type=\\\"text\\\" maxlength=\\\"2\\\" value=\\\"3\\\" data-bind=\\\"value: marginBottom\\\"></td><td></td></tr>\\n            </table>\\n        </td>\\n    </tr>\\n    <tr data-bind=\\\"visible: settingsExpanded\\\">\\n        <td class=\\\"label\\\">Resolution</td>\\n        <td><input type=\\\"text\\\" maxlength=\\\"4\\\" class=\\\"resolution\\\" data-bind=\\\"value: resolution\\\"> dpi</td>\\n    </tr>\\n    <tr data-bind=\\\"visible: settingsExpanded\\\">\\n        <td class=\\\"label\\\">Source zoom<br />level</td>\\n        <td>\\n            <select name=\\\"srczoom\\\"\\n                    data-bind=\\\"options: zoomLevels, value: zoomLevel\\\">\\n            </select>\\n        </td>\\n    </tr>\\n    <tr>\\n        <td colspan=\\\"2\\\">\\n            <label><input type=\\\"checkbox\\\" data-bind=\\\"checked: magneticMeridiansOn\\\"> Magnetic meridians</label>\\n            <label><input type=\\\"checkbox\\\" data-bind=\\\"checked: gridOn\\\"> Kilometers grid</label>\\n        </td>\\n    </tr>\\n    <tr><td colspan=\\\"2\\\">\\n        <a class=\\\"button-settings image-button\\\" data-bind=\\\"click: function() {settingsExpanded(!settingsExpanded())}\\\"\\n            title=\\\"More settings\\\"></a>\\n        <div class=\\\"settings-summary\\\">\\n            <span data-bind=\\\"text: pageSizeDescription\\\"></span><br/>\\n            <span data-bind=\\\"text: resolution\\\"></span>&nbsp;dpi,\\n            zoom&nbsp;<span data-bind=\\\"text: zoomLevel\\\"></span>\\n            <!-- ko if: zoomLevel()=== \\\"auto\\\" -->\\n            (<span title=\\\"Zoom for satellite and scanned imagery\\\" data-bind=\\\"text: autoZoomLevels().satZoom\\\"></span>&nbsp;\\n            /&nbsp;<span title=\\\"Zoom for maps like OSM and Google\\\" data-bind=\\\"text: autoZoomLevels().mapZoom\\\"></span>)\\n            <!-- /ko -->\\n        </div>\\n    </td></tr>\\n    <tr><td colspan=\\\"2\\\">\\n        <div class=\\\"download-button-row\\\">\\n            <div class=\\\"button-minimize\\\" data-bind=\\\"click: setMinimized\\\"></div>\\n            <a class=\\\"text-button button-save\\\" data-bind=\\\"\\n                                click: onSavePdfClicked,\\n                                visible: !makingPdf()\\\">Save PDF</a>\\n            <div data-bind=\\\"\\n                                component: { \\n                                    name: 'progress-indicator',\\n                                    params: {progressRange: downloadProgressRange, progressDone: downloadProgressDone}\\n                                },\\n                                visible: makingPdf()\\\"></div>\\n        </div>\\n    </td></tr>\\n    </tbody>\\n</table>\\n</div>\\n\";","function header() {\n    return '%PDF-1.3';\n}\n\nfunction eof() {\n    return '%%EOF\\n';\n}\n\nfunction recCatalog() {\n    return (\n`1 0 obj\n<< /Type /Catalog\n/Pages 2 0 R\n>>\nendobj`);\n}\n\nfunction recPages(count) {\n    let kidsIds = [];\n    for (let i = 0; i < count; i++) {\n        kidsIds.push(`${i * 3 + 3} 0 R`);\n    }\n    kidsIds = kidsIds.join(' ');\n    return (\n`2 0 obj\n<< /Type /Pages        \n/Kids [ ${kidsIds} ]\n/Count ${count}\n>>\nendobj`);\n}\n\nfunction recPage(serialNum, width, height) {\n    const pageRecId = serialNum * 3 + 3;\n    const contentRecId = pageRecId + 1;\n    const imageRecId = pageRecId + 2;\n    return (\n`${pageRecId} 0 obj\n<< /Type /Page\n/Parent 2 0 R\n/MediaBox [0 0 ${width} ${height}]\n/Contents ${contentRecId} 0 R\n/Rotate ${width > height ? 90 : 0}\n/Resources <<\n    /XObject << /Im${serialNum} ${imageRecId} 0 R >>\n    /ProcSet [ /PDF /Text /ImageC ] \n    >>\n>>\nendobj`);\n}\n\nfunction recContent(serialNum, width, height) {\n    const pageRecId = serialNum * 3 + 3;\n    const contentRecId = pageRecId + 1;\n    const contents = (\n`q\n${width} 0 0 ${height} 0 0 cm\n/Im${serialNum} Do\nQ   `);\n    return (\n`${contentRecId} 0 obj\n<<\n/Length ${contents.length + 1}\n>>\nstream\n${contents}   \nendstream\nendobj`);\n}\n\nfunction recImage(serialNum, widthPixels, heightPixels, data) {\n    const pageRecId = serialNum * 3 + 3;\n    const imageRecId = pageRecId + 2;\n\n    return (\n`${imageRecId} 0 obj\n<< /Type /XObject\n/Subtype /Image\n/Name /Im${serialNum}\n/Filter [ /DCTDecode ]\n/Width ${widthPixels}\n/Height ${heightPixels}\n/ColorSpace /DeviceRGB\n/BitsPerComponent 8\n/Length ${data.length}\n>>\nstream\n${data}\nendstream\nendobj`);\n}\n\nfunction recTrailer(recOffsets, currentOffset) {\n    const trailer = [];\n    trailer.push(\n`xref\n0 ${recOffsets.length + 1}\n0000000000 65535 f `);\n    const zeroes = '0000000000';\n    for (let offset of recOffsets) {\n        offset = offset.toString();\n        let padding = zeroes.substr(offset.length);\n        trailer.push(`${padding}${offset} 00000 n `);\n    }\n\n    trailer.push(\n`trailer\n<< /Root 1 0 R\n/Size ${recOffsets.length + 1}\n>>\nstartxref\n${currentOffset}`);\n    return trailer.join('\\n');\n}\n\nfunction makePdf(imagesInfo, resolution) {\n    let offset = 0;\n    const offsets = [];\n    let pdf = [];\n\n    function addRec(s, skipOffset) {\n        pdf.push(s);\n        if (!skipOffset) {\n            offsets.push(offset);\n        }\n        offset += s.length;\n    }\n\n    addRec(header(), true);\n    addRec(recCatalog());\n    addRec(recPages(imagesInfo.length));\n    for (let [i, {data, width, height}] of imagesInfo.entries()) {\n        let widthPoints = width / resolution * 72,\n            heightPoints = height / resolution * 72;\n        addRec(recPage(i, widthPoints, heightPoints));\n        addRec(recContent(i, widthPoints, heightPoints));\n        addRec(recImage(i, width, height, data));\n    }\n    addRec(recTrailer(offsets, offset), true);\n    addRec(eof(), true);\n\n    pdf = pdf.join('\\n');\n    return pdf;\n}\n\nexport {makePdf};\n\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {getDeclination} from '~/lib/magnetic-declination';\nimport {PrintStaticLayer} from './decorations';\n\nfunction radians(degrees) {\n    return degrees * Math.PI / 180;\n}\n\nfunction movePoint(p, angle, dist) {\n    angle = radians(angle);\n    return L.point(p.x + Math.sin(angle) * dist, p.y - Math.cos(angle) * dist);\n}\n\nclass MagneticMeridians extends PrintStaticLayer {\n    lineThicknessMm = 0.2;\n    lineIntervalMm = 50;\n    samplingIntervalMm = 15;\n    color = '#66c2ff';\n    overlaySolid = false;\n\n    _makeCanvasToLatLngTransformer(printOptions) {\n        const projectedBounds = printOptions.pixelBounds;\n        const scale = projectedBounds.getSize().unscaleBy(printOptions.destPixelSize);\n        const origin = projectedBounds.min;\n        return function(pixel) {\n            return L.CRS.EPSG3857.pointToLatLng(pixel.scaleBy(scale).add(origin), printOptions.zoom);\n        };\n    }\n\n    _drawRaster(canvas, printOptions) {\n        const toLatLng = this._makeCanvasToLatLngTransformer(printOptions);\n        const ctx = canvas.getContext('2d');\n        ctx.beginPath();\n        ctx.strokeStyle = this.color;\n        ctx.lineWidth = this.lineThicknessMm / 25.4 * printOptions.resolution;\n        const intervalPx = this.lineIntervalMm / 25.4 * printOptions.resolution;\n        const samplingPx = this.samplingIntervalMm / 25.4 * printOptions.resolution;\n        const pageDiagonal = Math.sqrt(\n            printOptions.destPixelSize.x * printOptions.destPixelSize.x +\n            printOptions.destPixelSize.y * printOptions.destPixelSize.y\n        );\n        const maxSegments = pageDiagonal / 2 / samplingPx;\n\n        function drawLine(p, directionDown) {\n            ctx.moveTo(p.x, p.y);\n\n            for (let i = 0; i <= maxSegments; i++) {\n                let latLng = toLatLng(p);\n                let declination = getDeclination(latLng.lat, latLng.lng);\n                if (declination === null) {\n                    break;\n                }\n                if (directionDown) {\n                    declination += 180;\n                }\n                p = movePoint(p, declination, samplingPx);\n                ctx.lineTo(p.x, p.y);\n            }\n        }\n\n        const center = printOptions.destPixelSize.divideBy(2);\n        const maxLines = pageDiagonal / 2 / intervalPx;\n\n        drawLine(center);\n        drawLine(center, true);\n\n        let p = center;\n        for (let i = 0; i <= maxLines; i++) {\n            let latLng = toLatLng(p);\n            let declination = getDeclination(latLng.lat, latLng.lng);\n            if (declination === null) {\n                declination = 0;\n            }\n            p = movePoint(p, declination + 90, intervalPx);\n            drawLine(p);\n            drawLine(p, true);\n        }\n        p = center;\n        for (let i = 0; i <= maxLines; i++) {\n            let latLng = toLatLng(p);\n            let declination = getDeclination(latLng.lat, latLng.lng);\n            if (declination === null) {\n                declination = 0;\n            }\n            p = movePoint(p, declination - 90, intervalPx);\n            drawLine(p);\n            drawLine(p, true);\n        }\n\n        ctx.stroke();\n    }\n}\n\nexport {MagneticMeridians};\n","import {PrintStaticLayer} from './decorations';\n\nfunction pageScaleRange(printOptions) {\n    const pageSize = printOptions.destPixelSize.divideBy(printOptions.resolution / 25.4);\n    const bounds = printOptions.latLngBounds;\n    const southLen = bounds.getSouthEast().distanceTo(bounds.getSouthWest());\n    const northLen = bounds.getNorthEast().distanceTo(bounds.getNorthWest());\n    const nScale = Math.round(northLen / pageSize.x * 10);\n    const sScale = Math.round(southLen / pageSize.x * 10);\n    return {\n        min: Math.min(nScale, sScale, printOptions.scale),\n        max: Math.max(nScale, sScale, printOptions.scale)\n    };\n}\n\nfunction formatScale(nominalScale, scaleRange) {\n    const threshold = 0.05;\n    if (\n        Math.abs(nominalScale - scaleRange.min) / nominalScale > threshold ||\n        Math.abs(nominalScale - scaleRange.max) / nominalScale > threshold\n    ) {\n        let unit;\n        scaleRange = {...scaleRange};\n        if (scaleRange.min >= 1000) {\n            scaleRange.min /= 1000;\n            scaleRange.max /= 1000;\n            unit = 'km';\n        } else {\n            unit = 'm';\n        }\n        return `${scaleRange.min} – ${scaleRange.max} ${unit} in 1 cm`;\n    }\n    let unit;\n    if (nominalScale >= 1000) {\n        nominalScale /= 1000;\n        unit = 'km';\n    } else {\n        unit = 'm';\n    }\n    return `${nominalScale} ${unit} in 1 cm`;\n}\n\nclass OverlayScale extends PrintStaticLayer {\n    fontSizeMm = 3;\n    font = 'verdana';\n    paddingMm = 1;\n    overlaySolid = true;\n\n    _drawRaster(canvas, printOptions) {\n        const ctx = canvas.getContext('2d');\n        let caption = formatScale(printOptions.scale, pageScaleRange(printOptions));\n        if (printOptions.pagesCount > 1) {\n            caption += ` | Page ${printOptions.pageLabel} / ${printOptions.pagesCount}`;\n        }\n        const fontSize = this.fontSizeMm / 25.4 * printOptions.resolution;\n        const padding = this.paddingMm / 25.4 * printOptions.resolution;\n        ctx.font = `${fontSize}px ${this.font}`;\n        const textWidth = ctx.measureText(caption).width;\n        ctx.textBaseline = 'bottom';\n        ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';\n        ctx.fillRect(0, 0, textWidth + 2 * padding, fontSize + 2 * padding);\n        ctx.fillStyle = '#000000';\n        ctx.fillText(caption, padding, fontSize + padding);\n    }\n}\n\nexport {OverlayScale};\n","import {PrintStaticLayer} from './decorations';\nimport L from 'leaflet';\n\nfunction radians(degrees) {\n    return degrees * Math.PI / 180;\n}\n\nclass Grid extends PrintStaticLayer {\n    minGridIntervalMm = 15;\n\n    fontSizeMm = 3;\n    font = 'verdana';\n    paddingMm = 1;\n\n    /* eslint-disable array-element-newline*/\n    intervals = [\n        1, 1.5, 2, 3.3, 5, 7.5,\n        10, 15, 20, 33, 50, 75,\n        100, 150, 200, 333, 500, 750,\n        1000, 1500, 2000, 4000, 5000, 7500,\n        10000, 15000, 20000, 40000, 50000, 75000,\n        100000, 150000, 200000, 400000, 500000, 750000,\n        1000000, 1500000, 2000000, 4000000, 5000000, 7500000\n    ];\n    /* eslint-enable array-element-newline*/\n\n    getGridInterval(printOptions) {\n        const minGridIntervalM = this.minGridIntervalMm / 10 * printOptions.scale;\n        let intervalM;\n        for (intervalM of this.intervals) {\n            if (intervalM > minGridIntervalM) {\n                break;\n            }\n        }\n        return intervalM;\n    }\n\n    formatDistance(x) {\n        let unit;\n        if (x < 1000) {\n            unit = 'm';\n        } else {\n            x /= 1000;\n            unit = 'km';\n        }\n        if (x % 1) {\n            x = x.toFixed(1);\n        }\n        return `${x} ${unit}`;\n    }\n\n    _drawGrid(canvas, printOptions) {\n        const metersPerDegree = L.Projection.SphericalMercator.R * Math.PI / 180;\n        const ctx = canvas.getContext('2d');\n        ctx.beginPath();\n        const pixelsPerMm = 1 / 25.4 * printOptions.resolution;\n        const intervalM = this.getGridInterval(printOptions);\n        const width = printOptions.destPixelSize.x;\n        const height = printOptions.destPixelSize.y;\n        const mercatorBounds = L.bounds(\n            L.Projection.SphericalMercator.project(printOptions.latLngBounds.getNorthWest()),\n            L.Projection.SphericalMercator.project(printOptions.latLngBounds.getSouthEast())\n        );\n        const canvasToMercatorScale = mercatorBounds.getSize().unscaleBy(printOptions.destPixelSize);\n        const rows = [];\n        let y = height;\n        while (true) {\n            let yMerc = mercatorBounds.max.y - y * canvasToMercatorScale.y;\n            let lat = L.Projection.SphericalMercator.unproject(L.point(0, yMerc)).lat;\n            rows.push({lat, y});\n            if (y < 0) {\n                break;\n            }\n            let lat2 = lat + intervalM / metersPerDegree;\n            let yMerc2 = L.Projection.SphericalMercator.project(L.latLng(lat2, 0)).y;\n            y = (mercatorBounds.max.y - yMerc2) / canvasToMercatorScale.y;\n        }\n        const lineWidthMm = 0.15;\n        let lineWidthPx = lineWidthMm * pixelsPerMm;\n        for (let {color, offset} of [\n            {color: '#D9D9D9', offset: lineWidthPx / 2},\n            {color: '#8C8C8C', offset: -lineWidthPx / 2},\n        ]) {\n            ctx.beginPath();\n\n            ctx.lineWidth = lineWidthPx;\n            ctx.strokeStyle = color;\n\n            for ({y} of rows) {\n                ctx.moveTo(0, y + offset);\n                ctx.lineTo(width, y + offset);\n            }\n            const pageCanvasCenterX = printOptions.destPixelSize.x / 2;\n            for (let direction of [-1, 1]) {\n                let colN = 0;\n                while (true) {\n                    let firstRow = true;\n                    let hasPointInPage = false;\n                    for (let {lat, y} of rows) {\n                        let dx = colN * intervalM / Math.cos(radians(lat)) / canvasToMercatorScale.x;\n                        // eslint-disable-next-line max-depth\n                        if (dx < pageCanvasCenterX) {\n                            hasPointInPage = true;\n                        }\n                        // eslint-disable-next-line max-depth\n                        if (firstRow) {\n                            ctx.moveTo(pageCanvasCenterX + dx * direction + offset, y);\n                        } else {\n                            ctx.lineTo(pageCanvasCenterX + dx * direction + offset, y);\n                        }\n                        firstRow = false;\n                    }\n                    if (!hasPointInPage) {\n                        break;\n                    }\n                    colN += 1;\n                }\n            }\n            ctx.stroke();\n        }\n    }\n\n    _drawLabel(canvas, printOptions) {\n        const intervalM = this.getGridInterval(printOptions);\n        const height = printOptions.destPixelSize.y;\n        const ctx = canvas.getContext('2d');\n        const caption = 'Grid ' + this.formatDistance(intervalM);\n        const fontSize = this.fontSizeMm / 25.4 * printOptions.resolution;\n        const padding = this.paddingMm / 25.4 * printOptions.resolution;\n        ctx.font = `${fontSize}px ${this.font}`;\n        const textWidth = ctx.measureText(caption).width;\n        ctx.textBaseline = 'bottom';\n        ctx.fillStyle = 'rgba(255, 255, 255, 0.7)';\n        ctx.fillRect(0, height - fontSize - 2 * padding, textWidth + 2 * padding, fontSize + 2 * padding);\n        ctx.fillStyle = '#000000';\n        ctx.fillText(caption, padding, height - padding);\n    }\n\n    async getTilesInfo(printOptions) {\n        return {\n            iterateTilePromises: (function*() {\n                yield {\n                    tilePromise: Promise.resolve({\n                            draw: (canvas) => this._drawGrid(canvas, printOptions),\n                            isOverlay: true,\n                            overlaySolid: false\n                        }\n                    ),\n                    abortLoading: () => {\n                        // no actions needed\n                    }\n                };\n                yield {\n                    tilePromise: Promise.resolve({\n                            draw: (canvas) => this._drawLabel(canvas, printOptions),\n                            isOverlay: true,\n                            overlaySolid: true\n                        }\n                    ),\n                    abortLoading: () => {\n                        // no actions needed\n                    }\n                };\n            }).bind(this),\n            count: 2\n        };\n    }\n}\n\nexport {Grid};\n","import L from 'leaflet';\nimport './style.css';\nimport '~/lib/leaflet.control.commons';\n\nL.Control.Caption = L.Control.extend({\n    options: {\n        position: 'bottomright',\n        className: 'leaflet-control-caption'\n    },\n\n    initialize: function(contents, options) {\n        L.setOptions(this, options);\n        this._contents = contents;\n    },\n\n    onAdd: function(map) {\n        this._map = map;\n        this._container = L.DomUtil.create('div', this.options.className);\n        this._container.innerHTML = this._contents;\n        L.DomEvent.on(this._container, 'contextmenu', (e) => {\n            L.DomEvent.stopPropagation(e);\n            e.returnValue = true;\n            return true;\n        });\n        return this._container;\n    },\n\n    setContents: function(contents) {\n        this._contents = contents;\n        if (this._map) {\n            this._container.innerHTML = this._contents;\n        }\n    }\n\n});\n\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport ko from 'knockout';\nimport './coordinates.css';\nimport copyToClipboard from '~/lib/clipboardCopy';\nimport Contextmenu from '~/lib/contextmenu';\nimport {makeButtonWithBar} from '~/lib/leaflet.control.commons';\nimport safeLocalStorage from '~/lib/safe-localstorage';\nimport '~/lib/controls-styles/controls-styles.css';\nimport * as formats from './formats';\n\nconst DEFAULT_FORMAT = formats.DEGREES;\nconst UNKNOWN_COORDINATES = {\n    lat: '-------',\n    lng: '-------'\n};\n\nL.Control.Coordinates = L.Control.extend({\n        options: {\n            position: 'bottomleft'\n        },\n\n        formats: [\n            formats.SIGNED_DEGREES,\n            formats.DEGREES,\n            formats.DEGREES_AND_MINUTES,\n            formats.DEGREES_AND_MINUTES_AND_SECONDS\n        ],\n\n        initialize: function(options) {\n            L.Control.prototype.initialize.call(this, options);\n\n            this.latlng = ko.observable();\n            this.format = ko.observable(DEFAULT_FORMAT);\n            this.formatCode = ko.pureComputed({\n                read: () => this.format().code,\n                write: (value) => {\n                    for (let format of this.formats) {\n                        if (value === format.code) {\n                            this.format(format);\n                            break;\n                        }\n                    }\n                }\n            });\n\n            this.formattedCoordinates = ko.pureComputed(() => {\n                if (this.latlng()) {\n                    return formats.formatLatLng(this.latlng().wrap(), this.format());\n                }\n                return UNKNOWN_COORDINATES;\n            }, this);\n\n            this.wrapperClass = ko.pureComputed(() => this.format().wrapperClass, this);\n\n            this.formatCode.subscribe(this.saveStateToStorage, this);\n        },\n\n        onAdd: function(map) {\n            const {container, link, barContainer} = makeButtonWithBar(\n                'leaflet-contol-coordinates',\n                'Показать координаты под курсором',\n                'icon-coordinates'\n            );\n\n            this._map = map;\n            this._container = container;\n            this._link = link;\n\n            barContainer.innerHTML = `\n                <div data-bind=\"css: wrapperClass\">\n                    <div class=\"leaflet-coordinates-container\" data-bind=\"with: formattedCoordinates()\">\n                        <span class=\"leaflet-coordinates-latitude\" data-bind=\"html: lat\"></span>\n                        <span class=\"leaflet-coordinates-longitude\" data-bind=\"html: lng\"></span>\n                    </div>\n                    <hr class=\"leaflet-coordinates-divider\" />\n                    <div data-bind=\"foreach: formats\">\n                        <div>\n                            <label title=\"\">\n                                <input type=\"radio\" data-bind=\"checked: $parent.formatCode, value: code\" \n                                       class=\"leaflet-coordinates-format-radio\"/>\n                                <span data-bind=\"html: label\"></span>\n                            </label>\n                        </div>\n                    </div>\n                </div>\n            `;\n\n            barContainer.title = \"Правый клик для копирования координат\";\n\n            this.loadStateFromStorage();\n            ko.applyBindings(this, container);\n            L.DomEvent.on(link, 'click', this.onClick, this);\n\n            return container;\n        },\n\n        onRemove: function() {\n            L.DomEvent.off(this._link, 'click', this.onClick, this);\n        },\n\n        loadStateFromStorage: function() {\n            const active = safeLocalStorage.leafletCoordinatesActive === '1';\n            const code = safeLocalStorage.leafletCoordinatesFmt || DEFAULT_FORMAT.code;\n\n            this.formatCode(code);\n            this.setEnabled(active);\n        },\n\n        saveStateToStorage: function() {\n            safeLocalStorage.leafletCoordinatesActive = this.isEnabled() ? '1' : '0';\n            safeLocalStorage.leafletCoordinatesFmt = this.formatCode();\n        },\n\n        onMouseMove: function(e) {\n            this.latlng(e.latlng);\n        },\n\n        setEnabled: function(enabled) {\n            if (Boolean(enabled) === this.isEnabled()) {\n                return;\n            }\n            const classFunc = enabled ? 'addClass' : 'removeClass';\n            const eventFunc = enabled ? 'on' : 'off';\n            L.DomUtil[classFunc](this._container, 'active');\n            L.DomUtil[classFunc](this._container, 'highlight');\n            L.DomUtil[classFunc](this._map._container, 'coordinates-control-active');\n            this._map[eventFunc]('mousemove', this.onMouseMove, this);\n            this._map[eventFunc]('contextmenu', this.onMapRightClick, this);\n            this._isEnabled = Boolean(enabled);\n            this.latlng(null);\n        },\n\n        onMapRightClick: function(e) {\n            L.DomEvent.stop(e);\n\n            function createItem(format, options = {}) {\n                const {lat, lng} = formats.formatLatLng(e.latlng.wrap(), format);\n                const coordinates = `${lat} ${lng}`;\n\n                return {text: `${coordinates} <span class=\"leaflet-coordinates-menu-fmt\">${format.label}</span>`,\n                    callback: () => copyToClipboard(coordinates, e.originalEvent),\n                    ...options};\n            }\n\n            const header = createItem(this.format(), {\n                text: '<b>Скопировать в буфер обмена</b>',\n                header: true,\n            });\n            const items = this.formats.map((format) => createItem(format));\n            items.unshift(header, '-');\n\n            new Contextmenu(items).show(e);\n        },\n\n        isEnabled: function() {\n            return Boolean(this._isEnabled);\n        },\n\n        onClick: function() {\n            this.setEnabled(!this.isEnabled());\n            this.saveStateToStorage();\n        }\n    }\n);\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","function truncToFixed(x, precision) {\n    let s = x.toString();\n    let point = s.indexOf('.');\n    if (point === -1) {\n        point = s.length;\n        s += '.';\n    }\n    let sliceEnd = point + precision;\n    if (precision > 0) {\n        s = s.padEnd(point + precision + 1, '0');\n        sliceEnd += 1;\n    }\n    s = s.slice(0, sliceEnd);\n    return s;\n}\n\nfunction formatNumber(value, size, precision = 0) {\n    if (value < 0) {\n      throw new Error('Negative values not supported');\n    }\n\n    if (precision > 0) {\n        size += 1;\n    }\n    return truncToFixed(value, precision).padStart(size + precision, '0');\n}\n\nfunction coordinatePresentations(coordinate, isLat) {\n    const degrees = Math.abs(coordinate);\n    const intDegrees = Math.floor(degrees);\n    const minutes = (degrees - intDegrees) * 60;\n    const intMinutes = Math.floor(minutes);\n    const seconds = (minutes - intMinutes) * 60;\n\n    let direction;\n    if (isLat) {\n        direction = (coordinate < 0) ? 'S' : 'N';\n    } else {\n        direction = (coordinate < 0) ? 'W' : 'E';\n    }\n\n    return {\n        signedDegrees: coordinate.toFixed(5),\n        degrees: formatNumber(degrees, 0, 5),\n        intDegrees: formatNumber(intDegrees, 0),\n        minutes: formatNumber(minutes, 2, 3),\n        intMinutes: formatNumber(intMinutes, 2),\n        seconds: formatNumber(seconds, 2, 2),\n        direction\n    };\n}\n\nfunction formatLatLng(latlng, format) {\n    return {\n        lat: format.formatter(coordinatePresentations(latlng.lat, true)),\n        lng: format.formatter(coordinatePresentations(latlng.lng, false))\n    };\n}\n\nconst SIGNED_DEGREES = {\n    code: 'd',\n    label: '±ddd.ddddd',\n    wrapperClass: 'leaflet-coordinates-wrapper-signed-degrees',\n    formatter: ({signedDegrees}) => signedDegrees\n};\n\nconst DEGREES = {\n    code: 'D',\n    label: 'ddd.ddddd°',\n    wrapperClass: 'leaflet-coordinates-wrapper-degrees',\n    formatter: ({degrees, direction}) => `${direction} ${degrees}°`\n};\n\nconst DEGREES_AND_MINUTES = {\n    code: 'DM',\n    label: 'ddd°mm.mmm′',\n    wrapperClass: 'leaflet-coordinates-wrapper-degrees-and-minutes',\n    formatter: ({intDegrees, minutes, direction}) => `${direction} ${intDegrees}°${minutes}′`\n};\n\nconst DEGREES_AND_MINUTES_AND_SECONDS = {\n    code: 'DMS',\n    label: 'ddd°mm′ss.s″',\n    wrapperClass: 'leaflet-coordinates-wrapper-degrees-and-minutes-and-seconds',\n    formatter: ({intDegrees, intMinutes, seconds, direction}) => `${direction} ${intDegrees}°${intMinutes}′${seconds}″`\n};\n\nexport {\n    SIGNED_DEGREES,\n    DEGREES,\n    DEGREES_AND_MINUTES,\n    DEGREES_AND_MINUTES_AND_SECONDS,\n    formatLatLng\n};\n","import L from 'leaflet';\nimport './style.css';\n\nfunction getLayerHotkey(layer) {\n    if (!layer || !layer.options) {\n        return null;\n    }\n    let hotkey = layer.options.hotkey;\n    if (hotkey) {\n        return hotkey;\n    }\n    hotkey = layer.options.code;\n    if (hotkey && hotkey.length === 1) {\n        return hotkey;\n    }\n    return null;\n}\n\nfunction extendLayerName(name, layer) {\n    if (layer.options) {\n        const hotkey = getLayerHotkey(layer);\n        if (hotkey) {\n            name += `<span class=\"layers-control-hotkey\">${hotkey}</span>`;\n        }\n    }\n    return name;\n}\n\nfunction enableHotKeys(control) {\n    const originalOnAdd = control.onAdd;\n    const originalOnRemove = control.onRemove;\n    const originalAddItem = control._addItem;\n\n    if (control._hotKeysEnabled) {\n        return control;\n    }\n\n    L.Util.extend(control, {\n            _hotKeysEnabled: true,\n\n            _addItem: function(obj) {\n                if (!L.Browser.touch || !L.Browser.mobile) {\n                    obj = L.Util.extend({}, obj);\n                    obj.name = extendLayerName(obj.name, obj.layer);\n                }\n                return originalAddItem.call(this, obj);\n            },\n\n            onAdd: function(map) {\n                var result = originalOnAdd.call(this, map);\n                this._addHotketEvents();\n                return result;\n            },\n\n            onRemove: function(map) {\n                L.DomEvent.off(document, 'keyup', this._onHotkeyUp, this);\n                L.DomEvent.off(document, 'keydown', this.onKeyDown, this);\n                originalOnRemove.call(this, map);\n            },\n\n            _addHotKetEvents: function() {\n                L.DomEvent.on(document, 'keyup', this._onHotkeyUp, this);\n                L.DomEvent.on(document, 'keydown', this.onKeyDown, this);\n            },\n\n            onKeyDown: function(e) {\n                if (e.altKey || e.ctrlKey || e.shiftKey) {\n                    return;\n                }\n                this._keyDown = e.keyCode;\n            },\n\n            _onHotkeyUp: function(e) {\n                const pressedKey = this._keyDown;\n                this._keyDown = null;\n                const targetTag = e.target.tagName.toLowerCase();\n                if (\n                    (targetTag === 'input' && ['text', 'search'].includes(e.target.type)) ||\n                    targetTag === 'textarea' ||\n                    pressedKey !== e.keyCode\n                ) {\n                    return;\n                }\n                let key = String.fromCharCode(e.keyCode);\n                // Клавиша \"D\" - default - активирует слой по умолчанию\n                if ( 'D' === key ) {\n                    key = 'O'; // на данный момент, слой по умолчанию это OSM - клавиша \"O\"\n                }\n                for (let layer of this._layers) {\n                    let layerId = L.stamp(layer.layer);\n                    const layerHotkey = getLayerHotkey(layer.layer);\n                    if (layerHotkey === key) {\n                        const inputs = this._container.getElementsByTagName('input');\n                        for (let input of [...inputs]) {\n                            if (input.layerId === layerId) {\n                                input.click();\n                                break;\n                            }\n                        }\n                        break;\n                    }\n                }\n            }\n        }\n    );\n    for (let layer of control._layers) {\n        layer.name = extendLayerName(layer.name, layer.layer);\n    }\n    control._addHotKetEvents();\n    control._update();\n    return control;\n}\n\nexport default enableHotKeys;\n\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport './leaflet.hashState';\n\nL.Map.include(L.Mixin.HashState);\n\nL.Map.include({\n        stateChangeEvents: ['moveend'],\n\n        serializeState: function() {\n            var center = this.getCenter();\n            var zoom = this.getZoom();\n            var precision = 5;\n            var state = [\n                zoom.toString(),\n                center.lat.toFixed(precision),\n                center.lng.toFixed(precision)\n            ];\n            return state;\n        },\n\n        validateState: function(values) {\n            if (!values || values.length !== 3) {\n                return {valid: false};\n            }\n            let zoom = parseInt(values[0], 10),\n                lat = parseFloat(values[1]),\n                lng = parseFloat(values[2]);\n            if (isNaN(zoom) || isNaN(lat) || isNaN(lng) || zoom < 0 || zoom > 32 || lat < -90 || lat > 90) {\n                return {valid: false};\n            }\n            return {lat, lng, zoom, valid: true};\n        },\n\n        unserializeState: function(values) {\n            let {lat, lng, zoom, valid} = this.validateState(values);\n            if (valid) {\n                this.setView([lat, lng], zoom);\n                return true;\n            }\n            return false;\n        }\n    }\n);\n\n","import L from 'leaflet';\nimport './leaflet.hashState';\n\nL.Control.Layers.include(L.Mixin.HashState);\n\nL.Control.Layers.include({\n        stateChangeEvents: ['baselayerchange', 'overlayadd', 'overlayremove'],\n        stateChangeEventsSource: '_map',\n\n        serializeState: function() {\n            const keys = [];\n            this._map.eachLayer((layer) => {\n                    let key = layer.options.code;\n                    if (key) {\n                        keys.push([key, layer.options.zIndex]);\n                    }\n                }\n            );\n            keys.sort((k1, k2) => k1[1] - k2[1]);\n            const state = keys.map((k) => k[0]);\n            return state;\n        },\n\n        unserializeState: function(values) {\n            if (!values || values.length === 0) {\n                return false;\n            }\n\n            let hasBaselayer;\n            for (let layer of this._layers) {\n                if (layer.layer.options && values.includes(layer.layer.options.code) && !layer.overlay) {\n                    hasBaselayer = true;\n                    break;\n                }\n            }\n\n            if (!hasBaselayer) {\n                return false;\n            }\n\n            for (let layer of this._layers) {\n                if (layer.layer.options && values.includes(layer.layer.options.code)) {\n                    this._map.addLayer(layer.layer);\n                } else {\n                    this._map.removeLayer(layer.layer);\n                }\n            }\n            return true;\n        }\n    }\n);\n\n","import L from 'leaflet';\nimport './style.css';\nimport {fixVectorMarkerWorldJump} from './fixWorldCopyJump';\n\n// https://github.com/Leaflet/Leaflet/issues/3575\nfunction fixPanAnimationBug() {\n    if (!L.Browser.chrome) {\n        return;\n    }\n    if (L.PosAnimation.prototype.__panAnimationFixed) {\n        return;\n    }\n\n    const originalStep = L.PosAnimation.prototype._step;\n    L.PosAnimation.prototype._step = function() {\n        return originalStep.call(this, true);\n    };\n    L.PosAnimation.prototype.__panAnimationFixed = true;\n}\n\nfunction fixTouchDetection() {\n    L.Browser.touch &= ((navigator.pointerEnabled && !L.Browser.ie) || navigator.maxTouchPoints);\n}\n\nfunction fixMapKeypressEvent() {\n    const originalHandleDOMEvent = L.Map.prototype._handleDOMEvent;\n    L.Map.prototype._handleDOMEvent = function(e) {\n        if (e.type === 'keypress' && e.keyCode === 13) {\n            this._fireDOMEvent(e, e.type);\n        } else {\n            originalHandleDOMEvent.call(this, e);\n        }\n    };\n}\n\nfunction fixVectorDrawWhileAnimation() {\n    if (L.Renderer.__animationFixed) {\n        return;\n    }\n\n    const resetInterval = 300;\n\n    const originalGetEvents = L.Renderer.prototype.getEvents;\n\n    function onZoom() {\n        const now = Date.now();\n        if (!this._lastReset || (now - this._lastReset > resetInterval)) {\n            this._reset();\n            this._lastReset = now;\n        } else {\n            L.Renderer.prototype._onZoom.call(this);\n        }\n    }\n\n    function onMove() {\n        const now = Date.now();\n        if (!this._lastReset || (now - this._lastReset > resetInterval)) {\n            this._reset();\n            this._lastReset = now;\n        }\n    }\n\n    function getEvents() {\n        const result = originalGetEvents.call(this);\n        result.move = onMove;\n        result.zoom = onZoom;\n        return result;\n    }\n\n    L.Renderer.prototype.getEvents = getEvents;\n    L.Renderer.__animationFixed = true;\n}\n\nfunction allowControlHorizontalStacking() {\n    const original_addTo = L.Control.prototype.addTo;\n    L.Control.prototype.addTo = function(map) {\n        const result = original_addTo.call(this, map);\n        if (this.options.stackHorizontally) {\n            L.DomUtil.addClass(this._container, 'leaflet-control-horizontal-stack');\n        }\n        return result;\n    };\n}\n\nfunction addTooltipDelay() {\n    const origOpenTooltip = L.Layer.prototype._openTooltip;\n    L.Layer.prototype._openTooltip = function(e) {\n        if (this._tooltip.options.delay) {\n            const that = this;\n            this._pendingTooltip = setTimeout(() => origOpenTooltip.call(that, e), this._tooltip.options.delay);\n        } else {\n            origOpenTooltip.call(this, e);\n        }\n    };\n\n    const origCloseTooltip = L.Layer.prototype.closeTooltip;\n    L.Layer.prototype.closeTooltip = function() {\n        clearInterval(this._pendingTooltip);\n        origCloseTooltip.call(this);\n    };\n}\n\nfunction fixAll() {\n    fixPanAnimationBug();\n    fixTouchDetection();\n    fixMapKeypressEvent();\n    fixVectorDrawWhileAnimation();\n    fixVectorMarkerWorldJump();\n    allowControlHorizontalStacking();\n    addTooltipDelay();\n}\n\nexport {fixAll};\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport ko from 'knockout';\nimport '~/lib/leaflet.hashState/leaflet.hashState';\n\nimport './style.css';\nimport '~/lib/controls-styles/controls-styles.css';\nimport {makeButtonWithBar} from '~/lib/leaflet.control.commons';\nimport mapillaryProvider from './lib/mapillary';\nimport wikimediaProvider from './lib/wikimedia';\nimport {DragEvents} from '~/lib/leaflet.events.drag';\nimport {onElementResize} from '~/lib/anyElementResizeEvent';\nimport safeLocalStorage from '~/lib/safe-localstorage';\n\nconst PanoMarker = L.Marker.extend({\n    options: {\n        zIndexOffset: 10000\n    },\n\n    initialize: function() {\n        const icon = L.divIcon({\n                className: 'leaflet-panorama-marker-wraper',\n                html: '<div class=\"leaflet-panorama-marker\"></div>'\n            }\n        );\n        L.Marker.prototype.initialize.call(this, [0, 0], {icon, interactive: false});\n    },\n\n    getIcon: function() {\n        let markerIcon = this.getElement();\n        markerIcon = markerIcon.children[0];\n        return markerIcon;\n    },\n\n    setHeading: function(angle) {\n        const markerIcon = this.getIcon();\n        markerIcon.style.transform = `rotate(${angle || 0}deg)`;\n    },\n\n    setType: function(markerType) {\n        const className = {\n            slim: 'leaflet-panorama-marker-circle',\n            normal: 'leaflet-panorama-marker-binocular'\n        }[markerType];\n        this.getIcon().className = className;\n    }\n});\n\nL.Control.Panoramas = L.Control.extend({\n        includes: L.Evented,\n\n        options: {\n            position: 'topleft',\n            splitVerically: true,\n            splitSizeFraction: 0.5,\n            minViewerSize: 30,\n        },\n\n        getProviders: function() {\n            return [\n                {\n                    name: 'wikimedia',\n                    title: 'Фотки Wikimedia',\n                    provider: wikimediaProvider,\n                    layerOptions: {opacity: 0.7, zIndex: 9},\n                    code: 'w',\n                    selected: ko.observable(true),\n                    mapMarkerType: 'slim'\n                },\n                {\n                    name: 'mapillary',\n                    title: 'Панорамы Mapillary',\n                    provider: mapillaryProvider,\n                    layerOptions: {opacity: 0.7, zIndex: 8},\n                    code: 'm',\n                    selected: ko.observable(false),\n                    mapMarkerType: 'normal'\n                },\n            ];\n        },\n\n        initialize: function(options) {\n            L.Control.prototype.initialize.call(this, options);\n            this.loadSettings();\n            this._panoramasContainer = L.DomUtil.create('div', 'panoramas-container');\n            onElementResize(\n                this._panoramasContainer,\n                L.Util.requestAnimFrame.bind(null, this.onContainerResize.bind(this))\n            );\n            this.providers = this.getProviders();\n            for (let provider of this.providers) {\n                provider.selected.subscribe(this.updateCoverageVisibility, this);\n                provider.container = L.DomUtil.create('div', 'panorama-container', this._panoramasContainer);\n            }\n            this.nearbyPoints = [];\n        },\n\n        loadSettings: function() {\n            let storedSettings;\n            try {\n                storedSettings = JSON.parse(safeLocalStorage.panoramaSettings);\n            } catch {\n                // ignore\n            }\n            this._splitVerically = storedSettings?.spitVertically ?? this.options.splitVerically;\n            const fraction = storedSettings?.splitSizeFraction;\n            this._splitSizeFraction = isNaN(fraction) ? this.options.splitSizeFraction : fraction;\n        },\n\n        saveSetting: function() {\n            safeLocalStorage.panoramaSettings = JSON.stringify({\n                spitVertically: this._splitVerically,\n                splitSizeFraction: this._splitSizeFraction\n            });\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n\n            this._splitterDragging = false;\n            const splitter = L.DomUtil.create('div', 'panorama-splitter', this._panoramasContainer);\n            L.DomUtil.create('div', 'splitter-border', splitter);\n            const splitterButton = L.DomUtil.create('div', 'button', splitter);\n            new DragEvents(splitter, null, {trackOutsideElement: true}).on({\n                dragstart: this.onSplitterDragStart,\n                dragend: this.onSplitterDragEnd,\n                drag: this.onSplitterDrag,\n            }, this);\n            new DragEvents(splitterButton, null, {trackOutsideElement: true}).on({\n                click: this.onSplitterClick\n            }, this);\n            this.setupViewerLayout();\n            const {container, link, barContainer} = makeButtonWithBar(\n                'leaflet-contol-panoramas', 'Панорамы и фотки (Alt-P)', 'icon-panoramas');\n            map.on('resize', this.onMapResize, this);\n            this._container = container;\n            L.DomEvent.on(link, 'click', this.onButtonClick, this);\n            L.DomEvent.on(document, 'keyup', this.onKeyUp, this);\n            barContainer.innerHTML = `\n                 <div class=\"panoramas-list\" data-bind=\"foreach: providers\">\n                     <div>\n                         <label>\n                             <input type=\"checkbox\" data-bind=\"checked: selected\"><span data-bind=\"text: title\"></span>\n                         </label>\n                     </div>\n                 </div>\n             `;\n\n            ko.applyBindings(this, container);\n            map.createPane('rasterOverlay').style.zIndex = 300;\n            return container;\n        },\n\n        onSplitterDrag: function(e) {\n            const minSize = this.options.minViewerSize;\n            const container = this._panoramasContainer;\n            const oldSize = container[this._splitVerically ? 'offsetWidth' : 'offsetHeight'];\n            let newSize = oldSize + e.dragMovement[this._splitVerically ? 'x' : 'y'];\n            const mapSize = this._map._container[this._splitVerically ? 'offsetWidth' : 'offsetHeight'];\n            if (newSize < minSize) {\n                newSize = this.options.minViewerSize;\n            }\n            const maxSize = oldSize + mapSize - minSize;\n            if (newSize > maxSize) {\n                newSize = maxSize;\n            }\n            this.setContainerSizePixels(newSize);\n        },\n\n        onSplitterClick: function() {\n            this._splitVerically = !this._splitVerically;\n            this.saveSetting();\n            this.setupViewerLayout();\n        },\n\n        onButtonClick: function() {\n            this.switchControl();\n        },\n\n        switchControl: function() {\n            if (this.controlEnabled) {\n                this.disableControl();\n            } else {\n                this.enableControl();\n            }\n        },\n\n        onKeyUp: function(e) {\n            if (e.keyCode === 'P'.codePointAt(0) && e.altKey) {\n                this.switchControl();\n            }\n        },\n\n        enableControl: function() {\n            if (this.controlEnabled) {\n                return;\n            }\n            this.controlEnabled = true;\n            L.DomUtil.addClass(this._container, 'active');\n            this.updateCoverageVisibility();\n            this._map.on('click', this.onMapClick, this);\n            L.DomUtil.addClass(this._map._container, 'panoramas-control-active');\n            this.notifyChanged();\n        },\n\n        disableControl: function() {\n            if (!this.controlEnabled) {\n                return;\n            }\n            this.controlEnabled = false;\n            L.DomUtil.removeClass(this._container, 'active');\n            this.updateCoverageVisibility();\n            this._map.off('click', this.onMapClick, this);\n            this.hidePanoViewer();\n            L.DomUtil.removeClass(this._map._container, 'panoramas-control-active');\n            this.notifyChanged();\n        },\n\n        updateCoverageVisibility: function() {\n            if (!this._map) {\n                return;\n            }\n            for (let provider of this.providers) {\n                if (this.controlEnabled && provider.selected()) {\n                    if (!provider.coverageLayer) {\n                        const options = L.extend({pane: 'rasterOverlay'}, provider.layerOptions);\n                        provider.coverageLayer = provider.provider.getCoverageLayer(options);\n                    }\n                    provider.coverageLayer.addTo(this._map);\n                } else {\n                    if (provider.coverageLayer) {\n                        this._map.removeLayer(provider.coverageLayer);\n                    }\n                }\n            }\n            this.notifyChanged();\n        },\n\n        showPanoramaContainer: function() {\n            L.DomUtil.addClass(this._panoramasContainer, 'enabled');\n        },\n\n        panoramaVisible: function() {\n            if (L.DomUtil.hasClass(this._panoramasContainer, 'enabled')) {\n                for (let provider of this.providers) {\n                    if (L.DomUtil.hasClass(provider.container, 'enabled')) {\n                        return provider;\n                    }\n                }\n            }\n            return false;\n        },\n\n        setupNearbyPoints: function(points) {\n            for (let point of this.nearbyPoints) {\n                this._map.removeLayer(point);\n            }\n            this.nearbyPoints = [];\n            if (points) {\n                const icon = L.divIcon({className: 'leaflet-panorama-marker-point'});\n                for (let latlng of points) {\n                    this.nearbyPoints.push(L.marker(latlng, {icon}).addTo(this._map));\n                }\n            }\n        },\n\n        hidePano: function(provider) {\n            L.DomUtil.removeClass(provider.container, 'enabled');\n            if (provider.viewer) {\n                provider.viewer.deactivate();\n            }\n            this.setupNearbyPoints();\n        },\n\n        showPano: async function(provider, data) {\n            this.showPanoramaContainer();\n            for (let otherProvider of this.providers) {\n                if (otherProvider !== provider) {\n                    this.hidePano(otherProvider);\n                }\n            }\n            L.DomUtil.addClass(provider.container, 'enabled');\n            if (!provider.viewer) {\n                // eslint-disable-next-line require-atomic-updates\n                provider.viewer = await provider.provider.getViewer(provider.container);\n                this.setupViewerEvents(provider);\n            }\n            if (data) {\n                // wait for panorama container become of right size, needed for viewer setup\n                setTimeout(() => provider.viewer.showPano(data), 0);\n            }\n            provider.viewer.activate();\n            this.notifyChanged();\n        },\n\n        setupViewerEvents: function(provider) {\n            provider.viewer.on({\n                change: this.onPanoramaChangeView.bind(this, provider),\n                closeclick: this.onPanoramaCloseClick\n            }, this);\n        },\n\n        hidePanoViewer: function() {\n            for (let provider of this.providers) {\n                this.hidePano(provider);\n            }\n            L.DomUtil.removeClass(this._panoramasContainer, 'enabled');\n            this.hideMarker();\n            this.notifyChanged();\n        },\n\n        placeMarker: function(latlng, heading) {\n            if (!this.panoramaVisible()) {\n                return;\n            }\n            if (!this.marker) {\n                this.marker = new PanoMarker();\n            }\n            this._map.addLayer(this.marker);\n            this.marker.setLatLng(latlng);\n            this.marker.setHeading(heading);\n        },\n\n        hideMarker: function() {\n            if (this.marker) {\n                this._map.removeLayer(this.marker);\n            }\n        },\n        notifyChanged: function() {\n            this._map.fire('panoramachanged');\n        },\n\n        onPanoramaChangeView: function(provider, e) {\n            if (!this._map.getBounds().pad(-0.05).contains(e.latlng)) {\n                this._map.panTo(e.latlng);\n            }\n            this.placeMarker(e.latlng, e.heading);\n            this.marker.setType(provider.mapMarkerType);\n            this.setupNearbyPoints(e.latlngs);\n            this.notifyChanged();\n        },\n\n        onPanoramaCloseClick: function() {\n            this.hidePanoViewer();\n        },\n\n        onMapClick: async function(e) {\n            const\n                searchRadiusPx = 24,\n                p = this._map.project(e.latlng).add([searchRadiusPx, 0]),\n                searchRadiusMeters = e.latlng.distanceTo(this._map.unproject(p)),\n                promises = [];\n            for (let provider of this.providers) {\n                if (provider.selected()) {\n                    promises.push({\n                        promise: provider.provider.getPanoramaAtPos(e.latlng, searchRadiusMeters),\n                        provider: provider\n                    });\n                }\n            }\n\n            for (let {promise, provider} of promises) {\n                let searchResult = await promise;\n                if (searchResult.found) {\n                    this.showPano(provider, searchResult.data);\n                    return;\n                }\n            }\n        },\n\n        setupViewerLayout: function() {\n            let sidebar;\n            if (this._splitVerically) {\n                L.DomUtil.addClass(this._panoramasContainer, 'split-vertical');\n                L.DomUtil.removeClass(this._panoramasContainer, 'split-horizontal');\n                sidebar = 'left';\n                this._panoramasContainer.style.height = '100%';\n            } else {\n                L.DomUtil.addClass(this._panoramasContainer, 'split-horizontal');\n                L.DomUtil.removeClass(this._panoramasContainer, 'split-vertical');\n                sidebar = 'top';\n                this._panoramasContainer.style.width = '100%';\n            }\n            this._map.addElementToSidebar(sidebar, this._panoramasContainer);\n            this.updateContainerSize();\n        },\n\n        setContainerSizePixels: function(size) {\n            size = Math.round(size);\n            this._panoramasContainer.style[this._splitVerically ? 'width' : 'height'] = `${size}px`;\n            setTimeout(() => { // map size has not updated yet\n                const mapSize = this._map._container[this._splitVerically ? 'offsetWidth' : 'offsetHeight'];\n                this._splitSizeFraction = size / (mapSize + size);\n                this.saveSetting();\n            }, 0);\n        },\n\n        updateContainerSize: function() {\n            const fraction = this._splitSizeFraction;\n            const container = this._panoramasContainer;\n            const containerSize = container[this._splitVerically ? 'offsetWidth' : 'offsetHeight'];\n            const mapSize = this._map._container[this._splitVerically ? 'offsetWidth' : 'offsetHeight'];\n            const newSize = Math.round(fraction * (mapSize + containerSize));\n            container.style[this._splitVerically ? 'width' : 'height'] = `${newSize}px`;\n        },\n\n        onContainerResize: function() {\n            const provider = this.panoramaVisible();\n            if (provider && provider.viewer) {\n                provider.viewer.invalidateSize();\n            }\n        },\n\n        onMapResize: function() {\n            if (!this._splitterDragging) {\n                this.updateContainerSize();\n            }\n        },\n\n        onSplitterDragStart: function() {\n            this._splitterDragging = true;\n        },\n\n        onSplitterDragEnd: function() {\n            this._splitterDragging = false;\n        },\n    },\n);\n\nL.Control.Panoramas.include(L.Mixin.HashState);\nL.Control.Panoramas.include({\n        stateChangeEvents: ['panoramachanged'],\n\n        serializeState: function() {\n            let state = null;\n            if (this.controlEnabled) {\n                state = [];\n                let coverageCode = '_';\n                for (let provider of this.providers) {\n                    if (provider.selected()) {\n                        coverageCode += provider.code;\n                    }\n                }\n                state.push(coverageCode);\n                const provider = this.panoramaVisible();\n                if (provider && provider.viewer) {\n                    let viewerState = provider.viewer.getState();\n                    if (viewerState) {\n                        state.push(provider.code);\n                        state.push(...viewerState);\n                    }\n                }\n            }\n            return state;\n        },\n\n        unserializeState: function(state) {\n            if (!state) {\n                this.disableControl();\n                return true;\n            }\n\n            const coverageCode = state[0];\n            if (!coverageCode || coverageCode[0] !== '_') {\n                return false;\n            }\n            this.enableControl();\n            for (let provider of this.providers) {\n                provider.selected(coverageCode.includes(provider.code));\n            }\n            if (state.length > 2) {\n                const panoramaVisible = state[1];\n                for (let provider of this.providers) {\n                    if (panoramaVisible === provider.code) {\n                        this.showPano(provider).then(() => {\n                            const success = provider.viewer.setState(state.slice(2));\n                            if (!success) {\n                                this.hidePanoViewer();\n                            }\n                        });\n                        break;\n                    }\n                }\n            }\n            return true;\n        }\n    }\n);\n\nL.Control.Panoramas.hashStateUpgrader = function(panoramasControl) {\n    return L.Util.extend({}, L.Mixin.HashState, {\n        unserializeState: function(oldState) {\n            if (oldState) {\n                const upgradedState = ['_g'];\n                if (oldState.length) {\n                    upgradedState.push('g', ...oldState);\n                }\n                setTimeout(() => panoramasControl.unserializeState(upgradedState), 0);\n            }\n            return false;\n        },\n\n        serializeState: function() {\n            return null;\n        },\n    });\n};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {MapillaryCoverage} from './mapillary-coverage-layer';\nimport {fetch} from '~/lib/xhr-promise';\nimport config from '~/config';\nimport './style.css';\nimport {CloseButtonMixin, DateLabelMixin} from '../common';\n\nfunction getCoverageLayer(options) {\n    return new MapillaryCoverage(options);\n}\n\nfunction getMapillary() {\n    return new Promise((resolve) => {\n        require.ensure(['mapillary-js/dist/mapillary.min.js', 'mapillary-js/dist/mapillary.min.css'], () => {\n            require('mapillary-js/dist/mapillary.min.css');\n            resolve(require('mapillary-js/dist/mapillary.min.js'));\n        }, 'mapillary');\n    });\n}\n\nasync function getPanoramaAtPos(latlng, searchRadiusMeters) {\n    const url = `https://a.mapillary.com/v3/images?` +\n        `client_id=${config.mapillary}&closeto=${latlng.lng},${latlng.lat}&radius=${searchRadiusMeters}`;\n    const resp = await fetch(url, {responseType: 'json', timeout: 10000});\n    if (resp.status === 200 && resp.responseJSON.features.length) {\n        return {found: true, data: resp.responseJSON.features[0].properties.key};\n    }\n    return {found: false};\n}\n\nconst Viewer = L.Evented.extend({\n        includes: [CloseButtonMixin, DateLabelMixin],\n\n        initialize: function(mapillary, container) {\n            const id = `container-${L.stamp(container)}`;\n            container.id = id;\n            const viewer = this.viewer = new mapillary.Viewer(\n                id, config.mapillary, null, {component: {cover: false, bearing: false}});\n            window.addEventListener('resize', function() {\n                    viewer.resize();\n                }\n            );\n            viewer.on('nodechanged', this.onNodeChanged.bind(this));\n            viewer.on('bearingchanged', this.onBearingChanged.bind(this));\n            this.createDateLabel(container);\n            this.createCloseButton(container);\n            this._bearing = 0;\n            this._zoom = 0;\n            this._center = [0, 0];\n            this.invalidateSize = L.Util.throttle(this._invalidateSize, 100, this);\n        },\n\n        showPano: function(data) {\n            this.deactivate();\n            this.activate();\n            this.viewer.moveToKey(data).then(() => {\n                this.viewer.setZoom(0);\n                this.updateZoomAndCenter();\n            });\n        },\n\n        onNodeChanged: function(node) {\n            if (this._node && (node.key === this._node.key)) {\n                return;\n            }\n            this._node = node;\n            this.fireChangeEvent();\n            this.updateDateLabel(node.capturedAt);\n        },\n\n        getBearingCorrection: function() {\n            if (this._node && 'computedCA' in this._node) {\n                return (this._node.computedCA - this._node.originalCA);\n            }\n            return 0;\n        },\n\n        onBearingChanged: function(bearing) {\n            bearing -= this.getBearingCorrection();\n            if (this._bearing === bearing) {\n                return;\n            }\n            this._bearing = bearing;\n            this.fireChangeEvent();\n        },\n\n        fireChangeEvent: function() {\n            if (this._node) {\n                const latlon = this._node.originalLatLon;\n                this.fire('change', {\n                        latlng: L.latLng(latlon.lat, latlon.lon),\n                        heading: this._bearing,\n                        pitch: this._pitch,\n                        zoom: this._zoom\n                    }\n                );\n            }\n        },\n\n        deactivate: function() {\n            this.viewer.activateCover();\n            if (this._updateHandler) {\n                clearInterval(this._updateHandler);\n                this._updateHandler = null;\n            }\n        },\n\n        updateZoomAndCenter: function() {\n            this.viewer.getZoom().then((zoom) => {\n                this._zoom = zoom;\n            });\n            this.viewer.getCenter().then((center) => {\n                this._center = center;\n            });\n            this.viewer.getBearing().then((bearing) => {\n                this.onBearingChanged(bearing);\n            });\n        },\n\n        activate: function() {\n            this.viewer.resize();\n            this.viewer.deactivateCover();\n            if (!this._updateHandler) {\n                this._updateHandler = setInterval(() => this.updateZoomAndCenter(), 200);\n            }\n        },\n\n        getState: function() {\n            if (!this._node) {\n                return [];\n            }\n            const {lat, lon} = this._node.originalLatLon;\n            return [\n                lat.toFixed(6),\n                lon.toFixed(6),\n                this._center[0].toFixed(4),\n                this._center[1].toFixed(4),\n                this._zoom.toFixed(2)\n            ];\n        },\n\n        setState: function(state) {\n            const lat = parseFloat(state[0]);\n            const lng = parseFloat(state[1]);\n            const center0 = parseFloat(state[2]);\n            const center1 = parseFloat(state[3]);\n            const zoom = parseFloat(state[4]);\n            if (!isNaN(lat) && !isNaN(lng) && !isNaN(center0) && !isNaN(center1) && !isNaN(zoom)) {\n                this.viewer.moveCloseTo(lat, lng).then(() => {\n                    this.viewer.setCenter([center0, center1]);\n                    this.viewer.setZoom(zoom);\n                });\n                return true;\n            }\n            return false;\n        },\n\n        _invalidateSize: function() {\n            this.viewer.resize();\n        }\n    }\n);\n\nasync function getViewer(container) {\n    const mapillary = await getMapillary();\n    return new Viewer(mapillary, container);\n}\n\nconst mapillaryProvider = {getCoverageLayer, getPanoramaAtPos, getViewer};\nexport default mapillaryProvider;\n","import L from 'leaflet';\nimport {MapillaryLoader} from './mapillary-loader';\n\nconst MapillaryCoverage = L.GridLayer.extend({\n        options: {\n            tileSize: 1024,\n            updateWhenIdle: true,\n            color: '#00cfb1'\n        },\n\n        initialize: function(options) {\n            L.GridLayer.prototype.initialize.call(this, options);\n            this.loader = new MapillaryLoader(this.options.url, 12);\n        },\n\n        onAdd: function(map) {\n            L.GridLayer.prototype.onAdd.call(this, map);\n            this.on('tileunload', this.onTileUnload, this);\n        },\n\n        onRemove: function(map) {\n            L.GridLayer.prototype.onRemove.call(this, map);\n            this.off('tileunload', this.onTileUnload, this);\n        },\n\n        onTileUnload: function(e) {\n            const tile = e.tile;\n            tile._abortLoading();\n            delete tile._tileData;\n            delete tile._adjustment;\n        },\n\n        drawOverview: function(canvas) {\n            const\n                tileData = canvas._tileData;\n            if (!tileData['mapillary-sequence-overview']) {\n                return;\n            }\n            let {multiplier, offsetX, offsetY} = canvas._adjustment;\n            const canvasCtx = canvas.getContext('2d');\n            canvasCtx.fillStyle = this.options.color;\n            for (let feature of tileData['mapillary-sequence-overview']) {\n                if (feature.geometry.type !== 'Point') {\n                    throw new Error(`Invalid sequence overview geometry type \"${feature.geometry.type}\"`);\n                }\n                canvasCtx.beginPath();\n                let x = feature.geometry.coordinates[0] * multiplier - offsetX;\n                let y = feature.geometry.coordinates[1] * multiplier - offsetY;\n                canvasCtx.arc(x, y, 5, 0, 2 * Math.PI);\n                canvasCtx.fill();\n            }\n        },\n\n        drawSequences: function(canvas, lineWidth) {\n            let\n                tileData = canvas._tileData,\n                adjustment = canvas._adjustment;\n\n            if (!tileData['mapillary-sequences']) {\n                return;\n            }\n            const canvasCtx = canvas.getContext('2d');\n            canvasCtx.beginPath();\n            canvasCtx.strokeStyle = this.options.color;\n            canvasCtx.lineWidth = lineWidth;\n            // canvasCtx.lineWidth = thinLines ? 1 : 1;\n            canvasCtx.lineCap = \"round\";\n            canvasCtx.lineJoin = \"bevel\";\n            for (let feature of tileData['mapillary-sequences']) {\n                if (feature.geometry.type !== 'MultiLineString') {\n                    throw new Error(`Invalid sequence geometry type \"${feature.geometry.type}\"`);\n                }\n                let {multiplier, offsetX, offsetY} = adjustment;\n\n                let lines = feature.geometry.coordinates;\n                for (let lineI = 0; lineI < lines.length; lineI++) {\n                    let line = lines[lineI];\n                    if (!line.length) {\n                        continue;\n                    }\n                    let x = line[0][0] * multiplier - offsetX;\n                    let y = line[0][1] * multiplier - offsetY;\n                    canvasCtx.moveTo(x, y);\n                    if (line.length === 1) {\n                        canvasCtx.lineTo(x, y);\n                    }\n                    for (let pointI = 0; pointI < line.length; pointI++) {\n                        let x = line[pointI][0] * multiplier - offsetX;\n                        let y = line[pointI][1] * multiplier - offsetY;\n                        canvasCtx.lineTo(x, y);\n                    }\n                }\n            }\n            canvasCtx.stroke();\n        },\n\n        drawImages: function(canvas) {\n            let\n                tileData = canvas._tileData,\n                adjustment = canvas._adjustment;\n            if (!tileData['mapillary-images']) {\n                return;\n            }\n            let {multiplier, offsetX, offsetY} = adjustment;\n            const canvasCtx = canvas.getContext('2d');\n            canvasCtx.beginPath();\n            canvasCtx.fillStyle = this.options.color;\n            for (let feature of tileData['mapillary-images']) {\n                if (feature.geometry.type !== 'Point') {\n                    throw new Error(`Invalid image geometry type \"${feature.geometry.type}\"`);\n                }\n                canvasCtx.beginPath();\n                let x = feature.geometry.coordinates[0] * multiplier - offsetX;\n                let y = feature.geometry.coordinates[1] * multiplier - offsetY;\n                canvasCtx.arc(x, y, 4, 0, 2 * Math.PI);\n                canvasCtx.fill();\n            }\n        },\n\n        drawTile: function(canvas, coords) {\n            if (!this._map) {\n                return;\n            }\n            if (!canvas._tileData) {\n                return;\n            }\n            if (coords.z < 6 + 2) {\n                this.drawOverview(canvas);\n            } else if (coords.z < 14 + 2) {\n                let width = coords.z < 14 ? 10 : 5;\n                this.drawSequences(canvas, width);\n            } else {\n                this.drawSequences(canvas, 2);\n                this.drawImages(canvas);\n            }\n        },\n\n        createTile: function(coords, done) {\n            const canvas = L.DomUtil.create('canvas', 'leaflet-tile');\n            canvas.width = this.options.tileSize;\n            canvas.height = this.options.tileSize;\n            let {dataPromise, abortLoading} = this.loader.requestTileData(coords);\n            dataPromise.then((data) => {\n                if (!data.error) {\n                    canvas._tileData = data.tileData;\n                    canvas._adjustment = data.adjustment || {multiplier: 1, offsetX: 0, offsetY: 0};\n                    setTimeout(() => {\n                        this.drawTile(canvas, coords);\n                        done(null, canvas);\n                    }, 1);\n                }\n            });\n            canvas._abortLoading = abortLoading;\n            return canvas;\n        },\n\n    }\n);\n\nexport {MapillaryCoverage};\n","import L from 'leaflet';\nimport {TiledDataLoader} from '~/lib/tiled-data-loader';\nimport {decodeMvt} from './mvt';\n\nclass MapillaryLoader extends TiledDataLoader {\n    url = 'https://d25uarhxywzl1j.cloudfront.net/v0.1/{z}/{x}/{y}.mvt';\n    maxZoom = 14;\n\n    getTileUrl(coords) {\n        const data = {\n            x: coords.x,\n            z: coords.z,\n            y: coords.y\n        };\n        return L.Util.template(this.url, data);\n    }\n\n    layerTileToDataTileCoords(layerTileCoords) {\n        let z = layerTileCoords.z - 2;\n        let z2 = null;\n        if (z > 6 && z <= 10) {\n            z2 = 6;\n        } else if (z >= 11 && z < 14) {\n            z2 = z - 4;\n        } else if (z < 0) {\n            z2 = 0;\n        } else if (z > this.maxZoom) {\n            z2 = this.maxZoom;\n        } else {\n            return {z, x: layerTileCoords.x, y: layerTileCoords.y};\n        }\n\n        let multiplier = 1 << (z - z2);\n        return {\n            x: Math.floor(layerTileCoords.x / multiplier),\n            y: Math.floor(layerTileCoords.y / multiplier),\n            z: z2\n        };\n    }\n\n    makeRequestData(dataTileCoords) {\n        return {\n            url: this.getTileUrl(dataTileCoords),\n            options: {\n                responseType: 'arraybuffer',\n                timeout: 10000,\n                isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403\n            }\n        };\n    }\n\n    calcAdjustment(layerTileCoords, dataTileCoords) {\n        let adjustment = super.calcAdjustment(\n            {x: layerTileCoords.x, y: layerTileCoords.y, z: layerTileCoords.z - 2},\n            dataTileCoords\n        );\n        if (adjustment) {\n            adjustment.offsetX *= 1024;\n            adjustment.offsetY *= 1024;\n        }\n        return adjustment;\n    }\n\n    async processResponse(xhr, originalDataTileCoords) {\n        return this._processResponse(xhr, originalDataTileCoords);\n    }\n\n    async _processResponse(xhr, originalDataTileCoords) {\n        let tileData;\n        if (xhr.status === 200 && xhr.response) {\n            const layers = decodeMvt(xhr.response, 1024);\n            tileData = {};\n            for (let layer of layers) {\n                tileData[layer.name] = layer.features;\n            }\n        } else {\n            tileData = null;\n        }\n\n        return {\n            tileData,\n            coords: originalDataTileCoords\n        };\n    }\n}\n\nexport {MapillaryLoader};\n","class Cache {\n    constructor(maxSize) {\n        this._maxSize = maxSize;\n        this._store = {};\n        this._size = 0;\n    }\n\n    get(key) {\n        if (key in this._store) {\n            const value = this._store[key];\n            delete this._store[key];\n            this._store[key] = value;\n            return {value, found: true};\n        }\n        return {found: false};\n    }\n\n    put(key, value) {\n        if (key in this._store) {\n            delete this._store[key];\n        } else {\n            this._size += 1;\n        }\n        this._store[key] = value;\n        if (this._size > this._maxSize) {\n            delete this._store[Object.keys(this._store)[0]];\n            this._size -= 1;\n        }\n    }\n}\n\nexport {Cache};\n","import Pbf from 'pbf';\nimport {Tile as TileProto} from './vector_tile_pb';\n\nfunction decodeCoordinate(x) {\n    return ((x >> 1) ^ (-(x & 1)));\n}\n\nfunction parseGeometry(geometryType, ints, coordinatesScale) { // eslint-disable-line complexity\n    if (geometryType !== TileProto.GeomType.POINT && geometryType !== TileProto.GeomType.LINESTRING &&\n        geometryType !== TileProto.GeomType.POLYGON) {\n        throw new Error(`Unknown feature geometry type ${geometryType}`);\n    }\n    const len = ints.length;\n    let pos = 0;\n    const lineStrings = [];\n    let line;\n    let x = 0,\n        y = 0;\n    while (pos < len) {\n        let i = ints[pos];\n        let cmd = i & 0x7;\n        let cmdRepeat = i >> 3;\n        switch (cmd) {\n            case 1: // MoveTo\n                if (cmdRepeat !== 1) {\n                    throw new Error(`repeat=${cmdRepeat} for command MoveTo`);\n                }\n                if (pos + 2 > len) {\n                    throw new Error('Not enough elements for MoveTo arguments');\n                }\n                if (line) {\n                    lineStrings.push(line);\n                }\n                x += decodeCoordinate(ints[pos + 1]);\n                y += decodeCoordinate(ints[pos + 2]);\n                line = [[x * coordinatesScale, y * coordinatesScale]];\n                pos += 3;\n                break;\n            case 2: // LineTo\n                if (cmdRepeat < 1) {\n                    throw new Error(`repeat=${cmdRepeat} for command LineTo`);\n                }\n                if (!line) {\n                    throw new Error('LineTo with empty linestring');\n                }\n                pos += 1;\n                for (let cmdN = 0; cmdN < cmdRepeat; cmdN++) {\n                    if (pos + 2 > len) {\n                        throw new Error('Not enough elements for LineTo arguments');\n                    }\n                    x += decodeCoordinate(ints[pos]);\n                    y += decodeCoordinate(ints[pos + 1]);\n                    line.push([x * coordinatesScale, y * coordinatesScale]);\n                    pos += 2;\n                }\n                break;\n            case 7: // ClosePath\n                if (geometryType !== TileProto.GeomType.POLYGON) {\n                    throw new Error(`ClosePath command for non-polygon type ${geometryType}`);\n                }\n                if (!line) {\n                    throw new Error('ClosePath with empty linestring');\n                }\n                if (cmdRepeat !== 1) {\n                    throw new Error(`ClosePath repeats ${cmdRepeat} times`);\n                }\n                line.push(line[0]);\n                pos += 1;\n                break;\n            default:\n                throw new Error(`Unknown command ${i} & 0x7 = ${cmd}`);\n        }\n    }\n    if (line) {\n        lineStrings.push(line);\n    }\n    const geometry = {};\n    switch (geometryType) {\n        case TileProto.GeomType.POINT:\n            if (lineStrings.length !== 1 || lineStrings[0].length !== 1) {\n                throw new Error('Invalid coordinates number for point');\n            }\n            geometry.type = 'Point';\n            geometry.coordinates = lineStrings[0][0];\n            break;\n        case TileProto.GeomType.LINESTRING:\n            geometry.type = 'MultiLineString';\n            geometry.coordinates = lineStrings;\n            break;\n        case TileProto.GeomType.POLYGON:\n            geometry.type = 'Polygon';\n            geometry.coordinates = lineStrings;\n            break;\n        default:\n    }\n    return geometry;\n}\n\nfunction parseFeatures(layer, coordinatesScale) {\n    const features = [];\n    for (let feature of layer.features) {\n        const geometry = parseGeometry(feature.type, feature.geometry, coordinatesScale);\n        features.push({geometry});\n    }\n    return features;\n}\n\nfunction decodeMvt(ar, tileExtent = 256) {\n    const\n        pbf = new Pbf(new Uint8Array(ar)),\n        tileData = TileProto.read(pbf);\n    const parsedLayers = [];\n    for (let layer of tileData.layers) {\n        let scale = tileExtent / layer.extent;\n        parsedLayers.push({\n            name: layer.name,\n            features: parseFeatures(layer, scale)\n        });\n    }\n    return parsedLayers;\n}\n\nexport {decodeMvt};\n","// code generated by pbf v3.0.5\n\n// Tile ========================================\n\nvar Tile = exports.Tile = {};\n\nTile.read = function (pbf, end) {\n    return pbf.readFields(Tile._readField, {layers: []}, end);\n};\nTile._readField = function (tag, obj, pbf) {\n    if (tag === 3) obj.layers.push(Tile.Layer.read(pbf, pbf.readVarint() + pbf.pos));\n};\n\nTile.GeomType = {\n    \"UNKNOWN\": 0,\n    \"POINT\": 1,\n    \"LINESTRING\": 2,\n    \"POLYGON\": 3\n};\n\n\n// Tile.Feature ========================================\n\nTile.Feature = {};\n\nTile.Feature.read = function (pbf, end) {\n    return pbf.readFields(Tile.Feature._readField, {id: 0, tags: [], type: 0, geometry: []}, end);\n};\nTile.Feature._readField = function (tag, obj, pbf) {\n    if (tag === 3) obj.type = pbf.readVarint();\n    else if (tag === 4) pbf.readPackedVarint(obj.geometry);\n};\n\n// Tile.Layer ========================================\n\nTile.Layer = {};\n\nTile.Layer.read = function (pbf, end) {\n    return pbf.readFields(Tile.Layer._readField, {version: 0, name: \"\", features: [], keys: [], values: [], extent: 0}, end);\n};\nTile.Layer._readField = function (tag, obj, pbf) {\n    if (tag === 15) obj.version = pbf.readVarint();\n    else if (tag === 1) obj.name = pbf.readString();\n    else if (tag === 2) obj.features.push(Tile.Feature.read(pbf, pbf.readVarint() + pbf.pos));\n    else if (tag === 5) obj.extent = pbf.readVarint();\n};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport './style.css';\n\nconst CloseButtonMixin = {\n    createCloseButton: function(container) {\n        this.closeButton = L.DomUtil.create('div', 'photo-viewer-button-close', container);\n        L.DomEvent.on(this.closeButton, 'click', this.onCloseClick, this);\n    },\n\n    onCloseClick: function() {\n        this.fire('closeclick');\n    },\n};\n\nfunction formatDateTime(ts) {\n    const d = new Date(ts);\n    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n    return `${d.getDate()} ${months[d.getMonth()]} ${d.getFullYear()}`;\n}\n\nconst DateLabelMixin = {\n    createDateLabel: function(container) {\n        this.dateLabel = L.DomUtil.create('div', 'mapillary-viewer-date-overlay', container);\n    },\n\n    updateDateLabel: function(timestamp) {\n        this.dateLabel.innerHTML = formatDateTime(timestamp);\n    }\n};\n\nexport {CloseButtonMixin, DateLabelMixin};\n","import L from 'leaflet';\nimport {MultiLayer, WikimediaVectorCoverage} from './coverage-layer';\nimport {fetch} from '~/lib/xhr-promise';\nimport './style.css';\nimport '../common/style.css';\nimport config from '~/config';\n\nfunction getCoverageLayer(options) {\n    const url = config.wikimediaCommonsCoverageUrl;\n    return new MultiLayer([\n        {layer: L.tileLayer(url, L.extend({}, options, {tms: true})), minZoom: 0, maxZoom: 10},\n        {layer: new WikimediaVectorCoverage(url, options), minZoom: 11, maxZoom: 18}\n    ]);\n}\n\nfunction parseSearchResponse(resp) { // eslint-disable-line complexity\n    const images = [];\n    if (resp && resp.query && resp.query.pages && resp.query.pages) {\n        for (let page of Object.values(resp.query.pages)) {\n            if (!page.coordinates || page.title.slice(-4).toLowerCase() !== '.jpg') {\n                continue;\n            }\n\n            const iinfo = page.imageinfo[0];\n            let imageDescription = iinfo.extmetadata.ImageDescription ? iinfo.extmetadata.ImageDescription.value : null;\n            let objectDescription = iinfo.extmetadata.ObjectName ? iinfo.extmetadata.ObjectName.value : null;\n            if (imageDescription && /^<table (.|\\n)+<\\/table>$/u.test(imageDescription)) {\n                imageDescription = null;\n            }\n            if (imageDescription) {\n                imageDescription = imageDescription.replace(/<[^>]+>/ug, '');\n                imageDescription = imageDescription.replace(/[\\n\\r]/ug, '');\n            }\n            if (\n                imageDescription &&\n                objectDescription &&\n                objectDescription.toLowerCase().includes(imageDescription.toLowerCase())\n            ) {\n                imageDescription = null;\n            }\n            if (\n                objectDescription &&\n                imageDescription &&\n                imageDescription.toLowerCase().includes(objectDescription.toLowerCase())\n            ) {\n                objectDescription = null;\n            }\n            let description = 'Wikimedia commons';\n            if (objectDescription || imageDescription) {\n                description = '';\n                if (objectDescription) {\n                    description = objectDescription;\n                }\n                if (imageDescription) {\n                    // eslint-disable-next-line max-depth\n                    if (objectDescription) {\n                        description += '</br>';\n                    }\n                    description += imageDescription;\n                }\n            }\n\n            let author = iinfo.extmetadata.Artist ? iinfo.extmetadata.Artist.value : null;\n            if (author && /^<table (.|\\n)+<\\/table>$/u.test(author)) {\n                author = `See author info at <a href=\"${iinfo.descriptionurl}\">Wikimedia commons</a>`;\n            }\n\n            // original images can be rotated, 90 degrees\n            // thumbnails are always oriented right\n            // so we request thumbnail of original image size\n            let url = iinfo.thumburl.replace('134px', `${iinfo.width}px`);\n            images.push({\n                url,\n                width: iinfo.width,\n                height: iinfo.height,\n                lat: page.coordinates[0].lat,\n                lng: page.coordinates[0].lon,\n                author: author,\n                timeOriginal: iinfo.extmetadata.DateTimeOriginal ? iinfo.extmetadata.DateTimeOriginal.value : null,\n                time: iinfo.extmetadata.DateTime ? iinfo.extmetadata.DateTime.value : null,\n                description: description,\n                pageUrl: iinfo.descriptionurl,\n                pageId: page.pageid.toString()\n            });\n        }\n        if (images.length) {\n            return images;\n        }\n    }\n    return null;\n}\n\nfunction isCloser(target, a, b) {\n    const d1 = target.distanceTo(a);\n    const d2 = target.distanceTo(b);\n    if (d1 < d2) {\n        return -1;\n    } else if (d1 === d2) {\n        return 0;\n    }\n    return 1;\n}\n\nasync function getPanoramaAtPos(latlng, searchRadiusMeters) {\n    latlng = L.latLng(latlng.lat, latlng.lng); // make independent copy\n\n    const clusterSize = 10;\n    const urlTemplate = 'https://commons.wikimedia.org/w/api.php?' +\n                        'origin=*&format=json&action=query&generator=geosearch&' +\n                        'ggsprimary=all&ggsnamespace=6&ggslimit=10&iilimit=1&coprimary=all&' +\n                        'ggsradius={radius}&ggscoord={lat}|{lng}&' +\n                        'iiurlwidth=134&' +\n                        'prop=imageinfo|coordinates&' +\n                        'iiprop=url|mime|size|extmetadata|commonmetadata|metadata';\n    searchRadiusMeters += clusterSize;\n    if (searchRadiusMeters < 10) {\n        searchRadiusMeters = 10;\n    }\n    if (searchRadiusMeters > 10000) {\n        searchRadiusMeters = 10000;\n    }\n    const url = L.Util.template(urlTemplate, {lat: latlng.lat, lng: latlng.lng, radius: Math.ceil(searchRadiusMeters)});\n    const resp = await fetch(url, {responseType: 'json', timeout: 10000});\n    if (resp.status === 200) {\n        let photos = parseSearchResponse(resp.responseJSON);\n        if (photos) {\n            photos.sort(isCloser.bind(null, latlng));\n            const nearestLatlng = L.latLng(photos[0].lat, photos[0].lng);\n            photos = photos.filter((photo) => nearestLatlng.distanceTo(L.latLng(photo.lat, photo.lng)) <= clusterSize);\n            return {\n                found: true,\n                data: photos\n            };\n        }\n        return {found: false};\n    }\n    return {found: false};\n}\n\nfunction formatDateTime(dateStr) {\n    const m = /^(\\d+)-(\\d+)-(\\d+)/u.exec(dateStr);\n    const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n    if (m) {\n        let [year, month, day] = m.slice(1);\n        return `${day} ${months[month - 1]} ${year}`;\n    }\n    return dateStr;\n}\n\nconst Viewer = L.Evented.extend({\n    initialize: function(container) {\n        container = L.DomUtil.create('div', 'wikimedia-viewer-container', container);\n        const mapContainer = this.mapContainer = L.DomUtil.create('div', 'wikimedia-viewer-map-container', container);\n        this.pageButtonContainer = L.DomUtil.create('div', 'wikimedia-viewer-page-buttons-container', container);\n\n        this.map = L.map(mapContainer, {\n            maxBoundsViscosity: 1,\n            crs: L.CRS.Simple,\n            zoomControl: false,\n            attributionControl: false,\n            zoomSnap: 0,\n        });\n\n        this.map.on('zoomend', this.notifyChange, this);\n        this.map.on('moveend', this.notifyChange, this);\n\n        this.infoLabel = L.DomUtil.create('div', 'wikimedia-viewer-info-overlay', mapContainer);\n        this.closeButton = L.DomUtil.create('div', 'photo-viewer-button-close', container);\n        this.prevPhotoButton = L.DomUtil.create('div', 'wikimedia-viewer-button-prev', mapContainer);\n        this.nextPhotoButton = L.DomUtil.create('div', 'wikimedia-viewer-button-next', mapContainer);\n        L.DomEvent.on(this.prevPhotoButton, 'click', () => {\n            this.switchPhoto(this._imageIdx - 1);\n        });\n        L.DomEvent.on(this.nextPhotoButton, 'click', () => {\n            this.switchPhoto(this._imageIdx + 1);\n        });\n        L.DomEvent.on(this.closeButton, 'click', this.onCloseClick, this);\n    },\n\n    setupPageButtons: function(count) {\n        if (this._buttons) {\n            for (let button of this._buttons) {\n                this.pageButtonContainer.removeChild(button);\n            }\n        }\n        this._buttons = [];\n        if (count > 1) {\n            L.DomUtil.addClass(this.pageButtonContainer, 'enabled');\n\n            for (let i = 0; i < count; i++) {\n                let button = L.DomUtil.create('div', 'wikimedia-viewer-page-button', this.pageButtonContainer);\n                button.innerHTML = String(i + 1);\n                this._buttons.push(button);\n                L.DomEvent.on(button, 'click', () => this.switchPhoto(i));\n            }\n        } else {\n            L.DomUtil.removeClass(this.pageButtonContainer, 'enabled');\n        }\n    },\n\n    switchPhoto: function(imageIdx, imagePos = null) {\n        this._imageIdx = imageIdx;\n        if (this.imageLayer) {\n            this.map.removeLayer(this.imageLayer);\n        }\n        let image = this.images[imageIdx];\n        let mapSize = this.map.getSize();\n        if (!mapSize.x || !mapSize.y) {\n            mapSize = {x: 500, y: 500};\n        }\n        let maxZoom = Math.log2(Math.max(image.width / mapSize.x, image.height / mapSize.y)) + 2;\n        if (maxZoom < 1) {\n            maxZoom = 1;\n        }\n        let\n            southWest = this.map.unproject([0, image.height], maxZoom - 2),\n            northEast = this.map.unproject([image.width, 0], maxZoom - 2);\n        const bounds = new L.LatLngBounds(southWest, northEast);\n        this.map.setMaxZoom(maxZoom);\n        this.map.setMaxBounds(bounds);\n        if (imagePos) {\n            this.map.setView(imagePos.center, imagePos.zoom, {animate: false});\n        } else {\n            this.map.fitBounds(bounds, {animate: false});\n        }\n\n        this.imageLayer = L.imageOverlay(null, bounds);\n        L.DomUtil.addClass(this.mapContainer, 'loading');\n        this.imageLayer.on('load', () => {\n            L.DomUtil.removeClass(this.mapContainer, 'loading');\n        });\n        this.imageLayer.setUrl(image.url);\n        this.imageLayer.addTo(this.map);\n        let caption = [];\n\n        if (image.timeOriginal) {\n            caption.push(formatDateTime(image.timeOriginal));\n        }\n        if (image.author) {\n            caption.push(image.author);\n        }\n        caption.push(`<a href=\"${image.pageUrl}\">${image.description}</a>`);\n        caption = caption.join('</br>');\n        this.infoLabel.innerHTML = caption;\n\n        if (imageIdx > 0) {\n            L.DomUtil.addClass(this.prevPhotoButton, 'enabled');\n        } else {\n            L.DomUtil.removeClass(this.prevPhotoButton, 'enabled');\n        }\n        if (imageIdx < this.images.length - 1) {\n            L.DomUtil.addClass(this.nextPhotoButton, 'enabled');\n        } else {\n            L.DomUtil.removeClass(this.nextPhotoButton, 'enabled');\n        }\n        for (let [i, button] of this._buttons.entries()) {\n            ((i === imageIdx) ? L.DomUtil.addClass : L.DomUtil.removeClass)(button, 'active');\n        }\n        this.notifyChange();\n    },\n\n    notifyChange: function() {\n        if (this.images && this._active) {\n            const image = this.images[this._imageIdx];\n            this.fire('change', {\n                    latlng: L.latLng(image.lat, image.lng),\n                    latlngs: this.images.map((image) => L.latLng(image.lat, image.lng))\n                }\n            );\n        }\n    },\n\n    _showPano: function(images, imageIdx = 0, imagePos = null) {\n        this.images = images;\n        this.setupPageButtons(images.length);\n        this.switchPhoto(imageIdx, imagePos);\n    },\n\n    showPano: function(images) {\n        this._showPano(images);\n    },\n\n    onCloseClick: function() {\n        this.fire('closeclick');\n    },\n\n    activate: function() {\n        this._active = true;\n    },\n\n    deactivate: function() {\n        this._active = false;\n    },\n\n    setState: function(state) {\n        const lat = parseFloat(state[0]);\n        const lng = parseFloat(state[1]);\n        const pageId = state[2];\n        const y = parseFloat(state[3]);\n        const x = parseFloat(state[4]);\n        const zoom = parseFloat(state[5]);\n        if (!isNaN(lat) && !isNaN(lng) && !isNaN(x) && !isNaN(y) && !isNaN(zoom)) {\n            let imageIdx = -1;\n            getPanoramaAtPos({lat, lng}, 0).then((resp) => {\n                if (!resp.found) {\n                    return;\n                }\n                for (let [i, image] of resp.data.entries()) {\n                    if (image.pageId === pageId) {\n                        imageIdx = i;\n                        break;\n                    }\n                }\n                if (imageIdx > -1) {\n                    this._showPano(resp.data, imageIdx, {center: L.latLng(y, x), zoom});\n                }\n            });\n            return true;\n        }\n        return false;\n    },\n\n    getState: function() {\n        if (!this.images) {\n            return [];\n        }\n        const center = this.map.getCenter();\n        return [\n            this.images[0].lat.toFixed(6),\n            this.images[0].lng.toFixed(6),\n            this.images[this._imageIdx].pageId,\n            center.lat.toFixed(2),\n            center.lng.toFixed(2),\n            this.map.getZoom().toFixed(1)\n        ];\n    },\n\n    invalidateSize: function() {\n        this.map.invalidateSize();\n    }\n});\n\nfunction getViewer(container) {\n    return new Viewer(container);\n}\n\nconst wikimediaProvider = {getCoverageLayer, getPanoramaAtPos, getViewer};\nexport default wikimediaProvider;\n","import L from 'leaflet';\nimport {TiledDataLoader} from '~/lib/tiled-data-loader';\n\nconst MultiLayer = L.Layer.extend({\n    initialize: function(layers) {\n        this.layers = layers;\n    },\n\n    setLayersVisibility: function(e) {\n        if (!this._map) {\n            return;\n        }\n\n        let newZoom;\n        if (e && e.zoom !== undefined) {\n            newZoom = e.zoom;\n        } else {\n            newZoom = this._map.getZoom();\n        }\n\n        for (let layer of this.layers) {\n            if (layer.minZoom <= newZoom && newZoom <= layer.maxZoom) {\n                this._map.addLayer(layer.layer);\n            } else {\n                this._map.removeLayer(layer.layer);\n            }\n        }\n    },\n\n    onAdd: function(map) {\n        this._map = map;\n        this.setLayersVisibility();\n        map.on('zoomend', this.setLayersVisibility, this);\n    },\n\n    onRemove: function() {\n        for (let layer of this.layers) {\n            this._map.removeLayer(layer.layer);\n        }\n        this._map.off('zoomend', this.setLayersVisibility, this);\n        this._map.off('zoomanim', this.setLayersVisibility, this);\n        this._map = null;\n    }\n\n});\n\nclass WikimediaLoader extends TiledDataLoader {\n    constructor(urlTemplate, zoom) {\n        super();\n        this.url = urlTemplate;\n        this.maxZoom = zoom;\n    }\n\n    getTileUrl(coords) {\n        const data = {\n            x: coords.x,\n            z: coords.z,\n            y: 2 ** coords.z - 1 - coords.y\n        };\n        return L.Util.template(this.url, data);\n    }\n\n    layerTileToDataTileCoords(layerTileCoords) {\n        let z = layerTileCoords.z;\n        let z2 = null;\n        if (z > this.maxZoom) {\n            z2 = this.maxZoom;\n        } else {\n            return {z, x: layerTileCoords.x, y: layerTileCoords.y};\n        }\n\n        let multiplier = 1 << (z - z2);\n        return {\n            x: Math.floor(layerTileCoords.x / multiplier),\n            y: Math.floor(layerTileCoords.y / multiplier),\n            z: z2\n        };\n    }\n\n    makeRequestData(dataTileCoords) {\n        return {\n            url: this.getTileUrl(dataTileCoords),\n            options: {\n                responseType: 'arraybuffer',\n                timeout: 10000,\n                isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 404\n            }\n        };\n    }\n\n    async processResponse(xhr, originalDataTileCoords) {\n        let tileData;\n        if (originalDataTileCoords.z >= this.maxZoom && xhr.status === 200 && xhr.response) {\n            tileData = new Uint16Array(xhr.response);\n        } else {\n            tileData = null;\n        }\n\n        return {\n            tileData,\n            coords: originalDataTileCoords\n        };\n    }\n}\n\nconst WikimediaVectorCoverage = L.GridLayer.extend({\n        options: {\n            tileSize: 256,\n            // updateWhenIdle: true,\n            color: '#ff00ff',\n        },\n\n        initialize: function(url, options) {\n            L.GridLayer.prototype.initialize.call(this, options);\n            this.loader = new WikimediaLoader(url, 11);\n        },\n\n        onAdd: function(map) {\n            L.GridLayer.prototype.onAdd.call(this, map);\n            this.on('tileunload', this.onTileUnload, this);\n        },\n\n        onRemove: function(map) {\n            L.GridLayer.prototype.onRemove.call(this, map);\n            this.off('tileunload', this.onTileUnload, this);\n        },\n\n        onTileUnload: function(e) {\n            const tile = e.tile;\n            tile._abortLoading();\n            delete tile._tileData;\n            delete tile._adjustment;\n        },\n\n        drawTile: function(canvas, _unused_coords) {\n            if (!this._map) {\n                return;\n            }\n            if (!canvas._tileData) {\n                return;\n            }\n            const dataOffset = 5000;\n            const dataExtent = 65535 - 2 * dataOffset;\n            const tileData = canvas._tileData;\n            let {multiplier, offsetX, offsetY} = canvas._adjustment;\n            const canvasCtx = canvas.getContext('2d');\n            const pixelScale = multiplier * 256 / dataExtent;\n            canvasCtx.fillStyle = this.options.color;\n            for (let i = 0, l = tileData.length; i < l; i += 2) {\n                let x = (tileData[i] - dataOffset) * pixelScale - offsetX * 256;\n                let y = (tileData[i + 1] - dataOffset) * pixelScale - offsetY * 256;\n                canvasCtx.beginPath();\n                canvasCtx.arc(x, y, 5, 0, 2 * Math.PI);\n                canvasCtx.fill();\n            }\n        },\n\n        createTile: function(coords, done) {\n            const canvas = L.DomUtil.create('canvas', 'leaflet-tile');\n            canvas.width = this.options.tileSize;\n            canvas.height = this.options.tileSize;\n            let {dataPromise, abortLoading} = this.loader.requestTileData(coords);\n            dataPromise.then((data) => {\n                if (!data.error) {\n                    canvas._tileData = data.tileData;\n                    canvas._adjustment = data.adjustment || {multiplier: 1, offsetX: 0, offsetY: 0};\n                    setTimeout(() => {\n                        this.drawTile(canvas, coords);\n                        done(null, canvas);\n                    }, 1);\n                }\n            });\n\n            canvas._abortLoading = abortLoading;\n            return canvas;\n        },\n    }\n);\n\nexport {MultiLayer, WikimediaVectorCoverage};\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import {arrayBufferToString} from '~/lib/binary-strings';\n\nconst selectFiles = (() => {\n    let fileInput;\n    return function selectFiles(multiple = false) {\n        if (fileInput) {\n            document.body.removeChild(fileInput);\n        }\n        fileInput = document.createElement('input');\n        document.body.appendChild(fileInput);\n        fileInput.type = 'file';\n        fileInput.multiple = Boolean(multiple);\n        fileInput.style.display = 'none';\n\n        const result = new Promise(function(resolve) {\n                fileInput.addEventListener('change', function() {\n                        resolve(fileInput.files);\n                    }\n                );\n            }\n        );\n        fileInput.click();\n        return result;\n    };\n})();\n\nfunction readFile(file) {\n    return new Promise(function(resolve) {\n            var reader = new FileReader();\n            reader.onload = function(e) {\n                resolve({\n                        data: arrayBufferToString(e.target.result),\n                        filename: file.name\n                    }\n                );\n            };\n            reader.readAsArrayBuffer(file);\n        }\n    );\n}\n\nfunction readFiles(files) {\n    files = Array.prototype.slice.apply(files);\n    return Promise.all(files.map(readFile));\n}\n\nexport {selectFiles, readFiles};\n","import parseGpx from './gpx';\nimport parseZip from './zip';\nimport {parseKmz, parseKml} from './kml';\nimport {parseOziPlt, parseOziRte, parseOziWpt} from './ozi';\n\nconst parsers = [\n    parseKmz,\n    parseZip,\n    parseGpx,\n    parseOziRte,\n    parseOziPlt,\n    parseOziWpt,\n    parseKml,\n];\n\nexport default parsers;\n","import {JSUnzip} from '~/vendored/github.com/augustl/js-unzip/js-unzip';\nimport jsInflate from './jsInflate';\nimport {decode866} from './codePages';\nimport parseGeoFile from '../parseGeoFile';\n\nfunction parseZip(txt, _unused_name) {\n    let unzipper;\n    try {\n        unzipper = new JSUnzip(txt);\n    } catch (e) {\n        return null;\n    }\n    if (!unzipper.isZipFile()) {\n        return null;\n    }\n    try {\n        unzipper.readEntries();\n    } catch (e) {\n        return null;\n    }\n    var geodata_array = [];\n    for (var i = 0; i < unzipper.entries.length; i++) {\n        var entry = unzipper.entries[i];\n        var uncompressed;\n        if (entry.compressionMethod === 0) {\n            uncompressed = entry.data;\n        } else if (entry.compressionMethod === 8) {\n            uncompressed = jsInflate(entry.data, entry.uncompressedSize);\n        } else {\n            return null;\n        }\n        var file_name = decode866(entry.fileName);\n        var geodata = parseGeoFile(file_name, uncompressed);\n        for (let item of geodata) {\n            if (item.error === 'UNSUPPORTED' && item.name.match(/(\\.(pdf|doc|txt|jpg))|\\/$/ui)) {\n                continue;\n            }\n            geodata_array.push(item);\n        }\n    }\n    return geodata_array;\n}\n\nexport default parseZip;\n","import {decode as utf8_decode} from 'utf8';\nimport {xmlGetNodeText} from './xmlUtils';\nimport stripBom from '~/lib/stripBom';\nimport JSUnzip from '~/vendored/github.com/augustl/js-unzip/js-unzip';\nimport jsInflate from './jsInflate';\n\nfunction parseKml(txt, name) {\n    var error;\n    function getSegmentPoints(coordinates_element) {\n        // convert multiline text value of tag to single line\n        var coordinates_string = xmlGetNodeText(coordinates_element);\n        var points_strings = coordinates_string.split(/\\s+/u);\n        var points = [];\n        for (var i = 0; i < points_strings.length; i++) {\n            if (points_strings[i].length) {\n                var point = points_strings[i].split(',');\n                var lat = parseFloat(point[1]);\n                var lng = parseFloat(point[0]);\n                if (isNaN(lat) || isNaN(lng)) {\n                    error = 'CORRUPT';\n                    break;\n                }\n                points.push({lat: lat, lng: lng});\n            }\n        }\n        return points;\n    }\n\n    function getTrackSegments(xml) {\n        var segments_elements = xml.getElementsByTagName('LineString');\n        var segments = [];\n        for (var i = 0; i < segments_elements.length; i++) {\n            var coordinates_element = segments_elements[i].getElementsByTagName('coordinates');\n            if (coordinates_element.length) {\n                var segment_points = getSegmentPoints(coordinates_element[0]);\n                if (segment_points.length) {\n                    segments.push(segment_points);\n                }\n            }\n        }\n        return segments;\n    }\n\n    function getPoints(dom) {\n        var points = [],\n            placemarks, i, coord, name, lat, lng, pointObjs;\n        placemarks = dom.getElementsByTagName('Placemark');\n        for (i = 0; i < placemarks.length; i++) {\n            pointObjs = placemarks[i].getElementsByTagName('Point');\n            if (pointObjs.length === 0) {\n                continue;\n            } else if (pointObjs.length > 1) {\n                error = 'CORRUPT';\n                break;\n            }\n            coord = pointObjs[0].getElementsByTagName('coordinates');\n            if (coord.length !== 1) {\n                error = 'CORRUPT';\n                break;\n            }\n            coord = xmlGetNodeText(coord[0]);\n            coord = coord.split(',');\n            lat = parseFloat(coord[1]);\n            lng = parseFloat(coord[0]);\n            if (isNaN(lat) || isNaN(lng)) {\n                error = 'CORRUPT';\n                break;\n            }\n            name = '';\n            const nameTags = placemarks[i].getElementsByTagName('name');\n            if (nameTags[0]) {\n                try {\n                    name = xmlGetNodeText(nameTags[0]);\n                    name = utf8_decode(name);\n                } catch (e) {\n                    error = 'CORRUPT';\n                }\n            }\n            points.push({\n                    name: name,\n                    lat: lat,\n                    lng: lng\n                }\n            );\n        }\n        return points;\n    }\n\n    txt = stripBom(txt);\n    txt = txt.replace(/<([^ >]+):([^ >]+)/ug, '<$1_$2');\n    let dom;\n    try {\n        dom = (new DOMParser()).parseFromString(txt, \"text/xml\");\n    } catch (e) {\n        return null;\n    }\n    if (dom.documentElement.nodeName === 'parsererror') {\n        return null;\n    }\n    if (dom.getElementsByTagName('kml').length === 0) {\n        return null;\n    }\n\n    return [{name: name, tracks: getTrackSegments(dom), points: getPoints(dom), error: error}];\n}\n\nfunction parseKmz(txt, name) {\n    var uncompressed;\n    let unzipper;\n    try {\n        unzipper = new JSUnzip(txt);\n    } catch (e) {\n        return null;\n    }\n    var tracks = [],\n        points = [],\n        geodata,\n        error;\n    var hasDocKml = false;\n    if (!unzipper.isZipFile()) {\n        return null;\n    }\n    try {\n        unzipper.readEntries();\n    } catch (e) {\n        return null;\n    }\n    var i, entry;\n    for (i = 0; i < unzipper.entries.length; i++) {\n        entry = unzipper.entries[i];\n        if (entry.fileName === 'doc.kml') {\n            hasDocKml = true;\n            break;\n        }\n    }\n    if (!hasDocKml) {\n        return null;\n    }\n\n    for (i = 0; i < unzipper.entries.length; i++) {\n        entry = unzipper.entries[i];\n        if (entry.fileName.match(/\\.kml$/iu)) {\n            if (entry.compressionMethod === 0) {\n                uncompressed = entry.data;\n            } else if (entry.compressionMethod === 8) {\n                uncompressed = jsInflate(entry.data, entry.uncompressedSize);\n            } else {\n                return null;\n            }\n            geodata = parseKml(uncompressed, 'dummmy');\n            if (geodata) {\n                error = error || geodata[0].error;\n                tracks.push(...geodata[0].tracks);\n                points.push(...geodata[0].points);\n            }\n        }\n    }\n\n    geodata = [{name: name, error: error, tracks: tracks, points: points}];\n    return geodata;\n}\n\nexport {parseKml, parseKmz};\n","import {decodeCP1251} from './codePages';\nimport stripBom from '~/lib/stripBom';\n\nfunction parseOziRte(txt, name) {\n    let error,\n        segments = [];\n    txt = stripBom(txt);\n    const lines = txt.split('\\n');\n    if (lines[0].indexOf('OziExplorer Route File') !== 0) {\n        return null;\n    }\n    let currentSegment = [];\n    for (let i = 4; i < lines.length; i++) {\n        let line = lines[i].trim();\n        if (!line) {\n            continue;\n        }\n        let fields = line.split(',');\n        if (fields[0] === 'R') {\n            if (currentSegment.length) {\n                segments.push(currentSegment);\n            }\n            currentSegment = [];\n        } else if (fields[0] === 'W') {\n            let lat = parseFloat(fields[5]);\n            let lng = parseFloat(fields[6]);\n            if (isNaN(lat) || isNaN(lng)) {\n                error = 'CORRUPT';\n                break;\n            }\n            currentSegment.push({lat, lng});\n        } else {\n            error = 'CORRUPT';\n            break;\n        }\n    }\n    if (currentSegment.length) {\n        segments.push(currentSegment);\n    }\n    return [{name, tracks: segments, error}];\n}\n\nfunction parseOziPlt(txt, name) {\n    var error;\n    var segments = [];\n    txt = stripBom(txt);\n    var lines = txt.split('\\n');\n    if (lines[0].indexOf('OziExplorer Track Point File') !== 0) {\n        return null;\n    }\n    var expected_points_num = parseInt(lines[5], 10);\n    var current_segment = [];\n    var total_points_num = 0;\n    for (var i = 6; i < lines.length; i++) {\n        var line = lines[i].trim();\n        if (!line) {\n            continue;\n        }\n        var fields = line.split(',');\n        var lat = parseFloat(fields[0]);\n        var lon = parseFloat(fields[1]);\n        var is_start_of_segment = parseInt(fields[2], 10);\n        if (isNaN(lat) || isNaN(lon) || isNaN(is_start_of_segment)) {\n            error = 'CORRUPT';\n            break;\n        }\n        if (is_start_of_segment) {\n            current_segment = [];\n        }\n        if (!current_segment.length) {\n            segments.push(current_segment);\n        }\n        current_segment.push({lat: lat, lng: lon});\n        total_points_num += 1;\n    }\n    if (isNaN(expected_points_num) || (expected_points_num !== 0 && expected_points_num !== total_points_num)) {\n        error = 'CORRUPT';\n    }\n    return [{name: name, tracks: segments, error: error}];\n}\n\nfunction parseOziWpt(txt, name) {\n    var points = [],\n        error,\n        lines, line,\n        i,\n        lat, lng, pointName, fields;\n    txt = stripBom(txt);\n    lines = txt.split('\\n');\n    if (lines[0].indexOf('OziExplorer Waypoint File') !== 0) {\n        return null;\n    }\n    for (i = 4; i < lines.length; i++) {\n        line = lines[i].trim();\n        if (!line) {\n            continue;\n        }\n        fields = line.split(',');\n        lat = parseFloat(fields[2]);\n        lng = parseFloat(fields[3]);\n        pointName = decodeCP1251(fields[1]).trim();\n        if (isNaN(lat) || isNaN(lng)) {\n            error = 'CORRUPT';\n            break;\n        }\n        points.push({\n                lat: lat,\n                lng: lng,\n                name: pointName\n            }\n        );\n    }\n    return [{name: name, points: points, error: error}];\n}\n\nexport {parseOziPlt, parseOziRte, parseOziWpt};\n","import SimpleService from './simpleService';\nimport Endomondo from './endomondo';\nimport Etomesto from './etomesto';\nimport Gpsies from './gpsies';\nimport Gpslib from './gpslib';\nimport Osm from './osm';\nimport Strava from './strava';\nimport Tracedetrail from './tracedetrail';\nimport {YandexRuler} from './yandex';\nimport {NakarteTrack, NakarteUrl} from './nakarte';\nimport {MovescountMove, MovescountRoute} from './movescount';\nimport {GarminActivity, GarminRoute} from './garmin';\nimport {SportsTrackerActivity} from './sportstracker';\nimport OpenStreetMapRu from './openstreetmapRu';\n\nconst services = [\n    YandexRuler,\n    NakarteTrack,\n    NakarteUrl,\n    Endomondo,\n    Etomesto,\n    Gpsies,\n    Gpslib,\n    Osm,\n    Strava,\n    Tracedetrail,\n    MovescountMove,\n    MovescountRoute,\n    GarminActivity,\n    GarminRoute,\n    SportsTrackerActivity,\n    OpenStreetMapRu,\n    SimpleService\n];\n\nexport default services;\n","import BaseService from './baseService';\nimport parseGeoFile from '../parseGeoFile';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nclass SimpleService extends BaseService {\n    isOurUrl() {\n        return Boolean(this.origUrl.match(/^https?:\\/\\/.+/u));\n    }\n\n    requestOptions() {\n        return [{\n            url: urlViaCorsProxy(this.origUrl),\n            options: {responseType: 'binarystring'}\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        return parseGeoFile(this.nameFromUrl(response.responseURL), response.responseBinaryText);\n    }\n}\n\nexport default SimpleService;\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nclass Endomondo extends BaseService {\n    urlRegexps = [\n        /^https?:\\/\\/(?:www\\.)?endomondo\\.com\\/users\\/(\\d+)\\/workouts\\/(\\d+)/u,\n        /^https?:\\/\\/(?:www\\.)?endomondo\\.com\\/workouts\\/(\\d+)\\/(\\d+)/u\n    ];\n\n    isOurUrl() {\n        return this.urlRegexps.some((re) => re.test(this.origUrl));\n    }\n\n    requestOptions() {\n        let userId, trackId;\n        let m = this.urlRegexps[0].exec(this.origUrl);\n        if (m) {\n            [userId, trackId] = [m[1], m[2]];\n        } else {\n            m = this.urlRegexps[1].exec(this.origUrl);\n            [trackId, userId] = [m[1], m[2]];\n        }\n        return [{\n            url: urlViaCorsProxy(`https://www.endomondo.com/rest/v1/users/${userId}/workouts/${trackId}`),\n            options: {\n                responseType: 'json',\n                isResponseSuccess: (xhr) => (xhr.status === 200 || xhr.status === 404)\n            },\n\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        if (response.status === 404) {\n            return [{error: 'Invalid link or user disabled viewing this workout track'}];\n        }\n\n        const data = response.responseJSON;\n        if (!data) {\n            return [{name: 'Endomondo activity', error: 'UNSUPPORTED'}];\n        }\n        if (!data.points || !data.points.points) {\n            return [{error: 'Endomondo user disabled viewing this workout track'}];\n        }\n\n        const track = data.points.points\n            .filter((p) => p.latitude)\n            .map((p) => ({\n                        lat: p.latitude,\n                        lng: p.longitude\n            }));\n        if (track.length === 0) {\n            return [{error: 'Endomondo user disabled viewing this workout track'}];\n        }\n\n        const date = data.local_start_time.split('T')[0];\n        const dist = `${data.distance.toFixed(1)} km`;\n        let trackName = `${date}, ${dist}`;\n        if (data.author && data.author.name) {\n            trackName += ` ${data.author.name}`;\n        }\n        if (data.title) {\n            trackName += `: ${data.title}`;\n        }\n        return [{\n            name: trackName,\n            tracks: [track]\n        }];\n    }\n}\n\nexport default Endomondo;\n","import urlViaCorsProxy from '~/lib/CORSProxy';\nimport BaseService from './baseService';\nimport parseGpx from '../parsers/gpx';\n\nclass Etomesto extends BaseService {\n    urlRe = /^https?:\\/\\/(?:www\\.)?etomesto\\.ru\\/track([a-z0-9]+)/u;\n\n    getTrackId() {\n        const m = this.urlRe.exec(this.origUrl);\n        return m[1];\n    }\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const trackId = this.getTrackId();\n        return [{\n            url: urlViaCorsProxy(`http://www.etomesto.ru/save/${trackId}.gpx`),\n            options: {\n                responseType: 'binarystring',\n                isResponseSuccess: (xhr) => (\n                    xhr.status === 200 &&\n                    !xhr.responseBinaryText.startsWith('ERROR'))\n            }\n        }];\n    }\n\n    parseResponse(responses) {\n        const trackId = this.getTrackId();\n        const response = responses[0];\n        const name = `Etomesto track ${trackId}`;\n        return parseGpx(response.responseBinaryText, name, true) || [{name: name, error: 'UNSUPPORTED'}];\n    }\n}\n\nexport default Etomesto;\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\nimport parseGpx from '../parsers/gpx';\nimport urlEncode from './urlEncode';\n\nclass Gpsies extends BaseService {\n    urlRe = /^https?:\\/\\/www\\.gpsies\\.com\\/map\\.do[^?]*\\?fileId=([a-z]+)/u;\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = m[1];\n        const newUrl = urlViaCorsProxy('https://www.gpsies.com/download.do');\n        return [{\n            url: newUrl,\n            options: {\n                method: 'POST',\n                data: urlEncode({\n                        fileId: trackId,\n                        speed: '10',\n                        dataType: '3',\n                        filetype: 'gpxTrk',\n                        submitButton: '',\n                        inappropriate: ''\n                    }\n                ),\n                headers: [[\"Content-type\", \"application/x-www-form-urlencoded\"]],\n                responseType: 'binarystring'\n            }\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        return parseGpx(response.responseBinaryText, this.nameFromUrl(response.responseURL), true) ||\n            [{name: name, error: 'UNSUPPORTED'}];\n    }\n}\n\nexport default Gpsies;\n","function urlEncode(d) {\n    return Object.entries(d).map(([k, v]) => `${k}=${encodeURIComponent(v)}`).join('&');\n}\n\nexport default urlEncode;\n","import urlViaCorsProxy from '~/lib/CORSProxy';\nimport BaseService from './baseService';\nimport parseGpx from '../parsers/gpx';\n\nclass Gpslib extends BaseService {\n    urlRe = /^https?:\\/\\/(?:.+\\.)?gpslib\\.[^.]+\\/tracks\\/info\\/(\\d+)/u;\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[1];\n        return [{\n            url: urlViaCorsProxy(`https://www.gpslib.ru/tracks/download/${trackId}.gpx`),\n            options: {responseType: 'binarystring'}\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        return parseGpx(response.responseBinaryText, `GPSLib ${this.trackId}`, true) ||\n            [{name: name, error: 'UNSUPPORTED'}];\n    }\n}\n\nexport default Gpslib;\n","import urlViaCorsProxy from '~/lib/CORSProxy';\nimport BaseService from './baseService';\nimport parseGpx from '../parsers/gpx';\n\nclass Osm extends BaseService {\n    urlRe = /^https?:\\/\\/(?:www\\.)?openstreetmap\\.org\\/user\\/(?:.*)\\/traces\\/(\\d+)/u;\n\n    getTrackId() {\n        const m = this.urlRe.exec(this.origUrl);\n        return m[1];\n    }\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const trackId = this.getTrackId();\n        return [{\n            url: urlViaCorsProxy(`https://www.openstreetmap.org/trace/${trackId}/data`),\n            options: {responseType: 'binarystring'}\n        }];\n    }\n\n    parseResponse(responses) {\n        const trackId = this.getTrackId();\n        const response = responses[0];\n        return parseGpx(response.responseBinaryText, `OSM track ${trackId}`, true) ||\n            [{name: name, error: 'UNSUPPORTED'}];\n    }\n}\n\nexport default Osm;\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nclass Strava extends BaseService {\n    urlRe = /^https?:\\/\\/(?:.+\\.)?strava\\.com\\/activities\\/(\\d+)/u;\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[1];\n        function isResponseSuccess(response) {\n            return [200, 401, 404].includes(response.status);\n        }\n        return [\n            {\n                url: urlViaCorsProxy(`https://www.strava.com/activities/${trackId}?hl=en-GB`),\n                options: {\n                    isResponseSuccess\n                }\n            },\n            {\n                url: urlViaCorsProxy(`https://www.strava.com/stream/${trackId}?streams%5B%5D=latlng`),\n                options: {\n                    responseType: 'json',\n                    isResponseSuccess\n                }\n            }\n        ];\n    }\n\n    parseResponse(responses) {\n        const statusMessages = {\n            401: 'Requested Strava activity marked as private',\n            404: 'Requested Strava activity could not be found'\n        };\n        const [pageResponse, trackResponse] = responses;\n        if (trackResponse.status !== 200) {\n            return [{error: statusMessages[trackResponse.status]}];\n        }\n        let name = `Strava ${this.trackId}`;\n        const latlngs = trackResponse.responseJSON?.latlng;\n        if (!latlngs || !Array.isArray(latlngs)) {\n            return [{name, error: 'UNSUPPORTED'}];\n        }\n        const tracks = [latlngs.map((p) => ({lat: p[0], lng: p[1]}))];\n        let dom;\n        try {\n            dom = (new DOMParser()).parseFromString(pageResponse.response, 'text/html');\n        } catch (e) {\n            // will use default name\n        }\n        if (dom) {\n            const userName = (dom.querySelector('a.minimal[href*=\"/athletes/\"]')?.textContent ?? '').trim();\n            const activityTitle = (dom.querySelector('h1.activity-name')?.textContent ?? '').trim();\n            let date = dom.querySelector('time')?.textContent ?? '';\n            date = date.split(',')[1] ?? '';\n            date = date.trim();\n            if (userName && activityTitle && date) {\n                name = `${userName} - ${activityTitle} ${date}`;\n            }\n        }\n        return [{\n            name,\n            tracks\n        }];\n    }\n}\n\nexport default Strava;\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\nimport L from 'leaflet';\n\nclass Tracedetrail extends BaseService {\n    urlRe = /^https?:\\/\\/(?:www\\.)?tracedetrail\\.[a-z]{2,}.*\\/trace\\/trace\\/([0-9]+)/u;\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[1];\n\n        return [{\n            url: urlViaCorsProxy(`https://tracedetrail.com/en/trace/geomSections/${trackId}`),\n            options: {responseType: 'json'}\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        let name = `Tracedetrail track ${this.trackId}`;\n        try {\n            name = response.responseJSON.nom_fr || name;\n            const geometry = JSON.parse(response.responseJSON.geometry);\n            const proj = L.CRS.EPSG3857;\n            const points = geometry.map((item) => proj.unproject(L.point(item.lon, item.lat)));\n\n            return [{\n                name,\n                tracks: [points]\n            }];\n        } catch (e) {\n            let error = 'UNSUPPORTED';\n\n            if (response.status === 200) {\n                error = `Track with id ${this.trackId} was deleted or did not exist`;\n            }\n\n            return [{name, error}];\n        }\n    }\n}\n\nexport default Tracedetrail;\n","import BaseService from './baseService';\n\nclass YandexRuler extends BaseService {\n    urlRe = /yandex\\..+[?&]rl=([^&]+)/u;\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        return [];\n    }\n\n    parseResponse() {\n        let last_lat = 0;\n        let last_lng = 0;\n        let error;\n        const points = [];\n        let s = this.urlRe.exec(this.origUrl)[1];\n        s = s.replace(/%2C/iug, ',');\n        const points_str = s.split('~');\n        for (let i = 0; i < points_str.length; i++) {\n            let point = points_str[i].split(',');\n            let lng = parseFloat(point[0]);\n            let lat = parseFloat(point[1]);\n            if (isNaN(lat) || isNaN(lng)) {\n                error = 'CORRUPT';\n                break;\n            }\n            last_lng += lng;\n            last_lat += lat;\n            points.push({lat: last_lat, lng: last_lng});\n        }\n        return [{\n            error: error,\n            tracks: [points],\n            name: 'Yandex ruler'\n        }];\n    }\n}\n\n// function parseYandexMap(txt) {\n//     var start_tag = '<script id=\"vpage\" type=\"application/json\">';\n//     var json_start = txt.indexOf(start_tag);\n//     if (json_start === -1) {\n//         return null;\n//     }\n//     json_start += start_tag.length;\n//     var json_end = txt.indexOf('</script>', json_start);\n//     if (json_end === -1) {\n//         return null;\n//     }\n//     var map_data = txt.substring(json_start, json_end);\n//     map_data = JSON.parse(map_data);\n//     console.log(map_data);\n//     if (!('request' in map_data)) {\n//         return null;\n//     }\n//     var name = 'YandexMap';\n//     var segments = [];\n//     var error;\n//     if (map_data.vpage && map_data.vpage.data && map_data.vpage.data.objects && map_data.vpage.data.objects.length) {\n//         var mapName = ('' + (map_data.vpage.data.name || '')).trim();\n//         if (mapName.length > 3) {\n//             name = '';\n//         } else if (mapName.length) {\n//             name += ': ';\n//         }\n//         name += fileutils.decodeUTF8(mapName);\n//         map_data.vpage.data.objects.forEach(function(obj){\n//             if (obj.pts && obj.pts.length) {\n//                 var segment = [];\n//                 for (var i=0; i< obj.pts.length; i++) {\n//                     var pt = obj.pts[i];\n//                     var lng = parseFloat(pt[0]);\n//                     var lat = parseFloat(pt[1]);\n//                     if (isNaN(lat) || isNaN(lng)) {\n//                         error = 'CORRUPT';\n//                         break;\n//                     }\n//                     segment.push({lat: lat, lng:lng});\n//                 }\n//                 if (segment.length) {\n//                     segments.push(segment);\n//                 }\n//             }\n//         });\n//     }\n//     if (map_data.request.args && map_data.request.args.rl) {\n//         var res = parseYandexRulerString(map_data.request.args.rl);\n//         error = error || res.error;\n//         if (res.points && res.points.length) {\n//             segments.push(res.points);\n//         }\n//     }\n//     return [{name: name, error: error, tracks: segments}];\n// }\n\nexport {YandexRuler};\n","'use strict'; // code generated by pbf v3.0.5\n\n// Segment ========================================\n\nvar self = exports;\n\nvar Segment = self.Segment = {};\n\nSegment.read = function (pbf, end) {\n    return pbf.readFields(Segment._readField, {lats: [], lons: []}, end);\n};\nSegment._readField = function (tag, obj, pbf) {\n    if (tag === 1) pbf.readPackedSVarint(obj.lats);\n    else if (tag === 2) pbf.readPackedSVarint(obj.lons);\n};\nSegment.write = function (obj, pbf) {\n    if (obj.lats) pbf.writePackedSVarint(1, obj.lats);\n    if (obj.lons) pbf.writePackedSVarint(2, obj.lons);\n};\n\n// Waypoint ========================================\n\nvar Waypoint = self.Waypoint = {};\n\nWaypoint.read = function (pbf, end) {\n    return pbf.readFields(Waypoint._readField, {lat: 0, lon: 0, name: \"\"}, end);\n};\nWaypoint._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.lat = pbf.readSVarint();\n    else if (tag === 2) obj.lon = pbf.readSVarint();\n    else if (tag === 3) obj.name = pbf.readString();\n};\nWaypoint.write = function (obj, pbf) {\n    if (obj.lat) pbf.writeSVarintField(1, obj.lat);\n    if (obj.lon) pbf.writeSVarintField(2, obj.lon);\n    if (obj.name) pbf.writeStringField(3, obj.name);\n};\n\n// Waypoints ========================================\n\nvar Waypoints = self.Waypoints = {};\n\nWaypoints.read = function (pbf, end) {\n    return pbf.readFields(Waypoints._readField, {midLat: 0, midLon: 0, waypoints: []}, end);\n};\nWaypoints._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.midLat = pbf.readSVarint();\n    else if (tag === 2) obj.midLon = pbf.readSVarint();\n    else if (tag === 3) obj.waypoints.push(Waypoint.read(pbf, pbf.readVarint() + pbf.pos));\n};\nWaypoints.write = function (obj, pbf) {\n    if (obj.midLat) pbf.writeSVarintField(1, obj.midLat);\n    if (obj.midLon) pbf.writeSVarintField(2, obj.midLon);\n    if (obj.waypoints) for (var i = 0; i < obj.waypoints.length; i++) pbf.writeMessage(3, Waypoint.write, obj.waypoints[i]);\n};\n\n// Track ========================================\n\nvar Track = self.Track = {};\n\nTrack.read = function (pbf, end) {\n    return pbf.readFields(Track._readField, {name: \"\", segments: [], waypoints: null}, end);\n};\nTrack._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.name = pbf.readString();\n    else if (tag === 2) obj.segments.push(Segment.read(pbf, pbf.readVarint() + pbf.pos));\n    else if (tag === 3) obj.waypoints = Waypoints.read(pbf, pbf.readVarint() + pbf.pos);\n};\nTrack.write = function (obj, pbf) {\n    if (obj.name) pbf.writeStringField(1, obj.name);\n    if (obj.segments) for (var i = 0; i < obj.segments.length; i++) pbf.writeMessage(2, Segment.write, obj.segments[i]);\n    if (obj.waypoints) pbf.writeMessage(3, Waypoints.write, obj.waypoints);\n};\n\n// View ========================================\n\nvar View = self.View = {};\n\nView.read = function (pbf, end) {\n    return pbf.readFields(View._readField, {color: 0, shown: false, ticksShown: false}, end);\n};\nView._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.color = pbf.readVarint(true);\n    else if (tag === 2) obj.shown = pbf.readBoolean();\n    else if (tag === 3) obj.ticksShown = pbf.readBoolean();\n};\nView.write = function (obj, pbf) {\n    if (obj.color) pbf.writeVarintField(1, obj.color);\n    if (obj.shown) pbf.writeBooleanField(2, obj.shown);\n    if (obj.ticksShown) pbf.writeBooleanField(3, obj.ticksShown);\n};\n\n// TrackView ========================================\n\nvar TrackView = self.TrackView = {};\n\nTrackView.read = function (pbf, end) {\n    return pbf.readFields(TrackView._readField, {view: null, track: null}, end);\n};\nTrackView._readField = function (tag, obj, pbf) {\n    if (tag === 1) obj.view = View.read(pbf, pbf.readVarint() + pbf.pos);\n    else if (tag === 2) obj.track = Track.read(pbf, pbf.readVarint() + pbf.pos);\n};\nTrackView.write = function (obj, pbf) {\n    if (obj.view) pbf.writeMessage(1, View.write, obj.view);\n    if (obj.track) pbf.writeMessage(2, Track.write, obj.track);\n};\n","import * as urlSafeBase64 from '../../parsers/urlSafeBase64';\nimport {TRACKLIST_TRACK_COLORS} from '../../../track-list';\nimport loadFromUrl from '../../loadFromUrl';\n\nfunction parseWaypoint(rawPoint) {\n    let name = rawPoint.n;\n    let lat = Number(rawPoint.lt);\n    let lng = Number(rawPoint.ln);\n    if (typeof name !== 'string' || !name || isNaN(lat) || isNaN(lng) ||\n        lat < -90 || lat > 90 || lng < -180 || lng > 180) {\n        return {valid: false};\n    }\n    return {\n        valid: true,\n        point: {lat, lng, name}\n    };\n}\n\nfunction parseTrack(rawTrack) {\n    if (!rawTrack.length) {\n        return {valid: false};\n    }\n    const track = [];\n    for (let rawSegment of rawTrack) {\n        let segment = [];\n        if (!rawSegment || !rawSegment.length) {\n            return {valid: false};\n        }\n        for (let rawPoint of rawSegment) {\n            if (!rawPoint || rawPoint.length !== 2) {\n                return {valid: false};\n            }\n            let [lat, lng] = rawPoint.map(Number);\n            if (isNaN(lat) || isNaN(lng) || lat < -90 || lat > 90) {\n                return {valid: false};\n            }\n            segment.push({lat, lng});\n        }\n        track.push(segment);\n    }\n    return {valid: true, track};\n}\n\nasync function loadTracksFromJson(value) { // eslint-disable-line complexity\n    const errCorrupt = [{name: 'Track in url', error: 'CORRUPT'}];\n\n    const jsonString = urlSafeBase64.decode(value);\n    let data;\n    try {\n        data = JSON.parse(jsonString);\n    } catch (e) {\n        return errCorrupt;\n    }\n    if (!data || !data.length) {\n        return errCorrupt;\n    }\n    const geoDataArray = [];\n\n    for (let el of data) {\n        // Each track should contain either url or at least one of tracks and points\n        if (!el.u && !(el.p || el.t)) {\n            return errCorrupt;\n        }\n        let geodata;\n        if (el.u) {\n            geodata = await\n                loadFromUrl(el.u);\n            if (el.n && geodata.length === 1 && !geodata[0].error) {\n                geodata[0].name = el.n;\n            }\n        } else {\n            geodata = {};\n            geodata.name = el.n || 'Track';\n            if (el.t) {\n                const res = parseTrack(el.t);\n                if (!res.valid) {\n                    return errCorrupt;\n                }\n                geodata.tracks = res.track;\n            }\n            if (el.p) {\n                geodata.points = [];\n                for (let rawPoint of el.p) {\n                    let res = parseWaypoint(rawPoint);\n                    // eslint-disable-next-line max-depth\n                    if (!res.valid) {\n                        return errCorrupt;\n                    }\n                    geodata.points.push(res.point);\n                }\n            }\n            geodata = [geodata];\n        }\n        let viewProps = {};\n        if ('c' in el) {\n            let color = Number(el.c);\n            if (color < 0 || color >= TRACKLIST_TRACK_COLORS.length) {\n                return errCorrupt;\n            }\n            viewProps.color = color;\n        }\n        if ('v' in el) {\n            viewProps.trackHidden = !el.v;\n        }\n        if ('m' in el) {\n            viewProps.measureTicksShown = Boolean(el.m);\n        }\n        geodata.forEach((el) => Object.assign(el, viewProps));\n        geoDataArray.push(...geodata);\n    }\n    return geoDataArray;\n}\n\nexport default loadTracksFromJson;\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nclass MovescountBase extends BaseService {\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n}\n\nclass MovescountRoute extends MovescountBase {\n    urlRe = /^https?:\\/\\/(?:www\\.)?movescount\\.com\\/([a-z]{2}\\/)?map.*[?&]route=(\\d+)/u;\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[2];\n        return [{\n            url: urlViaCorsProxy(`http://www.movescount.com/Move/Route/${trackId}`),\n            options: {\n                responseType: 'json',\n                isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403\n            },\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        if (response.status === 403) {\n            return [{error: 'Movescount user disabled viewing this route'}];\n        }\n        let name = `Movescount route ${this.trackId}`;\n        const data = response.responseJSON;\n        if (!data) {\n            return [{name, error: 'UNSUPPORTED'}];\n        }\n\n        let points = [];\n        let track = [];\n\n        for (let i = 0; i < data.points.latitudes.length; i++) {\n            const latlng = {\n                lat: data.points.latitudes[i],\n                lng: data.points.longitudes[i]\n            };\n            track.push(latlng);\n            const point = data.points.data[i];\n            if (point) {\n                points.push({...latlng, name: point.name});\n            }\n        }\n\n        name = data.routeName ? data.routeName : name;\n\n        return [{\n            name,\n            points,\n            tracks: [track]\n        }];\n    }\n}\n\nclass MovescountMove extends MovescountBase {\n    urlRe = /^https?:\\/\\/(?:www\\.)?movescount\\.com\\/([a-z]{2}\\/)?moves\\/move(\\d+)/u;\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[2];\n        return [\n            {\n                url: urlViaCorsProxy(`http://www.movescount.com/Move/Track2/${trackId}`),\n                options: {\n                    responseType: 'json',\n                    isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403\n                }\n            },\n            {\n                url: urlViaCorsProxy(`https://www.movescount.com/moves/move${trackId}`),\n                options: {\n                    isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403 || xhr.status === 404\n                }\n            }\n        ];\n    }\n\n    parseResponse(responses) {\n        const [trackResponse, pageResponse] = responses;\n        if (trackResponse.status === 403) {\n            return [{error: 'Movescount user disabled viewing this activity'}];\n        }\n        let name = `Movescount move ${this.trackId}`;\n        const data = trackResponse.responseJSON;\n        if (!data) {\n            return [{name, error: 'UNSUPPORTED'}];\n        }\n\n        const track = data.TrackPoints.map((trackPoint) => ({\n                lat: trackPoint.Latitude,\n                lng: trackPoint.Longitude\n            })\n        );\n\n        const dom = (new DOMParser()).parseFromString(pageResponse.response, \"text/html\");\n        try {\n            const title = dom.querySelector('title').text.trim();\n            name = title ? title : name;\n        } catch (_) {\n            // use previously constructed name\n        }\n\n        return [{\n            name,\n            tracks: [track]\n        }];\n    }\n}\n\nexport {MovescountRoute, MovescountMove};\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nclass GarminBase extends BaseService {\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n}\n\nclass GarminRoute extends GarminBase {\n    urlRe = /^https?:\\/\\/connect\\.garmin\\.com\\/modern\\/course\\/(\\d+)/u;\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[1];\n        return [{\n            url: urlViaCorsProxy(`https://connect.garmin.com/modern/proxy/course-service/course/${trackId}`),\n            options: {\n                responseType: 'json',\n                isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403 || xhr.status === 404\n            },\n        }];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        if (response.status === 403) {\n            return [{error: 'Garmin Connect user disabled viewing this route'}];\n        }\n        if (response.status === 404) {\n            return [{error: 'Garmin Connect route does not exist'}];\n        }\n        let name = `Garmin Connect route ${this.trackId}`;\n        const data = response.responseJSON;\n        if (!data) {\n            return [{name, error: 'UNSUPPORTED'}];\n        }\n        let points = data.coursePoints.map((pt) => ({name: pt.name, lat: pt.lat, lng: pt.lon}));\n        let track = data.geoPoints.map((obj) => ({lat: obj.latitude, lng: obj.longitude}));\n        name = data.courseName ? data.courseName : name;\n        return [{\n            name,\n            points,\n            tracks: [track]\n        }];\n    }\n}\n\nclass GarminActivity extends GarminBase {\n    urlRe = /^https?:\\/\\/connect\\.garmin\\.com\\/modern\\/activity\\/(\\d+)/u;\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const trackId = this.trackId = m[1];\n        return [\n            {\n                url: urlViaCorsProxy(\n                    `https://connect.garmin.com/modern/proxy/activity-service/activity/${trackId}/details`),\n                options: {\n                    responseType: 'json',\n                    isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403 || xhr.status === 404\n                }\n            }\n        ];\n    }\n\n    parseResponse(responses) {\n        const response = responses[0];\n        if (response.status === 403) {\n            return [{error: 'Garmin Connect user disabled viewing this activity'}];\n        }\n        if (response.status === 404) {\n            return [{error: 'Garmin Connect activity does not exist'}];\n        }\n        let name = `Garmin Connect activity ${this.trackId}`;\n        const data = response.responseJSON;\n        if (!data) {\n            return [{name, error: 'UNSUPPORTED'}];\n        }\n        let track = data.geoPolylineDTO.polyline.map((obj) => ({lat: obj.lat, lng: obj.lon}));\n        return [{\n            name,\n            tracks: [track]\n        }];\n    }\n}\n\nexport {GarminRoute, GarminActivity};\n","import BaseService from './baseService';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\nimport utf8 from 'utf8';\n\nclass SportsTrackerBase extends BaseService {\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n}\n\nclass SportsTrackerActivity extends SportsTrackerBase {\n    urlRe = /^https?:\\/\\/(www\\.)?sports-tracker\\.com\\/workout\\/([^/]+)\\/([a-z0-9]+)/u;\n\n    requestOptions() {\n        const m = this.urlRe.exec(this.origUrl);\n        const activityId = m[3];\n        return [\n            {\n                url: urlViaCorsProxy(\n                    `https://api.sports-tracker.com/apiserver/v1/workouts/${activityId}/data?samples=100000`\n                ),\n                options: {\n                    responseType: 'binarystring',\n                    isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 403\n                }\n            },\n            {\n                url: urlViaCorsProxy(`https://api.sports-tracker.com/apiserver/v1/workouts/${activityId}/combined`),\n                options: {\n                    responseType: 'binarystring',\n                    isResponseSuccess: (xhr) => [200, 403, 404].includes(xhr.status)\n                }\n            }\n        ];\n    }\n\n    parseResponse(responses) {\n        const [dataResponse, metadataResponse] = responses;\n        if (metadataResponse.status === 404) {\n            return [{error: 'Sports Tracker activity not found'}];\n        }\n        if (dataResponse.status === 403) {\n            return [{error: 'Sports Tracker user disabled viewing this activity'}];\n        }\n        let data, metadata;\n        let name = `Sports Tracker activity`;\n        try {\n            data = JSON.parse(utf8.decode(dataResponse.responseBinaryText));\n            metadata = JSON.parse(utf8.decode(metadataResponse.responseBinaryText));\n        } catch (e) {\n            return [{name, error: 'UNSUPPORTED'}];\n        }\n        const track = data.payload.locations.map((location) => ({\n                lat: location.la,\n                lng: location.ln\n            })\n        );\n        if (data.payload.description) {\n            name = data.payload.description;\n        } else {\n            const startTime = new Date(metadata.payload.startTime).toDateString();\n            name = `${metadata.payload.fullname} on ${startTime}`;\n        }\n\n        return [{\n            name,\n            tracks: [track]\n        }];\n    }\n}\n\nexport {SportsTrackerActivity};\n","import urlViaCorsProxy from '~/lib/CORSProxy';\nimport BaseService from './baseService';\nimport parseGpx from '../parsers/gpx';\n\nclass OpenStreetMapRu extends BaseService {\n    urlRe = /^https?:\\/\\/(?:www\\.)?openstreetmap\\.ru\\/\\?mapid=(\\d+)/u;\n\n    getTrackId() {\n        const m = this.urlRe.exec(this.origUrl);\n        return m[1];\n    }\n\n    isOurUrl() {\n        return this.urlRe.test(this.origUrl);\n    }\n\n    requestOptions() {\n        const trackId = this.getTrackId();\n        return [{\n            url: urlViaCorsProxy(`https://openstreetmap.ru/mymap.php?id=${trackId}&format=gpx`),\n            options: {responseType: 'binarystring'}\n        }];\n    }\n\n    parseResponse(responses) {\n        const trackId = this.getTrackId();\n        const response = responses[0];\n        const geodata = parseGpx(response.responseBinaryText, `PersonalMap ${trackId}`, true);\n        if (!geodata) {\n            return [{name: name, error: 'UNSUPPORTED'}];\n        }\n        if (geodata[0].tracks.length === 0 && geodata[0].points.length === 0) {\n            return [{error: 'Personal map is empty or does not exist'}];\n        }\n        return geodata;\n    }\n}\n\nexport default OpenStreetMapRu;\n","import utf8 from 'utf8';\nimport escapeHtml from 'escape-html';\nimport {saveNktk} from './parsers/nktk';\n\nfunction saveGpx(segments, name, points, withElevations = false) {\n    const gpx = [];\n    const fakeTime = '1970-01-01T00:00:01.000Z';\n\n    gpx.push('<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\" ?>');\n    gpx.push(\n        '<gpx xmlns=\"http://www.topografix.com/GPX/1/1\" creator=\"http://nakarte.me\" ' +\n        'xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://www.topografix.com/GPX/1/1 ' +\n        'http://www.topografix.com/GPX/1/1/gpx.xsd\" version=\"1.1\">'\n    );\n    points.forEach(function(marker) {\n            var label = marker.label;\n            label = escapeHtml(label);\n            label = utf8.encode(label);\n            gpx.push(`\\t<wpt lat=\"${marker.latlng.lat.toFixed(6)}\" lon=\"${marker.latlng.lng.toFixed(6)}\">`);\n            if (withElevations && marker.latlng.alt !== null) {\n                gpx.push(`\\t\\t<ele>${marker.latlng.alt.toFixed(1)}</ele>`);\n            }\n            gpx.push(`\\t\\t<name>${label}</name>`);\n            gpx.push('\\t</wpt>');\n        }\n    );\n    if (segments.length > 0) {\n        name = name || 'Track';\n        name = escapeHtml(name);\n        name = utf8.encode(name);\n        gpx.push('\\t<trk>');\n        gpx.push('\\t\\t<name>' + name + '</name>');\n\n        for (let segment of segments) {\n            gpx.push('\\t\\t<trkseg>');\n            for (let point of segment) {\n                let x = point.lng.toFixed(6);\n                let y = point.lat.toFixed(6);\n                const elevation = (withElevations && point.alt !== null)\n                    ? `<ele>${point.alt.toFixed(1)}</ele>` : '';\n                // time element is not necessary, added for compatibility to Garmin Connect only\n                gpx.push(`\\t\\t\\t<trkpt lat=\"${y}\" lon=\"${x}\">${elevation}<time>${fakeTime}</time></trkpt>`);\n            }\n            gpx.push('\\t\\t</trkseg>');\n        }\n        gpx.push('\\t</trk>');\n    }\n    gpx.push('</gpx>');\n    return gpx.join('\\n');\n}\n\nfunction saveGpxWithElevations(segments, name, points) {\n    return saveGpx(segments, name, points, true);\n}\n\nfunction saveKml(segments, name, points) {\n    const kml = [];\n\n    name = name || 'Track';\n    name = escapeHtml(name);\n    name = utf8.encode(name);\n\n    kml.push('<?xml version=\"1.0\" encoding=\"UTF-8\"?>');\n    kml.push('<kml xmlns=\"http://www.opengis.net/kml/2.2\">');\n    kml.push('\\t<Document>');\n    kml.push(`\\t\\t<name>${name}</name>`);\n\n    for (let [i, segment] of segments.entries()) {\n        kml.push('\\t\\t<Placemark>');\n        kml.push(`\\t\\t\\t<name>Line ${(i + 1)}</name>`);\n        kml.push('\\t\\t\\t<LineString>');\n        kml.push('\\t\\t\\t\\t<tessellate>1</tessellate>');\n        kml.push('\\t\\t\\t\\t<coordinates>');\n\n        for (let point of segment) {\n            let x = point.lng.toFixed(6);\n            let y = point.lat.toFixed(6);\n            kml.push(`\\t\\t\\t\\t\\t${x},${y}`);\n        }\n\n        kml.push('\\t\\t\\t\\t</coordinates>');\n        kml.push('\\t\\t\\t</LineString>');\n        kml.push('\\t\\t</Placemark>');\n    }\n\n    points.forEach(function(marker) {\n            var label = marker.label;\n            label = escapeHtml(label);\n            label = utf8.encode(label);\n            var coordinates = marker.latlng.lng.toFixed(6) + ',' + marker.latlng.lat.toFixed(6) + ',0';\n\n            kml.push('\\t\\t<Placemark>');\n            kml.push('\\t\\t\\t<name>' + label + '</name>');\n            kml.push('\\t\\t\\t<Point>');\n            kml.push('\\t\\t\\t\\t<coordinates>' + coordinates + '</coordinates>');\n            kml.push('\\t\\t\\t</Point>');\n            kml.push('\\t\\t</Placemark>');\n        }\n    );\n\n    kml.push('\\t</Document>');\n    kml.push('\\t</kml>');\n\n    return kml.join('\\n');\n}\n\nexport {saveGpx, saveGpxWithElevations, saveKml, saveNktk as saveToString};\n\n","import L from 'leaflet';\n\nL.LineUtil.simplifyLatlngs = function simplifyLatlngs(points, tolerance) {\n    function latlngToXy(p) {\n        return {\n            x: p.lng,\n            y: p.lat\n        };\n    }\n\n    function xyToLatlng(p) {\n        return {\n            lat: p.y,\n            lng: p.x\n        };\n    }\n\n    points = points.map(latlngToXy);\n    points = L.LineUtil.simplify(points, tolerance);\n    points = points.map(xyToLatlng);\n    return points;\n};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport './edit_line.css';\nimport {wrapLatLngToTarget} from '~/lib/leaflet.fixes/fixWorldCopyJump';\n\nL.Polyline.EditMixinOptions = {\n    className: 'leaflet-editable-line'\n};\n\nL.Polyline.EditMixin = {\n    _nodeMarkersZOffset: 10000,\n\n    startEdit: function() {\n        if (this._map && !this._editing) {\n            this._editing = true;\n            this._drawingDirection = 0;\n            this.setupMarkers();\n            this.on('remove', this.stopEdit.bind(this));\n            this._map\n                .on('click', this.onMapClick, this)\n                .on('dragend', this.onMapEndDrag, this);\n            L.DomEvent.on(document, 'keyup', this.onKeyPress, this);\n            this._storedStyle = {weight: this.options.weight, opacity: this.options.opacity};\n            if (this._latlngs.length) {\n                this.setStyle({weight: 1.5, opacity: 1});\n            }\n            L.DomUtil.addClass(this._map._container, 'leaflet-line-editing');\n            this.fire('editstart', {target: this});\n        }\n    },\n\n    stopEdit: function(userCancelled) {\n        if (this._editing) {\n            this.stopDrawingLine();\n            this._editing = false;\n            this.removeMarkers();\n            L.DomEvent.off(document, 'keyup', this.onKeyPress, this);\n            this.off('remove', this.stopEdit.bind(this));\n            this._map\n                .off('click', this.onMapClick, this)\n                .off('dragend', this.onMapEndDrag, this);\n            if (this._latlngs.length) {\n                this.setStyle(this._storedStyle);\n            }\n            L.DomUtil.removeClass(this._map._container, 'leaflet-line-editing');\n            this.fire('editend', {target: this, userCancelled});\n        }\n    },\n\n    removeMarkers: function() {\n        this.getLatLngs().forEach(function(node) {\n                if (node._nodeMarker) {\n                    this.nodeMarkers.removeLayer(node._nodeMarker);\n                    delete node._nodeMarker._lineNode;\n                    delete node._nodeMarker;\n                }\n                if (node._segmentOverlay) {\n                    this.segmentOverlays.removeLayer(node._segmentOverlay);\n                    delete node._segmentOverlay._lineNode;\n                    delete node._segmentOverlay;\n                }\n            }.bind(this)\n        );\n    },\n\n    getMarkerIndex: function(marker) {\n        return this.getLatLngs().indexOf(marker._lineNode);\n    },\n\n    getSegmentOverlayIndex: function(segmentOverlay) {\n        return this.getLatLngs().indexOf(segmentOverlay._lineNode);\n    },\n\n    onNodeMarkerDragEnd: function(e) {\n        var marker = e.target,\n            nodeIndex = this.getMarkerIndex(marker);\n        this.replaceNode(nodeIndex, marker.getLatLng());\n        this._setupEndMarkers();\n    },\n\n    onNodeMarkerMovedChangeNode: function(e) {\n        var marker = e.target,\n            latlng = marker.getLatLng(),\n            node = marker._lineNode;\n        node.lat = latlng.lat;\n        node.lng = latlng.lng;\n        this.redraw();\n        this.fire('nodeschanged');\n    },\n\n    onNodeMarkerDblClickedRemoveNode: function(e) {\n        if (this._disableEditOnLeftClick) {\n            return;\n        }\n        if (this.getLatLngs().length < 2 || (this._drawingDirection && this.getLatLngs().length === 2)) {\n            return;\n        }\n        var marker = e.target,\n            nodeIndex = this.getMarkerIndex(marker);\n        this.removeNode(nodeIndex);\n        this._setupEndMarkers();\n    },\n\n    onMapClick: function(e) {\n        if (this._drawingDirection) {\n            let newNodeIndex,\n                refNodeIndex;\n            if (this._drawingDirection === -1) {\n                newNodeIndex = 1;\n                refNodeIndex = 0;\n            } else {\n                newNodeIndex = this._latlngs.length - 1;\n                refNodeIndex = this._latlngs.length - 1;\n            }\n            this.addNode(newNodeIndex, wrapLatLngToTarget(e.latlng, this._latlngs[refNodeIndex]));\n        } else {\n            if (!this.preventStopEdit) {\n                this.stopEdit(true);\n            }\n        }\n    },\n\n    onMapEndDrag: function(e) {\n        if (e.distance < 15) {\n            // get mouse position from map drag handler\n            var handler = e.target.dragging._draggable;\n            var mousePos = handler._startPoint.add(handler._newPos).subtract(handler._startPos);\n            var latlng = e.target.mouseEventToLatLng({clientX: mousePos.x, clientY: mousePos.y});\n            this.onMapClick({latlng: latlng});\n        }\n    },\n\n    startDrawingLine: function(direction, e) {\n        if (!this._editing) {\n            return;\n        }\n        if (direction === undefined) {\n            direction = 1;\n        }\n        if (this._drawingDirection === direction) {\n            return;\n        }\n        this.stopDrawingLine();\n        this._drawingDirection = direction;\n        if (e) {\n            var newNodeIndex = this._drawingDirection === -1 ? 0 : this.getLatLngs().length;\n            this.spliceLatLngs(newNodeIndex, 0, e.latlng);\n            this._setupEndMarkers();\n        }\n\n        this._map.on('mousemove', this.onMouseMoveFollowEndNode, this);\n        L.DomUtil.addClass(this._map._container, 'leaflet-line-drawing');\n        this._map.clickLocked = true;\n    },\n\n    stopDrawingLine: function() {\n        if (!this._drawingDirection) {\n            return;\n        }\n        this._map.off('mousemove', this.onMouseMoveFollowEndNode, this);\n        var nodeIndex = this._drawingDirection === -1 ? 0 : this.getLatLngs().length - 1;\n        this.spliceLatLngs(nodeIndex, 1);\n        this._drawingDirection = 0;\n        L.DomUtil.removeClass(this._map._container, 'leaflet-line-drawing');\n        this._map.clickLocked = false;\n        this._setupEndMarkers();\n        this.fire('drawend');\n    },\n\n    onKeyPress: function(e) {\n        if (e.target.tagName.toLowerCase() === 'input') {\n            return;\n        }\n        var code = e.keyCode;\n        switch (code) {\n            case 27:\n            case 13:\n                if (this._drawingDirection) {\n                    this.stopDrawingLine();\n                } else {\n                    if (!this.preventStopEdit) {\n                        this.stopEdit(true);\n                    }\n                }\n                L.DomEvent.stop(e);\n                break;\n            case 8:\n            case 46:\n                if (this._drawingDirection && this.getLatLngs().length > 2) {\n                    const nodeIndex = this._drawingDirection === 1 ? this.getLatLngs().length - 2 : 1;\n                    this.removeNode(nodeIndex);\n                    L.DomEvent.preventDefault(e);\n                }\n                break;\n\n            default:\n        }\n    },\n\n    onMouseMoveFollowEndNode: function(e) {\n        var nodeIndex = this._drawingDirection === -1 ? 0 : this.getLatLngs().length - 1;\n        let latlng = e.latlng;\n        if (this._latlngs.length > 0) {\n            latlng = wrapLatLngToTarget(latlng, this._latlngs[nodeIndex]);\n        }\n        this.spliceLatLngs(nodeIndex, 1, latlng);\n    },\n\n    makeNodeMarker: function(nodeIndex) {\n        // если кликнули по созданию нового трэка, то делаем линию тоньше только когда появятся 2 точки\n        if (this._latlngs.length === 2) {\n            this.setStyle({weight: 1.5, opacity: 1});\n        }\n        var node = this.getLatLngs()[nodeIndex],\n            marker = L.marker(node.clone(), {\n                    icon: L.divIcon({\n                        className: 'line-editor-node-marker-halo',\n                        html: '<div class=\"line-editor-node-marker\"></div>'\n                    }),\n                    draggable: true,\n                    zIndexOffset: this._nodeMarkersZOffset,\n                    projectedShift: () => this.shiftProjectedFitMapView()\n                }\n            );\n        marker\n            .on('drag', this.onNodeMarkerMovedChangeNode, this)\n            // .on('dragstart', this.fire.bind(this, 'editingstart'))\n            .on('dragend', this.onNodeMarkerDragEnd, this)\n            .on('dblclick', this.onNodeMarkerDblClickedRemoveNode, this)\n            .on('click', this.onNodeMarkerClickStartStopDrawing, this)\n            .on('contextmenu', function(e) {\n                    this.stopDrawingLine();\n                    this.fire('noderightclick', {\n                            nodeIndex: this.getMarkerIndex(marker),\n                            line: this,\n                            mouseEvent: e\n                        }\n                    );\n                }, this\n            );\n        marker._lineNode = node;\n        node._nodeMarker = marker;\n        marker.addTo(this.nodeMarkers);\n    },\n\n    onNodeMarkerClickStartStopDrawing: function(e) {\n        if (this._disableEditOnLeftClick) {\n            return;\n        }\n        var marker = e.target,\n            latlngs = this.getLatLngs(),\n            latlngs_n = latlngs.length,\n            nodeIndex = this.getMarkerIndex(marker);\n        if ((this._drawingDirection === -1 && nodeIndex === 1) ||\n            ((this._drawingDirection === 1 && nodeIndex === latlngs_n - 2))) {\n            this.stopDrawingLine();\n        } else if (nodeIndex === this.getLatLngs().length - 1) {\n            this.startDrawingLine(1, e);\n        } else if (nodeIndex === 0) {\n            this.startDrawingLine(-1, e);\n        }\n    },\n\n    makeSegmentOverlay: function(nodeIndex) {\n        const latlngs = this.getLatLngs(),\n            p1 = latlngs[nodeIndex],\n            p2 = latlngs[nodeIndex + 1];\n        if (!p2) {\n            return;\n        }\n        const segmentOverlay = L.polyline([p1, p2], {\n            weight: 10,\n            opacity: 0.0,\n            projectedShift: () => this.shiftProjectedFitMapView()\n        });\n        segmentOverlay.on('mousedown', this.onSegmentMouseDownAddNode, this);\n        segmentOverlay.on('contextmenu', function(e) {\n                this.stopDrawingLine();\n                this.fire('segmentrightclick', {\n                        nodeIndex: this.getSegmentOverlayIndex(segmentOverlay),\n                        mouseEvent: e,\n                        line: this\n                    }\n                );\n            }, this\n        );\n        segmentOverlay._lineNode = p1;\n        p1._segmentOverlay = segmentOverlay;\n        segmentOverlay.addTo(this.segmentOverlays);\n    },\n\n    onSegmentMouseDownAddNode: function(e) {\n        if (e.originalEvent.button !== 0 || this._disableEditOnLeftClick) {\n            return;\n        }\n        var segmentOverlay = e.target,\n            latlngs = this.getLatLngs(),\n            nodeIndex = this.getSegmentOverlayIndex(segmentOverlay) + 1;\n        const midPoint = L.latLngBounds(latlngs[nodeIndex], latlngs[nodeIndex - 1]).getCenter();\n        this.addNode(nodeIndex, wrapLatLngToTarget(e.latlng, midPoint));\n        if (L.Draggable._dragging) {\n            L.Draggable._dragging.finishDrag();\n        }\n        latlngs[nodeIndex]._nodeMarker.dragging._draggable._onDown(e.originalEvent);\n    },\n\n    addNode: function(index, latlng) {\n        var nodes = this.getLatLngs(),\n            isAddingLeft = (index === 1 && this._drawingDirection === -1),\n            isAddingRight = (index === nodes.length - 1 && this._drawingDirection === 1);\n        latlng = latlng.clone();\n        this.spliceLatLngs(index, 0, latlng);\n        this.makeNodeMarker(index);\n        if (!isAddingLeft && (index >= 1)) {\n            if (!isAddingRight) {\n                var prevNode = nodes[index - 1];\n                this.segmentOverlays.removeLayer(prevNode._segmentOverlay);\n                delete prevNode._segmentOverlay._lineNode;\n                delete prevNode._segmentOverlay;\n            }\n            this.makeSegmentOverlay(index - 1);\n        }\n        if (!isAddingRight) {\n            this.makeSegmentOverlay(index);\n        }\n        if (nodes.length < 3) {\n            this._setupEndMarkers();\n        }\n    },\n\n    removeNode: function(index) {\n        var nodes = this.getLatLngs(),\n            node = nodes[index],\n            marker = node._nodeMarker;\n        delete node._nodeMarker;\n        delete marker._lineNode;\n        this.spliceLatLngs(index, 1);\n        this.nodeMarkers.removeLayer(marker);\n        if (node._segmentOverlay) {\n            this.segmentOverlays.removeLayer(node._segmentOverlay);\n            delete node._segmentOverlay._lineNode;\n            delete node._segmentOverlay;\n        }\n        var prevNode = nodes[index - 1];\n        if (prevNode && prevNode._segmentOverlay) {\n            this.segmentOverlays.removeLayer(prevNode._segmentOverlay);\n            delete prevNode._segmentOverlay._lineNode;\n            delete prevNode._segmentOverlay;\n            if ((index < nodes.length - 1) || (index < nodes.length && this._drawingDirection !== 1)) {\n                this.makeSegmentOverlay(index - 1);\n            }\n        }\n    },\n\n    replaceNode: function(index, latlng) {\n        var nodes = this.getLatLngs(),\n            oldNode = nodes[index],\n            oldMarker = oldNode._nodeMarker;\n        this.nodeMarkers.removeLayer(oldNode._nodeMarker);\n        delete oldNode._nodeMarker;\n        delete oldMarker._lineNode;\n        latlng = latlng.clone();\n        this.spliceLatLngs(index, 1, latlng);\n        this.makeNodeMarker(index);\n        if (oldNode._segmentOverlay) {\n            this.segmentOverlays.removeLayer(oldNode._segmentOverlay);\n            delete oldNode._segmentOverlay._lineNode;\n            delete oldNode._segmentOverlay;\n            this.makeSegmentOverlay(index);\n        }\n        var prevNode = nodes[index - 1];\n        if (prevNode && prevNode._segmentOverlay) {\n            this.segmentOverlays.removeLayer(prevNode._segmentOverlay);\n            delete prevNode._segmentOverlay._lineNode;\n            delete prevNode._segmentOverlay;\n            this.makeSegmentOverlay(index - 1);\n        }\n    },\n\n    _setupEndMarkers: function() {\n        const nodesCount = this._latlngs.length;\n        if (nodesCount === 0) {\n            return;\n        }\n        const startIndex = this._drawingDirection === -1 ? 1 : 0;\n        const endIndex = this._drawingDirection === 1 ? nodesCount - 2 : nodesCount - 1;\n        const startIcon = this._latlngs[startIndex]._nodeMarker._icon;\n        L.DomUtil[this._drawingDirection === -1 ? 'removeClass' : 'addClass'](\n            startIcon, 'line-editor-node-marker-start'\n        );\n        if (endIndex >= 0) {\n            const endIcon = this._latlngs[endIndex]._nodeMarker._icon;\n            let func;\n            if (this._drawingDirection !== 1 && endIndex > 0) {\n                func = L.DomUtil.addClass;\n            } else {\n                func = L.DomUtil.removeClass;\n            }\n            func(endIcon, 'line-editor-node-marker-end');\n        }\n    },\n\n    setupMarkers: function() {\n        if (!this.segmentOverlays) {\n            this.segmentOverlays = L.featureGroup().addTo(this._map);\n        }\n        if (!this.nodeMarkers) {\n            this.nodeMarkers = L.featureGroup().addTo(this._map);\n        }\n        this.removeMarkers();\n        var latlngs = this.getLatLngs(),\n            startNode = 0,\n            endNode = latlngs.length - 1;\n        if (this._drawingDirection === -1) {\n            startNode += 1;\n        }\n        if (this._drawingDirection === 1) {\n            endNode -= 1;\n        }\n        for (var i = startNode; i <= endNode; i++) {\n            this.makeNodeMarker(i);\n            if (i < endNode) {\n                this.makeSegmentOverlay(i);\n            }\n        }\n        this._setupEndMarkers();\n    },\n\n    spliceLatLngs: function(...args) {\n        const latlngs = this.getLatLngs();\n        const res = latlngs.splice(...args);\n        this.setLatLngs(latlngs);\n        this.fire('nodeschanged');\n        return res;\n        // this._latlngs.splice(...args);\n        // this.redraw();\n    },\n\n    getFixedLatLngs: function() {\n        const start = this._drawingDirection === -1 ? 1 : 0;\n        let end = this._latlngs.length;\n        if (this._drawingDirection === 1) {\n            end -= 1;\n        }\n        return this._latlngs.slice(start, end);\n    },\n\n    disableEditOnLeftClick: function(disable) {\n        this._disableEditOnLeftClick = disable;\n    },\n\n    highlighNodesForDeletion: function(startNodeIndex, endNodeIndex) {\n        if (!this._editing) {\n            return;\n        }\n        const nodes = this.getLatLngs();\n        for (let i = 0; i < nodes.length; i++) {\n            const node = nodes[i];\n            const icon = node._nodeMarker._icon;\n            L.DomUtil[i >= startNodeIndex && i <= endNodeIndex ? 'addClass' : 'removeClass'](icon, 'highlight-delete');\n        }\n    }\n};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from \"leaflet\";\n\nfunction getSegmentSplitPointLat(latLng1, latLng2, lng) {\n    const deltaLat = latLng2.lat - latLng1.lat;\n    const deltaLng = latLng2.lng - latLng1.lng;\n    return latLng1.lat + deltaLat / deltaLng * (lng - latLng1.lng);\n}\n\nfunction splitLineAt180Meridian(latLngs) {\n    // this function also creates new LatLng object for all elements\n    const wrappedLatLngs = latLngs.map((ll) => ll.wrap());\n    const newLines = [];\n    if (latLngs.length < 2) {\n        return newLines;\n    }\n\n    let newLine = [wrappedLatLngs[0]];\n    newLines.push(newLine);\n    for (let i = 1; i < wrappedLatLngs.length; i++) {\n        let latLng = wrappedLatLngs[i];\n        let prevLatLng = wrappedLatLngs[i - 1];\n        if (Math.abs(latLng.lng - prevLatLng.lng) <= 180) {\n            newLine.push(latLng);\n        } else {\n            let positiveLng = L.Util.wrapNum(latLng.lng, [0, 360]);\n            let positivePrevLng = L.Util.wrapNum(prevLatLng.lng, [0, 360]);\n            let splitLng = 180 - 0.000001 * Math.sign(latLng.lng);\n            let splitPrevLng = 180 - 0.000001 * Math.sign(prevLatLng.lng);\n            let splitLat = getSegmentSplitPointLat(\n                L.latLng(prevLatLng.lat, positivePrevLng),\n                L.latLng(latLng.lat, positiveLng),\n                splitLng\n            );\n            let splitPrevLat = getSegmentSplitPointLat(\n                L.latLng(prevLatLng.lat, positivePrevLng),\n                L.latLng(latLng.lat, positiveLng),\n                splitPrevLng\n            );\n            newLine.push(L.latLng(splitPrevLat, splitPrevLng).wrap());\n            newLine = [L.latLng(splitLat, splitLng).wrap(), latLng];\n            newLines.push(newLine);\n        }\n    }\n    return newLines;\n}\n\nfunction splitLinesAt180Meridian(lines) {\n    return (lines || [])\n        .map((segment) => splitLineAt180Meridian(segment))\n        .reduce((acc, cur) => {\n            acc.push(...cur);\n            return acc;\n        }, []);\n}\n\nexport {splitLinesAt180Meridian};\n","import L from 'leaflet';\nimport './track-list';\nimport './ruler.css';\nimport {makeButton} from '~/lib/leaflet.control.commons';\n\nL.Control.TrackList.Ruler = L.Control.extend({\n    options: {\n        position: 'topleft'\n    },\n\n    initialize: function(trackList, options) {\n        L.Control.prototype.initialize.call(this, options);\n        this._trackList = trackList;\n    },\n\n    onAdd: function(map) {\n        this._map = map;\n        let {container} = makeButton('', 'Measure distance', 'icon-ruler');\n        this._container = container;\n        L.DomEvent.on(container, 'click', this.onClick, this);\n        return container;\n    },\n\n    onClick: function() {\n        this._trackList.setExpanded();\n        this._trackList.addTrackAndEdit('Ruler').measureTicksShown(true);\n    }\n\n});\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {NakarteUrlLoader} from './lib/services/nakarte';\n\nL.Control.TrackList.include({\n        hashParams: function() {\n            return new NakarteUrlLoader().paramNames();\n        },\n\n        loadTrackFromParam: async function(paramName, values) {\n            if (!values || !values.length) {\n                return;\n            }\n            this.readingFiles(this.readingFiles() + 1);\n            const geodata = await new NakarteUrlLoader().geoData(paramName, values);\n            const notEmpty = this.addTracksFromGeodataArray(geodata, paramName);\n            this.readingFiles(this.readingFiles() - 1);\n            if (notEmpty) {\n                this.setExpanded();\n            }\n        },\n    }\n);\n\n","import './track-list';\nimport L from 'leaflet';\nimport {parseNktkSequence} from './lib/parsers/nktk';\nimport safeLocalStorage from '~/lib/safe-localstorage';\nimport * as logging from '~/lib/logging';\n\nL.Control.TrackList.include({\n        maxLocalStorageSessions: 5,\n\n        saveTracksToStorage: function() {\n            var tracks = this.tracks(),\n                serialized = [],\n                i, track, s, key;\n\n            key = 'trackList_1';\n\n            if (tracks.length === 0) {\n                safeLocalStorage.setItem(key, '');\n                return;\n            }\n            for (i = 0; i < tracks.length; i++) {\n                track = tracks[i];\n                if ( 'default' !== track.group() ) {\n                    continue;\n                }\n                s = this.trackToString(track);\n                serialized.push(s);\n            }\n            if (serialized.length === 0) {\n                return;\n            }\n            s = '#nktk=' + serialized.join('/');\n\n            safeLocalStorage.setItem(key, s);\n        },\n\n        loadTracksFromStorage: function() {\n            let key = 'trackList_1';\n            let s = safeLocalStorage.getItem(key);\n            //safeLocalStorage.removeItem(key);\n            if (s) {\n                logging.captureBreadcrumb('load track from localStorage');\n                s = s.slice(6); // remove \"#nktk=\" prefix\n                let geodata = parseNktkSequence(s);\n                this.addTracksFromGeodataArray(geodata);\n            }\n        }\n    }\n);\n","import L from 'leaflet';\nimport './style.css';\nimport '~/lib/controls-styles/controls-styles.css';\nimport enableTopRow from '~/lib/leaflet.control.layers.top-row';\n\nfunction enableMinimize(control) {\n    const originalOnAdd = control.onAdd;\n    if (control._minimizeEnabled) {\n        return;\n    }\n    enableTopRow(control);\n\n    L.Util.extend(control, {\n            _minimizeEnabled: true,\n\n            onAdd: function(map) {\n                const container = originalOnAdd.call(this, map);\n                setTimeout(() => this.__injectMinimizeButtons(), 0);\n                return container;\n            },\n\n            __injectMinimizeButtons: function() {\n                const container = this._container;\n                const contentsWrapper = L.DomUtil.create('div', 'leaflet-control-content');\n                while (container.childNodes.length) {\n                    contentsWrapper.appendChild(container.childNodes[0]);\n                }\n                container.appendChild(contentsWrapper);\n                const minimizeButton = L.DomUtil.create('div', 'button-minimize');\n                this._topRow.appendChild(minimizeButton);\n                const expandButton = L.DomUtil.create('div', 'leaflet-control-button-toggle', container);\n                expandButton.title = 'Select layers';\n                L.DomEvent.on(expandButton, 'click', this.setExpanded, this);\n                L.DomEvent.on(minimizeButton, 'click', this.setMinimized, this);\n            },\n\n            setExpanded: function() {\n                L.DomUtil.removeClass(this._container, 'minimized');\n            },\n\n            setMinimized: function() {\n                L.DomUtil.addClass(this._container, 'minimized');\n            }\n        }\n    );\n    if (control._map) {\n        control.__injectMinimizeButtons();\n    }\n}\n\nexport default enableMinimize;\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport './style.css';\nimport enableTopRow from '~/lib/leaflet.control.layers.top-row';\nimport './customLayer';\n\nfunction enableConfig(control, {layers}) {\n    const originalOnAdd = control.onAdd;\n    const originalUnserializeState = control.unserializeState;\n    if (control._configEnabled) {\n        return;\n    }\n    enableTopRow(control);\n\n    L.Util.extend(control, {\n            _configEnabled: true,\n            _allLayersGroups: layers,\n            _allLayers: [].concat(...layers.map((group) => group.layers)),\n\n            onAdd: function(map) {\n                const container = originalOnAdd.call(this, map);\n                return container;\n            },\n\n            _initializeLayersState: function() {\n                this.updateEnabledLayers(); // eslint-disable-line\n            },\n\n            updateEnabledLayers: function(addedLayers) {\n                let hasBaselayerOnMap = false;\n                const enabledLayers = [...this._allLayers];\n                enabledLayers.sort((l1, l2) => l1.order - l2.order);\n                enabledLayers.forEach((l) => {\n                        l.layer._justAdded = addedLayers && addedLayers.includes(l);\n                        const {layer: {options: {isOverlay}}} = l;\n                        if (isOverlay) {\n                            this.addOverlay(l.layer, l.title);\n                        } else {\n                            this.addBaseLayer(l.layer, l.title);\n                        }\n                        if (!isOverlay && this._map.hasLayer(l.layer)) {\n                              hasBaselayerOnMap = true;\n                        }\n                    }\n                );\n                // если нет активного базового слоя, включить первый, если он есть\n                if (!hasBaselayerOnMap) {\n                    for (let layer of enabledLayers) {\n                        if (!layer.layer.options.isOverlay) {\n                            this._map.addLayer(layer.layer);\n                            break;\n                        }\n                    }\n                }\n                /* this.storeEnabledLayers(); */\n            },\n\n            unserializeState: function(values) {\n                this.updateEnabledLayers();\n                return originalUnserializeState.call(this, values);\n            },\n        }\n    );\n}\n\nexport default enableConfig;\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\n\nL.Layer.CustomLayer = L.TileLayer.extend({\n    getTileUrl: function(coords) {\n        const z = this._getZoomForUrl();\n        var data = {\n            r: L.Browser.retina ? '@2x' : '',\n            s: this._getSubdomain(coords),\n            x: coords.x,\n            y: coords.y,\n            z: z,\n            z_1: z + 1,\n            x_1024: Math.floor(coords.x / 1024),\n            y_1024: Math.floor(coords.y / 1024),\n        };\n        if (this._map && !this._map.options.crs.infinite) {\n            var invertedY = this._globalTileRange.max.y - coords.y;\n            if (this.options.tms) {\n                data['y'] = invertedY;\n                data['y_1024'] = Math.floor(invertedY / 1024);\n            }\n            data['-y'] = invertedY;\n        }\n\n        return L.Util.template(this._url, L.extend(data, this.options));\n    },\n\n    cloneForPrint: function(options) {\n        return new L.Layer.CustomLayer(this._url, L.Util.extend({}, this.options, options));\n    },\n\n});\n","import './style.css';\nimport L from 'leaflet';\n\nfunction raiseControlsOnFocus(map) {\n    const selectors = [\n        '.leaflet-top.leaflet-right',\n        '.leaflet-bottom.leaflet-right',\n        '.leaflet-top.leaflet-left',\n        '.leaflet-bottom.leaflet-left'\n    ];\n    let elements = map._container.querySelectorAll(selectors.join(','));\n\n    function raise(target) {\n        for (let cornerDiv of elements) {\n            if (cornerDiv === target) {\n                L.DomUtil.addClass(cornerDiv, 'leaflet-controls-corner-raised');\n            } else {\n                L.DomUtil.removeClass(cornerDiv, 'leaflet-controls-corner-raised');\n            }\n        }\n    }\n\n    [...elements].forEach((el) => L.DomEvent.on(el, 'mouseenter', raise.bind(null, el)));\n}\n\nexport default raiseControlsOnFocus;\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport '~/lib/leaflet.layer.yandex';\nimport '~/lib/leaflet.layer.google';\nimport '~/lib/leaflet.layer.soviet-topomaps-grid';\nimport '~/lib/leaflet.layer.wikimapia';\nimport {RetinaTileLayer} from '~/lib/leaflet.layer.RetinaTileLayer';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nconst layersDefs = [\n    {\n        title: 'OpenStreetMap',\n        description: 'OSM default style',\n        isDefault: true,\n        layer: L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n            {\n                code: 'O',\n                isOverlay: false,\n                scaleDependent: true,\n                print: true,\n                jnx: true,\n                shortName: 'osm',\n                attribution: '© Участники <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> '\n            }\n        )\n    },\n    {\n        title: 'OpenCycleMap',\n        description: '<a href=\"https://www.opencyclemap.org/docs/\">(Info and key)</a>',\n        isDefault: false,\n        layer: L.tileLayer('https://{s}.tile.thunderforest.com/cycle/{z}/{x}/{y}.png',\n            {\n                code: 'Ocm',\n                isOverlay: false,\n                scaleDependent: true,\n                print: true,\n                hotkey: 'H',\n                jnx: true,\n                shortName: 'opencyclemap',\n                attribution: 'Thunderforest <a href=\"https://www.opencyclemap.org/\">OpenCycleMap</a>'\n            }\n        )\n    },\n    {\n        title: 'OpenTopoMap',\n        isDefault: true,\n        layer: L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png',\n            {\n                code: 'Otm',\n                isOverlay: false,\n                maxNativeZoom: 17,\n                scaleDependent: true,\n                print: true,\n                jnx: true,\n                noCors: false,\n                shortName: 'opentopo',\n                attribution: '<a href=\"https://opentopomap.org/\">OpenTopoMap</a>'\n            }\n        )\n    },\n    {\n        title: 'Yandex Спутник',\n        isDefault: true,\n        layer: new L.Layer.Yandex.Sat(\n            {\n                scaleDependent: false,\n                code: 'S',\n                isOverlay: false,\n                print: true,\n                jnx: true,\n                shortName: 'yandex_sat',\n                attribution: '<a href=\"https://yandex.ru/maps/?l=sat\">Yandex</a>'\n            }\n        )\n    },\n    {\n        title: 'Google Спутник',\n        isDefault: true,\n        layer: new L.Layer.GoogleSat(\n            {\n                code: 'L',\n                isOverlay: false,\n                scaleDependent: false,\n                print: true,\n                jnx: true,\n                shortName: 'google_sat',\n                attribution: '<a href=\"https://www.google.com/maps/@45.0000194,34.336961,9z\">Google</a>'\n            }\n        )\n    },\n    {\n        title: 'ESRI Спутник',\n        isDefault: true,\n        layer: L.tileLayer(\n            'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',\n            {\n                code: 'E',\n                isOverlay: false,\n                scaleDependent: false,\n                maxNativeZoom: 18,\n                print: true,\n                jnx: true,\n                shortName: 'esri',\n                attribution: 'ESRI World Imagery for <a href=\"https://www.arcgis.com/\">ArcGIS</a>'\n            }\n        )\n    },\n    {\n        title: 'Советская карта (zoom ≥ 12)',\n        isDefault: true,\n        layer: L.tileLayer('https://{s}.tiles.nakarte.me/topo500/{z}/{x}/{y}',\n            {\n                code: 'B',\n                isOverlay: true,\n                isOverlayTransparent: false,\n                tms: true,\n                scaleDependent: false,\n                maxNativeZoom: 14,\n                minZoom: 12,\n                print: true,\n                jnx: true,\n                shortName: 'topo_500'\n            }\n        )\n    },\n    {\n        title: 'Разбивка на квадраты',\n        isDefault: true,\n        layer: new L.Layer.SovietTopoGrid({\n            code: 'Ng',\n            isOverlay: true,\n            print: false,\n            jnx: false\n        })\n    },\n    {\n        title: 'Wikimapia',\n        isDefault: true,\n        layer: new L.Wikimapia({\n            code: 'W',\n            hotkey: 'W',\n            isOverlay: true,\n            print: false,\n            jnx: false\n        })\n    },\n    {\n        title: 'OpenStreetMap GPS трэки',\n        isDefault: false,\n        layer: L.tileLayer('https://{s}.gps-tile.openstreetmap.org/lines/{z}/{x}/{y}.png',\n            {\n                code: 'Ot',\n                isOverlay: true,\n                isOverlayTransparent: true,\n                scaleDependent: true,\n                print: true,\n                jnx: false,\n                shortName: 'osm_gps_traces'\n            }\n        )\n    },\n    {\n        title: 'Strava трэки',\n        isDefault: false,\n        layer: new RetinaTileLayer(\n            [\n                urlViaCorsProxy(\n                    'https://heatmap-external-a.strava.com/tiles-auth/all/hot/{z}/{x}/{y}.png?px=256'\n                ),\n                urlViaCorsProxy(\n                    'https://heatmap-external-a.strava.com/tiles-auth/all/hot/{z}/{x}/{y}.png?px=512'\n                ),\n            ],\n            {\n                code: 'Sa',\n                hotkey: 'T',\n                isOverlay: true,\n                isOverlayTransparent: true,\n                scaleDependent: false,\n                print: true,\n                jnx: false,\n                subdomains: 'abc',\n                noCors: true,\n                shortName: 'strava_all',\n                retinaOptionsOverrides: [{maxNativeZoom: 16}, {maxNativeZoom: 15}],\n            }\n        )\n    },\n    {\n        title: 'Маркированные маршруты',\n        description: '<a href=\"https://hiking.waymarkedtrails.org/\">https://hiking.waymarkedtrails.org</a>',\n        isDefault: false,\n        layer: L.tileLayer('https://tile.waymarkedtrails.org/hiking/{z}/{x}/{y}.png',\n            {\n                code: 'Wh',\n                isOverlay: true,\n                tms: false,\n                print: true,\n                jnx: false,\n                scaleDependent: true,\n                shortName: 'hiking_trails',\n                isOverlayTransparent: true\n            })\n    },\n    {\n        title: 'Yandex трэки (zoom ≥ 10)',\n        isDefault: false,\n        layer: new L.Layer.Yandex.Tracks(\n            {\n                scaleDependent: true,\n                code: 'Ytr',\n                isOverlay: true,\n                isOverlayTransparent: true,\n                print: true,\n                jnx: false,\n                shortName: 'yandex_tracks',\n                noCors: true,\n            }\n        )\n    },\n];\n\nfunction getLayers() {\n    // set metadata\n    for (let layer of layersDefs) {\n        layer.layer.meta = {title: layer.title};\n    }\n\n    // divide layers by groups\n    const grouppedLayers = [];\n    let group = {group: 'title', layers: layersDefs};\n    grouppedLayers.push(group);\n\n    return {\n        layers: grouppedLayers,\n    };\n}\n\nexport {getLayers};\n","import L from 'leaflet';\nimport './style.css';\nimport Contextmenu from '~/lib/contextmenu';\nimport copyToClipboard from '~/lib/clipboardCopy';\n\nfunction zeroPad(num, size) {\n    var s = String(num);\n    while (s.length < size) {\n        s = \"0\" + s;\n    }\n    return s;\n}\n\nconst bigLetterReplacers = [\n    /* eslint-disable quote-props */\n    {\n        '1': 'А',\n        '2': 'Б',\n        '3': 'В',\n        '4': 'Г'\n    },\n    {\n        '1': 'A',\n        '2': 'B',\n        '3': 'C',\n        '4': 'D'\n    }\n    /* eslint-enable quote-props */\n];\n\nvar Nomenclature = {\n    getQuadName1m: function(column, row, join) {\n        var name = '';\n        if (row < 0) {\n            row = -row - 1;\n            name += 'x';\n        }\n        column += 31;\n        name += 'ABCDEFGHIJKLMNOPQRSTUV'[row] + '-' + zeroPad(column, 2);\n        for (var n = 1; n <= join - 1; n++) {\n            name += ',' + zeroPad(column + n, 2);\n        }\n        return [name];\n    },\n\n    getQuadName500k: function(column, row, join) {\n        var name1 = this.getQuadName1m(Math.floor(column / 2), Math.floor(row / 2), 1)[0];\n        var subquad = 2 - (row & 1) * 2 + (column & 1) + 1;\n        let name2 = '-' + subquad;\n        if (join > 1) {\n            name2 += ',' + (subquad + 1);\n        }\n        if (join === 4) {\n            name2 +=\n                ',' + this.getQuadName1m(Math.floor((column + 2) / 2), Math.floor(row / 2), 1) + '-' + subquad +\n                ',' + (subquad + 1);\n        }\n        const names = [name1 + name2];\n        for (let replacer of bigLetterReplacers) {\n            let name3 = name2.replace(/\\b[1-4]\\b/gu, (s) => replacer[s]);\n            names.push(name1 + name3);\n        }\n        return names;\n    },\n\n    getQuadName100k: function(column, row, join) {\n        var name = this.getQuadName1m(Math.floor(column / 12), Math.floor(row / 12), 1);\n        const subRow = row - Math.floor(row / 12) * 12;\n        const subColumn = column - Math.floor(column / 12) * 12;\n        var subquad = 132 - subRow * 12 + subColumn + 1;\n        name = name + '-' + zeroPad(subquad, 3);\n        if (join > 1) {\n            name += ',' + zeroPad(subquad + 1, 3);\n        }\n        if (join === 4) {\n            name += ',' + zeroPad(subquad + 2, 3) + ',' + zeroPad(subquad + 3, 3);\n        }\n\n        return [name];\n    },\n\n    getQuadName050k: function(column, row, join) {\n        var name1 = this.getQuadName100k(Math.floor(column / 2), Math.floor(row / 2), 1);\n        var subquad = 2 - (row & 1) * 2 + (column & 1) + 1;\n        let name2 = '-' + subquad;\n        if (join > 1) {\n            name2 += ',' + (subquad + 1);\n        }\n        if (join === 4) {\n            name2 += ',' + this.getQuadName100k(Math.floor((column + 2) / 2), Math.floor(row / 2), 1) + '-' +\n                subquad + ',' + (subquad + 1);\n        }\n        const names = [name1 + name2];\n        for (let replacer of bigLetterReplacers) {\n            let name3 = name2.replace(/\\b[1-4]\\b/gu, (s) => replacer[s]);\n            names.push(name1 + name3);\n        }\n        return names;\n    },\n\n    _getQuads: function(bounds, row_height, column_width, name_factory) {\n        bounds = L.latLngBounds(bounds);\n        var quads = [];\n        var min_lat = Math.max(bounds.getSouth(), -84);\n        var max_lat = Math.min(bounds.getNorth(), 84);\n        var min_row = Math.floor(min_lat / row_height);\n        const maxCols = 360 / column_width;\n        for (var row = min_row; row * row_height < max_lat; row++) {\n            var row_south = row * row_height;\n            var row_north = row_south + row_height;\n            var joined_quads;\n            if (row_south >= 76 || row_north <= -76) {\n                joined_quads = 4;\n            } else if (row_south >= 60 || row_north <= -60) {\n                joined_quads = 2;\n            } else {\n                joined_quads = 1;\n            }\n            var min_lon = bounds.getWest();\n            var max_lon = bounds.getEast();\n            var min_column = Math.floor((min_lon + 180) / column_width / joined_quads) * joined_quads -\n                Math.round(180 / column_width);\n            for (var column = min_column; column * column_width < max_lon; column += joined_quads) {\n                var column_west = column * column_width;\n                var column_east = column_west + column_width * joined_quads;\n                var quad_bounds = L.latLngBounds([[row_south, column_west], [row_north, column_east]]);\n                // shift column to positive numbers, calc modulo, shift back\n                const wrappedColumn = ((column + maxCols / 2) % maxCols + maxCols) % maxCols - maxCols / 2;\n                var names = name_factory(wrappedColumn, row, joined_quads);\n                quads.push({names: names, bounds: quad_bounds});\n            }\n        }\n        return quads;\n    },\n\n    getQuads1m: function(bounds) {\n        return this._getQuads(bounds, 4, 6, this.getQuadName1m);\n    },\n\n    getQuads500k: function(bounds) {\n        return this._getQuads(bounds, 2, 3, this.getQuadName500k.bind(this));\n    },\n\n    getQuads100k: function(bounds) {\n        return this._getQuads(bounds, 4 / 12, 6 / 12, this.getQuadName100k.bind(this));\n    },\n\n    getQuads050k: function(bounds) {\n        return this._getQuads(bounds, 4 / 12 / 2, 6 / 12 / 2, this.getQuadName050k.bind(this));\n    }\n\n};\n\nL.Layer.SovietTopoGrid = L.LayerGroup.extend({\n        options: {},\n\n        initialize: function(options) {\n            L.LayerGroup.prototype.initialize.call(this);\n            L.Util.setOptions(this, options);\n            this.renderer = L.svg({padding: 0.5});\n            this._quads = {};\n            this._updateRenderer = L.Util.throttle(this._updateRenderer, 100, this);\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            map.on('zoomend', this._reset, this);\n            map.on('move', this._update, this);\n            map.on('move', this._updateRenderer, this);\n            this._update();\n        },\n\n        onRemove: function(map) {\n            map.off('zoomend', this._reset, this);\n            map.off('move', this._update, this);\n            this._cleanupQuads(true);\n        },\n\n        _addQuad: function(bounds, id, titles, color, layer, scale) {\n            if (id in this._quads) {\n                return;\n            }\n            var rect_options = {\n                smoothFactor: 0,\n                noClip: true,\n                interactive: false,\n                fill: false,\n                opacity: {1: 0.7, 2: 0.4}[layer],\n                color: color,\n                weight: {1: 1, 2: 3}[layer],\n                renderer: this.renderer\n            };\n\n            var rect = L.rectangle(bounds, rect_options);\n            this.addLayer(rect);\n            if (layer === 1) {\n                rect.bringToBack();\n            }\n            var objects = [rect];\n            const title = titles[0].replace(/-/gu, ' &ndash; ');\n            var html = L.Util.template(`<span style=\"color:{color}\">{title}</span>`, {color: color, title: title});\n            var icon = L.divIcon({html: html, className: 'leaflet-sovietgrid-quadtitle-' + layer, iconSize: null});\n            var marker = L.marker(L.latLngBounds(bounds).getCenter(), {icon: icon});\n            this.addLayer(marker);\n            objects.push(marker);\n            this._quads[id] = objects;\n            marker.on('click contextmenu', this._showContextMenu.bind(this, scale, titles));\n        },\n\n        _showContextMenu: function(scale, titles, e) {\n            const scaleString = {\n                '1m': '1:1 000 000',\n                '500k': '1:500 000',\n                '100k': '1:100 000',\n                '050k': '1:50 000'\n            }[scale];\n            const items = [\n                {text: scaleString, header: true},\n                {text: 'Копировать в буфер обмена', header: true},\n                {\n                    text: titles[0],\n                    callback: () => {\n                        copyToClipboard(titles[0], e.originalEvent);\n                    }\n                }\n            ];\n            if (titles.length > 1) {\n                items.push({\n                        text: titles[1] + ' <span class=\"leaflet-sovietgrid-lang\">RUS</span>',\n                        callback: () => {\n                            copyToClipboard(titles[1], e.originalEvent);\n                        }\n                    }\n                );\n                items.push({\n                        text: titles[2] + ' <span class=\"leaflet-sovietgrid-lang\">LAT</span>',\n                        callback: () => {\n                            copyToClipboard(titles[2], e.originalEvent);\n                        }\n                    }\n                );\n            }\n            const menu = new Contextmenu(items);\n            menu.show(e);\n        },\n\n        _removeQuad: function(id) {\n            this._quads[id].forEach(this.removeLayer.bind(this));\n            delete this._quads[id];\n        },\n\n        _addQuads: function(quads, scale, color, layer) {\n            quads.forEach(function(quad) {\n                    var id = scale + quad.names[0];\n                    this._addQuad(quad.bounds, id, quad.names, color, layer, scale);\n                }.bind(this)\n            );\n        },\n\n        _addGrid: function() {\n            var quads;\n            var layer;\n            var map_bbox = this._map.getBounds();\n            var zoom = this._map.getZoom();\n\n            if (zoom >= 10) {\n                quads = Nomenclature.getQuads050k(map_bbox);\n                layer = (zoom >= 12) ? 2 : 1;\n                this._addQuads(quads, '050k', '#50d', layer);\n            }\n\n            if (zoom >= 8 && zoom < 12) {\n                quads = Nomenclature.getQuads100k(map_bbox);\n                layer = (zoom >= 10) ? 2 : 1;\n                this._addQuads(quads, '100k', '#d50', layer);\n            }\n\n            if (zoom >= 6 && zoom < 10) {\n                quads = Nomenclature.getQuads500k(map_bbox);\n                layer = (zoom >= 8) ? 2 : 1;\n                this._addQuads(quads, '500k', '#099', layer);\n            }\n\n            if (zoom >= 4 && zoom < 8) {\n                layer = (zoom >= 6) ? 2 : 1;\n                quads = Nomenclature.getQuads1m(map_bbox);\n                this._addQuads(quads, '1m', 'blue', layer);\n            }\n        },\n\n        _reset: function() {\n            this._update(true);\n        },\n\n        _cleanupQuads: function(reset) {\n            if (reset === true) {\n                this.clearLayers();\n                this._quads = {};\n            } else {\n                var map_bbox = this._map.getBounds();\n                for (var quad_id of Object.keys(this._quads)) {\n                    var rect = this._quads[quad_id][0];\n                    if (!map_bbox.intersects(rect.getBounds())) {\n                        this._removeQuad(quad_id);\n                    }\n                }\n            }\n        },\n\n        _updateRenderer: function() {\n            if (this.renderer._map) {\n                this.renderer._update();\n            }\n        },\n\n        _update: function(reset) {\n            this._cleanupQuads(reset);\n            this._addGrid();\n        }\n    }\n);\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport {WikimapiaLoader} from './wikimapia-loader';\nimport './style.css';\nimport {openPopupWindow} from '~/lib/popup-window';\n\nfunction isPointInPolygon(polygon, p) {\n    var inside = false;\n    var prevNode = polygon[polygon.length - 1],\n        node, i;\n    for (i = 0; i < polygon.length; i++) {\n        node = polygon[i];\n        if (\n            ((node[0] <= p[0] && p[0] < prevNode[0]) || (prevNode[0] <= p[0] && p[0] < node[0])) &&\n            p[1] < (prevNode[1] - node[1]) * (p[0] - node[0]) / (prevNode[0] - node[0]) + node[1]\n        ) {\n            inside = !inside;\n        }\n        prevNode = node;\n    }\n    return inside;\n}\n\nL.Wikimapia = L.GridLayer.extend({\n        options: {\n            tileSize: 1024,\n            updateWhenIdle: true\n        },\n\n        initialize: function(options) {\n            L.GridLayer.prototype.initialize.call(this, options);\n            this.loader = null;\n        },\n\n        onAdd: function(map) {\n            if (!this.loader) {\n                this.loader = new WikimapiaLoader(map);\n            }\n            L.GridLayer.prototype.onAdd.call(this, map);\n            this.on('tileunload', this.onTileUnload, this);\n            map.on('mousemove', this.onMouseMove, this);\n            map.on('click', this.onClick, this);\n        },\n\n        onRemove: function(map) {\n            map.off('mousemove', this.onMouseMove, this);\n            map.off('click', this.onClick, this);\n            if (this.highlightedPlace) {\n                this._map.removeLayer(this.highlightedPlace.polygon);\n                this._map.removeLayer(this.highlightedPlace.label);\n                this.highlightedPlace = null;\n            }\n            L.TileLayer.prototype.onRemove.call(this, map);\n            this.off('tileunload', this.onTileUnload, this);\n        },\n\n        drawTile: function(canvas) {\n            if (!this._map) {\n                return;\n            }\n            const\n                tileData = canvas._tileData,\n                adjustment = canvas._adjustment;\n            if (!tileData) {\n                return;\n            }\n\n            const canvasCtx = canvas.getContext('2d');\n            canvasCtx.beginPath();\n            canvasCtx.strokeStyle = '#CFA600';\n            canvasCtx.lineWidth = 1;\n            for (let place of tileData.places) {\n                let polygon = place.localPolygon;\n                if (!polygon) {\n                    continue;\n                }\n                if (adjustment) {\n                    let {multiplier, offsetX, offsetY} = adjustment,\n                        polygon2 = [];\n                    for (let i = 0; i < polygon.length; i++) {\n                        let p = polygon[i];\n                        polygon2.push({\n                                x: p.x * multiplier - offsetX,\n                                y: p.y * multiplier - offsetY\n                            }\n                        );\n                    }\n                    polygon = polygon2;\n                }\n                canvasCtx.moveTo(polygon[0].x, polygon[0].y);\n                let p;\n                for (let i = 1; i < polygon.length; i++) {\n                    p = polygon[i];\n                    canvasCtx.lineTo(p.x, p.y);\n                }\n                canvasCtx.lineTo(polygon[0].x, polygon[0].y);\n            }\n            canvasCtx.stroke();\n        },\n\n        createTile: function(coords, done) {\n            const canvas = L.DomUtil.create('canvas', 'leaflet-tile');\n            canvas.width = this.options.tileSize;\n            canvas.height = this.options.tileSize;\n            let {dataPromise, abortLoading} = this.loader.requestTileData(coords);\n            dataPromise.then((data) => {\n                if (!data.error) {\n                    canvas._tileData = data.tileData;\n                    canvas._adjustment = data.adjustment;\n                    this.drawTile(canvas);\n                    this._tileOnLoad(done, canvas);\n                }\n            });\n\n            canvas._abortLoading = abortLoading;\n            return canvas;\n        },\n\n        _tileOnLoad: function(done, tile) {\n            // For https://github.com/Leaflet/Leaflet/issues/3332\n            if (L.Browser.ielt9) {\n                setTimeout(L.bind(done, this, null, tile), 0);\n            } else {\n                done(null, tile);\n            }\n        },\n\n        onTileUnload: function(e) {\n            const tile = e.tile;\n            tile._abortLoading();\n            delete tile._tileData;\n            delete tile._adjustment;\n        },\n\n        _tileCoordsFromEvent: function(e) {\n            const layerPoint = this._map.getPixelOrigin().add(e.layerPoint);\n            const tileSize = this.options.tileSize;\n            let coords = {\n                x: Math.floor(layerPoint.x / tileSize),\n                y: Math.floor(layerPoint.y / tileSize),\n                z: this._map.getZoom()\n            };\n\n            return coords;\n        },\n\n        getPlaceAtMousePos: function(e) {\n            const tileCoords = this._tileCoordsFromEvent(e);\n            let tile = this._tiles[this._tileCoordsToKey(tileCoords)];\n            if (!tile) {\n                return null;\n            }\n            const tileData = tile.el._tileData;\n            if (!tileData) {\n                return null;\n            }\n            return this.getPlaceAtLatlng(e.latlng.wrap(), tileData.places);\n        },\n\n        onMouseMove: function(e) {\n            const place = this.getPlaceAtMousePos(e);\n            if (this.highlightedPlace && (!place || this.highlightedPlace.id !== place.id)) {\n                this._map.removeLayer(this.highlightedPlace.polygon);\n                this._map.removeLayer(this.highlightedPlace.label);\n                this.highlightedPlace = null;\n            }\n\n            if (place && !this.highlightedPlace) {\n                this.highlightedPlace = {\n                    id: place.id,\n                    polygon: L.polygon(place.polygon, {\n                            weight: 0,\n                            color: '#E6B800'\n                        }\n                    ),\n                    label: L.tooltip({className: 'wikimapia-tooltip-wrapper'}, null)\n                };\n                this.highlightedPlace.label.setLatLng(e.latlng);\n                this.highlightedPlace.polygon.addTo(this._map).bringToBack();\n                this.highlightedPlace.label.setContent(`<div class=\"wikimapia-tooltip\">${place.title}</div>`);\n                this._map.addLayer(this.highlightedPlace.label);\n            }\n            if (this.highlightedPlace) {\n                this.highlightedPlace.label.setLatLng(e.latlng);\n            }\n        },\n\n        onClick: function(e) {\n            if (this._map.clickLocked) {\n                return;\n            }\n            const place = this.getPlaceAtMousePos(e);\n            if (place) {\n                const url = `http://wikimapia.org/${place.id}/ru/`;\n                openPopupWindow(url, 564, 'wikimapia-details');\n            }\n        },\n\n        getPlaceAtLatlng: function(latlng, places) {\n            let {lat, lng} = latlng,\n                bounds, place;\n            for (let i = places.length - 1; i >= 0; i--) {\n                place = places[i];\n                bounds = place.boundsWESN;\n                if (lng >= bounds[0] && lng <= bounds[1] && lat >= bounds[2] && lat <= bounds[3] &&\n                    isPointInPolygon(place.polygon, [lat, lng])) {\n                    return place;\n                }\n            }\n            return null;\n        }\n\n    }\n);\n","import {TiledDataLoader} from '~/lib/tiled-data-loader';\nimport * as wmUtils from './wm-utils';\nimport urlViaCorsProxy from '~/lib/CORSProxy';\n\nclass WikimapiaLoader extends TiledDataLoader {\n    maxZoom = 15;\n    minZoom = 1;\n    tileSize = 1024;\n\n    constructor(projectObj) {\n        super();\n        this._projectObj = projectObj;\n    }\n\n    getFromCache(dataTileCoords) {\n        dataTileCoords = {...dataTileCoords};\n        let exactMatch = true;\n        while (dataTileCoords.z >= 0) {\n            let key = this.makeTileKey(dataTileCoords);\n            let res = this._cache.get(key);\n            if (res.found) {\n                if (exactMatch || !res.value.hasChildren) {\n                    res['coords'] = dataTileCoords;\n                    return res;\n                }\n                break;\n            }\n            dataTileCoords.z -= 1;\n            dataTileCoords.x = Math.floor(dataTileCoords.x / 2);\n            dataTileCoords.y = Math.floor(dataTileCoords.y / 2);\n            exactMatch = false;\n        }\n        return {found: false};\n    }\n\n    layerTileToDataTileCoords(layerTileCoords) {\n        let z = layerTileCoords.z - 2;\n        if (z > this.maxZoom) {\n            let z2 = this.maxZoom,\n                multiplier = 1 << (z - z2);\n            return {\n                x: Math.floor(layerTileCoords.x / multiplier),\n                y: Math.floor(layerTileCoords.y / multiplier),\n                z: z2\n            };\n        } else if (z < this.minZoom) {\n            let z2 = this.minZoom,\n                multiplier = 1 / (1 << (z2 - z));\n            return {\n                x: Math.floor(layerTileCoords.x / multiplier),\n                y: Math.floor(layerTileCoords.y / multiplier),\n                z: z2\n            };\n        }\n        return {z, x: layerTileCoords.x, y: layerTileCoords.y};\n    }\n\n    makeRequestData(dataTileCoords) {\n        let url = wmUtils.makeTileUrl(dataTileCoords);\n        url = urlViaCorsProxy(url);\n        return {\n            url,\n            options: {timeout: 20000}\n        };\n    }\n\n    processResponse(xhr) {\n        return wmUtils.parseTile(xhr.response, this._projectObj)\n            .then((tileData) => ({\n                        tileData,\n                        coords: tileData.coords\n            }));\n    }\n\n    calcAdjustment(layerTileCoords, dataTileCoords) {\n        const adjustment = super.calcAdjustment(\n            {x: layerTileCoords.x, y: layerTileCoords.y, z: layerTileCoords.z - 2},\n            dataTileCoords\n        );\n        if (adjustment) {\n            adjustment.offsetX *= 1024;\n            adjustment.offsetY *= 1024;\n        }\n        return adjustment;\n    }\n}\n\nexport {WikimapiaLoader};\n","import L from 'leaflet';\n\n// (1233,130,5) -> \"032203\"\nfunction getTileId({x, y, z}) {\n    let id = [];\n    y = (1 << z) - y - 1;\n    z += 1;\n    while (z) {\n        id.push((x & 1) + (y & 1) * 2);\n        x >>= 1;\n        y >>= 1;\n        z -= 1;\n    }\n    return id.reverse().join('');\n}\n\nfunction makeTileUrl(coords) {\n    const\n        tileId = getTileId(coords),\n        urlPath = tileId.replace(/(\\d{3})(?!$)/gu, '$1/'); // \"033331022\" -> \"033/331/022\"\n    return `http://wikimapia.org/z1/itiles/${urlPath}.xy?342342`;\n}\n\nfunction tileIdToCoords(tileId) {\n    const z = tileId.length - 1;\n    let x = 0,\n        y = 0;\n    for (let i = 0; i < tileId.length; i++) {\n        let c = parseInt(tileId[i], 10);\n        x <<= 1;\n        y <<= 1;\n        x += c & 1;\n        y += c >> 1;\n    }\n    y = (1 << z) - y - 1;\n    return {x, y, z};\n}\n\nfunction getWikimapiaTileCoords(coords, viewTileSize) {\n    let z = coords.z - 2;\n    if (z < 0) {\n        z = 0;\n    }\n    if (z > 15) {\n        z = 15;\n    }\n    const q = 2 ** (z - coords.z + Math.log2(viewTileSize / 256));\n    let x = Math.floor(coords.x * q),\n        y = Math.floor(coords.y * q);\n    return {x, y, z};\n}\n\nfunction decodeTitles(s) {\n    const titles = {};\n    for (let title of s.split('\\x1f')) {\n        if (title.length > 2) {\n            let langCode = title.charCodeAt(0) - 32;\n            titles[langCode.toString()] = title.substring(1);\n        }\n    }\n    return titles;\n}\n\nfunction chooseTitle(titles) {\n    var popularLanguages = ['1', '0', '3', '2', '5', '4', '9', '28', '17', '27'];\n    for (let langCode of popularLanguages) {\n        if (langCode in titles) {\n            return titles[langCode];\n        }\n    }\n    for (let langCode of Object.keys(titles)) {\n        return titles[langCode];\n    }\n    return \"\";\n}\n\nfunction decodePolygon(s) {\n    var i = 0,\n        coords = [],\n        lat = 0,\n        lng = 0;\n    while (i < s.length) {\n        var p,\n            l = 0,\n            c = 0;\n        do {\n            p = s.charCodeAt(i++) - 63; // eslint-disable-line no-plusplus\n            c |= (p & 31) << l;\n            l += 5;\n        } while (p >= 32);\n        lng += c & 1 ? ~(c >> 1) : c >> 1;\n        l = 0;\n        c = 0;\n        do {\n            p = s.charCodeAt(i++) - 63; // eslint-disable-line no-plusplus\n            c |= (p & 31) << l;\n            l += 5;\n        } while (p >= 32);\n        lat += c & 1 ? ~(c >> 1) : c >> 1;\n        coords.push([lat / 1e6, lng / 1e6]);\n    }\n    return coords;\n}\n\nfunction makeCoordsLocal(line, tileCoords, projectObj) {\n    const {x: tileX, y: tileY, z: tileZ} = tileCoords,\n        x0 = tileX * 1024,\n        y0 = tileY * 1024,\n        localCoords = [];\n    let latlon, p;\n    for (let i = 0; i < line.length; i++) {\n        latlon = line[i];\n        p = projectObj.project(latlon, tileZ + 2);\n        p.x -= x0;\n        p.y -= y0;\n        localCoords.push(p);\n    }\n    return localCoords;\n}\n\nfunction asap() {\n    return new Promise((resolve) => setTimeout(resolve, 0));\n}\n\nfunction simplifyPolygon(latlngs, tileCoords, tileHasChildren, projectObj) {\n    const\n        x = tileCoords.x * 1024,\n        y = tileCoords.y * 1024,\n        p0 = projectObj.unproject([x, y], tileCoords.z + 2),\n        p1 = projectObj.unproject([x + 1, y + 1], tileCoords.z + 2);\n    let pixelDegSize = p0.lat - p1.lat;\n    if (!tileHasChildren && tileCoords.z < 15) {\n        pixelDegSize /= (1 << (15 - tileCoords.z));\n    }\n    let points = [];\n    for (let i = 0; i < latlngs.length; i++) {\n        let ll = latlngs[i];\n        points.push({x: ll[0], y: ll[1]});\n    }\n    points = L.LineUtil.simplify(points, pixelDegSize * 2);\n    latlngs = [];\n    for (let i = 0; i < points.length; i++) {\n        let p = points[i];\n        latlngs.push([p.x, p.y]);\n    }\n    return latlngs;\n}\n\nasync function parseTile(s, projectObj) {\n    const tile = {};\n    const places = tile.places = [];\n    const lines = s.split('\\n');\n    if (lines.length < 1) {\n        throw new Error('No data in tile');\n    }\n    const fields = lines[0].split('|');\n    const tileId = fields[0];\n    if (!tileId || !tileId.match(/^[0-3]+$/u)) {\n        throw new Error('Invalid tile header');\n    }\n    tile.tileId = tileId;\n    tile.coords = tileIdToCoords(tileId);\n    tile.hasChildren = fields[1] === '1';\n\n    // FIXME: ignore some errors\n    let prevTime = Date.now();\n    for (let line of lines.slice(2)) {\n        let curTime = Date.now();\n        if (curTime - prevTime > 20) {\n            await asap();\n            prevTime = Date.now();\n        }\n        const place = {};\n        const fields = line.split('|');\n        if (fields.length < 6) {\n            continue;\n        }\n        let placeId = fields[0];\n        if (!placeId.match(/^\\d+$/u)) {\n            // throw new Error('Invalid place id');\n            continue;\n        }\n        place.id = parseInt(placeId, 10);\n        place.title = chooseTitle(decodeTitles(fields[5]));\n        if (fields[6] !== '1') {\n            throw new Error(`Unknown wikimapia polygon encoding type: \"${fields[6]}\"`);\n        }\n\n        let bounds = fields[2].match(/^([-\\d]+),([-\\d]+),([-\\d]+),([-\\d]+)$/u);\n        if (!bounds) {\n            throw new Error('Invalid place bounds');\n        }\n        place.boundsWESN = bounds.slice(1).map((x) => parseInt(x, 10) / 1e7);\n\n        let coords = fields.slice(7).join('|');\n\n        coords = decodePolygon(coords);\n        if (coords.length < 3) {\n            throw new Error(`Polygon has ${coords.length} points`);\n        }\n        let polygon = simplifyPolygon(coords, tile.coords, tile.hasChildren, projectObj);\n        place.polygon = polygon;\n        place.localPolygon = makeCoordsLocal(polygon, tile.coords, projectObj);\n        places.push(place);\n    }\n    return tile;\n}\n\n// быстрое проектирование полигонов\n// TODO: каждые 50-100 мс отдавать управление\n// projectPlacesForZoom: function(tile, viewZoom) {\n//     if (viewZoom < tile.coords.z) {\n//         throw new Error('viewZoom < tile.zoom');\n//     }\n//     if (tile.places && tile.places[0] && tile.places[0].projectedPolygons &&\n//         tile.places[0].projectedPolygons[viewZoom]) {\n//         return;\n//     }\n//     const virtualTileSize = 256 * (2 ** (viewZoom - tile.coords.z));\n//     const p1 = L.point([tile.coords.x * virtualTileSize, tile.coords.y * virtualTileSize]),\n//         p2 = L.point([(tile.coords.x + 1) * virtualTileSize, (tile.coords.y + 1) * virtualTileSize]),\n//         latlng1 = this._map.unproject(p1, viewZoom),\n//         latlng2 = this._map.unproject(p2, viewZoom),\n//         lat0 = latlng1.lat,\n//         lng0 = latlng1.lng;\n//     const qx = (p2.x - p1.x) / (latlng2.lng - latlng1.lng),\n//         qy = (p2.y - p1.y) / (latlng2.lat - latlng1.lat);\n//\n//     const offsets = [],\n//         offsetsStep = virtualTileSize / 64;\n//     const y0 = p1.y;\n//     for (let y = -virtualTileSize; y <= 2 * virtualTileSize; y += offsetsStep) {\n//         let lat = y / qy + lat0;\n//         let offset = this._map.project([lat, lng0], viewZoom).y - y0 - y;\n//         offsets.push(offset);\n//     }\n//\n//     let ll, offset, offsetPos, offsetIndex, offsetIndexDelta, x, y;\n//     const x0 = p1.x;\n//     for (let place of tile.places) {\n//         let polygon = place.polygon;\n//         if (polygon.length < 3) {\n//             continue;\n//         }\n//         let projectedPolygon = [];\n//         for (let i = 0; i < polygon.length; i++) {\n//             ll = polygon[i];\n//             x = (ll[1] - lng0) * qx;\n//             y = (ll[0] - lat0) * qy;\n//             offsetPos = (y + virtualTileSize) / offsetsStep;\n//             offsetIndex = Math.floor(offsetPos);\n//             offsetIndexDelta = offsetPos - offsetIndex;\n//             offset = offsets[offsetIndex] * (1 - offsetIndexDelta) + offsets[offsetIndex + 1] * offsetIndexDelta;\n//             projectedPolygon.push([x + x0, y + offset + y0]);\n//         }\n//         projectedPolygon = projectedPolygon.map(L.point);\n//         projectedPolygon = L.LineUtil.simplify(projectedPolygon, 1.5);\n//         if (!place.projectedPolygons) {\n//             place.projectedPolygons = [];\n//         }\n//         place.projectedPolygons[viewZoom] = projectedPolygon;\n//     }\n// },\n\nexport {getTileId, getWikimapiaTileCoords, parseTile, makeTileUrl};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport '~/lib/leaflet.control.commons';\n\nconst originalLayerOnAdd = L.Control.Layers.prototype.onAdd;\n\nL.Control.Layers.include({\n    onAdd: function(map) {\n        const container = originalLayerOnAdd.call(this, map);\n        this._stopContainerEvents();\n        return container;\n    }\n});\n\nconst originalZoomOnAdd = L.Control.Zoom.prototype.onAdd;\n\nL.Control.Zoom.include({\n    onAdd: function(map) {\n        const container = originalZoomOnAdd.call(this, map);\n        this._container = container;\n        this._stopContainerEvents();\n        return container;\n    }\n});\n","import L from 'leaflet';\nimport ko from 'knockout';\nimport './style.css';\nimport '~/lib/leaflet.control.commons';\nimport {RectangleSelect} from './selector';\nimport Contextmenu from '~/lib/contextmenu';\nimport {makeJnxFromLayer, minZoom} from './jnx-maker';\nimport {saveAs} from '~/vendored/github.com/eligrey/FileSaver';\nimport {notify} from '~/lib/notifications';\nimport * as logging from '~/lib/logging';\n\nL.Control.JNX = L.Control.extend({\n        includes: L.Evented,\n\n        initialize: function(layersControl, options) {\n            L.Control.prototype.initialize.call(this, options);\n            this._layersControl = layersControl;\n            this.makingJnx = ko.observable(false);\n            this.downloadProgressRange = ko.observable(1);\n            this.downloadProgressDone = ko.observable(0);\n            this.contextMenu = new Contextmenu(() => this.makeMenuItems());\n        },\n\n        getLayerForJnx: function() {\n            let selectedLayer = {};\n            for (let layerRec of this._layersControl._layers) {\n                let layer = layerRec.layer;\n                if (this._map.hasLayer(layer) && layer.options && layer.options.jnx) {\n                    selectedLayer = {\n                        layer,\n                        layerName: layerRec.name\n                    };\n                }\n            }\n            return selectedLayer;\n        },\n\n        estimateTilesCount: function(maxZoom) {\n            let tilesCount = 0;\n            const bounds = this._selector.getBounds();\n            for (let zoom = minZoom(maxZoom); zoom <= maxZoom; zoom++) {\n                const topLeftTile = this._map.project(bounds.getNorthWest(), zoom).divideBy(256).floor();\n                const bottomRightTile = this._map.project(bounds.getSouthEast(), zoom).divideBy(256).ceil();\n                tilesCount += Math.ceil((bottomRightTile.x - topLeftTile.x) * (bottomRightTile.y - topLeftTile.y));\n            }\n            return tilesCount;\n        },\n\n        makeMenuItems: function() {\n            const {layer, layerName} = this.getLayerForJnx();\n            if (!layer) {\n                return [{text: 'No supported layers'}];\n            }\n            const maxLevel = layer.options.maxNativeZoom || layer.options.maxZoom || 18;\n            const minLevel = Math.max(0, maxLevel - 6);\n\n            const equatorLength = 40075016;\n            const lat = this._selector.getBounds().getCenter().lat;\n            let metersPerPixel = equatorLength / 2 ** maxLevel / 256 * Math.cos(lat / 180 * Math.PI);\n\n            const items = [{text: layerName, header: true}];\n            for (let zoom = maxLevel; zoom >= minLevel; zoom -= 1) {\n                let tilesCount = this.estimateTilesCount(zoom);\n                let fileSizeMb = tilesCount * 0.02;\n                let itemClass = tilesCount > 50000 ? 'jnx-menu-warning' : '';\n                let resolutionString = metersPerPixel.toFixed(2);\n                let sizeString = fileSizeMb.toFixed(fileSizeMb > 1 ? 0 : 1);\n                let item = {\n                    text: `<span class=\"${itemClass}\">Zoom ${zoom} (${resolutionString} m/pixel) &mdash; ${tilesCount} tiles (~${sizeString} Mb)</span>`, // eslint-disable-line max-len\n                    callback: () => this.makeJnx(layer, layerName, zoom),\n                    disabled: this.makingJnx()\n                };\n                items.push(item);\n                metersPerPixel *= 2;\n            }\n            return items;\n        },\n\n        notifyProgress: function(value, maxValue) {\n            this.downloadProgressDone(this.downloadProgressDone() + value);\n            this.downloadProgressRange(maxValue);\n        },\n\n        makeJnx: function(layer, layerName, zoom) {\n            logging.captureBreadcrumb('start making jnx');\n            this.makingJnx(true);\n            this.downloadProgressDone(0);\n\n            const bounds = this._selector.getBounds();\n            const sanitizedLayerName = layerName.toLowerCase().replace(/[ ()]+/u, '_');\n            const fileName = `nakarte.me_${sanitizedLayerName}_z${zoom}.jnx`;\n            const eventId = logging.randId();\n            this.fire('tileExportStart', {\n                eventId,\n                layer,\n                zoom,\n                bounds,\n            });\n            makeJnxFromLayer(layer, layerName, zoom, bounds, this.notifyProgress.bind(this))\n                .then((fileData) => {\n                    saveAs(fileData, fileName, true);\n                    this.fire('tileExportEnd', {eventId, success: true});\n                })\n                .catch((e) => {\n                    logging.captureException(e, 'Failed to create JNX');\n                    this.fire('tileExportEnd', {\n                        eventId,\n                        success: false,\n                        error: e\n                    });\n                    notify(`Failed to create JNX: ${e.message}`);\n                })\n                .then(() => this.makingJnx(false));\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            const container = this._container = L.DomUtil.create('div', 'leaflet-control leaflet-control-jnx');\n            container.innerHTML = `\n                <a class=\"button\" data-bind=\"visible: !makingJnx(), click: onButtonClicked\"\n                 title=\"Make JNX for Garmin receivers\">JNX</a>\n                <div data-bind=\"\n                    component:{\n                        name: 'progress-indicator',\n                        params: {progressRange: downloadProgressRange, progressDone: downloadProgressDone}\n                    },\n                    visible: makingJnx()\"></div>`;\n            ko.applyBindings(this, container);\n            this._stopContainerEvents();\n            return container;\n        },\n\n        removeSelector: function() {\n            if (this._selector) {\n                this._map.removeLayer(this._selector);\n                this._selector = null;\n                this.fire('selectionchange');\n            }\n        },\n\n        addSelector: function(bounds) {\n            if (!bounds) {\n                bounds = this._map.getBounds().pad(-0.25);\n            }\n            this._selector = new RectangleSelect(bounds)\n                .addTo(this._map)\n                .on('change', () => this.fire('selectionchange'))\n                .on('click contextmenu', (e) => {\n                    L.DomEvent.stop(e);\n                    this.contextMenu.show(e);\n                });\n            this.fire('selectionchange');\n        },\n\n        onButtonClicked: function() {\n            if (this._selector) {\n                if (this._selector.getBounds().intersects(this._map.getBounds().pad(-0.05))) {\n                    this.removeSelector();\n                } else {\n                    this.removeSelector();\n                    this.addSelector();\n                }\n            } else {\n                this.addSelector();\n            }\n        },\n    }\n);\n\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\n\nconst RectangleSelect = L.Rectangle.extend({\n        includes: L.Evented,\n\n        options: {\n            opacity: 1,\n            weight: 0.5,\n            fillOpacity: 0.2,\n            color: '#3388ff',\n            fillColor: '#3388ff',\n\n        },\n\n        onAdd: function(map) {\n            L.Rectangle.prototype.onAdd.call(this, map);\n            this.markers = [];\n            for (let position of ['top', 'right', 'bottom', 'left']) {\n                let marker = L.marker([0, 0], {\n                        icon: L.divIcon({className: `leaflet-rectangle-select-edge edge-${position}`}),\n                        draggable: true\n                    }\n                )\n                    .addTo(map);\n                marker.on({\n                        drag: this.onMarkerDrag,\n                        dragend: this.onMarkerDragEnd\n                    }, this\n                );\n                this.markers[position] = marker;\n            }\n            this.placeMarkers();\n            map.on('zoomend', this.placeMarkers, this);\n        },\n\n        placeMarkers: function() {\n            const bounds = this.getBounds();\n            const topLeftPixel = this._map.project(bounds.getNorthWest());\n            const bottomRightPixel = this._map.project(bounds.getSouthEast());\n            const size = bottomRightPixel.subtract(topLeftPixel);\n            let center = topLeftPixel.add(size.divideBy(2));\n            center = this._map.unproject(center);\n            this.markers['top'].setLatLng([bounds.getNorth(), center.lng]);\n            this.markers['top']._icon.style.width = `${size.x}px`;\n            this.markers['top']._icon.style.marginLeft = `-${size.x / 2}px`;\n            this.markers['right'].setLatLng([center.lat, bounds.getEast()]);\n            this.markers['right']._icon.style.height = `${size.y}px`;\n            this.markers['right']._icon.style.marginTop = `-${size.y / 2}px`;\n            this.markers['bottom'].setLatLng([bounds.getSouth(), center.lng]);\n            this.markers['bottom']._icon.style.width = `${size.x}px`;\n            this.markers['bottom']._icon.style.marginLeft = `-${size.x / 2}px`;\n            this.markers['left'].setLatLng([center.lat, bounds.getWest()]);\n            this.markers['left']._icon.style.height = `${size.y}px`;\n            this.markers['left']._icon.style.marginTop = `-${size.y / 2}px`;\n        },\n\n        onRemove: function(map) {\n            for (let marker of Object.values(this.markers)) {\n                this._map.removeLayer(marker);\n            }\n            this.markers = null;\n            map.off('zoomend', this.placeMarkers, this);\n            L.Rectangle.prototype.onRemove.call(this, map);\n        },\n\n        setBoundsFromMarkers: function() {\n            this.setBounds(\n                [\n                    [this.markers['top'].getLatLng().lat, this.markers['left'].getLatLng().lng],\n                    [this.markers['bottom'].getLatLng().lat, this.markers['right'].getLatLng().lng]\n                ]\n            );\n        },\n        onMarkerDrag: function() {\n            this.setBoundsFromMarkers();\n        },\n\n        onMarkerDragEnd: function() {\n            this.setBoundsFromMarkers();\n            this.placeMarkers();\n            this.fire('change');\n        }\n    }\n);\n\nexport {RectangleSelect};\n","import L from 'leaflet';\nimport {JnxWriter} from './jnx-encoder';\nimport {getTempMap, disposeMap} from '~/lib/leaflet.layer.rasterize';\nimport {XHRQueue} from '~/lib/xhr-promise';\nimport {arrayBufferToString, stringToArrayBuffer} from '~/lib/binary-strings';\n\nconst defaultXHROptions = {\n    responseType: 'arraybuffer',\n    timeout: 20000,\n    isResponseSuccess: (xhr) => xhr.status === 200 || xhr.status === 404\n};\n\nfunction minZoom(maxZoom) {\n    return Math.max(maxZoom - 4, 0);\n}\n\nfunction imageFromarrayBuffer(arr) {\n    const dataUrl = 'data:image/png;base64,' + btoa(arrayBufferToString(arr));\n    const image = new Image();\n    return new Promise(function(resolve, reject) {\n            image.onload = () => resolve(image);\n            image.onerror = () => reject(new Error('Tile image corrupt'));\n            image.src = dataUrl;\n        }\n    );\n}\n\nasync function convertToJpeg(image) {\n    try {\n        image = await imageFromarrayBuffer(image);\n    } catch (e) {\n        return null;\n    }\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = image.width;\n    canvas.height = image.height;\n    const ctx = canvas.getContext(\"2d\");\n    ctx.drawImage(image, 0, 0);\n    const dataURL = canvas.toDataURL(\"image/jpeg\");\n    const s = atob(dataURL.replace(/^data:image\\/jpeg;base64,/u, \"\"));\n    return stringToArrayBuffer(s);\n}\n\nfunction ensureImageJpg(image) {\n    if (!image) {\n        return null;\n    }\n    if (arrayBufferToString(image.slice(0, 4)) === '\\x89PNG' &&\n        arrayBufferToString(image.slice(-8)) === 'IEND\\xae\\x42\\x60\\x82') {\n        return convertToJpeg(image);\n    } else if (arrayBufferToString(image.slice(0, 2)) === '\\xff\\xd8' &&\n        arrayBufferToString(image.slice(-2)) === '\\xff\\xd9') {\n        return Promise.resolve(image);\n    }\n    return null;\n}\n\nasync function makeJnxFromLayer(srcLayer, layerName, maxZoomLevel, latLngBounds, progress) {\n    const jnxProductId = L.stamp(srcLayer);\n    const jnxZOrder = Math.min(jnxProductId, 100);\n    const writer = new JnxWriter(layerName, jnxProductId, jnxZOrder);\n    const xhrQueue = new XHRQueue();\n    let doStop = false;\n    let error;\n    const minZoomLevel = minZoom(maxZoomLevel);\n    let progressWeight = 1;\n    for (let zoom = maxZoomLevel; zoom >= minZoomLevel; zoom--) {\n        let pixelBounds = L.bounds(\n            L.CRS.EPSG3857.latLngToPoint(latLngBounds.getNorthWest(), zoom).round(),\n            L.CRS.EPSG3857.latLngToPoint(latLngBounds.getSouthEast(), zoom).round()\n        );\n\n        let promises = [];\n        let layer = srcLayer.cloneForPrint({xhrQueue});\n        let tempMap = getTempMap(zoom, layer._rasterizeNeedsFullSizeMap, pixelBounds);\n        tempMap.addLayer(layer);\n        let {iterateTilePromises, count: tilesCount} = await layer.getTilesInfo({\n                xhrOptions: defaultXHROptions,\n                pixelBounds,\n                rawData: true\n            }\n        );\n        for (let tilePromiseRec of iterateTilePromises()) {\n            promises.push(tilePromiseRec);\n        }\n        for (let {tilePromise} of promises) {\n            let imageRec;\n            try {\n                imageRec = await tilePromise;\n            } catch (e) {\n                error = e;\n                doStop = true;\n                break;\n            }\n            let xhr = imageRec.image;\n\n            if (xhr === null || xhr.status !== 200 || !xhr.response || !xhr.response.byteLength) {\n                continue;\n            }\n            let image = await ensureImageJpg(xhr.response);\n            if (!image) {\n                error = new Error('Tile image invalid');\n                doStop = true;\n                break;\n            }\n            writer.addTile(image, zoom, imageRec.latLngBounds);\n            progress(progressWeight / tilesCount, 4 / 3);\n        }\n        disposeMap(tempMap);\n        if (doStop) {\n            promises.forEach((promiseRec) => promiseRec.abortLoading());\n            throw error;\n        }\n        progressWeight /= 4;\n    }\n\n    return writer.getJnx();\n}\n\nexport {makeJnxFromLayer, minZoom};\n","import L from 'leaflet';\nimport {BinStream} from './binary-stream';\n\nfunction jnxCoordinates(extents) {\n    function toJnx(x) {\n        return Math.round(x / 180.0 * 0x7fffffff);\n    }\n\n    return [toJnx(extents.north), toJnx(extents.east), toJnx(extents.south), toJnx(extents.west)];\n}\n\nconst JnxWriter = L.Class.extend({\n        initialize: function(productName, productId, zOrder) {\n            this.tiles = {};\n            this.productName = productName || 'Raster map';\n            this.productId = productId || 0;\n            this.zOrder = zOrder;\n        },\n\n        addTile: function(tileData, level, latLngBounds) {\n            this.tiles[level] = this.tiles[level] || [];\n            tileData = new Blob([tileData]).slice(2);\n            const extents = {\n                west: latLngBounds.getWest(),\n                north: latLngBounds.getNorth(),\n                south: latLngBounds.getSouth(),\n                east: latLngBounds.getEast(),\n\n            };\n            this.tiles[level].push({data: tileData, extents: extents});\n        },\n\n        getJnx: function() {\n            const HEADER_SIZE = 52,\n                LEVEL_INFO_SIZE = 17,\n                TILE_INFO_SIZE = 28;\n\n            let totalTilesCount = 0;\n            for (let levelTiles of Object.values(this.tiles)) {\n                totalTilesCount += levelTiles.length;\n            }\n            if (totalTilesCount === 0) {\n                throw new Error('No tiles collected, JNX is empty');\n            }\n            if (totalTilesCount > 50000) {\n                throw new Error('Too many tiles found (more then 50000)');\n            }\n\n            let west = 1e10,\n                east = -1e10,\n                north = -1e10,\n                south = 1e10,\n                levels_n = Object.keys(this.tiles).length,\n                level, tiles, extents,\n                i, tile;\n            for (let levelTiles of Object.values(this.tiles)) {\n                for (let tile of levelTiles) {\n                    west = (west < tile.extents.west) ? west : tile.extents.west;\n                    east = (east > tile.extents.east) ? east : tile.extents.east;\n                    north = (north > tile.extents.north) ? north : tile.extents.north;\n                    south = (south < tile.extents.south) ? south : tile.extents.south;\n                }\n            }\n            const stream = new BinStream(1024, true);\n            // header\n            stream.writeInt32(4); // version\n            stream.writeInt32(0); // device id\n            extents = jnxCoordinates({south: south, north: north, west: west, east: east});\n            stream.writeInt32(extents[0]); // north\n            stream.writeInt32(extents[1]); // west\n            stream.writeInt32(extents[2]); // south\n            stream.writeInt32(extents[3]); // east\n            stream.writeInt32(levels_n); // number of zoom levels\n            stream.writeInt32(0); // expiration date\n            stream.writeInt32(this.productId);\n            stream.writeInt32(0); // tiles CRC32\n            stream.writeInt32(0); // signature version\n            stream.writeUint32(0); // signature offset\n            stream.writeInt32(this.zOrder);\n            stream.seek(HEADER_SIZE + LEVEL_INFO_SIZE * levels_n);\n            // map description\n            stream.writeInt32(9); // section version\n            stream.writeString('12345678-1234-1234-1234-123456789ABC', true); // GUID\n            stream.writeString(this.productName, true);\n            stream.writeString('', true);\n            stream.writeInt16(this.productId);\n            stream.writeString(this.productName, true);\n            stream.writeInt32(levels_n);\n            // levels descriptions\n            for (level of Object.keys(this.tiles)) {\n                stream.writeString('', true);\n                stream.writeString('', true);\n                stream.writeString('', true);\n                stream.writeInt32(level);\n            }\n            let tileDescriptorOffset = stream.tell();\n            // level info\n            let jnxScale;\n            stream.seek(HEADER_SIZE);\n            for (level of Object.keys(this.tiles)) {\n                level = parseInt(level, 10);\n                stream.writeInt32(this.tiles[level].length);\n                stream.writeUint32(tileDescriptorOffset);\n                // jnxScale = JnxScales[level + 3];\n                jnxScale = 34115555 / (2 ** level) * Math.cos((north + south) / 2 / 180 * Math.PI) / 1.1;\n                stream.writeInt32(jnxScale);\n                stream.writeInt32(2);\n                stream.writeUint8(0);\n                tileDescriptorOffset += TILE_INFO_SIZE * this.tiles[level].length;\n            }\n            // tiles descriptors\n            stream.seek(stream.size);\n            let tileDataOffset = tileDescriptorOffset;\n            for (level of Object.keys(this.tiles)) {\n                tiles = this.tiles[level];\n                for (i = 0; i < tiles.length; i++) {\n                    tile = tiles[i];\n                    extents = jnxCoordinates(tile.extents);\n                    stream.writeInt32(extents[0]); // north\n                    stream.writeInt32(extents[1]); // west\n                    stream.writeInt32(extents[2]); // south\n                    stream.writeInt32(extents[3]); // east\n                    stream.writeInt16(256); // width\n                    stream.writeInt16(256); // height\n                    stream.writeInt32(tile.data.size);\n                    stream.writeUint32(tileDataOffset);\n                    tileDataOffset += tile.data.size;\n                }\n            }\n\n            const blob = [];\n            blob.push(stream.getBuffer());\n            for (level of Object.keys(this.tiles)) {\n                tiles = this.tiles[level];\n                for (i = 0; i < tiles.length; i++) {\n                    tile = tiles[i];\n                    blob.push(tile.data);\n                }\n            }\n\n            blob.push('BirdsEye');\n            return new Blob(blob);\n        }\n    }\n);\n\nexport {JnxWriter};\n","import utf8 from 'utf8';\n\nclass BinStream {\n    constructor(size, littlEndian) {\n        this.maxSize = 1024;\n        this.dv = new DataView(new ArrayBuffer(this.maxSize));\n        this._pos = 0;\n        this.size = 0;\n        this.littlEndian = littlEndian;\n    }\n\n    grow() {\n        this.maxSize *= 2;\n        const old_buffer = this.dv.buffer;\n        this.dv = new DataView(new ArrayBuffer(this.maxSize));\n        const newAr = new Uint8Array(this.dv.buffer);\n        const oldAr = new Uint8Array(old_buffer);\n        for (let i = 0; i < oldAr.length; i++) {\n            newAr[i] = oldAr[i];\n        }\n    }\n\n    checkSize(size) {\n        if (this._pos + size >= this.maxSize) {\n            this.grow();\n        }\n        const newPos = this._pos + size;\n        this.size = (newPos > this.size) ? newPos : this.size;\n    }\n\n    writeUint8(value) {\n        this.checkSize(1);\n        this.dv.setUint8(this._pos, value);\n        this._pos += 1;\n    }\n\n    writeInt8(value) {\n        this.checkSize(1);\n        this.dv.setInt8(this._pos, value);\n        this._pos += 1;\n    }\n\n    writeInt16(value) {\n        this.checkSize(2);\n        this.dv.setInt16(this._pos, value, this.littlEndian);\n        this._pos += 2;\n    }\n\n    writeUint16(value) {\n        this.checkSize(2);\n        this.dv.setUint16(this._pos, value, this.littlEndian);\n        this._pos += 2;\n    }\n\n    writeInt32(value) {\n        this.checkSize(4);\n        this.dv.setInt32(this._pos, value, this.littlEndian);\n        this._pos += 4;\n    }\n\n    writeUint32(value) {\n        this.checkSize(4);\n        this.dv.setUint32(this._pos, value, this.littlEndian);\n        this._pos += 4;\n    }\n\n    writeString(s, zeroTerminated) {\n        s = utf8.encode(s);\n        for (let i = 0; i < s.length; i++) {\n            this.writeUint8(s.charCodeAt(i));\n        }\n        if (zeroTerminated) {\n            this.writeUint8(0);\n        }\n    }\n\n    tell() {\n        return this._pos;\n    }\n\n    seek(pos) {\n        this._pos = pos;\n    }\n\n    getBuffer() {\n        return this.dv.buffer.slice(0, this.size);\n    }\n}\n\nexport {BinStream};\n","import L from 'leaflet';\nimport '~/lib/leaflet.hashState/leaflet.hashState';\n\nL.Control.JNX.include(L.Mixin.HashState);\nL.Control.JNX.include({\n        stateChangeEvents: ['selectionchange'],\n\n        serializeState: function() {\n            let state;\n            if (this._selector) {\n                const bounds = this._selector.getBounds();\n                state = [\n                    bounds.getSouth().toFixed(5),\n                    bounds.getWest().toFixed(5),\n                    bounds.getNorth().toFixed(5),\n                    bounds.getEast().toFixed(5)\n                ];\n            }\n            return state;\n        },\n\n        unserializeState: function(values) {\n            function validateFloat(value) {\n                value = parseFloat(value);\n                if (isNaN(value)) {\n                    throw new Error('INVALID VALUE');\n                }\n                return value;\n            }\n\n            function validateFloatRange(value, min, max) {\n                value = validateFloat(value);\n                if (value < min || value > max) {\n                    throw new Error('INVALID VALUE');\n                }\n                return value;\n            }\n\n            if (values && values.length === 4) {\n                let south, west, north, east;\n                try {\n                        south = validateFloatRange(values[0], -86, 86);\n                        west = validateFloat(values[1]);\n                        north = validateFloatRange(values[2], -86, 86);\n                        east = validateFloat(values[3]);\n                } catch (e) {\n                    if (e.message === 'INVALID VALUE') {\n                        return false;\n                    }\n                    throw e;\n                }\n                this.removeSelector();\n                this.addSelector([[south, west], [north, east]]);\n                return true;\n            }\n            return false;\n        }\n    }\n);\n","import L from 'leaflet';\nimport ko from 'knockout';\nimport {makeButtonWithBar} from '~/lib/leaflet.control.commons';\nimport layout from './control.html';\nimport '~/lib/controls-styles/controls-styles.css';\nimport './style.css';\nimport {getDeclination} from '~/lib/magnetic-declination';\nimport 'leaflet-rotatedmarker'; // eslint-disable-line import/no-unassigned-import\nimport iconPointer from './pointer.svg';\nimport iconPointerStart from './pointer-start.svg';\nimport iconPointerEnd from './pointer-end.svg';\nimport {ElevationProfile, calcSamplingInterval} from '~/lib/leaflet.control.elevation-profile';\n\nfunction radians(x) {\n    return x / 180 * Math.PI;\n}\n\nfunction degrees(x) {\n    return x / Math.PI * 180;\n}\n\nfunction calcAzimuth(latlng1, latlng2) {\n    const lat1 = radians(latlng1.lat);\n    const lat2 = radians(latlng2.lat);\n    const lng1 = radians(latlng1.lng);\n    const lng2 = radians(latlng2.lng);\n\n    const y = Math.sin(lng2 - lng1) * Math.cos(lat2);\n    const x = Math.cos(lat1) * Math.sin(lat2) -\n        Math.sin(lat1) * Math.cos(lat2) * Math.cos(lng2 - lng1);\n    let brng = Math.atan2(y, x);\n    brng = degrees(brng);\n    return brng;\n}\n\nfunction calcAngle(latlng1, latlng2) {\n    const p1 = L.Projection.SphericalMercator.project(latlng1);\n    const p2 = L.Projection.SphericalMercator.project(latlng2);\n    const delta = p2.subtract(p1);\n    const angle = Math.atan2(delta.x, delta.y);\n    return degrees(angle);\n}\n\nfunction roundAzimuth(a) {\n    return (Math.round(a) + 360) % 360;\n}\n\nL.Control.Azimuth = L.Control.extend({\n        options: {\n            position: 'bottomleft'\n        },\n\n        includes: L.Evented,\n\n        initialize: function(options) {\n            L.Control.prototype.initialize.call(this, options);\n            this.trueAzimuth = ko.observable(null);\n            this.magneticAzimuth = ko.observable(null);\n            this.distance = ko.observable(null);\n            this.points = {\n                start: null,\n                end: null\n            };\n            const iconSingle = L.icon({iconUrl: iconPointer, iconSize: [30, 30]});\n            const iconStart = L.icon({iconUrl: iconPointerStart, iconSize: [30, 30]});\n            const iconEnd = L.icon({iconUrl: iconPointerEnd, iconSize: [30, 45]});\n            this.azimuthLine = L.polyline([], {interactive: false, weight: 1.5});\n            this.markers = {\n                single: L.marker([0, 0], {icon: iconSingle, draggable: true, which: 'start'})\n                    .on('drag', this.onMarkerDrag, this)\n                    .on('click', L.DomEvent.stopPropagation),\n                start: L.marker([0, 0], {\n                    icon: iconStart,\n                    draggable: true,\n                    which: 'start',\n                    rotationOrigin: 'center center',\n                    projectedShift: () => this.azimuthLine.shiftProjectedFitMapView()\n                })\n                    .on('drag', this.onMarkerDrag, this)\n                    .on('click', L.DomEvent.stopPropagation)\n                    .on('dragend', this.onMarkerDragEnd, this),\n                end: L.marker([0, 0], {\n                    icon: iconEnd,\n                    draggable: true,\n                    which: 'end',\n                    rotationOrigin: 'center center',\n                    projectedShift: () => this.azimuthLine.shiftProjectedFitMapView()\n                })\n                    .on('drag', this.onMarkerDrag, this)\n                    .on('click', L.DomEvent.stopPropagation)\n                    .on('dragend', this.onMarkerDragEnd, this)\n            };\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            const {container, link, barContainer} = makeButtonWithBar(\n                'leaflet-control-azimuth', 'Measure bearing, display line of sight', 'icon-azimuth');\n            this._container = container;\n            L.DomEvent.on(link, 'click', this.onClick, this);\n\n            barContainer.innerHTML = layout;\n            ko.applyBindings(this, barContainer);\n            return container;\n        },\n\n        onClick: function() {\n            if (this.isEnabled()) {\n                this.disableControl();\n            } else {\n                this.enableControl();\n            }\n        },\n\n        onMarkerDrag: function(e) {\n            const marker = e.target;\n            this.setPoints({[marker.options.which]: marker.getLatLng()});\n        },\n\n        onMarkerDragEnd: function() {\n            if (this.elevationControl) {\n                this.showProfile();\n            }\n        },\n\n        enableControl: function() {\n            L.DomUtil.addClass(this._container, 'active');\n            L.DomUtil.addClass(this._container, 'highlight');\n            L.DomUtil.addClass(this._map._container, 'azimuth-control-active');\n            this._map.on('click', this.onMapClick, this);\n            this.fire('enabled');\n            this._map.clickLocked = true;\n            this._enabled = true;\n        },\n\n        disableControl: function() {\n            L.DomUtil.removeClass(this._container, 'active');\n            L.DomUtil.removeClass(this._container, 'highlight');\n            this.hideProfile();\n            this.setPoints({start: null, end: null});\n            L.DomUtil.removeClass(this._map._container, 'azimuth-control-active');\n            this._map.off('click', this.onMapClick, this);\n            this._map.clickLocked = false;\n            this._enabled = false;\n        },\n\n        isEnabled: function() {\n            return Boolean(this._enabled);\n        },\n\n        setPoints: function(points) {\n            Object.assign(this.points, points);\n            points = this.points;\n            if (points.start && !points.end) {\n                this.markers.single\n                    .setLatLng(points.start)\n                    .addTo(this._map);\n            } else {\n                this.markers.single.removeFrom(this._map);\n            }\n            if (points.start && points.end) {\n                const angle = calcAngle(points.start, points.end);\n                this.markers.start\n                    .setLatLng(points.start)\n                    .addTo(this._map)\n                    .setRotationAngle(angle);\n                this.markers.end\n                    .setLatLng(points.end)\n                    .addTo(this._map)\n                    .setRotationAngle(angle);\n                this.azimuthLine\n                    .setLatLngs([[points.start, points.end]])\n                    .addTo(this._map);\n            } else {\n                this.markers.start.removeFrom(this._map);\n                this.markers.end.removeFrom(this._map);\n                this.azimuthLine.removeFrom(this._map);\n            }\n            this.updateValuesDisplay();\n        },\n\n        updateValuesDisplay: function() {\n            if (this.points.start && this.points.end) {\n                const points = this.points;\n                const azimuth = calcAzimuth(points.start, points.end);\n                this.trueAzimuth(roundAzimuth(azimuth));\n                const declination = getDeclination(points.start.lat, points.start.lng);\n                if (declination === null) {\n                    this.magneticAzimuth(null);\n                } else {\n                    this.magneticAzimuth(roundAzimuth(azimuth - declination));\n                }\n                this.distance(points.start.distanceTo(points.end));\n            } else {\n                this.distance(null);\n                this.trueAzimuth(null);\n                this.magneticAzimuth(null);\n            }\n        },\n\n        onMapClick: function(e) {\n            if (!this.points.start && !this.points.end) {\n                this.setPoints({start: e.latlng});\n            } else if (this.points.start && !this.points.end) {\n                this.setPoints({end: e.latlng});\n            } else if (this.points.start && this.points.end) {\n                this.hideProfile();\n                this.setPoints({start: e.latlng, end: null});\n            }\n        },\n\n        showProfile: function() {\n            if (!this.points.end) {\n                return;\n            }\n            if (this.elevationControl) {\n                this.elevationControl.removeFrom(this._map);\n            }\n\n            const dist = this.points.start.distanceTo(this.points.end);\n            this.elevationControl = new ElevationProfile(this._map, [this.points.start, this.points.end], {\n                samplingInterval: calcSamplingInterval(dist),\n                sightLine: true\n            });\n            this.elevationControl.on('remove', () => {\n                this.elevationControl = null;\n            });\n            this.fire('elevation-shown');\n        },\n\n        hideProfile: function() {\n            if (this.elevationControl) {\n                this.elevationControl.removeFrom(this._map);\n            }\n            this.elevationControl = null;\n        },\n\n        onProfileButtonClick: function() {\n            this.showProfile();\n        },\n\n        onReverseButtonClick: function() {\n            if (this.points.end && this.points.start) {\n                this.setPoints({start: this.points.end, end: this.points.start});\n                if (this.elevationControl) {\n                    this.showProfile();\n                }\n            }\n        }\n\n    }\n);\n\n","export default \"<div class=\\\"contents\\\">\\n    <table>\\n        <tr>\\n            <td>True azimuth</td>\\n            <td data-bind=\\\"text: trueAzimuth() !== null ? Math.round(trueAzimuth()) + '&deg;' : '--'\\\"></td>\\n        </tr>\\n        <tr>\\n            <td>Magnetic azimuth</td>\\n            <td data-bind=\\\"text: magneticAzimuth() !== null ? magneticAzimuth() + '&deg;' : '--'\\\"></td>\\n        </tr>\\n        <tr>\\n            <td>Distance</td>\\n            <td data-bind=\\\"text: distance() === null ? '--' :\\n                distance() > 2000 ? (distance() / 1000).toFixed(2) + ' km' : Math.round(distance()) + ' m'\\\"></td>\\n        </tr>\\n    </table>\\n\\n    <div class=\\\"buttons\\\">\\n        <div class=\\\"button\\\" data-bind=\\\"click: onReverseButtonClick\\\">Reverse</div>\\n        <div class=\\\"button\\\" data-bind=\\\"click: onProfileButtonClick\\\">Elevation / Sightline</div>\\n    </div>\\n</div>\";","// extracted by mini-css-extract-plugin\nexport {};","export default \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMzAgMzAiPgogICAgPGc+CiAgICAgICAgPGVsbGlwc2Ugcnk9IjE1IiByeD0iMTUiIGN5PSIxNSIgY3g9IjE1IiBmaWxsPSIjNzc3IiBmaWxsLW9wYWNpdHk9IjAuNSIvPgogICAgICAgIDxlbGxpcHNlIHJ5PSIzIiByeD0iMyIgY3k9IjE1IiBjeD0iMTUiIGZpbGw9IiMzMzg4ZmYiIC8+CiAgICA8L2c+Cjwvc3ZnPg==\"","export default \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMzAgNDUiPgogICAgPGc+CiAgICAgICAgPGVsbGlwc2Ugcnk9IjE1IiByeD0iMTUiIGN5PSIyNiIgY3g9IjE1IiBmaWxsPSIjNzc3IiBmaWxsLW9wYWNpdHk9IjAuNSIvPgogICAgICAgIDxwYXRoIGQ9Ik0xNSwyMCBsLTUsMTIgbDEwLDAgeiIgZmlsbD0iIzMzODhmZiIvPgogICAgPC9nPgo8L3N2Zz4=\"","import L from 'leaflet';\nimport {makeButton} from '~/lib/leaflet.control.commons';\nimport './style.css';\nimport localStorage from '~/lib/safe-localstorage';\n\nconst STATE_DISABLED = 'disabled';\nconst STATE_LOCATING = 'locating';\nconst STATE_ENABLED = 'enabled';\nconst STATE_ENABLED_FOLLOWING = 'enabled_following';\nconst STATE_MOVING_TO_FOLLOWING = 'moving_to_following';\nconst STATE_MOVING_TO_FOLLOWING_FIRST = 'moving_to_following_first';\nconst STATE_UPDATING_FOLLOWING = 'updating_following';\n\nconst EVENT_INIT = 'init';\nconst EVENT_BUTTON_CLICK = 'button_click';\nconst EVENT_LOCATION_RECEIVED = 'location_received';\nconst EVENT_LOCATION_ERROR = 'location_error';\nconst EVENT_MAP_MOVE = 'user_move';\nconst EVENT_MAP_MOVE_END = 'map_move_end';\n\nconst LOCALSTORAGE_POSITION = 'leaflet_locate_position';\n\nconst PositionMarker = L.LayerGroup.extend({\n    initialize: function(options) {\n        L.LayerGroup.prototype.initialize.call(this, options);\n        this._locationSet = false;\n        this._elements = {\n            accuracyCircle: L.circle([0, 0], {\n                radius: 1,\n                interactive: false,\n                fillColor: '#4271a8',\n                color: '#2ba3f7',\n                weight: 2\n            }),\n            markerCircle: L.circleMarker([0, 0], {\n                interactive: false,\n                radius: 10,\n                color: '#2ba3f7',\n                weight: 2.5,\n                fill: null,\n                opacity: 0.8\n            }),\n            markerPoint: L.circleMarker([0, 0], {\n                interactive: false,\n                radius: 2,\n                weight: 0,\n                color: '#2ba3f7',\n                fillOpacity: 0.8\n            }),\n        };\n        this.addLayer(this._elements.accuracyCircle);\n    },\n\n    onAdd: function(map) {\n        L.LayerGroup.prototype.onAdd.call(this, map);\n        map.on('zoom', this._onZoom, this);\n        this._updatePrecisionState();\n    },\n\n    onRemove: function(map) {\n        map.off('zoom', this._onZoom, this);\n        L.LayerGroup.prototype.onRemove.call(this, map);\n    },\n\n    _updatePrecisionState: function() {\n        if (!this._map || !this._locationSet) {\n            return;\n        }\n        const precise = this._elements.accuracyCircle._radius <= this._elements.markerCircle.options.radius * 0.8;\n        if (precise !== this._precise) {\n            if (precise) {\n                this._elements.accuracyCircle.setStyle({opacity: 0, fillOpacity: 0});\n                this.addLayer(this._elements.markerPoint);\n                this.addLayer(this._elements.markerCircle);\n            } else {\n                this._elements.accuracyCircle.setStyle({opacity: 0.8, fillOpacity: 0.4});\n                this.removeLayer(this._elements.markerPoint);\n                this.removeLayer(this._elements.markerCircle);\n            }\n            this._precise = precise;\n        }\n    },\n\n    setLocation: function(latlng, accuracy) {\n        this._elements.accuracyCircle.setLatLng(latlng);\n        this._elements.accuracyCircle.setRadius(accuracy);\n        this._elements.markerCircle.setLatLng(latlng);\n        this._elements.markerPoint.setLatLng(latlng);\n        this._locationSet = true;\n        this._updatePrecisionState();\n    },\n\n    _onZoom: function() {\n        this._updatePrecisionState();\n    }\n\n});\n\nconst LocateControl = L.Control.extend({\n        // button click behavior:\n        // if button turned off -- turn on, maps follows marker\n        // if button turned on\n        //     if map is following marker -- turn off\n        //     if map not following marker -- center map at marker, start following\n\n        options: {\n            locationAcquireTimeoutMS: Infinity,\n            showError: ({message}) => {\n                alert(message);\n            },\n            maxAutoZoom: 17,\n            minAutoZoomDeltaForAuto: 4,\n            minDistForAutoZoom: 2 // in average screen sizes\n        },\n\n        initialize: function(options) {\n            L.Control.prototype.initialize.call(this, options);\n            this._events = [];\n        },\n\n        onAdd: function(map) {\n            this._map = map;\n            const {container, link} = makeButton('leaflet-control-locate', 'Где я сейчас?', 'icon-position');\n            this._container = container;\n            L.DomEvent.on(link, 'click', () => this._handleEvent(EVENT_BUTTON_CLICK));\n            this._marker = new PositionMarker();\n            this._handleEvent(EVENT_INIT);\n            return container;\n        },\n\n        moveMapToCurrentLocation: function(zoom, fallbackLatLng, forceLatLng, forceZoom) {\n            let storedPosition;\n            try {\n                storedPosition = JSON.parse(localStorage.getItem(LOCALSTORAGE_POSITION));\n                let {lat, lon} = storedPosition;\n                if (lat && lon) {\n                    storedPosition = L.latLng(lat, lon);\n                } else {\n                    storedPosition = null;\n                }\n            } catch (e) {\n                // ignore invalid data from localstorage\n            }\n\n            if (storedPosition) {\n                this._map.setView(forceLatLng ? forceLatLng : storedPosition, forceZoom ? forceZoom : zoom, {\n                    animate: false,\n                });\n                if (!('geolocation' in navigator)) {\n                    return;\n                }\n                navigator.geolocation.getCurrentPosition(\n                    (pos) => {\n                        this._storePositionToLocalStorage(pos);\n                        if (!forceLatLng) {\n                            // TODO: check if map has not moved\n                            this._map.setView(L.latLng(pos.coords.latitude, pos.coords.longitude), zoom, {\n                                animate: false,\n                            });\n                        }\n                    },\n                    (e) => {\n                        if (e.code === 1) {\n                            localStorage.removeItem(LOCALSTORAGE_POSITION);\n                        }\n                    }, {\n                    enableHighAccuracy: false,\n                    timeout: 500,\n                    maximumAge: 0\n                });\n            } else {\n                this._map.setView(forceLatLng ? forceLatLng : fallbackLatLng, forceZoom ? forceZoom : zoom,\n                    {animate: false});\n            }\n        },\n\n        _startLocating: function() {\n            if (!('geolocation' in navigator) || !('watchPosition' in navigator.geolocation)) {\n                const error = {code: 0, message: 'Geolocation not supported'};\n                setTimeout(() => {\n                        this._onLocationError(error);\n                    }, 0\n                );\n            }\n            this._watchID = navigator.geolocation.watchPosition(\n                this._onLocationSuccess.bind(this), this._onLocationError.bind(this),\n                {\n                    enableHighAccuracy: true,\n                    timeout: this.options.locationAcquireTimeoutMS,\n                }\n            );\n        },\n\n        _storePositionToLocalStorage: function(pos) {\n            const coords = {lat: pos.coords.latitude, lon: pos.coords.longitude};\n            localStorage.setItem(LOCALSTORAGE_POSITION, JSON.stringify(coords));\n        },\n\n        _onLocationSuccess: function(pos) {\n            this._handleEvent(EVENT_LOCATION_RECEIVED, pos);\n            this._storePositionToLocalStorage(pos);\n        },\n\n        _onLocationError: function(e) {\n            this._handleEvent(EVENT_LOCATION_ERROR, e);\n            if (e.code === 1) {\n                localStorage.removeItem(LOCALSTORAGE_POSITION);\n            }\n        },\n\n        _stopLocating: function() {\n            if (this._watchID && navigator.geolocation) {\n                navigator.geolocation.clearWatch(this._watchID);\n            }\n        },\n\n        _storeLocation: function(position) {\n            this._latlng = L.latLng(position.coords.latitude, position.coords.longitude);\n            this._accuracy = position.coords.accuracy;\n        },\n\n        _updateMarkerLocation: function() {\n            this._marker.setLocation(this._latlng, this._accuracy);\n        },\n\n        _updateMapPositionWhileFollowing: function() {\n            this._updateFollowingStartPosition = this._map.getCenter();\n            this._updateFollowingDestPosition = this._latlng;\n            this._map.panTo(this._latlng);\n        },\n\n        _setViewToLocation: function(preferAutoZoom) {\n            if (!this._map || !this._latlng) {\n                return;\n            }\n\n            // autoZoom -- to fit accuracy cirlce on screen, but not more then options.maxAutoZoom (17)\n            // if current zoom more then options.minAutoZoomDeltaForAuto less then autoZoom, set autoZoom\n            // if map center far from geolocation, set autoZoom\n            // if map center not far from geolocation\n            //      if accuracy circle does not fit at current zoom, zoom out to fit\n            //      if  current zoom is less then minAutoZoomDeltaForAuto less then autoZoom\n            //          or >= autoZoom and circle fits screen, keep current zoom\n\n            const currentZoom = this._map.getZoom();\n            let zoomFitAccuracy = this._map.getBoundsZoom(this._latlng.toBounds(this._accuracy * 2));\n            let autoZoom = zoomFitAccuracy;\n            let newZoom;\n            autoZoom = Math.min(autoZoom, this.options.maxAutoZoom);\n\n            if (preferAutoZoom || autoZoom - currentZoom >= this.options.minAutoZoomDeltaForAuto) {\n                newZoom = autoZoom;\n            } else {\n                const p1 = this._map.project(this._map.getCenter());\n                const p2 = this._map.project(this._latlng);\n                const screenSize = this._map.getSize();\n                const averageScreenSize = (screenSize.x + screenSize.y) / 2;\n                if (p1.distanceTo(p2) > averageScreenSize * this.options.minDistForAutoZoom) {\n                    newZoom = autoZoom;\n                } else {\n                    newZoom = currentZoom > zoomFitAccuracy ? zoomFitAccuracy : currentZoom;\n                }\n            }\n            this._map.setView(this._latlng, newZoom);\n        },\n\n        _onMapMove: function() {\n            this._handleEvent(EVENT_MAP_MOVE);\n        },\n\n        _onMapMoveEnd: function() {\n            const ll = this._map.getCenter();\n            setTimeout(() => {\n                    if (this._map.getCenter().equals(ll)) {\n                        this._handleEvent(EVENT_MAP_MOVE_END);\n                    }\n                }, 100\n            );\n        },\n\n        _isMapOffsetFromFollowingSegment: function() {\n            if (this._updateFollowingStartPosition) {\n                const p = this._map.project(this._map.getCenter());\n                const p1 = this._map.project(this._updateFollowingStartPosition);\n                const p2 = this._map.project(this._updateFollowingDestPosition);\n                return L.LineUtil.pointToSegmentDistance(p, p1, p2) > 5;\n            }\n            return true;\n        },\n\n        _isMapCenteredAtLocation: function() {\n            if (!this._latlng || !this._map) {\n                return false;\n            }\n            let p1 = this._map.project(this._latlng);\n            let p2 = this._map.project(this._map.getCenter());\n            return p1.distanceTo(p2) < 5;\n        },\n\n        _updateButtonClasses: function(add, remove) {\n            for (let cls of add) {\n                L.DomUtil.addClass(this._container, cls);\n            }\n            for (let cls of remove) {\n                L.DomUtil.removeClass(this._container, cls);\n            }\n        },\n\n        _setEvents: function(on) {\n            const f = on ? 'on' : 'off';\n            this._map[f]('move', this._onMapMove, this);\n            this._map[f]('moveend', this._onMapMoveEnd, this);\n        },\n\n        _handleEvent: function(event, data) {\n            this._events.push({event, data});\n            if (!this._processingEvent) {\n                this._processingEvent = true;\n                while (this._events.length) {\n                    this._processEvent(this._events.shift());\n                }\n                this._processingEvent = false;\n            }\n        },\n\n        _processEvent: function({event, data}) { // eslint-disable-line complexity\n            // console.log('PROCESS EVENT', event);\n            const state = this._state;\n            switch (event) {\n                case EVENT_INIT:\n                    this._setState(STATE_DISABLED);\n                    break;\n                case EVENT_BUTTON_CLICK:\n                    if (state === STATE_DISABLED) {\n                        this._setState(STATE_LOCATING);\n                    } else if (state === STATE_ENABLED) {\n                        this._setState(STATE_MOVING_TO_FOLLOWING);\n                        this._setViewToLocation();\n                    } else {\n                        this._setState(STATE_DISABLED);\n                    }\n                    break;\n                case EVENT_LOCATION_RECEIVED:\n                    if (state === STATE_DISABLED) {\n                        return;\n                    }\n                    this._storeLocation(data);\n                    this._updateMarkerLocation();\n                    if (state === STATE_LOCATING || state === STATE_MOVING_TO_FOLLOWING_FIRST) {\n                        this._setViewToLocation(true);\n                        this._setState(STATE_MOVING_TO_FOLLOWING_FIRST);\n                    } else if (state === STATE_MOVING_TO_FOLLOWING) {\n                        this._setViewToLocation();\n                    } else if (this._state === STATE_ENABLED_FOLLOWING || state === STATE_UPDATING_FOLLOWING) {\n                        this._updateMapPositionWhileFollowing();\n                        this._setState(STATE_UPDATING_FOLLOWING);\n                    }\n                    break;\n                case EVENT_LOCATION_ERROR:\n                    if (state === STATE_DISABLED) {\n                        return;\n                    }\n                    this.options.showError(data);\n                    this._setState(STATE_DISABLED);\n                    break;\n                case EVENT_MAP_MOVE:\n                    if (state === STATE_ENABLED_FOLLOWING) {\n                        if (!this._isMapCenteredAtLocation() && this._isMapOffsetFromFollowingSegment()) {\n                            this._setState(STATE_ENABLED);\n                        }\n                    }\n                    break;\n                case EVENT_MAP_MOVE_END:\n                    if (state === STATE_MOVING_TO_FOLLOWING) {\n                        if (this._isMapCenteredAtLocation()) {\n                            this._setState(STATE_ENABLED_FOLLOWING);\n                        } else {\n                            this._setState(STATE_ENABLED);\n                        }\n                    } else if (state === STATE_UPDATING_FOLLOWING || state === STATE_MOVING_TO_FOLLOWING_FIRST) {\n                        if (this._isMapCenteredAtLocation() || !this._isMapOffsetFromFollowingSegment()) {\n                            this._setState(STATE_ENABLED_FOLLOWING);\n                        } else {\n                            this._setState(STATE_ENABLED);\n                        }\n                    }\n                    break;\n                default:\n            }\n        },\n\n        _setState: function(newState) {\n            const oldState = this._state;\n            if (oldState === newState) {\n                return;\n            }\n            // console.log(`STATE: ${oldState} -> ${newState}`);\n            switch (newState) {\n                case STATE_LOCATING:\n                    this._startLocating();\n                    this._updateButtonClasses(['requesting'], ['active', 'following']);\n                    this._setEvents(true);\n                    break;\n                case STATE_DISABLED:\n                    this._stopLocating();\n                    this._marker.removeFrom(this._map);\n                    this._setEvents(false);\n                    this._updateButtonClasses([], ['active', 'highlight', 'following', 'requesting']);\n                    break;\n                case STATE_ENABLED:\n                    this._updateButtonClasses(['active', 'highlight'], ['following', 'requesting']);\n                    break;\n                case STATE_MOVING_TO_FOLLOWING_FIRST:\n                    this._marker.addTo(this._map);\n                    break;\n                case STATE_ENABLED_FOLLOWING:\n                    this._updateButtonClasses(['active', 'highlight', 'following'], ['requesting']);\n                    break;\n                default:\n            }\n            this._state = newState;\n        },\n    }\n);\n\nexport {LocateControl};\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport './style.css';\n\nconst ZoomWithDisplay = L.Control.Zoom.extend({\n    onAdd: function(map) {\n        const container = L.Control.Zoom.prototype.onAdd.call(this, map);\n        this._display = L.DomUtil.create('div', 'leaflet-control-zoom-display');\n        container.insertBefore(this._display, this._zoomOutButton);\n        map.on('zoomend', this._updateDisplay, this);\n        this._updateDisplay();\n        return container;\n    },\n\n    onRemove: function(map) {\n        L.Control.Zoom.prototype.onRemove.call(this, map);\n        map.off('zoomend', this._updateDisplay, this);\n    },\n\n    _updateDisplay: function() {\n        this._display.innerHTML = this._map.getZoom();\n    }\n\n});\n\nexport default ZoomWithDisplay;\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\n\nimport '~/lib/leaflet.hashState/leaflet.hashState';\n\nimport './style.css';\n\nconst Placemark = L.Marker.extend({\n    initialize: function(latlng, title) {\n        this.title = title;\n        const icon = L.divIcon({\n            html: '<div class=\"lealfet-placemark-title\"></div>',\n            className: 'leaflet-placemark',\n        });\n        L.Marker.prototype.initialize.call(this, latlng, {icon});\n    },\n\n    getTitle: function() {\n        return this.title;\n    },\n\n    onAdd: function(map) {\n        L.Marker.prototype.onAdd.call(this, map);\n        this.getElement().children[0].innerHTML = this.title;\n        this.on('click', this.onClick, this);\n        map.on('click', this.onMapClick, this);\n        map.suggestedPoint = {latlng: this.getLatLng(), title: this.title};\n    },\n\n    onRemove: function(map) {\n        this._map.off('move', this.onMapMove, this);\n        this._map.off('click', this.onMapClick, this);\n        this._map.suggestedPoint = null;\n        L.Marker.prototype.onRemove.call(this, map);\n    },\n\n    onClick: function() {\n        this._map.fire('click', {latlng: this.getLatLng(), suggested: true});\n        this._map.removeLayer(this);\n    },\n\n    onMapClick: function(e) {\n        if (!e.suggested) {\n            this._map.removeLayer(this);\n        }\n    },\n});\n\nL.Map.include({\n    showPlacemark: function(latlng, title) {\n        if (this._placemark) {\n            this.removeLayer(this._placemark);\n        }\n        this._placemark = new Placemark(latlng, title);\n        this.addLayer(this._placemark);\n        this.fire('placemarkshow');\n        this._placemark.on('remove', this.onPlacemarkRemove, this);\n    },\n\n    onPlacemarkRemove: function() {\n        this._placemark = null;\n        this.fire('placemarkhide');\n    },\n});\n\nconst PlacemarkHashStateInterface = L.Class.extend({\n    includes: L.Mixin.HashState,\n\n    stateChangeEvents: ['placemarkshow', 'placemarkhide'],\n\n    initialize: function(map) {\n        this.map = map;\n        this.stateChangeEventsSource = 'map';\n    },\n\n    serializeState: function() {\n        const placemark = this.map._placemark;\n        if (!placemark) {\n            return null;\n        }\n        const latlng = placemark.getLatLng();\n        return [latlng.lat.toFixed(6), latlng.lng.toFixed(6), encodeURIComponent(placemark.getTitle())];\n    },\n\n    unserializeState: function(values) {\n        if (!values) {\n            return false;\n        }\n        const lat = parseFloat(values[0]);\n        const lng = parseFloat(values[1]);\n        const title = decodeURIComponent(values[2] ?? '');\n        if (isNaN(lat) || isNaN(lng) || lat < -90 || lat > 90 || lng < -180 || lng > 180) {\n            return false;\n        }\n        this.map.showPlacemark(L.latLng(lat, lng), title);\n        return true;\n    },\n});\n\nL.Map.include({\n    getPlacemarkHashStateInterface: function() {\n        return new PlacemarkHashStateInterface(this);\n    },\n});\n","// extracted by mini-css-extract-plugin\nexport {};","import L from 'leaflet';\nimport './style.css';\nimport config from '~/config';\nimport '~/lib/leaflet.control.commons';\nimport {fetch} from '~/lib/xhr-promise';\nimport {notify} from '~/lib/notifications';\nimport iconPointer from '../leaflet.control.azimuth/pointer.svg';\n\nL.Control.Weather = L.Control.extend({\n    options: {\n        position: 'topleft',\n    },\n\n    onAdd: function (map) {\n        this.places = null; // места\n        this.data = null; // данные по погоде\n        this.periods = null; // соответствие timestamp дате\n\n        this.icon_map = {\n            '01d' : 'skc_d',\n            '02d' : 'bkn_d',\n            '03d' : 'ovc',\n            '04d' : 'ovc',\n            '09d' : 'ovc_ra',\n            '10d' : 'bkn_ra_d',\n            '11d' : 'ovc_+ra',\n            '13d' : 'bkn_+sn_d',\n            '50d' : 'ovc',\n            '01n' : 'skc_n',\n            '02n' : 'bkn_n',\n            '03n' : 'ovc',\n            '04n' : 'ovc',\n            '09n' : 'ovc_ra',\n            '10n' : 'bkn_ra_n',\n            '11n' : 'ovc_+ra',\n            '13n' : 'bkn_+sn_n',\n            '50n' : 'ovc',\n        }\n\n\n        this.layerGroup = L.layerGroup();\n        this.layerGroup.addTo( map );\n\n        this._map = map;\n\n        this.container = L.DomUtil.create('div', 'leaflet-control button-with-bar leaflet-control-weather');\n        let link_container = L.DomUtil.create('div', 'leaflet-bar leaflet-control-single-button', this.container);\n        this.link = L.DomUtil.create('a', 'leaflet-control-weather-button leaflet-bar-part ', link_container);\n        this.link.href = '#';\n        L.DomEvent.on(this.link, 'click', this.load, this);\n\n        return this.container;\n    },\n    load: function(map) {\n        if ( map._simulated ) {\n            return this.stopPropagation(map);\n        }\n        if ( L.DomUtil.hasClass( this.link, 'leaflet-control-weather-loading' ) ) {\n            return this.stopPropagation(map);\n        }\n\n        if ( L.DomUtil.hasClass( this.container, 'active' ) ) {\n            this.unload();\n            return this.stopPropagation(map);\n        }\n        L.DomUtil.addClass( this.link, 'leaflet-control-weather-loading' );\n        const url = config.weatherServer;\n        let self = this;\n        if ( self.places ) {\n            setTimeout( function() {\n                self.showControl(map);\n            }, 100 );\n        } else {\n            fetch(url, {method: 'GET', withCredentials: false}).then(function(response) {\n                if ( response.status !== 200 ) {\n                    notify( 'Данные о погоде временно не доступны' );\n                    return false;\n                }\n                let res = JSON.parse( response.responseJSON );\n                self.places = res.objects;\n                self.data = res.data;\n                self.periods = res.periods;\n\n                //console.log(self.places, self.data, self.periods);\n                self.showControl(map);\n            });\n        }\n\n        return this.stopPropagation(map);\n    },\n    stopPropagation: function(map) {\n        map.preventDefault();\n        map.stopPropagation();\n        return false;\n    },\n    renderMarkerIcon: function( place, current_weather ) {\n        let temp = Math.round( current_weather.t );\n        if ( temp > 0 ) {\n            temp = '+' + temp;\n        }\n        let html = '<div class=\"balloon\">\\n' +\n            '<a tabindex=\"0\" href=\"#\">\\n' +\n            '<img class=\"icon\" src=\"https://yastatic.net/weather/i/icons/blueye/color/svg/'+self.icon_map[current_weather.i]+'.svg\">' +\n            '<span class=\"balloon__temp\">'+temp+'°</span>' +\n            '<span class=\"balloon__name\">'+place.name+'</span>' +\n            '</a>\\n' +\n            '</div>\\n';\n\n        return html;\n    },\n    renderPlaces: function( period_index = 0 ) {\n        self = this;\n        const iconSingle = L.icon({iconUrl: iconPointer, iconSize: [30, 30]});\n        for ( let place in self.places ) {\n            let current_period = Object.keys(self.data)[period_index];\n            let current_weather = self.data[current_period][place];\n            if ( typeof current_weather === 'undefined' ) {\n                continue;\n            }\n            let icon = L.divIcon({\n                className: \"marker-default\",\n                html: self.renderMarkerIcon( self.places[place], current_weather )\n            });\n            let marker = L.marker([self.places[place].lat, self.places[place].lng], {icon: icon});\n            self.layerGroup.addLayer( marker );\n        }\n        document.querySelectorAll(\".balloon\").forEach(function(baloon ) {\n            baloon.addEventListener(\"mouseenter\", function(e) {\n                baloon.querySelector(\".balloon__name\").style.display = 'inline-block';\n                //baloon.querySelector(\".baloon-content\").style.display = 'block';\n                let marker = baloon.closest('.marker-default');\n                marker.dataset.zindex = marker.style['z-index'];\n                marker.style['z-index'] = 99999;\n                marker.style['min-width'] = '150px';\n            });\n            baloon.addEventListener(\"mouseleave\", function(e) {\n                baloon.querySelector(\".balloon__name\").style.display = 'none';\n                //baloon.querySelector(\".baloon-content\").style.display = 'none';\n                let marker = baloon.closest('.marker-default');\n                marker.style['z-index'] = marker.dataset.zindex;\n                marker.style['min-width'] = 'inherit';\n            });\n            baloon.addEventListener(\"click\", function(e) {\n                e.stopPropagation();\n                e.preventDefault();\n            });\n        });\n\n    },\n    showControl: function(map) {\n        L.DomUtil.removeClass( this.link, 'leaflet-control-weather-loading' );\n\n        L.DomUtil.addClass(this.container, 'active');\n        this._map.fire( 'weather_rendered' );\n\n        this.renderPlaces();\n\n        this.controlContainer = L.DomUtil.create('div', 'leaflet-bar bar leaflet-control-weather-bar', this.container);\n\n        this.positionSliderLabel = L.DomUtil.create('label', 'leaflet-control-weather-label leaflet-bar-part', this.controlContainer);\n        this.positionSliderLabel.for = \"rainviewer-positionslider\";\n        this.positionSliderLabel.textContent = '';\n\n        this.positionSlider = L.DomUtil.create('input', 'leaflet-control-weather-positionslider leaflet-bar-part', this.controlContainer);\n        this.positionSlider.type = \"range\";\n        this.positionSlider.id = \"rainviewer-positionslider\";\n        this.positionSlider.min = 0;\n        this.positionSlider.max = Object.keys(this.data).length-1;\n        this.positionSlider.value = 0;\n        L.DomEvent.on(this.positionSlider, 'input', function(e) {\n            this.setCurrentPeriod( e.target.value );\n        }, this);\n        this.setCurrentPeriod( 0 );\n        L.DomEvent.disableClickPropagation(this.positionSlider);\n\n        this.closeButton = L.DomUtil.create('div', 'leaflet-control-weather-close', this.container);\n        L.DomEvent.on(this.closeButton, 'click', this.unload, this);\n    },\n    unload: function(e) {\n        L.DomUtil.remove(this.controlContainer);\n        L.DomUtil.remove(this.closeButton);\n        L.DomUtil.removeClass(this.container, 'active');\n        this.layerGroup.clearLayers();\n    },\n    setCurrentPeriod( period_index = 0 ) {\n        this.layerGroup.clearLayers();\n        let current_period = Object.keys(this.data)[period_index];\n        this.renderPlaces(period_index);\n        this.positionSliderLabel.textContent = this.periods[current_period];\n    },\n    onRemove: function (map) {\n        // Nothing to do here\n    }\n});","// extracted by mini-css-extract-plugin\nexport {};"],"sourceRoot":""}